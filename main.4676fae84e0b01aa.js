"use strict";(self.webpackChunkngx_three_demo=self.webpackChunkngx_three_demo||[]).push([[179],{1778:(KC,T2,lh)=>{var wg={};function Si(i){return"function"==typeof i}function $C(i){const t=i(n=>{Error.call(n),n.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}lh.r(wg),lh.d(wg,{ACESFilmicToneMapping:()=>mj,AddEquation:()=>As,AddOperation:()=>uj,AdditiveAnimationBlendMode:()=>oT,AdditiveBlending:()=>lf,AlphaFormat:()=>xj,AlwaysDepth:()=>rj,AlwaysStencilFunc:()=>kj,AmbientLight:()=>vx,AmbientLightProbe:()=>y4,AnimationClip:()=>cu,AnimationLoader:()=>Pae,AnimationMixer:()=>R4,AnimationObjectGroup:()=>Kae,AnimationUtils:()=>Tae,ArcCurve:()=>GU,ArrayCamera:()=>jT,ArrowHelper:()=>$4,Audio:()=>EI,AudioAnalyser:()=>Vae,AudioContext:()=>MI,AudioListener:()=>E4,AudioLoader:()=>Nae,AxesHelper:()=>J4,BackSide:()=>ys,BasicDepthPacking:()=>Dj,BasicShadowMap:()=>zte,Bone:()=>Kd,BooleanKeyframeTrack:()=>su,Box2:()=>sle,Box3:()=>Da,Box3Helper:()=>Y4,BoxBufferGeometry:()=>fle,BoxGeometry:()=>Ki,BoxHelper:()=>X4,BufferAttribute:()=>Ci,BufferGeometry:()=>xt,BufferGeometryLoader:()=>m4,ByteType:()=>_j,Cache:()=>du,Camera:()=>o0,CameraHelper:()=>q4,CanvasTexture:()=>ax,CapsuleBufferGeometry:()=>ple,CapsuleGeometry:()=>Zf,CatmullRomCurve3:()=>QU,CineonToneMapping:()=>pj,CircleBufferGeometry:()=>mle,CircleGeometry:()=>Kf,ClampToEdgeWrapping:()=>gr,Clock:()=>up,Color:()=>De,ColorKeyframeTrack:()=>_I,ColorManagement:()=>Yr,CompressedArrayTexture:()=>qT,CompressedTexture:()=>m0,CompressedTextureLoader:()=>_x,ConeBufferGeometry:()=>gle,ConeGeometry:()=>$f,CubeCamera:()=>DT,CubeReflectionMapping:()=>sc,CubeRefractionMapping:()=>oc,CubeTexture:()=>qd,CubeTextureLoader:()=>d4,CubeUVReflectionMapping:()=>ff,CubicBezierCurve:()=>$T,CubicBezierCurve3:()=>qU,CubicInterpolant:()=>o4,CullFaceBack:()=>US,CullFaceFront:()=>XN,CullFaceFrontBack:()=>Vte,CullFaceNone:()=>qN,Curve:()=>Co,CurvePath:()=>YU,CustomBlending:()=>cf,CustomToneMapping:()=>gj,CylinderBufferGeometry:()=>_le,CylinderGeometry:()=>jn,Cylindrical:()=>rle,Data3DTexture:()=>Ef,DataArrayTexture:()=>Mf,DataTexture:()=>ka,DataTexture2DArray:()=>e5,DataTexture3D:()=>t5,DataTextureLoader:()=>cp,DataUtils:()=>cs,DecrementStencilOp:()=>$te,DecrementWrapStencilOp:()=>eie,DefaultLoadingManager:()=>c4,DepthFormat:()=>cc,DepthStencilFormat:()=>dc,DepthTexture:()=>Hf,DirectionalLight:()=>M0,DirectionalLightHelper:()=>W4,DiscreteInterpolant:()=>a4,DodecahedronBufferGeometry:()=>ble,DodecahedronGeometry:()=>Jf,DoubleSide:()=>rc,DstAlphaFactor:()=>rA,DstColorFactor:()=>sA,DynamicCopyUsage:()=>pie,DynamicDrawUsage:()=>vA,DynamicReadUsage:()=>uie,EdgesGeometry:()=>rI,EllipseCurve:()=>bc,EqualDepth:()=>oj,EqualStencilFunc:()=>rie,EquirectangularReflectionMapping:()=>hf,EquirectangularRefractionMapping:()=>j_,Euler:()=>$s,EventDispatcher:()=>os,ExtrudeBufferGeometry:()=>vle,ExtrudeGeometry:()=>iu,FileLoader:()=>Ar,Float16BufferAttribute:()=>Xie,Float32BufferAttribute:()=>Ge,Float64BufferAttribute:()=>Yie,FloatType:()=>Ln,Fog:()=>l0,FogExp2:()=>XA,FramebufferTexture:()=>HU,FrontSide:()=>_l,Frustum:()=>zA,GLBufferAttribute:()=>nle,GLSL1:()=>gie,GLSL3:()=>lT,GreaterDepth:()=>lj,GreaterEqualDepth:()=>aj,GreaterEqualStencilFunc:()=>lie,GreaterStencilFunc:()=>oie,GridHelper:()=>PI,Group:()=>xs,HalfFloatType:()=>fn,HemisphereLight:()=>vI,HemisphereLightHelper:()=>z4,HemisphereLightProbe:()=>v4,IcosahedronBufferGeometry:()=>yle,IcosahedronGeometry:()=>tp,ImageBitmapLoader:()=>b4,ImageLoader:()=>x0,ImageUtils:()=>pT,ImmediateRenderObject:()=>ule,IncrementStencilOp:()=>Kte,IncrementWrapStencilOp:()=>Jte,InstancedBufferAttribute:()=>Yf,InstancedBufferGeometry:()=>CI,InstancedInterleavedBuffer:()=>ile,InstancedMesh:()=>ix,Int16BufferAttribute:()=>Wie,Int32BufferAttribute:()=>qie,Int8BufferAttribute:()=>Hie,IntType:()=>vj,InterleavedBuffer:()=>c0,InterleavedBufferAttribute:()=>_c,Interpolant:()=>lp,InterpolateDiscrete:()=>Af,InterpolateLinear:()=>Nd,InterpolateSmooth:()=>gA,InvertStencilOp:()=>tie,KeepStencilOp:()=>bA,KeyframeTrack:()=>ra,LOD:()=>GT,LatheBufferGeometry:()=>Ale,LatheGeometry:()=>Jd,Layers:()=>RA,LessDepth:()=>sj,LessEqualDepth:()=>oA,LessEqualStencilFunc:()=>sie,LessStencilFunc:()=>nie,Light:()=>Il,LightProbe:()=>E0,Line:()=>Nn,Line3:()=>F4,LineBasicMaterial:()=>pn,LineCurve:()=>cx,LineCurve3:()=>XU,LineDashedMaterial:()=>hI,LineLoop:()=>rx,LineSegments:()=>ws,LinearEncoding:()=>Ys,LinearFilter:()=>Li,LinearInterpolant:()=>gI,LinearMipMapLinearFilter:()=>Wte,LinearMipMapNearestFilter:()=>Qte,LinearMipmapLinearFilter:()=>Xs,LinearMipmapNearestFilter:()=>lA,LinearSRGBColorSpace:()=>xf,LinearToneMapping:()=>hj,Loader:()=>yr,LoaderUtils:()=>Cs,LoadingManager:()=>bI,LoopOnce:()=>sT,LoopPingPong:()=>Ij,LoopRepeat:()=>Tj,LuminanceAlphaFormat:()=>Cj,LuminanceFormat:()=>cA,MOUSE:()=>yo,Material:()=>On,MaterialLoader:()=>yx,MathUtils:()=>gt,Matrix3:()=>Xr,Matrix4:()=>Ve,MaxEquation:()=>QS,Mesh:()=>Ke,MeshBasicMaterial:()=>Xn,MeshDepthMaterial:()=>Zd,MeshDistanceMaterial:()=>qA,MeshLambertMaterial:()=>gx,MeshMatcapMaterial:()=>uI,MeshNormalMaterial:()=>ap,MeshPhongMaterial:()=>nu,MeshPhysicalMaterial:()=>Oa,MeshStandardMaterial:()=>La,MeshToonMaterial:()=>dI,MinEquation:()=>GS,MirroredRepeatWrapping:()=>pf,MixOperation:()=>dj,MultiplyBlending:()=>HS,MultiplyOperation:()=>N_,NearestFilter:()=>$t,NearestMipMapLinearFilter:()=>Gte,NearestMipMapNearestFilter:()=>Hte,NearestMipmapLinearFilter:()=>mf,NearestMipmapNearestFilter:()=>U_,NeverDepth:()=>nj,NeverStencilFunc:()=>iie,NoBlending:()=>Kt,NoColorSpace:()=>Xte,NoToneMapping:()=>Ra,NormalAnimationBlendMode:()=>_A,NormalBlending:()=>Ia,NotEqualDepth:()=>cj,NotEqualStencilFunc:()=>aie,NumberKeyframeTrack:()=>ou,Object3D:()=>wi,ObjectLoader:()=>Lae,ObjectSpaceNormalMap:()=>Pj,OctahedronBufferGeometry:()=>xle,OctahedronGeometry:()=>ia,OneFactor:()=>L_,OneMinusDstAlphaFactor:()=>ej,OneMinusDstColorFactor:()=>tj,OneMinusSrcAlphaFactor:()=>O_,OneMinusSrcColorFactor:()=>JN,OrthographicCamera:()=>Pa,PCFShadowMap:()=>VS,PCFSoftShadowMap:()=>YN,PMREMGenerator:()=>BT,Path:()=>b0,PerspectiveCamera:()=>Sn,Plane:()=>to,PlaneBufferGeometry:()=>wle,PlaneGeometry:()=>gc,PlaneHelper:()=>Z4,PointLight:()=>dp,PointLightHelper:()=>j4,Points:()=>$d,PointsMaterial:()=>El,PolarGridHelper:()=>H4,PolyhedronBufferGeometry:()=>Cle,PolyhedronGeometry:()=>Fa,PositionalAudio:()=>T4,PropertyBinding:()=>Oi,PropertyMixer:()=>I4,QuadraticBezierCurve:()=>JT,QuadraticBezierCurve3:()=>eI,Quaternion:()=>xi,QuaternionKeyframeTrack:()=>Sl,QuaternionLinearInterpolant:()=>l4,REVISION:()=>nA,RGBADepthPacking:()=>W_,RGBAFormat:()=>En,RGBAIntegerFormat:()=>Sj,RGBA_ASTC_10x10_Format:()=>iT,RGBA_ASTC_10x5_Format:()=>JS,RGBA_ASTC_10x6_Format:()=>eT,RGBA_ASTC_10x8_Format:()=>tT,RGBA_ASTC_12x10_Format:()=>nT,RGBA_ASTC_12x12_Format:()=>rT,RGBA_ASTC_4x4_Format:()=>pA,RGBA_ASTC_5x4_Format:()=>WS,RGBA_ASTC_5x5_Format:()=>qS,RGBA_ASTC_6x5_Format:()=>XS,RGBA_ASTC_6x6_Format:()=>YS,RGBA_ASTC_8x5_Format:()=>ZS,RGBA_ASTC_8x6_Format:()=>KS,RGBA_ASTC_8x8_Format:()=>$S,RGBA_BPTC_Format:()=>mA,RGBA_ETC2_EAC_Format:()=>fA,RGBA_PVRTC_2BPPV1_Format:()=>G_,RGBA_PVRTC_4BPPV1_Format:()=>yf,RGBA_S3TC_DXT1_Format:()=>dA,RGBA_S3TC_DXT3_Format:()=>z_,RGBA_S3TC_DXT5_Format:()=>bf,RGBFormat:()=>wj,RGB_ETC1_Format:()=>uA,RGB_ETC2_Format:()=>hA,RGB_PVRTC_2BPPV1_Format:()=>H_,RGB_PVRTC_4BPPV1_Format:()=>vf,RGB_S3TC_DXT1_Format:()=>_f,RGFormat:()=>gf,RGIntegerFormat:()=>Ej,RawShaderMaterial:()=>cI,Ray:()=>J_,Raycaster:()=>gu,RectAreaLight:()=>wI,RedFormat:()=>bl,RedIntegerFormat:()=>Mj,ReinhardToneMapping:()=>fj,RepeatWrapping:()=>Ao,ReplaceStencilOp:()=>Zte,ReverseSubtractEquation:()=>KN,RingBufferGeometry:()=>Mle,RingGeometry:()=>ip,SRGBColorSpace:()=>$o,Scene:()=>YA,ShaderChunk:()=>fi,ShaderLib:()=>wo,ShaderMaterial:()=>Rt,ShadowMaterial:()=>lI,Shape:()=>eu,ShapeBufferGeometry:()=>Ele,ShapeGeometry:()=>np,ShapePath:()=>ale,ShapeUtils:()=>Ba,ShortType:()=>bj,Skeleton:()=>Xf,SkeletonHelper:()=>O4,SkinnedMesh:()=>f0,Source:()=>Hd,Sphere:()=>Al,SphereBufferGeometry:()=>Sle,SphereGeometry:()=>vc,Spherical:()=>xx,SphericalHarmonics3:()=>p4,SplineCurve:()=>tI,SpotLight:()=>w0,SpotLightHelper:()=>L4,Sprite:()=>HT,SpriteMaterial:()=>ZA,SrcAlphaFactor:()=>uf,SrcAlphaSaturateFactor:()=>ij,SrcColorFactor:()=>$N,StaticCopyUsage:()=>fie,StaticDrawUsage:()=>q_,StaticReadUsage:()=>die,StereoCamera:()=>w4,StreamCopyUsage:()=>mie,StreamDrawUsage:()=>cie,StreamReadUsage:()=>hie,StringKeyframeTrack:()=>au,SubtractEquation:()=>ZN,SubtractiveBlending:()=>zS,TOUCH:()=>gl,TangentSpaceNormalMap:()=>uc,TetrahedronBufferGeometry:()=>Tle,TetrahedronGeometry:()=>rp,Texture:()=>qn,TextureLoader:()=>bx,TorusBufferGeometry:()=>Ile,TorusGeometry:()=>na,TorusKnotBufferGeometry:()=>Rle,TorusKnotGeometry:()=>sp,Triangle:()=>Js,TriangleFanDrawMode:()=>aT,TriangleStripDrawMode:()=>Rj,TrianglesDrawMode:()=>qte,TubeBufferGeometry:()=>Dle,TubeGeometry:()=>op,TwoPassDoubleSide:()=>B_,UVMapping:()=>aA,Uint16BufferAttribute:()=>kA,Uint32BufferAttribute:()=>FA,Uint8BufferAttribute:()=>Gie,Uint8ClampedBufferAttribute:()=>Qie,Uniform:()=>II,UniformsGroup:()=>tle,UniformsLib:()=>it,UniformsUtils:()=>mi,UnsignedByteType:()=>Wr,UnsignedInt248Type:()=>lc,UnsignedIntType:()=>ac,UnsignedShort4444Type:()=>yj,UnsignedShort5551Type:()=>Aj,UnsignedShortType:()=>V_,VSMShadowMap:()=>af,Vector2:()=>ue,Vector3:()=>T,Vector4:()=>ni,VectorKeyframeTrack:()=>lu,VideoTexture:()=>zU,WebGL1Renderer:()=>wU,WebGL3DRenderTarget:()=>kie,WebGLArrayRenderTarget:()=>Pie,WebGLCubeRenderTarget:()=>Yj,WebGLMultipleRenderTargets:()=>Fie,WebGLMultisampleRenderTarget:()=>hle,WebGLRenderTarget:()=>Gt,WebGLRenderer:()=>VT,WebGLUtils:()=>xU,WireframeGeometry:()=>aI,WrapAroundEnding:()=>Q_,ZeroCurvatureEnding:()=>jd,ZeroFactor:()=>df,ZeroSlopeEnding:()=>Ud,ZeroStencilOp:()=>Yte,_SRGBAFormat:()=>yA,sRGBEncoding:()=>hi});const JC=$C(i=>function(t){i(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((n,r)=>`${r+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Zb(i,e){if(i){const t=i.indexOf(e);0<=t&&i.splice(t,1)}}class cn{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:n}=this;if(Si(n))try{n()}catch(s){e=s instanceof JC?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{D2(s)}catch(o){e=e??[],o instanceof JC?e=[...e,...o.errors]:e.push(o)}}if(e)throw new JC(e)}}add(e){var t;if(e&&e!==this)if(this.closed)D2(e);else{if(e instanceof cn){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Zb(t,e)}remove(e){const{_finalizers:t}=this;t&&Zb(t,e),e instanceof cn&&e._removeParent(this)}}cn.EMPTY=(()=>{const i=new cn;return i.closed=!0,i})();const I2=cn.EMPTY;function R2(i){return i instanceof cn||i&&"closed"in i&&Si(i.remove)&&Si(i.add)&&Si(i.unsubscribe)}function D2(i){Si(i)?i():i.unsubscribe()}const ld={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Kb={setTimeout(i,e,...t){const{delegate:n}=Kb;return n?.setTimeout?n.setTimeout(i,e,...t):setTimeout(i,e,...t)},clearTimeout(i){const{delegate:e}=Kb;return(e?.clearTimeout||clearTimeout)(i)},delegate:void 0};function P2(i){Kb.setTimeout(()=>{const{onUnhandledError:e}=ld;if(!e)throw i;e(i)})}function eM(){}const $8=tM("C",void 0,void 0);function tM(i,e,t){return{kind:i,value:e,error:t}}let cd=null;function $b(i){if(ld.useDeprecatedSynchronousErrorHandling){const e=!cd;if(e&&(cd={errorThrown:!1,error:null}),i(),e){const{errorThrown:t,error:n}=cd;if(cd=null,t)throw n}}else i()}class iM extends cn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,R2(e)&&e.add(this)):this.destination=sQ}static create(e,t,n){return new Jb(e,t,n)}next(e){this.isStopped?rM(function eQ(i){return tM("N",i,void 0)}(e),this):this._next(e)}error(e){this.isStopped?rM(function J8(i){return tM("E",void 0,i)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?rM($8,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const iQ=Function.prototype.bind;function nM(i,e){return iQ.call(i,e)}class nQ{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){ev(n)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){ev(n)}else ev(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){ev(t)}}}class Jb extends iM{constructor(e,t,n){let r;if(super(),Si(e)||!e)r={next:e??void 0,error:t??void 0,complete:n??void 0};else{let s;this&&ld.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&nM(e.next,s),error:e.error&&nM(e.error,s),complete:e.complete&&nM(e.complete,s)}):r=e}this.destination=new nQ(r)}}function ev(i){ld.useDeprecatedSynchronousErrorHandling?function tQ(i){ld.useDeprecatedSynchronousErrorHandling&&cd&&(cd.errorThrown=!0,cd.error=i)}(i):P2(i)}function rM(i,e){const{onStoppedNotification:t}=ld;t&&Kb.setTimeout(()=>t(i,e))}const sQ={closed:!0,next:eM,error:function rQ(i){throw i},complete:eM},sM="function"==typeof Symbol&&Symbol.observable||"@@observable";function Ql(i){return i}function k2(i){return 0===i.length?Ql:1===i.length?i[0]:function(t){return i.reduce((n,r)=>r(n),t)}}let Fi=(()=>{class i{constructor(t){t&&(this._subscribe=t)}lift(t){const n=new i;return n.source=this,n.operator=t,n}subscribe(t,n,r){const s=function lQ(i){return i&&i instanceof iM||function aQ(i){return i&&Si(i.next)&&Si(i.error)&&Si(i.complete)}(i)&&R2(i)}(t)?t:new Jb(t,n,r);return $b(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return new(n=F2(n))((r,s)=>{const o=new Jb({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(t)}[sM](){return this}pipe(...t){return k2(t)(this)}toPromise(t){return new(t=F2(t))((n,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>n(s))})}}return i.create=e=>new i(e),i})();function F2(i){var e;return null!==(e=i??ld.Promise)&&void 0!==e?e:Promise}const cQ=$C(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Wt=(()=>{class i extends Fi{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const n=new B2(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new cQ}next(t){$b(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(t)}})}error(t){$b(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){$b(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:n,isStopped:r,observers:s}=this;return n||r?I2:(this.currentObservers=null,s.push(t),new cn(()=>{this.currentObservers=null,Zb(s,t)}))}_checkFinalizedStatuses(t){const{hasError:n,thrownError:r,isStopped:s}=this;n?t.error(r):s&&t.complete()}asObservable(){const t=new Fi;return t.source=this,t}}return i.create=(e,t)=>new B2(e,t),i})();class B2 extends Wt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:I2}}function L2(i){return Si(i?.lift)}function xn(i){return e=>{if(L2(e))return e.lift(function(t){try{return i(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function dn(i,e,t,n,r){return new dQ(i,e,t,n,r)}class dQ extends iM{constructor(e,t,n,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function vt(i,e){return xn((t,n)=>{let r=0;t.subscribe(dn(n,s=>{n.next(i.call(e,s,r++))}))})}function dd(i){return this instanceof dd?(this.v=i,this):new dd(i)}function fQ(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,n=t.apply(i,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(h){n[h]&&(r[h]=function(f){return new Promise(function(m,p){s.push([h,f,m,p])>1||a(h,f)})})}function a(h,f){try{!function l(h){h.value instanceof dd?Promise.resolve(h.value.v).then(c,d):u(s[0][2],h)}(n[h](f))}catch(m){u(s[0][3],m)}}function c(h){a("next",h)}function d(h){a("throw",h)}function u(h,f){h(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}function pQ(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=i[Symbol.asyncIterator];return e?e.call(i):(i=function j2(i){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=i[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=i[s](o)).done,o.value)})}}}const aM=i=>i&&"number"==typeof i.length&&"function"!=typeof i;function U2(i){return Si(i?.then)}function V2(i){return Si(i[sM])}function z2(i){return Symbol.asyncIterator&&Si(i?.[Symbol.asyncIterator])}function H2(i){return new TypeError(`You provided ${null!==i&&"object"==typeof i?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const G2=function gQ(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Q2(i){return Si(i?.[G2])}function W2(i){return fQ(this,arguments,function*(){const t=i.getReader();try{for(;;){const{value:n,done:r}=yield dd(t.read());if(r)return yield dd(void 0);yield yield dd(n)}}finally{t.releaseLock()}})}function q2(i){return Si(i?.getReader)}function fs(i){if(i instanceof Fi)return i;if(null!=i){if(V2(i))return function _Q(i){return new Fi(e=>{const t=i[sM]();if(Si(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(i);if(aM(i))return function bQ(i){return new Fi(e=>{for(let t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}(i);if(U2(i))return function vQ(i){return new Fi(e=>{i.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,P2)})}(i);if(z2(i))return X2(i);if(Q2(i))return function yQ(i){return new Fi(e=>{for(const t of i)if(e.next(t),e.closed)return;e.complete()})}(i);if(q2(i))return function AQ(i){return X2(W2(i))}(i)}throw H2(i)}function X2(i){return new Fi(e=>{(function xQ(i,e){var t,n,r,s;return function uQ(i,e,t,n){return new(t||(t=Promise))(function(s,o){function a(d){try{c(n.next(d))}catch(u){o(u)}}function l(d){try{c(n.throw(d))}catch(u){o(u)}}function c(d){d.done?s(d.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(d.value).then(a,l)}c((n=n.apply(i,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=pQ(i);!(n=yield t.next()).done;)if(e.next(n.value),e.closed)return}catch(o){r={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(i,e).catch(t=>e.error(t))})}function el(i,e,t,n=0,r=!1){const s=e.schedule(function(){t(),r?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(s),!r)return s}function Mr(i,e,t=1/0){return Si(e)?Mr((n,r)=>vt((s,o)=>e(n,s,r,o))(fs(i(n,r))),t):("number"==typeof e&&(t=e),xn((n,r)=>function wQ(i,e,t,n,r,s,o,a){const l=[];let c=0,d=0,u=!1;const h=()=>{u&&!l.length&&!c&&e.complete()},f=p=>c<n?m(p):l.push(p),m=p=>{s&&e.next(p),c++;let g=!1;fs(t(p,d++)).subscribe(dn(e,_=>{r?.(_),s?f(_):e.next(_)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;l.length&&c<n;){const _=l.shift();o?el(e,o,()=>m(_)):m(_)}h()}catch(_){e.error(_)}}))};return i.subscribe(dn(e,f,()=>{u=!0,h()})),()=>{a?.()}}(n,r,i,t)))}function ch(i=1/0){return Mr(Ql,i)}const jr=new Fi(i=>i.complete());function Y2(i){return i&&Si(i.schedule)}function lM(i){return i[i.length-1]}function cM(i){return Si(lM(i))?i.pop():void 0}function Cg(i){return Y2(lM(i))?i.pop():void 0}function Z2(i,e=0){return xn((t,n)=>{t.subscribe(dn(n,r=>el(n,i,()=>n.next(r),e),()=>el(n,i,()=>n.complete(),e),r=>el(n,i,()=>n.error(r),e)))})}function K2(i,e=0){return xn((t,n)=>{n.add(i.schedule(()=>t.subscribe(n),e))})}function $2(i,e){if(!i)throw new Error("Iterable cannot be null");return new Fi(t=>{el(t,e,()=>{const n=i[Symbol.asyncIterator]();el(t,e,()=>{n.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function wn(i,e){return e?function DQ(i,e){if(null!=i){if(V2(i))return function EQ(i,e){return fs(i).pipe(K2(e),Z2(e))}(i,e);if(aM(i))return function TQ(i,e){return new Fi(t=>{let n=0;return e.schedule(function(){n===i.length?t.complete():(t.next(i[n++]),t.closed||this.schedule())})})}(i,e);if(U2(i))return function SQ(i,e){return fs(i).pipe(K2(e),Z2(e))}(i,e);if(z2(i))return $2(i,e);if(Q2(i))return function IQ(i,e){return new Fi(t=>{let n;return el(t,e,()=>{n=i[G2](),el(t,e,()=>{let r,s;try{({value:r,done:s}=n.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>Si(n?.return)&&n.return()})}(i,e);if(q2(i))return function RQ(i,e){return $2(W2(i),e)}(i,e)}throw H2(i)}(i,e):fs(i)}function ud(...i){const e=Cg(i),t=function MQ(i,e){return"number"==typeof lM(i)?i.pop():e}(i,1/0),n=i;return n.length?1===n.length?fs(n[0]):ch(t)(wn(n,e)):jr}function ps(i){return i<=0?()=>jr:xn((e,t)=>{let n=0;e.subscribe(dn(t,r=>{++n<=i&&(t.next(r),i<=n&&t.complete())}))})}function dM(i={}){const{connector:e=(()=>new Wt),resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:r=!0}=i;return s=>{let o=null,a=null,l=null,c=0,d=!1,u=!1;const h=()=>{a?.unsubscribe(),a=null},f=()=>{h(),o=l=null,d=u=!1},m=()=>{const p=o;f(),p?.unsubscribe()};return xn((p,g)=>{c++,!u&&!d&&h();const _=l=l??e();g.add(()=>{c--,0===c&&!u&&!d&&(a=uM(m,r))}),_.subscribe(g),o||(o=new Jb({next:v=>_.next(v),error:v=>{u=!0,h(),a=uM(f,t,v),_.error(v)},complete:()=>{d=!0,h(),a=uM(f,n),_.complete()}}),wn(p).subscribe(o))})(s)}}function uM(i,e,...t){return!0===e?(i(),null):!1===e?null:e(...t).pipe(ps(1)).subscribe(()=>i())}function Yi(i){for(let e in i)if(i[e]===Yi)return e;throw Error("Could not find renamed property on target object.")}function hM(i,e){for(const t in e)e.hasOwnProperty(t)&&!i.hasOwnProperty(t)&&(i[t]=e[t])}function Ji(i){if("string"==typeof i)return i;if(Array.isArray(i))return"["+i.map(Ji).join(", ")+"]";if(null==i)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;const e=i.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function fM(i,e){return null==i||""===i?null===e?"":e:null==e||""===e?i:i+" "+e}const PQ=Yi({__forward_ref__:Yi});function le(i){return i.__forward_ref__=le,i.toString=function(){return Ji(this())},i}function Nt(i){return pM(i)?i():i}function pM(i){return"function"==typeof i&&i.hasOwnProperty(PQ)&&i.__forward_ref__===le}function mM(i){return i&&!!i.\u0275providers}const tv="https://g.co/ng/security#xss";class Me extends Error{constructor(e,t){super(function iv(i,e){return`NG0${Math.abs(i)}${e?": "+e.trim():""}`}(e,t)),this.code=e}}function Xt(i){return"string"==typeof i?i:null==i?"":String(i)}function nv(i,e){throw new Me(-201,!1)}function uo(i,e){null==i&&function ji(i,e,t,n){throw new Error(`ASSERTION ERROR: ${i}`+(null==n?"":` [Expected=> ${t} ${n} ${e} <=Actual]`))}(e,i,null,"!=")}function Ne(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function oi(i){return{providers:i.providers||[],imports:i.imports||[]}}function rv(i){return J2(i,sv)||J2(i,tP)}function J2(i,e){return i.hasOwnProperty(e)?i[e]:null}function eP(i){return i&&(i.hasOwnProperty(gM)||i.hasOwnProperty(VQ))?i[gM]:null}const sv=Yi({\u0275prov:Yi}),gM=Yi({\u0275inj:Yi}),tP=Yi({ngInjectableDef:Yi}),VQ=Yi({ngInjectorDef:Yi});var jt=(()=>((jt=jt||{})[jt.Default=0]="Default",jt[jt.Host=1]="Host",jt[jt.Self=2]="Self",jt[jt.SkipSelf=4]="SkipSelf",jt[jt.Optional=8]="Optional",jt))();let _M;function ho(i){const e=_M;return _M=i,e}function iP(i,e,t){const n=rv(i);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:t&jt.Optional?null:void 0!==e?e:void nv(Ji(i))}const en=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Mg={},bM="__NG_DI_FLAG__",ov="ngTempTokenPath",GQ=/\n/gm,nP="__source";let Eg;function dh(i){const e=Eg;return Eg=i,e}function WQ(i,e=jt.Default){if(void 0===Eg)throw new Me(-203,!1);return null===Eg?iP(i,void 0,e):Eg.get(i,e&jt.Optional?null:void 0,e)}function ye(i,e=jt.Default){return(function zQ(){return _M}()||WQ)(Nt(i),e)}function Ut(i,e=jt.Default){return ye(i,av(e))}function av(i){return typeof i>"u"||"number"==typeof i?i:0|(i.optional&&8)|(i.host&&1)|(i.self&&2)|(i.skipSelf&&4)}function vM(i){const e=[];for(let t=0;t<i.length;t++){const n=Nt(i[t]);if(Array.isArray(n)){if(0===n.length)throw new Me(900,!1);let r,s=jt.Default;for(let o=0;o<n.length;o++){const a=n[o],l=qQ(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(ye(r,s))}else e.push(ye(n))}return e}function Sg(i,e){return i[bM]=e,i.prototype[bM]=e,i}function qQ(i){return i[bM]}function ql(i){return{toString:i}.toString()}var jo=(()=>((jo=jo||{})[jo.OnPush=0]="OnPush",jo[jo.Default=1]="Default",jo))(),Uo=(()=>{return(i=Uo||(Uo={}))[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",Uo;var i})();const tl={},Bi=[],lv=Yi({\u0275cmp:Yi}),yM=Yi({\u0275dir:Yi}),AM=Yi({\u0275pipe:Yi}),sP=Yi({\u0275mod:Yi}),il=Yi({\u0275fac:Yi}),Tg=Yi({__NG_ELEMENT_ID__:Yi});let ZQ=0;function $(i){return ql(()=>{const t=!0===i.standalone,n={},r={type:i.type,providersResolver:null,decls:i.decls,vars:i.vars,factory:null,template:i.template||null,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:i.exportAs||null,onPush:i.changeDetection===jo.OnPush,directiveDefs:null,pipeDefs:null,standalone:t,dependencies:t&&i.dependencies||null,getStandaloneInjector:null,selectors:i.selectors||Bi,viewQuery:i.viewQuery||null,features:i.features||null,data:i.data||{},encapsulation:i.encapsulation||Uo.Emulated,id:"c"+ZQ++,styles:i.styles||Bi,_:null,setInput:null,schemas:i.schemas||null,tView:null,findHostDirectiveDefs:null,hostDirectives:null},s=i.dependencies,o=i.features;return r.inputs=lP(i.inputs,n),r.outputs=lP(i.outputs),o&&o.forEach(a=>a(r)),r.directiveDefs=s?()=>("function"==typeof s?s():s).map(oP).filter(aP):null,r.pipeDefs=s?()=>("function"==typeof s?s():s).map($r).filter(aP):null,r})}function oP(i){return Ui(i)||Ur(i)}function aP(i){return null!==i}function ci(i){return ql(()=>({type:i.type,bootstrap:i.bootstrap||Bi,declarations:i.declarations||Bi,imports:i.imports||Bi,exports:i.exports||Bi,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null}))}function lP(i,e){if(null==i)return tl;const t={};for(const n in i)if(i.hasOwnProperty(n)){let r=i[n],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=n,e&&(e[r]=s)}return t}const ke=$;function gi(i){return{type:i.type,name:i.name,factory:null,pure:!1!==i.pure,standalone:!0===i.standalone,onDestroy:i.type.prototype.ngOnDestroy||null}}function Ui(i){return i[lv]||null}function Ur(i){return i[yM]||null}function $r(i){return i[AM]||null}function Os(i,e){const t=i[sP]||null;if(!t&&!0===e)throw new Error(`Type ${Ji(i)} does not have '\u0275mod' property.`);return t}function Ns(i){return Array.isArray(i)&&"object"==typeof i[1]}function zo(i){return Array.isArray(i)&&!0===i[1]}function CM(i){return 0!=(4&i.flags)}function Pg(i){return i.componentOffset>-1}function fv(i){return 1==(1&i.flags)}function Ho(i){return null!==i.template}function JQ(i){return 0!=(256&i[2])}function fd(i,e){return i.hasOwnProperty(il)?i[il]:null}class i6{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function Pr(){return pP}function pP(i){return i.type.prototype.ngOnChanges&&(i.setInput=r6),n6}function n6(){const i=gP(this),e=i?.current;if(e){const t=i.previous;if(t===tl)i.previous=e;else for(let n in e)t[n]=e[n];i.current=null,this.ngOnChanges(e)}}function r6(i,e,t,n){const r=this.declaredInputs[t],s=gP(i)||function s6(i,e){return i[mP]=e}(i,{previous:tl,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[r];o[r]=new i6(l&&l.currentValue,e,a===tl),i[n]=e}Pr.ngInherit=!0;const mP="__ngSimpleChanges__";function gP(i){return i[mP]||null}function kr(i){for(;Array.isArray(i);)i=i[0];return i}function pv(i,e){return kr(e[i])}function js(i,e){return kr(e[i.index])}function vP(i,e){return i.data[e]}function gh(i,e){return i[e]}function Us(i,e){const t=e[i];return Ns(t)?t:t[0]}function mv(i){return 64==(64&i[2])}function Xl(i,e){return null==e?null:i[e]}function yP(i){i[18]=0}function EM(i,e){i[5]+=e;let t=i,n=i[3];for(;null!==n&&(1===e&&1===t[5]||-1===e&&0===t[5]);)n[5]+=e,t=n,n=n[3]}const Yt={lFrame:RP(null),bindingsEnabled:!0};function xP(){return Yt.bindingsEnabled}function Le(){return Yt.lFrame.lView}function Ti(){return Yt.lFrame.tView}function cr(i){return Yt.lFrame.contextLView=i,i[8]}function dr(i){return Yt.lFrame.contextLView=null,i}function Fr(){let i=wP();for(;null!==i&&64===i.type;)i=i.parent;return i}function wP(){return Yt.lFrame.currentTNode}function ga(i,e){const t=Yt.lFrame;t.currentTNode=i,t.isParent=e}function SM(){return Yt.lFrame.isParent}function TM(){Yt.lFrame.isParent=!1}function es(){const i=Yt.lFrame;let e=i.bindingRootIndex;return-1===e&&(e=i.bindingRootIndex=i.tView.bindingStartIndex),e}function _h(){return Yt.lFrame.bindingIndex++}function sl(i){const e=Yt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+i,t}function b6(i,e){const t=Yt.lFrame;t.bindingIndex=t.bindingRootIndex=i,IM(e)}function IM(i){Yt.lFrame.currentDirectiveIndex=i}function RM(i){const e=Yt.lFrame.currentDirectiveIndex;return-1===e?null:i[e]}function SP(){return Yt.lFrame.currentQueryIndex}function DM(i){Yt.lFrame.currentQueryIndex=i}function y6(i){const e=i[1];return 2===e.type?e.declTNode:1===e.type?i[6]:null}function TP(i,e,t){if(t&jt.SkipSelf){let r=e,s=i;for(;!(r=r.parent,null!==r||t&jt.Host||(r=y6(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,i=s}const n=Yt.lFrame=IP();return n.currentTNode=e,n.lView=i,!0}function PM(i){const e=IP(),t=i[1];Yt.lFrame=e,e.currentTNode=t.firstChild,e.lView=i,e.tView=t,e.contextLView=i,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function IP(){const i=Yt.lFrame,e=null===i?null:i.child;return null===e?RP(i):e}function RP(i){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return null!==i&&(i.child=e),e}function DP(){const i=Yt.lFrame;return Yt.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}const PP=DP;function kM(){const i=DP();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function ts(){return Yt.lFrame.selectedIndex}function pd(i){Yt.lFrame.selectedIndex=i}function Cn(){const i=Yt.lFrame;return vP(i.tView,i.selectedIndex)}function gv(i,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){const s=i.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:d}=s;o&&(i.contentHooks||(i.contentHooks=[])).push(-t,o),a&&((i.contentHooks||(i.contentHooks=[])).push(t,a),(i.contentCheckHooks||(i.contentCheckHooks=[])).push(t,a)),l&&(i.viewHooks||(i.viewHooks=[])).push(-t,l),c&&((i.viewHooks||(i.viewHooks=[])).push(t,c),(i.viewCheckHooks||(i.viewCheckHooks=[])).push(t,c)),null!=d&&(i.destroyHooks||(i.destroyHooks=[])).push(t,d)}}function _v(i,e,t){BP(i,e,3,t)}function bv(i,e,t,n){(3&i[2])===t&&BP(i,e,t,n)}function FM(i,e){let t=i[2];(3&t)===e&&(t&=2047,t+=1,i[2]=t)}function BP(i,e,t,n){const s=n??-1,o=e.length-1;let a=0;for(let l=void 0!==n?65535&i[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=n&&a>=n)break}else e[l]<0&&(i[18]+=65536),(a<s||-1==s)&&(S6(i,t,e,l),i[18]=(4294901760&i[18])+l+2),l++}function S6(i,e,t,n){const r=t[n]<0,s=t[n+1],a=i[r?-t[n]:t[n]];if(r){if(i[2]>>11<i[18]>>16&&(3&i[2])===e){i[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class Fg{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function LM(i,e,t){let n=0;for(;n<t.length;){const r=t[n];if("number"==typeof r){if(0!==r)break;n++;const s=t[n++],o=t[n++],a=t[n++];i.setAttribute(e,o,a,s)}else{const s=r,o=t[++n];OP(s)?i.setProperty(e,s,o):i.setAttribute(e,s,o),n++}}return n}function LP(i){return 3===i||4===i||6===i}function OP(i){return 64===i.charCodeAt(0)}function Bg(i,e){if(null!==e&&0!==e.length)if(null===i||0===i.length)i=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){const r=e[n];"number"==typeof r?t=r:0===t||NP(i,t,r,null,-1===t||2===t?e[++n]:null)}}return i}function NP(i,e,t,n,r){let s=0,o=i.length;if(-1===e)o=-1;else for(;s<i.length;){const a=i[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<i.length;){const a=i[s];if("number"==typeof a)break;if(a===t){if(null===n)return void(null!==r&&(i[s+1]=r));if(n===i[s+1])return void(i[s+2]=r)}s++,null!==n&&s++,null!==r&&s++}-1!==o&&(i.splice(o,0,e),s=o+1),i.splice(s++,0,t),null!==n&&i.splice(s++,0,n),null!==r&&i.splice(s++,0,r)}function jP(i){return-1!==i}function vv(i){return 32767&i}function yv(i,e){let t=function D6(i){return i>>16}(i),n=e;for(;t>0;)n=n[15],t--;return n}let OM=!0;function Av(i){const e=OM;return OM=i,e}let P6=0;const _a={};function xv(i,e){const t=zP(i,e);if(-1!==t)return t;const n=e[1];n.firstCreatePass&&(i.injectorIndex=e.length,NM(n.data,i),NM(e,null),NM(n.blueprint,null));const r=jM(i,e),s=i.injectorIndex;if(jP(r)){const o=vv(r),a=yv(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function NM(i,e){i.push(0,0,0,0,0,0,0,0,e)}function zP(i,e){return-1===i.injectorIndex||i.parent&&i.parent.injectorIndex===i.injectorIndex||null===e[i.injectorIndex+8]?-1:i.injectorIndex}function jM(i,e){if(i.parent&&-1!==i.parent.injectorIndex)return i.parent.injectorIndex;let t=0,n=null,r=e;for(;null!==r;){if(n=YP(r),null===n)return-1;if(t++,r=r[15],-1!==n.injectorIndex)return n.injectorIndex|t<<16}return-1}function UM(i,e,t){!function k6(i,e,t){let n;"string"==typeof t?n=t.charCodeAt(0)||0:t.hasOwnProperty(Tg)&&(n=t[Tg]),null==n&&(n=t[Tg]=P6++);const r=255&n;e.data[i+(r>>5)]|=1<<r}(i,e,t)}function HP(i,e,t){if(t&jt.Optional||void 0!==i)return i;nv()}function GP(i,e,t,n){if(t&jt.Optional&&void 0===n&&(n=null),!(t&(jt.Self|jt.Host))){const r=i[9],s=ho(void 0);try{return r?r.get(e,n,t&jt.Optional):iP(e,n,t&jt.Optional)}finally{ho(s)}}return HP(n,0,t)}function QP(i,e,t,n=jt.Default,r){if(null!==i){if(1024&e[2]){const o=function N6(i,e,t,n,r){let s=i,o=e;for(;null!==s&&null!==o&&1024&o[2]&&!(256&o[2]);){const a=WP(s,o,t,n|jt.Self,_a);if(a!==_a)return a;let l=s.parent;if(!l){const c=o[21];if(c){const d=c.get(t,_a,n);if(d!==_a)return d}l=YP(o),o=o[15]}s=l}return r}(i,e,t,n,_a);if(o!==_a)return o}const s=WP(i,e,t,n,_a);if(s!==_a)return s}return GP(e,t,n,r)}function WP(i,e,t,n,r){const s=function L6(i){if("string"==typeof i)return i.charCodeAt(0)||0;const e=i.hasOwnProperty(Tg)?i[Tg]:void 0;return"number"==typeof e?e>=0?255&e:O6:e}(t);if("function"==typeof s){if(!TP(e,i,n))return n&jt.Host?HP(r,0,n):GP(e,t,n,r);try{const o=s(n);if(null!=o||n&jt.Optional)return o;nv()}finally{PP()}}else if("number"==typeof s){let o=null,a=zP(i,e),l=-1,c=n&jt.Host?e[16][6]:null;for((-1===a||n&jt.SkipSelf)&&(l=-1===a?jM(i,e):e[a+8],-1!==l&&XP(n,!1)?(o=e[1],a=vv(l),e=yv(l,e)):a=-1);-1!==a;){const d=e[1];if(qP(s,a,d.data)){const u=B6(a,e,t,o,n,c);if(u!==_a)return u}l=e[a+8],-1!==l&&XP(n,e[1].data[a+8]===c)&&qP(s,a,e)?(o=d,a=vv(l),e=yv(l,e)):a=-1}}return r}function B6(i,e,t,n,r,s){const o=e[1],a=o.data[i+8],d=wv(a,o,t,null==n?Pg(a)&&OM:n!=o&&0!=(3&a.type),r&jt.Host&&s===a);return null!==d?md(e,o,d,a):_a}function wv(i,e,t,n,r){const s=i.providerIndexes,o=e.data,a=1048575&s,l=i.directiveStart,d=s>>20,h=r?a+d:i.directiveEnd;for(let f=n?a:a+d;f<h;f++){const m=o[f];if(f<l&&t===m||f>=l&&m.type===t)return f}if(r){const f=o[l];if(f&&Ho(f)&&f.type===t)return l}return null}function md(i,e,t,n){let r=i[t];const s=e.data;if(function T6(i){return i instanceof Fg}(r)){const o=r;o.resolving&&function kQ(i,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${i}`:"";throw new Me(-200,`Circular dependency in DI detected for ${i}${t}`)}(function Ni(i){return"function"==typeof i?i.name||i.toString():"object"==typeof i&&null!=i&&"function"==typeof i.type?i.type.name||i.type.toString():Xt(i)}(s[t]));const a=Av(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?ho(o.injectImpl):null;TP(i,n,jt.Default);try{r=i[t]=o.factory(void 0,s,i,n),e.firstCreatePass&&t>=n.directiveStart&&function E6(i,e,t){const{ngOnChanges:n,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(n){const o=pP(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(i,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(i,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-i,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(i,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(i,s))}(t,s[t],e)}finally{null!==l&&ho(l),Av(a),o.resolving=!1,PP()}}return r}function qP(i,e,t){return!!(t[e+(i>>5)]&1<<i)}function XP(i,e){return!(i&jt.Self||i&jt.Host&&e)}class vh{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return QP(this._tNode,this._lView,e,av(n),t)}}function O6(){return new vh(Fr(),Le())}function ce(i){return ql(()=>{const e=i.prototype.constructor,t=e[il]||VM(e),n=Object.prototype;let r=Object.getPrototypeOf(i.prototype).constructor;for(;r&&r!==n;){const s=r[il]||VM(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function VM(i){return pM(i)?()=>{const e=VM(Nt(i));return e&&e()}:fd(i)}function YP(i){const e=i[1],t=e.type;return 2===t?e.declTNode:1===t?i[6]:null}function Lg(i){return function F6(i,e){if("class"===e)return i.classes;if("style"===e)return i.styles;const t=i.attrs;if(t){const n=t.length;let r=0;for(;r<n;){const s=t[r];if(LP(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<n&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(Fr(),i)}const Ah="__parameters__";function wh(i,e,t){return ql(()=>{const n=function zM(i){return function(...t){if(i){const n=i(...t);for(const r in n)this[r]=n[r]}}}(e);function r(...s){if(this instanceof r)return n.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,d){const u=l.hasOwnProperty(Ah)?l[Ah]:Object.defineProperty(l,Ah,{value:[]})[Ah];for(;u.length<=d;)u.push(null);return(u[d]=u[d]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=i,r.annotationCls=r,r})}class Fe{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Ne({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function gd(i,e){i.forEach(t=>Array.isArray(t)?gd(t,e):e(t))}function KP(i,e,t){e>=i.length?i.push(t):i.splice(e,0,t)}function Cv(i,e){return e>=i.length-1?i.pop():i.splice(e,1)[0]}function jg(i,e){const t=[];for(let n=0;n<i;n++)t.push(e);return t}function Vs(i,e,t){let n=Ch(i,e);return n>=0?i[1|n]=t:(n=~n,function z6(i,e,t,n){let r=i.length;if(r==e)i.push(t,n);else if(1===r)i.push(n,i[0]),i[0]=t;else{for(r--,i.push(i[r-1],i[r]);r>e;)i[r]=i[r-2],r--;i[e]=t,i[e+1]=n}}(i,n,e,t)),n}function GM(i,e){const t=Ch(i,e);if(t>=0)return i[1|t]}function Ch(i,e){return function $P(i,e,t){let n=0,r=i.length>>t;for(;r!==n;){const s=n+(r-n>>1),o=i[s<<t];if(e===o)return s<<t;o>e?r=s:n=s+1}return~(r<<t)}(i,e,1)}const Ev=Sg(wh("Inject",i=>({token:i})),-1),ol=Sg(wh("Optional"),8),Mh=Sg(wh("SkipSelf"),4);var ms=(()=>((ms=ms||{})[ms.Important=1]="Important",ms[ms.DashCase=2]="DashCase",ms))();const YM=new Map;let dW=0;const KM="__ngContext__";function Hr(i,e){Ns(e)?(i[KM]=e[20],function hW(i){YM.set(i[20],i)}(e)):i[KM]=e}function JM(i,e){return undefined(i,e)}function Hg(i){const e=i[3];return zo(e)?e[3]:e}function e1(i){return bk(i[13])}function t1(i){return bk(i[4])}function bk(i){for(;null!==i&&!zo(i);)i=i[4];return i}function Sh(i,e,t,n,r){if(null!=n){let s,o=!1;zo(n)?s=n:Ns(n)&&(o=!0,n=n[0]);const a=kr(n);0===i&&null!==t?null==r?Ck(e,t,a):_d(e,t,a,r||null,!0):1===i&&null!==t?_d(e,t,a,r||null,!0):2===i?function c1(i,e,t){const n=Iv(i,e);n&&function PW(i,e,t,n){i.removeChild(e,t,n)}(i,n,e,t)}(e,a,o):3===i&&e.destroyNode(a),null!=s&&function BW(i,e,t,n,r){const s=t[7];s!==kr(t)&&Sh(e,i,n,s,r);for(let a=10;a<t.length;a++){const l=t[a];Gg(l[1],l,i,e,n,s)}}(e,i,s,t,r)}}function r1(i,e,t){return i.createElement(e,t)}function yk(i,e){const t=i[9],n=t.indexOf(e),r=e[3];512&e[2]&&(e[2]&=-513,EM(r,-1)),t.splice(n,1)}function s1(i,e){if(i.length<=10)return;const t=10+e,n=i[t];if(n){const r=n[17];null!==r&&r!==i&&yk(r,n),e>0&&(i[t-1][4]=n[4]);const s=Cv(i,10+e);!function CW(i,e){Gg(i,e,e[11],2,null,null),e[0]=null,e[6]=null}(n[1],n);const o=s[19];null!==o&&o.detachView(s[1]),n[3]=null,n[4]=null,n[2]&=-65}return n}function Ak(i,e){if(!(128&e[2])){const t=e[11];t.destroyNode&&Gg(i,e,t,3,null,null),function SW(i){let e=i[13];if(!e)return o1(i[1],i);for(;e;){let t=null;if(Ns(e))t=e[13];else{const n=e[10];n&&(t=n)}if(!t){for(;e&&!e[4]&&e!==i;)Ns(e)&&o1(e[1],e),e=e[3];null===e&&(e=i),Ns(e)&&o1(e[1],e),t=e&&e[4]}e=t}}(e)}}function o1(i,e){if(!(128&e[2])){e[2]&=-65,e[2]|=128,function DW(i,e){let t;if(null!=i&&null!=(t=i.destroyHooks))for(let n=0;n<t.length;n+=2){const r=e[t[n]];if(!(r instanceof Fg)){const s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(i,e),function RW(i,e){const t=i.cleanup,n=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?n[r=o]():n[r=-o].unsubscribe(),s+=2}else{const o=n[r=t[s+1]];t[s].call(o)}if(null!==n){for(let s=r+1;s<n.length;s++)(0,n[s])();e[7]=null}}(i,e),1===e[1].type&&e[11].destroy();const t=e[17];if(null!==t&&zo(e[3])){t!==e[3]&&yk(t,e);const n=e[19];null!==n&&n.detachView(i)}!function fW(i){YM.delete(i[20])}(e)}}function xk(i,e,t){return function wk(i,e,t){let n=e;for(;null!==n&&40&n.type;)n=(e=n).parent;if(null===n)return t[0];{const{componentOffset:r}=n;if(r>-1){const{encapsulation:s}=i.data[n.directiveStart+r];if(s===Uo.None||s===Uo.Emulated)return null}return js(n,t)}}(i,e.parent,t)}function _d(i,e,t,n,r){i.insertBefore(e,t,n,r)}function Ck(i,e,t){i.appendChild(e,t)}function Mk(i,e,t,n,r){null!==n?_d(i,e,t,n,r):Ck(i,e,t)}function Iv(i,e){return i.parentNode(e)}function Ek(i,e,t){return Tk(i,e,t)}let Pv,h1,kv,Tk=function Sk(i,e,t){return 40&i.type?js(i,t):null};function Rv(i,e,t,n){const r=xk(i,n,e),s=e[11],a=Ek(n.parent||e[6],n,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)Mk(s,r,t[l],a,!1);else Mk(s,r,t,a,!1)}function Dv(i,e){if(null!==e){const t=e.type;if(3&t)return js(e,i);if(4&t)return l1(-1,i[e.index]);if(8&t){const n=e.child;if(null!==n)return Dv(i,n);{const r=i[e.index];return zo(r)?l1(-1,r):kr(r)}}if(32&t)return JM(e,i)()||kr(i[e.index]);{const n=Rk(i,e);return null!==n?Array.isArray(n)?n[0]:Dv(Hg(i[16]),n):Dv(i,e.next)}}return null}function Rk(i,e){return null!==e?i[16][6].projection[e.projection]:null}function l1(i,e){const t=10+i+1;if(t<e.length){const n=e[t],r=n[1].firstChild;if(null!==r)return Dv(n,r)}return e[7]}function d1(i,e,t,n,r,s,o){for(;null!=t;){const a=n[t.index],l=t.type;if(o&&0===e&&(a&&Hr(kr(a),n),t.flags|=2),32!=(32&t.flags))if(8&l)d1(i,e,t.child,n,r,s,!1),Sh(e,i,r,a,s);else if(32&l){const c=JM(t,n);let d;for(;d=c();)Sh(e,i,r,d,s);Sh(e,i,r,a,s)}else 16&l?Dk(i,e,n,t,r,s):Sh(e,i,r,a,s);t=o?t.projectionNext:t.next}}function Gg(i,e,t,n,r,s){d1(t,n,i.firstChild,e,r,s,!1)}function Dk(i,e,t,n,r,s){const o=t[16],l=o[6].projection[n.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Sh(e,i,r,l[c],s);else d1(i,e,l,o[3],r,s,!0)}function Pk(i,e,t){""===t?i.removeAttribute(e,"class"):i.setAttribute(e,"class",t)}function kk(i,e,t){const{mergedAttrs:n,classes:r,styles:s}=t;null!==n&&LM(i,e,n),null!==r&&Pk(i,e,r),null!==s&&function OW(i,e,t){i.setAttribute(e,"style",t)}(i,e,s)}function bd(i){return function u1(){if(void 0===Pv&&(Pv=null,en.trustedTypes))try{Pv=en.trustedTypes.createPolicy("angular",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch{}return Pv}()?.createHTML(i)||i}function Ok(i){return function f1(){if(void 0===kv&&(kv=null,en.trustedTypes))try{kv=en.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch{}return kv}()?.createScriptURL(i)||i}class vd{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${tv})`}}class zW extends vd{getTypeName(){return"HTML"}}class HW extends vd{getTypeName(){return"Style"}}class GW extends vd{getTypeName(){return"Script"}}class QW extends vd{getTypeName(){return"URL"}}class WW extends vd{getTypeName(){return"ResourceURL"}}function zs(i){return i instanceof vd?i.changingThisBreaksApplicationSecurity:i}function ba(i,e){const t=function qW(i){return i instanceof vd&&i.getTypeName()||null}(i);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${tv})`)}return t===e}class JW{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(bd(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class e7{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const n=this.inertDocument.createElement("body");t.appendChild(n)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=bd(e),t;const n=this.inertDocument.createElement("body");return n.innerHTML=bd(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(e){const t=e.attributes;for(let r=t.length-1;0<r;r--){const o=t.item(r).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&e.removeAttribute(o)}let n=e.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const n7=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function Fv(i){return(i=String(i)).match(n7)?i:"unsafe:"+i}function al(i){const e={};for(const t of i.split(","))e[t]=!0;return e}function Qg(...i){const e={};for(const t of i)for(const n in t)t.hasOwnProperty(n)&&(e[n]=!0);return e}const jk=al("area,br,col,hr,img,wbr"),Uk=al("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Vk=al("rp,rt"),p1=Qg(jk,Qg(Uk,al("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Qg(Vk,al("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Qg(Vk,Uk)),m1=al("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),zk=Qg(m1,al("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),al("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),r7=al("script,style,template");class s7{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!p1.hasOwnProperty(t))return this.sanitizedSomething=!0,!r7.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let r=0;r<n.length;r++){const s=n.item(r),o=s.name,a=o.toLowerCase();if(!zk.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;m1[a]&&(l=Fv(l)),this.buf.push(" ",o,'="',Hk(l),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();p1.hasOwnProperty(t)&&!jk.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(Hk(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const o7=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,a7=/([^\#-~ |!])/g;function Hk(i){return i.replace(/&/g,"&amp;").replace(o7,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(a7,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Bv;function Gk(i,e){let t=null;try{Bv=Bv||function Nk(i){const e=new e7(i);return function t7(){try{return!!(new window.DOMParser).parseFromString(bd(""),"text/html")}catch{return!1}}()?new JW(e):e}(i);let n=e?String(e):"";t=Bv.getInertBodyElement(n);let r=5,s=n;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,n=s,s=t.innerHTML,t=Bv.getInertBodyElement(n)}while(n!==s);return bd((new s7).sanitizeChildren(g1(t)||t))}finally{if(t){const n=g1(t)||t;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function g1(i){return"content"in i&&function l7(i){return i.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===i.nodeName}(i)?i.content:null}var Ri=(()=>((Ri=Ri||{})[Ri.NONE=0]="NONE",Ri[Ri.HTML=1]="HTML",Ri[Ri.STYLE=2]="STYLE",Ri[Ri.SCRIPT=3]="SCRIPT",Ri[Ri.URL=4]="URL",Ri[Ri.RESOURCE_URL=5]="RESOURCE_URL",Ri))();function Qk(i){const e=Wg();return e?e.sanitize(Ri.URL,i)||"":ba(i,"URL")?zs(i):Fv(Xt(i))}function Wk(i){const e=Wg();if(e)return Ok(e.sanitize(Ri.RESOURCE_URL,i)||"");if(ba(i,"ResourceURL"))return Ok(zs(i));throw new Me(904,!1)}function Wg(){const i=Le();return i&&i[12]}const Lv=new Fe("ENVIRONMENT_INITIALIZER"),Xk=new Fe("INJECTOR",-1),Yk=new Fe("INJECTOR_DEF_TYPES");class Zk{get(e,t=Mg){if(t===Mg){const n=new Error(`NullInjectorError: No provider for ${Ji(e)}!`);throw n.name="NullInjectorError",n}return t}}function g7(...i){return{\u0275providers:Kk(0,i),\u0275fromNgModule:!0}}function Kk(i,...e){const t=[],n=new Set;let r;return gd(e,s=>{const o=s;_1(o,t,[],n)&&(r||(r=[]),r.push(o))}),void 0!==r&&$k(r,t),t}function $k(i,e){for(let t=0;t<i.length;t++){const{providers:r}=i[t];b1(r,s=>{e.push(s)})}}function _1(i,e,t,n){if(!(i=Nt(i)))return!1;let r=null,s=eP(i);const o=!s&&Ui(i);if(s||o){if(o&&!o.standalone)return!1;r=i}else{const l=i.ngModule;if(s=eP(l),!s)return!1;r=l}const a=n.has(r);if(o){if(a)return!1;if(n.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)_1(c,e,t,n)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;n.add(r);try{gd(s.imports,d=>{_1(d,e,t,n)&&(c||(c=[]),c.push(d))})}finally{}void 0!==c&&$k(c,e)}if(!a){const c=fd(r)||(()=>new r);e.push({provide:r,useFactory:c,deps:Bi},{provide:Yk,useValue:r,multi:!0},{provide:Lv,useValue:()=>ye(r),multi:!0})}const l=s.providers;null==l||a||b1(l,d=>{e.push(d)})}}return r!==i&&void 0!==i.providers}function b1(i,e){for(let t of i)mM(t)&&(t=t.\u0275providers),Array.isArray(t)?b1(t,e):e(t)}const _7=Yi({provide:String,useValue:Yi});function v1(i){return null!==i&&"object"==typeof i&&_7 in i}function yd(i){return"function"==typeof i}const y1=new Fe("Set Injector scope."),Ov={},v7={};let A1;function Nv(){return void 0===A1&&(A1=new Zk),A1}class va{}class tF extends va{get destroyed(){return this._destroyed}constructor(e,t,n,r){super(),this.parent=t,this.source=n,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,w1(e,o=>this.processProvider(o)),this.records.set(Xk,Th(void 0,this)),r.has("environment")&&this.records.set(va,Th(void 0,this));const s=this.records.get(y1);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Yk.multi,Bi,jt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}runInContext(e){this.assertNotDestroyed();const t=dh(this),n=ho(void 0);try{return e()}finally{dh(t),ho(n)}}get(e,t=Mg,n=jt.Default){this.assertNotDestroyed(),n=av(n);const r=dh(this),s=ho(void 0);try{if(!(n&jt.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function C7(i){return"function"==typeof i||"object"==typeof i&&i instanceof Fe}(e)&&rv(e);a=l&&this.injectableDefInScope(l)?Th(x1(e),Ov):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(n&jt.Self?Nv():this.parent).get(e,t=n&jt.Optional&&t===Mg?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[ov]=o[ov]||[]).unshift(Ji(e)),r)throw o;return function XQ(i,e,t,n){const r=i[ov];throw e[nP]&&r.unshift(e[nP]),i.message=function YQ(i,e,t,n=null){i=i&&"\n"===i.charAt(0)&&"\u0275"==i.charAt(1)?i.slice(2):i;let r=Ji(e);if(Array.isArray(e))r=e.map(Ji).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Ji(a)))}r=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${r}]: ${i.replace(GQ,"\n  ")}`}("\n"+i.message,r,t,n),i.ngTokenPath=r,i[ov]=null,i}(o,e,"R3InjectorError",this.source)}throw o}finally{ho(s),dh(r)}}resolveInjectorInitializers(){const e=dh(this),t=ho(void 0);try{const n=this.get(Lv.multi,Bi,jt.Self);for(const r of n)r()}finally{dh(e),ho(t)}}toString(){const e=[],t=this.records;for(const n of t.keys())e.push(Ji(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Me(205,!1)}processProvider(e){let t=yd(e=Nt(e))?e:Nt(e&&e.provide);const n=function A7(i){return v1(i)?Th(void 0,i.useValue):Th(iF(i),Ov)}(e);if(yd(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=Th(void 0,Ov,!0),r.factory=()=>vM(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,n)}hydrate(e,t){return t.value===Ov&&(t.value=v7,t.value=t.factory()),"object"==typeof t.value&&t.value&&function w7(i){return null!==i&&"object"==typeof i&&"function"==typeof i.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Nt(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}}function x1(i){const e=rv(i),t=null!==e?e.factory:fd(i);if(null!==t)return t;if(i instanceof Fe)throw new Me(204,!1);if(i instanceof Function)return function y7(i){const e=i.length;if(e>0)throw jg(e,"?"),new Me(204,!1);const t=function jQ(i){const e=i&&(i[sv]||i[tP]);if(e){const t=function UQ(i){if(i.hasOwnProperty("name"))return i.name;const e=(""+i).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(i);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(i);return null!==t?()=>t.factory(i):()=>new i}(i);throw new Me(204,!1)}function iF(i,e,t){let n;if(yd(i)){const r=Nt(i);return fd(r)||x1(r)}if(v1(i))n=()=>Nt(i.useValue);else if(function eF(i){return!(!i||!i.useFactory)}(i))n=()=>i.useFactory(...vM(i.deps||[]));else if(function Jk(i){return!(!i||!i.useExisting)}(i))n=()=>ye(Nt(i.useExisting));else{const r=Nt(i&&(i.useClass||i.provide));if(!function x7(i){return!!i.deps}(i))return fd(r)||x1(r);n=()=>new r(...vM(i.deps))}return n}function Th(i,e,t=!1){return{factory:i,value:e,multi:t?[]:void 0}}function w1(i,e){for(const t of i)Array.isArray(t)?w1(t,e):t&&mM(t)?w1(t.\u0275providers,e):e(t)}class M7{}class nF{}class S7{resolveComponentFactory(e){throw function E7(i){const e=Error(`No component factory found for ${Ji(i)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=i,e}(e)}}let Yl=(()=>{class i{}return i.NULL=new S7,i})();function T7(){return Ih(Fr(),Le())}function Ih(i,e){return new Ht(js(i,e))}let Ht=(()=>{class i{constructor(t){this.nativeElement=t}}return i.__NG_ELEMENT_ID__=T7,i})();function I7(i){return i instanceof Ht?i.nativeElement:i}class qg{}let ll=(()=>{class i{}return i.__NG_ELEMENT_ID__=()=>function R7(){const i=Le(),t=Us(Fr().index,i);return(Ns(t)?t:i)[11]}(),i})(),D7=(()=>{class i{}return i.\u0275prov=Ne({token:i,providedIn:"root",factory:()=>null}),i})();class Ad{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const P7=new Ad("15.1.1"),C1={};function E1(i){return i.ngOriginalError}class cl{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&E1(e);for(;t&&E1(t);)t=E1(t);return t||null}}function S1(i){return i.ownerDocument.defaultView}function jv(i){return i.ownerDocument}function dl(i){return i instanceof Function?i():i}function oF(i,e,t){let n=i.length;for(;;){const r=i.indexOf(e,t);if(-1===r)return r;if(0===r||i.charCodeAt(r-1)<=32){const s=e.length;if(r+s===n||i.charCodeAt(r+s)<=32)return r}t=r+1}}const aF="ng-template";function V7(i,e,t){let n=0;for(;n<i.length;){let r=i[n++];if(t&&"class"===r){if(r=i[n],-1!==oF(r.toLowerCase(),e,0))return!0}else if(1===r){for(;n<i.length&&"string"==typeof(r=i[n++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function lF(i){return 4===i.type&&i.value!==aF}function z7(i,e,t){return e===(4!==i.type||t?i.value:aF)}function H7(i,e,t){let n=4;const r=i.attrs||[],s=function W7(i){for(let e=0;e<i.length;e++)if(LP(i[e]))return e;return i.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&n){if(n=2|1&n,""!==l&&!z7(i,l,t)||""===l&&1===e.length){if(Go(n))return!1;o=!0}}else{const c=8&n?l:e[++a];if(8&n&&null!==i.attrs){if(!V7(i.attrs,c,t)){if(Go(n))return!1;o=!0}continue}const u=G7(8&n?"class":l,r,lF(i),t);if(-1===u){if(Go(n))return!1;o=!0;continue}if(""!==c){let h;h=u>s?"":r[u+1].toLowerCase();const f=8&n?h:null;if(f&&-1!==oF(f,c,0)||2&n&&c!==h){if(Go(n))return!1;o=!0}}}}else{if(!o&&!Go(n)&&!Go(l))return!1;if(o&&Go(l))continue;o=!1,n=l|1&n}}return Go(n)||o}function Go(i){return 0==(1&i)}function G7(i,e,t,n){if(null===e)return-1;let r=0;if(n||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===i)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function q7(i,e){let t=i.indexOf(4);if(t>-1)for(t++;t<i.length;){const n=i[t];if("number"==typeof n)return-1;if(n===e)return t;t++}return-1}(e,i)}function cF(i,e,t=!1){for(let n=0;n<e.length;n++)if(H7(i,e[n],t))return!0;return!1}function X7(i,e){e:for(let t=0;t<e.length;t++){const n=e[t];if(i.length===n.length){for(let r=0;r<i.length;r++)if(i[r]!==n[r])continue e;return!0}}return!1}function dF(i,e){return i?":not("+e.trim()+")":e}function Y7(i){let e=i[0],t=1,n=2,r="",s=!1;for(;t<i.length;){let o=i[t];if("string"==typeof o)if(2&n){const a=i[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&n?r+="."+o:4&n&&(r+=" "+o);else""!==r&&!Go(o)&&(e+=dF(s,r),r=""),n=o,s=s||!Go(n);t++}return""!==r&&(e+=dF(s,r)),e}const Zt={};function oe(i){uF(Ti(),Le(),ts()+i,!1)}function uF(i,e,t,n){if(!n)if(3==(3&e[2])){const s=i.preOrderCheckHooks;null!==s&&_v(e,s,t)}else{const s=i.preOrderHooks;null!==s&&bv(e,s,0,t)}pd(t)}function mF(i,e=null,t=null,n){const r=gF(i,e,t,n);return r.resolveInjectorInitializers(),r}function gF(i,e=null,t=null,n,r=new Set){const s=[t||Bi,g7(i)];return n=n||("object"==typeof i?void 0:Ji(i)),new tF(s,e||Nv(),n||null,r)}let _s=(()=>{class i{static create(t,n){if(Array.isArray(t))return mF({name:""},n,t,"");{const r=t.name??"";return mF({name:r},t.parent,t.providers,r)}}}return i.THROW_IF_NOT_FOUND=Mg,i.NULL=new Zk,i.\u0275prov=Ne({token:i,providedIn:"any",factory:()=>ye(Xk)}),i.__NG_ELEMENT_ID__=-1,i})();function R(i,e=jt.Default){const t=Le();return null===t?ye(i,e):QP(Fr(),t,Nt(i),e)}function Xg(){throw new Error("invalid")}function wF(i,e){const t=i.contentQueries;if(null!==t)for(let n=0;n<t.length;n+=2){const s=t[n+1];if(-1!==s){const o=i.data[s];DM(t[n]),o.contentQueries(2,e[s],s)}}}function Vv(i,e,t,n,r,s,o,a,l,c,d){const u=e.blueprint.slice();return u[0]=r,u[2]=76|n,(null!==d||i&&1024&i[2])&&(u[2]|=1024),yP(u),u[3]=u[15]=i,u[8]=t,u[10]=o||i&&i[10],u[11]=a||i&&i[11],u[12]=l||i&&i[12]||null,u[9]=c||i&&i[9]||null,u[6]=s,u[20]=function uW(){return dW++}(),u[21]=d,u[16]=2==e.type?i[16]:u,u}function Ph(i,e,t,n,r){let s=i.data[e];if(null===s)s=function P1(i,e,t,n,r){const s=wP(),o=SM(),l=i.data[e]=function A9(i,e,t,n,r,s){return{type:t,index:n,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,n,r);return null===i.firstChild&&(i.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(i,e,t,n,r),function _6(){return Yt.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=n,s.attrs=r;const o=function kg(){const i=Yt.lFrame,e=i.currentTNode;return i.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return ga(s,!0),s}function Yg(i,e,t,n){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(n),i.blueprint.push(n),i.data.push(null);return r}function k1(i,e,t){PM(e);try{const n=i.viewQuery;null!==n&&H1(1,n,t);const r=i.template;null!==r&&CF(i,e,r,1,t),i.firstCreatePass&&(i.firstCreatePass=!1),i.staticContentQueries&&wF(i,e),i.staticViewQueries&&H1(2,i.viewQuery,t);const s=i.components;null!==s&&function b9(i,e){for(let t=0;t<e.length;t++)U9(i,e[t])}(e,s)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{e[2]&=-5,kM()}}function zv(i,e,t,n){const r=e[2];if(128!=(128&r)){PM(e);try{yP(e),function MP(i){return Yt.lFrame.bindingIndex=i}(i.bindingStartIndex),null!==t&&CF(i,e,t,2,n);const o=3==(3&r);if(o){const c=i.preOrderCheckHooks;null!==c&&_v(e,c,null)}else{const c=i.preOrderHooks;null!==c&&bv(e,c,0,null),FM(e,0)}if(function N9(i){for(let e=e1(i);null!==e;e=t1(e)){if(!e[2])continue;const t=e[9];for(let n=0;n<t.length;n++){const r=t[n];512&r[2]||EM(r[3],1),r[2]|=512}}}(e),function O9(i){for(let e=e1(i);null!==e;e=t1(e))for(let t=10;t<e.length;t++){const n=e[t],r=n[1];mv(n)&&zv(r,n,r.template,n[8])}}(e),null!==i.contentQueries&&wF(i,e),o){const c=i.contentCheckHooks;null!==c&&_v(e,c)}else{const c=i.contentHooks;null!==c&&bv(e,c,1),FM(e,1)}!function g9(i,e){const t=i.hostBindingOpCodes;if(null!==t)try{for(let n=0;n<t.length;n++){const r=t[n];if(r<0)pd(~r);else{const s=r,o=t[++n],a=t[++n];b6(o,s),a(2,e[s])}}}finally{pd(-1)}}(i,e);const a=i.components;null!==a&&function _9(i,e){for(let t=0;t<e.length;t++)j9(i,e[t])}(e,a);const l=i.viewQuery;if(null!==l&&H1(2,l,n),o){const c=i.viewCheckHooks;null!==c&&_v(e,c)}else{const c=i.viewHooks;null!==c&&bv(e,c,2),FM(e,2)}!0===i.firstUpdatePass&&(i.firstUpdatePass=!1),e[2]&=-41,512&e[2]&&(e[2]&=-513,EM(e[3],-1))}finally{kM()}}}function CF(i,e,t,n,r){const s=ts(),o=2&n;try{pd(-1),o&&e.length>22&&uF(i,e,22,!1),t(n,r)}finally{pd(s)}}function F1(i,e,t){if(CM(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=i.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}function B1(i,e,t){xP()&&(function S9(i,e,t,n){const r=t.directiveStart,s=t.directiveEnd;Pg(t)&&function F9(i,e,t){const n=js(e,i),r=MF(t),s=i[10],o=Hv(i,Vv(i,r,null,t.onPush?32:16,n,e,s,s.createRenderer(n,t),null,null,null));i[e.index]=o}(e,t,i.data[r+t.componentOffset]),i.firstCreatePass||xv(t,e),Hr(n,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=i.data[a],c=md(e,i,a,t);Hr(c,e),null!==o&&B9(0,a-r,c,l,0,o),Ho(l)&&(Us(t.index,e)[8]=md(e,i,a,t))}}(i,e,t,js(t,e)),64==(64&t.flags)&&DF(i,e,t))}function L1(i,e,t=js){const n=e.localNames;if(null!==n){let r=e.index+1;for(let s=0;s<n.length;s+=2){const o=n[s+1],a=-1===o?t(e,i):i[o];i[r++]=a}}}function MF(i){const e=i.tView;return null===e||e.incompleteFirstPass?i.tView=O1(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts):e}function O1(i,e,t,n,r,s,o,a,l,c){const d=22+n,u=d+r,h=function v9(i,e){const t=[];for(let n=0;n<e;n++)t.push(n<i?null:Zt);return t}(d,u),f="function"==typeof c?c():c;return h[1]={type:i,blueprint:h,template:t,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:u,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function EF(i,e,t,n){const r=kF(e);null===t?r.push(n):(r.push(t),i.firstCreatePass&&FF(i).push(n,r.length-1))}function SF(i,e,t,n){for(let r in i)if(i.hasOwnProperty(r)){t=null===t?{}:t;const s=i[r];null===n?TF(t,e,r,s):n.hasOwnProperty(r)&&TF(t,e,n[r],s)}return t}function TF(i,e,t,n){i.hasOwnProperty(t)?i[t].push(e,n):i[t]=[e,n]}function Hs(i,e,t,n,r,s,o,a){const l=js(e,t);let d,c=e.inputs;!a&&null!=c&&(d=c[n])?(G1(i,t,d,n,r),Pg(e)&&IF(t,e.index)):3&e.type&&(n=function w9(i){return"class"===i?"className":"for"===i?"htmlFor":"formaction"===i?"formAction":"innerHtml"===i?"innerHTML":"readonly"===i?"readOnly":"tabindex"===i?"tabIndex":i}(n),r=null!=o?o(r,e.value||"",n):r,s.setProperty(l,n,r))}function IF(i,e){const t=Us(e,i);16&t[2]||(t[2]|=32)}function N1(i,e,t,n){let r=!1;if(xP()){const s=null===n?null:{"":-1},o=function I9(i,e){const t=i.directiveRegistry;let n=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(cF(e,o.selectors,!1))if(n||(n=[]),Ho(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),n.unshift(...a,o),j1(i,e,a.length)}else n.unshift(o),j1(i,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,n,r),n.push(o)}return null===n?null:[n,r]}(i,t);let a,l;null===o?a=l=null:[a,l]=o,null!==a&&(r=!0,RF(i,e,t,a,s,l)),s&&function R9(i,e,t){if(e){const n=i.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new Me(-301,!1);n.push(e[r],s)}}}(t,n,s)}return t.mergedAttrs=Bg(t.mergedAttrs,t.attrs),r}function RF(i,e,t,n,r,s){for(let c=0;c<n.length;c++)UM(xv(t,e),i,n[c].type);!function P9(i,e,t){i.flags|=1,i.directiveStart=e,i.directiveEnd=e+t,i.providerIndexes=e}(t,i.data.length,n.length);for(let c=0;c<n.length;c++){const d=n[c];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,l=Yg(i,e,n.length,null);for(let c=0;c<n.length;c++){const d=n[c];t.mergedAttrs=Bg(t.mergedAttrs,d.hostAttrs),k9(i,t,e,l,d),D9(l,d,r),null!==d.contentQueries&&(t.flags|=4),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(t.flags|=64);const u=d.type.prototype;!o&&(u.ngOnChanges||u.ngOnInit||u.ngDoCheck)&&((i.preOrderHooks||(i.preOrderHooks=[])).push(t.index),o=!0),!a&&(u.ngOnChanges||u.ngDoCheck)&&((i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(t.index),a=!0),l++}!function x9(i,e,t){const r=e.directiveEnd,s=i.data,o=e.attrs,a=[];let l=null,c=null;for(let d=e.directiveStart;d<r;d++){const u=s[d],h=t?t.get(u):null,m=h?h.outputs:null;l=SF(u.inputs,d,l,h?h.inputs:null),c=SF(u.outputs,d,c,m);const p=null===l||null===o||lF(e)?null:L9(l,d,o);a.push(p)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}(i,t,s)}function DF(i,e,t){const n=t.directiveStart,r=t.directiveEnd,s=t.index,o=function v6(){return Yt.lFrame.currentDirectiveIndex}();try{pd(s);for(let a=n;a<r;a++){const l=i.data[a],c=e[a];IM(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&T9(l,c)}}finally{pd(-1),IM(o)}}function T9(i,e){null!==i.hostBindings&&i.hostBindings(1,e)}function j1(i,e,t){e.componentOffset=t,(i.components||(i.components=[])).push(e.index)}function D9(i,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=i;Ho(e)&&(t[""]=i)}}function k9(i,e,t,n,r){i.data[n]=r;const s=r.factory||(r.factory=fd(r.type)),o=new Fg(s,Ho(r),R);i.blueprint[n]=o,t[n]=o,function M9(i,e,t,n,r){const s=r.hostBindings;if(s){let o=i.hostBindingOpCodes;null===o&&(o=i.hostBindingOpCodes=[]);const a=~e.index;(function E9(i){let e=i.length;for(;e>0;){const t=i[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,n,s)}}(i,e,n,Yg(i,t,r.hostVars,Zt),r)}function ya(i,e,t,n,r,s){const o=js(i,e);!function U1(i,e,t,n,r,s,o){if(null==s)i.removeAttribute(e,r,t);else{const a=null==o?Xt(s):o(s,n||"",r);i.setAttribute(e,r,a,t)}}(e[11],o,s,i.value,t,n,r)}function B9(i,e,t,n,r,s){const o=s[e];if(null!==o){const a=n.setInput;for(let l=0;l<o.length;){const c=o[l++],d=o[l++],u=o[l++];null!==a?n.setInput(t,u,c,d):t[d]=u}}}function L9(i,e,t){let n=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(i.hasOwnProperty(s)){null===n&&(n=[]);const o=i[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){n.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return n}function PF(i,e,t,n){return[i,!0,!1,e,null,0,n,t,null,null]}function j9(i,e){const t=Us(e,i);if(mv(t)){const n=t[1];48&t[2]?zv(n,t,n.template,t[8]):t[5]>0&&V1(t)}}function V1(i){for(let n=e1(i);null!==n;n=t1(n))for(let r=10;r<n.length;r++){const s=n[r];if(mv(s))if(512&s[2]){const o=s[1];zv(o,s,o.template,s[8])}else s[5]>0&&V1(s)}const t=i[1].components;if(null!==t)for(let n=0;n<t.length;n++){const r=Us(t[n],i);mv(r)&&r[5]>0&&V1(r)}}function U9(i,e){const t=Us(e,i),n=t[1];(function V9(i,e){for(let t=e.length;t<i.blueprint.length;t++)e.push(i.blueprint[t])})(n,t),k1(n,t,t[8])}function Hv(i,e){return i[13]?i[14][4]=e:i[13]=e,i[14]=e,e}function z1(i){for(;i;){i[2]|=32;const e=Hg(i);if(JQ(i)&&!e)return i;i=e}return null}function Gv(i,e,t,n=!0){const r=e[10];r.begin&&r.begin();try{zv(i,e,i.template,t)}catch(o){throw n&&LF(e,o),o}finally{r.end&&r.end()}}function H1(i,e,t){DM(0),e(i,t)}function kF(i){return i[7]||(i[7]=[])}function FF(i){return i.cleanup||(i.cleanup=[])}function BF(i,e,t){return(null===i||Ho(i))&&(t=function a6(i){for(;Array.isArray(i);){if("object"==typeof i[1])return i;i=i[0]}return null}(t[e.index])),t[11]}function LF(i,e){const t=i[9],n=t?t.get(cl,null):null;n&&n.handleError(e)}function G1(i,e,t,n,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=i.data[o];null!==c.setInput?c.setInput(l,r,n,a):l[a]=r}}function Qv(i,e,t){let n=t?i.styles:null,r=t?i.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=fM(r,a):2==s&&(n=fM(n,a+": "+e[++o]+";"))}t?i.styles=n:i.stylesWithoutHost=n,t?i.classes=r:i.classesWithoutHost=r}function Wv(i,e,t,n,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&n.push(kr(s)),zo(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&Wv(l[1],l,c,n)}const o=t.type;if(8&o)Wv(i,e,t.child,n);else if(32&o){const a=JM(t,e);let l;for(;l=a();)n.push(l)}else if(16&o){const a=Rk(e,t);if(Array.isArray(a))n.push(...a);else{const l=Hg(e[16]);Wv(l[1],l,a,n,!0)}}t=r?t.projectionNext:t.next}return n}class Zg{get rootNodes(){const e=this._lView,t=e[1];return Wv(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(zo(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(s1(e,n),Cv(t,n))}this._attachedToViewContainer=!1}Ak(this._lView[1],this._lView)}onDestroy(e){EF(this._lView[1],this._lView,null,e)}markForCheck(){z1(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){Gv(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Me(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function EW(i,e){Gg(i,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Me(902,!1);this._appRef=e}}class z9 extends Zg{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Gv(e[1],e,e[8],!1)}checkNoChanges(){}get context(){return null}}class OF extends Yl{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Ui(e);return new Kg(t,this.ngModule)}}function NF(i){const e=[];for(let t in i)i.hasOwnProperty(t)&&e.push({propName:i[t],templateName:t});return e}class G9{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=av(n);const r=this.injector.get(e,C1,n);return r!==C1||t===C1?r:this.parentInjector.get(e,t,n)}}class Kg extends nF{get inputs(){return NF(this.componentDef.inputs)}get outputs(){return NF(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function Z7(i){return i.map(Y7).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,n,r){let s=(r=r||this.ngModule)instanceof va?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new G9(e,s):e,a=o.get(qg,null);if(null===a)throw new Me(407,!1);const l=o.get(D7,null),c=a.createRenderer(null,this.componentDef),d=this.componentDef.selectors[0][0]||"div",u=n?function y9(i,e,t){return i.selectRootElement(e,t===Uo.ShadowDom)}(c,n,this.componentDef.encapsulation):r1(c,d,function H9(i){const e=i.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(d)),h=this.componentDef.onPush?288:272,f=O1(0,null,null,1,0,null,null,null,null,null),m=Vv(null,f,null,h,null,null,a,c,l,o,null);let p,g;PM(m);try{const _=this.componentDef;let v,b=null;_.findHostDirectiveDefs?(v=[],b=new Map,_.findHostDirectiveDefs(_,v,b),v.push(_)):v=[_];const y=function W9(i,e){const t=i[1];return i[22]=e,Ph(t,22,2,"#host",null)}(m,u),x=function q9(i,e,t,n,r,s,o,a){const l=r[1];!function X9(i,e,t,n){for(const r of i)e.mergedAttrs=Bg(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(Qv(e,e.mergedAttrs,!0),null!==t&&kk(n,t,e))}(n,i,e,o);const c=s.createRenderer(e,t),d=Vv(r,MF(t),null,t.onPush?32:16,r[i.index],i,s,c,a||null,null,null);return l.firstCreatePass&&j1(l,i,n.length-1),Hv(r,d),r[i.index]=d}(y,u,_,v,m,a,c);g=vP(f,22),u&&function Z9(i,e,t,n){if(n)LM(i,t,["ng-version",P7.full]);else{const{attrs:r,classes:s}=function K7(i){const e=[],t=[];let n=1,r=2;for(;n<i.length;){let s=i[n];if("string"==typeof s)2===r?""!==s&&e.push(s,i[++n]):8===r&&t.push(s);else{if(!Go(r))break;r=s}n++}return{attrs:e,classes:t}}(e.selectors[0]);r&&LM(i,t,r),s&&s.length>0&&Pk(i,t,s.join(" "))}}(c,_,u,n),void 0!==t&&function K9(i,e,t){const n=i.projection=[];for(let r=0;r<e.length;r++){const s=t[r];n.push(null!=s?Array.from(s):null)}}(g,this.ngContentSelectors,t),p=function Y9(i,e,t,n,r,s){const o=Fr(),a=r[1],l=js(o,r);RF(a,r,o,t,null,n);for(let d=0;d<t.length;d++)Hr(md(r,a,o.directiveStart+d,o),r);DF(a,r,o),l&&Hr(l,r);const c=md(r,a,o.directiveStart+o.componentOffset,o);if(i[8]=r[8]=c,null!==s)for(const d of s)d(c,e);return F1(a,o,i),c}(x,_,v,b,m,[$9]),k1(f,m,null)}finally{kM()}return new Q9(this.componentType,p,Ih(g,m),m,g)}}class Q9 extends M7{constructor(e,t,n,r,s){super(),this.location=n,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new z9(r),this.componentType=e}setInput(e,t){const n=this._tNode.inputs;let r;if(null!==n&&(r=n[e])){const s=this._rootLView;G1(s[1],s,r,e,t),IF(s,this._tNode.index)}}get injector(){return new vh(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function $9(){const i=Fr();gv(Le()[1],i)}function W(i){let e=function jF(i){return Object.getPrototypeOf(i.prototype).constructor}(i.type),t=!0;const n=[i];for(;e;){let r;if(Ho(i))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Me(903,!1);r=e.\u0275dir}if(r){if(t){n.push(r);const o=i;o.inputs=Q1(i.inputs),o.declaredInputs=Q1(i.declaredInputs),o.outputs=Q1(i.outputs);const a=r.hostBindings;a&&iq(i,a);const l=r.viewQuery,c=r.contentQueries;if(l&&eq(i,l),c&&tq(i,c),hM(i.inputs,r.inputs),hM(i.declaredInputs,r.declaredInputs),hM(i.outputs,r.outputs),Ho(r)&&r.data.animation){const d=i.data;d.animation=(d.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(i),a===W&&(t=!1)}}e=Object.getPrototypeOf(e)}!function J9(i){let e=0,t=null;for(let n=i.length-1;n>=0;n--){const r=i[n];r.hostVars=e+=r.hostVars,r.hostAttrs=Bg(r.hostAttrs,t=Bg(t,r.hostAttrs))}}(n)}function Q1(i){return i===tl?{}:i===Bi?[]:i}function eq(i,e){const t=i.viewQuery;i.viewQuery=t?(n,r)=>{e(n,r),t(n,r)}:e}function tq(i,e){const t=i.contentQueries;i.contentQueries=t?(n,r,s)=>{e(n,r,s),t(n,r,s)}:e}function iq(i,e){const t=i.hostBindings;i.hostBindings=t?(n,r)=>{e(n,r),t(n,r)}:e}let qv=null;function xd(){if(!qv){const i=en.Symbol;if(i&&i.iterator)qv=i.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const n=e[t];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(qv=n)}}}return qv}function Xv(i){return!!W1(i)&&(Array.isArray(i)||!(i instanceof Map)&&xd()in i)}function W1(i){return null!==i&&("function"==typeof i||"object"==typeof i)}function Aa(i,e,t){return i[e]=t}function Gr(i,e,t){return!Object.is(i[e],t)&&(i[e]=t,!0)}function wd(i,e,t,n){const r=Gr(i,e,t);return Gr(i,e+1,n)||r}function hn(i,e,t,n){const r=Le();return Gr(r,_h(),e)&&(Ti(),ya(Cn(),r,i,e,t,n)),hn}function Vt(i,e,t,n,r,s,o,a){const l=Le(),c=Ti(),d=i+22,u=c.firstCreatePass?function hq(i,e,t,n,r,s,o,a,l){const c=e.consts,d=Ph(e,i,4,o||null,Xl(c,a));N1(e,t,d,Xl(c,l)),gv(e,d);const u=d.tViews=O1(2,d,n,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,d),u.queries=e.queries.embeddedTView(d)),d}(d,c,l,e,t,n,r,s,o):c.data[d];ga(u,!1);const h=l[11].createComment("");Rv(c,l,h,u),Hr(h,l),Hv(l,l[d]=PF(h,l,h,u)),fv(u)&&B1(c,l,u),null!=o&&L1(l,u,a)}function qt(i){return gh(function g6(){return Yt.lFrame.contextLView}(),22+i)}function K(i,e,t){const n=Le();return Gr(n,_h(),e)&&Hs(Ti(),Cn(),n,i,e,n[11],t,!1),K}function q1(i,e,t,n,r){const o=r?"class":"style";G1(i,t,e.inputs[o],o,n)}function ve(i,e,t,n){const r=Le(),s=Ti(),o=22+i,a=r[11],l=r[o]=r1(a,e,function M6(){return Yt.lFrame.currentNamespace}()),c=s.firstCreatePass?function pq(i,e,t,n,r,s,o){const a=e.consts,c=Ph(e,i,2,r,Xl(a,s));return N1(e,t,c,Xl(a,o)),null!==c.attrs&&Qv(c,c.attrs,!1),null!==c.mergedAttrs&&Qv(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,n):s.data[o];return ga(c,!0),kk(a,l,c),32!=(32&c.flags)&&Rv(s,r,l,c),0===function u6(){return Yt.lFrame.elementDepthCount}()&&Hr(l,r),function h6(){Yt.lFrame.elementDepthCount++}(),fv(c)&&(B1(s,r,c),F1(s,c,r)),null!==n&&L1(r,c),ve}function Ie(){let i=Fr();SM()?TM():(i=i.parent,ga(i,!1));const e=i;!function f6(){Yt.lFrame.elementDepthCount--}();const t=Ti();return t.firstCreatePass&&(gv(t,i),CM(i)&&t.queries.elementEnd(i)),null!=e.classesWithoutHost&&function I6(i){return 0!=(8&i.flags)}(e)&&q1(t,e,Le(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function R6(i){return 0!=(16&i.flags)}(e)&&q1(t,e,Le(),e.stylesWithoutHost,!1),Ie}function ze(i,e,t,n){return ve(i,e,t,n),Ie(),ze}function X1(i,e,t){const n=Le(),r=Ti(),s=i+22,o=r.firstCreatePass?function mq(i,e,t,n,r){const s=e.consts,o=Xl(s,n),a=Ph(e,i,8,"ng-container",o);return null!==o&&Qv(a,o,!0),N1(e,t,a,Xl(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,n,e,t):r.data[s];ga(o,!0);const a=n[s]=n[11].createComment("");return Rv(r,n,a,o),Hr(a,n),fv(o)&&(B1(r,n,o),F1(r,o,n)),null!=t&&L1(n,o),X1}function Y1(){let i=Fr();const e=Ti();return SM()?TM():(i=i.parent,ga(i,!1)),e.firstCreatePass&&(gv(e,i),CM(i)&&e.queries.elementEnd(i)),Y1}function Jg(i,e,t){return X1(i,e,t),Y1(),Jg}function Gs(){return Le()}function e_(i){return!!i&&"function"==typeof i.then}function $F(i){return!!i&&"function"==typeof i.subscribe}const Z1=$F;function mt(i,e,t,n){const r=Le(),s=Ti(),o=Fr();return JF(s,r,r[11],o,i,e,n),mt}function K1(i,e){const t=Fr(),n=Le(),r=Ti();return JF(r,n,BF(RM(r.data),t,n),t,i,e),K1}function JF(i,e,t,n,r,s,o){const a=fv(n),c=i.firstCreatePass&&FF(i),d=e[8],u=kF(e);let h=!0;if(3&n.type||o){const p=js(n,e),g=o?o(p):p,_=u.length,v=o?y=>o(kr(y[n.index])):n.index;let b=null;if(!o&&a&&(b=function gq(i,e,t,n){const r=i.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===n){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(i,e,r,n.index)),null!==b)(b.__ngLastListenerFn__||b).__ngNextListenerFn__=s,b.__ngLastListenerFn__=s,h=!1;else{s=tB(n,e,d,s,!1);const y=t.listen(g,r,s);u.push(s,y),c&&c.push(r,v,_,_+1)}}else s=tB(n,e,d,s,!1);const f=n.outputs;let m;if(h&&null!==f&&(m=f[r])){const p=m.length;if(p)for(let g=0;g<p;g+=2){const x=e[m[g]][m[g+1]].subscribe(s),C=u.length;u.push(s,x),c&&c.push(r,n.index,C,-(C+1))}}}function eB(i,e,t,n){try{return!1!==t(n)}catch(r){return LF(i,r),!1}}function tB(i,e,t,n,r){return function s(o){if(o===Function)return n;z1(i.componentOffset>-1?Us(i.index,e):e);let l=eB(e,0,n,o),c=s.__ngNextListenerFn__;for(;c;)l=eB(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function bi(i=1){return function A6(i){return(Yt.lFrame.contextLView=function x6(i,e){for(;i>0;)e=e[15],i--;return e}(i,Yt.lFrame.contextLView))[8]}(i)}function _q(i,e){let t=null;const n=function Q7(i){const e=i.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(i);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===n?cF(i,s,!0):X7(n,s))return r}else t=r}return t}function Pn(i){const e=Le()[16][6];if(!e.projection){const n=e.projection=jg(i?i.length:1,null),r=n.slice();let s=e.child;for(;null!==s;){const o=i?_q(s,i):0;null!==o&&(r[o]?r[o].projectionNext=s:n[o]=s,r[o]=s),s=s.next}}}function ti(i,e=0,t){const n=Le(),r=Ti(),s=Ph(r,22+i,16,null,t||null);null===s.projection&&(s.projection=e),TM(),32!=(32&s.flags)&&function FW(i,e,t){Dk(e[11],0,e,t,xk(i,t,e),Ek(t.parent||e[6],t,e))}(r,n,s)}function Zv(i,e){return i<<17|e<<2}function Zl(i){return i>>17&32767}function J1(i){return 2|i}function Cd(i){return(131068&i)>>2}function eE(i,e){return-131069&i|e<<2}function tE(i){return 1|i}function uB(i,e,t,n,r){const s=i[t+1],o=null===e;let a=n?Zl(s):Cd(s),l=!1;for(;0!==a&&(!1===l||o);){const d=i[a+1];wq(i[a],e)&&(l=!0,i[a+1]=n?tE(d):J1(d)),a=n?Zl(d):Cd(d)}l&&(i[t+1]=n?J1(s):tE(s))}function wq(i,e){return null===i||null==e||(Array.isArray(i)?i[1]:i)===e||!(!Array.isArray(i)||"string"!=typeof e)&&Ch(i,e)>=0}const hr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function hB(i){return i.substring(hr.key,hr.keyEnd)}function Cq(i){return i.substring(hr.value,hr.valueEnd)}function pB(i,e){const t=hr.textEnd;let n=hr.key=zh(i,e,t);return t===n?-1:(n=hr.keyEnd=function Tq(i,e,t){let n;for(;e<t&&(45===(n=i.charCodeAt(e))||95===n||(-33&n)>=65&&(-33&n)<=90||n>=48&&n<=57);)e++;return e}(i,n,t),n=gB(i,n,t),n=hr.value=zh(i,n,t),n=hr.valueEnd=function Iq(i,e,t){let n=-1,r=-1,s=-1,o=e,a=o;for(;o<t;){const l=i.charCodeAt(o++);if(59===l)return a;34===l||39===l?a=o=_B(i,l,o,t):e===o-4&&85===s&&82===r&&76===n&&40===l?a=o=_B(i,41,o,t):l>32&&(a=o),s=r,r=n,n=-33&l}return a}(i,n,t),gB(i,n,t))}function zh(i,e,t){for(;e<t&&i.charCodeAt(e)<=32;)e++;return e}function gB(i,e,t,n){return(e=zh(i,e,t))<t&&e++,e}function _B(i,e,t,n){let r=-1,s=t;for(;s<n;){const o=i.charCodeAt(s++);if(o==e&&92!==r)return s;r=92==o&&92===r?0:o}throw new Error}function Hh(i,e,t){return Qo(i,e,t,!1),Hh}function Mi(i,e){return Qo(i,e,null,!0),Mi}function go(i){!function Wo(i,e,t,n){const r=Ti(),s=sl(2);r.firstUpdatePass&&vB(r,null,s,n);const o=Le();if(t!==Zt&&Gr(o,s,t)){const a=r.data[ts()];if(wB(a,n)&&!bB(r,s)){let l=n?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=fM(l,t||"")),q1(r,a,o,t,n)}else!function Oq(i,e,t,n,r,s,o,a){r===Zt&&(r=Bi);let l=0,c=0,d=0<r.length?r[0]:null,u=0<s.length?s[0]:null;for(;null!==d||null!==u;){const h=l<r.length?r[l+1]:void 0,f=c<s.length?s[c+1]:void 0;let p,m=null;d===u?(l+=2,c+=2,h!==f&&(m=u,p=f)):null===u||null!==d&&d<u?(l+=2,m=d):(c+=2,m=u,p=f),null!==m&&AB(i,e,t,n,m,p,o,a),d=l<r.length?r[l]:null,u=c<s.length?s[c]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function Lq(i,e,t){if(null==t||""===t)return Bi;const n=[],r=zs(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)i(n,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&i(n,s,r[s]);else"string"==typeof r&&e(n,r);return n}(i,e,t),n,s)}}(yB,Rq,i,!1)}function Rq(i,e){for(let t=function Eq(i){return function mB(i){hr.key=0,hr.keyEnd=0,hr.value=0,hr.valueEnd=0,hr.textEnd=i.length}(i),pB(i,zh(i,0,hr.textEnd))}(e);t>=0;t=pB(e,t))yB(i,hB(e),Cq(e))}function Qo(i,e,t,n){const r=Le(),s=Ti(),o=sl(2);s.firstUpdatePass&&vB(s,i,o,n),e!==Zt&&Gr(r,o,e)&&AB(s,s.data[ts()],r,r[11],i,r[o+1]=function Nq(i,e){return null==i||("string"==typeof e?i+=e:"object"==typeof i&&(i=Ji(zs(i)))),i}(e,t),n,o)}function bB(i,e){return e>=i.expandoStartIndex}function vB(i,e,t,n){const r=i.data;if(null===r[t+1]){const s=r[ts()],o=bB(i,t);wB(s,n)&&null===e&&!o&&(e=!1),e=function Pq(i,e,t,n){const r=RM(i);let s=n?e.residualClasses:e.residualStyles;if(null===r)0===(n?e.classBindings:e.styleBindings)&&(t=t_(t=iE(null,i,e,t,n),e.attrs,n),s=null);else{const o=e.directiveStylingLast;if(-1===o||i[o]!==r)if(t=iE(r,i,e,t,n),null===s){let l=function kq(i,e,t){const n=t?e.classBindings:e.styleBindings;if(0!==Cd(n))return i[Zl(n)]}(i,e,n);void 0!==l&&Array.isArray(l)&&(l=iE(null,i,e,l[1],n),l=t_(l,e.attrs,n),function Fq(i,e,t,n){i[Zl(t?e.classBindings:e.styleBindings)]=n}(i,e,n,l))}else s=function Bq(i,e,t){let n;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)n=t_(n,i[s].hostAttrs,t);return t_(n,e.attrs,t)}(i,e,n)}return void 0!==s&&(n?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,n),function Aq(i,e,t,n,r,s){let o=s?e.classBindings:e.styleBindings,a=Zl(o),l=Cd(o);i[n]=t;let d,c=!1;if(Array.isArray(t)?(d=t[1],(null===d||Ch(t,d)>0)&&(c=!0)):d=t,r)if(0!==l){const h=Zl(i[a+1]);i[n+1]=Zv(h,a),0!==h&&(i[h+1]=eE(i[h+1],n)),i[a+1]=function vq(i,e){return 131071&i|e<<17}(i[a+1],n)}else i[n+1]=Zv(a,0),0!==a&&(i[a+1]=eE(i[a+1],n)),a=n;else i[n+1]=Zv(l,0),0===a?a=n:i[l+1]=eE(i[l+1],n),l=n;c&&(i[n+1]=J1(i[n+1])),uB(i,d,n,!0),uB(i,d,n,!1),function xq(i,e,t,n,r){const s=r?i.residualClasses:i.residualStyles;null!=s&&"string"==typeof e&&Ch(s,e)>=0&&(t[n+1]=tE(t[n+1]))}(e,d,i,n,s),o=Zv(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,n)}}function iE(i,e,t,n,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],n=t_(n,s.hostAttrs,r),s!==i);)a++;return null!==i&&(t.directiveStylingLast=a),n}function t_(i,e,t){const n=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===n&&(Array.isArray(i)||(i=void 0===i?[]:["",i]),Vs(i,o,!!t||e[++s]))}return void 0===i?null:i}function yB(i,e,t){Vs(i,e,zs(t))}function AB(i,e,t,n,r,s,o,a){if(!(3&e.type))return;const l=i.data,c=l[a+1],d=function yq(i){return 1==(1&i)}(c)?xB(l,e,t,r,Cd(c),o):void 0;Kv(d)||(Kv(s)||function bq(i){return 2==(2&i)}(c)&&(s=xB(l,null,t,r,a,o)),function LW(i,e,t,n,r){if(e)r?i.addClass(t,n):i.removeClass(t,n);else{let s=-1===n.indexOf("-")?void 0:ms.DashCase;null==r?i.removeStyle(t,n,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=ms.Important),i.setStyle(t,n,r,s))}}(n,o,pv(ts(),t),r,s))}function xB(i,e,t,n,r,s){const o=null===e;let a;for(;r>0;){const l=i[r],c=Array.isArray(l),d=c?l[1]:l,u=null===d;let h=t[r+1];h===Zt&&(h=u?Bi:void 0);let f=u?GM(h,n):d===n?h:void 0;if(c&&!Kv(f)&&(f=GM(l,n)),Kv(f)&&(a=f,o))return a;const m=i[r+1];r=o?Zl(m):Cd(m)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=GM(l,n))}return a}function Kv(i){return void 0!==i}function wB(i,e){return 0!=(i.flags&(e?8:16))}function qi(i,e=""){const t=Le(),n=Ti(),r=i+22,s=n.firstCreatePass?Ph(n,r,1,e,null):n.data[r],o=t[r]=function n1(i,e){return i.createText(e)}(t[11],e);Rv(n,t,o,s),ga(s,!1)}function $v(i){return Jv("",i,""),$v}function Jv(i,e,t){const n=Le(),r=function Fh(i,e,t,n){return Gr(i,_h(),t)?e+Xt(t)+n:Zt}(n,i,e,t);return r!==Zt&&function ul(i,e,t){const n=pv(e,i);!function vk(i,e,t){i.setValue(e,t)}(i[11],n,t)}(n,ts(),r),Jv}function nE(i,e,t){const n=Le();if(Gr(n,_h(),e)){const s=Ti(),o=Cn();Hs(s,o,n,i,e,BF(RM(s.data),o,n),t,!0)}return nE}const Qh="en-US";let GB=Qh;function oE(i,e,t,n,r){if(i=Nt(i),Array.isArray(i))for(let s=0;s<i.length;s++)oE(i[s],e,t,n,r);else{const s=Ti(),o=Le();let a=yd(i)?i:Nt(i.provide),l=iF(i);const c=Fr(),d=1048575&c.providerIndexes,u=c.directiveStart,h=c.providerIndexes>>20;if(yd(i)||!i.multi){const f=new Fg(l,r,R),m=lE(a,e,r?d:d+h,u);-1===m?(UM(xv(c,o),s,a),aE(s,i,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(f),o.push(f)):(t[m]=f,o[m]=f)}else{const f=lE(a,e,d+h,u),m=lE(a,e,d,d+h),g=m>=0&&t[m];if(r&&!g||!r&&!(f>=0&&t[f])){UM(xv(c,o),s,a);const _=function iY(i,e,t,n,r){const s=new Fg(i,t,R);return s.multi=[],s.index=e,s.componentProviders=0,mL(s,r,n&&!t),s}(r?tY:eY,t.length,r,n,l);!r&&g&&(t[m].providerFactory=_),aE(s,i,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(_),o.push(_)}else aE(s,i,f>-1?f:m,mL(t[r?m:f],l,!r&&n));!r&&n&&g&&t[m].componentProviders++}}}function aE(i,e,t,n){const r=yd(e),s=function b7(i){return!!i.useClass}(e);if(r||s){const l=(s?Nt(e.useClass):e).prototype.ngOnDestroy;if(l){const c=i.destroyHooks||(i.destroyHooks=[]);if(!r&&e.multi){const d=c.indexOf(t);-1===d?c.push(t,[n,l]):c[d+1].push(n,l)}else c.push(t,l)}}}function mL(i,e,t){return t&&i.componentProviders++,i.multi.push(e)-1}function lE(i,e,t,n){for(let r=t;r<n;r++)if(e[r]===i)return r;return-1}function eY(i,e,t,n){return cE(this.multi,[])}function tY(i,e,t,n){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=md(t,t[1],this.providerFactory.index,n);s=a.slice(0,o),cE(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],cE(r,s);return s}function cE(i,e){for(let t=0;t<i.length;t++)e.push((0,i[t])());return e}function se(i,e=[]){return t=>{t.providersResolver=(n,r)=>function JX(i,e,t){const n=Ti();if(n.firstCreatePass){const r=Ho(i);oE(t,n.data,n.blueprint,r,!0),oE(e,n.data,n.blueprint,r,!1)}}(n,r?r(i):i,e)}}class Wh{}class gL{}class _L extends Wh{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new OF(this);const n=Os(e);this._bootstrapComponents=dl(n.bootstrap),this._r3Injector=gF(e,t,[{provide:Wh,useValue:this},{provide:Yl,useValue:this.componentFactoryResolver}],Ji(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class dE extends gL{constructor(e){super(),this.moduleType=e}create(e){return new _L(this.moduleType,e)}}class rY extends Wh{constructor(e,t,n){super(),this.componentFactoryResolver=new OF(this),this.instance=null;const r=new tF([...e,{provide:Wh,useValue:this},{provide:Yl,useValue:this.componentFactoryResolver}],t||Nv(),n,new Set(["environment"]));this.injector=r,r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function ry(i,e,t=null){return new rY(i,e,t).injector}let sY=(()=>{class i{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t.id)){const n=Kk(0,t.type),r=n.length>0?ry([n],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t.id,r)}return this.cachedInjectors.get(t.id)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}}return i.\u0275prov=Ne({token:i,providedIn:"environment",factory:()=>new i(ye(va))}),i})();function uE(i){i.getStandaloneInjector=e=>e.get(sY).getOrCreateStandaloneInjector(i)}function Re(i,e,t){const n=es()+i,r=Le();return r[n]===Zt?Aa(r,n,t?e.call(t):e()):function $g(i,e){return i[e]}(r,n)}function ui(i,e,t,n){return CL(Le(),es(),i,e,t,n)}function wa(i,e,t,n,r){return ML(Le(),es(),i,e,t,n,r)}function Ed(i,e,t,n,r,s){return function EL(i,e,t,n,r,s,o,a){const l=e+t;return function Yv(i,e,t,n,r){const s=wd(i,e,t,n);return Gr(i,e+2,r)||s}(i,l,r,s,o)?Aa(i,l+3,a?n.call(a,r,s,o):n(r,s,o)):l_(i,l+3)}(Le(),es(),i,e,t,n,r,s)}function a_(i,e,t,n,r,s,o){return function SL(i,e,t,n,r,s,o,a,l){const c=e+t;return function mo(i,e,t,n,r,s){const o=wd(i,e,t,n);return wd(i,e+2,r,s)||o}(i,c,r,s,o,a)?Aa(i,c+4,l?n.call(l,r,s,o,a):n(r,s,o,a)):l_(i,c+4)}(Le(),es(),i,e,t,n,r,s,o)}function l_(i,e){const t=i[e];return t===Zt?void 0:t}function CL(i,e,t,n,r,s){const o=e+t;return Gr(i,o,r)?Aa(i,o+1,s?n.call(s,r):n(r)):l_(i,o+1)}function ML(i,e,t,n,r,s,o){const a=e+t;return wd(i,a,r,s)?Aa(i,a+2,o?n.call(o,r,s):n(r,s)):l_(i,a+2)}function fr(i,e){const t=Ti();let n;const r=i+22;t.firstCreatePass?(n=function vY(i,e){if(e)for(let t=e.length-1;t>=0;t--){const n=e[t];if(i===n.name)return n}}(e,t.pipeRegistry),t.data[r]=n,n.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(r,n.onDestroy)):n=t.data[r];const s=n.factory||(n.factory=fd(n.type)),o=ho(R);try{const a=Av(!1),l=s();return Av(a),function fq(i,e,t,n){t>=i.data.length&&(i.data[t]=null,i.blueprint[t]=null),e[t]=n}(t,Le(),r,l),l}finally{ho(o)}}function Er(i,e,t){const n=i+22,r=Le(),s=gh(r,n);return c_(r,n)?CL(r,es(),e,s.transform,t,s):s.transform(t)}function c_(i,e){return i[1].data[e].pure}function fE(i){return e=>{setTimeout(i,void 0,e)}}const Ct=class wY extends Wt{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){let r=e,s=t||(()=>null),o=n;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=fE(s),r&&(r=fE(r)),o&&(o=fE(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof cn&&e.add(a),a}};function CY(){return this._results[xd()]()}class Sd{get changes(){return this._changes||(this._changes=new Ct)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=xd(),n=Sd.prototype;n[t]||(n[t]=CY)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const n=this;n.dirty=!1;const r=function po(i){return i.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function U6(i,e,t){if(i.length!==e.length)return!1;for(let n=0;n<i.length;n++){let r=i[n],s=e[n];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let bs=(()=>{class i{}return i.__NG_ELEMENT_ID__=SY,i})();const MY=bs,EY=class extends MY{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}createEmbeddedView(e,t){const n=this._declarationTContainer.tViews,r=Vv(this._declarationLView,n,e,16,null,n.declTNode,null,null,null,null,t||null);r[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(r[19]=o.createEmbeddedView(n)),k1(n,r,e),new Zg(r)}};function SY(){return sy(Fr(),Le())}function sy(i,e){return 4&i.type?new EY(e,i,Ih(i,e)):null}let Qr=(()=>{class i{}return i.__NG_ELEMENT_ID__=TY,i})();function TY(){return PL(Fr(),Le())}const IY=Qr,RL=class extends IY{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return Ih(this._hostTNode,this._hostLView)}get injector(){return new vh(this._hostTNode,this._hostLView)}get parentInjector(){const e=jM(this._hostTNode,this._hostLView);if(jP(e)){const t=yv(e,this._hostLView),n=vv(e);return new vh(t[1].data[n+8],t)}return new vh(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=DL(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,n){let r,s;"number"==typeof n?r=n:null!=n&&(r=n.index,s=n.injector);const o=e.createEmbeddedView(t||{},s);return this.insert(o,r),o}createComponent(e,t,n,r,s){const o=e&&!function Ng(i){return"function"==typeof i}(e);let a;if(o)a=t;else{const u=t||{};a=u.index,n=u.injector,r=u.projectableNodes,s=u.environmentInjector||u.ngModuleRef}const l=o?e:new Kg(Ui(e)),c=n||this.parentInjector;if(!s&&null==l.ngModule){const h=(o?c:this.parentInjector).get(va,null);h&&(s=h)}const d=l.create(c,r,void 0,s);return this.insert(d.hostView,a),d}insert(e,t){const n=e._lView,r=n[1];if(function d6(i){return zo(i[3])}(n)){const d=this.indexOf(e);if(-1!==d)this.detach(d);else{const u=n[3],h=new RL(u,u[6],u[3]);h.detach(h.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function TW(i,e,t,n){const r=10+n,s=t.length;n>0&&(t[r-1][4]=e),n<s-10?(e[4]=t[r],KP(t,10+n,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function IW(i,e){const t=i[9];e[16]!==e[3][3][16]&&(i[2]=!0),null===t?i[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(i),e[2]|=64}(r,n,o,s);const a=l1(s,o),l=n[11],c=Iv(l,o[7]);return null!==c&&function MW(i,e,t,n,r,s){n[0]=r,n[6]=e,Gg(i,n,t,1,r,s)}(r,o[6],l,n,c,a),e.attachToViewContainerRef(),KP(pE(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=DL(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=s1(this._lContainer,t);n&&(Cv(pE(this._lContainer),t),Ak(n[1],n))}detach(e){const t=this._adjustIndex(e,-1),n=s1(this._lContainer,t);return n&&null!=Cv(pE(this._lContainer),t)?new Zg(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function DL(i){return i[8]}function pE(i){return i[8]||(i[8]=[])}function PL(i,e){let t;const n=e[i.index];if(zo(n))t=n;else{let r;if(8&i.type)r=kr(n);else{const s=e[11];r=s.createComment("");const o=js(i,e);_d(s,Iv(s,o),r,function kW(i,e){return i.nextSibling(e)}(s,o),!1)}e[i.index]=t=PF(n,e,r,i),Hv(e,t)}return new RL(t,i,e)}class mE{constructor(e){this.queryList=e,this.matches=null}clone(){return new mE(this.queryList)}setDirty(){this.queryList.setDirty()}}class gE{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<n;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new gE(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==OL(e,t).matches&&this.queries[t].setDirty()}}class kL{constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class _E{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const r=null!==t?t.length:0,s=this.getByIndex(n).embeddedTView(e,r);s&&(s.indexInDeclarationView=n,null!==t?t.push(s):t=[s])}return null!==t?new _E(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class bE{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new bE(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){const s=n[r];this.matchTNodeWithReadOption(e,t,RY(t,s)),this.matchTNodeWithReadOption(e,t,wv(t,e,s,!1,!1))}else n===bs?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,wv(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===Ht||r===Qr||r===bs&&4&t.type)this.addMatch(t.index,-2);else{const s=wv(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function RY(i,e){const t=i.localNames;if(null!==t)for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1];return null}function PY(i,e,t,n){return-1===t?function DY(i,e){return 11&i.type?Ih(i,e):4&i.type?sy(i,e):null}(e,i):-2===t?function kY(i,e,t){return t===Ht?Ih(e,i):t===bs?sy(e,i):t===Qr?PL(e,i):void 0}(i,e,n):md(i,i[1],t,e)}function FL(i,e,t,n){const r=e[19].queries[n];if(null===r.matches){const s=i.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:PY(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function vE(i,e,t,n){const r=i.queries.getByIndex(t),s=r.matches;if(null!==s){const o=FL(i,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)n.push(o[a/2]);else{const c=s[a+1],d=e[-l];for(let u=10;u<d.length;u++){const h=d[u];h[17]===h[3]&&vE(h[1],h,c,n)}if(null!==d[9]){const u=d[9];for(let h=0;h<u.length;h++){const f=u[h];vE(f[1],f,c,n)}}}}}return n}function Pt(i){const e=Le(),t=Ti(),n=SP();DM(n+1);const r=OL(t,n);if(i.dirty&&function c6(i){return 4==(4&i[2])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)i.reset([]);else{const s=r.crossesNgTemplate?vE(t,e,n,[]):FL(t,e,r,n);i.reset(s,I7),i.notifyOnChanges()}return!0}return!1}function Di(i,e,t){const n=Ti();n.firstCreatePass&&(LL(n,new kL(i,e,t),-1),2==(2&e)&&(n.staticViewQueries=!0)),BL(n,Le(),e)}function Fn(i,e,t,n){const r=Ti();if(r.firstCreatePass){const s=Fr();LL(r,new kL(e,t,n),s.index),function BY(i,e){const t=i.contentQueries||(i.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(i.queries.length-1,e)}(r,i),2==(2&t)&&(r.staticContentQueries=!0)}BL(r,Le(),t)}function kt(){return function FY(i,e){return i[19].queries[e].queryList}(Le(),SP())}function BL(i,e,t){const n=new Sd(4==(4&t));EF(i,e,n,n.destroy),null===e[19]&&(e[19]=new gE),e[19].queries.push(new mE(n))}function LL(i,e,t){null===i.queries&&(i.queries=new _E),i.queries.track(new bE(e,t))}function OL(i,e){return i.queries.getByIndex(e)}function Td(i,e){return sy(i,e)}function ay(...i){}const ly=new Fe("Application Initializer");let cy=(()=>{class i{constructor(t){this.appInits=t,this.resolve=ay,this.reject=ay,this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],n=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(e_(s))t.push(s);else if(Z1(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{n()}).catch(r=>{this.reject(r)}),0===t.length&&n(),this.initialized=!0}}return i.\u0275fac=function(t){return new(t||i)(ye(ly,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const u_=new Fe("AppId",{providedIn:"root",factory:function iO(){return`${CE()}${CE()}${CE()}`}});function CE(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const nO=new Fe("Platform Initializer"),h_=new Fe("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),rO=new Fe("appBootstrapListener"),rs=new Fe("AnimationModuleType");let tZ=(()=>{class i{log(t){console.log(t)}warn(t){console.warn(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();const Ca=new Fe("LocaleId",{providedIn:"root",factory:()=>Ut(Ca,jt.Optional|jt.SkipSelf)||function iZ(){return typeof $localize<"u"&&$localize.locale||Qh}()});class rZ{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let sO=(()=>{class i{compileModuleSync(t){return new dE(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const n=this.compileModuleSync(t),s=dl(Os(t).declarations).reduce((o,a)=>{const l=Ui(a);return l&&o.push(new Kg(l)),o},[]);return new rZ(n,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const aZ=(()=>Promise.resolve(0))();function ME(i){typeof Zone>"u"?aZ.then(()=>{i&&i.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",i)}class at{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ct(!1),this.onMicrotaskEmpty=new Ct(!1),this.onStable=new Ct(!1),this.onError=new Ct(!1),typeof Zone>"u")throw new Me(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&t,r.shouldCoalesceRunChangeDetection=n,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function lZ(){let i=en.requestAnimationFrame,e=en.cancelAnimationFrame;if(typeof Zone<"u"&&i&&e){const t=i[Zone.__symbol__("OriginalDelegate")];t&&(i=t);const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function uZ(i){const e=()=>{!function dZ(i){i.isCheckStableRunning||-1!==i.lastRequestAnimationFrameId||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(en,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,SE(i),i.isCheckStableRunning=!0,EE(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),SE(i))}(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,r,s,o,a)=>{try{return lO(i),t.invokeTask(r,s,o,a)}finally{(i.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||i.shouldCoalesceRunChangeDetection)&&e(),cO(i)}},onInvoke:(t,n,r,s,o,a,l)=>{try{return lO(i),t.invoke(r,s,o,a,l)}finally{i.shouldCoalesceRunChangeDetection&&e(),cO(i)}},onHasTask:(t,n,r,s)=>{t.hasTask(r,s),n===r&&("microTask"==s.change?(i._hasPendingMicrotasks=s.microTask,SE(i),EE(i)):"macroTask"==s.change&&(i.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,n,r,s)=>(t.handleError(r,s),i.runOutsideAngular(()=>i.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!at.isInAngularZone())throw new Me(909,!1)}static assertNotInAngularZone(){if(at.isInAngularZone())throw new Me(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,cZ,ay,ay);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const cZ={};function EE(i){if(0==i._nesting&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function SE(i){i.hasPendingMicrotasks=!!(i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&-1!==i.lastRequestAnimationFrameId)}function lO(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function cO(i){i._nesting--,EE(i)}class hZ{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ct,this.onMicrotaskEmpty=new Ct,this.onStable=new Ct,this.onError=new Ct}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,r){return e.apply(t,n)}}const dO=new Fe(""),dy=new Fe("");let RE,TE=(()=>{class i{constructor(t,n,r){this._ngZone=t,this.registry=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,RE||(function fZ(i){RE=i}(r),r.addToWindow(n)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{at.assertNotInAngularZone(),ME(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())ME(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(n=>!n.updateCb||!n.updateCb(t)||(clearTimeout(n.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,n,r){let s=-1;n&&n>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},n)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,n,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,n,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,n,r){return[]}}return i.\u0275fac=function(t){return new(t||i)(ye(at),ye(IE),ye(dy))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})(),IE=(()=>{class i{constructor(){this._applications=new Map}registerApplication(t,n){this._applications.set(t,n)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,n=!0){return RE?.findTestabilityInTree(this,t,n)??null}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})(),Kl=null;const uO=new Fe("AllowMultipleToken"),DE=new Fe("PlatformDestroyListeners");class hO{constructor(e,t){this.name=e,this.token=t}}function pO(i,e,t=[]){const n=`Platform: ${e}`,r=new Fe(n);return(s=[])=>{let o=PE();if(!o||o.injector.get(uO,!1)){const a=[...t,...s,{provide:r,useValue:!0}];i?i(a):function gZ(i){if(Kl&&!Kl.get(uO,!1))throw new Me(400,!1);Kl=i;const e=i.get(gO);(function fO(i){const e=i.get(nO,null);e&&e.forEach(t=>t())})(i)}(function mO(i=[],e){return _s.create({name:e,providers:[{provide:y1,useValue:"platform"},{provide:DE,useValue:new Set([()=>Kl=null])},...i]})}(a,n))}return function bZ(i){const e=PE();if(!e)throw new Me(401,!1);return e}()}}function PE(){return Kl?.get(gO)??null}let gO=(()=>{class i{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,n){const r=function bO(i,e){let t;return t="noop"===i?new hZ:("zone.js"===i?void 0:i)||new at(e),t}(n?.ngZone,function _O(i){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!i||!i.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!i||!i.ngZoneRunCoalescing)||!1}}(n)),s=[{provide:at,useValue:r}];return r.run(()=>{const o=_s.create({providers:s,parent:this.injector,name:t.moduleType.name}),a=t.create(o),l=a.injector.get(cl,null);if(!l)throw new Me(402,!1);return r.runOutsideAngular(()=>{const c=r.onError.subscribe({next:d=>{l.handleError(d)}});a.onDestroy(()=>{uy(this._modules,a),c.unsubscribe()})}),function vO(i,e,t){try{const n=t();return e_(n)?n.catch(r=>{throw e.runOutsideAngular(()=>i.handleError(r)),r}):n}catch(n){throw e.runOutsideAngular(()=>i.handleError(n)),n}}(l,r,()=>{const c=a.injector.get(cy);return c.runInitializers(),c.donePromise.then(()=>(function QB(i){uo(i,"Expected localeId to be defined"),"string"==typeof i&&(GB=i.toLowerCase().replace(/_/g,"-"))}(a.injector.get(Ca,Qh)||Qh),this._moduleDoBootstrap(a),a))})})}bootstrapModule(t,n=[]){const r=yO({},n);return function pZ(i,e,t){const n=new dE(t);return Promise.resolve(n)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const n=t.injector.get(Yh);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>n.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Me(-403,!1);t.instance.ngDoBootstrap(n)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Me(404,!1);this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n());const t=this._injector.get(DE,null);t&&(t.forEach(n=>n()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return i.\u0275fac=function(t){return new(t||i)(ye(_s))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();function yO(i,e){return Array.isArray(e)?e.reduce(yO,i):{...i,...e}}let Yh=(()=>{class i{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(t,n,r){this._zone=t,this._injector=n,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new Fi(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),o=new Fi(a=>{let l;this._zone.runOutsideAngular(()=>{l=this._zone.onStable.subscribe(()=>{at.assertNotInAngularZone(),ME(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const c=this._zone.onUnstable.subscribe(()=>{at.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{l.unsubscribe(),c.unsubscribe()}});this.isStable=ud(s,o.pipe(dM()))}bootstrap(t,n){const r=t instanceof nF;if(!this._injector.get(cy).done)throw!r&&function uh(i){const e=Ui(i)||Ur(i)||$r(i);return null!==e&&e.standalone}(t),new Me(405,false);let o;o=r?t:this._injector.get(Yl).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function mZ(i){return i.isBoundToModule}(o)?void 0:this._injector.get(Wh),c=o.create(_s.NULL,[],n||o.selector,a),d=c.location.nativeElement,u=c.injector.get(dO,null);return u?.registerApplication(d),c.onDestroy(()=>{this.detachView(c.hostView),uy(this.components,c),u?.unregisterApplication(d)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new Me(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const n=t;this._views.push(n),n.attachToAppRef(this)}detachView(t){const n=t;uy(this._views,n),n.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const n=this._injector.get(rO,[]);n.push(...this._bootstrapListeners),n.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>uy(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Me(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return i.\u0275fac=function(t){return new(t||i)(ye(at),ye(va),ye(cl))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function uy(i,e){const t=i.indexOf(e);t>-1&&i.splice(t,1)}let er=(()=>{class i{}return i.__NG_ELEMENT_ID__=yZ,i})();function yZ(i){return function AZ(i,e,t){if(Pg(i)&&!t){const n=Us(i.index,e);return new Zg(n,n)}return 47&i.type?new Zg(e[16],e):null}(Fr(),Le(),16==(16&i))}class MO{constructor(){}supports(e){return Xv(e)}create(e){return new SZ(e)}}const EZ=(i,e)=>e;class SZ{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||EZ}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,r=0,s=null;for(;t||n;){const o=!n||t&&t.currentIndex<SO(n,r,s)?t:n,a=SO(o,r,s),l=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,d=l-r;if(c!=d){for(let h=0;h<c;h++){const f=h<s.length?s[h]:s[h]=0,m=f+h;d<=m&&m<c&&(s[h]=f+1)}s[o.previousIndex]=d-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Xv(e))throw new Me(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,n=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),n=!0),t=t._next}else r=0,function cq(i,e){if(Array.isArray(i))for(let t=0;t<i.length;t++)e(i[t]);else{const t=i[xd()]();let n;for(;!(n=t.next()).done;)e(n.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),n=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new TZ(t,n),s,r),e}_verifyReinsertion(e,t,n,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new EO),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new EO),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class TZ{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class IZ{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class EO{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new IZ,this.map.set(t,n)),n.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function SO(i,e,t){const n=i.previousIndex;if(null===n)return n;let r=0;return t&&n<t.length&&(r=t[n]),n+e+r}class TO{constructor(){}supports(e){return e instanceof Map||W1(e)}create(){return new RZ}}class RZ{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||W1(e)))throw new Me(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(n,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,n),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,n);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let n=t;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const n=new DZ(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}}class DZ{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function IO(){return new py([new MO])}let py=(()=>{class i{constructor(t){this.factories=t}static create(t,n){if(null!=n){const r=n.factories.slice();t=t.concat(r)}return new i(t)}static extend(t){return{provide:i,useFactory:n=>i.create(t,n||IO()),deps:[[i,new Mh,new ol]]}}find(t){const n=this.factories.find(r=>r.supports(t));if(null!=n)return n;throw new Me(901,!1)}}return i.\u0275prov=Ne({token:i,providedIn:"root",factory:IO}),i})();function RO(){return new f_([new TO])}let f_=(()=>{class i{constructor(t){this.factories=t}static create(t,n){if(n){const r=n.factories.slice();t=t.concat(r)}return new i(t)}static extend(t){return{provide:i,useFactory:n=>i.create(t,n||RO()),deps:[[i,new Mh,new ol]]}}find(t){const n=this.factories.find(r=>r.supports(t));if(n)return n;throw new Me(901,!1)}}return i.\u0275prov=Ne({token:i,providedIn:"root",factory:RO}),i})();const FZ=pO(null,"core",[]);let BZ=(()=>{class i{constructor(t){}}return i.\u0275fac=function(t){return new(t||i)(ye(Yh))},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({}),i})();function Zh(i){return"boolean"==typeof i?i:null!=i&&"false"!==i}let OE=null;function Ma(){return OE}class NZ{}const ii=new Fe("DocumentToken");let NE=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:function(){return function jZ(){return ye(DO)}()},providedIn:"platform"}),i})();const UZ=new Fe("Location Initialized");let DO=(()=>{class i extends NE{constructor(t){super(),this._doc=t,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ma().getBaseHref(this._doc)}onPopState(t){const n=Ma().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",t,!1),()=>n.removeEventListener("popstate",t)}onHashChange(t){const n=Ma().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",t,!1),()=>n.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,n,r){PO()?this._history.pushState(t,n,r):this._location.hash=r}replaceState(t,n,r){PO()?this._history.replaceState(t,n,r):this._location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return i.\u0275fac=function(t){return new(t||i)(ye(ii))},i.\u0275prov=Ne({token:i,factory:function(){return function VZ(){return new DO(ye(ii))}()},providedIn:"platform"}),i})();function PO(){return!!window.history.pushState}function jE(i,e){if(0==i.length)return e;if(0==e.length)return i;let t=0;return i.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?i+e.substring(1):1==t?i+e:i+"/"+e}function kO(i){const e=i.match(/#|\?|$/),t=e&&e.index||i.length;return i.slice(0,t-("/"===i[t-1]?1:0))+i.slice(t)}function fl(i){return i&&"?"!==i[0]?"?"+i:i}let Rd=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:function(){return Ut(BO)},providedIn:"root"}),i})();const FO=new Fe("appBaseHref");let BO=(()=>{class i extends Rd{constructor(t,n){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??Ut(ii).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return jE(this._baseHref,t)}path(t=!1){const n=this._platformLocation.pathname+fl(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${n}${r}`:n}pushState(t,n,r,s){const o=this.prepareExternalUrl(r+fl(s));this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){const o=this.prepareExternalUrl(r+fl(s));this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return i.\u0275fac=function(t){return new(t||i)(ye(NE),ye(FO,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),zZ=(()=>{class i extends Rd{constructor(t,n){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let n=this._platformLocation.hash;return null==n&&(n="#"),n.length>0?n.substring(1):n}prepareExternalUrl(t){const n=jE(this._baseHref,t);return n.length>0?"#"+n:n}pushState(t,n,r,s){let o=this.prepareExternalUrl(r+fl(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){let o=this.prepareExternalUrl(r+fl(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return i.\u0275fac=function(t){return new(t||i)(ye(NE),ye(FO,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})(),my=(()=>{class i{constructor(t){this._subject=new Ct,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const n=this._locationStrategy.getBaseHref();this._basePath=function QZ(i){if(new RegExp("^(https?:)?//").test(i)){const[,t]=i.split(/\/\/[^\/]+/);return t}return i}(kO(LO(n))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,n=""){return this.path()==this.normalize(t+fl(n))}normalize(t){return i.stripTrailingSlash(function GZ(i,e){return i&&new RegExp(`^${i}([/;?#]|$)`).test(e)?e.substring(i.length):e}(this._basePath,LO(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,n="",r=null){this._locationStrategy.pushState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+fl(n)),r)}replaceState(t,n="",r=null){this._locationStrategy.replaceState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+fl(n)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)})),()=>{const n=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(n,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",n){this._urlChangeListeners.forEach(r=>r(t,n))}subscribe(t,n,r){return this._subject.subscribe({next:t,error:n,complete:r})}}return i.normalizeQueryParams=fl,i.joinWithSlash=jE,i.stripTrailingSlash=kO,i.\u0275fac=function(t){return new(t||i)(ye(Rd))},i.\u0275prov=Ne({token:i,factory:function(){return function HZ(){return new my(ye(Rd))}()},providedIn:"root"}),i})();function LO(i){return i.replace(/\/index.html$/,"")}function QO(i,e){e=encodeURIComponent(e);for(const t of i.split(";")){const n=t.indexOf("="),[r,s]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}const YE=/\s+/,WO=[];let qO=(()=>{class i{constructor(t,n,r,s){this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=s,this.initialClasses=WO,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(YE):WO}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(YE):t}ngDoCheck(){for(const n of this.initialClasses)this._updateState(n,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const n of t)this._updateState(n,!0);else if(null!=t)for(const n of Object.keys(t))this._updateState(n,Boolean(t[n]));this._applyStateDiff()}_updateState(t,n){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==n&&(r.changed=!0,r.enabled=n),r.touched=!0):this.stateMap.set(t,{enabled:n,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const n=t[0],r=t[1];r.changed?(this._toggleClass(n,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(n,!1),this.stateMap.delete(n)),r.touched=!1}}_toggleClass(t,n){(t=t.trim()).length>0&&t.split(YE).forEach(r=>{n?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return i.\u0275fac=function(t){return new(t||i)(R(py),R(f_),R(Ht),R(ll))},i.\u0275dir=ke({type:i,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),i})(),XO=(()=>{class i{constructor(t){this._viewContainerRef=t,this.ngComponentOutlet=null}ngOnChanges(t){const{_viewContainerRef:n,ngComponentOutletNgModule:r,ngComponentOutletNgModuleFactory:s}=this;if(n.clear(),this._componentRef=void 0,this.ngComponentOutlet){const o=this.ngComponentOutletInjector||n.parentInjector;(t.ngComponentOutletNgModule||t.ngComponentOutletNgModuleFactory)&&(this._moduleRef&&this._moduleRef.destroy(),this._moduleRef=r?function nY(i,e){return new _L(i,e??null)}(r,YO(o)):s?s.create(YO(o)):void 0),this._componentRef=n.createComponent(this.ngComponentOutlet,{index:n.length,injector:o,ngModuleRef:this._moduleRef,projectableNodes:this.ngComponentOutletContent})}}ngOnDestroy(){this._moduleRef&&this._moduleRef.destroy()}}return i.\u0275fac=function(t){return new(t||i)(R(Qr))},i.\u0275dir=ke({type:i,selectors:[["","ngComponentOutlet",""]],inputs:{ngComponentOutlet:"ngComponentOutlet",ngComponentOutletInjector:"ngComponentOutletInjector",ngComponentOutletContent:"ngComponentOutletContent",ngComponentOutletNgModule:"ngComponentOutletNgModule",ngComponentOutletNgModuleFactory:"ngComponentOutletNgModuleFactory"},standalone:!0,features:[Pr]}),i})();function YO(i){return i.get(Wh).injector}class TK{constructor(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let $l=(()=>{class i{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,n,r){this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const n=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)n.createEmbeddedView(this._template,new TK(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)n.remove(null===s?void 0:s);else if(null!==s){const a=n.get(s);n.move(a,o),KO(a,r)}});for(let r=0,s=n.length;r<s;r++){const a=n.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{KO(n.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(R(Qr),R(bs),R(py))},i.\u0275dir=ke({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),i})();function KO(i,e){i.context.$implicit=e.item}let Dd=(()=>{class i{constructor(t,n){this._viewContainer=t,this._context=new RK,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){$O("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){$O("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(R(Qr),R(bs))},i.\u0275dir=ke({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),i})();class RK{constructor(){this.$implicit=null,this.ngIf=null}}function $O(i,e){if(e&&!e.createEmbeddedView)throw new Error(`${i} must be a TemplateRef, but received '${Ji(e)}'.`)}class ZE{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let My=(()=>{class i{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews.push(t)}_matchCase(t){const n=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||n,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),n}_updateDefaultCases(t){if(this._defaultViews.length>0&&t!==this._defaultUsed){this._defaultUsed=t;for(const n of this._defaultViews)n.enforceState(t)}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=ke({type:i,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),i})(),JO=(()=>{class i{constructor(t,n,r){this.ngSwitch=r,r._addCase(),this._view=new ZE(t,n)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return i.\u0275fac=function(t){return new(t||i)(R(Qr),R(bs),R(My,9))},i.\u0275dir=ke({type:i,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),i})(),t3=(()=>{class i{constructor(t,n,r){this._ngEl=t,this._differs=n,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,n){const[r,s]=t.split("."),o=-1===r.indexOf("-")?void 0:ms.DashCase;null!=n?this._renderer.setStyle(this._ngEl.nativeElement,r,s?`${n}${s}`:n,o):this._renderer.removeStyle(this._ngEl.nativeElement,r,o)}_applyChanges(t){t.forEachRemovedItem(n=>this._setStyle(n.key,null)),t.forEachAddedItem(n=>this._setStyle(n.key,n.currentValue)),t.forEachChangedItem(n=>this._setStyle(n.key,n.currentValue))}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(f_),R(ll))},i.\u0275dir=ke({type:i,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),i})(),KE=(()=>{class i{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(t){if(t.ngTemplateOutlet||t.ngTemplateOutletInjector){const n=this._viewContainerRef;if(this._viewRef&&n.remove(n.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:s,ngTemplateOutletInjector:o}=this;this._viewRef=n.createEmbeddedView(r,s,o?{injector:o}:void 0)}else this._viewRef=null}else this._viewRef&&t.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return i.\u0275fac=function(t){return new(t||i)(R(Qr))},i.\u0275dir=ke({type:i,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Pr]}),i})();class kK{createSubscription(e,t){return e.subscribe({next:t,error:n=>{throw n}})}dispose(e){e.unsubscribe()}}class FK{createSubscription(e,t){return e.then(t,n=>{throw n})}dispose(e){}}const BK=new FK,LK=new kK;let $E=(()=>{class i{constructor(t){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,n=>this._updateLatestValue(t,n))}_selectStrategy(t){if(e_(t))return BK;if($F(t))return LK;throw function Yo(i,e){return new Me(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,n){t===this._obj&&(this._latestValue=n,this._ref.markForCheck())}}return i.\u0275fac=function(t){return new(t||i)(R(er,16))},i.\u0275pipe=gi({name:"async",type:i,pure:!1,standalone:!0}),i})(),Ea=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({}),i})();const r3="browser";function s3(i){return i===r3}let n$=(()=>{class i{}return i.\u0275prov=Ne({token:i,providedIn:"root",factory:()=>new r$(ye(ii),window)}),i})();class r${constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function s$(i,e){const t=i.getElementById(e)||i.getElementsByName(e)[0];if(t)return t;if("function"==typeof i.createTreeWalker&&i.body&&(i.body.createShadowRoot||i.body.attachShadow)){const n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT);let r=n.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=o3(this.window.history)||o3(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function o3(i){return Object.getOwnPropertyDescriptor(i,"scrollRestoration")}class a3{}class P$ extends NZ{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class nS extends P${static makeCurrent(){!function OZ(i){OE||(OE=i)}(new nS)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function k$(){return __=__||document.querySelector("base"),__?__.getAttribute("href"):null}();return null==t?null:function F$(i){Sy=Sy||document.createElement("a"),Sy.setAttribute("href",i);const e=Sy.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){__=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return QO(document.cookie,e)}}let Sy,__=null;const f3=new Fe("TRANSITION_ID"),L$=[{provide:ly,useFactory:function B$(i,e,t){return()=>{t.get(cy).donePromise.then(()=>{const n=Ma(),r=e.querySelectorAll(`style[ng-transition="${i}"]`);for(let s=0;s<r.length;s++)n.remove(r[s])})}},deps:[f3,ii,_s],multi:!0}];let N$=(()=>{class i{build(){return new XMLHttpRequest}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();const Ty=new Fe("EventManagerPlugins");let Iy=(()=>{class i{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,n,r){return this._findPluginFor(n).addEventListener(t,n,r)}addGlobalEventListener(t,n,r){return this._findPluginFor(n).addGlobalEventListener(t,n,r)}getZone(){return this._zone}_findPluginFor(t){const n=this._eventNameToPlugin.get(t);if(n)return n;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return i.\u0275fac=function(t){return new(t||i)(ye(Ty),ye(at))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();class p3{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const r=Ma().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,n)}}let m3=(()=>{class i{constructor(){this._stylesSet=new Set}addStyles(t){const n=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),n.add(r))}),this.onStylesAdded(n)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})(),b_=(()=>{class i extends m3{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,n,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(n.appendChild(o))})}addHost(t){const n=[];this._addStylesToHost(this._stylesSet,t,n),this._hostNodes.set(t,n)}removeHost(t){const n=this._hostNodes.get(t);n&&n.forEach(g3),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((n,r)=>{this._addStylesToHost(t,r,n)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(g3))}}return i.\u0275fac=function(t){return new(t||i)(ye(ii))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();function g3(i){Ma().remove(i)}const rS={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},sS=/%COMP%/g;function oS(i,e){return e.flat(100).map(t=>t.replace(sS,i))}function v3(i){return e=>{if("__ngUnwrap__"===e)return i;!1===i(e)&&(e.preventDefault(),e.returnValue=!1)}}let Ry=(()=>{class i{constructor(t,n,r){this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new aS(t)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;switch(n.encapsulation){case Uo.Emulated:{let r=this.rendererByCompId.get(n.id);return r||(r=new G$(this.eventManager,this.sharedStylesHost,n,this.appId),this.rendererByCompId.set(n.id,r)),r.applyToHost(t),r}case Uo.ShadowDom:return new Q$(this.eventManager,this.sharedStylesHost,t,n);default:if(!this.rendererByCompId.has(n.id)){const r=oS(n.id,n.styles);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(n.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return i.\u0275fac=function(t){return new(t||i)(ye(Iy),ye(b_),ye(u_))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();class aS{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(rS[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(A3(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(A3(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;const s=rS[r];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const r=rS[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(ms.DashCase|ms.Important)?e.style.setProperty(t,n,r&ms.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&ms.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,v3(n)):this.eventManager.addEventListener(e,t,v3(n))}}function A3(i){return"TEMPLATE"===i.tagName&&void 0!==i.content}class G$ extends aS{constructor(e,t,n,r){super(e),this.component=n;const s=oS(r+"-"+n.id,n.styles);t.addStyles(s),this.contentAttr=function V$(i){return"_ngcontent-%COMP%".replace(sS,i)}(r+"-"+n.id),this.hostAttr=function z$(i){return"_nghost-%COMP%".replace(sS,i)}(r+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class Q$ extends aS{constructor(e,t,n,r){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=oS(r.id,r.styles);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let W$=(()=>{class i extends p3{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,r){return t.addEventListener(n,r,!1),()=>this.removeEventListener(t,n,r)}removeEventListener(t,n,r){return t.removeEventListener(n,r)}}return i.\u0275fac=function(t){return new(t||i)(ye(ii))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();const x3=["alt","control","meta","shift"],q$={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},X$={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let Y$=(()=>{class i extends p3{constructor(t){super(t)}supports(t){return null!=i.parseEventName(t)}addEventListener(t,n,r){const s=i.parseEventName(n),o=i.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ma().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const n=t.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const s=i._normalizeKey(n.pop());let o="",a=n.indexOf("code");if(a>-1&&(n.splice(a,1),o="code."),x3.forEach(c=>{const d=n.indexOf(c);d>-1&&(n.splice(d,1),o+=c+".")}),o+=s,0!=n.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,n){let r=q$[t.key]||t.key,s="";return n.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),x3.forEach(o=>{o!==r&&(0,X$[o])(t)&&(s+=o+".")}),s+=r,s===n)}static eventCallback(t,n,r){return s=>{i.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>n(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return i.\u0275fac=function(t){return new(t||i)(ye(ii))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();const C3=[{provide:h_,useValue:r3},{provide:nO,useValue:function Z$(){nS.makeCurrent()},multi:!0},{provide:ii,useFactory:function $$(){return function VW(i){h1=i}(document),document},deps:[]}],J$=pO(FZ,"browser",C3),M3=new Fe(""),E3=[{provide:dy,useClass:class O${addToWindow(e){en.getAngularTestability=(n,r=!0)=>{const s=e.findTestabilityInTree(n,r);if(null==s)throw new Error("Could not find testability for element.");return s},en.getAllAngularTestabilities=()=>e.getAllTestabilities(),en.getAllAngularRootElements=()=>e.getAllRootElements(),en.frameworkStabilizers||(en.frameworkStabilizers=[]),en.frameworkStabilizers.push(n=>{const r=en.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&n(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,n){return null==t?null:e.getTestability(t)??(n?Ma().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:dO,useClass:TE,deps:[at,IE,dy]},{provide:TE,useClass:TE,deps:[at,IE,dy]}],S3=[{provide:y1,useValue:"root"},{provide:cl,useFactory:function K$(){return new cl},deps:[]},{provide:Ty,useClass:W$,multi:!0,deps:[ii,at,h_]},{provide:Ty,useClass:Y$,multi:!0,deps:[ii]},{provide:Ry,useClass:Ry,deps:[Iy,b_,u_]},{provide:qg,useExisting:Ry},{provide:m3,useExisting:b_},{provide:b_,useClass:b_,deps:[ii]},{provide:Iy,useClass:Iy,deps:[Ty,at]},{provide:a3,useClass:N$,deps:[]},[]];let T3=(()=>{class i{constructor(t){}static withServerTransition(t){return{ngModule:i,providers:[{provide:u_,useValue:t.appId},{provide:f3,useExisting:u_},L$]}}}return i.\u0275fac=function(t){return new(t||i)(ye(M3,12))},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({providers:[...S3,...E3],imports:[Ea,BZ]}),i})(),I3=(()=>{class i{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return i.\u0275fac=function(t){return new(t||i)(ye(ii))},i.\u0275prov=Ne({token:i,factory:function(t){let n=null;return n=t?new t:function tJ(){return new I3(ye(ii))}(),n},providedIn:"root"}),i})();typeof window<"u"&&window;let Dy=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:function(t){let n=null;return n=t?new(t||i):ye(P3),n},providedIn:"root"}),i})(),P3=(()=>{class i extends Dy{constructor(t){super(),this._doc=t}sanitize(t,n){if(null==n)return null;switch(t){case Ri.NONE:return n;case Ri.HTML:return ba(n,"HTML")?zs(n):Gk(this._doc,String(n)).toString();case Ri.STYLE:return ba(n,"Style")?zs(n):n;case Ri.SCRIPT:if(ba(n,"Script"))return zs(n);throw new Error("unsafe value used in a script context");case Ri.URL:return ba(n,"URL")?zs(n):Fv(String(n));case Ri.RESOURCE_URL:if(ba(n,"ResourceURL"))return zs(n);throw new Error(`unsafe value used in a resource URL context (see ${tv})`);default:throw new Error(`Unexpected SecurityContext ${t} (see ${tv})`)}}bypassSecurityTrustHtml(t){return function XW(i){return new zW(i)}(t)}bypassSecurityTrustStyle(t){return function YW(i){return new HW(i)}(t)}bypassSecurityTrustScript(t){return function ZW(i){return new GW(i)}(t)}bypassSecurityTrustUrl(t){return function KW(i){return new QW(i)}(t)}bypassSecurityTrustResourceUrl(t){return function $W(i){return new WW(i)}(t)}}return i.\u0275fac=function(t){return new(t||i)(ye(ii))},i.\u0275prov=Ne({token:i,factory:function(t){let n=null;return n=t?new t:function lJ(i){return new P3(i.get(ii))}(ye(_s)),n},providedIn:"root"}),i})();function wt(...i){return wn(i,Cg(i))}class Qs extends Wt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}const Py=$C(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:cJ}=Array,{getPrototypeOf:dJ,prototype:uJ,keys:hJ}=Object;function k3(i){if(1===i.length){const e=i[0];if(cJ(e))return{args:e,keys:null};if(function fJ(i){return i&&"object"==typeof i&&dJ(i)===uJ}(e)){const t=hJ(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}const{isArray:pJ}=Array;function dS(i){return vt(e=>function mJ(i,e){return pJ(e)?i(...e):i(e)}(i,e))}function F3(i,e){return i.reduce((t,n,r)=>(t[n]=e[r],t),{})}function uS(...i){const e=Cg(i),t=cM(i),{args:n,keys:r}=k3(i);if(0===n.length)return wn([],e);const s=new Fi(function gJ(i,e,t=Ql){return n=>{B3(e,()=>{const{length:r}=i,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)B3(e,()=>{const c=wn(i[l],e);let d=!1;c.subscribe(dn(n,u=>{s[l]=u,d||(d=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}(n,e,r?o=>F3(r,o):Ql));return t?s.pipe(dS(t)):s}function B3(i,e,t){i?el(t,i,e):e()}function ky(...i){return function _J(){return ch(1)}()(wn(i,Cg(i)))}function L3(i){return new Fi(e=>{fs(i()).subscribe(e)})}function Zo(i,e){const t=Si(i)?i:()=>i,n=r=>r.error(t());return new Fi(e?r=>e.schedule(n,0,r):n)}function Fy(){return xn((i,e)=>{let t=null;i._refCount++;const n=dn(e,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(t=null);const r=i._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});i.subscribe(n),n.closed||(t=i.connect())})}class hS extends Fi{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,L2(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new cn;const t=this.getSubject();e.add(this.source.subscribe(dn(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=cn.EMPTY)}return e}refCount(){return Fy()(this)}}function Ws(i,e){return xn((t,n)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&n.complete();t.subscribe(dn(n,l=>{r?.unsubscribe();let c=0;const d=s++;fs(i(l,d)).subscribe(r=dn(n,u=>n.next(e?e(l,u,d,c++):u),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function ec(...i){const e=Cg(i);return xn((t,n)=>{(e?ky(i,t,e):ky(i,t)).subscribe(n)})}function Bn(i,e){return xn((t,n)=>{let r=0;t.subscribe(dn(n,s=>i.call(e,s,r++)&&n.next(s)))})}function By(i){return xn((e,t)=>{let n=!1;e.subscribe(dn(t,r=>{n=!0,t.next(r)},()=>{n||t.next(i),t.complete()}))})}function O3(i=bJ){return xn((e,t)=>{let n=!1;e.subscribe(dn(t,r=>{n=!0,t.next(r)},()=>n?t.complete():t.error(i())))})}function bJ(){return new Py}function tc(i,e){const t=arguments.length>=2;return n=>n.pipe(i?Bn((r,s)=>i(r,s,n)):Ql,ps(1),t?By(e):O3(()=>new Py))}function ic(i,e){return Si(e)?Mr(i,e,1):Mr(i,1)}function nn(i,e,t){const n=Si(i)||e||t?{next:i,error:e,complete:t}:i;return n?xn((r,s)=>{var o;null===(o=n.subscribe)||void 0===o||o.call(n);let a=!0;r.subscribe(dn(s,l=>{var c;null===(c=n.next)||void 0===c||c.call(n,l),s.next(l)},()=>{var l;a=!1,null===(l=n.complete)||void 0===l||l.call(n),s.complete()},l=>{var c;a=!1,null===(c=n.error)||void 0===c||c.call(n,l),s.error(l)},()=>{var l,c;a&&(null===(l=n.unsubscribe)||void 0===l||l.call(n)),null===(c=n.finalize)||void 0===c||c.call(n)}))}):Ql}function Ko(i){return xn((e,t)=>{let s,n=null,r=!1;n=e.subscribe(dn(t,void 0,void 0,o=>{s=fs(i(o,Ko(i)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):r=!0})),r&&(n.unsubscribe(),n=null,s.subscribe(t))})}function vJ(i,e,t,n,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(dn(o,d=>{const u=c++;l=a?i(l,d,u):(a=!0,d),n&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function N3(i,e){return xn(vJ(i,e,arguments.length>=2,!0))}function fS(i){return i<=0?()=>jr:xn((e,t)=>{let n=[];e.subscribe(dn(t,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(const r of n)t.next(r);t.complete()},void 0,()=>{n=null}))})}function j3(i,e){const t=arguments.length>=2;return n=>n.pipe(i?Bn((r,s)=>i(r,s,n)):Ql,fS(1),t?By(e):O3(()=>new Py))}function pS(i){return vt(()=>i)}function Ly(i){return xn((e,t)=>{try{e.subscribe(t)}finally{t.add(i)}})}const pi="primary",v_=Symbol("RouteTitle");class AJ{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Kh(i){return new AJ(i)}function xJ(i,e,t){const n=t.path.split("/");if(n.length>i.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<i.length))return null;const r={};for(let s=0;s<n.length;s++){const o=n[s],a=i[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function Sa(i,e){const t=i?Object.keys(i):void 0,n=e?Object.keys(e):void 0;if(!t||!n||t.length!=n.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!U3(i[r],e[r]))return!1;return!0}function U3(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;const t=[...i].sort(),n=[...e].sort();return t.every((r,s)=>n[s]===r)}return i===e}function V3(i){return Array.prototype.concat.apply([],i)}function z3(i){return i.length>0?i[i.length-1]:null}function Br(i,e){for(const t in i)i.hasOwnProperty(t)&&e(i[t],t)}function nc(i){return Z1(i)?i:e_(i)?wn(Promise.resolve(i)):wt(i)}const Oy=!1,CJ={exact:function Q3(i,e,t){if(!kd(i.segments,e.segments)||!Ny(i.segments,e.segments,t)||i.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!i.children[n]||!Q3(i.children[n],e.children[n],t))return!1;return!0},subset:W3},H3={exact:function MJ(i,e){return Sa(i,e)},subset:function EJ(i,e){return Object.keys(e).length<=Object.keys(i).length&&Object.keys(e).every(t=>U3(i[t],e[t]))},ignored:()=>!0};function G3(i,e,t){return CJ[t.paths](i.root,e.root,t.matrixParams)&&H3[t.queryParams](i.queryParams,e.queryParams)&&!("exact"===t.fragment&&i.fragment!==e.fragment)}function W3(i,e,t){return q3(i,e,e.segments,t)}function q3(i,e,t,n){if(i.segments.length>t.length){const r=i.segments.slice(0,t.length);return!(!kd(r,t)||e.hasChildren()||!Ny(r,t,n))}if(i.segments.length===t.length){if(!kd(i.segments,t)||!Ny(i.segments,t,n))return!1;for(const r in e.children)if(!i.children[r]||!W3(i.children[r],e.children[r],n))return!1;return!0}{const r=t.slice(0,i.segments.length),s=t.slice(i.segments.length);return!!(kd(i.segments,r)&&Ny(i.segments,r,n)&&i.children[pi])&&q3(i.children[pi],e,s,n)}}function Ny(i,e,t){return e.every((n,r)=>H3[t](i[r].parameters,n.parameters))}class Pd{constructor(e=new _i([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Kh(this.queryParams)),this._queryParamMap}toString(){return IJ.serialize(this)}}class _i{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Br(t,(n,r)=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return jy(this)}}class y_{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Kh(this.parameters)),this._parameterMap}toString(){return Z3(this)}}function kd(i,e){return i.length===e.length&&i.every((t,n)=>t.path===e[n].path)}let A_=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:function(){return new mS},providedIn:"root"}),i})();class mS{parse(e){const t=new NJ(e);return new Pd(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${x_(e.root,!0)}`,n=function PJ(i){const e=Object.keys(i).map(t=>{const n=i[t];return Array.isArray(n)?n.map(r=>`${Uy(t)}=${Uy(r)}`).join("&"):`${Uy(t)}=${Uy(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${n}${"string"==typeof e.fragment?`#${function RJ(i){return encodeURI(i)}(e.fragment)}`:""}`}}const IJ=new mS;function jy(i){return i.segments.map(e=>Z3(e)).join("/")}function x_(i,e){if(!i.hasChildren())return jy(i);if(e){const t=i.children[pi]?x_(i.children[pi],!1):"",n=[];return Br(i.children,(r,s)=>{s!==pi&&n.push(`${s}:${x_(r,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function TJ(i,e){let t=[];return Br(i.children,(n,r)=>{r===pi&&(t=t.concat(e(n,r)))}),Br(i.children,(n,r)=>{r!==pi&&(t=t.concat(e(n,r)))}),t}(i,(n,r)=>r===pi?[x_(i.children[pi],!1)]:[`${r}:${x_(n,!1)}`]);return 1===Object.keys(i.children).length&&null!=i.children[pi]?`${jy(i)}/${t[0]}`:`${jy(i)}/(${t.join("//")})`}}function X3(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Uy(i){return X3(i).replace(/%3B/gi,";")}function gS(i){return X3(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Vy(i){return decodeURIComponent(i)}function Y3(i){return Vy(i.replace(/\+/g,"%20"))}function Z3(i){return`${gS(i.path)}${function DJ(i){return Object.keys(i).map(e=>`;${gS(e)}=${gS(i[e])}`).join("")}(i.parameters)}`}const kJ=/^[^\/()?;=#]+/;function zy(i){const e=i.match(kJ);return e?e[0]:""}const FJ=/^[^=?&#]+/,LJ=/^[^&#]+/;class NJ{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new _i([],{}):new _i([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[pi]=new _i(e,t)),n}parseSegment(){const e=zy(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Me(4009,Oy);return this.capture(e),new y_(Vy(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=zy(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const r=zy(this.remaining);r&&(n=r,this.capture(n))}e[Vy(t)]=Vy(n)}parseQueryParam(e){const t=function BJ(i){const e=i.match(FJ);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const o=function OJ(i){const e=i.match(LJ);return e?e[0]:""}(this.remaining);o&&(n=o,this.capture(n))}const r=Y3(t),s=Y3(n);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=zy(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Me(4010,Oy);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=pi);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[pi]:new _i([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Me(4011,Oy)}}function _S(i){return i.segments.length>0?new _i([],{[pi]:i}):i}function Hy(i){const e={};for(const n of Object.keys(i.children)){const s=Hy(i.children[n]);(s.segments.length>0||s.hasChildren())&&(e[n]=s)}return function jJ(i){if(1===i.numberOfChildren&&i.children[pi]){const e=i.children[pi];return new _i(i.segments.concat(e.segments),e.children)}return i}(new _i(i.segments,e))}function Fd(i){return i instanceof Pd}function zJ(i,e,t,n,r){if(0===t.length)return $h(e.root,e.root,e.root,n,r);const s=function J3(i){if("string"==typeof i[0]&&1===i.length&&"/"===i[0])return new $3(!0,0,i);let e=0,t=!1;const n=i.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Br(s.outlets,(l,c)=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new $3(t,e,n)}(t);return s.toRoot()?$h(e.root,e.root,new _i([],{}),n,r):function o(l){const c=function GJ(i,e,t,n){if(i.isAbsolute)return new Jh(e.root,!0,0);if(-1===n)return new Jh(t,t===e.root,0);return function eN(i,e,t){let n=i,r=e,s=t;for(;s>r;){if(s-=r,n=n.parent,!n)throw new Me(4005,!1);r=n.segments.length}return new Jh(n,!1,r-s)}(t,n+(w_(i.commands[0])?0:1),i.numberOfDoubleDots)}(s,e,i.snapshot?._urlSegment,l),d=c.processChildren?M_(c.segmentGroup,c.index,s.commands):vS(c.segmentGroup,c.index,s.commands);return $h(e.root,c.segmentGroup,d,n,r)}(i.snapshot?._lastPathIndex)}function w_(i){return"object"==typeof i&&null!=i&&!i.outlets&&!i.segmentPath}function C_(i){return"object"==typeof i&&null!=i&&i.outlets}function $h(i,e,t,n,r){let o,s={};n&&Br(n,(l,c)=>{s[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`}),o=i===e?t:K3(i,e,t);const a=_S(Hy(o));return new Pd(a,s,r)}function K3(i,e,t){const n={};return Br(i.children,(r,s)=>{n[s]=r===e?t:K3(r,e,t)}),new _i(i.segments,n)}class $3{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&w_(n[0]))throw new Me(4003,!1);const r=n.find(C_);if(r&&r!==z3(n))throw new Me(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Jh{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function vS(i,e,t){if(i||(i=new _i([],{})),0===i.segments.length&&i.hasChildren())return M_(i,e,t);const n=function WJ(i,e,t){let n=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=t.length)return s;const o=i.segments[r],a=t[n];if(C_(a))break;const l=`${a}`,c=n<t.length-1?t[n+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!iN(l,c,o))return s;n+=2}else{if(!iN(l,{},o))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}(i,e,t),r=t.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){const s=new _i(i.segments.slice(0,n.pathIndex),{});return s.children[pi]=new _i(i.segments.slice(n.pathIndex),i.children),M_(s,0,r)}return n.match&&0===r.length?new _i(i.segments,{}):n.match&&!i.hasChildren()?yS(i,e,t):n.match?M_(i,0,r):yS(i,e,t)}function M_(i,e,t){if(0===t.length)return new _i(i.segments,{});{const n=function QJ(i){return C_(i[0])?i[0].outlets:{[pi]:i}}(t),r={};return Br(n,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=vS(i.children[o],e,s))}),Br(i.children,(s,o)=>{void 0===n[o]&&(r[o]=s)}),new _i(i.segments,r)}}function yS(i,e,t){const n=i.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(C_(s)){const l=qJ(s.outlets);return new _i(n,l)}if(0===r&&w_(t[0])){n.push(new y_(i.segments[e].path,tN(t[0]))),r++;continue}const o=C_(s)?s.outlets[pi]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&w_(a)?(n.push(new y_(o,tN(a))),r+=2):(n.push(new y_(o,{})),r++)}return new _i(n,{})}function qJ(i){const e={};return Br(i,(t,n)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[n]=yS(new _i([],{}),0,t))}),e}function tN(i){const e={};return Br(i,(t,n)=>e[n]=`${t}`),e}function iN(i,e,t){return i==t.path&&Sa(e,t.parameters)}const E_="imperative";class Ta{constructor(e,t){this.id=e,this.url=t}}class AS extends Ta{constructor(e,t,n="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Bd extends Ta{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Gy extends Ta{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class nN extends Ta{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=16}}class rN extends Ta{constructor(e,t,n,r){super(e,t),this.error=n,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class XJ extends Ta{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class YJ extends Ta{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ZJ extends Ta{constructor(e,t,n,r,s){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class KJ extends Ta{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class $J extends Ta{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class JJ{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class eee{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class tee{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class iee{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class nee{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ree{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class sN{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let oee=(()=>{class i{createUrlTree(t,n,r,s,o,a){return zJ(t||n.root,r,s,o,a)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})(),aee=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:function(e){return oee.\u0275fac(e)},providedIn:"root"}),i})();class oN{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=xS(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=xS(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=wS(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return wS(e,this._root).map(t=>t.value)}}function xS(i,e){if(i===e.value)return e;for(const t of e.children){const n=xS(i,t);if(n)return n}return null}function wS(i,e){if(i===e.value)return[e];for(const t of e.children){const n=wS(i,t);if(n.length)return n.unshift(e),n}return[]}class ml{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function ef(i){const e={};return i&&i.children.forEach(t=>e[t.value.outlet]=t),e}class aN extends oN{constructor(e,t){super(e),this.snapshot=t,CS(this,e)}toString(){return this.snapshot.toString()}}function lN(i,e){const t=function lee(i,e){const o=new Qy([],{},{},"",{},pi,e,null,i.root,-1,{});return new dN("",new ml(o,[]))}(i,e),n=new Qs([new y_("",{})]),r=new Qs({}),s=new Qs({}),o=new Qs({}),a=new Qs(""),l=new Ld(n,r,o,a,s,pi,e,t.root);return l.snapshot=t.root,new aN(new ml(l,[]),t)}class Ld{constructor(e,t,n,r,s,o,a,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.title=this.data?.pipe(vt(c=>c[v_]))??wt(void 0),this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(vt(e=>Kh(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(vt(e=>Kh(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function cN(i,e="emptyOnly"){const t=i.pathFromRoot;let n=0;if("always"!==e)for(n=t.length-1;n>=1;){const r=t[n],s=t[n-1];if(r.routeConfig&&""===r.routeConfig.path)n--;else{if(s.component)break;n--}}return function cee(i){return i.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(n))}class Qy{get title(){return this.data?.[v_]}constructor(e,t,n,r,s,o,a,l,c,d,u){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=d,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Kh(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Kh(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class dN extends oN{constructor(e,t){super(t),this.url=e,CS(this,t)}toString(){return uN(this._root)}}function CS(i,e){e.value._routerState=i,e.children.forEach(t=>CS(i,t))}function uN(i){const e=i.children.length>0?` { ${i.children.map(uN).join(", ")} } `:"";return`${i.value}${e}`}function MS(i){if(i.snapshot){const e=i.snapshot,t=i._futureSnapshot;i.snapshot=t,Sa(e.queryParams,t.queryParams)||i.queryParams.next(t.queryParams),e.fragment!==t.fragment&&i.fragment.next(t.fragment),Sa(e.params,t.params)||i.params.next(t.params),function wJ(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;++t)if(!Sa(i[t],e[t]))return!1;return!0}(e.url,t.url)||i.url.next(t.url),Sa(e.data,t.data)||i.data.next(t.data)}else i.snapshot=i._futureSnapshot,i.data.next(i._futureSnapshot.data)}function ES(i,e){const t=Sa(i.params,e.params)&&function SJ(i,e){return kd(i,e)&&i.every((t,n)=>Sa(t.parameters,e[n].parameters))}(i.url,e.url);return t&&!(!i.parent!=!e.parent)&&(!i.parent||ES(i.parent,e.parent))}function S_(i,e,t){if(t&&i.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const r=function uee(i,e,t){return e.children.map(n=>{for(const r of t.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return S_(i,n,r);return S_(i,n)})}(i,e,t);return new ml(n,r)}{if(i.shouldAttach(e.value)){const s=i.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>S_(i,a)),o}}const n=function hee(i){return new Ld(new Qs(i.url),new Qs(i.params),new Qs(i.queryParams),new Qs(i.fragment),new Qs(i.data),i.outlet,i.component,i)}(e.value),r=e.children.map(s=>S_(i,s));return new ml(n,r)}}const SS="ngNavigationCancelingError";function hN(i,e){const{redirectTo:t,navigationBehaviorOptions:n}=Fd(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=fN(!1,0,e);return r.url=t,r.navigationBehaviorOptions=n,r}function fN(i,e,t){const n=new Error("NavigationCancelingError: "+(i||""));return n[SS]=!0,n.cancellationCode=e,t&&(n.url=t),n}function pN(i){return mN(i)&&Fd(i.url)}function mN(i){return i&&i[SS]}class fee{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new T_,this.attachRef=null}}let T_=(()=>{class i{constructor(){this.contexts=new Map}onChildOutletCreated(t,n){const r=this.getOrCreateContext(t);r.outlet=n,this.contexts.set(t,r)}onChildOutletDestroyed(t){const n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new fee,this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Wy=!1;let TS=(()=>{class i{constructor(){this.activated=null,this._activatedRoute=null,this.name=pi,this.activateEvents=new Ct,this.deactivateEvents=new Ct,this.attachEvents=new Ct,this.detachEvents=new Ct,this.parentContexts=Ut(T_),this.location=Ut(Qr),this.changeDetector=Ut(er),this.environmentInjector=Ut(va)}ngOnChanges(t){if(t.name){const{firstChange:n,previousValue:r}=t.name;if(n)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Me(4012,Wy);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Me(4012,Wy);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Me(4012,Wy);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new Me(4013,Wy);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new pee(t,a,r.injector);if(n&&function mee(i){return!!i.resolveComponentFactory}(n)){const c=n.resolveComponentFactory(o);this.activated=r.createComponent(c,r.length,l)}else this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:n??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=ke({type:i,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Pr]}),i})();class pee{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===Ld?this.route:e===T_?this.childContexts:this.parent.get(e,t)}}let IS=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=$({type:i,selectors:[["ng-component"]],standalone:!0,features:[uE],decls:1,vars:0,template:function(t,n){1&t&&ze(0,"router-outlet")},dependencies:[TS],encapsulation:2}),i})();function gN(i,e){return i.providers&&!i._injector&&(i._injector=ry(i.providers,e,`Route: ${i.path}`)),i._injector??e}function DS(i){const e=i.children&&i.children.map(DS),t=e?{...i,children:e}:{...i};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==pi&&(t.component=IS),t}function vo(i){return i.outlet||pi}function _N(i,e){const t=i.filter(n=>vo(n)===e);return t.push(...i.filter(n=>vo(n)!==e)),t}function I_(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let e=i.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class yee{constructor(e,t,n,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),MS(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const r=ef(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],n),delete r[o]}),Br(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=ef(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(n&&n.outlet){const o=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=ef(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(e,t,n){const r=ef(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],n),this.forwardEvent(new ree(s.value.snapshot))}),e.children.length&&this.forwardEvent(new iee(e.value.snapshot))}activateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(MS(r),r===s)if(r.component){const o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(r.component){const o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),MS(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=I_(r.snapshot),l=a?.get(Yl)??null;o.attachRef=null,o.route=r,o.resolver=l,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}class bN{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class qy{constructor(e,t){this.component=e,this.route=t}}function Aee(i,e,t){const n=i._root;return R_(n,e?e._root:null,t,[n.value])}function tf(i,e){const t=Symbol(),n=e.get(i,t);return n===t?"function"!=typeof i||function NQ(i){return null!==rv(i)}(i)?e.get(i):i:n}function R_(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=ef(e);return i.children.forEach(o=>{(function wee(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=i.value,o=e?e.value:null,a=t?t.getContext(i.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function Cee(i,e,t){if("function"==typeof t)return t(i,e);switch(t){case"pathParamsChange":return!kd(i.url,e.url);case"pathParamsOrQueryParamsChange":return!kd(i.url,e.url)||!Sa(i.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ES(i,e)||!Sa(i.queryParams,e.queryParams);default:return!ES(i,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new bN(n)):(s.data=o.data,s._resolvedData=o._resolvedData),R_(i,e,s.component?a?a.children:null:t,n,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new qy(a.outlet.component,o))}else o&&D_(e,a,r),r.canActivateChecks.push(new bN(n)),R_(i,null,s.component?a?a.children:null:t,n,r)})(o,s[o.value.outlet],t,n.concat([o.value]),r),delete s[o.value.outlet]}),Br(s,(o,a)=>D_(o,t.getContext(a),r)),r}function D_(i,e,t){const n=ef(i),r=i.value;Br(n,(s,o)=>{D_(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new qy(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function P_(i){return"function"==typeof i}function PS(i){return i instanceof Py||"EmptyError"===i?.name}const Xy=Symbol("INITIAL_VALUE");function nf(){return Ws(i=>uS(i.map(e=>e.pipe(ps(1),ec(Xy)))).pipe(vt(e=>{for(const t of e)if(!0!==t){if(t===Xy)return Xy;if(!1===t||t instanceof Pd)return t}return!0}),Bn(e=>e!==Xy),ps(1)))}function vN(i){return function oQ(...i){return k2(i)}(nn(e=>{if(Fd(e))throw hN(0,e)}),vt(e=>!0===e))}const kS={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function yN(i,e,t,n,r){const s=FS(i,e,t);return s.matched?function Vee(i,e,t,n){const r=e.canMatch;return r&&0!==r.length?wt(r.map(o=>{const a=tf(o,i);return nc(function Ree(i){return i&&P_(i.canMatch)}(a)?a.canMatch(e,t):i.runInContext(()=>a(e,t)))})).pipe(nf(),vN()):wt(!0)}(n=gN(e,n),e,t).pipe(vt(o=>!0===o?s:{...kS})):wt(s)}function FS(i,e,t){if(""===e.path)return"full"===e.pathMatch&&(i.hasChildren()||t.length>0)?{...kS}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||xJ)(t,i,e);if(!r)return{...kS};const s={};Br(r.posParams,(a,l)=>{s[l]=a.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function Yy(i,e,t,n){if(t.length>0&&function Gee(i,e,t){return t.some(n=>Zy(i,e,n)&&vo(n)!==pi)}(i,t,n)){const s=new _i(e,function Hee(i,e,t,n){const r={};r[pi]=n,n._sourceSegment=i,n._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&vo(s)!==pi){const o=new _i([],{});o._sourceSegment=i,o._segmentIndexShift=e.length,r[vo(s)]=o}return r}(i,e,n,new _i(t,i.children)));return s._sourceSegment=i,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===t.length&&function Qee(i,e,t){return t.some(n=>Zy(i,e,n))}(i,t,n)){const s=new _i(i.segments,function zee(i,e,t,n,r){const s={};for(const o of n)if(Zy(i,t,o)&&!r[vo(o)]){const a=new _i([],{});a._sourceSegment=i,a._segmentIndexShift=e.length,s[vo(o)]=a}return{...r,...s}}(i,e,t,n,i.children));return s._sourceSegment=i,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}const r=new _i(i.segments,i.children);return r._sourceSegment=i,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:t}}function Zy(i,e,t){return(!(i.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function AN(i,e,t,n){return!!(vo(i)===n||n!==pi&&Zy(e,t,i))&&("**"===i.path||FS(e,i,t).matched)}function xN(i,e,t){return 0===e.length&&!i.children[t]}const Ky=!1;class $y{constructor(e){this.segmentGroup=e||null}}class wN{constructor(e){this.urlTree=e}}function k_(i){return Zo(new $y(i))}function CN(i){return Zo(new wN(i))}class Yee{constructor(e,t,n,r,s){this.injector=e,this.configLoader=t,this.urlSerializer=n,this.urlTree=r,this.config=s,this.allowRedirects=!0}apply(){const e=Yy(this.urlTree.root,[],[],this.config).segmentGroup,t=new _i(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,pi).pipe(vt(s=>this.createUrlTree(Hy(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Ko(s=>{if(s instanceof wN)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof $y?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,pi).pipe(vt(r=>this.createUrlTree(Hy(r),e.queryParams,e.fragment))).pipe(Ko(r=>{throw r instanceof $y?this.noMatchError(r):r}))}noMatchError(e){return new Me(4002,Ky)}createUrlTree(e,t,n){const r=_S(e);return new Pd(r,t,n)}expandSegmentGroup(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(vt(s=>new _i([],s))):this.expandSegment(e,n,t,n.segments,r,!0)}expandChildren(e,t,n){const r=[];for(const s of Object.keys(n.children))"primary"===s?r.unshift(s):r.push(s);return wn(r).pipe(ic(s=>{const o=n.children[s],a=_N(t,s);return this.expandSegmentGroup(e,a,o,s).pipe(vt(l=>({segment:l,outlet:s})))}),N3((s,o)=>(s[o.outlet]=o.segment,s),{}),j3())}expandSegment(e,t,n,r,s,o){return wn(n).pipe(ic(a=>this.expandSegmentAgainstRoute(e,t,n,a,r,s,o).pipe(Ko(c=>{if(c instanceof $y)return wt(null);throw c}))),tc(a=>!!a),Ko((a,l)=>{if(PS(a))return xN(t,r,s)?wt(new _i([],{})):k_(t);throw a}))}expandSegmentAgainstRoute(e,t,n,r,s,o,a){return AN(r,t,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o):k_(t):k_(t)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,r){const s=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?CN(s):this.lineralizeSegments(n,s).pipe(Mr(o=>{const a=new _i(o,{});return this.expandSegment(e,a,t,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:d}=FS(t,r,s);if(!a)return k_(t);const u=this.applyRedirectCommands(l,r.redirectTo,d);return r.redirectTo.startsWith("/")?CN(u):this.lineralizeSegments(r,u).pipe(Mr(h=>this.expandSegment(e,t,n,h.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,n,r,s){return"**"===n.path?(e=gN(n,e),n.loadChildren?(n._loadedRoutes?wt({routes:n._loadedRoutes,injector:n._loadedInjector}):this.configLoader.loadChildren(e,n)).pipe(vt(a=>(n._loadedRoutes=a.routes,n._loadedInjector=a.injector,new _i(r,{})))):wt(new _i(r,{}))):yN(t,n,r,e).pipe(Ws(({matched:o,consumedSegments:a,remainingSegments:l})=>o?this.getChildConfig(e=n._injector??e,n,r).pipe(Mr(d=>{const u=d.injector??e,h=d.routes,{segmentGroup:f,slicedSegments:m}=Yy(t,a,l,h),p=new _i(f.segments,f.children);if(0===m.length&&p.hasChildren())return this.expandChildren(u,h,p).pipe(vt(b=>new _i(a,b)));if(0===h.length&&0===m.length)return wt(new _i(a,{}));const g=vo(n)===s;return this.expandSegment(u,p,h,m,g?pi:s,!0).pipe(vt(v=>new _i(a.concat(v.segments),v.children)))})):k_(t)))}getChildConfig(e,t,n){return t.children?wt({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?wt({routes:t._loadedRoutes,injector:t._loadedInjector}):function Uee(i,e,t,n){const r=e.canLoad;return void 0===r||0===r.length?wt(!0):wt(r.map(o=>{const a=tf(o,i);return nc(function Eee(i){return i&&P_(i.canLoad)}(a)?a.canLoad(e,t):i.runInContext(()=>a(e,t)))})).pipe(nf(),vN())}(e,t,n).pipe(Mr(r=>r?this.configLoader.loadChildren(e,t).pipe(nn(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function qee(i){return Zo(fN(Ky,3))}())):wt({routes:[],injector:e})}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return wt(n);if(r.numberOfChildren>1||!r.children[pi])return Zo(new Me(4e3,Ky));r=r.children[pi]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreateUrlTree(e,t,n,r){const s=this.createSegmentGroup(e,t.root,n,r);return new Pd(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return Br(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);n[s]=t[a]}else n[s]=r}),n}createSegmentGroup(e,t,n,r){const s=this.createSegments(e,t.segments,n,r);let o={};return Br(t.children,(a,l)=>{o[l]=this.createSegmentGroup(e,a,n,r)}),new _i(s,o)}createSegments(e,t,n,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,n))}findPosParam(e,t,n){const r=n[t.path.substring(1)];if(!r)throw new Me(4001,Ky);return r}findOrReturn(e,t){let n=0;for(const r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}}class Kee{}class ete{constructor(e,t,n,r,s,o,a){this.injector=e,this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a}recognize(){const e=Yy(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,pi).pipe(vt(t=>{if(null===t)return null;const n=new Qy([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},pi,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new ml(n,t),s=new dN(this.url,r);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(e){const t=e.value,n=cN(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.processChildren(e,t,n):this.processSegment(e,t,n,n.segments,r)}processChildren(e,t,n){return wn(Object.keys(n.children)).pipe(ic(r=>{const s=n.children[r],o=_N(t,r);return this.processSegmentGroup(e,o,s,r)}),N3((r,s)=>r&&s?(r.push(...s),r):null),function yJ(i,e=!1){return xn((t,n)=>{let r=0;t.subscribe(dn(n,s=>{const o=i(s,r++);(o||e)&&n.next(s),!o&&n.complete()}))})}(r=>null!==r),By(null),j3(),vt(r=>{if(null===r)return null;const s=EN(r);return function tte(i){i.sort((e,t)=>e.value.outlet===pi?-1:t.value.outlet===pi?1:e.value.outlet.localeCompare(t.value.outlet))}(s),s}))}processSegment(e,t,n,r,s){return wn(t).pipe(ic(o=>this.processSegmentAgainstRoute(o._injector??e,o,n,r,s)),tc(o=>!!o),Ko(o=>{if(PS(o))return xN(n,r,s)?wt([]):wt(null);throw o}))}processSegmentAgainstRoute(e,t,n,r,s){if(t.redirectTo||!AN(t,n,r,s))return wt(null);let o;if("**"===t.path){const a=r.length>0?z3(r).parameters:{},l=TN(n)+r.length;o=wt({snapshot:new Qy(r,a,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,IN(t),vo(t),t.component??t._loadedComponent??null,t,SN(n),l,RN(t)),consumedSegments:[],remainingSegments:[]})}else o=yN(n,t,r,e).pipe(vt(({matched:a,consumedSegments:l,remainingSegments:c,parameters:d})=>{if(!a)return null;const u=TN(n)+l.length;return{snapshot:new Qy(l,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,IN(t),vo(t),t.component??t._loadedComponent??null,t,SN(n),u,RN(t)),consumedSegments:l,remainingSegments:c}}));return o.pipe(Ws(a=>{if(null===a)return wt(null);const{snapshot:l,consumedSegments:c,remainingSegments:d}=a;e=t._injector??e;const u=t._loadedInjector??e,h=function ite(i){return i.children?i.children:i.loadChildren?i._loadedRoutes:[]}(t),{segmentGroup:f,slicedSegments:m}=Yy(n,c,d,h.filter(g=>void 0===g.redirectTo));if(0===m.length&&f.hasChildren())return this.processChildren(u,h,f).pipe(vt(g=>null===g?null:[new ml(l,g)]));if(0===h.length&&0===m.length)return wt([new ml(l,[])]);const p=vo(t)===s;return this.processSegment(u,h,f,m,p?pi:s).pipe(vt(g=>null===g?null:[new ml(l,g)]))}))}}function nte(i){const e=i.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function EN(i){const e=[],t=new Set;for(const n of i){if(!nte(n)){e.push(n);continue}const r=e.find(s=>n.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...n.children),t.add(r)):e.push(n)}for(const n of t){const r=EN(n.children);e.push(new ml(n.value,r))}return e.filter(n=>!t.has(n))}function SN(i){let e=i;for(;e._sourceSegment;)e=e._sourceSegment;return e}function TN(i){let e=i,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function IN(i){return i.data||{}}function RN(i){return i.resolve||{}}function DN(i){return"string"==typeof i.title||null===i.title}function BS(i){return Ws(e=>{const t=i(e);return t?wn(t).pipe(vt(()=>e)):wt(e)})}const rf=new Fe("ROUTES");let LS=(()=>{class i{constructor(t,n){this.injector=t,this.compiler=n,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return wt(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const n=nc(t.loadComponent()).pipe(vt(kN),nn(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Ly(()=>{this.componentLoaders.delete(t)})),r=new hS(n,()=>new Wt).pipe(Fy());return this.componentLoaders.set(t,r),r}loadChildren(t,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return wt({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);const s=this.loadModuleFactoryOrRoutes(n.loadChildren).pipe(vt(a=>{this.onLoadEndListener&&this.onLoadEndListener(n);let l,c,d=!1;Array.isArray(a)?c=a:(l=a.create(t).injector,c=V3(l.get(rf,[],jt.Self|jt.Optional)));return{routes:c.map(DS),injector:l}}),Ly(()=>{this.childrenLoaders.delete(n)})),o=new hS(s,()=>new Wt).pipe(Fy());return this.childrenLoaders.set(n,o),o}loadModuleFactoryOrRoutes(t){return nc(t()).pipe(vt(kN),Mr(r=>r instanceof gL||Array.isArray(r)?wt(r):wn(this.compiler.compileModuleAsync(r))))}}return i.\u0275fac=function(t){return new(t||i)(ye(_s),ye(sO))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function kN(i){return function hte(i){return i&&"object"==typeof i&&"default"in i}(i)?i.default:i}let eA=(()=>{class i{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Wt,this.configLoader=Ut(LS),this.environmentInjector=Ut(va),this.urlSerializer=Ut(A_),this.rootContexts=Ut(T_),this.navigationId=0,this.afterPreactivation=()=>wt(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new eee(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new JJ(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const n=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:n})}setupNavigations(t){return this.transitions=new Qs({id:0,targetPageId:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:E_,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Bn(n=>0!==n.id),vt(n=>({...n,extractedUrl:t.urlHandlingStrategy.extract(n.rawUrl)})),Ws(n=>{let r=!1,s=!1;return wt(n).pipe(nn(o=>{this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Ws(o=>{const a=t.browserUrlTree.toString(),l=!t.navigated||o.extractedUrl.toString()!==a||a!==t.currentUrlTree.toString();if(!l&&"reload"!==(o.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const d="";return this.events.next(new nN(o.id,t.serializeUrl(n.rawUrl),d,0)),t.rawUrlTree=o.rawUrl,o.resolve(null),jr}if(t.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return FN(o.source)&&(t.browserUrlTree=o.extractedUrl),wt(o).pipe(Ws(d=>{const u=this.transitions?.getValue();return this.events.next(new AS(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),u!==this.transitions?.getValue()?jr:Promise.resolve(d)}),function Zee(i,e,t,n){return Ws(r=>function Xee(i,e,t,n,r){return new Yee(i,e,t,n,r).apply()}(i,e,t,r.extractedUrl,n).pipe(vt(s=>({...r,urlAfterRedirects:s}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,t.config),nn(d=>{this.currentNavigation={...this.currentNavigation,finalUrl:d.urlAfterRedirects},n.urlAfterRedirects=d.urlAfterRedirects}),function ste(i,e,t,n,r){return Mr(s=>function Jee(i,e,t,n,r,s,o="emptyOnly"){return new ete(i,e,t,n,r,o,s).recognize().pipe(Ws(a=>null===a?function $ee(i){return new Fi(e=>e.error(i))}(new Kee):wt(a)))}(i,e,t,s.urlAfterRedirects,n.serialize(s.urlAfterRedirects),n,r).pipe(vt(o=>({...s,targetSnapshot:o}))))}(this.environmentInjector,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),nn(d=>{if(n.targetSnapshot=d.targetSnapshot,"eager"===t.urlUpdateStrategy){if(!d.extras.skipLocationChange){const h=t.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl);t.setBrowserUrl(h,d)}t.browserUrlTree=d.urlAfterRedirects}const u=new XJ(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(u)}));if(l&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:d,extractedUrl:u,source:h,restoredState:f,extras:m}=o,p=new AS(d,this.urlSerializer.serialize(u),h,f);this.events.next(p);const g=lN(u,this.rootComponentType).snapshot;return wt(n={...o,targetSnapshot:g,urlAfterRedirects:u,extras:{...m,skipLocationChange:!1,replaceUrl:!1}})}{const d="";return this.events.next(new nN(o.id,t.serializeUrl(n.extractedUrl),d,1)),t.rawUrlTree=o.rawUrl,o.resolve(null),jr}}),nn(o=>{const a=new YJ(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),vt(o=>n={...o,guards:Aee(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),function Pee(i,e){return Mr(t=>{const{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?wt({...t,guardsResult:!0}):function kee(i,e,t,n){return wn(i).pipe(Mr(r=>function jee(i,e,t,n,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?wt(s.map(a=>{const l=I_(e)??r,c=tf(a,l);return nc(function Iee(i){return i&&P_(i.canDeactivate)}(c)?c.canDeactivate(i,e,t,n):l.runInContext(()=>c(i,e,t,n))).pipe(tc())})).pipe(nf()):wt(!0)}(r.component,r.route,t,e,n)),tc(r=>!0!==r,!0))}(o,n,r,i).pipe(Mr(a=>a&&function Mee(i){return"boolean"==typeof i}(a)?function Fee(i,e,t,n){return wn(e).pipe(ic(r=>ky(function Lee(i,e){return null!==i&&e&&e(new tee(i)),wt(!0)}(r.route.parent,n),function Bee(i,e){return null!==i&&e&&e(new nee(i)),wt(!0)}(r.route,n),function Nee(i,e,t){const n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function xee(i){const e=i.routeConfig?i.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:i,guards:e}:null}(o)).filter(o=>null!==o).map(o=>L3(()=>wt(o.guards.map(l=>{const c=I_(o.node)??t,d=tf(l,c);return nc(function Tee(i){return i&&P_(i.canActivateChild)}(d)?d.canActivateChild(n,i):c.runInContext(()=>d(n,i))).pipe(tc())})).pipe(nf())));return wt(s).pipe(nf())}(i,r.path,t),function Oee(i,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return wt(!0);const r=n.map(s=>L3(()=>{const o=I_(e)??t,a=tf(s,o);return nc(function See(i){return i&&P_(i.canActivate)}(a)?a.canActivate(e,i):o.runInContext(()=>a(e,i))).pipe(tc())}));return wt(r).pipe(nf())}(i,r.route,t))),tc(r=>!0!==r,!0))}(n,s,i,e):wt(a)),vt(a=>({...t,guardsResult:a})))})}(this.environmentInjector,o=>this.events.next(o)),nn(o=>{if(n.guardsResult=o.guardsResult,Fd(o.guardsResult))throw hN(0,o.guardsResult);const a=new ZJ(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),Bn(o=>!!o.guardsResult||(t.restoreHistory(o),this.cancelNavigationTransition(o,"",3),!1)),BS(o=>{if(o.guards.canActivateChecks.length)return wt(o).pipe(nn(a=>{const l=new KJ(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}),Ws(a=>{let l=!1;return wt(a).pipe(function ote(i,e){return Mr(t=>{const{targetSnapshot:n,guards:{canActivateChecks:r}}=t;if(!r.length)return wt(t);let s=0;return wn(r).pipe(ic(o=>function ate(i,e,t,n){const r=i.routeConfig,s=i._resolve;return void 0!==r?.title&&!DN(r)&&(s[v_]=r.title),function lte(i,e,t,n){const r=function cte(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}(i);if(0===r.length)return wt({});const s={};return wn(r).pipe(Mr(o=>function dte(i,e,t,n){const r=I_(e)??n,s=tf(i,r);return nc(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(i[o],e,t,n).pipe(tc(),nn(a=>{s[o]=a}))),fS(1),pS(s),Ko(o=>PS(o)?jr:Zo(o)))}(s,i,e,n).pipe(vt(o=>(i._resolvedData=o,i.data=cN(i,t).resolve,r&&DN(r)&&(i.data[v_]=r.title),null)))}(o.route,n,i,e)),nn(()=>s++),fS(1),Mr(o=>s===r.length?wt(t):jr))})}(t.paramsInheritanceStrategy,this.environmentInjector),nn({next:()=>l=!0,complete:()=>{l||(t.restoreHistory(a),this.cancelNavigationTransition(a,"",2))}}))}),nn(a=>{const l=new $J(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}))}),BS(o=>{const a=l=>{const c=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&c.push(this.configLoader.loadComponent(l.routeConfig).pipe(nn(d=>{l.component=d}),vt(()=>{})));for(const d of l.children)c.push(...a(d));return c};return uS(a(o.targetSnapshot.root)).pipe(By(),ps(1))}),BS(()=>this.afterPreactivation()),vt(o=>{const a=function dee(i,e,t){const n=S_(i,e._root,t?t._root:void 0);return new aN(n,e)}(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return n={...o,targetRouterState:a}}),nn(o=>{t.currentUrlTree=o.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(o.urlAfterRedirects,o.rawUrl),t.routerState=o.targetRouterState,"deferred"===t.urlUpdateStrategy&&(o.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,o),t.browserUrlTree=o.urlAfterRedirects)}),((i,e,t)=>vt(n=>(new yee(e,n.targetRouterState,n.currentRouterState,t).activate(i),n)))(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o)),nn({next:o=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new Bd(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{r=!0}}),Ly(()=>{r||s||this.cancelNavigationTransition(n,"",1),this.currentNavigation?.id===n.id&&(this.currentNavigation=null)}),Ko(o=>{if(s=!0,mN(o)){pN(o)||(t.navigated=!0,t.restoreHistory(n,!0));const a=new Gy(n.id,this.urlSerializer.serialize(n.extractedUrl),o.message,o.cancellationCode);if(this.events.next(a),pN(o)){const l=t.urlHandlingStrategy.merge(o.url,t.rawUrlTree),c={skipLocationChange:n.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||FN(n.source)};t.scheduleNavigation(l,E_,null,c,{resolve:n.resolve,reject:n.reject,promise:n.promise})}else n.resolve(!1)}else{t.restoreHistory(n,!0);const a=new rN(n.id,this.urlSerializer.serialize(n.extractedUrl),o,n.targetSnapshot??void 0);this.events.next(a);try{n.resolve(t.errorHandler(o))}catch(l){n.reject(l)}}return jr}))}))}cancelNavigationTransition(t,n,r){const s=new Gy(t.id,this.urlSerializer.serialize(t.extractedUrl),n,r);this.events.next(s),t.resolve(!1)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function FN(i){return i!==E_}let BN=(()=>{class i{buildTitle(t){let n,r=t.root;for(;void 0!==r;)n=this.getResolvedTitleForRoute(r)??n,r=r.children.find(s=>s.outlet===pi);return n}getResolvedTitleForRoute(t){return t.data[v_]}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:function(){return Ut(fte)},providedIn:"root"}),i})(),fte=(()=>{class i extends BN{constructor(t){super(),this.title=t}updateTitle(t){const n=this.buildTitle(t);void 0!==n&&this.title.setTitle(n)}}return i.\u0275fac=function(t){return new(t||i)(ye(I3))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),pte=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:function(){return Ut(gte)},providedIn:"root"}),i})();class mte{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let gte=(()=>{class i extends mte{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=ce(i)))(n||i)}}(),i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const tA=new Fe("",{providedIn:"root",factory:()=>({})});let bte=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:function(){return Ut(vte)},providedIn:"root"}),i})(),vte=(()=>{class i{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function yte(i){throw i}function Ate(i,e,t){return e.parse("/")}const xte={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},wte={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let qs=(()=>{class i{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=Ut(tZ),this.isNgZoneEnabled=!1,this.options=Ut(tA,{optional:!0})||{},this.errorHandler=this.options.errorHandler||yte,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Ate,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=Ut(bte),this.routeReuseStrategy=Ut(pte),this.urlCreationStrategy=Ut(aee),this.titleStrategy=Ut(BN),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=V3(Ut(rf,{optional:!0})??[]),this.navigationTransitions=Ut(eA),this.urlSerializer=Ut(A_),this.location=Ut(my),this.isNgZoneEnabled=Ut(at)instanceof at&&at.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Pd,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=lN(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),E_,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const n="popstate"===t.type?"popstate":"hashchange";"popstate"===n&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,n,t.state)},0)}))}navigateToSyncWithBrowser(t,n,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const l={...r};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t);this.scheduleNavigation(a,n,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(t){this.config=t.map(DS),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,n={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=n,c=l?this.currentUrlTree.fragment:o;let d=null;switch(a){case"merge":d={...this.currentUrlTree.queryParams,...s};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}return null!==d&&(d=this.removeEmptyProps(d)),this.urlCreationStrategy.createUrlTree(r,this.routerState,this.currentUrlTree,t,d,c??null)}navigateByUrl(t,n={skipLocationChange:!1}){const r=Fd(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,E_,null,n)}navigate(t,n={skipLocationChange:!1}){return function Cte(i){for(let e=0;e<i.length;e++){if(null==i[e])throw new Me(4008,!1)}}(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let n;try{n=this.urlSerializer.parse(t)}catch(r){n=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return n}isActive(t,n){let r;if(r=!0===n?{...xte}:!1===n?{...wte}:n,Fd(t))return G3(this.currentUrlTree,t,r);const s=this.parseUrl(t);return G3(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((n,r)=>{const s=t[r];return null!=s&&(n[r]=s),n},{})}scheduleNavigation(t,n,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c,d;return o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((u,h)=>{a=u,l=h}),d="computed"===this.canceledNavigationResolution?r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:d,source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(u=>Promise.reject(u))}setBrowserUrl(t,n){const r=this.urlSerializer.serialize(t),s={...n.extras.state,...this.generateNgRouterState(n.id,n.targetPageId)};this.location.isCurrentPathEqualTo(r)||n.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,n=!1){if("computed"===this.canceledNavigationResolution){const r=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===r?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===r&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(r)}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,n){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),iA=(()=>{class i{constructor(t,n,r,s,o,a){this.router=t,this.route=n,this.tabIndexAttribute=r,this.renderer=s,this.el=o,this.locationStrategy=a,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new Wt;const l=o.nativeElement.tagName;this.isAnchorElement="A"===l||"AREA"===l,this.isAnchorElement?this.subscription=t.events.subscribe(c=>{c instanceof Bd&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(t){this._preserveFragment=Zh(t)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(t){this._skipLocationChange=Zh(t)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(t){this._replaceUrl=Zh(t)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,n,r,s,o){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||n||r||s||o||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:function qk(i,e,t){return function p7(i,e){return"src"===e&&("embed"===i||"frame"===i||"iframe"===i||"media"===i||"script"===i)||"href"===e&&("base"===i||"link"===i)?Wk:Qk}(e,t)(i)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,n){const r=this.renderer,s=this.el.nativeElement;null!==n?r.setAttribute(s,t,n):r.removeAttribute(s,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return i.\u0275fac=function(t){return new(t||i)(R(qs),R(Ld),Lg("tabindex"),R(ll),R(Ht),R(Rd))},i.\u0275dir=ke({type:i,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(t,n){1&t&&mt("click",function(s){return n.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&t&&hn("target",n.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[Pr]}),i})();class ON{}let Ste=(()=>{class i{constructor(t,n,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Bn(t=>t instanceof Bd),ic(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,n){const r=[];for(const s of n){s.providers&&!s._injector&&(s._injector=ry(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent?r.push(this.preloadConfig(o,s)):(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return wn(r).pipe(ch())}preloadConfig(t,n){return this.preloadingStrategy.preload(n,()=>{let r;r=n.loadChildren&&void 0===n.canLoad?this.loader.loadChildren(t,n):wt(null);const s=r.pipe(Mr(o=>null===o?wt(void 0):(n._loadedRoutes=o.routes,n._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return n.loadComponent&&!n._loadedComponent?wn([s,this.loader.loadComponent(n)]).pipe(ch()):s})}}return i.\u0275fac=function(t){return new(t||i)(ye(qs),ye(sO),ye(va),ye(ON),ye(LS))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const OS=new Fe("");let NN=(()=>{class i{constructor(t,n,r,s,o={}){this.urlSerializer=t,this.transitions=n,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof AS?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Bd&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof sN&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,n){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new sN(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return i.\u0275fac=function(t){Xg()},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();function Od(i,e){return{\u0275kind:i,\u0275providers:e}}function UN(){const i=Ut(_s);return e=>{const t=i.get(Yh);if(e!==t.components[0])return;const n=i.get(qs),r=i.get(VN);1===i.get(jS)&&n.initialNavigation(),i.get(zN,null,jt.Optional)?.setUpPreloading(),i.get(OS,null,jt.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.unsubscribe())}}const VN=new Fe("",{factory:()=>new Wt}),jS=new Fe("",{providedIn:"root",factory:()=>1});const zN=new Fe("");function Pte(i){return Od(0,[{provide:zN,useExisting:Ste},{provide:ON,useExisting:i}])}const HN=new Fe("ROUTER_FORROOT_GUARD"),kte=[my,{provide:A_,useClass:mS},qs,T_,{provide:Ld,useFactory:function jN(i){return i.routerState.root},deps:[qs]},LS,[]];function Fte(){return new hO("Router",qs)}let GN=(()=>{class i{constructor(t){}static forRoot(t,n){return{ngModule:i,providers:[kte,[],{provide:rf,multi:!0,useValue:t},{provide:HN,useFactory:Nte,deps:[[qs,new ol,new Mh]]},{provide:tA,useValue:n||{}},n?.useHash?{provide:Rd,useClass:zZ}:{provide:Rd,useClass:BO},{provide:OS,useFactory:()=>{const i=Ut(n$),e=Ut(at),t=Ut(tA),n=Ut(eA),r=Ut(A_);return t.scrollOffset&&i.setOffset(t.scrollOffset),new NN(r,n,i,e,t)}},n?.preloadingStrategy?Pte(n.preloadingStrategy).\u0275providers:[],{provide:hO,multi:!0,useFactory:Fte},n?.initialNavigation?jte(n):[],[{provide:QN,useFactory:UN},{provide:rO,multi:!0,useExisting:QN}]]}}static forChild(t){return{ngModule:i,providers:[{provide:rf,multi:!0,useValue:t}]}}}return i.\u0275fac=function(t){return new(t||i)(ye(HN,8))},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[IS]}),i})();function Nte(i){return"guarded"}function jte(i){return["disabled"===i.initialNavigation?Od(3,[{provide:ly,multi:!0,useFactory:()=>{const e=Ut(qs);return()=>{e.setUpLocationChangeListener()}}},{provide:jS,useValue:2}]).\u0275providers:[],"enabledBlocking"===i.initialNavigation?Od(2,[{provide:jS,useValue:0},{provide:ly,multi:!0,deps:[_s],useFactory:e=>{const t=e.get(UZ,Promise.resolve());return()=>t.then(()=>new Promise(r=>{const s=e.get(qs),o=e.get(VN);(function n(r){e.get(qs).events.pipe(Bn(o=>o instanceof Bd||o instanceof Gy||o instanceof rN),vt(o=>o instanceof Bd||o instanceof Gy&&(0===o.code||1===o.code)&&null),Bn(o=>null!==o),ps(1)).subscribe(()=>{r()})})(()=>{r(!0)}),e.get(eA).afterPreactivation=()=>(r(!0),o.closed?wt(void 0):o),s.initialNavigation()}))}}]).\u0275providers:[]]}const QN=new Fe("");function WN(i,e,t,n,r,s,o){try{var a=i[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(n,r)}function ss(i){return function(){var e=this,t=arguments;return new Promise(function(n,r){var s=i.apply(e,t);function o(l){WN(s,n,r,o,a,"next",l)}function a(l){WN(s,n,r,o,a,"throw",l)}o(void 0)})}}const nA="148",yo={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},gl={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},qN=0,US=1,XN=2,Vte=3,zte=0,VS=1,YN=2,af=3,_l=0,ys=1,rc=2,B_=3,Kt=0,Ia=1,lf=2,zS=3,HS=4,cf=5,As=100,ZN=101,KN=102,GS=103,QS=104,df=200,L_=201,$N=202,JN=203,uf=204,O_=205,rA=206,ej=207,sA=208,tj=209,ij=210,nj=0,rj=1,sj=2,oA=3,oj=4,aj=5,lj=6,cj=7,N_=0,dj=1,uj=2,Ra=0,hj=1,fj=2,pj=3,mj=4,gj=5,aA=300,sc=301,oc=302,hf=303,j_=304,ff=306,Ao=1e3,gr=1001,pf=1002,$t=1003,U_=1004,Hte=1004,mf=1005,Gte=1005,Li=1006,lA=1007,Qte=1007,Xs=1008,Wte=1008,Wr=1009,_j=1010,bj=1011,V_=1012,vj=1013,ac=1014,Ln=1015,fn=1016,yj=1017,Aj=1018,lc=1020,xj=1021,wj=1022,En=1023,cA=1024,Cj=1025,cc=1026,dc=1027,bl=1028,Mj=1029,gf=1030,Ej=1031,Sj=1033,_f=33776,dA=33777,z_=33778,bf=33779,vf=35840,H_=35841,yf=35842,G_=35843,uA=36196,hA=37492,fA=37496,pA=37808,WS=37809,qS=37810,XS=37811,YS=37812,ZS=37813,KS=37814,$S=37815,JS=37816,eT=37817,tT=37818,iT=37819,nT=37820,rT=37821,mA=36492,sT=2200,Tj=2201,Ij=2202,Af=2300,Nd=2301,gA=2302,jd=2400,Ud=2401,Q_=2402,_A=2500,oT=2501,qte=0,Rj=1,aT=2,Ys=3e3,hi=3001,Dj=3200,W_=3201,uc=0,Pj=1,Xte="",$o="srgb",xf="srgb-linear",Yte=0,bA=7680,Zte=7681,Kte=7682,$te=7683,Jte=34055,eie=34056,tie=5386,iie=512,nie=513,rie=514,sie=515,oie=516,aie=517,lie=518,kj=519,q_=35044,vA=35048,cie=35040,die=35045,uie=35049,hie=35041,fie=35046,pie=35050,mie=35042,gie="100",lT="300 es",yA=1035;class os{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const n=this._listeners[e.type];if(void 0!==n){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const qr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Fj=1234567;const Vd=Math.PI/180,X_=180/Math.PI;function Zs(){const i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(qr[255&i]+qr[i>>8&255]+qr[i>>16&255]+qr[i>>24&255]+"-"+qr[255&e]+qr[e>>8&255]+"-"+qr[e>>16&15|64]+qr[e>>24&255]+"-"+qr[63&t|128]+qr[t>>8&255]+"-"+qr[t>>16&255]+qr[t>>24&255]+qr[255&n]+qr[n>>8&255]+qr[n>>16&255]+qr[n>>24&255]).toLowerCase()}function Wn(i,e,t){return Math.max(e,Math.min(t,i))}function cT(i,e){return(i%e+e)%e}function Y_(i,e,t){return(1-t)*i+t*e}function dT(i){return 0==(i&i-1)&&0!==i}function Bj(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function AA(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function vl(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Zi(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return Math.round(65535*i);case Uint8Array:return Math.round(255*i);case Int16Array:return Math.round(32767*i);case Int8Array:return Math.round(127*i);default:throw new Error("Invalid component type.")}}var gt=Object.freeze({__proto__:null,DEG2RAD:Vd,RAD2DEG:X_,generateUUID:Zs,clamp:Wn,euclideanModulo:cT,mapLinear:function _ie(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)},inverseLerp:function bie(i,e,t){return i!==e?(t-i)/(e-i):0},lerp:Y_,damp:function vie(i,e,t,n){return Y_(i,e,1-Math.exp(-t*n))},pingpong:function yie(i,e=1){return e-Math.abs(cT(i,2*e)-e)},smoothstep:function Aie(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e))*i*(3-2*i)},smootherstep:function xie(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e))*i*i*(i*(6*i-15)+10)},randInt:function wie(i,e){return i+Math.floor(Math.random()*(e-i+1))},randFloat:function Cie(i,e){return i+Math.random()*(e-i)},randFloatSpread:function Mie(i){return i*(.5-Math.random())},seededRandom:function Eie(i){void 0!==i&&(Fj=i);let e=Fj+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function Sie(i){return i*Vd},radToDeg:function Tie(i){return i*X_},isPowerOfTwo:dT,ceilPowerOfTwo:Bj,floorPowerOfTwo:AA,setQuaternionFromProperEuler:function Iie(i,e,t,n,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+n)/2),d=o((e+n)/2),u=s((e-n)/2),h=o((e-n)/2),f=s((n-e)/2),m=o((n-e)/2);switch(r){case"XYX":i.set(a*d,l*u,l*h,a*c);break;case"YZY":i.set(l*h,a*d,l*u,a*c);break;case"ZXZ":i.set(l*u,l*h,a*d,a*c);break;case"XZX":i.set(a*d,l*m,l*f,a*c);break;case"YXY":i.set(l*f,a*d,l*m,a*c);break;case"ZYZ":i.set(l*m,l*f,a*d,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:Zi,denormalize:vl});class ue{constructor(e=0,t=0){ue.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Xr{constructor(){Xr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,n,r,s,o,a,l,c){const d=this.elements;return d[0]=e,d[1]=r,d[2]=a,d[3]=t,d[4]=s,d[5]=l,d[6]=n,d[7]=o,d[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[3],l=n[6],c=n[1],d=n[4],u=n[7],h=n[2],f=n[5],m=n[8],p=r[0],g=r[3],_=r[6],v=r[1],b=r[4],y=r[7],x=r[2],C=r[5],M=r[8];return s[0]=o*p+a*v+l*x,s[3]=o*g+a*b+l*C,s[6]=o*_+a*y+l*M,s[1]=c*p+d*v+u*x,s[4]=c*g+d*b+u*C,s[7]=c*_+d*y+u*M,s[2]=h*p+f*v+m*x,s[5]=h*g+f*b+m*C,s[8]=h*_+f*y+m*M,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8];return t*o*d-t*a*c-n*s*d+n*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],u=d*o-a*c,h=a*l-d*s,f=c*s-o*l,m=t*u+n*h+r*f;if(0===m)return this.set(0,0,0,0,0,0,0,0,0);const p=1/m;return e[0]=u*p,e[1]=(r*c-d*n)*p,e[2]=(a*n-r*o)*p,e[3]=h*p,e[4]=(d*t-r*l)*p,e[5]=(r*s-a*t)*p,e[6]=f*p,e[7]=(n*l-c*t)*p,e[8]=(o*t-n*s)*p,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(uT.makeScale(e,t)),this}rotate(e){return this.premultiply(uT.makeRotation(-e)),this}translate(e,t){return this.premultiply(uT.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const uT=new Xr;function Lj(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const Rie={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function wf(i,e){return new Rie[i](e)}function Z_(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function zd(i){return i<.04045?.0773993808*i:Math.pow(.9478672986*i+.0521327014,2.4)}function xA(i){return i<.0031308?12.92*i:1.055*Math.pow(i,.41666)-.055}const hT={[$o]:{[xf]:zd},[xf]:{[$o]:xA}},Yr={legacyMode:!0,get workingColorSpace(){return xf},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,e,t){if(this.legacyMode||e===t||!e||!t)return i;if(hT[e]&&void 0!==hT[e][t]){const n=hT[e][t];return i.r=n(i.r),i.g=n(i.g),i.b=n(i.b),i}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)}},Oj={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_r={r:0,g:0,b:0},Jo={h:0,s:0,l:0},wA={h:0,s:0,l:0};function fT(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+6*(e-i)*t:t<.5?e:t<2/3?i+6*(e-i)*(2/3-t):i}function CA(i,e){return e.r=i.r,e.g=i.g,e.b=i.b,e}let Cf,De=(()=>{class i{constructor(t,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===n&&void 0===r?this.set(t):this.setRGB(t,n,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,n=$o){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,Yr.toWorkingColorSpace(this,n),this}setRGB(t,n,r,s=Yr.workingColorSpace){return this.r=t,this.g=n,this.b=r,Yr.toWorkingColorSpace(this,s),this}setHSL(t,n,r,s=Yr.workingColorSpace){if(t=cT(t,1),n=Wn(n,0,1),r=Wn(r,0,1),0===n)this.r=this.g=this.b=r;else{const o=r<=.5?r*(1+n):r+n-r*n,a=2*r-o;this.r=fT(a,o,t+1/3),this.g=fT(a,o,t),this.b=fT(a,o,t-1/3)}return Yr.toWorkingColorSpace(this,s),this}setStyle(t,n=$o){function r(o){void 0!==o&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let s;if(s=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let o;const l=s[2];switch(s[1]){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(255,parseInt(o[1],10))/255,this.g=Math.min(255,parseInt(o[2],10))/255,this.b=Math.min(255,parseInt(o[3],10))/255,Yr.toWorkingColorSpace(this,n),r(o[4]),this;if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(100,parseInt(o[1],10))/100,this.g=Math.min(100,parseInt(o[2],10))/100,this.b=Math.min(100,parseInt(o[3],10))/100,Yr.toWorkingColorSpace(this,n),r(o[4]),this;break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l)){const c=parseFloat(o[1])/360,d=parseFloat(o[2])/100,u=parseFloat(o[3])/100;return r(o[4]),this.setHSL(c,d,u,n)}}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(t)){const o=s[1],a=o.length;if(3===a)return this.r=parseInt(o.charAt(0)+o.charAt(0),16)/255,this.g=parseInt(o.charAt(1)+o.charAt(1),16)/255,this.b=parseInt(o.charAt(2)+o.charAt(2),16)/255,Yr.toWorkingColorSpace(this,n),this;if(6===a)return this.r=parseInt(o.charAt(0)+o.charAt(1),16)/255,this.g=parseInt(o.charAt(2)+o.charAt(3),16)/255,this.b=parseInt(o.charAt(4)+o.charAt(5),16)/255,Yr.toWorkingColorSpace(this,n),this}return t&&t.length>0?this.setColorName(t,n):this}setColorName(t,n=$o){const r=Oj[t.toLowerCase()];return void 0!==r?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=zd(t.r),this.g=zd(t.g),this.b=zd(t.b),this}copyLinearToSRGB(t){return this.r=xA(t.r),this.g=xA(t.g),this.b=xA(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=$o){return Yr.fromWorkingColorSpace(CA(this,_r),t),Wn(255*_r.r,0,255)<<16^Wn(255*_r.g,0,255)<<8^Wn(255*_r.b,0,255)<<0}getHexString(t=$o){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,n=Yr.workingColorSpace){Yr.fromWorkingColorSpace(CA(this,_r),n);const r=_r.r,s=_r.g,o=_r.b,a=Math.max(r,s,o),l=Math.min(r,s,o);let c,d;const u=(l+a)/2;if(l===a)c=0,d=0;else{const h=a-l;switch(d=u<=.5?h/(a+l):h/(2-a-l),a){case r:c=(s-o)/h+(s<o?6:0);break;case s:c=(o-r)/h+2;break;case o:c=(r-s)/h+4}c/=6}return t.h=c,t.s=d,t.l=u,t}getRGB(t,n=Yr.workingColorSpace){return Yr.fromWorkingColorSpace(CA(this,_r),n),t.r=_r.r,t.g=_r.g,t.b=_r.b,t}getStyle(t=$o){return Yr.fromWorkingColorSpace(CA(this,_r),t),t!==$o?`color(${t} ${_r.r} ${_r.g} ${_r.b})`:`rgb(${255*_r.r|0},${255*_r.g|0},${255*_r.b|0})`}offsetHSL(t,n,r){return this.getHSL(Jo),Jo.h+=t,Jo.s+=n,Jo.l+=r,this.setHSL(Jo.h,Jo.s,Jo.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this}lerpColors(t,n,r){return this.r=t.r+(n.r-t.r)*r,this.g=t.g+(n.g-t.g)*r,this.b=t.b+(n.b-t.b)*r,this}lerpHSL(t,n){this.getHSL(Jo),t.getHSL(wA);const r=Y_(Jo.h,wA.h,n),s=Y_(Jo.s,wA.s,n),o=Y_(Jo.l,wA.l,n);return this.setHSL(r,s,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,n=0){return this.r=t[n],this.g=t[n+1],this.b=t[n+2],this}toArray(t=[],n=0){return t[n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t}fromBufferAttribute(t,n){return this.r=t.getX(n),this.g=t.getY(n),this.b=t.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}return i.NAMES=Oj,i})();class pT{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Cf&&(Cf=Z_("canvas")),Cf.width=e.width,Cf.height=e.height;const n=Cf.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Cf}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Z_("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*zd(s[o]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t[n]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*zd(t[n]/255)):zd(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Hd{constructor(e=null){this.isSource=!0,this.uuid=Zs(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(mT(r[o].isDataTexture?r[o].image:r[o]))}else s=mT(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function mT(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?pT.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Die=0,qn=(()=>{class i extends os{constructor(t=i.DEFAULT_IMAGE,n=i.DEFAULT_MAPPING,r=gr,s=gr,o=Li,a=Xs,l=En,c=Wr,d=i.DEFAULT_ANISOTROPY,u=Ys){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Die++}),this.uuid=Zs(),this.name="",this.source=new Hd(t),this.mipmaps=[],this.mapping=n,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=d,this.format=l,this.internalFormat=null,this.type=c,this.offset=new ue(0,0),this.repeat=new ue(1,1),this.center=new ue(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Xr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=u,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const n=void 0===t||"string"==typeof t;if(!n&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==aA)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Ao:t.x=t.x-Math.floor(t.x);break;case gr:t.x=t.x<0?0:1;break;case pf:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Ao:t.y=t.y-Math.floor(t.y);break;case gr:t.y=t.y<0?0:1;break;case pf:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return i.DEFAULT_IMAGE=null,i.DEFAULT_MAPPING=aA,i.DEFAULT_ANISOTROPY=1,i})();class ni{constructor(e=0,t=0,n=0,r=1){ni.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const l=e.elements,c=l[0],d=l[4],u=l[8],h=l[1],f=l[5],m=l[9],p=l[2],g=l[6],_=l[10];if(Math.abs(d-h)<.01&&Math.abs(u-p)<.01&&Math.abs(m-g)<.01){if(Math.abs(d+h)<.1&&Math.abs(u+p)<.1&&Math.abs(m+g)<.1&&Math.abs(c+f+_-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const b=(c+1)/2,y=(f+1)/2,x=(_+1)/2,C=(d+h)/4,M=(u+p)/4,w=(m+g)/4;return b>y&&b>x?b<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(b),r=C/n,s=M/n):y>x?y<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(y),n=C/r,s=w/r):x<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(x),n=M/s,r=w/s),this.set(n,r,s,t),this}let v=Math.sqrt((g-m)*(g-m)+(u-p)*(u-p)+(h-d)*(h-d));return Math.abs(v)<.001&&(v=1),this.x=(g-m)/v,this.y=(u-p)/v,this.z=(h-d)/v,this.w=Math.acos((c+f+_-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Gt extends os{constructor(e=1,t=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new ni(0,0,e,t),this.scissorTest=!1,this.viewport=new ni(0,0,e,t),this.texture=new qn({width:e,height:t,depth:1},n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Li,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Hd(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Mf extends qn{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=$t,this.minFilter=$t,this.wrapR=gr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Pie extends Gt{constructor(e=1,t=1,n=1){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Mf(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Ef extends qn{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=$t,this.minFilter=$t,this.wrapR=gr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class kie extends Gt{constructor(e=1,t=1,n=1){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Ef(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Fie extends Gt{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<n;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class xi{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,o,a){let l=n[r+0],c=n[r+1],d=n[r+2],u=n[r+3];const h=s[o+0],f=s[o+1],m=s[o+2],p=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=d,void(e[t+3]=u);if(1===a)return e[t+0]=h,e[t+1]=f,e[t+2]=m,void(e[t+3]=p);if(u!==p||l!==h||c!==f||d!==m){let g=1-a;const _=l*h+c*f+d*m+u*p,v=_>=0?1:-1,b=1-_*_;if(b>Number.EPSILON){const x=Math.sqrt(b),C=Math.atan2(x,_*v);g=Math.sin(g*C)/x,a=Math.sin(a*C)/x}const y=a*v;if(l=l*g+h*y,c=c*g+f*y,d=d*g+m*y,u=u*g+p*y,g===1-a){const x=1/Math.sqrt(l*l+c*c+d*d+u*u);l*=x,c*=x,d*=x,u*=x}}e[t]=l,e[t+1]=c,e[t+2]=d,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,r,s,o){const a=n[r],l=n[r+1],c=n[r+2],d=n[r+3],u=s[o],h=s[o+1],f=s[o+2],m=s[o+3];return e[t]=a*m+d*u+l*f-c*h,e[t+1]=l*m+d*h+c*u-a*f,e[t+2]=c*m+d*f+a*h-l*u,e[t+3]=d*m-a*u-l*h-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(n/2),d=a(r/2),u=a(s/2),h=l(n/2),f=l(r/2),m=l(s/2);switch(o){case"XYZ":this._x=h*d*u+c*f*m,this._y=c*f*u-h*d*m,this._z=c*d*m+h*f*u,this._w=c*d*u-h*f*m;break;case"YXZ":this._x=h*d*u+c*f*m,this._y=c*f*u-h*d*m,this._z=c*d*m-h*f*u,this._w=c*d*u+h*f*m;break;case"ZXY":this._x=h*d*u-c*f*m,this._y=c*f*u+h*d*m,this._z=c*d*m+h*f*u,this._w=c*d*u-h*f*m;break;case"ZYX":this._x=h*d*u-c*f*m,this._y=c*f*u+h*d*m,this._z=c*d*m-h*f*u,this._w=c*d*u+h*f*m;break;case"YZX":this._x=h*d*u+c*f*m,this._y=c*f*u+h*d*m,this._z=c*d*m-h*f*u,this._w=c*d*u-h*f*m;break;case"XZY":this._x=h*d*u-c*f*m,this._y=c*f*u-h*d*m,this._z=c*d*m+h*f*u,this._w=c*d*u+h*f*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],d=t[6],u=t[10],h=n+a+u;if(h>0){const f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(d-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(n>a&&n>u){const f=2*Math.sqrt(1+n-a-u);this._w=(d-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>u){const f=2*Math.sqrt(1+a-n-u);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+d)/f}else{const f=2*Math.sqrt(1+u-n-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+d)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Wn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,d=t._w;return this._x=n*d+o*a+r*c-s*l,this._y=r*d+o*l+s*a-n*c,this._z=s*d+o*c+n*l-r*a,this._w=o*d-n*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*n+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),d=Math.atan2(c,a),u=Math.sin((1-t)*d)/c,h=Math.sin(t*d)/c;return this._w=o*u+this._w*h,this._x=n*u+this._x*h,this._y=r*u+this._y*h,this._z=s*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(s),n*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class T{constructor(e=0,t=0,n=0){T.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Nj.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Nj.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*n,d=l*n+a*t-s*r,u=l*r+s*n-o*t,h=-s*t-o*n-a*r;return this.x=c*l+h*-s+d*-a-u*-o,this.y=d*l+h*-o+u*-s-c*-a,this.z=u*l+h*-a+c*-o-d*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return gT.copy(this).projectOnVector(e),this.sub(gT)}reflect(e){return this.sub(gT.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Wn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const gT=new T,Nj=new xi;class Da{constructor(e=new T(1/0,1/0,1/0),t=new T(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.length;l<c;l+=3){const d=e[l],u=e[l+1],h=e[l+2];d<t&&(t=d),u<n&&(n=u),h<r&&(r=h),d>s&&(s=d),u>o&&(o=u),h>a&&(a=h)}return this.min.set(t,n,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.count;l<c;l++){const d=e.getX(l),u=e.getY(l),h=e.getZ(l);d<t&&(t=d),u<n&&(n=u),h<r&&(r=h),d>s&&(s=d),u>o&&(o=u),h>a&&(a=h)}return this.min.set(t,n,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Gd.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){const s=n.attributes.position;for(let o=0,a=s.count;o<a;o++)Gd.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(Gd)}else null===n.boundingBox&&n.computeBoundingBox(),_T.copy(n.boundingBox),_T.applyMatrix4(e.matrixWorld),this.union(_T);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Gd),Gd.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(K_),MA.subVectors(this.max,K_),Sf.subVectors(e.a,K_),Tf.subVectors(e.b,K_),If.subVectors(e.c,K_),hc.subVectors(Tf,Sf),fc.subVectors(If,Tf),Qd.subVectors(Sf,If);let t=[0,-hc.z,hc.y,0,-fc.z,fc.y,0,-Qd.z,Qd.y,hc.z,0,-hc.x,fc.z,0,-fc.x,Qd.z,0,-Qd.x,-hc.y,hc.x,0,-fc.y,fc.x,0,-Qd.y,Qd.x,0];return!(!bT(t,Sf,Tf,If,MA)||(t=[1,0,0,0,1,0,0,0,1],!bT(t,Sf,Tf,If,MA)))&&(EA.crossVectors(hc,fc),t=[EA.x,EA.y,EA.z],bT(t,Sf,Tf,If,MA))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Gd.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(Gd).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(yl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),yl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),yl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),yl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),yl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),yl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),yl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),yl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(yl)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const yl=[new T,new T,new T,new T,new T,new T,new T,new T],Gd=new T,_T=new Da,Sf=new T,Tf=new T,If=new T,hc=new T,fc=new T,Qd=new T,K_=new T,MA=new T,EA=new T,Wd=new T;function bT(i,e,t,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){Wd.fromArray(i,s);const a=r.x*Math.abs(Wd.x)+r.y*Math.abs(Wd.y)+r.z*Math.abs(Wd.z),l=e.dot(Wd),c=t.dot(Wd),d=n.dot(Wd);if(Math.max(-Math.max(l,c,d),Math.min(l,c,d))>a)return!1}return!0}const Bie=new Da,$_=new T,vT=new T;class Al{constructor(e=new T,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):Bie.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;$_.subVectors(e,this.center);const t=$_.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=.5*(n-this.radius);this.center.addScaledVector($_,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(vT.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint($_.copy(e.center).add(vT)),this.expandByPoint($_.copy(e.center).sub(vT))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const xl=new T,yT=new T,SA=new T,pc=new T,AT=new T,TA=new T,xT=new T;class J_{constructor(e=new T,t=new T(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,xl)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=xl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(xl.copy(this.direction).multiplyScalar(t).add(this.origin),xl.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){yT.copy(e).add(t).multiplyScalar(.5),SA.copy(t).sub(e).normalize(),pc.copy(this.origin).sub(yT);const s=.5*e.distanceTo(t),o=-this.direction.dot(SA),a=pc.dot(this.direction),l=-pc.dot(SA),c=pc.lengthSq(),d=Math.abs(1-o*o);let u,h,f,m;if(d>0)if(u=o*l-a,h=o*a-l,m=s*d,u>=0)if(h>=-m)if(h<=m){const p=1/d;u*=p,h*=p,f=u*(u+o*h+2*a)+h*(o*u+h+2*l)+c}else h=s,u=Math.max(0,-(o*h+a)),f=-u*u+h*(h+2*l)+c;else h=-s,u=Math.max(0,-(o*h+a)),f=-u*u+h*(h+2*l)+c;else h<=-m?(u=Math.max(0,-(-o*s+a)),h=u>0?-s:Math.min(Math.max(-s,-l),s),f=-u*u+h*(h+2*l)+c):h<=m?(u=0,h=Math.min(Math.max(-s,-l),s),f=h*(h+2*l)+c):(u=Math.max(0,-(o*s+a)),h=u>0?s:Math.min(Math.max(-s,-l),s),f=-u*u+h*(h+2*l)+c);else h=o>0?-s:s,u=Math.max(0,-(o*h+a)),f=-u*u+h*(h+2*l)+c;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),r&&r.copy(SA).multiplyScalar(h).add(yT),f}intersectSphere(e,t){xl.subVectors(e.center,this.origin);const n=xl.dot(this.direction),r=xl.dot(xl)-n*n,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,l=n+o;return a<0&&l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,o,a,l;const c=1/this.direction.x,d=1/this.direction.y,u=1/this.direction.z,h=this.origin;return c>=0?(n=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(n=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),d>=0?(s=(e.min.y-h.y)*d,o=(e.max.y-h.y)*d):(s=(e.max.y-h.y)*d,o=(e.min.y-h.y)*d),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),u>=0?(a=(e.min.z-h.z)*u,l=(e.max.z-h.z)*u):(a=(e.max.z-h.z)*u,l=(e.min.z-h.z)*u),n>l||a>r)||((a>n||n!=n)&&(n=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return null!==this.intersectBox(e,xl)}intersectTriangle(e,t,n,r,s){AT.subVectors(t,e),TA.subVectors(n,e),xT.crossVectors(AT,TA);let a,o=this.direction.dot(xT);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}pc.subVectors(this.origin,e);const l=a*this.direction.dot(TA.crossVectors(pc,TA));if(l<0)return null;const c=a*this.direction.dot(AT.cross(pc));if(c<0||l+c>o)return null;const d=-a*pc.dot(xT);return d<0?null:this.at(d/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Ve{constructor(){Ve.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,n,r,s,o,a,l,c,d,u,h,f,m,p,g){const _=this.elements;return _[0]=e,_[4]=t,_[8]=n,_[12]=r,_[1]=s,_[5]=o,_[9]=a,_[13]=l,_[2]=c,_[6]=d,_[10]=u,_[14]=h,_[3]=f,_[7]=m,_[11]=p,_[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Ve).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/Rf.setFromMatrixColumn(e,0).length(),s=1/Rf.setFromMatrixColumn(e,1).length(),o=1/Rf.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),c=Math.sin(r),d=Math.cos(s),u=Math.sin(s);if("XYZ"===e.order){const h=o*d,f=o*u,m=a*d,p=a*u;t[0]=l*d,t[4]=-l*u,t[8]=c,t[1]=f+m*c,t[5]=h-p*c,t[9]=-a*l,t[2]=p-h*c,t[6]=m+f*c,t[10]=o*l}else if("YXZ"===e.order){const h=l*d,f=l*u,m=c*d,p=c*u;t[0]=h+p*a,t[4]=m*a-f,t[8]=o*c,t[1]=o*u,t[5]=o*d,t[9]=-a,t[2]=f*a-m,t[6]=p+h*a,t[10]=o*l}else if("ZXY"===e.order){const h=l*d,f=l*u,m=c*d,p=c*u;t[0]=h-p*a,t[4]=-o*u,t[8]=m+f*a,t[1]=f+m*a,t[5]=o*d,t[9]=p-h*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const h=o*d,f=o*u,m=a*d,p=a*u;t[0]=l*d,t[4]=m*c-f,t[8]=h*c+p,t[1]=l*u,t[5]=p*c+h,t[9]=f*c-m,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const h=o*l,f=o*c,m=a*l,p=a*c;t[0]=l*d,t[4]=p-h*u,t[8]=m*u+f,t[1]=u,t[5]=o*d,t[9]=-a*d,t[2]=-c*d,t[6]=f*u+m,t[10]=h-p*u}else if("XZY"===e.order){const h=o*l,f=o*c,m=a*l,p=a*c;t[0]=l*d,t[4]=-u,t[8]=c*d,t[1]=h*u+p,t[5]=o*d,t[9]=f*u-m,t[2]=m*u-f,t[6]=a*d,t[10]=p*u+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Lie,e,Oie)}lookAt(e,t,n){const r=this.elements;return Ks.subVectors(e,t),0===Ks.lengthSq()&&(Ks.z=1),Ks.normalize(),mc.crossVectors(n,Ks),0===mc.lengthSq()&&(1===Math.abs(n.z)?Ks.x+=1e-4:Ks.z+=1e-4,Ks.normalize(),mc.crossVectors(n,Ks)),mc.normalize(),IA.crossVectors(Ks,mc),r[0]=mc.x,r[4]=IA.x,r[8]=Ks.x,r[1]=mc.y,r[5]=IA.y,r[9]=Ks.y,r[2]=mc.z,r[6]=IA.z,r[10]=Ks.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[4],l=n[8],c=n[12],d=n[1],u=n[5],h=n[9],f=n[13],m=n[2],p=n[6],g=n[10],_=n[14],v=n[3],b=n[7],y=n[11],x=n[15],C=r[0],M=r[4],w=r[8],E=r[12],I=r[1],F=r[5],Q=r[9],B=r[13],L=r[2],X=r[6],P=r[10],V=r[14],O=r[3],q=r[7],ee=r[11],Z=r[15];return s[0]=o*C+a*I+l*L+c*O,s[4]=o*M+a*F+l*X+c*q,s[8]=o*w+a*Q+l*P+c*ee,s[12]=o*E+a*B+l*V+c*Z,s[1]=d*C+u*I+h*L+f*O,s[5]=d*M+u*F+h*X+f*q,s[9]=d*w+u*Q+h*P+f*ee,s[13]=d*E+u*B+h*V+f*Z,s[2]=m*C+p*I+g*L+_*O,s[6]=m*M+p*F+g*X+_*q,s[10]=m*w+p*Q+g*P+_*ee,s[14]=m*E+p*B+g*V+_*Z,s[3]=v*C+b*I+y*L+x*O,s[7]=v*M+b*F+y*X+x*q,s[11]=v*w+b*Q+y*P+x*ee,s[15]=v*E+b*B+y*V+x*Z,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],d=e[2],u=e[6],h=e[10],f=e[14];return e[3]*(+s*l*u-r*c*u-s*a*h+n*c*h+r*a*f-n*l*f)+e[7]*(+t*l*f-t*c*h+s*o*h-r*o*f+r*c*d-s*l*d)+e[11]*(+t*c*u-t*a*f-s*o*u+n*o*f+s*a*d-n*c*d)+e[15]*(-r*a*d-t*l*u+t*a*h+r*o*u-n*o*h+n*l*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],u=e[9],h=e[10],f=e[11],m=e[12],p=e[13],g=e[14],_=e[15],v=u*g*c-p*h*c+p*l*f-a*g*f-u*l*_+a*h*_,b=m*h*c-d*g*c-m*l*f+o*g*f+d*l*_-o*h*_,y=d*p*c-m*u*c+m*a*f-o*p*f-d*a*_+o*u*_,x=m*u*l-d*p*l-m*a*h+o*p*h+d*a*g-o*u*g,C=t*v+n*b+r*y+s*x;if(0===C)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const M=1/C;return e[0]=v*M,e[1]=(p*h*s-u*g*s-p*r*f+n*g*f+u*r*_-n*h*_)*M,e[2]=(a*g*s-p*l*s+p*r*c-n*g*c-a*r*_+n*l*_)*M,e[3]=(u*l*s-a*h*s-u*r*c+n*h*c+a*r*f-n*l*f)*M,e[4]=b*M,e[5]=(d*g*s-m*h*s+m*r*f-t*g*f-d*r*_+t*h*_)*M,e[6]=(m*l*s-o*g*s-m*r*c+t*g*c+o*r*_-t*l*_)*M,e[7]=(o*h*s-d*l*s+d*r*c-t*h*c-o*r*f+t*l*f)*M,e[8]=y*M,e[9]=(m*u*s-d*p*s-m*n*f+t*p*f+d*n*_-t*u*_)*M,e[10]=(o*p*s-m*a*s+m*n*c-t*p*c-o*n*_+t*a*_)*M,e[11]=(d*a*s-o*u*s-d*n*c+t*u*c+o*n*f-t*a*f)*M,e[12]=x*M,e[13]=(d*p*r-m*u*r+m*n*h-t*p*h-d*n*g+t*u*g)*M,e[14]=(m*a*r-o*p*r-m*n*l+t*p*l+o*n*g-t*a*g)*M,e[15]=(o*u*r-d*a*r+d*n*l-t*u*l-o*n*h+t*a*h)*M,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,o=e.x,a=e.y,l=e.z,c=s*o,d=s*a;return this.set(c*o+n,c*a-r*l,c*l+r*a,0,c*a+r*l,d*a+n,d*l-r*o,0,c*l-r*a,d*l+r*o,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,d=o+o,u=a+a,h=s*c,f=s*d,m=s*u,p=o*d,g=o*u,_=a*u,v=l*c,b=l*d,y=l*u,x=n.x,C=n.y,M=n.z;return r[0]=(1-(p+_))*x,r[1]=(f+y)*x,r[2]=(m-b)*x,r[3]=0,r[4]=(f-y)*C,r[5]=(1-(h+_))*C,r[6]=(g+v)*C,r[7]=0,r[8]=(m+b)*M,r[9]=(g-v)*M,r[10]=(1-(h+p))*M,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let s=Rf.set(r[0],r[1],r[2]).length();const o=Rf.set(r[4],r[5],r[6]).length(),a=Rf.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],ea.copy(this);const c=1/s,d=1/o,u=1/a;return ea.elements[0]*=c,ea.elements[1]*=c,ea.elements[2]*=c,ea.elements[4]*=d,ea.elements[5]*=d,ea.elements[6]*=d,ea.elements[8]*=u,ea.elements[9]*=u,ea.elements[10]*=u,t.setFromRotationMatrix(ea),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,r,s,o){const a=this.elements,c=2*s/(n-r),d=(t+e)/(t-e),u=(n+r)/(n-r),h=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=2*s/(t-e),a[4]=0,a[8]=d,a[12]=0,a[1]=0,a[5]=c,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,r,s,o){const a=this.elements,l=1/(t-e),c=1/(n-r),d=1/(o-s),u=(t+e)*l,h=(n+r)*c,f=(o+s)*d;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*d,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Rf=new T,ea=new Ve,Lie=new T(0,0,0),Oie=new T(1,1,1),mc=new T,IA=new T,Ks=new T,jj=new Ve,Uj=new xi;let $s=(()=>{class i{constructor(t=0,n=0,r=0,s=i.DefaultOrder){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,s=this._order){return this._x=t,this._y=n,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],d=s[5],u=s[9],h=s[2],f=s[6],m=s[10];switch(n){case"XYZ":this._y=Math.asin(Wn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,m),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,d),this._z=0);break;case"YXZ":this._x=Math.asin(-Wn(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(l,m),this._z=Math.atan2(c,d)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(Wn(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,m),this._z=Math.atan2(-a,d)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-Wn(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,m),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,d));break;case"YZX":this._z=Math.asin(Wn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-u,d),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(l,m));break;case"XZY":this._z=Math.asin(-Wn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,d),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-u,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return jj.makeRotationFromQuaternion(t),this.setFromRotationMatrix(jj,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return Uj.setFromEuler(this),this.setFromQuaternion(Uj,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}return i.DefaultOrder="XYZ",i.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],i})();class RA{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Nie=0;const Vj=new T,Df=new xi,wl=new Ve,DA=new T,e0=new T,jie=new T,Uie=new xi,zj=new T(1,0,0),Hj=new T(0,1,0),Gj=new T(0,0,1),Vie={type:"added"},Qj={type:"removed"};let wi=(()=>{class i extends os{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Nie++}),this.uuid=Zs(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=i.DefaultUp.clone();const t=new T,n=new $s,r=new xi,s=new T(1,1,1);n._onChange(function o(){r.setFromEuler(n,!1)}),r._onChange(function a(){n.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Ve},normalMatrix:{value:new Xr}}),this.matrix=new Ve,this.matrixWorld=new Ve,this.matrixAutoUpdate=i.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=i.DefaultMatrixWorldAutoUpdate,this.layers=new RA,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return Df.setFromAxisAngle(t,n),this.quaternion.multiply(Df),this}rotateOnWorldAxis(t,n){return Df.setFromAxisAngle(t,n),this.quaternion.premultiply(Df),this}rotateX(t){return this.rotateOnAxis(zj,t)}rotateY(t){return this.rotateOnAxis(Hj,t)}rotateZ(t){return this.rotateOnAxis(Gj,t)}translateOnAxis(t,n){return Vj.copy(t).applyQuaternion(this.quaternion),this.position.add(Vj.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis(zj,t)}translateY(t){return this.translateOnAxis(Hj,t)}translateZ(t){return this.translateOnAxis(Gj,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(wl.copy(this.matrixWorld).invert())}lookAt(t,n,r){t.isVector3?DA.copy(t):DA.set(t,n,r);const s=this.parent;this.updateWorldMatrix(!0,!1),e0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?wl.lookAt(e0,DA,this.up):wl.lookAt(DA,e0,this.up),this.quaternion.setFromRotationMatrix(wl),s&&(wl.extractRotation(s.matrixWorld),Df.setFromRotationMatrix(wl),this.quaternion.premultiply(Df.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Vie)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(Qj)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const n=this.children[t];n.parent=null,n.dispatchEvent(Qj)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),wl.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),wl.multiply(t.parent.matrixWorld)),t.applyMatrix4(wl),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,n);if(void 0!==a)return a}}getObjectsByProperty(t,n){let r=[];this[t]===n&&r.push(this);for(let s=0,o=this.children.length;s<o;s++){const a=this.children[s].getObjectsByProperty(t,n);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(e0,t,jie),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(e0,Uie,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverseVisible(t)}traverseAncestors(t){const n=this.parent;null!==n&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const n=this.children;for(let r=0,s=n.length;r<s;r++){const o=n[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,n){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===n){const s=this.children;for(let o=0,a=s.length;o<a;o++){const l=s[o];!0===l.matrixWorldAutoUpdate&&l.updateWorldMatrix(!1,!0)}}}toJSON(t){const n=void 0===t||"string"==typeof t,r={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const s={};function o(l,c){return void 0===l[c.uuid]&&(l[c.uuid]=c.toJSON(t)),c.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const c=l.shapes;if(Array.isArray(c))for(let d=0,u=c.length;d<u;d++)o(t.shapes,c[d]);else o(t.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let c=0,d=this.material.length;c<d;c++)l.push(o(t.materials,this.material[c]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++)s.animations.push(o(t.animations,this.animations[l]))}if(n){const l=a(t.geometries),c=a(t.materials),d=a(t.textures),u=a(t.images),h=a(t.shapes),f=a(t.skeletons),m=a(t.animations),p=a(t.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),d.length>0&&(r.textures=d),u.length>0&&(r.images=u),h.length>0&&(r.shapes=h),f.length>0&&(r.skeletons=f),m.length>0&&(r.animations=m),p.length>0&&(r.nodes=p)}return r.object=s,r;function a(l){const c=[];for(const d in l){const u=l[d];delete u.metadata,c.push(u)}return c}}clone(t){return(new this.constructor).copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===n)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return i.DefaultUp=new T(0,1,0),i.DefaultMatrixAutoUpdate=!0,i.DefaultMatrixWorldAutoUpdate=!0,i})();const ta=new T,Cl=new T,wT=new T,Ml=new T,Pf=new T,kf=new T,Wj=new T,CT=new T,MT=new T,ET=new T;class Js{constructor(e=new T,t=new T,n=new T){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),ta.subVectors(e,t),r.cross(ta);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){ta.subVectors(r,t),Cl.subVectors(n,t),wT.subVectors(e,t);const o=ta.dot(ta),a=ta.dot(Cl),l=ta.dot(wT),c=Cl.dot(Cl),d=Cl.dot(wT),u=o*c-a*a;if(0===u)return s.set(-2,-1,-1);const h=1/u,f=(c*l-a*d)*h,m=(o*d-a*l)*h;return s.set(1-f-m,m,f)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Ml),Ml.x>=0&&Ml.y>=0&&Ml.x+Ml.y<=1}static getUV(e,t,n,r,s,o,a,l){return this.getBarycoord(e,t,n,r,Ml),l.set(0,0),l.addScaledVector(s,Ml.x),l.addScaledVector(o,Ml.y),l.addScaledVector(a,Ml.z),l}static isFrontFacing(e,t,n,r){return ta.subVectors(n,t),Cl.subVectors(e,t),ta.cross(Cl).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ta.subVectors(this.c,this.b),Cl.subVectors(this.a,this.b),.5*ta.cross(Cl).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Js.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Js.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,s){return Js.getUV(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return Js.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Js.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let o,a;Pf.subVectors(r,n),kf.subVectors(s,n),CT.subVectors(e,n);const l=Pf.dot(CT),c=kf.dot(CT);if(l<=0&&c<=0)return t.copy(n);MT.subVectors(e,r);const d=Pf.dot(MT),u=kf.dot(MT);if(d>=0&&u<=d)return t.copy(r);const h=l*u-d*c;if(h<=0&&l>=0&&d<=0)return o=l/(l-d),t.copy(n).addScaledVector(Pf,o);ET.subVectors(e,s);const f=Pf.dot(ET),m=kf.dot(ET);if(m>=0&&f<=m)return t.copy(s);const p=f*c-l*m;if(p<=0&&c>=0&&m<=0)return a=c/(c-m),t.copy(n).addScaledVector(kf,a);const g=d*m-f*u;if(g<=0&&u-d>=0&&f-m>=0)return Wj.subVectors(s,r),a=(u-d)/(u-d+(f-m)),t.copy(r).addScaledVector(Wj,a);const _=1/(g+p+h);return o=p*_,a=h*_,t.copy(n).addScaledVector(Pf,o).addScaledVector(kf,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let zie=0;class On extends os{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:zie++}),this.uuid=Zs(),this.name="",this.type="Material",this.blending=Ia,this.side=_l,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=uf,this.blendDst=O_,this.blendEquation=As,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=oA,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=kj,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=bA,this.stencilZFail=bA,this.stencilZPass=bA,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Ia&&(n.blending=this.blending),this.side!==_l&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class Xn extends On{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new De(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=N_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const nr=new T,PA=new ue;class Ci{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=q_,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)PA.fromBufferAttribute(this,t),PA.applyMatrix3(e),this.setXY(t,PA.x,PA.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)nr.fromBufferAttribute(this,t),nr.applyMatrix3(e),this.setXYZ(t,nr.x,nr.y,nr.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)nr.fromBufferAttribute(this,t),nr.applyMatrix4(e),this.setXYZ(t,nr.x,nr.y,nr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)nr.fromBufferAttribute(this,t),nr.applyNormalMatrix(e),this.setXYZ(t,nr.x,nr.y,nr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)nr.fromBufferAttribute(this,t),nr.transformDirection(e),this.setXYZ(t,nr.x,nr.y,nr.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=vl(t,this.array)),t}setX(e,t){return this.normalized&&(t=Zi(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=vl(t,this.array)),t}setY(e,t){return this.normalized&&(t=Zi(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=vl(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Zi(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=vl(t,this.array)),t}setW(e,t){return this.normalized&&(t=Zi(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Zi(t,this.array),n=Zi(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Zi(t,this.array),n=Zi(n,this.array),r=Zi(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=Zi(t,this.array),n=Zi(n,this.array),r=Zi(r,this.array),s=Zi(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==q_&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class Hie extends Ci{constructor(e,t,n){super(new Int8Array(e),t,n)}}class Gie extends Ci{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class Qie extends Ci{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class Wie extends Ci{constructor(e,t,n){super(new Int16Array(e),t,n)}}class kA extends Ci{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class qie extends Ci{constructor(e,t,n){super(new Int32Array(e),t,n)}}class FA extends Ci{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Xie extends Ci{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}}class Ge extends Ci{constructor(e,t,n){super(new Float32Array(e),t,n)}}class Yie extends Ci{constructor(e,t,n){super(new Float64Array(e),t,n)}}let Zie=0;const xo=new Ve,ST=new wi,Ff=new T,eo=new Da,t0=new Da,Sr=new T;class xt extends os{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Zie++}),this.uuid=Zs(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(Lj(e)?FA:kA)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const s=(new Xr).getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return xo.makeRotationFromQuaternion(e),this.applyMatrix4(xo),this}rotateX(e){return xo.makeRotationX(e),this.applyMatrix4(xo),this}rotateY(e){return xo.makeRotationY(e),this.applyMatrix4(xo),this}rotateZ(e){return xo.makeRotationZ(e),this.applyMatrix4(xo),this}translate(e,t,n){return xo.makeTranslation(e,t,n),this.applyMatrix4(xo),this}scale(e,t,n){return xo.makeScale(e,t,n),this.applyMatrix4(xo),this}lookAt(e){return ST.lookAt(e),ST.updateMatrix(),this.applyMatrix4(ST.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ff).negate(),this.translate(Ff.x,Ff.y,Ff.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ge(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Da);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new T(-1/0,-1/0,-1/0),new T(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++)eo.setFromBufferAttribute(t[n]),this.morphTargetsRelative?(Sr.addVectors(this.boundingBox.min,eo.min),this.boundingBox.expandByPoint(Sr),Sr.addVectors(this.boundingBox.max,eo.max),this.boundingBox.expandByPoint(Sr)):(this.boundingBox.expandByPoint(eo.min),this.boundingBox.expandByPoint(eo.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Al);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new T,1/0);if(e){const n=this.boundingSphere.center;if(eo.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)t0.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(Sr.addVectors(eo.min,t0.min),eo.expandByPoint(Sr),Sr.addVectors(eo.max,t0.max),eo.expandByPoint(Sr)):(eo.expandByPoint(t0.min),eo.expandByPoint(t0.max));eo.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)Sr.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(Sr));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,d=a.count;c<d;c++)Sr.fromBufferAttribute(a,c),l&&(Ff.fromBufferAttribute(e,c),Sr.add(Ff)),r=Math.max(r,n.distanceToSquared(Sr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Ci(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],d=[];for(let I=0;I<a;I++)c[I]=new T,d[I]=new T;const u=new T,h=new T,f=new T,m=new ue,p=new ue,g=new ue,_=new T,v=new T;function b(I,F,Q){u.fromArray(r,3*I),h.fromArray(r,3*F),f.fromArray(r,3*Q),m.fromArray(o,2*I),p.fromArray(o,2*F),g.fromArray(o,2*Q),h.sub(u),f.sub(u),p.sub(m),g.sub(m);const B=1/(p.x*g.y-g.x*p.y);isFinite(B)&&(_.copy(h).multiplyScalar(g.y).addScaledVector(f,-p.y).multiplyScalar(B),v.copy(f).multiplyScalar(p.x).addScaledVector(h,-g.x).multiplyScalar(B),c[I].add(_),c[F].add(_),c[Q].add(_),d[I].add(v),d[F].add(v),d[Q].add(v))}let y=this.groups;0===y.length&&(y=[{start:0,count:n.length}]);for(let I=0,F=y.length;I<F;++I){const Q=y[I],B=Q.start;for(let X=B,P=B+Q.count;X<P;X+=3)b(n[X+0],n[X+1],n[X+2])}const x=new T,C=new T,M=new T,w=new T;function E(I){M.fromArray(s,3*I),w.copy(M);const F=c[I];x.copy(F),x.sub(M.multiplyScalar(M.dot(F))).normalize(),C.crossVectors(w,F);const B=C.dot(d[I])<0?-1:1;l[4*I]=x.x,l[4*I+1]=x.y,l[4*I+2]=x.z,l[4*I+3]=B}for(let I=0,F=y.length;I<F;++I){const Q=y[I],B=Q.start;for(let X=B,P=B+Q.count;X<P;X+=3)E(n[X+0]),E(n[X+1]),E(n[X+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new Ci(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let h=0,f=n.count;h<f;h++)n.setXYZ(h,0,0,0);const r=new T,s=new T,o=new T,a=new T,l=new T,c=new T,d=new T,u=new T;if(e)for(let h=0,f=e.count;h<f;h+=3){const m=e.getX(h+0),p=e.getX(h+1),g=e.getX(h+2);r.fromBufferAttribute(t,m),s.fromBufferAttribute(t,p),o.fromBufferAttribute(t,g),d.subVectors(o,s),u.subVectors(r,s),d.cross(u),a.fromBufferAttribute(n,m),l.fromBufferAttribute(n,p),c.fromBufferAttribute(n,g),a.add(d),l.add(d),c.add(d),n.setXYZ(m,a.x,a.y,a.z),n.setXYZ(p,l.x,l.y,l.z),n.setXYZ(g,c.x,c.y,c.z)}else for(let h=0,f=t.count;h<f;h+=3)r.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),d.subVectors(o,s),u.subVectors(r,s),d.cross(u),n.setXYZ(h+0,d.x,d.y,d.z),n.setXYZ(h+1,d.x,d.y,d.z),n.setXYZ(h+2,d.x,d.y,d.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Sr.fromBufferAttribute(e,t),Sr.normalize(),e.setXYZ(t,Sr.x,Sr.y,Sr.z)}toNonIndexed(){function e(a,l){const c=a.array,d=a.itemSize,u=a.normalized,h=new c.constructor(l.length*d);let f=0,m=0;for(let p=0,g=l.length;p<g;p++){f=a.isInterleavedBufferAttribute?l[p]*a.data.stride+a.offset:l[p]*d;for(let _=0;_<d;_++)h[m++]=c[f++]}return new Ci(h,d,u)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new xt,n=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],n);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let d=0,u=c.length;d<u;d++){const f=e(c[d],n);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n)e.data.attributes[l]=n[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],d=[];for(let u=0,h=c.length;u<h;u++)d.push(c[u].toJSON(e.data));d.length>0&&(r[l]=d,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const d=[],u=s[c];for(let h=0,f=u.length;h<f;h++)d.push(u[h].clone(t));this.morphAttributes[c]=d}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,d=o.length;c<d;c++){const u=o[c];this.addGroup(u.start,u.count,u.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const qj=new Ve,Bf=new J_,TT=new Al,n0=new T,r0=new T,s0=new T,IT=new T,BA=new T,LA=new ue,OA=new ue,NA=new ue,RT=new T,jA=new T;class Ke extends wi{constructor(e=new xt,t=new Xn){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const n=this.geometry,s=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(n.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){BA.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const d=a[l];0!==d&&(IT.fromBufferAttribute(s[l],e),BA.addScaledVector(o?IT:IT.sub(t),d))}t.add(BA)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===n.boundingSphere&&n.computeBoundingSphere(),TT.copy(n.boundingSphere),TT.applyMatrix4(s),!1===e.ray.intersectsSphere(TT))||(qj.copy(s).invert(),Bf.copy(e.ray).applyMatrix4(qj),null!==n.boundingBox&&!1===Bf.intersectsBox(n.boundingBox)))return;let o;const a=n.index,l=n.attributes.position,c=n.attributes.uv,d=n.attributes.uv2,u=n.groups,h=n.drawRange;if(null!==a)if(Array.isArray(r))for(let f=0,m=u.length;f<m;f++){const p=u[f],g=r[p.materialIndex];for(let b=Math.max(p.start,h.start),y=Math.min(a.count,Math.min(p.start+p.count,h.start+h.count));b<y;b+=3){const x=a.getX(b),C=a.getX(b+1),M=a.getX(b+2);o=UA(this,g,e,Bf,c,d,x,C,M),o&&(o.faceIndex=Math.floor(b/3),o.face.materialIndex=p.materialIndex,t.push(o))}}else for(let p=Math.max(0,h.start),g=Math.min(a.count,h.start+h.count);p<g;p+=3){const _=a.getX(p),v=a.getX(p+1),b=a.getX(p+2);o=UA(this,r,e,Bf,c,d,_,v,b),o&&(o.faceIndex=Math.floor(p/3),t.push(o))}else if(void 0!==l)if(Array.isArray(r))for(let f=0,m=u.length;f<m;f++){const p=u[f],g=r[p.materialIndex];for(let b=Math.max(p.start,h.start),y=Math.min(l.count,Math.min(p.start+p.count,h.start+h.count));b<y;b+=3)o=UA(this,g,e,Bf,c,d,b,b+1,b+2),o&&(o.faceIndex=Math.floor(b/3),o.face.materialIndex=p.materialIndex,t.push(o))}else for(let p=Math.max(0,h.start),g=Math.min(l.count,h.start+h.count);p<g;p+=3)o=UA(this,r,e,Bf,c,d,p,p+1,p+2),o&&(o.faceIndex=Math.floor(p/3),t.push(o))}}function UA(i,e,t,n,r,s,o,a,l){i.getVertexPosition(o,n0),i.getVertexPosition(a,r0),i.getVertexPosition(l,s0);const c=function Kie(i,e,t,n,r,s,o,a){let l;if(l=e.side===ys?n.intersectTriangle(o,s,r,!0,a):n.intersectTriangle(r,s,o,e.side===_l,a),null===l)return null;jA.copy(a),jA.applyMatrix4(i.matrixWorld);const c=t.ray.origin.distanceTo(jA);return c<t.near||c>t.far?null:{distance:c,point:jA.clone(),object:i}}(i,e,t,n,n0,r0,s0,RT);if(c){r&&(LA.fromBufferAttribute(r,o),OA.fromBufferAttribute(r,a),NA.fromBufferAttribute(r,l),c.uv=Js.getUV(RT,n0,r0,s0,LA,OA,NA,new ue)),s&&(LA.fromBufferAttribute(s,o),OA.fromBufferAttribute(s,a),NA.fromBufferAttribute(s,l),c.uv2=Js.getUV(RT,n0,r0,s0,LA,OA,NA,new ue));const d={a:o,b:a,c:l,normal:new T,materialIndex:0};Js.getNormal(n0,r0,s0,d.normal),c.face=d}return c}class Ki extends xt{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],d=[],u=[];let h=0,f=0;function m(p,g,_,v,b,y,x,C,M,w,E){const I=y/M,F=x/w,Q=y/2,B=x/2,L=C/2,X=M+1,P=w+1;let V=0,O=0;const q=new T;for(let ee=0;ee<P;ee++){const Z=ee*F-B;for(let Y=0;Y<X;Y++)q[p]=(Y*I-Q)*v,q[g]=Z*b,q[_]=L,c.push(q.x,q.y,q.z),q[p]=0,q[g]=0,q[_]=C>0?1:-1,d.push(q.x,q.y,q.z),u.push(Y/M),u.push(1-ee/w),V+=1}for(let ee=0;ee<w;ee++)for(let Z=0;Z<M;Z++){const he=h+Z+X*(ee+1),J=h+(Z+1)+X*(ee+1),ae=h+(Z+1)+X*ee;l.push(h+Z+X*ee,he,ae),l.push(he,J,ae),O+=6}a.addGroup(f,O,E),f+=O,h+=V}m("z","y","x",-1,-1,n,t,e,o,s,0),m("z","y","x",1,-1,n,t,-e,o,s,1),m("x","z","y",1,1,e,n,t,r,o,2),m("x","z","y",1,-1,e,n,-t,r,o,3),m("x","y","z",1,-1,e,t,n,r,s,4),m("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new Ge(c,3)),this.setAttribute("normal",new Ge(d,3)),this.setAttribute("uv",new Ge(u,2))}static fromJSON(e){return new Ki(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Lf(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];e[t][n]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function as(i){const e={};for(let t=0;t<i.length;t++){const n=Lf(i[t]);for(const r in n)e[r]=n[r]}return e}function Xj(i){return null===i.getRenderTarget()&&i.outputEncoding===hi?$o:xf}const mi={clone:Lf,merge:as};class Rt extends On{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Lf(e.uniforms),this.uniformsGroups=function $ie(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class o0 extends wi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ve,this.projectionMatrix=new Ve,this.projectionMatrixInverse=new Ve}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Sn extends o0{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*X_*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Vd*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*X_*Math.atan(Math.tan(.5*Vd*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Vd*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*n/c,r*=o.width/l,n*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class DT extends wi{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n;const r=new Sn(-90,1,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);const s=new Sn(-90,1,e,t);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),this.add(s);const o=new Sn(-90,1,e,t);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(0,1,0),this.add(o);const a=new Sn(-90,1,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);const l=new Sn(-90,1,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,1),this.add(l);const c=new Sn(-90,1,e,t);c.layers=this.layers,c.up.set(0,1,0),c.lookAt(0,0,-1),this.add(c)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[r,s,o,a,l,c]=this.children,d=e.getRenderTarget(),u=e.toneMapping,h=e.xr.enabled;e.toneMapping=Ra,e.xr.enabled=!1;const f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,s),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,a),e.setRenderTarget(n,4),e.render(t,l),n.texture.generateMipmaps=f,e.setRenderTarget(n,5),e.render(t,c),e.setRenderTarget(d),e.toneMapping=u,e.xr.enabled=h,n.texture.needsPMREMUpdate=!0}}class qd extends qn{constructor(e,t,n,r,s,o,a,l,c,d){super(e=void 0!==e?e:[],t=void 0!==t?t:sc,n,r,s,o,a,l,c,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Yj extends Gt{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1};this.texture=new qd([n,n,n,n,n,n],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Li}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n_uniforms={tEquirect:{value:null}},n_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",n_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new Ki(5,5,5),s=new Rt({name:"CubemapFromEquirect",uniforms:Lf(n_uniforms),vertexShader:n_vertexShader,fragmentShader:n_fragmentShader,side:ys,blending:Kt});s.uniforms.tEquirect.value=t;const o=new Ke(r,s),a=t.minFilter;return t.minFilter===Xs&&(t.minFilter=Li),new DT(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(s)}}const PT=new T,tne=new T,ine=new Xr;class to{constructor(e=new T(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=PT.subVectors(n,t).cross(tne.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(PT),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(n).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||ine.getNormalMatrix(e),r=this.coplanarPoint(PT).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const jf=new Al,VA=new T;class zA{constructor(e=new to,t=new to,n=new to,r=new to,s=new to,o=new to){this.planes=[e,t,n,r,s,o]}set(e,t,n,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,r=n[0],s=n[1],o=n[2],a=n[3],l=n[4],c=n[5],d=n[6],u=n[7],h=n[8],f=n[9],m=n[10],p=n[11],g=n[12],_=n[13],v=n[14],b=n[15];return t[0].setComponents(a-r,u-l,p-h,b-g).normalize(),t[1].setComponents(a+r,u+l,p+h,b+g).normalize(),t[2].setComponents(a+s,u+c,p+f,b+_).normalize(),t[3].setComponents(a-s,u-c,p-f,b-_).normalize(),t[4].setComponents(a-o,u-d,p-m,b-v).normalize(),t[5].setComponents(a+o,u+d,p+m,b+v).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),jf.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(jf)}intersectsSprite(e){return jf.center.set(0,0,0),jf.radius=.7071067811865476,jf.applyMatrix4(e.matrixWorld),this.intersectsSphere(jf)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(VA.x=r.normal.x>0?e.max.x:e.min.x,VA.y=r.normal.y>0?e.max.y:e.min.y,VA.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(VA)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Zj(){let i=null,e=!1,t=null,n=null;function r(s,o){t(s,o),n=i.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function nne(i,e){const t=e.isWebGL2,n=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),n.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const d=n.get(c);d&&(i.deleteBuffer(d.buffer),n.delete(c))},update:function l(c,d){if(c.isGLBufferAttribute){const h=n.get(c);return void((!h||h.version<c.version)&&n.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const u=n.get(c);void 0===u?n.set(c,function r(c,d){const u=c.array,h=c.usage,f=i.createBuffer();let m;if(i.bindBuffer(d,f),i.bufferData(d,u,h),c.onUploadCallback(),u instanceof Float32Array)m=5126;else if(u instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");m=5131}else m=5123;else if(u instanceof Int16Array)m=5122;else if(u instanceof Uint32Array)m=5125;else if(u instanceof Int32Array)m=5124;else if(u instanceof Int8Array)m=5120;else if(u instanceof Uint8Array)m=5121;else{if(!(u instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);m=5121}return{buffer:f,type:m,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version}}(c,d)):u.version<c.version&&(function s(c,d,u){const h=d.array,f=d.updateRange;i.bindBuffer(u,c),-1===f.count?i.bufferSubData(u,0,h):(t?i.bufferSubData(u,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):i.bufferSubData(u,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1),d.onUploadCallback()}(u.buffer,c,d),u.version=c.version)}}}class gc extends xt{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(n),l=Math.floor(r),c=a+1,d=l+1,u=e/a,h=t/l,f=[],m=[],p=[],g=[];for(let _=0;_<d;_++){const v=_*h-o;for(let b=0;b<c;b++)m.push(b*u-s,-v,0),p.push(0,0,1),g.push(b/a),g.push(1-_/l)}for(let _=0;_<l;_++)for(let v=0;v<a;v++){const y=v+c*(_+1),x=v+1+c*(_+1),C=v+1+c*_;f.push(v+c*_,y,C),f.push(y,x,C)}this.setIndex(f),this.setAttribute("position",new Ge(m,3)),this.setAttribute("normal",new Ge(p,3)),this.setAttribute("uv",new Ge(g,2))}static fromJSON(e){return new gc(e.width,e.height,e.widthSegments,e.heightSegments)}}const fi={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if defined( USE_SHADOWMAP ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_COORDS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},it={common:{diffuse:{value:new De(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Xr},uv2Transform:{value:new Xr},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ue(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new De(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new De(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Xr}},sprite:{diffuse:{value:new De(16777215)},opacity:{value:1},center:{value:new ue(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Xr}}},wo={basic:{uniforms:as([it.common,it.specularmap,it.envmap,it.aomap,it.lightmap,it.fog]),vertexShader:fi.meshbasic_vert,fragmentShader:fi.meshbasic_frag},lambert:{uniforms:as([it.common,it.specularmap,it.envmap,it.aomap,it.lightmap,it.emissivemap,it.bumpmap,it.normalmap,it.displacementmap,it.fog,it.lights,{emissive:{value:new De(0)}}]),vertexShader:fi.meshlambert_vert,fragmentShader:fi.meshlambert_frag},phong:{uniforms:as([it.common,it.specularmap,it.envmap,it.aomap,it.lightmap,it.emissivemap,it.bumpmap,it.normalmap,it.displacementmap,it.fog,it.lights,{emissive:{value:new De(0)},specular:{value:new De(1118481)},shininess:{value:30}}]),vertexShader:fi.meshphong_vert,fragmentShader:fi.meshphong_frag},standard:{uniforms:as([it.common,it.envmap,it.aomap,it.lightmap,it.emissivemap,it.bumpmap,it.normalmap,it.displacementmap,it.roughnessmap,it.metalnessmap,it.fog,it.lights,{emissive:{value:new De(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:fi.meshphysical_vert,fragmentShader:fi.meshphysical_frag},toon:{uniforms:as([it.common,it.aomap,it.lightmap,it.emissivemap,it.bumpmap,it.normalmap,it.displacementmap,it.gradientmap,it.fog,it.lights,{emissive:{value:new De(0)}}]),vertexShader:fi.meshtoon_vert,fragmentShader:fi.meshtoon_frag},matcap:{uniforms:as([it.common,it.bumpmap,it.normalmap,it.displacementmap,it.fog,{matcap:{value:null}}]),vertexShader:fi.meshmatcap_vert,fragmentShader:fi.meshmatcap_frag},points:{uniforms:as([it.points,it.fog]),vertexShader:fi.points_vert,fragmentShader:fi.points_frag},dashed:{uniforms:as([it.common,it.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:fi.linedashed_vert,fragmentShader:fi.linedashed_frag},depth:{uniforms:as([it.common,it.displacementmap]),vertexShader:fi.depth_vert,fragmentShader:fi.depth_frag},normal:{uniforms:as([it.common,it.bumpmap,it.normalmap,it.displacementmap,{opacity:{value:1}}]),vertexShader:fi.meshnormal_vert,fragmentShader:fi.meshnormal_frag},sprite:{uniforms:as([it.sprite,it.fog]),vertexShader:fi.sprite_vert,fragmentShader:fi.sprite_frag},background:{uniforms:{uvTransform:{value:new Xr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:fi.background_vert,fragmentShader:fi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:fi.backgroundCube_vert,fragmentShader:fi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:fi.cube_vert,fragmentShader:fi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:fi.equirect_vert,fragmentShader:fi.equirect_frag},distanceRGBA:{uniforms:as([it.common,it.displacementmap,{referencePosition:{value:new T},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:fi.distanceRGBA_vert,fragmentShader:fi.distanceRGBA_frag},shadow:{uniforms:as([it.lights,it.fog,{color:{value:new De(0)},opacity:{value:1}}]),vertexShader:fi.shadow_vert,fragmentShader:fi.shadow_frag}};wo.physical={uniforms:as([wo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ue(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new De(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ue},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new De(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new De(1,1,1)},specularColorMap:{value:null}}]),vertexShader:fi.meshphysical_vert,fragmentShader:fi.meshphysical_frag};const HA={r:0,b:0,g:0};function ise(i,e,t,n,r,s,o){const a=new De(0);let c,d,l=!0===s?0:1,u=null,h=0,f=null;function p(g,_){g.getRGB(HA,Xj(i)),n.buffers.color.setClear(HA.r,HA.g,HA.b,_,o)}return{getClearColor:function(){return a},setClearColor:function(g,_=1){a.set(g),l=_,p(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,p(a,l)},render:function m(g,_){let v=!1,b=!0===_.isScene?_.background:null;b&&b.isTexture&&(b=(_.backgroundBlurriness>0?t:e).get(b));const y=i.xr,x=y.getSession&&y.getSession();x&&"additive"===x.environmentBlendMode&&(b=null),null===b?p(a,l):b&&b.isColor&&(p(b,1),v=!0),(i.autoClear||v)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),b&&(b.isCubeTexture||b.mapping===ff)?(void 0===d&&(d=new Ke(new Ki(1,1,1),new Rt({name:"BackgroundCubeMaterial",uniforms:Lf(wo.backgroundCube.uniforms),vertexShader:wo.backgroundCube.vertexShader,fragmentShader:wo.backgroundCube.fragmentShader,side:ys,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(C,M,w){this.matrixWorld.copyPosition(w.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(d)),d.material.uniforms.envMap.value=b,d.material.uniforms.flipEnvMap.value=b.isCubeTexture&&!1===b.isRenderTargetTexture?-1:1,d.material.uniforms.backgroundBlurriness.value=_.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=_.backgroundIntensity,d.material.toneMapped=b.encoding!==hi,(u!==b||h!==b.version||f!==i.toneMapping)&&(d.material.needsUpdate=!0,u=b,h=b.version,f=i.toneMapping),d.layers.enableAll(),g.unshift(d,d.geometry,d.material,0,0,null)):b&&b.isTexture&&(void 0===c&&(c=new Ke(new gc(2,2),new Rt({name:"BackgroundMaterial",uniforms:Lf(wo.background.uniforms),vertexShader:wo.background.vertexShader,fragmentShader:wo.background.fragmentShader,side:_l,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=b,c.material.uniforms.backgroundIntensity.value=_.backgroundIntensity,c.material.toneMapped=b.encoding!==hi,!0===b.matrixAutoUpdate&&b.updateMatrix(),c.material.uniforms.uvTransform.value.copy(b.matrix),(u!==b||h!==b.version||f!==i.toneMapping)&&(c.material.needsUpdate=!0,u=b,h=b.version,f=i.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}}}function nse(i,e,t,n){const r=i.getParameter(34921),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),o=n.isWebGL2||null!==s,a={},l=g(null);let c=l,d=!1;function f(L){return n.isWebGL2?i.bindVertexArray(L):s.bindVertexArrayOES(L)}function m(L){return n.isWebGL2?i.deleteVertexArray(L):s.deleteVertexArrayOES(L)}function g(L){const X=[],P=[],V=[];for(let O=0;O<r;O++)X[O]=0,P[O]=0,V[O]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:X,enabledAttributes:P,attributeDivisors:V,object:L,attributes:{},index:null}}function b(){const L=c.newAttributes;for(let X=0,P=L.length;X<P;X++)L[X]=0}function y(L){x(L,0)}function x(L,X){const V=c.enabledAttributes,O=c.attributeDivisors;c.newAttributes[L]=1,0===V[L]&&(i.enableVertexAttribArray(L),V[L]=1),O[L]!==X&&((n.isWebGL2?i:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](L,X),O[L]=X)}function C(){const L=c.newAttributes,X=c.enabledAttributes;for(let P=0,V=X.length;P<V;P++)X[P]!==L[P]&&(i.disableVertexAttribArray(P),X[P]=0)}function M(L,X,P,V,O,q){!0!==n.isWebGL2||5124!==P&&5125!==P?i.vertexAttribPointer(L,X,P,V,O,q):i.vertexAttribIPointer(L,X,P,O,q)}function Q(){B(),d=!0,c!==l&&(c=l,f(c.object))}function B(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function u(L,X,P,V,O){let q=!1;if(o){const ee=function p(L,X,P){const V=!0===P.wireframe;let O=a[L.id];void 0===O&&(O={},a[L.id]=O);let q=O[X.id];void 0===q&&(q={},O[X.id]=q);let ee=q[V];return void 0===ee&&(ee=g(function h(){return n.isWebGL2?i.createVertexArray():s.createVertexArrayOES()}()),q[V]=ee),ee}(V,P,X);c!==ee&&(c=ee,f(c.object)),q=function _(L,X,P,V){const O=c.attributes,q=X.attributes;let ee=0;const Z=P.getAttributes();for(const Y in Z)if(Z[Y].location>=0){const J=O[Y];let ae=q[Y];if(void 0===ae&&("instanceMatrix"===Y&&L.instanceMatrix&&(ae=L.instanceMatrix),"instanceColor"===Y&&L.instanceColor&&(ae=L.instanceColor)),void 0===J||J.attribute!==ae||ae&&J.data!==ae.data)return!0;ee++}return c.attributesNum!==ee||c.index!==V}(L,V,P,O),q&&function v(L,X,P,V){const O={},q=X.attributes;let ee=0;const Z=P.getAttributes();for(const Y in Z)if(Z[Y].location>=0){let J=q[Y];void 0===J&&("instanceMatrix"===Y&&L.instanceMatrix&&(J=L.instanceMatrix),"instanceColor"===Y&&L.instanceColor&&(J=L.instanceColor));const ae={};ae.attribute=J,J&&J.data&&(ae.data=J.data),O[Y]=ae,ee++}c.attributes=O,c.attributesNum=ee,c.index=V}(L,V,P,O)}else{const ee=!0===X.wireframe;(c.geometry!==V.id||c.program!==P.id||c.wireframe!==ee)&&(c.geometry=V.id,c.program=P.id,c.wireframe=ee,q=!0)}null!==O&&t.update(O,34963),(q||d)&&(d=!1,function w(L,X,P,V){if(!1===n.isWebGL2&&(L.isInstancedMesh||V.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;b();const O=V.attributes,q=P.getAttributes(),ee=X.defaultAttributeValues;for(const Z in q){const Y=q[Z];if(Y.location>=0){let he=O[Z];if(void 0===he&&("instanceMatrix"===Z&&L.instanceMatrix&&(he=L.instanceMatrix),"instanceColor"===Z&&L.instanceColor&&(he=L.instanceColor)),void 0!==he){const J=he.normalized,ae=he.itemSize,G=t.get(he);if(void 0===G)continue;const U=G.buffer,de=G.type,Ee=G.bytesPerElement;if(he.isInterleavedBufferAttribute){const we=he.data,et=we.stride,Ae=he.offset;if(we.isInstancedInterleavedBuffer){for(let xe=0;xe<Y.locationSize;xe++)x(Y.location+xe,we.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===V._maxInstanceCount&&(V._maxInstanceCount=we.meshPerAttribute*we.count)}else for(let xe=0;xe<Y.locationSize;xe++)y(Y.location+xe);i.bindBuffer(34962,U);for(let xe=0;xe<Y.locationSize;xe++)M(Y.location+xe,ae/Y.locationSize,de,J,et*Ee,(Ae+ae/Y.locationSize*xe)*Ee)}else{if(he.isInstancedBufferAttribute){for(let we=0;we<Y.locationSize;we++)x(Y.location+we,he.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===V._maxInstanceCount&&(V._maxInstanceCount=he.meshPerAttribute*he.count)}else for(let we=0;we<Y.locationSize;we++)y(Y.location+we);i.bindBuffer(34962,U);for(let we=0;we<Y.locationSize;we++)M(Y.location+we,ae/Y.locationSize,de,J,ae*Ee,ae/Y.locationSize*we*Ee)}}else if(void 0!==ee){const J=ee[Z];if(void 0!==J)switch(J.length){case 2:i.vertexAttrib2fv(Y.location,J);break;case 3:i.vertexAttrib3fv(Y.location,J);break;case 4:i.vertexAttrib4fv(Y.location,J);break;default:i.vertexAttrib1fv(Y.location,J)}}}}C()}(L,X,P,V),null!==O&&i.bindBuffer(34963,t.get(O).buffer))},reset:Q,resetDefaultState:B,dispose:function E(){Q();for(const L in a){const X=a[L];for(const P in X){const V=X[P];for(const O in V)m(V[O].object),delete V[O];delete X[P]}delete a[L]}},releaseStatesOfGeometry:function I(L){if(void 0===a[L.id])return;const X=a[L.id];for(const P in X){const V=X[P];for(const O in V)m(V[O].object),delete V[O];delete X[P]}delete a[L.id]},releaseStatesOfProgram:function F(L){for(const X in a){const P=a[X];if(void 0===P[L.id])continue;const V=P[L.id];for(const O in V)m(V[O].object),delete V[O];delete P[L.id]}},initAttributes:b,enableAttribute:y,disableUnusedAttributes:C}}function rse(i,e,t,n){const r=n.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,d){i.drawArrays(s,c,d),t.update(d,s,1)},this.renderInstances=function l(c,d,u){if(0===u)return;let h,f;if(r)h=i,f="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===h)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[f](s,c,d,u),t.update(d,s,u)}}function sse(i,e,t){let n;function s(M){if("highp"===M){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";M="mediump"}return"mediump"===M&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&i instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&i instanceof WebGL2ComputeRenderingContext;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),d=!0===t.logarithmicDepthBuffer,u=i.getParameter(34930),h=i.getParameter(35660),f=i.getParameter(3379),m=i.getParameter(34076),p=i.getParameter(34921),g=i.getParameter(36347),_=i.getParameter(36348),v=i.getParameter(36349),b=h>0,y=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==n)return n;if(!0===e.has("EXT_texture_filter_anisotropic")){const M=e.get("EXT_texture_filter_anisotropic");n=i.getParameter(M.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:d,maxTextures:u,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:m,maxAttributes:p,maxVertexUniforms:g,maxVaryings:_,maxFragmentUniforms:v,vertexTextures:b,floatFragmentTextures:y,floatVertexTextures:b&&y,maxSamples:o?i.getParameter(36183):0}}function ose(i){const e=this;let t=null,n=0,r=!1,s=!1;const o=new to,a=new Xr,l={value:null,needsUpdate:!1};function c(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function d(u,h,f,m){const p=null!==u?u.length:0;let g=null;if(0!==p){if(g=l.value,!0!==m||null===g){const _=f+4*p,v=h.matrixWorldInverse;a.getNormalMatrix(v),(null===g||g.length<_)&&(g=new Float32Array(_));for(let b=0,y=f;b!==p;++b,y+=4)o.copy(u[b]).applyMatrix4(v,a),o.normal.toArray(g,y),g[y+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=p,e.numIntersection=0,g}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,h,f){const m=0!==u.length||h||0!==n||r;return r=h,t=d(u,f,0),n=u.length,m},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1,c()},this.setState=function(u,h,f){const m=u.clippingPlanes,p=u.clipIntersection,g=u.clipShadows,_=i.get(u);if(!r||null===m||0===m.length||s&&!g)s?d(null):c();else{const v=s?0:n,b=4*v;let y=_.clippingState||null;l.value=y,y=d(m,h,b,f);for(let x=0;x!==b;++x)y[x]=t[x];_.clippingState=y,this.numIntersection=p?this.numPlanes:0,this.numPlanes+=v}}}function ase(i){let e=new WeakMap;function t(o,a){return a===hf?o.mapping=sc:a===j_&&(o.mapping=oc),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function n(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(a===hf||a===j_){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new Yj(l.height/2);return c.fromEquirectangularTexture(i,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class Pa extends o0{constructor(e=-1,t=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,o=n+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=d*this.view.offsetY,l=a-d*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const Kj=[.125,.215,.35,.446,.526,.582],kT=new Pa,$j=new De;let FT=null;const Yd=(1+Math.sqrt(5))/2,Vf=1/Yd,Jj=[new T(1,1,1),new T(-1,1,1),new T(1,1,-1),new T(-1,1,-1),new T(0,Yd,Vf),new T(0,Yd,-Vf),new T(Vf,0,Yd),new T(-Vf,0,Yd),new T(Yd,Vf,0),new T(-Yd,Vf,0)];class BT{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){FT=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=iU(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=tU(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(FT),e.scissorTest=!1,GA(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===sc||e.mapping===oc?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),FT=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Li,minFilter:Li,generateMipmaps:!1,type:fn,format:En,encoding:Ys,depthBuffer:!1},r=eU(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=eU(e,t,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function lse(i){const e=[],t=[],n=[];let r=i;const s=i-4+1+Kj.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>i-4?l=Kj[o-i+4-1]:0===o&&(l=0),n.push(l);const c=1/(a-2),d=-c,u=1+c,h=[d,d,u,d,u,u,d,d,u,u,d,u],f=6,m=6,p=3,g=2,_=1,v=new Float32Array(p*m*f),b=new Float32Array(g*m*f),y=new Float32Array(_*m*f);for(let C=0;C<f;C++){const M=C%3*2/3-1,w=C>2?0:-1;v.set([M,w,0,M+2/3,w,0,M+2/3,w+1,0,M,w,0,M+2/3,w+1,0,M,w+1,0],p*m*C),b.set(h,g*m*C),y.set([C,C,C,C,C,C],_*m*C)}const x=new xt;x.setAttribute("position",new Ci(v,p)),x.setAttribute("uv",new Ci(b,g)),x.setAttribute("faceIndex",new Ci(y,_)),e.push(x),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}(s)),this._blurMaterial=function cse(i,e,t){const n=new Float32Array(20),r=new T(0,1,0);return new Rt({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:Kt,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new Ke(this._lodPlanes[0],e);this._renderer.compile(t,kT)}_sceneToCubeUV(e,t,n,r){const a=new Sn(90,1,t,n),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],d=this._renderer,u=d.autoClear,h=d.toneMapping;d.getClearColor($j),d.toneMapping=Ra,d.autoClear=!1;const f=new Xn({name:"PMREM.Background",side:ys,depthWrite:!1,depthTest:!1}),m=new Ke(new Ki,f);let p=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,p=!0):(f.color.copy($j),p=!0);for(let _=0;_<6;_++){const v=_%3;0===v?(a.up.set(0,l[_],0),a.lookAt(c[_],0,0)):1===v?(a.up.set(0,0,l[_]),a.lookAt(0,c[_],0)):(a.up.set(0,l[_],0),a.lookAt(0,0,c[_]));const b=this._cubeSize;GA(r,v*b,_>2?b:0,b,b),d.setRenderTarget(r),p&&d.render(m,a),d.render(e,a)}m.geometry.dispose(),m.material.dispose(),d.toneMapping=h,d.autoClear=u,e.background=g}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===sc||e.mapping===oc;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=iU()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=tU());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Ke(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;GA(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(o,kT)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,Jj[(r-1)%Jj.length])}t.autoClear=n}_blur(e,t,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const u=new Ke(this._lodPlanes[r],c),h=c.uniforms,f=this._sizeLods[n]-1,m=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,p=s/m,g=isFinite(s)?1+Math.floor(3*p):20;g>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const _=[];let v=0;for(let M=0;M<20;++M){const w=M/p,E=Math.exp(-w*w/2);_.push(E),0===M?v+=E:M<g&&(v+=2*E)}for(let M=0;M<_.length;M++)_[M]=_[M]/v;h.envMap.value=e.texture,h.samples.value=g,h.weights.value=_,h.latitudinal.value="latitudinal"===o,a&&(h.poleAxis.value=a);const{_lodMax:b}=this;h.dTheta.value=m,h.mipInt.value=b-n;const y=this._sizeLods[r];GA(t,3*y*(r>b-4?r-b+4:0),4*(this._cubeSize-y),3*y,2*y),l.setRenderTarget(t),l.render(u,kT)}}function eU(i,e,t){const n=new Gt(i,e,t);return n.texture.mapping=ff,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function GA(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function tU(){return new Rt({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:Kt,depthTest:!1,depthWrite:!1})}function iU(){return new Rt({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:Kt,depthTest:!1,depthWrite:!1})}function dse(i){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function n(a){if(a&&a.isTexture){const l=a.mapping,c=l===hf||l===j_,d=l===sc||l===oc;if(c||d){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let u=e.get(a);return null===t&&(t=new BT(i)),u=c?t.fromEquirectangular(a,u):t.fromCubemap(a,u),e.set(a,u),u.texture}if(e.has(a))return e.get(a).texture;{const u=a.image;if(c&&u&&u.height>0||d&&u&&function r(a){let l=0;for(let d=0;d<6;d++)void 0!==a[d]&&l++;return 6===l}(u)){null===t&&(t=new BT(i));const h=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function use(i){const e={};function t(n){if(void 0!==e[n])return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return{has:function(n){return null!==t(n)},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const r=t(n);return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function hse(i,e,t,n){const r={},s=new WeakMap;function o(u){const h=u.target;null!==h.index&&e.remove(h.index);for(const m in h.attributes)e.remove(h.attributes[m]);h.removeEventListener("dispose",o),delete r[h.id];const f=s.get(h);f&&(e.remove(f),s.delete(h)),n.releaseStatesOfGeometry(h),!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount,t.memory.geometries--}function c(u){const h=[],f=u.index,m=u.attributes.position;let p=0;if(null!==f){const v=f.array;p=f.version;for(let b=0,y=v.length;b<y;b+=3){const x=v[b+0],C=v[b+1],M=v[b+2];h.push(x,C,C,M,M,x)}}else{p=m.version;for(let b=0,y=m.array.length/3-1;b<y;b+=3){const x=b+0,C=b+1,M=b+2;h.push(x,C,C,M,M,x)}}const g=new(Lj(h)?FA:kA)(h,1);g.version=p;const _=s.get(u);_&&e.remove(_),s.set(u,g)}return{get:function a(u,h){return!0===r[h.id]||(h.addEventListener("dispose",o),r[h.id]=!0,t.memory.geometries++),h},update:function l(u){const h=u.attributes;for(const m in h)e.update(h[m],34962);const f=u.morphAttributes;for(const m in f){const p=f[m];for(let g=0,_=p.length;g<_;g++)e.update(p[g],34962)}},getWireframeAttribute:function d(u){const h=s.get(u);if(h){const f=u.index;null!==f&&h.version<f.version&&c(u)}else c(u);return s.get(u)}}}function fse(i,e,t,n){const r=n.isWebGL2;let s,a,l;this.setMode=function o(h){s=h},this.setIndex=function c(h){a=h.type,l=h.bytesPerElement},this.render=function d(h,f){i.drawElements(s,f,a,h*l),t.update(f,s,1)},this.renderInstances=function u(h,f,m){if(0===m)return;let p,g;if(r)p=i,g="drawElementsInstanced";else if(p=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",null===p)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[g](s,f,a,h*l,m),t.update(f,s,m)}}function pse(i){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function n(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function mse(i,e){return i[0]-e[0]}function gse(i,e){return Math.abs(e[1])-Math.abs(i[1])}function _se(i,e,t){const n={},r=new Float32Array(8),s=new WeakMap,o=new ni,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,d,u,h){const f=c.morphTargetInfluences;if(!0===e.isWebGL2){const m=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,p=void 0!==m?m.length:0;let g=s.get(d);if(void 0===g||g.count!==p){let X=function(){B.dispose(),s.delete(d),d.removeEventListener("dispose",X)};void 0!==g&&g.texture.dispose();const b=void 0!==d.morphAttributes.position,y=void 0!==d.morphAttributes.normal,x=void 0!==d.morphAttributes.color,C=d.morphAttributes.position||[],M=d.morphAttributes.normal||[],w=d.morphAttributes.color||[];let E=0;!0===b&&(E=1),!0===y&&(E=2),!0===x&&(E=3);let I=d.attributes.position.count*E,F=1;I>e.maxTextureSize&&(F=Math.ceil(I/e.maxTextureSize),I=e.maxTextureSize);const Q=new Float32Array(I*F*4*p),B=new Mf(Q,I,F,p);B.type=Ln,B.needsUpdate=!0;const L=4*E;for(let P=0;P<p;P++){const V=C[P],O=M[P],q=w[P],ee=I*F*4*P;for(let Z=0;Z<V.count;Z++){const Y=Z*L;!0===b&&(o.fromBufferAttribute(V,Z),Q[ee+Y+0]=o.x,Q[ee+Y+1]=o.y,Q[ee+Y+2]=o.z,Q[ee+Y+3]=0),!0===y&&(o.fromBufferAttribute(O,Z),Q[ee+Y+4]=o.x,Q[ee+Y+5]=o.y,Q[ee+Y+6]=o.z,Q[ee+Y+7]=0),!0===x&&(o.fromBufferAttribute(q,Z),Q[ee+Y+8]=o.x,Q[ee+Y+9]=o.y,Q[ee+Y+10]=o.z,Q[ee+Y+11]=4===q.itemSize?o.w:1)}}g={count:p,texture:B,size:new ue(I,F)},s.set(d,g),d.addEventListener("dispose",X)}let _=0;for(let b=0;b<f.length;b++)_+=f[b];const v=d.morphTargetsRelative?1:1-_;h.getUniforms().setValue(i,"morphTargetBaseInfluence",v),h.getUniforms().setValue(i,"morphTargetInfluences",f),h.getUniforms().setValue(i,"morphTargetsTexture",g.texture,t),h.getUniforms().setValue(i,"morphTargetsTextureSize",g.size)}else{const m=void 0===f?0:f.length;let p=n[d.id];if(void 0===p||p.length!==m){p=[];for(let y=0;y<m;y++)p[y]=[y,0];n[d.id]=p}for(let y=0;y<m;y++){const x=p[y];x[0]=y,x[1]=f[y]}p.sort(gse);for(let y=0;y<8;y++)y<m&&p[y][1]?(a[y][0]=p[y][0],a[y][1]=p[y][1]):(a[y][0]=Number.MAX_SAFE_INTEGER,a[y][1]=0);a.sort(mse);const g=d.morphAttributes.position,_=d.morphAttributes.normal;let v=0;for(let y=0;y<8;y++){const x=a[y],C=x[0],M=x[1];C!==Number.MAX_SAFE_INTEGER&&M?(g&&d.getAttribute("morphTarget"+y)!==g[C]&&d.setAttribute("morphTarget"+y,g[C]),_&&d.getAttribute("morphNormal"+y)!==_[C]&&d.setAttribute("morphNormal"+y,_[C]),r[y]=M,v+=M):(g&&!0===d.hasAttribute("morphTarget"+y)&&d.deleteAttribute("morphTarget"+y),_&&!0===d.hasAttribute("morphNormal"+y)&&d.deleteAttribute("morphNormal"+y),r[y]=0)}const b=d.morphTargetsRelative?1:1-v;h.getUniforms().setValue(i,"morphTargetBaseInfluence",b),h.getUniforms().setValue(i,"morphTargetInfluences",r)}}}}function bse(i,e,t,n){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=n.render.frame,u=e.get(l,l.geometry);return r.get(u)!==c&&(e.update(u),r.set(u,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),null!==l.instanceColor&&t.update(l.instanceColor,34962)),u},dispose:function o(){r=new WeakMap}}}const nU=new qn,rU=new Mf,sU=new Ef,oU=new qd,aU=[],lU=[],cU=new Float32Array(16),dU=new Float32Array(9),uU=new Float32Array(4);function zf(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=aU[r];if(void 0===s&&(s=new Float32Array(r),aU[r]=s),0!==e){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,i[o].toArray(s,a)}return s}function br(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function vr(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function QA(i,e){let t=lU[e];void 0===t&&(t=new Int32Array(e),lU[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function vse(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function yse(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(br(t,e))return;i.uniform2fv(this.addr,e),vr(t,e)}}function Ase(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(br(t,e))return;i.uniform3fv(this.addr,e),vr(t,e)}}function xse(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(br(t,e))return;i.uniform4fv(this.addr,e),vr(t,e)}}function wse(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(br(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),vr(t,e)}else{if(br(t,n))return;uU.set(n),i.uniformMatrix2fv(this.addr,!1,uU),vr(t,n)}}function Cse(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(br(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),vr(t,e)}else{if(br(t,n))return;dU.set(n),i.uniformMatrix3fv(this.addr,!1,dU),vr(t,n)}}function Mse(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(br(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),vr(t,e)}else{if(br(t,n))return;cU.set(n),i.uniformMatrix4fv(this.addr,!1,cU),vr(t,n)}}function Ese(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function Sse(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(br(t,e))return;i.uniform2iv(this.addr,e),vr(t,e)}}function Tse(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(br(t,e))return;i.uniform3iv(this.addr,e),vr(t,e)}}function Ise(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(br(t,e))return;i.uniform4iv(this.addr,e),vr(t,e)}}function Rse(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function Dse(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(br(t,e))return;i.uniform2uiv(this.addr,e),vr(t,e)}}function Pse(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(br(t,e))return;i.uniform3uiv(this.addr,e),vr(t,e)}}function kse(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(br(t,e))return;i.uniform4uiv(this.addr,e),vr(t,e)}}function Fse(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2D(e||nU,r)}function Bse(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||sU,r)}function Lse(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||oU,r)}function Ose(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||rU,r)}function jse(i,e){i.uniform1fv(this.addr,e)}function Use(i,e){const t=zf(e,this.size,2);i.uniform2fv(this.addr,t)}function Vse(i,e){const t=zf(e,this.size,3);i.uniform3fv(this.addr,t)}function zse(i,e){const t=zf(e,this.size,4);i.uniform4fv(this.addr,t)}function Hse(i,e){const t=zf(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function Gse(i,e){const t=zf(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function Qse(i,e){const t=zf(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function Wse(i,e){i.uniform1iv(this.addr,e)}function qse(i,e){i.uniform2iv(this.addr,e)}function Xse(i,e){i.uniform3iv(this.addr,e)}function Yse(i,e){i.uniform4iv(this.addr,e)}function Zse(i,e){i.uniform1uiv(this.addr,e)}function Kse(i,e){i.uniform2uiv(this.addr,e)}function $se(i,e){i.uniform3uiv(this.addr,e)}function Jse(i,e){i.uniform4uiv(this.addr,e)}function eoe(i,e,t){const n=this.cache,r=e.length,s=QA(t,r);br(n,s)||(i.uniform1iv(this.addr,s),vr(n,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||nU,s[o])}function toe(i,e,t){const n=this.cache,r=e.length,s=QA(t,r);br(n,s)||(i.uniform1iv(this.addr,s),vr(n,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||sU,s[o])}function ioe(i,e,t){const n=this.cache,r=e.length,s=QA(t,r);br(n,s)||(i.uniform1iv(this.addr,s),vr(n,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||oU,s[o])}function noe(i,e,t){const n=this.cache,r=e.length,s=QA(t,r);br(n,s)||(i.uniform1iv(this.addr,s),vr(n,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||rU,s[o])}class soe{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function Nse(i){switch(i){case 5126:return vse;case 35664:return yse;case 35665:return Ase;case 35666:return xse;case 35674:return wse;case 35675:return Cse;case 35676:return Mse;case 5124:case 35670:return Ese;case 35667:case 35671:return Sse;case 35668:case 35672:return Tse;case 35669:case 35673:return Ise;case 5125:return Rse;case 36294:return Dse;case 36295:return Pse;case 36296:return kse;case 35678:case 36198:case 36298:case 36306:case 35682:return Fse;case 35679:case 36299:case 36307:return Bse;case 35680:case 36300:case 36308:case 36293:return Lse;case 36289:case 36303:case 36311:case 36292:return Ose}}(t.type)}}class ooe{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function roe(i){switch(i){case 5126:return jse;case 35664:return Use;case 35665:return Vse;case 35666:return zse;case 35674:return Hse;case 35675:return Gse;case 35676:return Qse;case 5124:case 35670:return Wse;case 35667:case 35671:return qse;case 35668:case 35672:return Xse;case 35669:case 35673:return Yse;case 5125:return Zse;case 36294:return Kse;case 36295:return $se;case 36296:return Jse;case 35678:case 36198:case 36298:case 36306:case 35682:return eoe;case 35679:case 36299:case 36307:return toe;case 35680:case 36300:case 36308:case 36293:return ioe;case 36289:case 36303:case 36311:case 36292:return noe}}(t.type)}}class aoe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],n)}}}const OT=/(\w+)(\])?(\[|\.)?/g;function hU(i,e){i.seq.push(e),i.map[e.id]=e}function loe(i,e,t){const n=i.name,r=n.length;for(OT.lastIndex=0;;){const s=OT.exec(n);let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&OT.lastIndex+2===r){hU(t,void 0===c?new soe(a,i,e):new ooe(a,i,e));break}{let u=t.map[a];void 0===u&&(u=new aoe(a),hU(t,u)),t=u}}}class WA{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,35718);for(let r=0;r<n;++r){const s=e.getActiveUniform(t,r);loe(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,n,r){const s=this.map[t];void 0!==s&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=n[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&n.push(o)}return n}}function fU(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}let coe=0;function pU(i,e,t){const n=i.getShaderParameter(e,35713),r=i.getShaderInfoLog(e).trim();if(n&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function doe(i,e){const t=i.split("\n"),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;n.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return n.join("\n")}(i.getShaderSource(e),o)}return r}function hoe(i,e){const t=function uoe(i){switch(i){case Ys:return["Linear","( value )"];case hi:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}(e);return"vec4 "+i+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function foe(i,e){let t;switch(e){case hj:t="Linear";break;case fj:t="Reinhard";break;case pj:t="OptimizedCineon";break;case mj:t="ACESFilmic";break;case gj:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function a0(i){return""!==i}function mU(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function gU(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const _oe=/^[ \t]*#include +<([\w\d./]+)>/gm;function NT(i){return i.replace(_oe,boe)}function boe(i,e){const t=fi[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return NT(t)}const voe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function _U(i){return i.replace(voe,yoe)}function yoe(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function bU(i){let e="precision "+i.precision+" float;\nprecision "+i.precision+" int;";return"highp"===i.precision?e+="\n#define HIGH_PRECISION":"mediump"===i.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===i.precision&&(e+="\n#define LOW_PRECISION"),e}function Eoe(i,e,t,n){const r=i.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function Aoe(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===VS?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===YN?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===af&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function xoe(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case sc:case oc:e="ENVMAP_TYPE_CUBE";break;case ff:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),d=function woe(i){let e="ENVMAP_MODE_REFLECTION";return i.envMap&&i.envMapMode===oc&&(e="ENVMAP_MODE_REFRACTION"),e}(t),u=function Coe(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case N_:e="ENVMAP_BLENDING_MULTIPLY";break;case dj:e="ENVMAP_BLENDING_MIX";break;case uj:e="ENVMAP_BLENDING_ADD"}return e}(t),h=function Moe(i){const e=i.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}(t),f=t.isWebGL2?"":function poe(i){return[i.extensionDerivatives||i.envMapCubeUVHeight||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||"physical"===i.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(a0).join("\n")}(t),m=function moe(i){const e=[];for(const t in i){const n=i[t];!1!==n&&e.push("#define "+t+" "+n)}return e.join("\n")}(s),p=r.createProgram();let g,_,v=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(g=[m].filter(a0).join("\n"),g.length>0&&(g+="\n"),_=[f,m].filter(a0).join("\n"),_.length>0&&(_+="\n")):(g=[bU(t),"#define SHADER_NAME "+t.shaderName,m,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(a0).join("\n"),_=[f,bU(t),"#define SHADER_NAME "+t.shaderName,m,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+d:"",t.envMap?"#define "+u:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Ra?"#define TONE_MAPPING":"",t.toneMapping!==Ra?fi.tonemapping_pars_fragment:"",t.toneMapping!==Ra?foe("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",fi.encodings_pars_fragment,hoe("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(a0).join("\n")),o=NT(o),o=mU(o,t),o=gU(o,t),a=NT(a),a=mU(a,t),a=gU(a,t),o=_U(o),a=_U(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(v="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,_=["#define varying in",t.glslVersion===lT?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===lT?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+_);const y=v+_+a,x=fU(r,35633,v+g+o),C=fU(r,35632,y);if(r.attachShader(p,x),r.attachShader(p,C),void 0!==t.index0AttributeName?r.bindAttribLocation(p,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(p,0,"position"),r.linkProgram(p),i.debug.checkShaderErrors){const E=r.getProgramInfoLog(p).trim(),I=r.getShaderInfoLog(x).trim(),F=r.getShaderInfoLog(C).trim();let Q=!0,B=!0;if(!1===r.getProgramParameter(p,35714)){Q=!1;const L=pU(r,x,"vertex"),X=pU(r,C,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(p,35715)+"\n\nProgram Info Log: "+E+"\n"+L+"\n"+X)}else""!==E?console.warn("THREE.WebGLProgram: Program Info Log:",E):(""===I||""===F)&&(B=!1);B&&(this.diagnostics={runnable:Q,programLog:E,vertexShader:{log:I,prefix:g},fragmentShader:{log:F,prefix:_}})}let M,w;return r.deleteShader(x),r.deleteShader(C),this.getUniforms=function(){return void 0===M&&(M=new WA(r,p)),M},this.getAttributes=function(){return void 0===w&&(w=function goe(i,e){const t={},n=i.getProgramParameter(e,35721);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),o=s.name;let a=1;35674===s.type&&(a=2),35675===s.type&&(a=3),35676===s.type&&(a=4),t[o]={type:s.type,location:i.getAttribLocation(e,o),locationSize:a}}return t}(r,p)),w},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(p),this.program=void 0},this.name=t.shaderName,this.id=coe++,this.cacheKey=e,this.usedTimes=1,this.program=p,this.vertexShader=x,this.fragmentShader=C,this}let Soe=0;class Toe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new Ioe(e),t.set(e,n)),n}}class Ioe{constructor(e){this.id=Soe++,this.code=e,this.usedTimes=0}}function Roe(i,e,t,n,r,s,o){const a=new RA,l=new Toe,c=[],d=r.isWebGL2,u=r.logarithmicDepthBuffer,h=r.vertexTextures;let f=r.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function p(w,E,I,F,Q){const B=F.fog,L=Q.geometry,P=(w.isMeshStandardMaterial?t:e).get(w.envMap||(w.isMeshStandardMaterial?F.environment:null)),V=P&&P.mapping===ff?P.image.height:null,O=m[w.type];null!==w.precision&&(f=r.getMaxPrecision(w.precision),f!==w.precision&&console.warn("THREE.WebGLProgram.getParameters:",w.precision,"not supported, using",f,"instead."));const q=L.morphAttributes.position||L.morphAttributes.normal||L.morphAttributes.color,ee=void 0!==q?q.length:0;let Y,he,J,ae,Z=0;if(void 0!==L.morphAttributes.position&&(Z=1),void 0!==L.morphAttributes.normal&&(Z=2),void 0!==L.morphAttributes.color&&(Z=3),O){const et=wo[O];Y=et.vertexShader,he=et.fragmentShader}else Y=w.vertexShader,he=w.fragmentShader,l.update(w),J=l.getVertexShaderID(w),ae=l.getFragmentShaderID(w);const G=i.getRenderTarget(),de=w.clearcoat>0,Ee=w.iridescence>0;return{isWebGL2:d,shaderID:O,shaderName:w.type,vertexShader:Y,fragmentShader:he,defines:w.defines,customVertexShaderID:J,customFragmentShaderID:ae,isRawShaderMaterial:!0===w.isRawShaderMaterial,glslVersion:w.glslVersion,precision:f,instancing:!0===Q.isInstancedMesh,instancingColor:!0===Q.isInstancedMesh&&null!==Q.instanceColor,supportsVertexTextures:h,outputEncoding:null===G?i.outputEncoding:!0===G.isXRRenderTarget?G.texture.encoding:Ys,map:!!w.map,matcap:!!w.matcap,envMap:!!P,envMapMode:P&&P.mapping,envMapCubeUVHeight:V,lightMap:!!w.lightMap,aoMap:!!w.aoMap,emissiveMap:!!w.emissiveMap,bumpMap:!!w.bumpMap,normalMap:!!w.normalMap,objectSpaceNormalMap:w.normalMapType===Pj,tangentSpaceNormalMap:w.normalMapType===uc,decodeVideoTexture:!!w.map&&!0===w.map.isVideoTexture&&w.map.encoding===hi,clearcoat:de,clearcoatMap:de&&!!w.clearcoatMap,clearcoatRoughnessMap:de&&!!w.clearcoatRoughnessMap,clearcoatNormalMap:de&&!!w.clearcoatNormalMap,iridescence:Ee,iridescenceMap:Ee&&!!w.iridescenceMap,iridescenceThicknessMap:Ee&&!!w.iridescenceThicknessMap,displacementMap:!!w.displacementMap,roughnessMap:!!w.roughnessMap,metalnessMap:!!w.metalnessMap,specularMap:!!w.specularMap,specularIntensityMap:!!w.specularIntensityMap,specularColorMap:!!w.specularColorMap,opaque:!1===w.transparent&&w.blending===Ia,alphaMap:!!w.alphaMap,alphaTest:w.alphaTest>0,gradientMap:!!w.gradientMap,sheen:w.sheen>0,sheenColorMap:!!w.sheenColorMap,sheenRoughnessMap:!!w.sheenRoughnessMap,transmission:w.transmission>0,transmissionMap:!!w.transmissionMap,thicknessMap:!!w.thicknessMap,combine:w.combine,vertexTangents:!!w.normalMap&&!!L.attributes.tangent,vertexColors:w.vertexColors,vertexAlphas:!0===w.vertexColors&&!!L.attributes.color&&4===L.attributes.color.itemSize,vertexUvs:!!(w.map||w.bumpMap||w.normalMap||w.specularMap||w.alphaMap||w.emissiveMap||w.roughnessMap||w.metalnessMap||w.clearcoatMap||w.clearcoatRoughnessMap||w.clearcoatNormalMap||w.iridescenceMap||w.iridescenceThicknessMap||w.displacementMap||w.transmissionMap||w.thicknessMap||w.specularIntensityMap||w.specularColorMap||w.sheenColorMap||w.sheenRoughnessMap),uvsVertexOnly:!(w.map||w.bumpMap||w.normalMap||w.specularMap||w.alphaMap||w.emissiveMap||w.roughnessMap||w.metalnessMap||w.clearcoatNormalMap||w.iridescenceMap||w.iridescenceThicknessMap||w.transmission>0||w.transmissionMap||w.thicknessMap||w.specularIntensityMap||w.specularColorMap||w.sheen>0||w.sheenColorMap||w.sheenRoughnessMap||!w.displacementMap),fog:!!B,useFog:!0===w.fog,fogExp2:B&&B.isFogExp2,flatShading:!!w.flatShading,sizeAttenuation:w.sizeAttenuation,logarithmicDepthBuffer:u,skinning:!0===Q.isSkinnedMesh,morphTargets:void 0!==L.morphAttributes.position,morphNormals:void 0!==L.morphAttributes.normal,morphColors:void 0!==L.morphAttributes.color,morphTargetsCount:ee,morphTextureStride:Z,numDirLights:E.directional.length,numPointLights:E.point.length,numSpotLights:E.spot.length,numSpotLightMaps:E.spotLightMap.length,numRectAreaLights:E.rectArea.length,numHemiLights:E.hemi.length,numDirLightShadows:E.directionalShadowMap.length,numPointLightShadows:E.pointShadowMap.length,numSpotLightShadows:E.spotShadowMap.length,numSpotLightShadowsWithMaps:E.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:w.dithering,shadowMapEnabled:i.shadowMap.enabled&&I.length>0,shadowMapType:i.shadowMap.type,toneMapping:w.toneMapped?i.toneMapping:Ra,physicallyCorrectLights:i.physicallyCorrectLights,premultipliedAlpha:w.premultipliedAlpha,doubleSided:w.side===rc,flipSided:w.side===ys,useDepthPacking:!!w.depthPacking,depthPacking:w.depthPacking||0,index0AttributeName:w.index0AttributeName,extensionDerivatives:w.extensions&&w.extensions.derivatives,extensionFragDepth:w.extensions&&w.extensions.fragDepth,extensionDrawBuffers:w.extensions&&w.extensions.drawBuffers,extensionShaderTextureLOD:w.extensions&&w.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||n.has("EXT_shader_texture_lod"),customProgramCacheKey:w.customProgramCacheKey()}},getProgramCacheKey:function g(w){const E=[];if(w.shaderID?E.push(w.shaderID):(E.push(w.customVertexShaderID),E.push(w.customFragmentShaderID)),void 0!==w.defines)for(const I in w.defines)E.push(I),E.push(w.defines[I]);return!1===w.isRawShaderMaterial&&(function _(w,E){w.push(E.precision),w.push(E.outputEncoding),w.push(E.envMapMode),w.push(E.envMapCubeUVHeight),w.push(E.combine),w.push(E.vertexUvs),w.push(E.fogExp2),w.push(E.sizeAttenuation),w.push(E.morphTargetsCount),w.push(E.morphAttributeCount),w.push(E.numDirLights),w.push(E.numPointLights),w.push(E.numSpotLights),w.push(E.numSpotLightMaps),w.push(E.numHemiLights),w.push(E.numRectAreaLights),w.push(E.numDirLightShadows),w.push(E.numPointLightShadows),w.push(E.numSpotLightShadows),w.push(E.numSpotLightShadowsWithMaps),w.push(E.shadowMapType),w.push(E.toneMapping),w.push(E.numClippingPlanes),w.push(E.numClipIntersection),w.push(E.depthPacking)}(E,w),function v(w,E){a.disableAll(),E.isWebGL2&&a.enable(0),E.supportsVertexTextures&&a.enable(1),E.instancing&&a.enable(2),E.instancingColor&&a.enable(3),E.map&&a.enable(4),E.matcap&&a.enable(5),E.envMap&&a.enable(6),E.lightMap&&a.enable(7),E.aoMap&&a.enable(8),E.emissiveMap&&a.enable(9),E.bumpMap&&a.enable(10),E.normalMap&&a.enable(11),E.objectSpaceNormalMap&&a.enable(12),E.tangentSpaceNormalMap&&a.enable(13),E.clearcoat&&a.enable(14),E.clearcoatMap&&a.enable(15),E.clearcoatRoughnessMap&&a.enable(16),E.clearcoatNormalMap&&a.enable(17),E.iridescence&&a.enable(18),E.iridescenceMap&&a.enable(19),E.iridescenceThicknessMap&&a.enable(20),E.displacementMap&&a.enable(21),E.specularMap&&a.enable(22),E.roughnessMap&&a.enable(23),E.metalnessMap&&a.enable(24),E.gradientMap&&a.enable(25),E.alphaMap&&a.enable(26),E.alphaTest&&a.enable(27),E.vertexColors&&a.enable(28),E.vertexAlphas&&a.enable(29),E.vertexUvs&&a.enable(30),E.vertexTangents&&a.enable(31),E.uvsVertexOnly&&a.enable(32),w.push(a.mask),a.disableAll(),E.fog&&a.enable(0),E.useFog&&a.enable(1),E.flatShading&&a.enable(2),E.logarithmicDepthBuffer&&a.enable(3),E.skinning&&a.enable(4),E.morphTargets&&a.enable(5),E.morphNormals&&a.enable(6),E.morphColors&&a.enable(7),E.premultipliedAlpha&&a.enable(8),E.shadowMapEnabled&&a.enable(9),E.physicallyCorrectLights&&a.enable(10),E.doubleSided&&a.enable(11),E.flipSided&&a.enable(12),E.useDepthPacking&&a.enable(13),E.dithering&&a.enable(14),E.specularIntensityMap&&a.enable(15),E.specularColorMap&&a.enable(16),E.transmission&&a.enable(17),E.transmissionMap&&a.enable(18),E.thicknessMap&&a.enable(19),E.sheen&&a.enable(20),E.sheenColorMap&&a.enable(21),E.sheenRoughnessMap&&a.enable(22),E.decodeVideoTexture&&a.enable(23),E.opaque&&a.enable(24),w.push(a.mask)}(E,w),E.push(i.outputEncoding)),E.push(w.customProgramCacheKey),E.join()},getUniforms:function b(w){const E=m[w.type];let I;return I=E?mi.clone(wo[E].uniforms):w.uniforms,I},acquireProgram:function y(w,E){let I;for(let F=0,Q=c.length;F<Q;F++){const B=c[F];if(B.cacheKey===E){I=B,++I.usedTimes;break}}return void 0===I&&(I=new Eoe(i,E,w,s),c.push(I)),I},releaseProgram:function x(w){if(0==--w.usedTimes){const E=c.indexOf(w);c[E]=c[c.length-1],c.pop(),w.destroy()}},releaseShaderCache:function C(w){l.remove(w)},programs:c,dispose:function M(){l.dispose()}}}function Doe(){let i=new WeakMap;return{get:function e(s){let o=i.get(s);return void 0===o&&(o={},i.set(s,o)),o},remove:function t(s){i.delete(s)},update:function n(s,o,a){i.get(s)[o]=a},dispose:function r(){i=new WeakMap}}}function Poe(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function vU(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function yU(){const i=[];let e=0;const t=[],n=[],r=[];function o(u,h,f,m,p,g){let _=i[e];return void 0===_?(_={id:u.id,object:u,geometry:h,material:f,groupOrder:m,renderOrder:u.renderOrder,z:p,group:g},i[e]=_):(_.id=u.id,_.object=u,_.geometry=h,_.material=f,_.groupOrder=m,_.renderOrder=u.renderOrder,_.z=p,_.group=g),e++,_}return{opaque:t,transmissive:n,transparent:r,init:function s(){e=0,t.length=0,n.length=0,r.length=0},push:function a(u,h,f,m,p,g){const _=o(u,h,f,m,p,g);f.transmission>0?n.push(_):!0===f.transparent?r.push(_):t.push(_)},unshift:function l(u,h,f,m,p,g){const _=o(u,h,f,m,p,g);f.transmission>0?n.unshift(_):!0===f.transparent?r.unshift(_):t.unshift(_)},finish:function d(){for(let u=e,h=i.length;u<h;u++){const f=i[u];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function c(u,h){t.length>1&&t.sort(u||Poe),n.length>1&&n.sort(h||vU),r.length>1&&r.sort(h||vU)}}}function koe(){let i=new WeakMap;return{get:function e(n,r){const s=i.get(n);let o;return void 0===s?(o=new yU,i.set(n,[o])):r>=s.length?(o=new yU,s.push(o)):o=s[r],o},dispose:function t(){i=new WeakMap}}}function Foe(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new T,color:new De};break;case"SpotLight":t={position:new T,direction:new T,color:new De,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new T,color:new De,distance:0,decay:0};break;case"HemisphereLight":t={direction:new T,skyColor:new De,groundColor:new De};break;case"RectAreaLight":t={color:new De,position:new T,halfWidth:new T,halfHeight:new T}}return i[e.id]=t,t}}}let Loe=0;function Ooe(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function Noe(i,e){const t=new Foe,n=function Boe(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ue};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ue,shadowCameraNear:1,shadowCameraFar:1e3}}return i[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let d=0;d<9;d++)r.probe.push(new T);const s=new T,o=new Ve,a=new Ve;return{setup:function l(d,u){let h=0,f=0,m=0;for(let F=0;F<9;F++)r.probe[F].set(0,0,0);let p=0,g=0,_=0,v=0,b=0,y=0,x=0,C=0,M=0,w=0;d.sort(Ooe);const E=!0!==u?Math.PI:1;for(let F=0,Q=d.length;F<Q;F++){const B=d[F],L=B.color,X=B.intensity,P=B.distance,V=B.shadow&&B.shadow.map?B.shadow.map.texture:null;if(B.isAmbientLight)h+=L.r*X*E,f+=L.g*X*E,m+=L.b*X*E;else if(B.isLightProbe)for(let O=0;O<9;O++)r.probe[O].addScaledVector(B.sh.coefficients[O],X);else if(B.isDirectionalLight){const O=t.get(B);if(O.color.copy(B.color).multiplyScalar(B.intensity*E),B.castShadow){const q=B.shadow,ee=n.get(B);ee.shadowBias=q.bias,ee.shadowNormalBias=q.normalBias,ee.shadowRadius=q.radius,ee.shadowMapSize=q.mapSize,r.directionalShadow[p]=ee,r.directionalShadowMap[p]=V,r.directionalShadowMatrix[p]=B.shadow.matrix,y++}r.directional[p]=O,p++}else if(B.isSpotLight){const O=t.get(B);O.position.setFromMatrixPosition(B.matrixWorld),O.color.copy(L).multiplyScalar(X*E),O.distance=P,O.coneCos=Math.cos(B.angle),O.penumbraCos=Math.cos(B.angle*(1-B.penumbra)),O.decay=B.decay,r.spot[_]=O;const q=B.shadow;if(B.map&&(r.spotLightMap[M]=B.map,M++,q.updateMatrices(B),B.castShadow&&w++),r.spotLightMatrix[_]=q.matrix,B.castShadow){const ee=n.get(B);ee.shadowBias=q.bias,ee.shadowNormalBias=q.normalBias,ee.shadowRadius=q.radius,ee.shadowMapSize=q.mapSize,r.spotShadow[_]=ee,r.spotShadowMap[_]=V,C++}_++}else if(B.isRectAreaLight){const O=t.get(B);O.color.copy(L).multiplyScalar(X),O.halfWidth.set(.5*B.width,0,0),O.halfHeight.set(0,.5*B.height,0),r.rectArea[v]=O,v++}else if(B.isPointLight){const O=t.get(B);if(O.color.copy(B.color).multiplyScalar(B.intensity*E),O.distance=B.distance,O.decay=B.decay,B.castShadow){const q=B.shadow,ee=n.get(B);ee.shadowBias=q.bias,ee.shadowNormalBias=q.normalBias,ee.shadowRadius=q.radius,ee.shadowMapSize=q.mapSize,ee.shadowCameraNear=q.camera.near,ee.shadowCameraFar=q.camera.far,r.pointShadow[g]=ee,r.pointShadowMap[g]=V,r.pointShadowMatrix[g]=B.shadow.matrix,x++}r.point[g]=O,g++}else if(B.isHemisphereLight){const O=t.get(B);O.skyColor.copy(B.color).multiplyScalar(X*E),O.groundColor.copy(B.groundColor).multiplyScalar(X*E),r.hemi[b]=O,b++}}v>0&&(e.isWebGL2||!0===i.has("OES_texture_float_linear")?(r.rectAreaLTC1=it.LTC_FLOAT_1,r.rectAreaLTC2=it.LTC_FLOAT_2):!0===i.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=it.LTC_HALF_1,r.rectAreaLTC2=it.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=f,r.ambient[2]=m;const I=r.hash;(I.directionalLength!==p||I.pointLength!==g||I.spotLength!==_||I.rectAreaLength!==v||I.hemiLength!==b||I.numDirectionalShadows!==y||I.numPointShadows!==x||I.numSpotShadows!==C||I.numSpotMaps!==M)&&(r.directional.length=p,r.spot.length=_,r.rectArea.length=v,r.point.length=g,r.hemi.length=b,r.directionalShadow.length=y,r.directionalShadowMap.length=y,r.pointShadow.length=x,r.pointShadowMap.length=x,r.spotShadow.length=C,r.spotShadowMap.length=C,r.directionalShadowMatrix.length=y,r.pointShadowMatrix.length=x,r.spotLightMatrix.length=C+M-w,r.spotLightMap.length=M,r.numSpotLightShadowsWithMaps=w,I.directionalLength=p,I.pointLength=g,I.spotLength=_,I.rectAreaLength=v,I.hemiLength=b,I.numDirectionalShadows=y,I.numPointShadows=x,I.numSpotShadows=C,I.numSpotMaps=M,r.version=Loe++)},setupView:function c(d,u){let h=0,f=0,m=0,p=0,g=0;const _=u.matrixWorldInverse;for(let v=0,b=d.length;v<b;v++){const y=d[v];if(y.isDirectionalLight){const x=r.directional[h];x.direction.setFromMatrixPosition(y.matrixWorld),s.setFromMatrixPosition(y.target.matrixWorld),x.direction.sub(s),x.direction.transformDirection(_),h++}else if(y.isSpotLight){const x=r.spot[m];x.position.setFromMatrixPosition(y.matrixWorld),x.position.applyMatrix4(_),x.direction.setFromMatrixPosition(y.matrixWorld),s.setFromMatrixPosition(y.target.matrixWorld),x.direction.sub(s),x.direction.transformDirection(_),m++}else if(y.isRectAreaLight){const x=r.rectArea[p];x.position.setFromMatrixPosition(y.matrixWorld),x.position.applyMatrix4(_),a.identity(),o.copy(y.matrixWorld),o.premultiply(_),a.extractRotation(o),x.halfWidth.set(.5*y.width,0,0),x.halfHeight.set(0,.5*y.height,0),x.halfWidth.applyMatrix4(a),x.halfHeight.applyMatrix4(a),p++}else if(y.isPointLight){const x=r.point[f];x.position.setFromMatrixPosition(y.matrixWorld),x.position.applyMatrix4(_),f++}else if(y.isHemisphereLight){const x=r.hemi[g];x.direction.setFromMatrixPosition(y.matrixWorld),x.direction.transformDirection(_),g++}}},state:r}}function AU(i,e){const t=new Noe(i,e),n=[],r=[];return{init:function s(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:t},setupLights:function l(u){t.setup(n,u)},setupLightsView:function c(u){t.setupView(n,u)},pushLight:function o(u){n.push(u)},pushShadow:function a(u){r.push(u)}}}function joe(i,e){let t=new WeakMap;return{get:function n(s,o=0){const a=t.get(s);let l;return void 0===a?(l=new AU(i,e),t.set(s,[l])):o>=a.length?(l=new AU(i,e),a.push(l)):l=a[o],l},dispose:function r(){t=new WeakMap}}}class Zd extends On{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Dj,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class qA extends On{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new T,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function zoe(i,e,t){let n=new zA;const r=new ue,s=new ue,o=new ni,a=new Zd({depthPacking:W_}),l=new qA,c={},d=t.maxTextureSize,u={0:ys,1:_l,2:rc},h=new Rt({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ue},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const m=new xt;m.setAttribute("position",new Ci(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const p=new Ke(m,h),g=this;function _(y,x){const C=e.update(p);h.defines.VSM_SAMPLES!==y.blurSamples&&(h.defines.VSM_SAMPLES=y.blurSamples,f.defines.VSM_SAMPLES=y.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),null===y.mapPass&&(y.mapPass=new Gt(r.x,r.y)),h.uniforms.shadow_pass.value=y.map.texture,h.uniforms.resolution.value=y.mapSize,h.uniforms.radius.value=y.radius,i.setRenderTarget(y.mapPass),i.clear(),i.renderBufferDirect(x,null,C,h,p,null),f.uniforms.shadow_pass.value=y.mapPass.texture,f.uniforms.resolution.value=y.mapSize,f.uniforms.radius.value=y.radius,i.setRenderTarget(y.map),i.clear(),i.renderBufferDirect(x,null,C,f,p,null)}function v(y,x,C,M,w,E){let I=null;const F=!0===C.isPointLight?y.customDistanceMaterial:y.customDepthMaterial;if(void 0!==F)I=F;else if(I=!0===C.isPointLight?l:a,i.localClippingEnabled&&!0===x.clipShadows&&Array.isArray(x.clippingPlanes)&&0!==x.clippingPlanes.length||x.displacementMap&&0!==x.displacementScale||x.alphaMap&&x.alphaTest>0||x.map&&x.alphaTest>0){const Q=I.uuid,B=x.uuid;let L=c[Q];void 0===L&&(L={},c[Q]=L);let X=L[B];void 0===X&&(X=I.clone(),L[B]=X),I=X}return I.visible=x.visible,I.wireframe=x.wireframe,I.side=E===af?null!==x.shadowSide?x.shadowSide:x.side:null!==x.shadowSide?x.shadowSide:u[x.side],I.alphaMap=x.alphaMap,I.alphaTest=x.alphaTest,I.map=x.map,I.clipShadows=x.clipShadows,I.clippingPlanes=x.clippingPlanes,I.clipIntersection=x.clipIntersection,I.displacementMap=x.displacementMap,I.displacementScale=x.displacementScale,I.displacementBias=x.displacementBias,I.wireframeLinewidth=x.wireframeLinewidth,I.linewidth=x.linewidth,!0===C.isPointLight&&!0===I.isMeshDistanceMaterial&&(I.referencePosition.setFromMatrixPosition(C.matrixWorld),I.nearDistance=M,I.farDistance=w),I}function b(y,x,C,M,w){if(!1===y.visible)return;if(y.layers.test(x.layers)&&(y.isMesh||y.isLine||y.isPoints)&&(y.castShadow||y.receiveShadow&&w===af)&&(!y.frustumCulled||n.intersectsObject(y))){y.modelViewMatrix.multiplyMatrices(C.matrixWorldInverse,y.matrixWorld);const F=e.update(y),Q=y.material;if(Array.isArray(Q)){const B=F.groups;for(let L=0,X=B.length;L<X;L++){const P=B[L],V=Q[P.materialIndex];if(V&&V.visible){const O=v(y,V,M,C.near,C.far,w);i.renderBufferDirect(C,null,F,O,y,P)}}}else if(Q.visible){const B=v(y,Q,M,C.near,C.far,w);i.renderBufferDirect(C,null,F,B,y,null)}}const I=y.children;for(let F=0,Q=I.length;F<Q;F++)b(I[F],x,C,M,w)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=VS,this.render=function(y,x,C){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===y.length)return;const M=i.getRenderTarget(),w=i.getActiveCubeFace(),E=i.getActiveMipmapLevel(),I=i.state;I.setBlending(Kt),I.buffers.color.setClear(1,1,1,1),I.buffers.depth.setTest(!0),I.setScissorTest(!1);for(let F=0,Q=y.length;F<Q;F++){const B=y[F],L=B.shadow;if(void 0===L){console.warn("THREE.WebGLShadowMap:",B,"has no shadow.");continue}if(!1===L.autoUpdate&&!1===L.needsUpdate)continue;r.copy(L.mapSize);const X=L.getFrameExtents();r.multiply(X),s.copy(L.mapSize),(r.x>d||r.y>d)&&(r.x>d&&(s.x=Math.floor(d/X.x),r.x=s.x*X.x,L.mapSize.x=s.x),r.y>d&&(s.y=Math.floor(d/X.y),r.y=s.y*X.y,L.mapSize.y=s.y)),null===L.map&&(L.map=new Gt(r.x,r.y,this.type!==af?{minFilter:$t,magFilter:$t}:{}),L.map.texture.name=B.name+".shadowMap",L.camera.updateProjectionMatrix()),i.setRenderTarget(L.map),i.clear();const P=L.getViewportCount();for(let V=0;V<P;V++){const O=L.getViewport(V);o.set(s.x*O.x,s.y*O.y,s.x*O.z,s.y*O.w),I.viewport(o),L.updateMatrices(B,V),n=L.getFrustum(),b(x,C,L.camera,B,this.type)}!0!==L.isPointLightShadow&&this.type===af&&_(L,C),L.needsUpdate=!1}g.needsUpdate=!1,i.setRenderTarget(M,w,E)}}function Hoe(i,e,t){const n=t.isWebGL2,a=new function r(){let re=!1;const ie=new ni;let je=null;const dt=new ni(0,0,0,0);return{setMask:function(Tt){je!==Tt&&!re&&(i.colorMask(Tt,Tt,Tt,Tt),je=Tt)},setLocked:function(Tt){re=Tt},setClear:function(Tt,ki,lr,Dr,Hl){!0===Hl&&(Tt*=Dr,ki*=Dr,lr*=Dr),ie.set(Tt,ki,lr,Dr),!1===dt.equals(ie)&&(i.clearColor(Tt,ki,lr,Dr),dt.copy(ie))},reset:function(){re=!1,je=null,dt.set(-1,0,0,0)}}},l=new function s(){let re=!1,ie=null,je=null,dt=null;return{setTest:function(Tt){Tt?U(2929):de(2929)},setMask:function(Tt){ie!==Tt&&!re&&(i.depthMask(Tt),ie=Tt)},setFunc:function(Tt){if(je!==Tt){switch(Tt){case nj:i.depthFunc(512);break;case rj:i.depthFunc(519);break;case sj:i.depthFunc(513);break;case oA:i.depthFunc(515);break;case oj:i.depthFunc(514);break;case aj:i.depthFunc(518);break;case lj:i.depthFunc(516);break;case cj:i.depthFunc(517);break;default:i.depthFunc(515)}je=Tt}},setLocked:function(Tt){re=Tt},setClear:function(Tt){dt!==Tt&&(i.clearDepth(Tt),dt=Tt)},reset:function(){re=!1,ie=null,je=null,dt=null}}},c=new function o(){let re=!1,ie=null,je=null,dt=null,Tt=null,ki=null,lr=null,Dr=null,Hl=null;return{setTest:function(on){re||(on?U(2960):de(2960))},setMask:function(on){ie!==on&&!re&&(i.stencilMask(on),ie=on)},setFunc:function(on,pa,Fs){(je!==on||dt!==pa||Tt!==Fs)&&(i.stencilFunc(on,pa,Fs),je=on,dt=pa,Tt=Fs)},setOp:function(on,pa,Fs){(ki!==on||lr!==pa||Dr!==Fs)&&(i.stencilOp(on,pa,Fs),ki=on,lr=pa,Dr=Fs)},setLocked:function(on){re=on},setClear:function(on){Hl!==on&&(i.clearStencil(on),Hl=on)},reset:function(){re=!1,ie=null,je=null,dt=null,Tt=null,ki=null,lr=null,Dr=null,Hl=null}}},d=new WeakMap,u=new WeakMap;let h={},f={},m=new WeakMap,p=[],g=null,_=!1,v=null,b=null,y=null,x=null,C=null,M=null,w=null,E=!1,I=null,F=null,Q=null,B=null,L=null;const X=i.getParameter(35661);let P=!1,V=0;const O=i.getParameter(7938);-1!==O.indexOf("WebGL")?(V=parseFloat(/^WebGL (\d)/.exec(O)[1]),P=V>=1):-1!==O.indexOf("OpenGL ES")&&(V=parseFloat(/^OpenGL ES (\d)/.exec(O)[1]),P=V>=2);let q=null,ee={};const Z=i.getParameter(3088),Y=i.getParameter(2978),he=(new ni).fromArray(Z),J=(new ni).fromArray(Y);function ae(re,ie,je){const dt=new Uint8Array(4),Tt=i.createTexture();i.bindTexture(re,Tt),i.texParameteri(re,10241,9728),i.texParameteri(re,10240,9728);for(let ki=0;ki<je;ki++)i.texImage2D(ie+ki,0,6408,1,1,0,6408,5121,dt);return Tt}const G={};function U(re){!0!==h[re]&&(i.enable(re),h[re]=!0)}function de(re){!1!==h[re]&&(i.disable(re),h[re]=!1)}G[3553]=ae(3553,3553,1),G[34067]=ae(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),U(2929),l.setFunc(oA),We(!1),yt(US),U(2884),Pe(Kt);const Ae={[As]:32774,[ZN]:32778,[KN]:32779};if(n)Ae[GS]=32775,Ae[QS]=32776;else{const re=e.get("EXT_blend_minmax");null!==re&&(Ae[GS]=re.MIN_EXT,Ae[QS]=re.MAX_EXT)}const xe={[df]:0,[L_]:1,[$N]:768,[uf]:770,[ij]:776,[sA]:774,[rA]:772,[JN]:769,[O_]:771,[tj]:775,[ej]:773};function Pe(re,ie,je,dt,Tt,ki,lr,Dr){if(re!==Kt){if(!1===_&&(U(3042),_=!0),re===cf)Tt=Tt||ie,ki=ki||je,lr=lr||dt,(ie!==b||Tt!==C)&&(i.blendEquationSeparate(Ae[ie],Ae[Tt]),b=ie,C=Tt),(je!==y||dt!==x||ki!==M||lr!==w)&&(i.blendFuncSeparate(xe[je],xe[dt],xe[ki],xe[lr]),y=je,x=dt,M=ki,w=lr),v=re,E=!1;else if(re!==v||Dr!==E){if((b!==As||C!==As)&&(i.blendEquation(32774),b=As,C=As),Dr)switch(re){case Ia:i.blendFuncSeparate(1,771,1,771);break;case lf:i.blendFunc(1,1);break;case zS:i.blendFuncSeparate(0,769,0,1);break;case HS:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",re)}else switch(re){case Ia:i.blendFuncSeparate(770,771,1,771);break;case lf:i.blendFunc(770,1);break;case zS:i.blendFuncSeparate(0,769,0,1);break;case HS:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",re)}y=null,x=null,M=null,w=null,v=re,E=Dr}}else!0===_&&(de(3042),_=!1)}function We(re){I!==re&&(i.frontFace(re?2304:2305),I=re)}function yt(re){re!==qN?(U(2884),re!==F&&i.cullFace(re===US?1029:re===XN?1028:1032)):de(2884),F=re}function ot(re,ie,je){re?(U(32823),(B!==ie||L!==je)&&(i.polygonOffset(ie,je),B=ie,L=je)):de(32823)}return{buffers:{color:a,depth:l,stencil:c},enable:U,disable:de,bindFramebuffer:function Ee(re,ie){return f[re]!==ie&&(i.bindFramebuffer(re,ie),f[re]=ie,n&&(36009===re&&(f[36160]=ie),36160===re&&(f[36009]=ie)),!0)},drawBuffers:function we(re,ie){let je=p,dt=!1;if(re)if(je=m.get(ie),void 0===je&&(je=[],m.set(ie,je)),re.isWebGLMultipleRenderTargets){const Tt=re.texture;if(je.length!==Tt.length||36064!==je[0]){for(let ki=0,lr=Tt.length;ki<lr;ki++)je[ki]=36064+ki;je.length=Tt.length,dt=!0}}else 36064!==je[0]&&(je[0]=36064,dt=!0);else 1029!==je[0]&&(je[0]=1029,dt=!0);dt&&(t.isWebGL2?i.drawBuffers(je):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(je))},useProgram:function et(re){return g!==re&&(i.useProgram(re),g=re,!0)},setBlending:Pe,setMaterial:function $e(re,ie){re.side===rc?de(2884):U(2884);let je=re.side===ys;ie&&(je=!je),We(je),re.blending===Ia&&!1===re.transparent?Pe(Kt):Pe(re.blending,re.blendEquation,re.blendSrc,re.blendDst,re.blendEquationAlpha,re.blendSrcAlpha,re.blendDstAlpha,re.premultipliedAlpha),l.setFunc(re.depthFunc),l.setTest(re.depthTest),l.setMask(re.depthWrite),a.setMask(re.colorWrite);const dt=re.stencilWrite;c.setTest(dt),dt&&(c.setMask(re.stencilWriteMask),c.setFunc(re.stencilFunc,re.stencilRef,re.stencilFuncMask),c.setOp(re.stencilFail,re.stencilZFail,re.stencilZPass)),ot(re.polygonOffset,re.polygonOffsetFactor,re.polygonOffsetUnits),!0===re.alphaToCoverage?U(32926):de(32926)},setFlipSided:We,setCullFace:yt,setLineWidth:function ht(re){re!==Q&&(P&&i.lineWidth(re),Q=re)},setPolygonOffset:ot,setScissorTest:function St(re){re?U(3089):de(3089)},activeTexture:function ft(re){void 0===re&&(re=33984+X-1),q!==re&&(i.activeTexture(re),q=re)},bindTexture:function N(re,ie,je){void 0===je&&(je=null===q?33984+X-1:q);let dt=ee[je];void 0===dt&&(dt={type:void 0,texture:void 0},ee[je]=dt),(dt.type!==re||dt.texture!==ie)&&(q!==je&&(i.activeTexture(je),q=je),i.bindTexture(re,ie||G[re]),dt.type=re,dt.texture=ie)},unbindTexture:function k(){const re=ee[q];void 0!==re&&void 0!==re.type&&(i.bindTexture(re.type,null),re.type=void 0,re.texture=void 0)},compressedTexImage2D:function _e(){try{i.compressedTexImage2D.apply(i,arguments)}catch(re){console.error("THREE.WebGLState:",re)}},compressedTexImage3D:function Se(){try{i.compressedTexImage3D.apply(i,arguments)}catch(re){console.error("THREE.WebGLState:",re)}},texImage2D:function lt(){try{i.texImage2D.apply(i,arguments)}catch(re){console.error("THREE.WebGLState:",re)}},texImage3D:function nt(){try{i.texImage3D.apply(i,arguments)}catch(re){console.error("THREE.WebGLState:",re)}},updateUBOMapping:function Jt(re,ie){let je=u.get(ie);void 0===je&&(je=new WeakMap,u.set(ie,je));let dt=je.get(re);void 0===dt&&(dt=i.getUniformBlockIndex(ie,re.name),je.set(re,dt))},uniformBlockBinding:function Ft(re,ie){const dt=u.get(ie).get(re);d.get(ie)!==dt&&(i.uniformBlockBinding(ie,dt,re.__bindingPointIndex),d.set(ie,dt))},texStorage2D:function te(){try{i.texStorage2D.apply(i,arguments)}catch(re){console.error("THREE.WebGLState:",re)}},texStorage3D:function tt(){try{i.texStorage3D.apply(i,arguments)}catch(re){console.error("THREE.WebGLState:",re)}},texSubImage2D:function Ue(){try{i.texSubImage2D.apply(i,arguments)}catch(re){console.error("THREE.WebGLState:",re)}},texSubImage3D:function Ze(){try{i.texSubImage3D.apply(i,arguments)}catch(re){console.error("THREE.WebGLState:",re)}},compressedTexSubImage2D:function bt(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(re){console.error("THREE.WebGLState:",re)}},compressedTexSubImage3D:function H(){try{i.compressedTexSubImage3D.apply(i,arguments)}catch(re){console.error("THREE.WebGLState:",re)}},scissor:function rt(re){!1===he.equals(re)&&(i.scissor(re.x,re.y,re.z,re.w),he.copy(re))},viewport:function At(re){!1===J.equals(re)&&(i.viewport(re.x,re.y,re.z,re.w),J.copy(re))},reset:function Ot(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),!0===n&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),h={},q=null,ee={},f={},m=new WeakMap,p=[],g=null,_=!1,v=null,b=null,y=null,x=null,C=null,M=null,w=null,E=!1,I=null,F=null,Q=null,B=null,L=null,he.set(0,0,i.canvas.width,i.canvas.height),J.set(0,0,i.canvas.width,i.canvas.height),a.reset(),l.reset(),c.reset()}}}function Goe(i,e,t,n,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,d=r.maxTextureSize,u=r.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),m=new WeakMap;let p;const g=new WeakMap;let _=!1;try{_=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function v(N,k){return _?new OffscreenCanvas(N,k):Z_("canvas")}function b(N,k,_e,Se){let Ue=1;if((N.width>Se||N.height>Se)&&(Ue=Se/Math.max(N.width,N.height)),Ue<1||!0===k){if(typeof HTMLImageElement<"u"&&N instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&N instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&N instanceof ImageBitmap){const Ze=k?AA:Math.floor,bt=Ze(Ue*N.width),H=Ze(Ue*N.height);void 0===p&&(p=v(bt,H));const te=_e?v(bt,H):p;return te.width=bt,te.height=H,te.getContext("2d").drawImage(N,0,0,bt,H),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+N.width+"x"+N.height+") to ("+bt+"x"+H+")."),te}return"data"in N&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+N.width+"x"+N.height+")."),N}return N}function y(N){return dT(N.width)&&dT(N.height)}function C(N,k){return N.generateMipmaps&&k&&N.minFilter!==$t&&N.minFilter!==Li}function M(N){i.generateMipmap(N)}function w(N,k,_e,Se,Ue=!1){if(!1===a)return k;if(null!==N){if(void 0!==i[N])return i[N];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+N+"'")}let Ze=k;return 6403===k&&(5126===_e&&(Ze=33326),5131===_e&&(Ze=33325),5121===_e&&(Ze=33321)),33319===k&&(5126===_e&&(Ze=33328),5131===_e&&(Ze=33327),5121===_e&&(Ze=33323)),6408===k&&(5126===_e&&(Ze=34836),5131===_e&&(Ze=34842),5121===_e&&(Ze=Se===hi&&!1===Ue?35907:32856),32819===_e&&(Ze=32854),32820===_e&&(Ze=32855)),(33325===Ze||33326===Ze||33327===Ze||33328===Ze||34842===Ze||34836===Ze)&&e.get("EXT_color_buffer_float"),Ze}function E(N,k,_e){return!0===C(N,_e)||N.isFramebufferTexture&&N.minFilter!==$t&&N.minFilter!==Li?Math.log2(Math.max(k.width,k.height))+1:void 0!==N.mipmaps&&N.mipmaps.length>0?N.mipmaps.length:N.isCompressedTexture&&Array.isArray(N.image)?k.mipmaps.length:1}function I(N){return N===$t||N===U_||N===mf?9728:9729}function F(N){const k=N.target;k.removeEventListener("dispose",F),function B(N){const k=n.get(N);if(void 0===k.__webglInit)return;const _e=N.source,Se=g.get(_e);if(Se){const Ue=Se[k.__cacheKey];Ue.usedTimes--,0===Ue.usedTimes&&L(N),0===Object.keys(Se).length&&g.delete(_e)}n.remove(N)}(k),k.isVideoTexture&&m.delete(k)}function Q(N){const k=N.target;k.removeEventListener("dispose",Q),function X(N){const k=N.texture,_e=n.get(N),Se=n.get(k);if(void 0!==Se.__webglTexture&&(i.deleteTexture(Se.__webglTexture),o.memory.textures--),N.depthTexture&&N.depthTexture.dispose(),N.isWebGLCubeRenderTarget)for(let Ue=0;Ue<6;Ue++)i.deleteFramebuffer(_e.__webglFramebuffer[Ue]),_e.__webglDepthbuffer&&i.deleteRenderbuffer(_e.__webglDepthbuffer[Ue]);else{if(i.deleteFramebuffer(_e.__webglFramebuffer),_e.__webglDepthbuffer&&i.deleteRenderbuffer(_e.__webglDepthbuffer),_e.__webglMultisampledFramebuffer&&i.deleteFramebuffer(_e.__webglMultisampledFramebuffer),_e.__webglColorRenderbuffer)for(let Ue=0;Ue<_e.__webglColorRenderbuffer.length;Ue++)_e.__webglColorRenderbuffer[Ue]&&i.deleteRenderbuffer(_e.__webglColorRenderbuffer[Ue]);_e.__webglDepthRenderbuffer&&i.deleteRenderbuffer(_e.__webglDepthRenderbuffer)}if(N.isWebGLMultipleRenderTargets)for(let Ue=0,Ze=k.length;Ue<Ze;Ue++){const bt=n.get(k[Ue]);bt.__webglTexture&&(i.deleteTexture(bt.__webglTexture),o.memory.textures--),n.remove(k[Ue])}n.remove(k),n.remove(N)}(k)}function L(N){const k=n.get(N);i.deleteTexture(k.__webglTexture),delete g.get(N.source)[k.__cacheKey],o.memory.textures--}let P=0;function ee(N,k){const _e=n.get(N);if(N.isVideoTexture&&function St(N){const k=o.render.frame;m.get(N)!==k&&(m.set(N,k),N.update())}(N),!1===N.isRenderTargetTexture&&N.version>0&&_e.__version!==N.version){const Se=N.image;if(null===Se)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Se.complete)return void de(_e,N,k);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(3553,_e.__webglTexture,33984+k)}const J={[Ao]:10497,[gr]:33071,[pf]:33648},ae={[$t]:9728,[U_]:9984,[mf]:9986,[Li]:9729,[lA]:9985,[Xs]:9987};function G(N,k,_e){if(_e?(i.texParameteri(N,10242,J[k.wrapS]),i.texParameteri(N,10243,J[k.wrapT]),(32879===N||35866===N)&&i.texParameteri(N,32882,J[k.wrapR]),i.texParameteri(N,10240,ae[k.magFilter]),i.texParameteri(N,10241,ae[k.minFilter])):(i.texParameteri(N,10242,33071),i.texParameteri(N,10243,33071),(32879===N||35866===N)&&i.texParameteri(N,32882,33071),(k.wrapS!==gr||k.wrapT!==gr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(N,10240,I(k.magFilter)),i.texParameteri(N,10241,I(k.minFilter)),k.minFilter!==$t&&k.minFilter!==Li&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const Se=e.get("EXT_texture_filter_anisotropic");if(k.magFilter===$t||k.minFilter!==mf&&k.minFilter!==Xs||k.type===Ln&&!1===e.has("OES_texture_float_linear")||!1===a&&k.type===fn&&!1===e.has("OES_texture_half_float_linear"))return;(k.anisotropy>1||n.get(k).__currentAnisotropy)&&(i.texParameterf(N,Se.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(k.anisotropy,r.getMaxAnisotropy())),n.get(k).__currentAnisotropy=k.anisotropy)}}function U(N,k){let _e=!1;void 0===N.__webglInit&&(N.__webglInit=!0,k.addEventListener("dispose",F));const Se=k.source;let Ue=g.get(Se);void 0===Ue&&(Ue={},g.set(Se,Ue));const Ze=function q(N){const k=[];return k.push(N.wrapS),k.push(N.wrapT),k.push(N.wrapR||0),k.push(N.magFilter),k.push(N.minFilter),k.push(N.anisotropy),k.push(N.internalFormat),k.push(N.format),k.push(N.type),k.push(N.generateMipmaps),k.push(N.premultiplyAlpha),k.push(N.flipY),k.push(N.unpackAlignment),k.push(N.encoding),k.join()}(k);if(Ze!==N.__cacheKey){void 0===Ue[Ze]&&(Ue[Ze]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,_e=!0),Ue[Ze].usedTimes++;const bt=Ue[N.__cacheKey];void 0!==bt&&(Ue[N.__cacheKey].usedTimes--,0===bt.usedTimes&&L(k)),N.__cacheKey=Ze,N.__webglTexture=Ue[Ze].texture}return _e}function de(N,k,_e){let Se=3553;(k.isDataArrayTexture||k.isCompressedArrayTexture)&&(Se=35866),k.isData3DTexture&&(Se=32879);const Ue=U(N,k),Ze=k.source;t.bindTexture(Se,N.__webglTexture,33984+_e);const bt=n.get(Ze);if(Ze.version!==bt.__version||!0===Ue){t.activeTexture(33984+_e),i.pixelStorei(37440,k.flipY),i.pixelStorei(37441,k.premultiplyAlpha),i.pixelStorei(3317,k.unpackAlignment),i.pixelStorei(37443,0);const H=function x(N){return!a&&(N.wrapS!==gr||N.wrapT!==gr||N.minFilter!==$t&&N.minFilter!==Li)}(k)&&!1===y(k.image);let te=b(k.image,H,!1,d);te=ft(k,te);const tt=y(te)||a,lt=s.convert(k.format,k.encoding);let At,nt=s.convert(k.type),rt=w(k.internalFormat,lt,nt,k.encoding,k.isVideoTexture);G(Se,k,tt);const Jt=k.mipmaps,Ft=a&&!0!==k.isVideoTexture,Ot=void 0===bt.__version||!0===Ue,re=E(k,te,tt);if(k.isDepthTexture)rt=6402,a?rt=k.type===Ln?36012:k.type===ac?33190:k.type===lc?35056:33189:k.type===Ln&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),k.format===cc&&6402===rt&&k.type!==V_&&k.type!==ac&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),k.type=ac,nt=s.convert(k.type)),k.format===dc&&6402===rt&&(rt=34041,k.type!==lc&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),k.type=lc,nt=s.convert(k.type))),Ot&&(Ft?t.texStorage2D(3553,1,rt,te.width,te.height):t.texImage2D(3553,0,rt,te.width,te.height,0,lt,nt,null));else if(k.isDataTexture)if(Jt.length>0&&tt){Ft&&Ot&&t.texStorage2D(3553,re,rt,Jt[0].width,Jt[0].height);for(let ie=0,je=Jt.length;ie<je;ie++)At=Jt[ie],Ft?t.texSubImage2D(3553,ie,0,0,At.width,At.height,lt,nt,At.data):t.texImage2D(3553,ie,rt,At.width,At.height,0,lt,nt,At.data);k.generateMipmaps=!1}else Ft?(Ot&&t.texStorage2D(3553,re,rt,te.width,te.height),t.texSubImage2D(3553,0,0,0,te.width,te.height,lt,nt,te.data)):t.texImage2D(3553,0,rt,te.width,te.height,0,lt,nt,te.data);else if(k.isCompressedTexture)if(k.isCompressedArrayTexture){Ft&&Ot&&t.texStorage3D(35866,re,rt,Jt[0].width,Jt[0].height,te.depth);for(let ie=0,je=Jt.length;ie<je;ie++)At=Jt[ie],k.format!==En?null!==lt?Ft?t.compressedTexSubImage3D(35866,ie,0,0,0,At.width,At.height,te.depth,lt,At.data,0,0):t.compressedTexImage3D(35866,ie,rt,At.width,At.height,te.depth,0,At.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ft?t.texSubImage3D(35866,ie,0,0,0,At.width,At.height,te.depth,lt,nt,At.data):t.texImage3D(35866,ie,rt,At.width,At.height,te.depth,0,lt,nt,At.data)}else{Ft&&Ot&&t.texStorage2D(3553,re,rt,Jt[0].width,Jt[0].height);for(let ie=0,je=Jt.length;ie<je;ie++)At=Jt[ie],k.format!==En?null!==lt?Ft?t.compressedTexSubImage2D(3553,ie,0,0,At.width,At.height,lt,At.data):t.compressedTexImage2D(3553,ie,rt,At.width,At.height,0,At.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ft?t.texSubImage2D(3553,ie,0,0,At.width,At.height,lt,nt,At.data):t.texImage2D(3553,ie,rt,At.width,At.height,0,lt,nt,At.data)}else if(k.isDataArrayTexture)Ft?(Ot&&t.texStorage3D(35866,re,rt,te.width,te.height,te.depth),t.texSubImage3D(35866,0,0,0,0,te.width,te.height,te.depth,lt,nt,te.data)):t.texImage3D(35866,0,rt,te.width,te.height,te.depth,0,lt,nt,te.data);else if(k.isData3DTexture)Ft?(Ot&&t.texStorage3D(32879,re,rt,te.width,te.height,te.depth),t.texSubImage3D(32879,0,0,0,0,te.width,te.height,te.depth,lt,nt,te.data)):t.texImage3D(32879,0,rt,te.width,te.height,te.depth,0,lt,nt,te.data);else if(k.isFramebufferTexture){if(Ot)if(Ft)t.texStorage2D(3553,re,rt,te.width,te.height);else{let ie=te.width,je=te.height;for(let dt=0;dt<re;dt++)t.texImage2D(3553,dt,rt,ie,je,0,lt,nt,null),ie>>=1,je>>=1}}else if(Jt.length>0&&tt){Ft&&Ot&&t.texStorage2D(3553,re,rt,Jt[0].width,Jt[0].height);for(let ie=0,je=Jt.length;ie<je;ie++)At=Jt[ie],Ft?t.texSubImage2D(3553,ie,0,0,lt,nt,At):t.texImage2D(3553,ie,rt,lt,nt,At);k.generateMipmaps=!1}else Ft?(Ot&&t.texStorage2D(3553,re,rt,te.width,te.height),t.texSubImage2D(3553,0,0,0,lt,nt,te)):t.texImage2D(3553,0,rt,lt,nt,te);C(k,tt)&&M(Se),bt.__version=Ze.version,k.onUpdate&&k.onUpdate(k)}N.__version=k.version}function we(N,k,_e,Se,Ue){const Ze=s.convert(_e.format,_e.encoding),bt=s.convert(_e.type),H=w(_e.internalFormat,Ze,bt,_e.encoding);n.get(k).__hasExternalTextures||(32879===Ue||35866===Ue?t.texImage3D(Ue,0,H,k.width,k.height,k.depth,0,Ze,bt,null):t.texImage2D(Ue,0,H,k.width,k.height,0,Ze,bt,null)),t.bindFramebuffer(36160,N),ot(k)?h.framebufferTexture2DMultisampleEXT(36160,Se,Ue,n.get(_e).__webglTexture,0,ht(k)):(3553===Ue||Ue>=34069&&Ue<=34074)&&i.framebufferTexture2D(36160,Se,Ue,n.get(_e).__webglTexture,0),t.bindFramebuffer(36160,null)}function et(N,k,_e){if(i.bindRenderbuffer(36161,N),k.depthBuffer&&!k.stencilBuffer){let Se=33189;if(_e||ot(k)){const Ue=k.depthTexture;Ue&&Ue.isDepthTexture&&(Ue.type===Ln?Se=36012:Ue.type===ac&&(Se=33190));const Ze=ht(k);ot(k)?h.renderbufferStorageMultisampleEXT(36161,Ze,Se,k.width,k.height):i.renderbufferStorageMultisample(36161,Ze,Se,k.width,k.height)}else i.renderbufferStorage(36161,Se,k.width,k.height);i.framebufferRenderbuffer(36160,36096,36161,N)}else if(k.depthBuffer&&k.stencilBuffer){const Se=ht(k);_e&&!1===ot(k)?i.renderbufferStorageMultisample(36161,Se,35056,k.width,k.height):ot(k)?h.renderbufferStorageMultisampleEXT(36161,Se,35056,k.width,k.height):i.renderbufferStorage(36161,34041,k.width,k.height),i.framebufferRenderbuffer(36160,33306,36161,N)}else{const Se=!0===k.isWebGLMultipleRenderTargets?k.texture:[k.texture];for(let Ue=0;Ue<Se.length;Ue++){const Ze=Se[Ue],bt=s.convert(Ze.format,Ze.encoding),H=s.convert(Ze.type),te=w(Ze.internalFormat,bt,H,Ze.encoding),tt=ht(k);_e&&!1===ot(k)?i.renderbufferStorageMultisample(36161,tt,te,k.width,k.height):ot(k)?h.renderbufferStorageMultisampleEXT(36161,tt,te,k.width,k.height):i.renderbufferStorage(36161,te,k.width,k.height)}}i.bindRenderbuffer(36161,null)}function xe(N){const k=n.get(N),_e=!0===N.isWebGLCubeRenderTarget;if(N.depthTexture&&!k.__autoAllocateDepthBuffer){if(_e)throw new Error("target.depthTexture not supported in Cube render targets");!function Ae(N,k){if(k&&k.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,N),!k.depthTexture||!k.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(k.depthTexture).__webglTexture||k.depthTexture.image.width!==k.width||k.depthTexture.image.height!==k.height)&&(k.depthTexture.image.width=k.width,k.depthTexture.image.height=k.height,k.depthTexture.needsUpdate=!0),ee(k.depthTexture,0);const Se=n.get(k.depthTexture).__webglTexture,Ue=ht(k);if(k.depthTexture.format===cc)ot(k)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,Se,0,Ue):i.framebufferTexture2D(36160,36096,3553,Se,0);else{if(k.depthTexture.format!==dc)throw new Error("Unknown depthTexture format");ot(k)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,Se,0,Ue):i.framebufferTexture2D(36160,33306,3553,Se,0)}}(k.__webglFramebuffer,N)}else if(_e){k.__webglDepthbuffer=[];for(let Se=0;Se<6;Se++)t.bindFramebuffer(36160,k.__webglFramebuffer[Se]),k.__webglDepthbuffer[Se]=i.createRenderbuffer(),et(k.__webglDepthbuffer[Se],N,!1)}else t.bindFramebuffer(36160,k.__webglFramebuffer),k.__webglDepthbuffer=i.createRenderbuffer(),et(k.__webglDepthbuffer,N,!1);t.bindFramebuffer(36160,null)}function ht(N){return Math.min(u,N.samples)}function ot(N){const k=n.get(N);return a&&N.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==k.__useRenderToTexture}function ft(N,k){const _e=N.encoding,Se=N.format,Ue=N.type;return!0===N.isCompressedTexture||!0===N.isVideoTexture||N.format===yA||_e!==Ys&&(_e===hi?!1===a?!0===e.has("EXT_sRGB")&&Se===En?(N.format=yA,N.minFilter=Li,N.generateMipmaps=!1):k=pT.sRGBToLinear(k):(Se!==En||Ue!==Wr)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",_e)),k}this.allocateTextureUnit=function O(){const N=P;return N>=l&&console.warn("THREE.WebGLTextures: Trying to use "+N+" texture units while this GPU supports only "+l),P+=1,N},this.resetTextureUnits=function V(){P=0},this.setTexture2D=ee,this.setTexture2DArray=function Z(N,k){const _e=n.get(N);N.version>0&&_e.__version!==N.version?de(_e,N,k):t.bindTexture(35866,_e.__webglTexture,33984+k)},this.setTexture3D=function Y(N,k){const _e=n.get(N);N.version>0&&_e.__version!==N.version?de(_e,N,k):t.bindTexture(32879,_e.__webglTexture,33984+k)},this.setTextureCube=function he(N,k){const _e=n.get(N);N.version>0&&_e.__version!==N.version?function Ee(N,k,_e){if(6!==k.image.length)return;const Se=U(N,k),Ue=k.source;t.bindTexture(34067,N.__webglTexture,33984+_e);const Ze=n.get(Ue);if(Ue.version!==Ze.__version||!0===Se){t.activeTexture(33984+_e),i.pixelStorei(37440,k.flipY),i.pixelStorei(37441,k.premultiplyAlpha),i.pixelStorei(3317,k.unpackAlignment),i.pixelStorei(37443,0);const bt=k.isCompressedTexture||k.image[0].isCompressedTexture,H=k.image[0]&&k.image[0].isDataTexture,te=[];for(let ie=0;ie<6;ie++)te[ie]=bt||H?H?k.image[ie].image:k.image[ie]:b(k.image[ie],!1,!0,c),te[ie]=ft(k,te[ie]);const tt=te[0],lt=y(tt)||a,nt=s.convert(k.format,k.encoding),rt=s.convert(k.type),At=w(k.internalFormat,nt,rt,k.encoding),Jt=a&&!0!==k.isVideoTexture,Ft=void 0===Ze.__version||!0===Se;let re,Ot=E(k,tt,lt);if(G(34067,k,lt),bt){Jt&&Ft&&t.texStorage2D(34067,Ot,At,tt.width,tt.height);for(let ie=0;ie<6;ie++){re=te[ie].mipmaps;for(let je=0;je<re.length;je++){const dt=re[je];k.format!==En?null!==nt?Jt?t.compressedTexSubImage2D(34069+ie,je,0,0,dt.width,dt.height,nt,dt.data):t.compressedTexImage2D(34069+ie,je,At,dt.width,dt.height,0,dt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Jt?t.texSubImage2D(34069+ie,je,0,0,dt.width,dt.height,nt,rt,dt.data):t.texImage2D(34069+ie,je,At,dt.width,dt.height,0,nt,rt,dt.data)}}}else{re=k.mipmaps,Jt&&Ft&&(re.length>0&&Ot++,t.texStorage2D(34067,Ot,At,te[0].width,te[0].height));for(let ie=0;ie<6;ie++)if(H){Jt?t.texSubImage2D(34069+ie,0,0,0,te[ie].width,te[ie].height,nt,rt,te[ie].data):t.texImage2D(34069+ie,0,At,te[ie].width,te[ie].height,0,nt,rt,te[ie].data);for(let je=0;je<re.length;je++){const Tt=re[je].image[ie].image;Jt?t.texSubImage2D(34069+ie,je+1,0,0,Tt.width,Tt.height,nt,rt,Tt.data):t.texImage2D(34069+ie,je+1,At,Tt.width,Tt.height,0,nt,rt,Tt.data)}}else{Jt?t.texSubImage2D(34069+ie,0,0,0,nt,rt,te[ie]):t.texImage2D(34069+ie,0,At,nt,rt,te[ie]);for(let je=0;je<re.length;je++){const dt=re[je];Jt?t.texSubImage2D(34069+ie,je+1,0,0,nt,rt,dt.image[ie]):t.texImage2D(34069+ie,je+1,At,nt,rt,dt.image[ie])}}}C(k,lt)&&M(34067),Ze.__version=Ue.version,k.onUpdate&&k.onUpdate(k)}N.__version=k.version}(_e,N,k):t.bindTexture(34067,_e.__webglTexture,33984+k)},this.rebindTextures=function Pe(N,k,_e){const Se=n.get(N);void 0!==k&&we(Se.__webglFramebuffer,N,N.texture,36064,3553),void 0!==_e&&xe(N)},this.setupRenderTarget=function $e(N){const k=N.texture,_e=n.get(N),Se=n.get(k);N.addEventListener("dispose",Q),!0!==N.isWebGLMultipleRenderTargets&&(void 0===Se.__webglTexture&&(Se.__webglTexture=i.createTexture()),Se.__version=k.version,o.memory.textures++);const Ue=!0===N.isWebGLCubeRenderTarget,Ze=!0===N.isWebGLMultipleRenderTargets,bt=y(N)||a;if(Ue){_e.__webglFramebuffer=[];for(let H=0;H<6;H++)_e.__webglFramebuffer[H]=i.createFramebuffer()}else{if(_e.__webglFramebuffer=i.createFramebuffer(),Ze)if(r.drawBuffers){const H=N.texture;for(let te=0,tt=H.length;te<tt;te++){const lt=n.get(H[te]);void 0===lt.__webglTexture&&(lt.__webglTexture=i.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&N.samples>0&&!1===ot(N)){const H=Ze?k:[k];_e.__webglMultisampledFramebuffer=i.createFramebuffer(),_e.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,_e.__webglMultisampledFramebuffer);for(let te=0;te<H.length;te++){const tt=H[te];_e.__webglColorRenderbuffer[te]=i.createRenderbuffer(),i.bindRenderbuffer(36161,_e.__webglColorRenderbuffer[te]);const lt=s.convert(tt.format,tt.encoding),nt=s.convert(tt.type),rt=w(tt.internalFormat,lt,nt,tt.encoding,!0===N.isXRRenderTarget),At=ht(N);i.renderbufferStorageMultisample(36161,At,rt,N.width,N.height),i.framebufferRenderbuffer(36160,36064+te,36161,_e.__webglColorRenderbuffer[te])}i.bindRenderbuffer(36161,null),N.depthBuffer&&(_e.__webglDepthRenderbuffer=i.createRenderbuffer(),et(_e.__webglDepthRenderbuffer,N,!0)),t.bindFramebuffer(36160,null)}}if(Ue){t.bindTexture(34067,Se.__webglTexture),G(34067,k,bt);for(let H=0;H<6;H++)we(_e.__webglFramebuffer[H],N,k,36064,34069+H);C(k,bt)&&M(34067),t.unbindTexture()}else if(Ze){const H=N.texture;for(let te=0,tt=H.length;te<tt;te++){const lt=H[te],nt=n.get(lt);t.bindTexture(3553,nt.__webglTexture),G(3553,lt,bt),we(_e.__webglFramebuffer,N,lt,36064+te,3553),C(lt,bt)&&M(3553)}t.unbindTexture()}else{let H=3553;(N.isWebGL3DRenderTarget||N.isWebGLArrayRenderTarget)&&(a?H=N.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(H,Se.__webglTexture),G(H,k,bt),we(_e.__webglFramebuffer,N,k,36064,H),C(k,bt)&&M(H),t.unbindTexture()}N.depthBuffer&&xe(N)},this.updateRenderTargetMipmap=function We(N){const k=y(N)||a,_e=!0===N.isWebGLMultipleRenderTargets?N.texture:[N.texture];for(let Se=0,Ue=_e.length;Se<Ue;Se++){const Ze=_e[Se];if(C(Ze,k)){const bt=N.isWebGLCubeRenderTarget?34067:3553,H=n.get(Ze).__webglTexture;t.bindTexture(bt,H),M(bt),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function yt(N){if(a&&N.samples>0&&!1===ot(N)){const k=N.isWebGLMultipleRenderTargets?N.texture:[N.texture],_e=N.width,Se=N.height;let Ue=16384;const Ze=[],bt=N.stencilBuffer?33306:36096,H=n.get(N),te=!0===N.isWebGLMultipleRenderTargets;if(te)for(let tt=0;tt<k.length;tt++)t.bindFramebuffer(36160,H.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+tt,36161,null),t.bindFramebuffer(36160,H.__webglFramebuffer),i.framebufferTexture2D(36009,36064+tt,3553,null,0);t.bindFramebuffer(36008,H.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,H.__webglFramebuffer);for(let tt=0;tt<k.length;tt++){Ze.push(36064+tt),N.depthBuffer&&Ze.push(bt);const lt=void 0!==H.__ignoreDepthValues&&H.__ignoreDepthValues;if(!1===lt&&(N.depthBuffer&&(Ue|=256),N.stencilBuffer&&(Ue|=1024)),te&&i.framebufferRenderbuffer(36008,36064,36161,H.__webglColorRenderbuffer[tt]),!0===lt&&(i.invalidateFramebuffer(36008,[bt]),i.invalidateFramebuffer(36009,[bt])),te){const nt=n.get(k[tt]).__webglTexture;i.framebufferTexture2D(36009,36064,3553,nt,0)}i.blitFramebuffer(0,0,_e,Se,0,0,_e,Se,Ue,9728),f&&i.invalidateFramebuffer(36008,Ze)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),te)for(let tt=0;tt<k.length;tt++){t.bindFramebuffer(36160,H.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+tt,36161,H.__webglColorRenderbuffer[tt]);const lt=n.get(k[tt]).__webglTexture;t.bindFramebuffer(36160,H.__webglFramebuffer),i.framebufferTexture2D(36009,36064+tt,3553,lt,0)}t.bindFramebuffer(36009,H.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=xe,this.setupFrameBufferTexture=we,this.useMultisampledRTT=ot}function xU(i,e,t){const n=t.isWebGL2;return{convert:function r(s,o=null){let a;if(s===Wr)return 5121;if(s===yj)return 32819;if(s===Aj)return 32820;if(s===_j)return 5120;if(s===bj)return 5122;if(s===V_)return 5123;if(s===vj)return 5124;if(s===ac)return 5125;if(s===Ln)return 5126;if(s===fn)return n?5131:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(s===xj)return 6406;if(s===En)return 6408;if(s===cA)return 6409;if(s===Cj)return 6410;if(s===cc)return 6402;if(s===dc)return 34041;if(s===wj)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(s===yA)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(s===bl)return 6403;if(s===Mj)return 36244;if(s===gf)return 33319;if(s===Ej)return 33320;if(s===Sj)return 36249;if(s===_f||s===dA||s===z_||s===bf)if(o===hi){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(s===_f)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===dA)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===z_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===bf)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(s===_f)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===dA)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===z_)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===bf)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(s===vf||s===H_||s===yf||s===G_){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(s===vf)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===H_)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===yf)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===G_)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(s===uA)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===hA||s===fA){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(s===hA)return o===hi?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===fA)return o===hi?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(s===pA||s===WS||s===qS||s===XS||s===YS||s===ZS||s===KS||s===$S||s===JS||s===eT||s===tT||s===iT||s===nT||s===rT){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(s===pA)return o===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===WS)return o===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===qS)return o===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===XS)return o===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===YS)return o===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===ZS)return o===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===KS)return o===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===$S)return o===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===JS)return o===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===eT)return o===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===tT)return o===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===iT)return o===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===nT)return o===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===rT)return o===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(s===mA){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(s===mA)return o===hi?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}return s===lc?n?34042:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==i[s]?i[s]:null}}}class jT extends Sn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class xs extends wi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Qoe={type:"move"};class UT{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new xs,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new xs,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new T,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new T),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new xs,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new T,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new T),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(c&&e.hand){o=!0;for(const p of e.hand.values()){const g=t.getJointPose(p,n),_=this._getHandJoint(c,p);null!==g&&(_.matrix.fromArray(g.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale),_.jointRadius=g.radius),_.visible=null!==g}const h=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),f=.02,m=.005;c.inputState.pinching&&h>f+m?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=f-m&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Qoe)))}return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new xs;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class Hf extends qn{constructor(e,t,n,r,s,o,a,l,c,d){if((d=void 0!==d?d:cc)!==cc&&d!==dc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&d===cc&&(n=ac),void 0===n&&d===dc&&(n=lc),super(null,r,s,o,a,l,d,n,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:$t,this.minFilter=void 0!==l?l:$t,this.flipY=!1,this.generateMipmaps=!1}}class Woe extends os{constructor(e,t){super();const n=this;let r=null,s=1,o=null,a="local-floor",l=null,c=null,d=null,u=null,h=null,f=null;const m=t.getContextAttributes();let p=null,g=null;const _=[],v=[],b=new Set,y=new Map,x=new Sn;x.layers.enable(1),x.viewport=new ni;const C=new Sn;C.layers.enable(2),C.viewport=new ni;const M=[x,C],w=new jT;w.layers.enable(1),w.layers.enable(2);let E=null,I=null;function F(Z){const Y=v.indexOf(Z.inputSource);if(-1===Y)return;const he=_[Y];void 0!==he&&he.dispatchEvent({type:Z.type,data:Z.inputSource})}function Q(){r.removeEventListener("select",F),r.removeEventListener("selectstart",F),r.removeEventListener("selectend",F),r.removeEventListener("squeeze",F),r.removeEventListener("squeezestart",F),r.removeEventListener("squeezeend",F),r.removeEventListener("end",Q),r.removeEventListener("inputsourceschange",B);for(let Z=0;Z<_.length;Z++){const Y=v[Z];null!==Y&&(v[Z]=null,_[Z].disconnect(Y))}E=null,I=null,e.setRenderTarget(p),h=null,u=null,d=null,r=null,g=null,ee.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function B(Z){for(let Y=0;Y<Z.removed.length;Y++){const he=Z.removed[Y],J=v.indexOf(he);J>=0&&(v[J]=null,_[J].disconnect(he))}for(let Y=0;Y<Z.added.length;Y++){const he=Z.added[Y];let J=v.indexOf(he);if(-1===J){for(let G=0;G<_.length;G++){if(G>=v.length){v.push(he),J=G;break}if(null===v[G]){v[G]=he,J=G;break}}if(-1===J)break}const ae=_[J];ae&&ae.connect(he)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Z){let Y=_[Z];return void 0===Y&&(Y=new UT,_[Z]=Y),Y.getTargetRaySpace()},this.getControllerGrip=function(Z){let Y=_[Z];return void 0===Y&&(Y=new UT,_[Z]=Y),Y.getGripSpace()},this.getHand=function(Z){let Y=_[Z];return void 0===Y&&(Y=new UT,_[Z]=Y),Y.getHandSpace()},this.setFramebufferScaleFactor=function(Z){s=Z,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Z){a=Z,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||o},this.setReferenceSpace=function(Z){l=Z},this.getBaseLayer=function(){return null!==u?u:h},this.getBinding=function(){return d},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=function(){var Z=ss(function*(Y){if(r=Y,null!==r){if(p=e.getRenderTarget(),r.addEventListener("select",F),r.addEventListener("selectstart",F),r.addEventListener("selectend",F),r.addEventListener("squeeze",F),r.addEventListener("squeezestart",F),r.addEventListener("squeezeend",F),r.addEventListener("end",Q),r.addEventListener("inputsourceschange",B),!0!==m.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)h=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||m.antialias,alpha:m.alpha,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:h}),g=new Gt(h.framebufferWidth,h.framebufferHeight,{format:En,type:Wr,encoding:e.outputEncoding,stencilBuffer:m.stencil});else{let he=null,J=null,ae=null;m.depth&&(ae=m.stencil?35056:33190,he=m.stencil?dc:cc,J=m.stencil?lc:ac);const G={colorFormat:32856,depthFormat:ae,scaleFactor:s};d=new XRWebGLBinding(r,t),u=d.createProjectionLayer(G),r.updateRenderState({layers:[u]}),g=new Gt(u.textureWidth,u.textureHeight,{format:En,type:Wr,depthTexture:new Hf(u.textureWidth,u.textureHeight,J,void 0,void 0,void 0,void 0,void 0,void 0,he),stencilBuffer:m.stencil,encoding:e.outputEncoding,samples:m.antialias?4:0}),e.properties.get(g).__ignoreDepthValues=u.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(1),l=null,o=yield r.requestReferenceSpace(a),ee.setContext(r),ee.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(Y){return Z.apply(this,arguments)}}();const L=new T,X=new T;function V(Z,Y){null===Y?Z.matrixWorld.copy(Z.matrix):Z.matrixWorld.multiplyMatrices(Y.matrixWorld,Z.matrix),Z.matrixWorldInverse.copy(Z.matrixWorld).invert()}this.updateCamera=function(Z){if(null===r)return;w.near=C.near=x.near=Z.near,w.far=C.far=x.far=Z.far,(E!==w.near||I!==w.far)&&(r.updateRenderState({depthNear:w.near,depthFar:w.far}),E=w.near,I=w.far);const Y=Z.parent,he=w.cameras;V(w,Y);for(let ae=0;ae<he.length;ae++)V(he[ae],Y);w.matrixWorld.decompose(w.position,w.quaternion,w.scale),Z.matrix.copy(w.matrix),Z.matrix.decompose(Z.position,Z.quaternion,Z.scale);const J=Z.children;for(let ae=0,G=J.length;ae<G;ae++)J[ae].updateMatrixWorld(!0);2===he.length?function P(Z,Y,he){L.setFromMatrixPosition(Y.matrixWorld),X.setFromMatrixPosition(he.matrixWorld);const J=L.distanceTo(X),ae=Y.projectionMatrix.elements,G=he.projectionMatrix.elements,U=ae[14]/(ae[10]-1),de=ae[14]/(ae[10]+1),Ee=(ae[9]+1)/ae[5],we=(ae[9]-1)/ae[5],et=(ae[8]-1)/ae[0],Ae=(G[8]+1)/G[0],xe=U*et,Pe=U*Ae,$e=J/(-et+Ae),We=$e*-et;Y.matrixWorld.decompose(Z.position,Z.quaternion,Z.scale),Z.translateX(We),Z.translateZ($e),Z.matrixWorld.compose(Z.position,Z.quaternion,Z.scale),Z.matrixWorldInverse.copy(Z.matrixWorld).invert();const yt=U+$e,ht=de+$e;Z.projectionMatrix.makePerspective(xe-We,Pe+(J-We),Ee*de/ht*yt,we*de/ht*yt,yt,ht)}(w,x,C):w.projectionMatrix.copy(x.projectionMatrix)},this.getCamera=function(){return w},this.getFoveation=function(){return null!==u?u.fixedFoveation:null!==h?h.fixedFoveation:void 0},this.setFoveation=function(Z){null!==u&&(u.fixedFoveation=Z),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=Z)},this.getPlanes=function(){return b};let O=null;const ee=new Zj;ee.setAnimationLoop(function q(Z,Y){if(c=Y.getViewerPose(l||o),f=Y,null!==c){const he=c.views;null!==h&&(e.setRenderTargetFramebuffer(g,h.framebuffer),e.setRenderTarget(g));let J=!1;he.length!==w.cameras.length&&(w.cameras.length=0,J=!0);for(let ae=0;ae<he.length;ae++){const G=he[ae];let U=null;if(null!==h)U=h.getViewport(G);else{const Ee=d.getViewSubImage(u,G);U=Ee.viewport,0===ae&&(e.setRenderTargetTextures(g,Ee.colorTexture,u.ignoreDepthValues?void 0:Ee.depthStencilTexture),e.setRenderTarget(g))}let de=M[ae];void 0===de&&(de=new Sn,de.layers.enable(ae),de.viewport=new ni,M[ae]=de),de.matrix.fromArray(G.transform.matrix),de.projectionMatrix.fromArray(G.projectionMatrix),de.viewport.set(U.x,U.y,U.width,U.height),0===ae&&w.matrix.copy(de.matrix),!0===J&&w.cameras.push(de)}}for(let he=0;he<_.length;he++){const J=v[he],ae=_[he];null!==J&&void 0!==ae&&ae.update(J,Y,l||o)}if(O&&O(Z,Y),Y.detectedPlanes){n.dispatchEvent({type:"planesdetected",data:Y.detectedPlanes});let he=null;for(const J of b)Y.detectedPlanes.has(J)||(null===he&&(he=[]),he.push(J));if(null!==he)for(const J of he)b.delete(J),y.delete(J),n.dispatchEvent({type:"planeremoved",data:J});for(const J of Y.detectedPlanes)if(b.has(J)){const ae=y.get(J);J.lastChangedTime>ae&&(y.set(J,J.lastChangedTime),n.dispatchEvent({type:"planechanged",data:J}))}else b.add(J),y.set(J,Y.lastChangedTime),n.dispatchEvent({type:"planeadded",data:J})}f=null}),this.setAnimationLoop=function(Z){O=Z},this.dispose=function(){}}}function qoe(i,e){function r(p,g){p.opacity.value=g.opacity,g.color&&p.diffuse.value.copy(g.color),g.emissive&&p.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(p.map.value=g.map),g.alphaMap&&(p.alphaMap.value=g.alphaMap),g.bumpMap&&(p.bumpMap.value=g.bumpMap,p.bumpScale.value=g.bumpScale,g.side===ys&&(p.bumpScale.value*=-1)),g.displacementMap&&(p.displacementMap.value=g.displacementMap,p.displacementScale.value=g.displacementScale,p.displacementBias.value=g.displacementBias),g.emissiveMap&&(p.emissiveMap.value=g.emissiveMap),g.normalMap&&(p.normalMap.value=g.normalMap,p.normalScale.value.copy(g.normalScale),g.side===ys&&p.normalScale.value.negate()),g.specularMap&&(p.specularMap.value=g.specularMap),g.alphaTest>0&&(p.alphaTest.value=g.alphaTest);const _=e.get(g).envMap;if(_&&(p.envMap.value=_,p.flipEnvMap.value=_.isCubeTexture&&!1===_.isRenderTargetTexture?-1:1,p.reflectivity.value=g.reflectivity,p.ior.value=g.ior,p.refractionRatio.value=g.refractionRatio),g.lightMap){p.lightMap.value=g.lightMap;const y=!0!==i.physicallyCorrectLights?Math.PI:1;p.lightMapIntensity.value=g.lightMapIntensity*y}let v,b;g.aoMap&&(p.aoMap.value=g.aoMap,p.aoMapIntensity.value=g.aoMapIntensity),g.map?v=g.map:g.specularMap?v=g.specularMap:g.displacementMap?v=g.displacementMap:g.normalMap?v=g.normalMap:g.bumpMap?v=g.bumpMap:g.roughnessMap?v=g.roughnessMap:g.metalnessMap?v=g.metalnessMap:g.alphaMap?v=g.alphaMap:g.emissiveMap?v=g.emissiveMap:g.clearcoatMap?v=g.clearcoatMap:g.clearcoatNormalMap?v=g.clearcoatNormalMap:g.clearcoatRoughnessMap?v=g.clearcoatRoughnessMap:g.iridescenceMap?v=g.iridescenceMap:g.iridescenceThicknessMap?v=g.iridescenceThicknessMap:g.specularIntensityMap?v=g.specularIntensityMap:g.specularColorMap?v=g.specularColorMap:g.transmissionMap?v=g.transmissionMap:g.thicknessMap?v=g.thicknessMap:g.sheenColorMap?v=g.sheenColorMap:g.sheenRoughnessMap&&(v=g.sheenRoughnessMap),void 0!==v&&(v.isWebGLRenderTarget&&(v=v.texture),!0===v.matrixAutoUpdate&&v.updateMatrix(),p.uvTransform.value.copy(v.matrix)),g.aoMap?b=g.aoMap:g.lightMap&&(b=g.lightMap),void 0!==b&&(b.isWebGLRenderTarget&&(b=b.texture),!0===b.matrixAutoUpdate&&b.updateMatrix(),p.uv2Transform.value.copy(b.matrix))}return{refreshFogUniforms:function t(p,g){g.color.getRGB(p.fogColor.value,Xj(i)),g.isFog?(p.fogNear.value=g.near,p.fogFar.value=g.far):g.isFogExp2&&(p.fogDensity.value=g.density)},refreshMaterialUniforms:function n(p,g,_,v,b){g.isMeshBasicMaterial||g.isMeshLambertMaterial?r(p,g):g.isMeshToonMaterial?(r(p,g),function d(p,g){g.gradientMap&&(p.gradientMap.value=g.gradientMap)}(p,g)):g.isMeshPhongMaterial?(r(p,g),function c(p,g){p.specular.value.copy(g.specular),p.shininess.value=Math.max(g.shininess,1e-4)}(p,g)):g.isMeshStandardMaterial?(r(p,g),function u(p,g){p.roughness.value=g.roughness,p.metalness.value=g.metalness,g.roughnessMap&&(p.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(p.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(p.envMapIntensity.value=g.envMapIntensity)}(p,g),g.isMeshPhysicalMaterial&&function h(p,g,_){p.ior.value=g.ior,g.sheen>0&&(p.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),p.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(p.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(p.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(p.clearcoat.value=g.clearcoat,p.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(p.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(p.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(p.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),p.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===ys&&p.clearcoatNormalScale.value.negate())),g.iridescence>0&&(p.iridescence.value=g.iridescence,p.iridescenceIOR.value=g.iridescenceIOR,p.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],p.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(p.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(p.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(p.transmission.value=g.transmission,p.transmissionSamplerMap.value=_.texture,p.transmissionSamplerSize.value.set(_.width,_.height),g.transmissionMap&&(p.transmissionMap.value=g.transmissionMap),p.thickness.value=g.thickness,g.thicknessMap&&(p.thicknessMap.value=g.thicknessMap),p.attenuationDistance.value=g.attenuationDistance,p.attenuationColor.value.copy(g.attenuationColor)),p.specularIntensity.value=g.specularIntensity,p.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(p.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(p.specularColorMap.value=g.specularColorMap)}(p,g,b)):g.isMeshMatcapMaterial?(r(p,g),function f(p,g){g.matcap&&(p.matcap.value=g.matcap)}(p,g)):g.isMeshDepthMaterial?r(p,g):g.isMeshDistanceMaterial?(r(p,g),function m(p,g){p.referencePosition.value.copy(g.referencePosition),p.nearDistance.value=g.nearDistance,p.farDistance.value=g.farDistance}(p,g)):g.isMeshNormalMaterial?r(p,g):g.isLineBasicMaterial?(function s(p,g){p.diffuse.value.copy(g.color),p.opacity.value=g.opacity}(p,g),g.isLineDashedMaterial&&function o(p,g){p.dashSize.value=g.dashSize,p.totalSize.value=g.dashSize+g.gapSize,p.scale.value=g.scale}(p,g)):g.isPointsMaterial?function a(p,g,_,v){let b;p.diffuse.value.copy(g.color),p.opacity.value=g.opacity,p.size.value=g.size*_,p.scale.value=.5*v,g.map&&(p.map.value=g.map),g.alphaMap&&(p.alphaMap.value=g.alphaMap),g.alphaTest>0&&(p.alphaTest.value=g.alphaTest),g.map?b=g.map:g.alphaMap&&(b=g.alphaMap),void 0!==b&&(!0===b.matrixAutoUpdate&&b.updateMatrix(),p.uvTransform.value.copy(b.matrix))}(p,g,_,v):g.isSpriteMaterial?function l(p,g){let _;p.diffuse.value.copy(g.color),p.opacity.value=g.opacity,p.rotation.value=g.rotation,g.map&&(p.map.value=g.map),g.alphaMap&&(p.alphaMap.value=g.alphaMap),g.alphaTest>0&&(p.alphaTest.value=g.alphaTest),g.map?_=g.map:g.alphaMap&&(_=g.alphaMap),void 0!==_&&(!0===_.matrixAutoUpdate&&_.updateMatrix(),p.uvTransform.value.copy(_.matrix))}(p,g):g.isShadowMaterial?(p.color.value.copy(g.color),p.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}}}function Xoe(i,e,t,n){let r={},s={},o=[];const a=t.isWebGL2?i.getParameter(35375):0;function f(v,b,y){const x=v.value;if(void 0===y[b]){if("number"==typeof x)y[b]=x;else{const C=Array.isArray(x)?x:[x],M=[];for(let w=0;w<C.length;w++)M.push(C[w].clone());y[b]=M}return!0}if("number"==typeof x){if(y[b]!==x)return y[b]=x,!0}else{const C=Array.isArray(y[b])?y[b]:[y[b]],M=Array.isArray(x)?x:[x];for(let w=0;w<C.length;w++){const E=C[w];if(!1===E.equals(M[w]))return E.copy(M[w]),!0}}return!1}function p(v){const b={boundary:0,storage:0};return"number"==typeof v?(b.boundary=4,b.storage=4):v.isVector2?(b.boundary=8,b.storage=8):v.isVector3||v.isColor?(b.boundary=16,b.storage=12):v.isVector4?(b.boundary=16,b.storage=16):v.isMatrix3?(b.boundary=48,b.storage=48):v.isMatrix4?(b.boundary=64,b.storage=64):v.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",v),b}function g(v){const b=v.target;b.removeEventListener("dispose",g);const y=o.indexOf(b.__bindingPointIndex);o.splice(y,1),i.deleteBuffer(r[b.id]),delete r[b.id],delete s[b.id]}return{bind:function l(v,b){n.uniformBlockBinding(v,b.program)},update:function c(v,b){let y=r[v.id];void 0===y&&(function m(v){const b=v.uniforms;let y=0;let C=0;for(let M=0,w=b.length;M<w;M++){const E=b[M],I={boundary:0,storage:0},F=Array.isArray(E.value)?E.value:[E.value];for(let Q=0,B=F.length;Q<B;Q++){const X=p(F[Q]);I.boundary+=X.boundary,I.storage+=X.storage}E.__data=new Float32Array(I.storage/Float32Array.BYTES_PER_ELEMENT),E.__offset=y,M>0&&(C=y%16,0!==C&&16-C-I.boundary<0&&(y+=16-C,E.__offset=y)),y+=I.storage}C=y%16,C>0&&(y+=16-C),v.__size=y,v.__cache={}}(v),y=function d(v){const b=function u(){for(let v=0;v<a;v++)if(-1===o.indexOf(v))return o.push(v),v;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();v.__bindingPointIndex=b;const y=i.createBuffer(),x=v.__size,C=v.usage;return i.bindBuffer(35345,y),i.bufferData(35345,x,C),i.bindBuffer(35345,null),i.bindBufferBase(35345,b,y),y}(v),r[v.id]=y,v.addEventListener("dispose",g)),n.updateUBOMapping(v,b.program);const C=e.render.frame;s[v.id]!==C&&(function h(v){const y=v.uniforms,x=v.__cache;i.bindBuffer(35345,r[v.id]);for(let C=0,M=y.length;C<M;C++){const w=y[C];if(!0===f(w,C,x)){const E=w.__offset,I=Array.isArray(w.value)?w.value:[w.value];let F=0;for(let Q=0;Q<I.length;Q++){const B=I[Q],L=p(B);"number"==typeof B?(w.__data[0]=B,i.bufferSubData(35345,E+F,w.__data)):B.isMatrix3?(w.__data[0]=B.elements[0],w.__data[1]=B.elements[1],w.__data[2]=B.elements[2],w.__data[3]=B.elements[0],w.__data[4]=B.elements[3],w.__data[5]=B.elements[4],w.__data[6]=B.elements[5],w.__data[7]=B.elements[0],w.__data[8]=B.elements[6],w.__data[9]=B.elements[7],w.__data[10]=B.elements[8],w.__data[11]=B.elements[0]):(B.toArray(w.__data,F),F+=L.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(35345,E,w.__data)}}i.bindBuffer(35345,null)}(v),s[v.id]=C)},dispose:function _(){for(const v in r)i.deleteBuffer(r[v]);o=[],r={},s={}}}}function VT(i={}){this.isWebGLRenderer=!0;const e=void 0!==i.canvas?i.canvas:function Yoe(){const i=Z_("canvas");return i.style.display="block",i}(),t=void 0!==i.context?i.context:null,n=void 0===i.depth||i.depth,r=void 0===i.stencil||i.stencil,s=void 0!==i.antialias&&i.antialias,o=void 0===i.premultipliedAlpha||i.premultipliedAlpha,a=void 0!==i.preserveDrawingBuffer&&i.preserveDrawingBuffer,l=void 0!==i.powerPreference?i.powerPreference:"default",c=void 0!==i.failIfMajorPerformanceCaveat&&i.failIfMajorPerformanceCaveat;let d;d=null!==t?t.getContextAttributes().alpha:void 0!==i.alpha&&i.alpha;let u=null,h=null;const f=[],m=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Ys,this.physicallyCorrectLights=!1,this.toneMapping=Ra,this.toneMappingExposure=1;const p=this;let g=!1,_=0,v=0,b=null,y=-1,x=null;const C=new ni,M=new ni;let w=null,E=e.width,I=e.height,F=1,Q=null,B=null;const L=new ni(0,0,E,I),X=new ni(0,0,E,I);let P=!1;const V=new zA;let O=!1,q=!1,ee=null;const Z=new Ve,Y=new ue,he=new T,J={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ae(){return null===b?F:1}let de,Ee,we,et,Ae,xe,Pe,$e,We,yt,ht,ot,St,ft,N,k,_e,Se,Ue,Ze,bt,H,te,tt,G=t;function U(j,ge){for(let me=0;me<j.length;me++){const Te=e.getContext(j[me],ge);if(null!==Te)return Te}return null}try{const j={alpha:!0,depth:n,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${nA}`),e.addEventListener("webglcontextlost",rt,!1),e.addEventListener("webglcontextrestored",At,!1),e.addEventListener("webglcontextcreationerror",Jt,!1),null===G){const ge=["webgl2","webgl","experimental-webgl"];if(!0===p.isWebGL1Renderer&&ge.shift(),G=U(ge,j),null===G)throw U(ge)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===G.getShaderPrecisionFormat&&(G.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(j){throw console.error("THREE.WebGLRenderer: "+j.message),j}function lt(){de=new use(G),Ee=new sse(G,de,i),de.init(Ee),H=new xU(G,de,Ee),we=new Hoe(G,de,Ee),et=new pse,Ae=new Doe,xe=new Goe(G,de,we,Ae,Ee,H,et),Pe=new ase(p),$e=new dse(p),We=new nne(G,Ee),te=new nse(G,de,We,Ee),yt=new hse(G,We,et,te),ht=new bse(G,yt,We,et),Ue=new _se(G,Ee,xe),k=new ose(Ae),ot=new Roe(p,Pe,$e,de,Ee,te,k),St=new qoe(p,Ae),ft=new koe,N=new joe(de,Ee),Se=new ise(p,Pe,$e,we,ht,d,o),_e=new zoe(p,ht,Ee),tt=new Xoe(G,et,Ee,we),Ze=new rse(G,de,et,Ee),bt=new fse(G,de,et,Ee),et.programs=ot.programs,p.capabilities=Ee,p.extensions=de,p.properties=Ae,p.renderLists=ft,p.shadowMap=_e,p.state=we,p.info=et}lt();const nt=new Woe(p,G);function rt(j){j.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function At(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const j=et.autoReset,ge=_e.enabled,me=_e.autoUpdate,pe=_e.needsUpdate,Te=_e.type;lt(),et.autoReset=j,_e.enabled=ge,_e.autoUpdate=me,_e.needsUpdate=pe,_e.type=Te}function Jt(j){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",j.statusMessage)}function Ft(j){const ge=j.target;ge.removeEventListener("dispose",Ft),function Ot(j){(function re(j){const ge=Ae.get(j).programs;void 0!==ge&&(ge.forEach(function(me){ot.releaseProgram(me)}),j.isShaderMaterial&&ot.releaseShaderCache(j))})(j),Ae.remove(j)}(ge)}this.xr=nt,this.getContext=function(){return G},this.getContextAttributes=function(){return G.getContextAttributes()},this.forceContextLoss=function(){const j=de.get("WEBGL_lose_context");j&&j.loseContext()},this.forceContextRestore=function(){const j=de.get("WEBGL_lose_context");j&&j.restoreContext()},this.getPixelRatio=function(){return F},this.setPixelRatio=function(j){void 0!==j&&(F=j,this.setSize(E,I,!1))},this.getSize=function(j){return j.set(E,I)},this.setSize=function(j,ge,me){nt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(E=j,I=ge,e.width=Math.floor(j*F),e.height=Math.floor(ge*F),!1!==me&&(e.style.width=j+"px",e.style.height=ge+"px"),this.setViewport(0,0,j,ge))},this.getDrawingBufferSize=function(j){return j.set(E*F,I*F).floor()},this.setDrawingBufferSize=function(j,ge,me){E=j,I=ge,F=me,e.width=Math.floor(j*me),e.height=Math.floor(ge*me),this.setViewport(0,0,j,ge)},this.getCurrentViewport=function(j){return j.copy(C)},this.getViewport=function(j){return j.copy(L)},this.setViewport=function(j,ge,me,pe){j.isVector4?L.set(j.x,j.y,j.z,j.w):L.set(j,ge,me,pe),we.viewport(C.copy(L).multiplyScalar(F).floor())},this.getScissor=function(j){return j.copy(X)},this.setScissor=function(j,ge,me,pe){j.isVector4?X.set(j.x,j.y,j.z,j.w):X.set(j,ge,me,pe),we.scissor(M.copy(X).multiplyScalar(F).floor())},this.getScissorTest=function(){return P},this.setScissorTest=function(j){we.setScissorTest(P=j)},this.setOpaqueSort=function(j){Q=j},this.setTransparentSort=function(j){B=j},this.getClearColor=function(j){return j.copy(Se.getClearColor())},this.setClearColor=function(){Se.setClearColor.apply(Se,arguments)},this.getClearAlpha=function(){return Se.getClearAlpha()},this.setClearAlpha=function(){Se.setClearAlpha.apply(Se,arguments)},this.clear=function(j=!0,ge=!0,me=!0){let pe=0;j&&(pe|=16384),ge&&(pe|=256),me&&(pe|=1024),G.clear(pe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",rt,!1),e.removeEventListener("webglcontextrestored",At,!1),e.removeEventListener("webglcontextcreationerror",Jt,!1),ft.dispose(),N.dispose(),Ae.dispose(),Pe.dispose(),$e.dispose(),ht.dispose(),te.dispose(),tt.dispose(),ot.dispose(),nt.dispose(),nt.removeEventListener("sessionstart",dt),nt.removeEventListener("sessionend",Tt),ee&&(ee.dispose(),ee=null),ki.stop()},this.renderBufferDirect=function(j,ge,me,pe,Te,S){null===ge&&(ge=J);const D=Te.isMesh&&Te.matrixWorld.determinant()<0,z=function E2(j,ge,me,pe,Te){!0!==ge.isScene&&(ge=J),xe.resetTextureUnits();const S=ge.fog,z=null===b?p.outputEncoding:!0===b.isXRRenderTarget?b.texture.encoding:Ys,ne=(pe.isMeshStandardMaterial?$e:Pe).get(pe.envMap||(pe.isMeshStandardMaterial?ge.environment:null)),be=!0===pe.vertexColors&&!!me.attributes.color&&4===me.attributes.color.itemSize,fe=!!pe.normalMap&&!!me.attributes.tangent,Ce=!!me.morphAttributes.position,Oe=!!me.morphAttributes.normal,qe=!!me.morphAttributes.color,Be=pe.toneMapped?p.toneMapping:Ra,Xe=me.morphAttributes.position||me.morphAttributes.normal||me.morphAttributes.color,Je=void 0!==Xe?Xe.length:0,He=Ae.get(pe),Bt=h.state.lights;!0!==O||!0!==q&&j===x||k.setState(pe,j,j===x&&pe.id===y);let Et=!1;pe.version===He.__version?(He.needsLights&&He.lightsStateVersion!==Bt.state.version||He.outputEncoding!==z||Te.isInstancedMesh&&!1===He.instancing||!Te.isInstancedMesh&&!0===He.instancing||Te.isSkinnedMesh&&!1===He.skinning||!Te.isSkinnedMesh&&!0===He.skinning||He.envMap!==ne||!0===pe.fog&&He.fog!==S||void 0!==He.numClippingPlanes&&(He.numClippingPlanes!==k.numPlanes||He.numIntersection!==k.numIntersection)||He.vertexAlphas!==be||He.vertexTangents!==fe||He.morphTargets!==Ce||He.morphNormals!==Oe||He.morphColors!==qe||He.toneMapping!==Be||!0===Ee.isWebGL2&&He.morphTargetsCount!==Je)&&(Et=!0):(Et=!0,He.__version=pe.version);let pt=He.currentProgram;!0===Et&&(pt=Fs(pe,ge,Te));let It=!1,ei=!1,an=!1;const Ai=pt.getUniforms(),$n=He.uniforms;if(we.useProgram(pt.program)&&(It=!0,ei=!0,an=!0),pe.id!==y&&(y=pe.id,ei=!0),It||x!==j){if(Ai.setValue(G,"projectionMatrix",j.projectionMatrix),Ee.logarithmicDepthBuffer&&Ai.setValue(G,"logDepthBufFC",2/(Math.log(j.far+1)/Math.LN2)),x!==j&&(x=j,ei=!0,an=!0),pe.isShaderMaterial||pe.isMeshPhongMaterial||pe.isMeshToonMaterial||pe.isMeshStandardMaterial||pe.envMap){const Qt=Ai.map.cameraPosition;void 0!==Qt&&Qt.setValue(G,he.setFromMatrixPosition(j.matrixWorld))}(pe.isMeshPhongMaterial||pe.isMeshToonMaterial||pe.isMeshLambertMaterial||pe.isMeshBasicMaterial||pe.isMeshStandardMaterial||pe.isShaderMaterial)&&Ai.setValue(G,"isOrthographic",!0===j.isOrthographicCamera),(pe.isMeshPhongMaterial||pe.isMeshToonMaterial||pe.isMeshLambertMaterial||pe.isMeshBasicMaterial||pe.isMeshStandardMaterial||pe.isShaderMaterial||pe.isShadowMaterial||Te.isSkinnedMesh)&&Ai.setValue(G,"viewMatrix",j.matrixWorldInverse)}if(Te.isSkinnedMesh){Ai.setOptional(G,Te,"bindMatrix"),Ai.setOptional(G,Te,"bindMatrixInverse");const Qt=Te.skeleton;Qt&&(Ee.floatVertexTextures?(null===Qt.boneTexture&&Qt.computeBoneTexture(),Ai.setValue(G,"boneTexture",Qt.boneTexture,xe),Ai.setValue(G,"boneTextureSize",Qt.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Qi=me.morphAttributes;if((void 0!==Qi.position||void 0!==Qi.normal||void 0!==Qi.color&&!0===Ee.isWebGL2)&&Ue.update(Te,me,pe,pt),(ei||He.receiveShadow!==Te.receiveShadow)&&(He.receiveShadow=Te.receiveShadow,Ai.setValue(G,"receiveShadow",Te.receiveShadow)),pe.isMeshGouraudMaterial&&null!==pe.envMap&&($n.envMap.value=ne,$n.flipEnvMap.value=ne.isCubeTexture&&!1===ne.isRenderTargetTexture?-1:1),ei&&(Ai.setValue(G,"toneMappingExposure",p.toneMappingExposure),He.needsLights&&function xg(j,ge){j.ambientLightColor.needsUpdate=ge,j.lightProbe.needsUpdate=ge,j.directionalLights.needsUpdate=ge,j.directionalLightShadows.needsUpdate=ge,j.pointLights.needsUpdate=ge,j.pointLightShadows.needsUpdate=ge,j.spotLights.needsUpdate=ge,j.spotLightShadows.needsUpdate=ge,j.rectAreaLights.needsUpdate=ge,j.hemisphereLights.needsUpdate=ge}($n,an),S&&!0===pe.fog&&St.refreshFogUniforms($n,S),St.refreshMaterialUniforms($n,pe,F,I,ee),WA.upload(G,He.uniformsList,$n,xe)),pe.isShaderMaterial&&!0===pe.uniformsNeedUpdate&&(WA.upload(G,He.uniformsList,$n,xe),pe.uniformsNeedUpdate=!1),pe.isSpriteMaterial&&Ai.setValue(G,"center",Te.center),Ai.setValue(G,"modelViewMatrix",Te.modelViewMatrix),Ai.setValue(G,"normalMatrix",Te.normalMatrix),Ai.setValue(G,"modelMatrix",Te.matrixWorld),pe.isShaderMaterial||pe.isRawShaderMaterial){const Qt=pe.uniformsGroups;for(let Rn=0,Bs=Qt.length;Rn<Bs;Rn++)if(Ee.isWebGL2){const Jn=Qt[Rn];tt.update(Jn,pt),tt.bind(Jn,pt)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return pt}(j,ge,me,pe,Te);we.setMaterial(pe,D);let ne=me.index,be=1;!0===pe.wireframe&&(ne=yt.getWireframeAttribute(me),be=2);const fe=me.drawRange,Ce=me.attributes.position;let Oe=fe.start*be,qe=(fe.start+fe.count)*be;null!==S&&(Oe=Math.max(Oe,S.start*be),qe=Math.min(qe,(S.start+S.count)*be)),null!==ne?(Oe=Math.max(Oe,0),qe=Math.min(qe,ne.count)):null!=Ce&&(Oe=Math.max(Oe,0),qe=Math.min(qe,Ce.count));const Be=qe-Oe;if(Be<0||Be===1/0)return;te.setup(Te,pe,z,me,ne);let Xe,Je=Ze;if(null!==ne&&(Xe=We.get(ne),Je=bt,Je.setIndex(Xe)),Te.isMesh)!0===pe.wireframe?(we.setLineWidth(pe.wireframeLinewidth*ae()),Je.setMode(1)):Je.setMode(4);else if(Te.isLine){let He=pe.linewidth;void 0===He&&(He=1),we.setLineWidth(He*ae()),Je.setMode(Te.isLineSegments?1:Te.isLineLoop?2:3)}else Te.isPoints?Je.setMode(0):Te.isSprite&&Je.setMode(4);if(Te.isInstancedMesh)Je.renderInstances(Oe,Be,Te.count);else if(me.isInstancedBufferGeometry){const Bt=Math.min(me.instanceCount,void 0!==me._maxInstanceCount?me._maxInstanceCount:1/0);Je.renderInstances(Oe,Be,Bt)}else Je.render(Oe,Be)},this.compile=function(j,ge){function me(pe,Te,S){!0===pe.transparent&&pe.side===B_?(pe.side=ys,pe.needsUpdate=!0,Fs(pe,Te,S),pe.side=_l,pe.needsUpdate=!0,Fs(pe,Te,S),pe.side=B_):Fs(pe,Te,S)}h=N.get(j),h.init(),m.push(h),j.traverseVisible(function(pe){pe.isLight&&pe.layers.test(ge.layers)&&(h.pushLight(pe),pe.castShadow&&h.pushShadow(pe))}),h.setupLights(p.physicallyCorrectLights),j.traverse(function(pe){const Te=pe.material;if(Te)if(Array.isArray(Te))for(let S=0;S<Te.length;S++)me(Te[S],j,pe);else me(Te,j,pe)}),m.pop(),h=null};let ie=null;function dt(){ki.stop()}function Tt(){ki.start()}const ki=new Zj;function lr(j,ge,me,pe){if(!1===j.visible)return;if(j.layers.test(ge.layers))if(j.isGroup)me=j.renderOrder;else if(j.isLOD)!0===j.autoUpdate&&j.update(ge);else if(j.isLight)h.pushLight(j),j.castShadow&&h.pushShadow(j);else if(j.isSprite){if(!j.frustumCulled||V.intersectsSprite(j)){pe&&he.setFromMatrixPosition(j.matrixWorld).applyMatrix4(Z);const D=ht.update(j),z=j.material;z.visible&&u.push(j,D,z,me,he.z,null)}}else if((j.isMesh||j.isLine||j.isPoints)&&(j.isSkinnedMesh&&j.skeleton.frame!==et.render.frame&&(j.skeleton.update(),j.skeleton.frame=et.render.frame),!j.frustumCulled||V.intersectsObject(j))){pe&&he.setFromMatrixPosition(j.matrixWorld).applyMatrix4(Z);const D=ht.update(j),z=j.material;if(Array.isArray(z)){const ne=D.groups;for(let be=0,fe=ne.length;be<fe;be++){const Ce=ne[be],Oe=z[Ce.materialIndex];Oe&&Oe.visible&&u.push(j,D,Oe,me,he.z,Ce)}}else z.visible&&u.push(j,D,z,me,he.z,null)}const S=j.children;for(let D=0,z=S.length;D<z;D++)lr(S[D],ge,me,pe)}function Dr(j,ge,me,pe){const Te=j.opaque,S=j.transmissive,D=j.transparent;h.setupLightsView(me),S.length>0&&function Hl(j,ge,me){const pe=Ee.isWebGL2;null===ee&&(ee=new Gt(1,1,{generateMipmaps:!0,type:de.has("EXT_color_buffer_half_float")?fn:Wr,minFilter:Xs,samples:pe&&!0===s?4:0})),p.getDrawingBufferSize(Y),pe?ee.setSize(Y.x,Y.y):ee.setSize(AA(Y.x),AA(Y.y));const Te=p.getRenderTarget();p.setRenderTarget(ee),p.clear();const S=p.toneMapping;p.toneMapping=Ra,on(j,ge,me),p.toneMapping=S,xe.updateMultisampleRenderTarget(ee),xe.updateRenderTargetMipmap(ee),p.setRenderTarget(Te)}(Te,ge,me),pe&&we.viewport(C.copy(pe)),Te.length>0&&on(Te,ge,me),S.length>0&&on(S,ge,me),D.length>0&&on(D,ge,me),we.buffers.depth.setTest(!0),we.buffers.depth.setMask(!0),we.buffers.color.setMask(!0),we.setPolygonOffset(!1)}function on(j,ge,me){const pe=!0===ge.isScene?ge.overrideMaterial:null;for(let Te=0,S=j.length;Te<S;Te++){const D=j[Te],z=D.object,ne=D.geometry,be=null===pe?D.material:pe,fe=D.group;z.layers.test(me.layers)&&pa(z,ge,me,ne,be,fe)}}function pa(j,ge,me,pe,Te,S){j.onBeforeRender(p,ge,me,pe,Te,S),j.modelViewMatrix.multiplyMatrices(me.matrixWorldInverse,j.matrixWorld),j.normalMatrix.getNormalMatrix(j.modelViewMatrix),Te.onBeforeRender(p,ge,me,pe,j,S),!0===Te.transparent&&Te.side===B_?(Te.side=ys,Te.needsUpdate=!0,p.renderBufferDirect(me,ge,pe,Te,j,S),Te.side=_l,Te.needsUpdate=!0,p.renderBufferDirect(me,ge,pe,Te,j,S),Te.side=B_):p.renderBufferDirect(me,ge,pe,Te,j,S),j.onAfterRender(p,ge,me,pe,Te,S)}function Fs(j,ge,me){!0!==ge.isScene&&(ge=J);const pe=Ae.get(j),Te=h.state.lights,D=Te.state.version,z=ot.getParameters(j,Te.state,h.state.shadowsArray,ge,me),ne=ot.getProgramCacheKey(z);let be=pe.programs;pe.environment=j.isMeshStandardMaterial?ge.environment:null,pe.fog=ge.fog,pe.envMap=(j.isMeshStandardMaterial?$e:Pe).get(j.envMap||pe.environment),void 0===be&&(j.addEventListener("dispose",Ft),be=new Map,pe.programs=be);let fe=be.get(ne);if(void 0!==fe){if(pe.currentProgram===fe&&pe.lightsStateVersion===D)return YC(j,z),fe}else z.uniforms=ot.getUniforms(j),j.onBuild(me,z,p),j.onBeforeCompile(z,p),fe=ot.acquireProgram(z,ne),be.set(ne,fe),pe.uniforms=z.uniforms;const Ce=pe.uniforms;(!j.isShaderMaterial&&!j.isRawShaderMaterial||!0===j.clipping)&&(Ce.clippingPlanes=k.uniform),YC(j,z),pe.needsLights=function S2(j){return j.isMeshLambertMaterial||j.isMeshToonMaterial||j.isMeshPhongMaterial||j.isMeshStandardMaterial||j.isShadowMaterial||j.isShaderMaterial&&!0===j.lights}(j),pe.lightsStateVersion=D,pe.needsLights&&(Ce.ambientLightColor.value=Te.state.ambient,Ce.lightProbe.value=Te.state.probe,Ce.directionalLights.value=Te.state.directional,Ce.directionalLightShadows.value=Te.state.directionalShadow,Ce.spotLights.value=Te.state.spot,Ce.spotLightShadows.value=Te.state.spotShadow,Ce.rectAreaLights.value=Te.state.rectArea,Ce.ltc_1.value=Te.state.rectAreaLTC1,Ce.ltc_2.value=Te.state.rectAreaLTC2,Ce.pointLights.value=Te.state.point,Ce.pointLightShadows.value=Te.state.pointShadow,Ce.hemisphereLights.value=Te.state.hemi,Ce.directionalShadowMap.value=Te.state.directionalShadowMap,Ce.directionalShadowMatrix.value=Te.state.directionalShadowMatrix,Ce.spotShadowMap.value=Te.state.spotShadowMap,Ce.spotLightMatrix.value=Te.state.spotLightMatrix,Ce.spotLightMap.value=Te.state.spotLightMap,Ce.pointShadowMap.value=Te.state.pointShadowMap,Ce.pointShadowMatrix.value=Te.state.pointShadowMatrix);const Oe=fe.getUniforms(),qe=WA.seqWithValue(Oe.seq,Ce);return pe.currentProgram=fe,pe.uniformsList=qe,fe}function YC(j,ge){const me=Ae.get(j);me.outputEncoding=ge.outputEncoding,me.instancing=ge.instancing,me.skinning=ge.skinning,me.morphTargets=ge.morphTargets,me.morphNormals=ge.morphNormals,me.morphColors=ge.morphColors,me.morphTargetsCount=ge.morphTargetsCount,me.numClippingPlanes=ge.numClippingPlanes,me.numIntersection=ge.numClipIntersection,me.vertexAlphas=ge.vertexAlphas,me.vertexTangents=ge.vertexTangents,me.toneMapping=ge.toneMapping}ki.setAnimationLoop(function je(j){ie&&ie(j)}),typeof self<"u"&&ki.setContext(self),this.setAnimationLoop=function(j){ie=j,nt.setAnimationLoop(j),null===j?ki.stop():ki.start()},nt.addEventListener("sessionstart",dt),nt.addEventListener("sessionend",Tt),this.render=function(j,ge){if(void 0===ge||!0===ge.isCamera){if(!0!==g){if(!0===j.matrixWorldAutoUpdate&&j.updateMatrixWorld(),null===ge.parent&&!0===ge.matrixWorldAutoUpdate&&ge.updateMatrixWorld(),!0===nt.enabled&&!0===nt.isPresenting&&(!0===nt.cameraAutoUpdate&&nt.updateCamera(ge),ge=nt.getCamera()),!0===j.isScene&&j.onBeforeRender(p,j,ge,b),h=N.get(j,m.length),h.init(),m.push(h),Z.multiplyMatrices(ge.projectionMatrix,ge.matrixWorldInverse),V.setFromProjectionMatrix(Z),q=this.localClippingEnabled,O=k.init(this.clippingPlanes,q,ge),u=ft.get(j,f.length),u.init(),f.push(u),lr(j,ge,0,p.sortObjects),u.finish(),!0===p.sortObjects&&u.sort(Q,B),!0===O&&k.beginShadows(),_e.render(h.state.shadowsArray,j,ge),!0===O&&k.endShadows(),!0===this.info.autoReset&&this.info.reset(),Se.render(u,j),h.setupLights(p.physicallyCorrectLights),ge.isArrayCamera){const pe=ge.cameras;for(let Te=0,S=pe.length;Te<S;Te++){const D=pe[Te];Dr(u,j,D,D.viewport)}}else Dr(u,j,ge);null!==b&&(xe.updateMultisampleRenderTarget(b),xe.updateRenderTargetMipmap(b)),!0===j.isScene&&j.onAfterRender(p,j,ge),te.resetDefaultState(),y=-1,x=null,m.pop(),h=m.length>0?m[m.length-1]:null,f.pop(),u=f.length>0?f[f.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return _},this.getActiveMipmapLevel=function(){return v},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(j,ge,me){Ae.get(j.texture).__webglTexture=ge,Ae.get(j.depthTexture).__webglTexture=me;const pe=Ae.get(j);pe.__hasExternalTextures=!0,pe.__hasExternalTextures&&(pe.__autoAllocateDepthBuffer=void 0===me,pe.__autoAllocateDepthBuffer||!0===de.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),pe.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(j,ge){const me=Ae.get(j);me.__webglFramebuffer=ge,me.__useDefaultFramebuffer=void 0===ge},this.setRenderTarget=function(j,ge=0,me=0){b=j,_=ge,v=me;let pe=!0,Te=null,S=!1,D=!1;if(j){const ne=Ae.get(j);void 0!==ne.__useDefaultFramebuffer?(we.bindFramebuffer(36160,null),pe=!1):void 0===ne.__webglFramebuffer?xe.setupRenderTarget(j):ne.__hasExternalTextures&&xe.rebindTextures(j,Ae.get(j.texture).__webglTexture,Ae.get(j.depthTexture).__webglTexture);const be=j.texture;(be.isData3DTexture||be.isDataArrayTexture||be.isCompressedArrayTexture)&&(D=!0);const fe=Ae.get(j).__webglFramebuffer;j.isWebGLCubeRenderTarget?(Te=fe[ge],S=!0):Te=Ee.isWebGL2&&j.samples>0&&!1===xe.useMultisampledRTT(j)?Ae.get(j).__webglMultisampledFramebuffer:fe,C.copy(j.viewport),M.copy(j.scissor),w=j.scissorTest}else C.copy(L).multiplyScalar(F).floor(),M.copy(X).multiplyScalar(F).floor(),w=P;if(we.bindFramebuffer(36160,Te)&&Ee.drawBuffers&&pe&&we.drawBuffers(j,Te),we.viewport(C),we.scissor(M),we.setScissorTest(w),S){const ne=Ae.get(j.texture);G.framebufferTexture2D(36160,36064,34069+ge,ne.__webglTexture,me)}else if(D){const ne=Ae.get(j.texture);G.framebufferTextureLayer(36160,36064,ne.__webglTexture,me||0,ge||0)}y=-1},this.readRenderTargetPixels=function(j,ge,me,pe,Te,S,D){if(!j||!j.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let z=Ae.get(j).__webglFramebuffer;if(j.isWebGLCubeRenderTarget&&void 0!==D&&(z=z[D]),z){we.bindFramebuffer(36160,z);try{const ne=j.texture,be=ne.format,fe=ne.type;if(be!==En&&H.convert(be)!==G.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Ce=fe===fn&&(de.has("EXT_color_buffer_half_float")||Ee.isWebGL2&&de.has("EXT_color_buffer_float"));if(!(fe===Wr||H.convert(fe)===G.getParameter(35738)||fe===Ln&&(Ee.isWebGL2||de.has("OES_texture_float")||de.has("WEBGL_color_buffer_float"))||Ce))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");ge>=0&&ge<=j.width-pe&&me>=0&&me<=j.height-Te&&G.readPixels(ge,me,pe,Te,H.convert(be),H.convert(fe),S)}finally{const ne=null!==b?Ae.get(b).__webglFramebuffer:null;we.bindFramebuffer(36160,ne)}}},this.copyFramebufferToTexture=function(j,ge,me=0){const pe=Math.pow(2,-me),Te=Math.floor(ge.image.width*pe),S=Math.floor(ge.image.height*pe);xe.setTexture2D(ge,0),G.copyTexSubImage2D(3553,me,0,0,j.x,j.y,Te,S),we.unbindTexture()},this.copyTextureToTexture=function(j,ge,me,pe=0){const Te=ge.image.width,S=ge.image.height,D=H.convert(me.format),z=H.convert(me.type);xe.setTexture2D(me,0),G.pixelStorei(37440,me.flipY),G.pixelStorei(37441,me.premultiplyAlpha),G.pixelStorei(3317,me.unpackAlignment),ge.isDataTexture?G.texSubImage2D(3553,pe,j.x,j.y,Te,S,D,z,ge.image.data):ge.isCompressedTexture?G.compressedTexSubImage2D(3553,pe,j.x,j.y,ge.mipmaps[0].width,ge.mipmaps[0].height,D,ge.mipmaps[0].data):G.texSubImage2D(3553,pe,j.x,j.y,D,z,ge.image),0===pe&&me.generateMipmaps&&G.generateMipmap(3553),we.unbindTexture()},this.copyTextureToTexture3D=function(j,ge,me,pe,Te=0){if(p.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const S=j.max.x-j.min.x+1,D=j.max.y-j.min.y+1,z=j.max.z-j.min.z+1,ne=H.convert(pe.format),be=H.convert(pe.type);let fe;if(pe.isData3DTexture)xe.setTexture3D(pe,0),fe=32879;else{if(!pe.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");xe.setTexture2DArray(pe,0),fe=35866}G.pixelStorei(37440,pe.flipY),G.pixelStorei(37441,pe.premultiplyAlpha),G.pixelStorei(3317,pe.unpackAlignment);const Ce=G.getParameter(3314),Oe=G.getParameter(32878),qe=G.getParameter(3316),Be=G.getParameter(3315),Xe=G.getParameter(32877),Je=me.isCompressedTexture?me.mipmaps[0]:me.image;G.pixelStorei(3314,Je.width),G.pixelStorei(32878,Je.height),G.pixelStorei(3316,j.min.x),G.pixelStorei(3315,j.min.y),G.pixelStorei(32877,j.min.z),me.isDataTexture||me.isData3DTexture?G.texSubImage3D(fe,Te,ge.x,ge.y,ge.z,S,D,z,ne,be,Je.data):me.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),G.compressedTexSubImage3D(fe,Te,ge.x,ge.y,ge.z,S,D,z,ne,Je.data)):G.texSubImage3D(fe,Te,ge.x,ge.y,ge.z,S,D,z,ne,be,Je),G.pixelStorei(3314,Ce),G.pixelStorei(32878,Oe),G.pixelStorei(3316,qe),G.pixelStorei(3315,Be),G.pixelStorei(32877,Xe),0===Te&&pe.generateMipmaps&&G.generateMipmap(fe),we.unbindTexture()},this.initTexture=function(j){j.isCubeTexture?xe.setTextureCube(j,0):j.isData3DTexture?xe.setTexture3D(j,0):j.isDataArrayTexture||j.isCompressedArrayTexture?xe.setTexture2DArray(j,0):xe.setTexture2D(j,0),we.unbindTexture()},this.resetState=function(){_=0,v=0,b=null,we.reset(),te.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class wU extends VT{}wU.prototype.isWebGL1Renderer=!0;class XA{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new De(e),this.density=t}clone(){return new XA(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class l0{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new De(e),this.near=t,this.far=n}clone(){return new l0(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class YA extends wi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class c0{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=q_,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Zs()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Zs()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Zs()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ls=new T;class _c{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)ls.fromBufferAttribute(this,t),ls.applyMatrix4(e),this.setXYZ(t,ls.x,ls.y,ls.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ls.fromBufferAttribute(this,t),ls.applyNormalMatrix(e),this.setXYZ(t,ls.x,ls.y,ls.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ls.fromBufferAttribute(this,t),ls.transformDirection(e),this.setXYZ(t,ls.x,ls.y,ls.z);return this}setX(e,t){return this.normalized&&(t=Zi(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Zi(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Zi(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Zi(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=vl(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=vl(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=vl(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=vl(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Zi(t,this.array),n=Zi(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Zi(t,this.array),n=Zi(n,this.array),r=Zi(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Zi(t,this.array),n=Zi(n,this.array),r=Zi(r,this.array),s=Zi(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Ci(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new _c(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class ZA extends On{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new De(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Gf;const d0=new T,Qf=new T,Wf=new T,qf=new ue,u0=new ue,CU=new Ve,KA=new T,h0=new T,$A=new T,MU=new ue,zT=new ue,EU=new ue;class HT extends wi{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",void 0===Gf){Gf=new xt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new c0(t,5);Gf.setIndex([0,1,2,0,2,3]),Gf.setAttribute("position",new _c(n,3,0,!1)),Gf.setAttribute("uv",new _c(n,2,3,!1))}this.geometry=Gf,this.material=void 0!==e?e:new ZA,this.center=new ue(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Qf.setFromMatrixScale(this.matrixWorld),CU.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Wf.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Qf.multiplyScalar(-Wf.z);const n=this.material.rotation;let r,s;0!==n&&(s=Math.cos(n),r=Math.sin(n));const o=this.center;JA(KA.set(-.5,-.5,0),Wf,o,Qf,r,s),JA(h0.set(.5,-.5,0),Wf,o,Qf,r,s),JA($A.set(.5,.5,0),Wf,o,Qf,r,s),MU.set(0,0),zT.set(1,0),EU.set(1,1);let a=e.ray.intersectTriangle(KA,h0,$A,!1,d0);if(null===a&&(JA(h0.set(-.5,.5,0),Wf,o,Qf,r,s),zT.set(0,1),a=e.ray.intersectTriangle(KA,$A,h0,!1,d0),null===a))return;const l=e.ray.origin.distanceTo(d0);l<e.near||l>e.far||t.push({distance:l,point:d0.clone(),uv:Js.getUV(d0,KA,h0,$A,MU,zT,EU,new ue),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function JA(i,e,t,n,r,s){qf.subVectors(i,t).addScalar(.5).multiply(n),void 0!==r?(u0.x=s*qf.x-r*qf.y,u0.y=r*qf.x+s*qf.y):u0.copy(qf),i.copy(e),i.x+=u0.x,i.y+=u0.y,i.applyMatrix4(CU)}const ex=new T,SU=new T;class GT extends wi{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const s=t[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let s=t[n].distance;if(t[n].object.visible&&(s-=s*t[n].hysteresis),e<s)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){ex.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(ex);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){ex.setFromMatrixPosition(e.matrixWorld),SU.setFromMatrixPosition(this.matrixWorld);const n=ex.distanceTo(SU)/e.zoom;let r,s;for(t[0].object.visible=!0,r=1,s=t.length;r<s;r++){let o=t[r].distance;if(t[r].object.visible&&(o-=o*t[r].hysteresis),!(n>=o))break;t[r-1].object.visible=!1,t[r].object.visible=!0}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,s=n.length;r<s;r++){const o=n[r];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const TU=new T,IU=new ni,RU=new ni,Zoe=new T,DU=new Ve;class f0 extends Ke{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ve,this.bindMatrixInverse=new Ve}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new ni,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,r=this.geometry;IU.fromBufferAttribute(r.attributes.skinIndex,e),RU.fromBufferAttribute(r.attributes.skinWeight,e),TU.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=RU.getComponent(s);if(0!==o){const a=IU.getComponent(s);DU.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(Zoe.copy(TU).applyMatrix4(DU),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Kd extends wi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class ka extends qn{constructor(e=null,t=1,n=1,r,s,o,a,l,c=$t,d=$t,u,h){super(null,o,a,l,c,d,r,s,u,h),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const PU=new Ve,Koe=new Ve;class Xf{constructor(e=[],t=[]){this.uuid=Zs(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Ve)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Ve;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)PU.multiplyMatrices(e[s]?e[s].matrixWorld:Koe,t[s]),PU.toArray(n,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new Xf(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=Bj(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new ka(t,e,e,En,Ln);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const s=e.bones[n];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new Kd),this.bones.push(o),this.boneInverses.push((new Ve).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(n[r].toArray());return e}}class Yf extends Ci{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const kU=new Ve,FU=new Ve,tx=[],$oe=new Ve,p0=new Ke;class ix extends Ke{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Yf(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1;for(let r=0;r<n;r++)this.setMatrixAt(r,$oe)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,r=this.count;if(p0.geometry=this.geometry,p0.material=this.material,void 0!==p0.material)for(let s=0;s<r;s++){this.getMatrixAt(s,kU),FU.multiplyMatrices(n,kU),p0.matrixWorld=FU,p0.raycast(e,tx);for(let o=0,a=tx.length;o<a;o++){const l=tx[o];l.instanceId=s,l.object=this,t.push(l)}tx.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Yf(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class pn extends On{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new De(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const BU=new T,LU=new T,OU=new Ve,QT=new J_,nx=new Al;class Nn extends wi{constructor(e=new xt,t=new pn){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)BU.fromBufferAttribute(t,r-1),LU.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=BU.distanceTo(LU);e.setAttribute("lineDistance",new Ge(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),nx.copy(n.boundingSphere),nx.applyMatrix4(r),nx.radius+=s,!1===e.ray.intersectsSphere(nx))return;OU.copy(r).invert(),QT.copy(e.ray).applyMatrix4(OU);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new T,d=new T,u=new T,h=new T,f=this.isLineSegments?2:1,m=n.index,g=n.attributes.position;if(null!==m)for(let b=Math.max(0,o.start),y=Math.min(m.count,o.start+o.count)-1;b<y;b+=f){const x=m.getX(b),C=m.getX(b+1);if(c.fromBufferAttribute(g,x),d.fromBufferAttribute(g,C),QT.distanceSqToSegment(c,d,h,u)>l)continue;h.applyMatrix4(this.matrixWorld);const w=e.ray.origin.distanceTo(h);w<e.near||w>e.far||t.push({distance:w,point:u.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}else for(let b=Math.max(0,o.start),y=Math.min(g.count,o.start+o.count)-1;b<y;b+=f){if(c.fromBufferAttribute(g,b),d.fromBufferAttribute(g,b+1),QT.distanceSqToSegment(c,d,h,u)>l)continue;h.applyMatrix4(this.matrixWorld);const C=e.ray.origin.distanceTo(h);C<e.near||C>e.far||t.push({distance:C,point:u.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const NU=new T,jU=new T;class ws extends Nn{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)NU.fromBufferAttribute(t,r),jU.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+NU.distanceTo(jU);e.setAttribute("lineDistance",new Ge(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class rx extends Nn{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class El extends On{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new De(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const UU=new Ve,WT=new J_,sx=new Al,ox=new T;class $d extends wi{constructor(e=new xt,t=new El){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),sx.copy(n.boundingSphere),sx.applyMatrix4(r),sx.radius+=s,!1===e.ray.intersectsSphere(sx))return;UU.copy(r).invert(),WT.copy(e.ray).applyMatrix4(UU);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=n.index,u=n.attributes.position;if(null!==c)for(let m=Math.max(0,o.start),p=Math.min(c.count,o.start+o.count);m<p;m++){const g=c.getX(m);ox.fromBufferAttribute(u,g),VU(ox,g,l,r,e,t,this)}else for(let m=Math.max(0,o.start),p=Math.min(u.count,o.start+o.count);m<p;m++)ox.fromBufferAttribute(u,m),VU(ox,m,l,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function VU(i,e,t,n,r,s,o){const a=WT.distanceSqToPoint(i);if(a<t){const l=new T;WT.closestPointToPoint(i,l),l.applyMatrix4(n);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class zU extends qn{constructor(e,t,n,r,s,o,a,l,c){super(e,t,n,r,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=void 0!==o?o:Li,this.magFilter=void 0!==s?s:Li,this.generateMipmaps=!1;const d=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function u(){d.needsUpdate=!0,e.requestVideoFrameCallback(u)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e==0&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class HU extends qn{constructor(e,t,n){super({width:e,height:t}),this.isFramebufferTexture=!0,this.format=n,this.magFilter=$t,this.minFilter=$t,this.generateMipmaps=!1,this.needsUpdate=!0}}class m0 extends qn{constructor(e,t,n,r,s,o,a,l,c,d,u,h){super(null,o,a,l,c,d,r,s,u,h),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class qT extends m0{constructor(e,t,n,r,s,o){super(e,t,n,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=gr}}class ax extends qn{constructor(e,t,n,r,s,o,a,l,c){super(e,t,n,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Co{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let r=0;const s=n.length;let o;o=t||e*n[s-1];let c,a=0,l=s-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=n[r]-o,c<0)a=r+1;else{if(!(c>0)){l=r;break}l=r-1}if(r=l,n[r]===o)return r/(s-1);const d=n[r];return(r+(o-d)/(n[r+1]-d))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new ue:new T);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new T,r=[],s=[],o=[],a=new T,l=new Ve;for(let f=0;f<=e;f++)r[f]=this.getTangentAt(f/e,new T);s[0]=new T,o[0]=new T;let c=Number.MAX_VALUE;const d=Math.abs(r[0].x),u=Math.abs(r[0].y),h=Math.abs(r[0].z);d<=c&&(c=d,n.set(1,0,0)),u<=c&&(c=u,n.set(0,1,0)),h<=c&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const m=Math.acos(Wn(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(a,m))}o[f].crossVectors(r[f],s[f])}if(!0===t){let f=Math.acos(Wn(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let m=1;m<=e;m++)s[m].applyMatrix4(l.makeRotationAxis(r[m],f*m)),o[m].crossVectors(r[m],s[m])}return{tangents:r,normals:s,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class bc extends Co{constructor(e=0,t=0,n=1,r=1,s=0,o=2*Math.PI,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const n=t||new ue,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=o?0:r),!0===this.aClockwise&&!o&&(s===r?s=-r:s-=r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const d=Math.cos(this.aRotation),u=Math.sin(this.aRotation),h=l-this.aX,f=c-this.aY;l=h*d-f*u+this.aX,c=h*u+f*d+this.aY}return n.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class GU extends bc{constructor(e,t,n,r,s,o){super(e,t,n,n,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function XT(){let i=0,e=0,t=0,n=0;function r(s,o,a,l){i=s,e=a,t=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,d,u){let h=(o-s)/c-(a-s)/(c+d)+(a-o)/d,f=(a-o)/d-(l-o)/(d+u)+(l-a)/u;h*=d,f*=d,r(o,a,h,f)},calc:function(s){const o=s*s;return i+e*s+t*o+n*(o*s)}}}const lx=new T,YT=new XT,ZT=new XT,KT=new XT;class QU extends Co{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new T){const n=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let c,d,a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:0===l&&a===s-1&&(a=s-2,l=1),this.closed||a>0?c=r[(a-1)%s]:(lx.subVectors(r[0],r[1]).add(r[0]),c=lx);const u=r[a%s],h=r[(a+1)%s];if(this.closed||a+2<s?d=r[(a+2)%s]:(lx.subVectors(r[s-1],r[s-2]).add(r[s-1]),d=lx),"centripetal"===this.curveType||"chordal"===this.curveType){const f="chordal"===this.curveType?.5:.25;let m=Math.pow(c.distanceToSquared(u),f),p=Math.pow(u.distanceToSquared(h),f),g=Math.pow(h.distanceToSquared(d),f);p<1e-4&&(p=1),m<1e-4&&(m=p),g<1e-4&&(g=p),YT.initNonuniformCatmullRom(c.x,u.x,h.x,d.x,m,p,g),ZT.initNonuniformCatmullRom(c.y,u.y,h.y,d.y,m,p,g),KT.initNonuniformCatmullRom(c.z,u.z,h.z,d.z,m,p,g)}else"catmullrom"===this.curveType&&(YT.initCatmullRom(c.x,u.x,h.x,d.x,this.tension),ZT.initCatmullRom(c.y,u.y,h.y,d.y,this.tension),KT.initCatmullRom(c.z,u.z,h.z,d.z,this.tension));return n.set(YT.calc(l),ZT.calc(l),KT.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push((new T).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function WU(i,e,t,n,r){const s=.5*(n-e),o=.5*(r-t),a=i*i;return(2*t-2*n+s+o)*(i*a)+(-3*t+3*n-2*s-o)*a+s*i+t}function g0(i,e,t,n){return function Joe(i,e){const t=1-i;return t*t*e}(i,e)+function eae(i,e){return 2*(1-i)*i*e}(i,t)+function tae(i,e){return i*i*e}(i,n)}function _0(i,e,t,n,r){return function iae(i,e){const t=1-i;return t*t*t*e}(i,e)+function nae(i,e){const t=1-i;return 3*t*t*i*e}(i,t)+function rae(i,e){return 3*(1-i)*i*i*e}(i,n)+function sae(i,e){return i*i*i*e}(i,r)}class $T extends Co{constructor(e=new ue,t=new ue,n=new ue,r=new ue){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new ue){const n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(_0(e,r.x,s.x,o.x,a.x),_0(e,r.y,s.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class qU extends Co{constructor(e=new T,t=new T,n=new T,r=new T){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new T){const n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(_0(e,r.x,s.x,o.x,a.x),_0(e,r.y,s.y,o.y,a.y),_0(e,r.z,s.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class cx extends Co{constructor(e=new ue,t=new ue){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ue){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const n=t||new ue;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class XU extends Co{constructor(e=new T,t=new T){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new T){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class JT extends Co{constructor(e=new ue,t=new ue,n=new ue){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ue){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(g0(e,r.x,s.x,o.x),g0(e,r.y,s.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class eI extends Co{constructor(e=new T,t=new T,n=new T){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new T){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(g0(e,r.x,s.x,o.x),g0(e,r.y,s.y,o.y),g0(e,r.z,s.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class tI extends Co{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ue){const n=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[0===o?o:o-1],c=r[o],d=r[o>r.length-2?r.length-1:o+1],u=r[o>r.length-3?r.length-1:o+2];return n.set(WU(a,l.x,c.x,d.x,u.x),WU(a,l.y,c.y,d.y,u.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push((new ue).fromArray(r))}return this}}var iI=Object.freeze({__proto__:null,ArcCurve:GU,CatmullRomCurve3:QU,CubicBezierCurve:$T,CubicBezierCurve3:qU,EllipseCurve:bc,LineCurve:cx,LineCurve3:XU,QuadraticBezierCurve:JT,QuadraticBezierCurve3:eI,SplineCurve:tI});class YU extends Co{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new cx(t,e))}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const o=r[s]-n,a=this.curves[s],l=a.getLength();return a.getPointAt(0===l?0:1-o/l,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],l=o.getPoints(o.isEllipseCurve?2*e:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e);for(let c=0;c<l.length;c++){const d=l[c];n&&n.equals(d)||(t.push(d),n=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push((new iI[r.type]).fromJSON(r))}return this}}class b0 extends YU{constructor(e){super(),this.type="Path",this.currentPoint=new ue,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new cx(this.currentPoint.clone(),new ue(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const s=new JT(this.currentPoint.clone(),new ue(e,t),new ue(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,s,o){const a=new $T(this.currentPoint.clone(),new ue(e,t),new ue(n,r),new ue(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new tI(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,s,o){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,n,r,s,o),this}absarc(e,t,n,r,s,o){return this.absellipse(e,t,n,n,r,s,o),this}ellipse(e,t,n,r,s,o,a,l){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,n,r,s,o,a,l),this}absellipse(e,t,n,r,s,o,a,l){const c=new bc(e,t,n,r,s,o,a,l);if(this.curves.length>0){const u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);const d=c.getPoint(1);return this.currentPoint.copy(d),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Jd extends xt{constructor(e=[new ue(0,-.5),new ue(.5,0),new ue(0,.5)],t=12,n=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=Wn(r,0,2*Math.PI);const s=[],o=[],a=[],l=[],c=[],d=1/t,u=new T,h=new ue,f=new T,m=new T,p=new T;let g=0,_=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:g=e[v+1].x-e[v].x,_=e[v+1].y-e[v].y,f.x=1*_,f.y=-g,f.z=0*_,p.copy(f),f.normalize(),l.push(f.x,f.y,f.z);break;case e.length-1:l.push(p.x,p.y,p.z);break;default:g=e[v+1].x-e[v].x,_=e[v+1].y-e[v].y,f.x=1*_,f.y=-g,f.z=0*_,m.copy(f),f.x+=p.x,f.y+=p.y,f.z+=p.z,f.normalize(),l.push(f.x,f.y,f.z),p.copy(m)}for(let v=0;v<=t;v++){const b=n+v*d*r,y=Math.sin(b),x=Math.cos(b);for(let C=0;C<=e.length-1;C++)u.x=e[C].x*y,u.y=e[C].y,u.z=e[C].x*x,o.push(u.x,u.y,u.z),h.x=v/t,h.y=C/(e.length-1),a.push(h.x,h.y),c.push(l[3*C+0]*y,l[3*C+1],l[3*C+0]*x)}for(let v=0;v<t;v++)for(let b=0;b<e.length-1;b++){const y=b+v*e.length,C=y+e.length,M=y+e.length+1,w=y+1;s.push(y,C,w),s.push(M,w,C)}this.setIndex(s),this.setAttribute("position",new Ge(o,3)),this.setAttribute("uv",new Ge(a,2)),this.setAttribute("normal",new Ge(c,3))}static fromJSON(e){return new Jd(e.points,e.segments,e.phiStart,e.phiLength)}}class Zf extends Jd{constructor(e=1,t=1,n=4,r=8){const s=new b0;s.absarc(0,-t/2,e,1.5*Math.PI,0),s.absarc(0,t/2,e,0,.5*Math.PI),super(s.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r}}static fromJSON(e){return new Zf(e.radius,e.length,e.capSegments,e.radialSegments)}}class Kf extends xt{constructor(e=1,t=32,n=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],l=[],c=new T,d=new ue;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let u=0,h=3;u<=t;u++,h+=3){const f=n+u/t*r;c.x=e*Math.cos(f),c.y=e*Math.sin(f),o.push(c.x,c.y,c.z),a.push(0,0,1),d.x=(o[h]/e+1)/2,d.y=(o[h+1]/e+1)/2,l.push(d.x,d.y)}for(let u=1;u<=t;u++)s.push(u,u+1,0);this.setIndex(s),this.setAttribute("position",new Ge(o,3)),this.setAttribute("normal",new Ge(a,3)),this.setAttribute("uv",new Ge(l,2))}static fromJSON(e){return new Kf(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class jn extends xt{constructor(e=1,t=1,n=1,r=32,s=1,o=!1,a=0,l=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const d=[],u=[],h=[],f=[];let m=0;const p=[],g=n/2;let _=0;function b(y){const x=m,C=new ue,M=new T;let w=0;const E=!0===y?e:t,I=!0===y?1:-1;for(let Q=1;Q<=r;Q++)u.push(0,g*I,0),h.push(0,I,0),f.push(.5,.5),m++;const F=m;for(let Q=0;Q<=r;Q++){const L=Q/r*l+a,X=Math.cos(L),P=Math.sin(L);M.x=E*P,M.y=g*I,M.z=E*X,u.push(M.x,M.y,M.z),h.push(0,I,0),C.x=.5*X+.5,C.y=.5*P*I+.5,f.push(C.x,C.y),m++}for(let Q=0;Q<r;Q++){const B=x+Q,L=F+Q;!0===y?d.push(L,L+1,B):d.push(L+1,L,B),w+=3}c.addGroup(_,w,!0===y?1:2),_+=w}(function v(){const y=new T,x=new T;let C=0;const M=(t-e)/n;for(let w=0;w<=s;w++){const E=[],I=w/s,F=I*(t-e)+e;for(let Q=0;Q<=r;Q++){const B=Q/r,L=B*l+a,X=Math.sin(L),P=Math.cos(L);x.x=F*X,x.y=-I*n+g,x.z=F*P,u.push(x.x,x.y,x.z),y.set(X,M,P).normalize(),h.push(y.x,y.y,y.z),f.push(B,1-I),E.push(m++)}p.push(E)}for(let w=0;w<r;w++)for(let E=0;E<s;E++){const F=p[E+1][w],Q=p[E+1][w+1],B=p[E][w+1];d.push(p[E][w],F,B),d.push(F,Q,B),C+=6}c.addGroup(_,C,0),_+=C})(),!1===o&&(e>0&&b(!0),t>0&&b(!1)),this.setIndex(d),this.setAttribute("position",new Ge(u,3)),this.setAttribute("normal",new Ge(h,3)),this.setAttribute("uv",new Ge(f,2))}static fromJSON(e){return new jn(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class $f extends jn{constructor(e=1,t=1,n=32,r=1,s=!1,o=0,a=2*Math.PI){super(0,e,t,n,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new $f(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Fa extends xt{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const s=[],o=[];function l(v,b,y,x){const C=x+1,M=[];for(let w=0;w<=C;w++){M[w]=[];const E=v.clone().lerp(y,w/C),I=b.clone().lerp(y,w/C),F=C-w;for(let Q=0;Q<=F;Q++)M[w][Q]=0===Q&&w===C?E:E.clone().lerp(I,Q/F)}for(let w=0;w<C;w++)for(let E=0;E<2*(C-w)-1;E++){const I=Math.floor(E/2);E%2==0?(h(M[w][I+1]),h(M[w+1][I]),h(M[w][I])):(h(M[w][I+1]),h(M[w+1][I+1]),h(M[w+1][I]))}}function h(v){s.push(v.x,v.y,v.z)}function f(v,b){const y=3*v;b.x=e[y+0],b.y=e[y+1],b.z=e[y+2]}function p(v,b,y,x){x<0&&1===v.x&&(o[b]=v.x-1),0===y.x&&0===y.z&&(o[b]=x/2/Math.PI+.5)}function g(v){return Math.atan2(v.z,-v.x)}function _(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}(function a(v){const b=new T,y=new T,x=new T;for(let C=0;C<t.length;C+=3)f(t[C+0],b),f(t[C+1],y),f(t[C+2],x),l(b,y,x,v)})(r),function c(v){const b=new T;for(let y=0;y<s.length;y+=3)b.x=s[y+0],b.y=s[y+1],b.z=s[y+2],b.normalize().multiplyScalar(v),s[y+0]=b.x,s[y+1]=b.y,s[y+2]=b.z}(n),function d(){const v=new T;for(let b=0;b<s.length;b+=3){v.x=s[b+0],v.y=s[b+1],v.z=s[b+2];const y=g(v)/2/Math.PI+.5,x=_(v)/Math.PI+.5;o.push(y,1-x)}(function m(){const v=new T,b=new T,y=new T,x=new T,C=new ue,M=new ue,w=new ue;for(let E=0,I=0;E<s.length;E+=9,I+=6){v.set(s[E+0],s[E+1],s[E+2]),b.set(s[E+3],s[E+4],s[E+5]),y.set(s[E+6],s[E+7],s[E+8]),C.set(o[I+0],o[I+1]),M.set(o[I+2],o[I+3]),w.set(o[I+4],o[I+5]),x.copy(v).add(b).add(y).divideScalar(3);const F=g(x);p(C,I+0,v,F),p(M,I+2,b,F),p(w,I+4,y,F)}})(),function u(){for(let v=0;v<o.length;v+=6){const b=o[v+0],y=o[v+2],x=o[v+4],C=Math.max(b,y,x),M=Math.min(b,y,x);C>.9&&M<.1&&(b<.2&&(o[v+0]+=1),y<.2&&(o[v+2]+=1),x<.2&&(o[v+4]+=1))}}()}(),this.setAttribute("position",new Ge(s,3)),this.setAttribute("normal",new Ge(s.slice(),3)),this.setAttribute("uv",new Ge(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new Fa(e.vertices,e.indices,e.radius,e.details)}}class Jf extends Fa{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Jf(e.radius,e.detail)}}const dx=new T,ux=new T,nI=new T,hx=new Js;class rI extends xt{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const r=Math.pow(10,4),s=Math.cos(Vd*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],d=["a","b","c"],u=new Array(3),h={},f=[];for(let m=0;m<l;m+=3){o?(c[0]=o.getX(m),c[1]=o.getX(m+1),c[2]=o.getX(m+2)):(c[0]=m,c[1]=m+1,c[2]=m+2);const{a:p,b:g,c:_}=hx;if(p.fromBufferAttribute(a,c[0]),g.fromBufferAttribute(a,c[1]),_.fromBufferAttribute(a,c[2]),hx.getNormal(nI),u[0]=`${Math.round(p.x*r)},${Math.round(p.y*r)},${Math.round(p.z*r)}`,u[1]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,u[2]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,u[0]!==u[1]&&u[1]!==u[2]&&u[2]!==u[0])for(let v=0;v<3;v++){const b=(v+1)%3,y=u[v],x=u[b],C=hx[d[v]],M=hx[d[b]],w=`${y}_${x}`,E=`${x}_${y}`;E in h&&h[E]?(nI.dot(h[E].normal)<=s&&(f.push(C.x,C.y,C.z),f.push(M.x,M.y,M.z)),h[E]=null):w in h||(h[w]={index0:c[v],index1:c[b],normal:nI.clone()})}}for(const m in h)if(h[m]){const{index0:p,index1:g}=h[m];dx.fromBufferAttribute(a,p),ux.fromBufferAttribute(a,g),f.push(dx.x,dx.y,dx.z),f.push(ux.x,ux.y,ux.z)}this.setAttribute("position",new Ge(f,3))}}}class eu extends b0{constructor(e){super(e),this.uuid=Zs(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push((new b0).fromJSON(r))}return this}}function ZU(i,e,t,n,r){let s,o;if(r===function xae(i,e,t,n){let r=0;for(let s=e,o=t-n;s<t;s+=n)r+=(i[o]-i[s])*(i[s+1]+i[o+1]),o=s;return r}(i,e,t,n)>0)for(s=e;s<t;s+=n)o=JU(s,i[s],i[s+1],o);else for(s=t-n;s>=e;s-=n)o=JU(s,i[s],i[s+1],o);return o&&fx(o,o.next)&&(A0(o),o=o.next),o}function tu(i,e){if(!i)return i;e||(e=i);let n,t=i;do{if(n=!1,t.steiner||!fx(t,t.next)&&0!==Tn(t.prev,t,t.next))t=t.next;else{if(A0(t),t=e=t.prev,t===t.next)break;n=!0}}while(n||t!==e);return e}function v0(i,e,t,n,r,s,o){if(!i)return;!o&&s&&function gae(i,e,t,n){let r=i;do{0===r.z&&(r.z=sI(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,function _ae(i){let e,t,n,r,s,o,a,l,c=1;do{for(t=i,i=null,s=null,o=0;t;){for(o++,n=t,a=0,e=0;e<c&&(a++,n=n.nextZ,n);e++);for(l=c;a>0||l>0&&n;)0!==a&&(0===l||!n||t.z<=n.z)?(r=t,t=t.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;t=n}s.nextZ=null,c*=2}while(o>1)}(r)}(i,n,r,s);let l,c,a=i;for(;i.prev!==i.next;)if(l=i.prev,c=i.next,s?lae(i,n,r,s):aae(i))e.push(l.i/t|0),e.push(i.i/t|0),e.push(c.i/t|0),A0(i),i=c.next,a=c.next;else if((i=c)===a){o?1===o?v0(i=cae(tu(i),e,t),e,t,n,r,s,2):2===o&&dae(i,e,t,n,r,s):v0(tu(i),e,t,n,r,s,1);break}}function aae(i){const e=i.prev,t=i,n=i.next;if(Tn(e,t,n)>=0)return!1;const r=e.x,s=t.x,o=n.x,a=e.y,l=t.y,c=n.y,d=r<s?r<o?r:o:s<o?s:o,u=a<l?a<c?a:c:l<c?l:c,h=r>s?r>o?r:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c;let m=n.next;for(;m!==e;){if(m.x>=d&&m.x<=h&&m.y>=u&&m.y<=f&&ep(r,a,s,l,o,c,m.x,m.y)&&Tn(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function lae(i,e,t,n){const r=i.prev,s=i,o=i.next;if(Tn(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,d=r.y,u=s.y,h=o.y,f=a<l?a<c?a:c:l<c?l:c,m=d<u?d<h?d:h:u<h?u:h,p=a>l?a>c?a:c:l>c?l:c,g=d>u?d>h?d:h:u>h?u:h,_=sI(f,m,e,t,n),v=sI(p,g,e,t,n);let b=i.prevZ,y=i.nextZ;for(;b&&b.z>=_&&y&&y.z<=v;){if(b.x>=f&&b.x<=p&&b.y>=m&&b.y<=g&&b!==r&&b!==o&&ep(a,d,l,u,c,h,b.x,b.y)&&Tn(b.prev,b,b.next)>=0||(b=b.prevZ,y.x>=f&&y.x<=p&&y.y>=m&&y.y<=g&&y!==r&&y!==o&&ep(a,d,l,u,c,h,y.x,y.y)&&Tn(y.prev,y,y.next)>=0))return!1;y=y.nextZ}for(;b&&b.z>=_;){if(b.x>=f&&b.x<=p&&b.y>=m&&b.y<=g&&b!==r&&b!==o&&ep(a,d,l,u,c,h,b.x,b.y)&&Tn(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;y&&y.z<=v;){if(y.x>=f&&y.x<=p&&y.y>=m&&y.y<=g&&y!==r&&y!==o&&ep(a,d,l,u,c,h,y.x,y.y)&&Tn(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function cae(i,e,t){let n=i;do{const r=n.prev,s=n.next.next;!fx(r,s)&&KU(r,n,n.next,s)&&y0(r,s)&&y0(s,r)&&(e.push(r.i/t|0),e.push(n.i/t|0),e.push(s.i/t|0),A0(n),A0(n.next),n=i=s),n=n.next}while(n!==i);return tu(n)}function dae(i,e,t,n,r,s){let o=i;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&vae(o,a)){let l=$U(o,a);return o=tu(o,o.next),l=tu(l,l.next),v0(o,e,t,n,r,s,0),void v0(l,e,t,n,r,s,0)}a=a.next}o=o.next}while(o!==i)}function hae(i,e){return i.x-e.x}function fae(i,e){const t=function pae(i,e){let r,t=e,n=-1/0;const s=i.x,o=i.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const h=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(h<=s&&h>n&&(n=h,r=t.x<t.next.x?t:t.next,h===s))return r}t=t.next}while(t!==e);if(!r)return null;const a=r,l=r.x,c=r.y;let u,d=1/0;t=r;do{s>=t.x&&t.x>=l&&s!==t.x&&ep(o<c?s:n,o,l,c,o<c?n:s,o,t.x,t.y)&&(u=Math.abs(o-t.y)/(s-t.x),y0(t,i)&&(u<d||u===d&&(t.x>r.x||t.x===r.x&&mae(r,t)))&&(r=t,d=u)),t=t.next}while(t!==a);return r}(i,e);if(!t)return e;const n=$U(t,i);return tu(n,n.next),tu(t,t.next)}function mae(i,e){return Tn(i.prev,i,e.prev)<0&&Tn(e.next,i,i.next)<0}function sI(i,e,t,n,r){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-t)*r|0)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function bae(i){let e=i,t=i;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==i);return t}function ep(i,e,t,n,r,s,o,a){return(r-o)*(e-a)>=(i-o)*(s-a)&&(i-o)*(n-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(n-a)}function vae(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function yae(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&KU(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}(i,e)&&(y0(i,e)&&y0(e,i)&&function Aae(i,e){let t=i,n=!1;const r=(i.x+e.x)/2,s=(i.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next}while(t!==i);return n}(i,e)&&(Tn(i.prev,i,e.prev)||Tn(i,e.prev,e))||fx(i,e)&&Tn(i.prev,i,i.next)>0&&Tn(e.prev,e,e.next)>0)}function Tn(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function fx(i,e){return i.x===e.x&&i.y===e.y}function KU(i,e,t,n){const r=mx(Tn(i,e,t)),s=mx(Tn(i,e,n)),o=mx(Tn(t,n,i)),a=mx(Tn(t,n,e));return!!(r!==s&&o!==a||0===r&&px(i,t,e)||0===s&&px(i,n,e)||0===o&&px(t,i,n)||0===a&&px(t,e,n))}function px(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function mx(i){return i>0?1:i<0?-1:0}function y0(i,e){return Tn(i.prev,i,i.next)<0?Tn(i,e,i.next)>=0&&Tn(i,i.prev,e)>=0:Tn(i,e,i.prev)<0||Tn(i,i.next,e)<0}function $U(i,e){const t=new oI(i.i,i.x,i.y),n=new oI(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function JU(i,e,t,n){const r=new oI(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function A0(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function oI(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Ba{static area(e){const t=e.length;let n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*n}static isClockWise(e){return Ba.area(e)<0}static triangulateShape(e,t){const n=[],r=[],s=[];e4(e),t4(n,e);let o=e.length;t.forEach(e4);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,t4(n,t[l]);const a=function(i,e,t=2){const n=e&&e.length,r=n?e[0]*t:i.length;let s=ZU(i,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,d,u,h,f;if(n&&(s=function uae(i,e,t,n){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:i.length,c=ZU(i,a,l,n,!1),c===c.next&&(c.steiner=!0),r.push(bae(c));for(r.sort(hae),s=0;s<r.length;s++)t=fae(r[s],t);return t}(i,e,s,t)),i.length>80*t){a=c=i[0],l=d=i[1];for(let m=t;m<r;m+=t)u=i[m],h=i[m+1],u<a&&(a=u),h<l&&(l=h),u>c&&(c=u),h>d&&(d=h);f=Math.max(c-a,d-l),f=0!==f?32767/f:0}return v0(s,o,t,a,l,f,0),o}(n,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function e4(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function t4(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class iu extends xt{constructor(e=new eu([new ue(.5,.5),new ue(-.5,.5),new ue(-.5,-.5),new ue(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++)o(e[a]);function o(a){const l=[],c=void 0!==t.curveSegments?t.curveSegments:12,d=void 0!==t.steps?t.steps:1,u=void 0!==t.depth?t.depth:1;let h=void 0===t.bevelEnabled||t.bevelEnabled,f=void 0!==t.bevelThickness?t.bevelThickness:.2,m=void 0!==t.bevelSize?t.bevelSize:f-.1,p=void 0!==t.bevelOffset?t.bevelOffset:0,g=void 0!==t.bevelSegments?t.bevelSegments:3;const _=t.extrudePath,v=void 0!==t.UVGenerator?t.UVGenerator:wae;let b,x,C,M,w,y=!1;_&&(b=_.getSpacedPoints(d),y=!0,h=!1,x=_.computeFrenetFrames(d,!1),C=new T,M=new T,w=new T),h||(g=0,f=0,m=0,p=0);const E=a.extractPoints(c);let I=E.shape;const F=E.holes;if(!Ba.isClockWise(I)){I=I.reverse();for(let Ae=0,xe=F.length;Ae<xe;Ae++){const Pe=F[Ae];Ba.isClockWise(Pe)&&(F[Ae]=Pe.reverse())}}const B=Ba.triangulateShape(I,F),L=I;for(let Ae=0,xe=F.length;Ae<xe;Ae++)I=I.concat(F[Ae]);function X(Ae,xe,Pe){return xe||console.error("THREE.ExtrudeGeometry: vec does not exist"),xe.clone().multiplyScalar(Pe).add(Ae)}const P=I.length,V=B.length;function O(Ae,xe,Pe){let $e,We,yt;const ht=Ae.x-xe.x,ot=Ae.y-xe.y,St=Pe.x-Ae.x,ft=Pe.y-Ae.y,N=ht*ht+ot*ot;if(Math.abs(ht*ft-ot*St)>Number.EPSILON){const _e=Math.sqrt(N),Se=Math.sqrt(St*St+ft*ft),Ue=xe.x-ot/_e,Ze=xe.y+ht/_e,te=((Pe.x-ft/Se-Ue)*ft-(Pe.y+St/Se-Ze)*St)/(ht*ft-ot*St);$e=Ue+ht*te-Ae.x,We=Ze+ot*te-Ae.y;const tt=$e*$e+We*We;if(tt<=2)return new ue($e,We);yt=Math.sqrt(tt/2)}else{let _e=!1;ht>Number.EPSILON?St>Number.EPSILON&&(_e=!0):ht<-Number.EPSILON?St<-Number.EPSILON&&(_e=!0):Math.sign(ot)===Math.sign(ft)&&(_e=!0),_e?($e=-ot,We=ht,yt=Math.sqrt(N)):($e=ht,We=ot,yt=Math.sqrt(N/2))}return new ue($e/yt,We/yt)}const q=[];for(let Ae=0,xe=L.length,Pe=xe-1,$e=Ae+1;Ae<xe;Ae++,Pe++,$e++)Pe===xe&&(Pe=0),$e===xe&&($e=0),q[Ae]=O(L[Ae],L[Pe],L[$e]);const ee=[];let Z,Y=q.concat();for(let Ae=0,xe=F.length;Ae<xe;Ae++){const Pe=F[Ae];Z=[];for(let $e=0,We=Pe.length,yt=We-1,ht=$e+1;$e<We;$e++,yt++,ht++)yt===We&&(yt=0),ht===We&&(ht=0),Z[$e]=O(Pe[$e],Pe[yt],Pe[ht]);ee.push(Z),Y=Y.concat(Z)}for(let Ae=0;Ae<g;Ae++){const xe=Ae/g,Pe=f*Math.cos(xe*Math.PI/2),$e=m*Math.sin(xe*Math.PI/2)+p;for(let We=0,yt=L.length;We<yt;We++){const ht=X(L[We],q[We],$e);U(ht.x,ht.y,-Pe)}for(let We=0,yt=F.length;We<yt;We++){const ht=F[We];Z=ee[We];for(let ot=0,St=ht.length;ot<St;ot++){const ft=X(ht[ot],Z[ot],$e);U(ft.x,ft.y,-Pe)}}}const he=m+p;for(let Ae=0;Ae<P;Ae++){const xe=h?X(I[Ae],Y[Ae],he):I[Ae];y?(M.copy(x.normals[0]).multiplyScalar(xe.x),C.copy(x.binormals[0]).multiplyScalar(xe.y),w.copy(b[0]).add(M).add(C),U(w.x,w.y,w.z)):U(xe.x,xe.y,0)}for(let Ae=1;Ae<=d;Ae++)for(let xe=0;xe<P;xe++){const Pe=h?X(I[xe],Y[xe],he):I[xe];y?(M.copy(x.normals[Ae]).multiplyScalar(Pe.x),C.copy(x.binormals[Ae]).multiplyScalar(Pe.y),w.copy(b[Ae]).add(M).add(C),U(w.x,w.y,w.z)):U(Pe.x,Pe.y,u/d*Ae)}for(let Ae=g-1;Ae>=0;Ae--){const xe=Ae/g,Pe=f*Math.cos(xe*Math.PI/2),$e=m*Math.sin(xe*Math.PI/2)+p;for(let We=0,yt=L.length;We<yt;We++){const ht=X(L[We],q[We],$e);U(ht.x,ht.y,u+Pe)}for(let We=0,yt=F.length;We<yt;We++){const ht=F[We];Z=ee[We];for(let ot=0,St=ht.length;ot<St;ot++){const ft=X(ht[ot],Z[ot],$e);y?U(ft.x,ft.y+b[d-1].y,b[d-1].x+Pe):U(ft.x,ft.y,u+Pe)}}}function G(Ae,xe){let Pe=Ae.length;for(;--Pe>=0;){const $e=Pe;let We=Pe-1;We<0&&(We=Ae.length-1);for(let yt=0,ht=d+2*g;yt<ht;yt++){const ot=P*yt,St=P*(yt+1);Ee(xe+$e+ot,xe+We+ot,xe+We+St,xe+$e+St)}}}function U(Ae,xe,Pe){l.push(Ae),l.push(xe),l.push(Pe)}function de(Ae,xe,Pe){we(Ae),we(xe),we(Pe);const $e=r.length/3,We=v.generateTopUV(n,r,$e-3,$e-2,$e-1);et(We[0]),et(We[1]),et(We[2])}function Ee(Ae,xe,Pe,$e){we(Ae),we(xe),we($e),we(xe),we(Pe),we($e);const We=r.length/3,yt=v.generateSideWallUV(n,r,We-6,We-3,We-2,We-1);et(yt[0]),et(yt[1]),et(yt[3]),et(yt[1]),et(yt[2]),et(yt[3])}function we(Ae){r.push(l[3*Ae+0]),r.push(l[3*Ae+1]),r.push(l[3*Ae+2])}function et(Ae){s.push(Ae.x),s.push(Ae.y)}(function J(){const Ae=r.length/3;if(h){let xe=0,Pe=P*xe;for(let $e=0;$e<V;$e++){const We=B[$e];de(We[2]+Pe,We[1]+Pe,We[0]+Pe)}xe=d+2*g,Pe=P*xe;for(let $e=0;$e<V;$e++){const We=B[$e];de(We[0]+Pe,We[1]+Pe,We[2]+Pe)}}else{for(let xe=0;xe<V;xe++){const Pe=B[xe];de(Pe[2],Pe[1],Pe[0])}for(let xe=0;xe<V;xe++){const Pe=B[xe];de(Pe[0]+P*d,Pe[1]+P*d,Pe[2]+P*d)}}n.addGroup(Ae,r.length/3-Ae,0)})(),function ae(){const Ae=r.length/3;let xe=0;G(L,xe),xe+=L.length;for(let Pe=0,$e=F.length;Pe<$e;Pe++){const We=F[Pe];G(We,xe),xe+=We.length}n.addGroup(Ae,r.length/3-Ae,1)}()}this.setAttribute("position",new Ge(r,3)),this.setAttribute("uv",new Ge(s,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function Cae(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++)t.shapes.push(i[n].uuid);else t.shapes.push(i.uuid);return t.options=Object.assign({},e),void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let s=0,o=e.shapes.length;s<o;s++)n.push(t[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new iI[r.type]).fromJSON(r)),new iu(n,e.options)}}const wae={generateTopUV:function(i,e,t,n,r){const a=e[3*n],l=e[3*n+1],c=e[3*r],d=e[3*r+1];return[new ue(e[3*t],e[3*t+1]),new ue(a,l),new ue(c,d)]},generateSideWallUV:function(i,e,t,n,r,s){const o=e[3*t],a=e[3*t+1],l=e[3*t+2],c=e[3*n],d=e[3*n+1],u=e[3*n+2],h=e[3*r],f=e[3*r+1],m=e[3*r+2],p=e[3*s],g=e[3*s+1],_=e[3*s+2];return Math.abs(a-d)<Math.abs(o-c)?[new ue(o,1-l),new ue(c,1-u),new ue(h,1-m),new ue(p,1-_)]:[new ue(a,1-l),new ue(d,1-u),new ue(f,1-m),new ue(g,1-_)]}};class tp extends Fa{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new tp(e.radius,e.detail)}}class ia extends Fa{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new ia(e.radius,e.detail)}}class ip extends xt{constructor(e=.5,t=1,n=32,r=1,s=0,o=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:o},n=Math.max(3,n);const a=[],l=[],c=[],d=[];let u=e;const h=(t-e)/(r=Math.max(1,r)),f=new T,m=new ue;for(let p=0;p<=r;p++){for(let g=0;g<=n;g++){const _=s+g/n*o;f.x=u*Math.cos(_),f.y=u*Math.sin(_),l.push(f.x,f.y,f.z),c.push(0,0,1),m.x=(f.x/t+1)/2,m.y=(f.y/t+1)/2,d.push(m.x,m.y)}u+=h}for(let p=0;p<r;p++){const g=p*(n+1);for(let _=0;_<n;_++){const v=_+g,y=v+n+1,x=v+n+2,C=v+1;a.push(v,y,C),a.push(y,x,C)}}this.setIndex(a),this.setAttribute("position",new Ge(l,3)),this.setAttribute("normal",new Ge(c,3)),this.setAttribute("uv",new Ge(d,2))}static fromJSON(e){return new ip(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class np extends xt{constructor(e=new eu([new ue(0,.5),new ue(-.5,-.5),new ue(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],s=[],o=[];let a=0,l=0;if(!1===Array.isArray(e))c(e);else for(let d=0;d<e.length;d++)c(e[d]),this.addGroup(a,l,d),a+=l,l=0;function c(d){const u=r.length/3,h=d.extractPoints(t);let f=h.shape;const m=h.holes;!1===Ba.isClockWise(f)&&(f=f.reverse());for(let g=0,_=m.length;g<_;g++){const v=m[g];!0===Ba.isClockWise(v)&&(m[g]=v.reverse())}const p=Ba.triangulateShape(f,m);for(let g=0,_=m.length;g<_;g++)f=f.concat(m[g]);for(let g=0,_=f.length;g<_;g++){const v=f[g];r.push(v.x,v.y,0),s.push(0,0,1),o.push(v.x,v.y)}for(let g=0,_=p.length;g<_;g++){const v=p[g];n.push(v[0]+u,v[1]+u,v[2]+u),l+=3}}this.setIndex(n),this.setAttribute("position",new Ge(r,3)),this.setAttribute("normal",new Ge(s,3)),this.setAttribute("uv",new Ge(o,2))}toJSON(){const e=super.toJSON();return function Mae(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++)e.shapes.push(i[t].uuid);else e.shapes.push(i.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++)n.push(t[e.shapes[r]]);return new np(n,e.curveSegments)}}class vc extends xt{constructor(e=1,t=32,n=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const l=Math.min(o+a,Math.PI);let c=0;const d=[],u=new T,h=new T,f=[],m=[],p=[],g=[];for(let _=0;_<=n;_++){const v=[],b=_/n;let y=0;0==_&&0==o?y=.5/t:_==n&&l==Math.PI&&(y=-.5/t);for(let x=0;x<=t;x++){const C=x/t;u.x=-e*Math.cos(r+C*s)*Math.sin(o+b*a),u.y=e*Math.cos(o+b*a),u.z=e*Math.sin(r+C*s)*Math.sin(o+b*a),m.push(u.x,u.y,u.z),h.copy(u).normalize(),p.push(h.x,h.y,h.z),g.push(C+y,1-b),v.push(c++)}d.push(v)}for(let _=0;_<n;_++)for(let v=0;v<t;v++){const y=d[_][v],x=d[_+1][v],C=d[_+1][v+1];(0!==_||o>0)&&f.push(d[_][v+1],y,C),(_!==n-1||l<Math.PI)&&f.push(y,x,C)}this.setIndex(f),this.setAttribute("position",new Ge(m,3)),this.setAttribute("normal",new Ge(p,3)),this.setAttribute("uv",new Ge(g,2))}static fromJSON(e){return new vc(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class rp extends Fa{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new rp(e.radius,e.detail)}}class na extends xt{constructor(e=1,t=.4,n=12,r=48,s=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:s},n=Math.floor(n),r=Math.floor(r);const o=[],a=[],l=[],c=[],d=new T,u=new T,h=new T;for(let f=0;f<=n;f++)for(let m=0;m<=r;m++){const p=m/r*s,g=f/n*Math.PI*2;u.x=(e+t*Math.cos(g))*Math.cos(p),u.y=(e+t*Math.cos(g))*Math.sin(p),u.z=t*Math.sin(g),a.push(u.x,u.y,u.z),d.x=e*Math.cos(p),d.y=e*Math.sin(p),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(m/r),c.push(f/n)}for(let f=1;f<=n;f++)for(let m=1;m<=r;m++){const g=(r+1)*(f-1)+m-1,_=(r+1)*(f-1)+m,v=(r+1)*f+m;o.push((r+1)*f+m-1,g,v),o.push(g,_,v)}this.setIndex(o),this.setAttribute("position",new Ge(a,3)),this.setAttribute("normal",new Ge(l,3)),this.setAttribute("uv",new Ge(c,2))}static fromJSON(e){return new na(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class sp extends xt{constructor(e=1,t=.4,n=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:s,q:o},n=Math.floor(n),r=Math.floor(r);const a=[],l=[],c=[],d=[],u=new T,h=new T,f=new T,m=new T,p=new T,g=new T,_=new T;for(let b=0;b<=n;++b){const y=b/n*s*Math.PI*2;v(y,s,o,e,f),v(y+.01,s,o,e,m),g.subVectors(m,f),_.addVectors(m,f),p.crossVectors(g,_),_.crossVectors(p,g),p.normalize(),_.normalize();for(let x=0;x<=r;++x){const C=x/r*Math.PI*2,M=-t*Math.cos(C),w=t*Math.sin(C);u.x=f.x+(M*_.x+w*p.x),u.y=f.y+(M*_.y+w*p.y),u.z=f.z+(M*_.z+w*p.z),l.push(u.x,u.y,u.z),h.subVectors(u,f).normalize(),c.push(h.x,h.y,h.z),d.push(b/n),d.push(x/r)}}for(let b=1;b<=n;b++)for(let y=1;y<=r;y++){const C=(r+1)*b+(y-1),M=(r+1)*b+y,w=(r+1)*(b-1)+y;a.push((r+1)*(b-1)+(y-1),C,w),a.push(C,M,w)}function v(b,y,x,C,M){const w=Math.cos(b),E=Math.sin(b),I=x/y*b,F=Math.cos(I);M.x=C*(2+F)*.5*w,M.y=C*(2+F)*E*.5,M.z=C*Math.sin(I)*.5}this.setIndex(a),this.setAttribute("position",new Ge(l,3)),this.setAttribute("normal",new Ge(c,3)),this.setAttribute("uv",new Ge(d,2))}static fromJSON(e){return new sp(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class op extends xt{constructor(e=new eI(new T(-1,-1,0),new T(-1,1,0),new T(1,1,0)),t=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new T,l=new T,c=new ue;let d=new T;const u=[],h=[],f=[],m=[];function g(b){d=e.getPointAt(b/t,d);const y=o.normals[b],x=o.binormals[b];for(let C=0;C<=r;C++){const M=C/r*Math.PI*2,w=Math.sin(M),E=-Math.cos(M);l.x=E*y.x+w*x.x,l.y=E*y.y+w*x.y,l.z=E*y.z+w*x.z,l.normalize(),h.push(l.x,l.y,l.z),a.x=d.x+n*l.x,a.y=d.y+n*l.y,a.z=d.z+n*l.z,u.push(a.x,a.y,a.z)}}(function p(){for(let b=0;b<t;b++)g(b);g(!1===s?t:0),function v(){for(let b=0;b<=t;b++)for(let y=0;y<=r;y++)c.x=b/t,c.y=y/r,f.push(c.x,c.y)}(),function _(){for(let b=1;b<=t;b++)for(let y=1;y<=r;y++){const C=(r+1)*b+(y-1),M=(r+1)*b+y,w=(r+1)*(b-1)+y;m.push((r+1)*(b-1)+(y-1),C,w),m.push(C,M,w)}}()})(),this.setIndex(m),this.setAttribute("position",new Ge(u,3)),this.setAttribute("normal",new Ge(h,3)),this.setAttribute("uv",new Ge(f,2))}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new op((new iI[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class aI extends xt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,r=new T,s=new T;if(null!==e.index){const o=e.attributes.position,a=e.index;let l=e.groups;0===l.length&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,d=l.length;c<d;++c){const u=l[c],h=u.start;for(let m=h,p=h+u.count;m<p;m+=3)for(let g=0;g<3;g++){const _=a.getX(m+g),v=a.getX(m+(g+1)%3);r.fromBufferAttribute(o,_),s.fromBufferAttribute(o,v),!0===n4(r,s,n)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const u=3*a+(c+1)%3;r.fromBufferAttribute(o,3*a+c),s.fromBufferAttribute(o,u),!0===n4(r,s,n)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Ge(t,3))}}}function n4(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return!0!==t.has(n)&&!0!==t.has(r)&&(t.add(n),t.add(r),!0)}var r4=Object.freeze({__proto__:null,BoxGeometry:Ki,CapsuleGeometry:Zf,CircleGeometry:Kf,ConeGeometry:$f,CylinderGeometry:jn,DodecahedronGeometry:Jf,EdgesGeometry:rI,ExtrudeGeometry:iu,IcosahedronGeometry:tp,LatheGeometry:Jd,OctahedronGeometry:ia,PlaneGeometry:gc,PolyhedronGeometry:Fa,RingGeometry:ip,ShapeGeometry:np,SphereGeometry:vc,TetrahedronGeometry:rp,TorusGeometry:na,TorusKnotGeometry:sp,TubeGeometry:op,WireframeGeometry:aI});class lI extends On{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new De(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class cI extends Rt{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class La extends On{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new De(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new De(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=uc,this.normalScale=new ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Oa extends La{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ue(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Wn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new De(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new De(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new De(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class nu extends On{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new De(16777215),this.specular=new De(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new De(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=uc,this.normalScale=new ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=N_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class dI extends On{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new De(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new De(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=uc,this.normalScale=new ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class ap extends On{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=uc,this.normalScale=new ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class gx extends On{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new De(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new De(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=uc,this.normalScale=new ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=N_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class uI extends On{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new De(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=uc,this.normalScale=new ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class hI extends pn{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Mo(i,e,t){return fI(i)?new i.constructor(i.subarray(e,void 0!==t?t:i.length)):i.slice(e,t)}function ru(i,e,t){return!i||!t&&i.constructor===e?i:"number"==typeof e.BYTES_PER_ELEMENT?new e(i):Array.prototype.slice.call(i)}function fI(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function s4(i){const t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(function e(r,s){return i[r]-i[s]}),n}function pI(i,e,t){const n=i.length,r=new i.constructor(n);for(let s=0,o=0;o!==n;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=i[a+l]}return r}function mI(i,e,t,n){let r=1,s=i[0];for(;void 0!==s&&void 0===s[n];)s=i[r++];if(void 0===s)return;let o=s[n];if(void 0!==o)if(Array.isArray(o))do{o=s[n],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=i[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[n],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=i[r++]}while(void 0!==s);else do{o=s[n],void 0!==o&&(e.push(s.time),t.push(o)),s=i[r++]}while(void 0!==s)}var Tae=Object.freeze({__proto__:null,arraySlice:Mo,convertArray:ru,isTypedArray:fI,getKeyframeOrder:s4,sortedArray:pI,flattenJSON:mI,subclip:function Eae(i,e,t,n,r=30){const s=i.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],d=c.getValueSize(),u=[],h=[];for(let f=0;f<c.times.length;++f){const m=c.times[f]*r;if(!(m<t||m>=n)){u.push(c.times[f]);for(let p=0;p<d;++p)h.push(c.values[f*d+p])}}0!==u.length&&(c.times=ru(u,c.times.constructor),c.values=ru(h,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function Sae(i,e=0,t=i,n=30){n<=0&&(n=30);const r=t.tracks.length,s=e/n;for(let o=0;o<r;++o){const a=t.tracks[o],l=a.ValueTypeName;if("bool"===l||"string"===l)continue;const c=i.tracks.find(function(_){return _.name===a.name&&_.ValueTypeName===l});if(void 0===c)continue;let d=0;const u=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=u/3);let h=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=f/3);const m=a.times.length-1;let p;if(s<=a.times[0])p=Mo(a.values,d,u-d);else if(s>=a.times[m]){const _=m*u+d;p=Mo(a.values,_,_+u-d)}else{const _=a.createInterpolant(),v=d,b=u-d;_.evaluate(s),p=Mo(_.resultBuffer,v,b)}"quaternion"===l&&(new xi).fromArray(p).normalize().conjugate().toArray(p);const g=c.times.length;for(let _=0;_<g;++_){const v=_*f+h;if("quaternion"===l)xi.multiplyQuaternionsFlat(c.values,v,p,0,c.values,v);else{const b=f-2*h;for(let y=0;y<b;++y)c.values[v+y]-=p[y]}}}return i.blendMode=oT,i}});class lp{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let o;i:{n:if(!(e<r)){for(let a=n+2;;){if(void 0===r){if(e<s)break n;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(s=r,r=t[++n],e<r)break t}o=t.length;break i}if(e>=s)break e;{const a=t[1];e<a&&(n=2,s=a);for(let l=n-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(r=s,s=t[--n-1],e>=s)break t}o=n,n=0}}for(;n<o;){const a=n+o>>>1;e<t[a]?o=a:n=a+1}if(r=t[n],s=t[n-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=n[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class o4 extends lp{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:jd,endingEnd:jd}}intervalChanged_(e,t,n){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case Ud:s=e,a=2*t-n;break;case Q_:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=n}if(void 0===l)switch(this.getSettings_().endingEnd){case Ud:o=e,l=2*n-t;break;case Q_:o=1,l=n+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(n-t),d=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-n),this._offsetPrev=s*d,this._offsetNext=o*d}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,d=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,f=this._weightNext,m=(n-t)/(r-t),p=m*m,g=p*m,_=-h*g+2*h*p-h*m,v=(1+h)*g+(-1.5-2*h)*p+(-.5+h)*m+1,b=(-1-f)*g+(1.5+f)*p+.5*m,y=f*g-f*p;for(let x=0;x!==a;++x)s[x]=_*o[d+x]+v*o[c+x]+b*o[l+x]+y*o[u+x];return s}}class gI extends lp{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,d=(n-t)/(r-t),u=1-d;for(let h=0;h!==a;++h)s[h]=o[c+h]*u+o[l+h]*d;return s}}class a4 extends lp{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class ra{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ru(t,this.TimeBufferType),this.values=ru(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:ru(e.times,Array),values:ru(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new a4(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new gI(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new o4(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Af:t=this.InterpolantFactoryMethodDiscrete;break;case Nd:t=this.InterpolantFactoryMethodLinear;break;case gA:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Af;case this.InterpolantFactoryMethodLinear:return Nd;case this.InterpolantFactoryMethodSmooth:return gA}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let s=0,o=r-1;for(;s!==r&&n[s]<e;)++s;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Mo(n,s,o),this.values=Mo(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=n[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&fI(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=Mo(this.times),t=Mo(this.values),n=this.getValueSize(),r=this.getInterpolation()===gA,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const u=a*n,h=u-n,f=u+n;for(let m=0;m!==n;++m){const p=t[u+m];if(p!==t[h+m]||p!==t[f+m]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const u=a*n,h=o*n;for(let f=0;f!==n;++f)t[h+f]=t[u+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*n,l=o*n,c=0;c!==n;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=Mo(e,0,o),this.values=Mo(t,0,o*n)):(this.times=e,this.values=t),this}clone(){const e=Mo(this.times,0),t=Mo(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}ra.prototype.TimeBufferType=Float32Array,ra.prototype.ValueBufferType=Float32Array,ra.prototype.DefaultInterpolation=Nd;class su extends ra{}su.prototype.ValueTypeName="bool",su.prototype.ValueBufferType=Array,su.prototype.DefaultInterpolation=Af,su.prototype.InterpolantFactoryMethodLinear=void 0,su.prototype.InterpolantFactoryMethodSmooth=void 0;class _I extends ra{}_I.prototype.ValueTypeName="color";class ou extends ra{}ou.prototype.ValueTypeName="number";class l4 extends lp{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(n-t)/(r-t);let c=e*a;for(let d=c+a;c!==d;c+=4)xi.slerpFlat(s,0,o,c-a,o,c,l);return s}}class Sl extends ra{InterpolantFactoryMethodLinear(e){return new l4(this.times,this.values,this.getValueSize(),e)}}Sl.prototype.ValueTypeName="quaternion",Sl.prototype.DefaultInterpolation=Nd,Sl.prototype.InterpolantFactoryMethodSmooth=void 0;class au extends ra{}au.prototype.ValueTypeName="string",au.prototype.ValueBufferType=Array,au.prototype.DefaultInterpolation=Af,au.prototype.InterpolantFactoryMethodLinear=void 0,au.prototype.InterpolantFactoryMethodSmooth=void 0;class lu extends ra{}lu.prototype.ValueTypeName="vector";class cu{constructor(e,t=-1,n,r=_A){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=Zs(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)t.push(Rae(n[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=n.length;s!==o;++s)t.push(ra.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const d=s4(l);l=pI(l,1,d),c=pI(c,1,d),!r&&0===l[0]&&(l.push(s),c.push(c[0])),o.push(new ou(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;Array.isArray(e)||(n=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],d=c.name.match(s);if(d&&d.length>1){const u=d[1];let h=r[u];h||(r[u]=h=[]),h.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(u,h,f,m,p){if(0!==f.length){const g=[],_=[];mI(f,g,_,m),0!==g.length&&p.push(new u(h,g,_))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let u=0;u<c.length;u++){const h=c[u].keys;if(h&&0!==h.length)if(h[0].morphTargets){const f={};let m;for(m=0;m<h.length;m++)if(h[m].morphTargets)for(let p=0;p<h[m].morphTargets.length;p++)f[h[m].morphTargets[p]]=-1;for(const p in f){const g=[],_=[];for(let v=0;v!==h[m].morphTargets.length;++v){const b=h[m];g.push(b.time),_.push(b.morphTarget===p?1:0)}r.push(new ou(".morphTargetInfluence["+p+"]",g,_))}l=f.length*o}else{const f=".bones["+t[u].name+"]";n(lu,f+".position",h,"pos",r),n(Sl,f+".quaternion",h,"rot",r),n(lu,f+".scale",h,"scl",r)}}return 0===r.length?null:new this(s,l,r,a)}resetDuration(){let t=0;for(let n=0,r=this.tracks.length;n!==r;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Rae(i){if(void 0===i.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function Iae(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ou;case"vector":case"vector2":case"vector3":case"vector4":return lu;case"color":return _I;case"quaternion":return Sl;case"bool":case"boolean":return su;case"string":return au}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}(i.type);if(void 0===i.times){const t=[],n=[];mI(i.keys,t,n,"value"),i.times=t,i.values=n}return void 0!==e.parse?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const du={enabled:!1,files:{},add:function(i,e){!1!==this.enabled&&(this.files[i]=e)},get:function(i){if(!1!==this.enabled)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class bI{constructor(e,t,n){const r=this;let l,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(d){a++,!1===s&&void 0!==r.onStart&&r.onStart(d,o,a),s=!0},this.itemEnd=function(d){o++,void 0!==r.onProgress&&r.onProgress(d,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(d){void 0!==r.onError&&r.onError(d)},this.resolveURL=function(d){return l?l(d):d},this.setURLModifier=function(d){return l=d,this},this.addHandler=function(d,u){return c.push(d,u),this},this.removeHandler=function(d){const u=c.indexOf(d);return-1!==u&&c.splice(u,2),this},this.getHandler=function(d){for(let u=0,h=c.length;u<h;u+=2){const f=c[u],m=c[u+1];if(f.global&&(f.lastIndex=0),f.test(d))return m}return null}}}const c4=new bI;class yr{constructor(e){this.manager=void 0!==e?e:c4,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,s){n.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Tl={};class Dae extends Error{constructor(e,t){super(e),this.response=t}}class Ar extends yr{constructor(e){super(e)}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=du.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==Tl[e])return void Tl[e].push({onLoad:t,onProgress:n,onError:r});Tl[e]=[],Tl[e].push({onLoad:t,onProgress:n,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===c.body||void 0===c.body.getReader)return c;const d=Tl[e],u=c.body.getReader(),h=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),f=h?parseInt(h):0,m=0!==f;let p=0;const g=new ReadableStream({start(_){!function v(){u.read().then(({done:b,value:y})=>{if(b)_.close();else{p+=y.byteLength;const x=new ProgressEvent("progress",{lengthComputable:m,loaded:p,total:f});for(let C=0,M=d.length;C<M;C++){const w=d[C];w.onProgress&&w.onProgress(x)}_.enqueue(y),v()}})}()}});return new Response(g)}throw new Dae(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(d=>(new DOMParser).parseFromString(d,a));case"json":return c.json();default:if(void 0===a)return c.text();{const u=/charset="?([^;"\s]*)"?/i.exec(a),h=u&&u[1]?u[1].toLowerCase():void 0,f=new TextDecoder(h);return c.arrayBuffer().then(m=>f.decode(m))}}}).then(c=>{du.add(e,c);const d=Tl[e];delete Tl[e];for(let u=0,h=d.length;u<h;u++){const f=d[u];f.onLoad&&f.onLoad(c)}}).catch(c=>{const d=Tl[e];if(void 0===d)throw this.manager.itemError(e),c;delete Tl[e];for(let u=0,h=d.length;u<h;u++){const f=d[u];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Pae extends yr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new Ar(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=cu.parse(e[n]);t.push(r)}return t}}class _x extends yr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=[],a=new m0,l=new Ar(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function d(u){l.load(e[u],function(h){const f=s.parse(h,!0);o[u]={width:f.width,height:f.height,format:f.format,mipmaps:f.mipmaps},c+=1,6===c&&(1===f.mipmapCount&&(a.minFilter=Li),a.image=o,a.format=f.format,a.needsUpdate=!0,t&&t(a))},n,r)}if(Array.isArray(e))for(let u=0,h=e.length;u<h;++u)d(u);else l.load(e,function(u){const h=s.parse(u,!0);if(h.isCubemap){const f=h.mipmaps.length/h.mipmapCount;for(let m=0;m<f;m++){o[m]={mipmaps:[]};for(let p=0;p<h.mipmapCount;p++)o[m].mipmaps.push(h.mipmaps[m*h.mipmapCount+p]),o[m].format=h.format,o[m].width=h.width,o[m].height=h.height}a.image=o}else a.image.width=h.width,a.image.height=h.height,a.mipmaps=h.mipmaps;1===h.mipmapCount&&(a.minFilter=Li),a.format=h.format,a.needsUpdate=!0,t&&t(a)},n,r);return a}}class x0 extends yr{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=du.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Z_("img");function l(){d(),du.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(u){d(),r&&r(u),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class d4 extends yr{constructor(e){super(e)}load(e,t,n,r){const s=new qd,o=new x0(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(d){s.images[c]=d,a++,6===a&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class cp extends yr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new ka,a=new Ar(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){const c=s.parse(l);c&&(void 0!==c.image?o.image=c.image:void 0!==c.data&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=void 0!==c.wrapS?c.wrapS:gr,o.wrapT=void 0!==c.wrapT?c.wrapT:gr,o.magFilter=void 0!==c.magFilter?c.magFilter:Li,o.minFilter=void 0!==c.minFilter?c.minFilter:Li,o.anisotropy=void 0!==c.anisotropy?c.anisotropy:1,void 0!==c.encoding&&(o.encoding=c.encoding),void 0!==c.flipY&&(o.flipY=c.flipY),void 0!==c.format&&(o.format=c.format),void 0!==c.type&&(o.type=c.type),void 0!==c.mipmaps&&(o.mipmaps=c.mipmaps,o.minFilter=Xs),1===c.mipmapCount&&(o.minFilter=Li),void 0!==c.generateMipmaps&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,t&&t(o,c))},n,r),o}}class bx extends yr{constructor(e){super(e)}load(e,t,n,r){const s=new qn,o=new x0(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},n,r),s}}class Il extends wi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new De(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class vI extends Il{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(wi.DefaultUp),this.updateMatrix(),this.groundColor=new De(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const yI=new Ve,u4=new T,h4=new T;class AI{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ue(512,512),this.map=null,this.mapPass=null,this.matrix=new Ve,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new zA,this._frameExtents=new ue(1,1),this._viewportCount=1,this._viewports=[new ni(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;u4.setFromMatrixPosition(e.matrixWorld),t.position.copy(u4),h4.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(h4),t.updateMatrixWorld(),yI.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(yI),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(yI)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class kae extends AI{constructor(){super(new Sn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*X_*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class w0 extends Il{constructor(e,t,n=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(wi.DefaultUp),this.updateMatrix(),this.target=new wi,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new kae}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const f4=new Ve,C0=new T,xI=new T;class Fae extends AI{constructor(){super(new Sn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ue(4,2),this._viewportCount=6,this._viewports=[new ni(2,1,1,1),new ni(0,1,1,1),new ni(3,1,1,1),new ni(1,1,1,1),new ni(3,0,1,1),new ni(1,0,1,1)],this._cubeDirections=[new T(1,0,0),new T(-1,0,0),new T(0,0,1),new T(0,0,-1),new T(0,1,0),new T(0,-1,0)],this._cubeUps=[new T(0,1,0),new T(0,1,0),new T(0,1,0),new T(0,1,0),new T(0,0,1),new T(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),C0.setFromMatrixPosition(e.matrixWorld),n.position.copy(C0),xI.copy(n.position),xI.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(xI),n.updateMatrixWorld(),r.makeTranslation(-C0.x,-C0.y,-C0.z),f4.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(f4)}}class dp extends Il{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new Fae}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Bae extends AI{constructor(){super(new Pa(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class M0 extends Il{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(wi.DefaultUp),this.updateMatrix(),this.target=new wi,this.shadow=new Bae}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class vx extends Il{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class wI extends Il{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class p4{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new T)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],n*r*1.092548),t.addScaledVector(o[5],r*s*1.092548),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],n*s*1.092548),t.addScaledVector(o[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*r),t.addScaledVector(o[2],1.023328*s),t.addScaledVector(o[3],1.023328*n),t.addScaledVector(o[4],.858086*n*r),t.addScaledVector(o[5],.858086*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],.858086*n*s),t.addScaledVector(o[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const n=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-r*r)}}class E0 extends Il{constructor(e=new p4,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class yx extends yr{constructor(e){super(e),this.textures={}}load(e,t,n,r){const s=this,o=new Ar(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const t=this.textures;function n(s){return void 0===t[s]&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const r=yx.createMaterialFromType(e.type);if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=(new De).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.iridescence&&(r.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(r.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&(r.vertexColors="number"==typeof e.vertexColors?e.vertexColors>0:e.vertexColors),void 0!==e.uniforms)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=n(o.value);break;case"c":r.uniforms[s].value=(new De).setHex(o.value);break;case"v2":r.uniforms[s].value=(new ue).fromArray(o.value);break;case"v3":r.uniforms[s].value=(new T).fromArray(o.value);break;case"v4":r.uniforms[s].value=(new ni).fromArray(o.value);break;case"m3":r.uniforms[s].value=(new Xr).fromArray(o.value);break;case"m4":r.uniforms[s].value=(new Ve).fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(r.glslVersion=e.glslVersion),void 0!==e.extensions)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new ue).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new ue).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(r.iridescenceMap=n(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=n(e.thicknessMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:lI,SpriteMaterial:ZA,RawShaderMaterial:cI,ShaderMaterial:Rt,PointsMaterial:El,MeshPhysicalMaterial:Oa,MeshStandardMaterial:La,MeshPhongMaterial:nu,MeshToonMaterial:dI,MeshNormalMaterial:ap,MeshLambertMaterial:gx,MeshDepthMaterial:Zd,MeshDistanceMaterial:qA,MeshBasicMaterial:Xn,MeshMatcapMaterial:uI,LineDashedMaterial:hI,LineBasicMaterial:pn,Material:On}[e]}}class Cs{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class CI extends xt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class m4 extends yr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new Ar(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const t={},n={};function r(f,m){if(void 0!==t[m])return t[m];const g=f.interleavedBuffers[m],_=function s(f,m){if(void 0!==n[m])return n[m];const _=new Uint32Array(f.arrayBuffers[m]).buffer;return n[m]=_,_}(f,g.buffer),v=wf(g.type,_),b=new c0(v,g.stride);return b.uuid=g.uuid,t[m]=b,b}const o=e.isInstancedBufferGeometry?new CI:new xt,a=e.data.index;if(void 0!==a){const f=wf(a.type,a.array);o.setIndex(new Ci(f,1))}const l=e.data.attributes;for(const f in l){const m=l[f];let p;if(m.isInterleavedBufferAttribute){const g=r(e.data,m.data);p=new _c(g,m.itemSize,m.offset,m.normalized)}else{const g=wf(m.type,m.array);p=new(m.isInstancedBufferAttribute?Yf:Ci)(g,m.itemSize,m.normalized)}void 0!==m.name&&(p.name=m.name),void 0!==m.usage&&p.setUsage(m.usage),void 0!==m.updateRange&&(p.updateRange.offset=m.updateRange.offset,p.updateRange.count=m.updateRange.count),o.setAttribute(f,p)}const c=e.data.morphAttributes;if(c)for(const f in c){const m=c[f],p=[];for(let g=0,_=m.length;g<_;g++){const v=m[g];let b;if(v.isInterleavedBufferAttribute){const y=r(e.data,v.data);b=new _c(y,v.itemSize,v.offset,v.normalized)}else{const y=wf(v.type,v.array);b=new Ci(y,v.itemSize,v.normalized)}void 0!==v.name&&(b.name=v.name),p.push(b)}o.morphAttributes[f]=p}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const u=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==u)for(let f=0,m=u.length;f!==m;++f){const p=u[f];o.addGroup(p.start,p.count,p.materialIndex)}const h=e.data.boundingSphere;if(void 0!==h){const f=new T;void 0!==h.center&&f.fromArray(h.center),o.boundingSphere=new Al(f,h.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Lae extends yr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=""===this.path?Cs.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new Ar(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(u){return void 0!==r&&r(u),void console.error("THREE:ObjectLoader: Can't parse "+e+".",u.message)}const d=c.metadata;if(void 0===d||void 0===d.type||"geometry"===d.type.toLowerCase())return void 0!==r&&r(new Error("THREE.ObjectLoader: Can't load "+e)),void console.error("THREE.ObjectLoader: Can't load "+e);s.parse(c,t)},n,r)}loadAsync(e,t){var n=this;return ss(function*(){const r=n,s=""===n.path?Cs.extractUrlBase(e):n.path;n.resourcePath=n.resourcePath||s;const o=new Ar(n.manager);o.setPath(n.path),o.setRequestHeader(n.requestHeader),o.setWithCredentials(n.withCredentials);const a=yield o.loadAsync(e,t),l=JSON.parse(a),c=l.metadata;if(void 0===c||void 0===c.type||"geometry"===c.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return yield r.parseAsync(l)})()}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){void 0!==t&&t(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,n),d=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,d),void 0!==t){let u=!1;for(const h in o)if(o[h].data instanceof HTMLImageElement){u=!0;break}!1===u&&t(c)}return c}parseAsync(e){var t=this;return ss(function*(){const n=t.parseAnimations(e.animations),r=t.parseShapes(e.shapes),s=t.parseGeometries(e.geometries,r),o=yield t.parseImagesAsync(e.images),a=t.parseTextures(e.textures,o),l=t.parseMaterials(e.materials,a),c=t.parseObject(e.object,s,l,a,n),d=t.parseSkeletons(e.skeletons,c);return t.bindSkeletons(c,d),c})()}parseShapes(e){const t={};if(void 0!==e)for(let n=0,r=e.length;n<r;n++){const s=(new eu).fromJSON(e[n]);t[s.uuid]=s}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),void 0!==e)for(let s=0,o=e.length;s<o;s++){const a=(new Xf).fromJSON(e[s],r);n[a.uuid]=a}return n}parseGeometries(e,t){const n={};if(void 0!==e){const r=new m4;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;default:l.type in r4?a=r4[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,void 0!==l.name&&(a.name=l.name),!0===a.isBufferGeometry&&void 0!==l.userData&&(a.userData=l.userData),n[l.uuid]=a}}return n}parseMaterials(e,t){const n={},r={};if(void 0!==e){const s=new yx;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const l=e[o];void 0===n[l.uuid]&&(n[l.uuid]=s.parse(l)),r[l.uuid]=n[l.uuid]}}return r}parseAnimations(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const s=cu.parse(e[n]);t[s.uuid]=s}return t}parseImages(e,t){const n=this,r={};let s;function a(l){if("string"==typeof l){const c=l;return function o(l){return n.manager.itemStart(l),s.load(l,function(){n.manager.itemEnd(l)},void 0,function(){n.manager.itemError(l),n.manager.itemEnd(l)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:n.resourcePath+c)}return l.data?{data:wf(l.type,l.data),width:l.width,height:l.height}:null}if(void 0!==e&&e.length>0){const l=new bI(t);s=new x0(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,d=e.length;c<d;c++){const u=e[c],h=u.url;if(Array.isArray(h)){const f=[];for(let m=0,p=h.length;m<p;m++){const _=a(h[m]);null!==_&&(_ instanceof HTMLImageElement?f.push(_):f.push(new ka(_.data,_.width,_.height)))}r[u.uuid]=new Hd(f)}else{const f=a(u.url);r[u.uuid]=new Hd(f)}}}return r}parseImagesAsync(e){var t=this;return ss(function*(){const n=t,r={};let s;function o(l){return a.apply(this,arguments)}function a(){return(a=ss(function*(l){if("string"==typeof l){const c=l,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:n.resourcePath+c;return yield s.loadAsync(d)}return l.data?{data:wf(l.type,l.data),width:l.width,height:l.height}:null})).apply(this,arguments)}if(void 0!==e&&e.length>0){s=new x0(t.manager),s.setCrossOrigin(t.crossOrigin);for(let l=0,c=e.length;l<c;l++){const d=e[l],u=d.url;if(Array.isArray(u)){const h=[];for(let f=0,m=u.length;f<m;f++){const p=u[f],g=yield o(p);null!==g&&(g instanceof HTMLImageElement?h.push(g):h.push(new ka(g.data,g.width,g.height)))}r[d.uuid]=new Hd(h)}else{const h=yield o(d.url);r[d.uuid]=new Hd(h)}}}return r})()}parseTextures(e,t){function n(s,o){return"number"==typeof s?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(void 0!==e)for(let s=0,o=e.length;s<o;s++){const a=e[s];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=t[a.image],c=l.data;let d;Array.isArray(c)?(d=new qd,6===c.length&&(d.needsUpdate=!0)):(d=c&&c.data?new ka:new qn,c&&(d.needsUpdate=!0)),d.source=l,d.uuid=a.uuid,void 0!==a.name&&(d.name=a.name),void 0!==a.mapping&&(d.mapping=n(a.mapping,Oae)),void 0!==a.offset&&d.offset.fromArray(a.offset),void 0!==a.repeat&&d.repeat.fromArray(a.repeat),void 0!==a.center&&d.center.fromArray(a.center),void 0!==a.rotation&&(d.rotation=a.rotation),void 0!==a.wrap&&(d.wrapS=n(a.wrap[0],g4),d.wrapT=n(a.wrap[1],g4)),void 0!==a.format&&(d.format=a.format),void 0!==a.type&&(d.type=a.type),void 0!==a.encoding&&(d.encoding=a.encoding),void 0!==a.minFilter&&(d.minFilter=n(a.minFilter,_4)),void 0!==a.magFilter&&(d.magFilter=n(a.magFilter,_4)),void 0!==a.anisotropy&&(d.anisotropy=a.anisotropy),void 0!==a.flipY&&(d.flipY=a.flipY),void 0!==a.generateMipmaps&&(d.generateMipmaps=a.generateMipmaps),void 0!==a.premultiplyAlpha&&(d.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(d.unpackAlignment=a.unpackAlignment),void 0!==a.userData&&(d.userData=a.userData),r[a.uuid]=d}return r}parseObject(e,t,n,r,s){let o,d,u;function a(h){return void 0===t[h]&&console.warn("THREE.ObjectLoader: Undefined geometry",h),t[h]}function l(h){if(void 0!==h){if(Array.isArray(h)){const f=[];for(let m=0,p=h.length;m<p;m++){const g=h[m];void 0===n[g]&&console.warn("THREE.ObjectLoader: Undefined material",g),f.push(n[g])}return f}return void 0===n[h]&&console.warn("THREE.ObjectLoader: Undefined material",h),n[h]}}function c(h){return void 0===r[h]&&console.warn("THREE.ObjectLoader: Undefined texture",h),r[h]}switch(e.type){case"Scene":o=new YA,void 0!==e.background&&(o.background=Number.isInteger(e.background)?new De(e.background):c(e.background)),void 0!==e.environment&&(o.environment=c(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new l0(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new XA(e.fog.color,e.fog.density))),void 0!==e.backgroundBlurriness&&(o.backgroundBlurriness=e.backgroundBlurriness);break;case"PerspectiveCamera":o=new Sn(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Pa(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new vx(e.color,e.intensity);break;case"DirectionalLight":o=new M0(e.color,e.intensity);break;case"PointLight":o=new dp(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new wI(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new w0(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new vI(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=(new E0).fromJSON(e);break;case"SkinnedMesh":d=a(e.geometry),u=l(e.material),o=new f0(d,u),void 0!==e.bindMode&&(o.bindMode=e.bindMode),void 0!==e.bindMatrix&&o.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(o.skeleton=e.skeleton);break;case"Mesh":d=a(e.geometry),u=l(e.material),o=new Ke(d,u);break;case"InstancedMesh":d=a(e.geometry),u=l(e.material);const f=e.instanceMatrix,m=e.instanceColor;o=new ix(d,u,e.count),o.instanceMatrix=new Yf(new Float32Array(f.array),16),void 0!==m&&(o.instanceColor=new Yf(new Float32Array(m.array),m.itemSize));break;case"LOD":o=new GT;break;case"Line":o=new Nn(a(e.geometry),l(e.material));break;case"LineLoop":o=new rx(a(e.geometry),l(e.material));break;case"LineSegments":o=new ws(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new $d(a(e.geometry),l(e.material));break;case"Sprite":o=new HT(l(e.material));break;case"Group":o=new xs;break;case"Bone":o=new Kd;break;default:o=new wi}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(o.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(o.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.frustumCulled&&(o.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(o.renderOrder=e.renderOrder),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.layers&&(o.layers.mask=e.layers),void 0!==e.children){const h=e.children;for(let f=0;f<h.length;f++)o.add(this.parseObject(h[f],t,n,r,s))}if(void 0!==e.animations){const h=e.animations;for(let f=0;f<h.length;f++)o.animations.push(s[h[f]])}if("LOD"===e.type){void 0!==e.autoUpdate&&(o.autoUpdate=e.autoUpdate);const h=e.levels;for(let f=0;f<h.length;f++){const m=h[f],p=o.getObjectByProperty("uuid",m.object);void 0!==p&&o.addLevel(p,m.distance,m.hysteresis)}}return o}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse(function(n){if(!0===n.isSkinnedMesh&&void 0!==n.skeleton){const r=t[n.skeleton];void 0===r?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}}const Oae={UVMapping:aA,CubeReflectionMapping:sc,CubeRefractionMapping:oc,EquirectangularReflectionMapping:hf,EquirectangularRefractionMapping:j_,CubeUVReflectionMapping:ff},g4={RepeatWrapping:Ao,ClampToEdgeWrapping:gr,MirroredRepeatWrapping:pf},_4={NearestFilter:$t,NearestMipmapNearestFilter:U_,NearestMipmapLinearFilter:mf,LinearFilter:Li,LinearMipmapNearestFilter:lA,LinearMipmapLinearFilter:Xs};class b4 extends yr{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=du.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){du.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let Ax;class MI{static getContext(){return void 0===Ax&&(Ax=new(window.AudioContext||window.webkitAudioContext)),Ax}static setContext(e){Ax=e}}class Nae extends yr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new Ar(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{const l=a.slice(0);MI.getContext().decodeAudioData(l,function(d){t(d)})}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}}class v4 extends E0{constructor(e,t,n=1){super(void 0,n),this.isHemisphereLightProbe=!0;const r=(new De).set(e),s=(new De).set(t),o=new T(r.r,r.g,r.b),a=new T(s.r,s.g,s.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}}class y4 extends E0{constructor(e,t=1){super(void 0,t),this.isAmbientLightProbe=!0;const n=(new De).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const A4=new Ve,x4=new Ve,uu=new Ve;class w4{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Sn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Sn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,uu.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,o=t.near*Math.tan(Vd*t.fov*.5)/t.zoom;let a,l;x4.elements[12]=-r,A4.elements[12]=r,a=-o*t.aspect+s,l=o*t.aspect+s,uu.elements[0]=2*t.near/(l-a),uu.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(uu),a=-o*t.aspect-s,l=o*t.aspect-s,uu.elements[0]=2*t.near/(l-a),uu.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(uu)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(x4),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(A4)}}class up{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=C4(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=C4();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function C4(){return(typeof performance>"u"?Date:performance).now()}const hu=new T,M4=new xi,jae=new T,fu=new T;class E4 extends wi{constructor(){super(),this.type="AudioListener",this.context=MI.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new up}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(hu,M4,jae),fu.set(0,0,-1).applyQuaternion(M4),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(hu.x,r),t.positionY.linearRampToValueAtTime(hu.y,r),t.positionZ.linearRampToValueAtTime(hu.z,r),t.forwardX.linearRampToValueAtTime(fu.x,r),t.forwardY.linearRampToValueAtTime(fu.y,r),t.forwardZ.linearRampToValueAtTime(fu.z,r),t.upX.linearRampToValueAtTime(n.x,r),t.upY.linearRampToValueAtTime(n.y,r),t.upZ.linearRampToValueAtTime(n.z,r)}else t.setPosition(hu.x,hu.y,hu.z),t.setOrientation(fu.x,fu.y,fu.z,n.x,n.y,n.z)}}class EI extends wi{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const pu=new T,S4=new xi,Uae=new T,mu=new T;class T4 extends EI{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(pu,S4,Uae),mu.set(0,0,1).applyQuaternion(S4);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(pu.x,n),t.positionY.linearRampToValueAtTime(pu.y,n),t.positionZ.linearRampToValueAtTime(pu.z,n),t.orientationX.linearRampToValueAtTime(mu.x,n),t.orientationY.linearRampToValueAtTime(mu.y,n),t.orientationZ.linearRampToValueAtTime(mu.z,n)}else t.setPosition(pu.x,pu.y,pu.z),t.setOrientation(mu.x,mu.y,mu.z)}}class Vae{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class I4{constructor(e,t,n){let r,s,o;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(0===o){for(let a=0;a!==r;++a)n[s+a]=n[a];o=t}else o+=t,this._mixBufferRegion(n,s,0,t/o,r);this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1&&this._mixBufferRegion(n,r,t*this._origIndex,1-s,t),o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(n[l]!==n[l+t]){a.setValue(n,r);break}}saveOriginalState(){const t=this.buffer,n=this.valueSize,r=n*this._origIndex;this.binding.getValue(t,r);for(let s=n,o=r;s!==o;++s)t[s]=t[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[n+o]}_slerp(e,t,n,r){xi.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,s){const o=this._workIndex*s;xi.multiplyQuaternionsFlat(e,o,e,t,e,n),xi.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,n,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[n+a]*r}}_lerpAdditive(e,t,n,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[n+o]*r}}}const SI="\\[\\]\\.:\\/",zae=new RegExp("["+SI+"]","g"),TI="[^"+SI+"]",Hae="[^"+SI.replace("\\.","")+"]",Xae=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",TI)+/(WCOD+)?/.source.replace("WCOD",Hae)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",TI)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",TI)+"$"),Yae=["material","materials","bones","map"];class Zae{constructor(e,t,n){const r=n||Oi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}let Oi=(()=>{class i{constructor(t,n,r){this.path=n,this.parsedPath=r||i.parseTrackName(n),this.node=i.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,r){return t&&t.isAnimationObjectGroup?new i.Composite(t,n,r):new i(t,n,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(zae,"")}static parseTrackName(t){const n=Xae.exec(t);if(null===n)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==Yae.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,n){if(void 0===n||""===n||"."===n||-1===n||n===t.name||n===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(n);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===n||l.uuid===n)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[n++]=r[s]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++]}_setValue_array_setNeedsUpdate(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node;const n=this.parsedPath,r=n.objectName,s=n.propertyName;let o=n.propertyIndex;if(t||(t=i.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let d=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let u=0;u<t.length;u++)if(t[u].name===d){d=u;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==d){if(void 0===t[d])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[d]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return i.Composite=Zae,i})();Oi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Oi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Oi.prototype.GetterByBindingType=[Oi.prototype._getValue_direct,Oi.prototype._getValue_array,Oi.prototype._getValue_arrayElement,Oi.prototype._getValue_toArray],Oi.prototype.SetterByBindingTypeAndVersioning=[[Oi.prototype._setValue_direct,Oi.prototype._setValue_direct_setNeedsUpdate,Oi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Oi.prototype._setValue_array,Oi.prototype._setValue_array_setNeedsUpdate,Oi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Oi.prototype._setValue_arrayElement,Oi.prototype._setValue_arrayElement_setNeedsUpdate,Oi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Oi.prototype._setValue_fromArray,Oi.prototype._setValue_fromArray_setNeedsUpdate,Oi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Kae{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Zs(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,c=this.nCachedObjects_;for(let d=0,u=arguments.length;d!==u;++d){const h=arguments[d],f=h.uuid;let m=t[f];if(void 0===m){m=l++,t[f]=m,e.push(h);for(let p=0,g=o;p!==g;++p)s[p].push(new Oi(h,n[p],r[p]))}else if(m<c){a=e[m];const p=--c,g=e[p];t[g.uuid]=m,e[m]=g,t[f]=p,e[p]=h;for(let _=0,v=o;_!==v;++_){const b=s[_];let x=b[m];b[m]=b[p],void 0===x&&(x=new Oi(h,n[_],r[_])),b[p]=x}}else e[m]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,d=t[c];if(void 0!==d&&d>=s){const u=s++,h=e[u];t[h.uuid]=d,e[d]=h,t[c]=u,e[u]=l;for(let f=0,m=r;f!==m;++f){const p=n[f],_=p[d];p[d]=p[u],p[u]=_}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const d=arguments[a].uuid,u=t[d];if(void 0!==u)if(delete t[d],u<s){const h=--s,f=e[h],m=--o,p=e[m];t[f.uuid]=u,e[u]=f,t[p.uuid]=h,e[h]=p,e.pop();for(let g=0,_=r;g!==_;++g){const v=n[g],y=v[m];v[u]=v[h],v[h]=y,v.pop()}}else{const h=--o,f=e[h];h>0&&(t[f.uuid]=u),e[u]=f,e.pop();for(let m=0,p=r;m!==p;++m){const g=n[m];g[u]=g[h],g.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const s=this._bindings;if(void 0!==r)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,d=this.nCachedObjects_,u=new Array(l.length);r=s.length,n[e]=r,o.push(e),a.push(t),s.push(u);for(let h=d,f=l.length;h!==f;++h)u[h]=new Oi(l[h],e,t);return u}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a];t[e[a]]=n,o[n]=l,o.pop(),s[n]=s[a],s.pop(),r[n]=r[a],r.pop()}}}class $ae{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:jd,endingEnd:jd};for(let c=0;c!==o;++c){const d=s[c].createInterpolant(null);a[c]=d,d.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Tj,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const r=this._clip.duration,s=e._clip.duration,a=r/s;e.warp(1,s/r,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+n,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled)return void this._updateWeight(e);const s=this._startTime;if(null!==s){const l=(e-s)*n;l<0||0===n?t=0:(this._startTime=null,t=n*l)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;if(this.blendMode===oT)for(let d=0,u=l.length;d!==u;++d)l[d].evaluate(o),c[d].accumulateAdditive(a);else for(let d=0,u=l.length;d!==u;++d)l[d].evaluate(o),c[d].accumulate(r,a)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;null!==n&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,s=this._loopCount;const o=n===Ij;if(0===e)return-1===s?r:o&&1==(1&s)?t-r:r;if(n===sT){-1===s&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===s&&(e>=0?(s=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===l){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&1==(1&s))return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=Ud,r.endingEnd=Ud):(r.endingStart=e?this.zeroSlopeAtStart?Ud:jd:Q_,r.endingEnd=t?this.zeroSlopeAtEnd?Ud:jd:Q_)}_scheduleFading(e,t,n){const r=this._mixer,s=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=n,this}}const Jae=new Float32Array(1);class R4 extends os{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=n.uuid,c=this._bindingsByRootAndName;let d=c[l];void 0===d&&(d={},c[l]=d);for(let u=0;u!==s;++u){const h=r[u],f=h.name;let m=d[f];if(void 0!==m)++m.referenceCount,o[u]=m;else{if(m=o[u],void 0!==m){null===m._cacheIndex&&(++m.referenceCount,this._addInactiveBinding(m,l,f));continue}m=new I4(Oi.create(n,f,t&&t._propertyBindings[u].binding.parsedPath),h.ValueTypeName,h.getValueSize()),++m.referenceCount,this._addInactiveBinding(m,l,f),o[u]=m}a[u].resultBuffer=m.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,n)}const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];0==--s.useCount&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,s=this._actionsByClip;let o=s[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],d=e._byClipCacheIndex;c._byClipCacheIndex=d,l[d]=c,l.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===l.length&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];0==--s.referenceCount&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];void 0===o&&(o={},r[t]=o),o[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,s=n.path,o=this._bindingsByRootAndName,a=o[r],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[s],0===Object.keys(a).length&&delete o[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new gI(new Float32Array(2),new Float32Array(2),1,Jae),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const r=t||this._root,s=r.uuid;let o="string"==typeof e?cu.findByName(r,e):e;const a=null!==o?o.uuid:e,l=this._actionsByClip[a];let c=null;if(void 0===n&&(n=null!==o?o.blendMode:_A),void 0!==l){const u=l.actionByRoot[s];if(void 0!==u&&u.blendMode===n)return u;c=l.knownActions[0],null===o&&(o=c._clip)}if(null===o)return null;const d=new $ae(this,o,t,n);return this._bindAction(d,c),this._addInactiveAction(d,a,s),d}existingAction(e,t){const n=t||this._root,r=n.uuid,s="string"==typeof e?cu.findByName(n,e):e,a=this._actionsByClip[s?s.uuid:e];return void 0!==a&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let n=this._nActiveActions-1;n>=0;--n)e[n].stop();return this}update(e){const t=this._actions,n=this._nActiveActions,r=this.time+=e*=this.timeScale,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==n;++c)t[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,s=r[n];if(void 0!==s){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const d=c._cacheIndex,u=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,u._cacheIndex=d,t[d]=u,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const l=n[o].actionByRoot[t];void 0!==l&&(this._deactivateAction(l),this._removeInactiveAction(l))}const s=this._bindingsByRootAndName[t];if(void 0!==s)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class II{constructor(e){this.value=e}clone(){return new II(void 0===this.value.clone?this.value:this.value.clone())}}let ele=0;class tle extends os{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:ele++}),this.name="",this.usage=q_,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++)this.uniforms.push(t[n].clone());return this}clone(){return(new this.constructor).copy(this)}}class ile extends c0{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class nle{constructor(e,t,n,r,s){this.isGLBufferAttribute=!0,this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class gu{constructor(e,t,n=0,r=1/0){this.ray=new J_(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new RA,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,n=[]){return RI(e,this,n,t),n.sort(D4),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)RI(e[r],this,n,t);return n.sort(D4),n}}function D4(i,e){return i.distance-e.distance}function RI(i,e,t,n){if(i.layers.test(e.layers)&&i.raycast(e,t),!0===n){const r=i.children;for(let s=0,o=r.length;s<o;s++)RI(r[s],e,t,!0)}}class xx{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Wn(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class rle{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return(new this.constructor).copy(this)}}const P4=new ue;class sle{constructor(e=new ue(1/0,1/0),t=new ue(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=P4.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return P4.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const k4=new T,wx=new T;class F4{constructor(e=new T,t=new T){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){k4.subVectors(e,this.start),wx.subVectors(this.end,this.start);const n=wx.dot(wx);let s=wx.dot(k4)/n;return t&&(s=Wn(s,0,1)),s}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const B4=new T;class L4 extends wi{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new xt,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,d=a/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(d),Math.sin(d),1)}n.setAttribute("position",new Ge(r,3));const s=new pn({fog:!1,toneMapped:!1});this.cone=new ws(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),B4.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(B4),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const yc=new T,Cx=new Ve,DI=new Ve;class O4 extends ws{constructor(e){const t=N4(e),n=new xt,r=[],s=[],o=new De(0,0,1),a=new De(0,1,0);for(let c=0;c<t.length;c++){const d=t[c];d.parent&&d.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}n.setAttribute("position",new Ge(r,3)),n.setAttribute("color",new Ge(s,3)),super(n,new pn({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");DI.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(Cx.multiplyMatrices(DI,a.matrixWorld),yc.setFromMatrixPosition(Cx),r.setXYZ(o,yc.x,yc.y,yc.z),Cx.multiplyMatrices(DI,a.parent.matrixWorld),yc.setFromMatrixPosition(Cx),r.setXYZ(o+1,yc.x,yc.y,yc.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function N4(i){const e=[];!0===i.isBone&&e.push(i);for(let t=0;t<i.children.length;t++)e.push.apply(e,N4(i.children[t]));return e}class j4 extends Ke{constructor(e,t,n){super(new vc(t,4,2),new Xn({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const ole=new T,U4=new De,V4=new De;class z4 extends wi{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new ia(t);r.rotateY(.5*Math.PI),this.material=new Xn({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(3*s.count);r.setAttribute("color",new Ci(o,3)),this.add(new Ke(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");U4.copy(this.light.color),V4.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){const s=n<r/2?U4:V4;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(ole.setFromMatrixPosition(this.light.matrixWorld).negate())}}class PI extends ws{constructor(e=10,t=10,n=4473924,r=8947848){n=new De(n),r=new De(r);const s=t/2,o=e/t,a=e/2,l=[],c=[];for(let h=0,f=0,m=-a;h<=t;h++,m+=o){l.push(-a,0,m,a,0,m),l.push(m,0,-a,m,0,a);const p=h===s?n:r;p.toArray(c,f),f+=3,p.toArray(c,f),f+=3,p.toArray(c,f),f+=3,p.toArray(c,f),f+=3}const d=new xt;d.setAttribute("position",new Ge(l,3)),d.setAttribute("color",new Ge(c,3)),super(d,new pn({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class H4 extends ws{constructor(e=10,t=16,n=8,r=64,s=4473924,o=8947848){s=new De(s),o=new De(o);const a=[],l=[];if(t>1)for(let u=0;u<t;u++){const h=u/t*(2*Math.PI),f=Math.sin(h)*e,m=Math.cos(h)*e;a.push(0,0,0),a.push(f,0,m);const p=1&u?s:o;l.push(p.r,p.g,p.b),l.push(p.r,p.g,p.b)}for(let u=0;u<n;u++){const h=1&u?s:o,f=e-e/n*u;for(let m=0;m<r;m++){let p=m/r*(2*Math.PI),g=Math.sin(p)*f,_=Math.cos(p)*f;a.push(g,0,_),l.push(h.r,h.g,h.b),p=(m+1)/r*(2*Math.PI),g=Math.sin(p)*f,_=Math.cos(p)*f,a.push(g,0,_),l.push(h.r,h.g,h.b)}}const c=new xt;c.setAttribute("position",new Ge(a,3)),c.setAttribute("color",new Ge(l,3)),super(c,new pn({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const G4=new T,Mx=new T,Q4=new T;class W4 extends wi{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===t&&(t=1);let r=new xt;r.setAttribute("position",new Ge([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new pn({fog:!1,toneMapped:!1});this.lightPlane=new Nn(r,s),this.add(this.lightPlane),r=new xt,r.setAttribute("position",new Ge([0,0,0,0,0,1],3)),this.targetLine=new Nn(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),G4.setFromMatrixPosition(this.light.matrixWorld),Mx.setFromMatrixPosition(this.light.target.matrixWorld),Q4.subVectors(Mx,G4),this.lightPlane.lookAt(Mx),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Mx),this.targetLine.scale.z=Q4.length()}}const Ex=new T,Un=new o0;class q4 extends ws{constructor(e){const t=new xt,n=new pn({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};function a(m,p){l(m),l(p)}function l(m){r.push(0,0,0),s.push(0,0,0),void 0===o[m]&&(o[m]=[]),o[m].push(r.length/3-1)}a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4"),t.setAttribute("position",new Ge(r,3)),t.setAttribute("color",new Ge(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new De(16755200),d=new De(16711680),u=new De(43775),h=new De(16777215),f=new De(3355443);this.setColors(c,d,u,h,f)}setColors(e,t,n,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap;Un.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Yn("c",t,e,Un,0,0,-1),Yn("t",t,e,Un,0,0,1),Yn("n1",t,e,Un,-1,-1,-1),Yn("n2",t,e,Un,1,-1,-1),Yn("n3",t,e,Un,-1,1,-1),Yn("n4",t,e,Un,1,1,-1),Yn("f1",t,e,Un,-1,-1,1),Yn("f2",t,e,Un,1,-1,1),Yn("f3",t,e,Un,-1,1,1),Yn("f4",t,e,Un,1,1,1),Yn("u1",t,e,Un,.7,1.1,-1),Yn("u2",t,e,Un,-.7,1.1,-1),Yn("u3",t,e,Un,0,2,-1),Yn("cf1",t,e,Un,-1,0,1),Yn("cf2",t,e,Un,1,0,1),Yn("cf3",t,e,Un,0,-1,1),Yn("cf4",t,e,Un,0,1,1),Yn("cn1",t,e,Un,-1,0,-1),Yn("cn2",t,e,Un,1,0,-1),Yn("cn3",t,e,Un,0,-1,-1),Yn("cn4",t,e,Un,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Yn(i,e,t,n,r,s,o){Ex.set(r,s,o).unproject(n);const a=e[i];if(void 0!==a){const l=t.getAttribute("position");for(let c=0,d=a.length;c<d;c++)l.setXYZ(a[c],Ex.x,Ex.y,Ex.z)}}const Sx=new Da;class X4 extends ws{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),s=new xt;s.setIndex(new Ci(n,1)),s.setAttribute("position",new Ci(r,3)),super(s,new pn({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Sx.setFromObject(this.object),Sx.isEmpty())return;const t=Sx.min,n=Sx.max,r=this.geometry.attributes.position,s=r.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=t.x,s[4]=n.y,s[5]=n.z,s[6]=t.x,s[7]=t.y,s[8]=n.z,s[9]=n.x,s[10]=t.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=t.z,s[15]=t.x,s[16]=n.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=n.x,s[22]=t.y,s[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Y4 extends ws{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new xt;s.setIndex(new Ci(n,1)),s.setAttribute("position",new Ge([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(s,new pn({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class Z4 extends Nn{constructor(e,t=1,n=16776960){const r=n,o=new xt;o.setAttribute("position",new Ge([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),o.computeBoundingSphere(),super(o,new pn({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const l=new xt;l.setAttribute("position",new Ge([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),l.computeBoundingSphere(),this.add(new Ke(l,new Xn({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const K4=new T;let Tx,kI;class $4 extends wi{constructor(e=new T(0,0,1),t=new T(0,0,0),n=1,r=16776960,s=.2*n,o=.2*s){super(),this.type="ArrowHelper",void 0===Tx&&(Tx=new xt,Tx.setAttribute("position",new Ge([0,0,0,0,1,0],3)),kI=new jn(0,.5,1,5,1),kI.translate(0,-.5,0)),this.position.copy(t),this.line=new Nn(Tx,new pn({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ke(kI,new Xn({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{K4.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(K4,t)}}setLength(e,t=.2*e,n=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class J4 extends ws{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new xt;r.setAttribute("position",new Ge(t,3)),r.setAttribute("color",new Ge([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(r,new pn({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const r=new De,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ale{constructor(){this.type="ShapePath",this.color=new De,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new b0,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,s,o){return this.currentPath.bezierCurveTo(e,t,n,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(_,v){const b=v.length;let y=!1;for(let x=b-1,C=0;C<b;x=C++){let M=v[x],w=v[C],E=w.x-M.x,I=w.y-M.y;if(Math.abs(I)>Number.EPSILON){if(I<0&&(M=v[C],E=-E,w=v[x],I=-I),_.y<M.y||_.y>w.y)continue;if(_.y===M.y){if(_.x===M.x)return!0}else{const F=I*(_.x-M.x)-E*(_.y-M.y);if(0===F)return!0;if(F<0)continue;y=!y}}else{if(_.y!==M.y)continue;if(w.x<=_.x&&_.x<=M.x||M.x<=_.x&&_.x<=w.x)return!0}}return y}const r=Ba.isClockWise,s=this.subPaths;if(0===s.length)return[];let o,a,l;const c=[];if(1===s.length)return a=s[0],l=new eu,l.curves=a.curves,c.push(l),c;let d=!r(s[0].getPoints());d=e?!d:d;const u=[],h=[];let p,g,f=[],m=0;h[m]=void 0,f[m]=[];for(let _=0,v=s.length;_<v;_++)a=s[_],p=a.getPoints(),o=r(p),o=e?!o:o,o?(!d&&h[m]&&m++,h[m]={s:new eu,p},h[m].s.curves=a.curves,d&&m++,f[m]=[]):f[m].push({h:a,p:p[0]});if(!h[0])return function t(_){const v=[];for(let b=0,y=_.length;b<y;b++){const x=_[b],C=new eu;C.curves=x.curves,v.push(C)}return v}(s);if(h.length>1){let _=!1,v=0;for(let b=0,y=h.length;b<y;b++)u[b]=[];for(let b=0,y=h.length;b<y;b++){const x=f[b];for(let C=0;C<x.length;C++){const M=x[C];let w=!0;for(let E=0;E<h.length;E++)n(M.p,h[E].p)&&(b!==E&&v++,w?(w=!1,u[E].push(M)):_=!0);w&&u[b].push(M)}}v>0&&!1===_&&(f=u)}for(let _=0,v=h.length;_<v;_++){l=h[_].s,c.push(l),g=f[_];for(let b=0,y=g.length;b<y;b++)l.holes.push(g[b].h)}return c}}const Rl=lle();function lle(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(n[l]=0,n[256|l]=32768,r[l]=24,r[256|l]=24):c<-14?(n[l]=1024>>-c-14,n[256|l]=1024>>-c-14|32768,r[l]=-c-1,r[256|l]=-c-1):c<=15?(n[l]=c+15<<10,n[256|l]=c+15<<10|32768,r[l]=13,r[256|l]=13):c<128?(n[l]=31744,n[256|l]=64512,r[l]=24,r[256|l]=24):(n[l]=31744,n[256|l]=64512,r[l]=13,r[256|l]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,d=0;for(;!(8388608&c);)c<<=1,d-=8388608;c&=-8388609,d+=947912704,s[l]=c|d}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}var cs=Object.freeze({__proto__:null,toHalfFloat:function cle(i){Math.abs(i)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),i=Wn(i,-65504,65504),Rl.floatView[0]=i;const e=Rl.uint32View[0],t=e>>23&511;return Rl.baseTable[t]+((8388607&e)>>Rl.shiftTable[t])},fromHalfFloat:function dle(i){const e=i>>10;return Rl.uint32View[0]=Rl.mantissaTable[Rl.offsetTable[e]+(1023&i)]+Rl.exponentTable[e],Rl.floatView[0]}});function ule(){console.error("THREE.ImmediateRenderObject has been removed.")}class hle extends Gt{constructor(e,t,n){console.error('THREE.WebGLMultisampleRenderTarget has been removed. Use a normal render target and set the "samples" property to greater 0 to enable multisampling.'),super(e,t,n),this.samples=4}}class e5 extends Mf{constructor(e,t,n,r){console.warn("THREE.DataTexture2DArray has been renamed to DataArrayTexture."),super(e,t,n,r)}}class t5 extends Ef{constructor(e,t,n,r){console.warn("THREE.DataTexture3D has been renamed to Data3DTexture."),super(e,t,n,r)}}class fle extends Ki{constructor(e,t,n,r,s,o){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(e,t,n,r,s,o)}}class ple extends Zf{constructor(e,t,n,r){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(e,t,n,r)}}class mle extends Kf{constructor(e,t,n,r){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(e,t,n,r)}}class gle extends $f{constructor(e,t,n,r,s,o,a){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(e,t,n,r,s,o,a)}}class _le extends jn{constructor(e,t,n,r,s,o,a,l){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(e,t,n,r,s,o,a,l)}}class ble extends Jf{constructor(e,t){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(e,t)}}class vle extends iu{constructor(e,t){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(e,t)}}class yle extends tp{constructor(e,t){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(e,t)}}class Ale extends Jd{constructor(e,t,n,r){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(e,t,n,r)}}class xle extends ia{constructor(e,t){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(e,t)}}class wle extends gc{constructor(e,t,n,r){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(e,t,n,r)}}class Cle extends Fa{constructor(e,t,n,r){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(e,t,n,r)}}class Mle extends ip{constructor(e,t,n,r,s,o){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(e,t,n,r,s,o)}}class Ele extends np{constructor(e,t){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(e,t)}}class Sle extends vc{constructor(e,t,n,r,s,o,a){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(e,t,n,r,s,o,a)}}class Tle extends rp{constructor(e,t){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(e,t)}}class Ile extends na{constructor(e,t,n,r,s){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(e,t,n,r,s)}}class Rle extends sp{constructor(e,t,n,r,s,o){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(e,t,n,r,s,o)}}class Dle extends op{constructor(e,t,n,r,s){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(e,t,n,r,s)}}function n5(i){return!(!i||!i.set)}function Qe(i,e){return n5(i)?void 0===e?i:Array.isArray(e)?(i.set(...e),i):i.copy&&e?(i.copy(e),i):void 0!==e?(i.set(e),i):i:e}function S0(i){return void 0!==i&&(i.observed||i.observers?.length>0)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:nA}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=nA);const FI={now:()=>(FI.delegate||Date).now(),delegate:void 0};class BI extends Wt{constructor(e=1/0,t=1/0,n=FI){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:n,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:o}=this;t||(n.push(e),!r&&n.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:r}=this,s=r.slice();for(let o=0;o<s.length&&!e.closed;o+=n?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<n.length&&n.splice(0,n.length-s),!r){const o=t.now();let a=0;for(let l=1;l<n.length&&n[l]<=o;l+=2)a=l;a&&n.splice(0,a+1)}}}class kle{constructor(){this.memberMap=new Map,this.children=[],this.eventListener={},this.add=(...e)=>(this.objRef&&this.objRef.add(...e),this.children.push(...e),this),this.remove=(...e)=>{this.objRef&&this.objRef.remove(...e);for(const t of e){const n=this.children.indexOf(t);n>=0&&(this.children=this.children.splice(n,1))}return this},this.applyToObject3D=e=>{if(this.memberMap.forEach((t,n)=>{const r=e[n];n5(r)?Qe(r,t):e[n]=t}),this.children.forEach(t=>e.add(t)),this.objRef?.parent){const t=this.objRef?.parent;t.remove(this.objRef),t.add(e)}},this.addEventListener=(e,t)=>{let n=this.eventListener[e];n||(n=[],this.eventListener[e]=n),n.push(t),this.objRef&&this.objRef.addEventListener(e,t)},this.removeEventListener=(e,t)=>{const n=this.eventListener[e];if(!n)return;const r=n.indexOf(t);r>=0&&n.splice(r,1)}}get(e,t,n){switch(t){case"__isProxy":return!0;case"applyToObject3D":return this.applyToObject3D;case"objRef":return this.objRef;case"add":return this.add;case"remove":return this.remove;case"children":return this.objRef?this.objRef.children:this.children;default:{const r=t;let s=this.objRef?this.objRef[r]:this.memberMap.get(r);return void 0===s&&(s=e[r],void 0!==s&&this.memberMap.set(r,s)),s??e[r]}}}set(e,t,n,r){return"objRef"===t?(n&&this.applyToObject3D(n),this.objRef=n):(this.memberMap.set(t,n),this.objRef&&(this.objRef[t]=n)),!0}}function r5(){return new Proxy(new wi,new kle)}function LI(i){return!0===i.__isProxy&&void 0===i.objRef}class Eo{set objRef(e){this.applyObjRef(e)}get objRef(){return this._objRef}constructor(){this.autoAddToParent=!0,this.autoDispose=!0}addToParent(){}removeFromParent(){}set threeEvents(e){this.removeEvents(),this.eventListeners=e,this.applyEvents()}get threeEvents(){return this.eventListeners}get onUpdate(){return this.updateEmitter||(this.updateEmitter=new Ct),this.updateEmitter}get objRef$(){return this._objRef$||(this._objRef$=new BI(1)),this._objRef$}ngOnInit(){this.objRef||(this.objRef=this.createThreeInstance(this.args))}getType(){throw new Error("derive me")}createThreeInstance(e){return Array.isArray(e)?new(this.getType())(...e):new(this.getType())(e)}ngOnChanges(e){if(!this.objRef||LI(this.objRef)){e.objRef?.currentValue?this.objRef=e.objRef?.currentValue:this.objRef||(this.objRef=this.createThreeInstance(e.args?.currentValue));for(const t in e)this[t]=e[t].currentValue;this.emitPropertyChanges(e)}else this.emitPropertyChanges(e)}disposeObjRef(){(function Ple(i){return!(!i||"function"!=typeof i.dispose)})(this.objRef)&&this.objRef.dispose()}ngOnDestroy(){this.removeEvents(),this.removeFromParent(),this.autoDispose&&this.disposeObjRef()}applyObjRef(e){this._objRef!==e&&(this.removeFromParent(),this._objRef=e,this.autoAddToParent&&this.addToParent()),this.emitObjRefChange()}emitObjRefChange(){this._objRef&&!LI(this._objRef)&&(this._objRef.dispatchEvent?.({type:"loaded",object:this._objRef}),this._objRef$&&this._objRef$.next(this._objRef))}emitPropertyChanges(e){this._objRef&&this._objRef.dispatchEvent?.({type:"changes",changes:e}),this.updateEmitter&&this.updateEmitter.next(e)}removeEvents(){if(this.eventListeners&&this._objRef){for(const e of Object.entries(this.eventListeners))this._objRef.removeEventListener(e[0],e[1]);this.eventListeners=void 0}}applyEvents(){if(this.eventListeners&&this._objRef)for(const e of Object.entries(this.eventListeners))this._objRef.addEventListener(e[0],e[1])}}Eo.\u0275fac=function(e){return new(e||Eo)},Eo.\u0275cmp=$({type:Eo,selectors:[["th-abs-wrapper"]],inputs:{autoAddToParent:"autoAddToParent",autoDispose:"autoDispose",objRef:"objRef",args:"args",threeEvents:"threeEvents"},outputs:{onUpdate:"onUpdate",objRef$:"objRef$"},features:[Pr],decls:0,vars:0,template:function(e,t){},encapsulation:2});class hp extends Eo{constructor(e){super(),this.parent=e}addToParent(){this._objRef&&this.parent.objRef&&(!this._objRef.parent||this._objRef.parent.uuid!==this.parent.objRef.uuid)&&this.parent.objRef.add(this._objRef)}removeFromParent(){this._objRef?.parent?.remove(this._objRef)}applyObjRef(e){(this._objRef!==e||this._objRef?.parent?.uuid!==this.parent.objRef.uuid)&&(this.removeFromParent(),this._objRef=e,this.autoAddToParent&&this.addToParent()),this.emitObjRefChange()}attachToParent(e,t){!this.parent.objRef||e===t&&t?.parent?.uuid===this.parent.objRef.uuid||(t&&t.parent&&t.parent.remove(t),e&&(!e.parent||e.parent&&e.parent.uuid!==this.parent.objRef.uuid)&&this.parent.objRef.add(e))}set lookAt(e){Promise.resolve().then(()=>{this.objRef&&(Array.isArray(e)?this.objRef.lookAt(...e):this.objRef.lookAt(e))})}}hp.\u0275fac=function(e){return new(e||hp)(R(hp))},hp.\u0275cmp=$({type:hp,selectors:[["th-abs-object"]],inputs:{lookAt:"lookAt"},features:[W],decls:0,vars:0,template:function(e,t){},encapsulation:2});class Ye extends hp{getType(){return wi}set id(e){this._objRef&&(this._objRef.id=e)}set uuid(e){this._objRef&&(this._objRef.uuid=e)}set name(e){this._objRef&&(this._objRef.name=e)}set type(e){this._objRef&&(this._objRef.type=e)}set children(e){this._objRef&&(this._objRef.children=e)}set up(e){this._objRef&&(this._objRef.up=Qe(this._objRef.up,e))}set position(e){this._objRef&&Qe(this._objRef.position,e)}set rotation(e){this._objRef&&Qe(this._objRef.rotation,e)}set quaternion(e){this._objRef&&Qe(this._objRef.quaternion,e)}set scale(e){this._objRef&&Qe(this._objRef.scale,e)}set modelViewMatrix(e){this._objRef&&Qe(this._objRef.modelViewMatrix,e)}set normalMatrix(e){this._objRef&&Qe(this._objRef.normalMatrix,e)}set matrix(e){this._objRef&&(this._objRef.matrix=Qe(this._objRef.matrix,e))}set matrixWorld(e){this._objRef&&(this._objRef.matrixWorld=Qe(this._objRef.matrixWorld,e))}set matrixAutoUpdate(e){this._objRef&&(this._objRef.matrixAutoUpdate=e)}set matrixWorldAutoUpdate(e){this._objRef&&(this._objRef.matrixWorldAutoUpdate=e)}set matrixWorldNeedsUpdate(e){this._objRef&&(this._objRef.matrixWorldNeedsUpdate=e)}set layers(e){this._objRef&&(this._objRef.layers=Qe(this._objRef.layers,e))}set visible(e){this._objRef&&(this._objRef.visible=e)}set castShadow(e){this._objRef&&(this._objRef.castShadow=e)}set receiveShadow(e){this._objRef&&(this._objRef.receiveShadow=e)}set frustumCulled(e){this._objRef&&(this._objRef.frustumCulled=e)}set renderOrder(e){this._objRef&&(this._objRef.renderOrder=e)}set animations(e){this._objRef&&(this._objRef.animations=e)}set userData(e){this._objRef&&(this._objRef.userData=e)}set customDepthMaterial(e){this._objRef&&(this._objRef.customDepthMaterial=e)}set customDistanceMaterial(e){this._objRef&&(this._objRef.customDistanceMaterial=e)}set onBeforeRender(e){this._objRef&&(this._objRef.onBeforeRender=e)}set onAfterRender(e){this._objRef&&(this._objRef.onAfterRender=e)}constructor(e){super(e)}}Ye.\u0275fac=function(e){return new(e||Ye)(R(Ye,4))},Ye.\u0275cmp=$({type:Ye,selectors:[["th-object3D"]],inputs:{id:"id",uuid:"uuid",name:"name",type:"type",children:"children",up:"up",position:"position",rotation:"rotation",quaternion:"quaternion",scale:"scale",modelViewMatrix:"modelViewMatrix",normalMatrix:"normalMatrix",matrix:"matrix",matrixWorld:"matrixWorld",matrixAutoUpdate:"matrixAutoUpdate",matrixWorldAutoUpdate:"matrixWorldAutoUpdate",matrixWorldNeedsUpdate:"matrixWorldNeedsUpdate",layers:"layers",visible:"visible",castShadow:"castShadow",receiveShadow:"receiveShadow",frustumCulled:"frustumCulled",renderOrder:"renderOrder",animations:"animations",userData:"userData",customDepthMaterial:"customDepthMaterial",customDistanceMaterial:"customDistanceMaterial",onBeforeRender:"onBeforeRender",onAfterRender:"onAfterRender"},features:[se([]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Ms extends Ye{getType(){return o0}set matrixWorldInverse(e){this._objRef&&(this._objRef.matrixWorldInverse=Qe(this._objRef.matrixWorldInverse,e))}set projectionMatrix(e){this._objRef&&(this._objRef.projectionMatrix=Qe(this._objRef.projectionMatrix,e))}set projectionMatrixInverse(e){this._objRef&&(this._objRef.projectionMatrixInverse=Qe(this._objRef.projectionMatrixInverse,e))}}Ms.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Ms)))(t||Ms)}}(),Ms.\u0275cmp=$({type:Ms,selectors:[["th-camera"]],inputs:{matrixWorldInverse:"matrixWorldInverse",projectionMatrix:"projectionMatrix",projectionMatrixInverse:"projectionMatrixInverse"},features:[se([{provide:Ye,useExisting:le(()=>Ms)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class rn extends Ms{getType(){return Sn}set type(e){this._objRef&&(this._objRef.type=e)}set zoom(e){this._objRef&&(this._objRef.zoom=e)}set fov(e){this._objRef&&(this._objRef.fov=e)}set aspect(e){this._objRef&&(this._objRef.aspect=e)}set near(e){this._objRef&&(this._objRef.near=e)}set far(e){this._objRef&&(this._objRef.far=e)}set focus(e){this._objRef&&(this._objRef.focus=e)}set view(e){this._objRef&&(this._objRef.view=e)}set filmGauge(e){this._objRef&&(this._objRef.filmGauge=e)}set filmOffset(e){this._objRef&&(this._objRef.filmOffset=e)}}rn.\u0275fac=function(){let i;return function(t){return(i||(i=ce(rn)))(t||rn)}}(),rn.\u0275cmp=$({type:rn,selectors:[["th-perspectiveCamera"]],inputs:{type:"type",zoom:"zoom",fov:"fov",aspect:"aspect",near:"near",far:"far",focus:"focus",view:"view",filmGauge:"filmGauge",filmOffset:"filmOffset"},features:[se([{provide:Ye,useExisting:le(()=>rn)},{provide:Ms,useExisting:le(()=>rn)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Ac extends Ye{getType(){return Nn}set geometry(e){this._objRef&&(this._objRef.geometry=e)}set material(e){this._objRef&&(this._objRef.material=e)}set type(e){this._objRef&&(this._objRef.type=e)}set morphTargetInfluences(e){this._objRef&&(this._objRef.morphTargetInfluences=e)}set morphTargetDictionary(e){this._objRef&&(this._objRef.morphTargetDictionary=e)}}Ac.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Ac)))(t||Ac)}}(),Ac.\u0275cmp=$({type:Ac,selectors:[["th-line"]],inputs:{geometry:"geometry",material:"material",type:"type",morphTargetInfluences:"morphTargetInfluences",morphTargetDictionary:"morphTargetDictionary"},features:[se([{provide:Ye,useExisting:le(()=>Ac)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Es extends Ac{getType(){return ws}set type(e){this._objRef&&(this._objRef.type=e)}}Es.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Es)))(t||Es)}}(),Es.\u0275cmp=$({type:Es,selectors:[["th-lineSegments"]],inputs:{type:"type"},features:[se([{provide:Ye,useExisting:le(()=>Es)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class io extends Es{getType(){return PI}set type(e){this._objRef&&(this._objRef.type=e)}}io.\u0275fac=function(){let i;return function(t){return(i||(i=ce(io)))(t||io)}}(),io.\u0275cmp=$({type:io,selectors:[["th-gridHelper"]],inputs:{type:"type"},features:[se([{provide:Ye,useExisting:le(()=>io)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Ss extends Ye{getType(){return Il}set type(e){this._objRef&&(this._objRef.type=e)}set color(e){this._objRef&&(this._objRef.color=Qe(this._objRef.color,e))}set intensity(e){this._objRef&&(this._objRef.intensity=e)}set shadow(e){this._objRef&&(this._objRef.shadow=e)}set shadowCameraFov(e){this._objRef&&(this._objRef.shadowCameraFov=e)}set shadowCameraLeft(e){this._objRef&&(this._objRef.shadowCameraLeft=e)}set shadowCameraRight(e){this._objRef&&(this._objRef.shadowCameraRight=e)}set shadowCameraTop(e){this._objRef&&(this._objRef.shadowCameraTop=e)}set shadowCameraBottom(e){this._objRef&&(this._objRef.shadowCameraBottom=e)}set shadowCameraNear(e){this._objRef&&(this._objRef.shadowCameraNear=e)}set shadowCameraFar(e){this._objRef&&(this._objRef.shadowCameraFar=e)}set shadowBias(e){this._objRef&&(this._objRef.shadowBias=e)}set shadowMapWidth(e){this._objRef&&(this._objRef.shadowMapWidth=e)}set shadowMapHeight(e){this._objRef&&(this._objRef.shadowMapHeight=e)}}Ss.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Ss)))(t||Ss)}}(),Ss.\u0275cmp=$({type:Ss,selectors:[["th-light"]],inputs:{type:"type",color:"color",intensity:"intensity",shadow:"shadow",shadowCameraFov:"shadowCameraFov",shadowCameraLeft:"shadowCameraLeft",shadowCameraRight:"shadowCameraRight",shadowCameraTop:"shadowCameraTop",shadowCameraBottom:"shadowCameraBottom",shadowCameraNear:"shadowCameraNear",shadowCameraFar:"shadowCameraFar",shadowBias:"shadowBias",shadowMapWidth:"shadowMapWidth",shadowMapHeight:"shadowMapHeight"},features:[se([{provide:Ye,useExisting:le(()=>Ss)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Dl extends Ss{getType(){return vI}set type(e){this._objRef&&(this._objRef.type=e)}set position(e){this._objRef&&(this._objRef.position=Qe(this._objRef.position,e))}set groundColor(e){this._objRef&&(this._objRef.groundColor=Qe(this._objRef.groundColor,e))}}Dl.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Dl)))(t||Dl)}}(),Dl.\u0275cmp=$({type:Dl,selectors:[["th-hemisphereLight"]],inputs:{type:"type",position:"position",groundColor:"groundColor"},features:[se([{provide:Ye,useExisting:le(()=>Dl)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Ts extends Ss{getType(){return M0}set type(e){this._objRef&&(this._objRef.type=e)}set position(e){this._objRef&&Qe(this._objRef.position,e)}set target(e){this._objRef&&(this._objRef.target=e)}set intensity(e){this._objRef&&(this._objRef.intensity=e)}set shadow(e){this._objRef&&(this._objRef.shadow=e)}}Ts.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Ts)))(t||Ts)}}(),Ts.\u0275cmp=$({type:Ts,selectors:[["th-directionalLight"]],inputs:{type:"type",position:"position",target:"target",intensity:"intensity",shadow:"shadow"},features:[se([{provide:Ye,useExisting:le(()=>Ts)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Vn extends Ye{getType(){return Ke}set geometry(e){this._objRef&&(this._objRef.geometry=e)}set material(e){this._objRef&&(this._objRef.material=e)}set morphTargetInfluences(e){this._objRef&&(this._objRef.morphTargetInfluences=e)}set morphTargetDictionary(e){this._objRef&&(this._objRef.morphTargetDictionary=e)}set type(e){this._objRef&&(this._objRef.type=e)}}Vn.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Vn)))(t||Vn)}}(),Vn.\u0275cmp=$({type:Vn,selectors:[["th-mesh"]],inputs:{geometry:"geometry",material:"material",morphTargetInfluences:"morphTargetInfluences",morphTargetDictionary:"morphTargetDictionary",type:"type"},features:[se([{provide:Ye,useExisting:le(()=>Vn)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class mn extends Ye{getType(){return YA}set type(e){this._objRef&&(this._objRef.type=e)}set fog(e){this._objRef&&(this._objRef.fog=e)}set backgroundBlurriness(e){this._objRef&&(this._objRef.backgroundBlurriness=e)}set backgroundIntensity(e){this._objRef&&(this._objRef.backgroundIntensity=e)}set overrideMaterial(e){this._objRef&&(this._objRef.overrideMaterial=e)}set background(e){this._objRef&&(this._objRef.background=Qe(this._objRef.background,e))}set environment(e){this._objRef&&(this._objRef.environment=e)}}mn.\u0275fac=function(){let i;return function(t){return(i||(i=ce(mn)))(t||mn)}}(),mn.\u0275cmp=$({type:mn,selectors:[["th-scene"]],inputs:{type:"type",fog:"fog",backgroundBlurriness:"backgroundBlurriness",backgroundIntensity:"backgroundIntensity",overrideMaterial:"overrideMaterial",background:"background",environment:"environment"},features:[se([{provide:Ye,useExisting:le(()=>mn)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class T0 extends Eo{constructor(e){super(),this.parent=e}addToParent(){if(!this.parent.objRef)throw new Error("parent object doesn't hold a three js object instance");this.parent.objRef.material=this.objRef}removeFromParent(){this._objRef&&this.parent&&this.parent.objRef&&(this.parent.objRef.material=void 0)}}T0.\u0275fac=function(e){return new(e||T0)(R(Ye))},T0.\u0275cmp=$({type:T0,selectors:[["th-abs-material"]],features:[W],decls:0,vars:0,template:function(e,t){},encapsulation:2});class Ei extends T0{getType(){return On}set alphaTest(e){this._objRef&&(this._objRef.alphaTest=e)}set alphaToCoverage(e){this._objRef&&(this._objRef.alphaToCoverage=e)}set blendDst(e){this._objRef&&(this._objRef.blendDst=e)}set blendDstAlpha(e){this._objRef&&(this._objRef.blendDstAlpha=e)}set blendEquation(e){this._objRef&&(this._objRef.blendEquation=e)}set blendEquationAlpha(e){this._objRef&&(this._objRef.blendEquationAlpha=e)}set blending(e){this._objRef&&(this._objRef.blending=e)}set blendSrc(e){this._objRef&&(this._objRef.blendSrc=e)}set blendSrcAlpha(e){this._objRef&&(this._objRef.blendSrcAlpha=e)}set clipIntersection(e){this._objRef&&(this._objRef.clipIntersection=e)}set clippingPlanes(e){this._objRef&&(this._objRef.clippingPlanes=e)}set clipShadows(e){this._objRef&&(this._objRef.clipShadows=e)}set colorWrite(e){this._objRef&&(this._objRef.colorWrite=e)}set defines(e){this._objRef&&(this._objRef.defines=e)}set depthFunc(e){this._objRef&&(this._objRef.depthFunc=e)}set depthTest(e){this._objRef&&(this._objRef.depthTest=e)}set depthWrite(e){this._objRef&&(this._objRef.depthWrite=e)}set id(e){this._objRef&&(this._objRef.id=e)}set stencilWrite(e){this._objRef&&(this._objRef.stencilWrite=e)}set stencilFunc(e){this._objRef&&(this._objRef.stencilFunc=e)}set stencilRef(e){this._objRef&&(this._objRef.stencilRef=e)}set stencilWriteMask(e){this._objRef&&(this._objRef.stencilWriteMask=e)}set stencilFuncMask(e){this._objRef&&(this._objRef.stencilFuncMask=e)}set stencilFail(e){this._objRef&&(this._objRef.stencilFail=e)}set stencilZFail(e){this._objRef&&(this._objRef.stencilZFail=e)}set stencilZPass(e){this._objRef&&(this._objRef.stencilZPass=e)}set name(e){this._objRef&&(this._objRef.name=e)}set needsUpdate(e){this._objRef&&(this._objRef.needsUpdate=e)}set opacity(e){this._objRef&&(this._objRef.opacity=e)}set polygonOffset(e){this._objRef&&(this._objRef.polygonOffset=e)}set polygonOffsetFactor(e){this._objRef&&(this._objRef.polygonOffsetFactor=e)}set polygonOffsetUnits(e){this._objRef&&(this._objRef.polygonOffsetUnits=e)}set precision(e){this._objRef&&(this._objRef.precision=e)}set premultipliedAlpha(e){this._objRef&&(this._objRef.premultipliedAlpha=e)}set dithering(e){this._objRef&&(this._objRef.dithering=e)}set side(e){this._objRef&&(this._objRef.side=e)}set shadowSide(e){this._objRef&&(this._objRef.shadowSide=e)}set toneMapped(e){this._objRef&&(this._objRef.toneMapped=e)}set transparent(e){this._objRef&&(this._objRef.transparent=e)}set type(e){this._objRef&&(this._objRef.type=e)}set uuid(e){this._objRef&&(this._objRef.uuid=e)}set vertexColors(e){this._objRef&&(this._objRef.vertexColors=e)}set visible(e){this._objRef&&(this._objRef.visible=e)}set userData(e){this._objRef&&(this._objRef.userData=e)}set version(e){this._objRef&&(this._objRef.version=e)}constructor(e){super(e)}}Ei.\u0275fac=function(e){return new(e||Ei)(R(Ye,4))},Ei.\u0275cmp=$({type:Ei,selectors:[["th-material"]],inputs:{alphaTest:"alphaTest",alphaToCoverage:"alphaToCoverage",blendDst:"blendDst",blendDstAlpha:"blendDstAlpha",blendEquation:"blendEquation",blendEquationAlpha:"blendEquationAlpha",blending:"blending",blendSrc:"blendSrc",blendSrcAlpha:"blendSrcAlpha",clipIntersection:"clipIntersection",clippingPlanes:"clippingPlanes",clipShadows:"clipShadows",colorWrite:"colorWrite",defines:"defines",depthFunc:"depthFunc",depthTest:"depthTest",depthWrite:"depthWrite",id:"id",stencilWrite:"stencilWrite",stencilFunc:"stencilFunc",stencilRef:"stencilRef",stencilWriteMask:"stencilWriteMask",stencilFuncMask:"stencilFuncMask",stencilFail:"stencilFail",stencilZFail:"stencilZFail",stencilZPass:"stencilZPass",name:"name",needsUpdate:"needsUpdate",opacity:"opacity",polygonOffset:"polygonOffset",polygonOffsetFactor:"polygonOffsetFactor",polygonOffsetUnits:"polygonOffsetUnits",precision:"precision",premultipliedAlpha:"premultipliedAlpha",dithering:"dithering",side:"side",shadowSide:"shadowSide",toneMapped:"toneMapped",transparent:"transparent",type:"type",uuid:"uuid",vertexColors:"vertexColors",visible:"visible",userData:"userData",version:"version"},features:[se([]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class no extends Ei{getType(){return nu}set type(e){this._objRef&&(this._objRef.type=e)}set color(e){this._objRef&&(this._objRef.color=Qe(this._objRef.color,e))}set specular(e){this._objRef&&(this._objRef.specular=Qe(this._objRef.specular,e))}set shininess(e){this._objRef&&(this._objRef.shininess=e)}set map(e){this._objRef&&(this._objRef.map=e)}set lightMap(e){this._objRef&&(this._objRef.lightMap=e)}set lightMapIntensity(e){this._objRef&&(this._objRef.lightMapIntensity=e)}set aoMap(e){this._objRef&&(this._objRef.aoMap=e)}set aoMapIntensity(e){this._objRef&&(this._objRef.aoMapIntensity=e)}set emissive(e){this._objRef&&(this._objRef.emissive=Qe(this._objRef.emissive,e))}set emissiveIntensity(e){this._objRef&&(this._objRef.emissiveIntensity=e)}set emissiveMap(e){this._objRef&&(this._objRef.emissiveMap=e)}set bumpMap(e){this._objRef&&(this._objRef.bumpMap=e)}set bumpScale(e){this._objRef&&(this._objRef.bumpScale=e)}set normalMap(e){this._objRef&&(this._objRef.normalMap=e)}set normalMapType(e){this._objRef&&(this._objRef.normalMapType=e)}set normalScale(e){this._objRef&&(this._objRef.normalScale=Qe(this._objRef.normalScale,e))}set displacementMap(e){this._objRef&&(this._objRef.displacementMap=e)}set displacementScale(e){this._objRef&&(this._objRef.displacementScale=e)}set displacementBias(e){this._objRef&&(this._objRef.displacementBias=e)}set specularMap(e){this._objRef&&(this._objRef.specularMap=e)}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}set envMap(e){this._objRef&&(this._objRef.envMap=e)}set combine(e){this._objRef&&(this._objRef.combine=e)}set reflectivity(e){this._objRef&&(this._objRef.reflectivity=e)}set refractionRatio(e){this._objRef&&(this._objRef.refractionRatio=e)}set wireframe(e){this._objRef&&(this._objRef.wireframe=e)}set wireframeLinewidth(e){this._objRef&&(this._objRef.wireframeLinewidth=e)}set wireframeLinecap(e){this._objRef&&(this._objRef.wireframeLinecap=e)}set wireframeLinejoin(e){this._objRef&&(this._objRef.wireframeLinejoin=e)}set flatShading(e){this._objRef&&(this._objRef.flatShading=e)}set metal(e){this._objRef&&(this._objRef.metal=e)}set fog(e){this._objRef&&(this._objRef.fog=e)}}no.\u0275fac=function(){let i;return function(t){return(i||(i=ce(no)))(t||no)}}(),no.\u0275cmp=$({type:no,selectors:[["th-meshPhongMaterial"]],inputs:{type:"type",color:"color",specular:"specular",shininess:"shininess",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",emissive:"emissive",emissiveIntensity:"emissiveIntensity",emissiveMap:"emissiveMap",bumpMap:"bumpMap",bumpScale:"bumpScale",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",specularMap:"specularMap",alphaMap:"alphaMap",envMap:"envMap",combine:"combine",reflectivity:"reflectivity",refractionRatio:"refractionRatio",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",flatShading:"flatShading",metal:"metal",fog:"fog"},features:[se([{provide:Ei,useExisting:le(()=>no)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class I0 extends Eo{constructor(e){super(),this.parent=e}addToParent(){this.parent.objRef&&(this.parent.objRef.geometry=this.objRef,this.parent.objRef.updateMorphTargets&&this.parent.objRef.updateMorphTargets())}removeFromParent(){this._objRef&&this.parent&&this.parent.objRef&&(this.parent.objRef.geometry=void 0)}}I0.\u0275fac=function(e){return new(e||I0)(R(Ye))},I0.\u0275cmp=$({type:I0,selectors:[["th-abs-geometry"]],features:[W],decls:0,vars:0,template:function(e,t){},encapsulation:2});class Mt extends I0{getType(){return xt}set id(e){this._objRef&&(this._objRef.id=e)}set uuid(e){this._objRef&&(this._objRef.uuid=e)}set name(e){this._objRef&&(this._objRef.name=e)}set type(e){this._objRef&&(this._objRef.type=e)}set index(e){this._objRef&&(this._objRef.index=Qe(this._objRef.index,e))}set attributes(e){this._objRef&&(this._objRef.attributes=e)}set morphAttributes(e){this._objRef&&(this._objRef.morphAttributes=e)}set morphTargetsRelative(e){this._objRef&&(this._objRef.morphTargetsRelative=e)}set groups(e){this._objRef&&(this._objRef.groups=e)}set boundingBox(e){this._objRef&&(this._objRef.boundingBox=Qe(this._objRef.boundingBox,e))}set boundingSphere(e){this._objRef&&(this._objRef.boundingSphere=Qe(this._objRef.boundingSphere,e))}set drawRange(e){this._objRef&&(this._objRef.drawRange=e)}set userData(e){this._objRef&&(this._objRef.userData=e)}set drawcalls(e){this._objRef&&(this._objRef.drawcalls=e)}set offsets(e){this._objRef&&(this._objRef.offsets=e)}constructor(e){super(e)}}Mt.\u0275fac=function(e){return new(e||Mt)(R(Ye,4))},Mt.\u0275cmp=$({type:Mt,selectors:[["th-bufferGeometry"]],inputs:{id:"id",uuid:"uuid",name:"name",type:"type",index:"index",attributes:"attributes",morphAttributes:"morphAttributes",morphTargetsRelative:"morphTargetsRelative",groups:"groups",boundingBox:"boundingBox",boundingSphere:"boundingSphere",drawRange:"drawRange",userData:"userData",drawcalls:"drawcalls",offsets:"offsets"},features:[se([]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class sa extends Mt{getType(){return gc}set type(e){this._objRef&&(this._objRef.type=e)}set parameters(e){this._objRef&&(this._objRef.parameters=e)}}sa.\u0275fac=function(){let i;return function(t){return(i||(i=ce(sa)))(t||sa)}}(),sa.\u0275cmp=$({type:sa,selectors:[["th-planeGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[se([{provide:Mt,useExisting:le(()=>sa)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});var So=(()=>{return(i=So||(So={})).mouseEnter="mouseEnter",i.mouseExit="mouseExit",i.click="click",i.pointerDown="pointerDown",i.pointerUp="pointerUp",So;var i})();const Ix=new Fe("A reference to the raycaster object",{factory:()=>new gu});class ro{constructor(){this.raycaster=Ut(Ix),this.selected=null,this.enabled=!0,this.groups=[],this.paused=!1,this.maxClickDistance=23,this.nid=ro.instanceCnt++,this.onPointerMove=this.onPointerMove.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerUp=this.onPointerUp.bind(this)}ngOnDestroy(){this.disable(),this.unsubscribe()}subscribe(){if(!this.canvas)throw new Error("missing canvas");this.canvas.addEventListener("pointermove",this.onPointerMove),this.canvas.addEventListener("pointerdown",this.onPointerDown),this.canvas.addEventListener("pointerup",this.onPointerUp)}unsubscribe(){if(!this.canvas)throw new Error("missing canvas");this.canvas.removeEventListener("pointermove",this.onPointerMove),this.canvas.removeEventListener("pointerdown",this.onPointerDown),this.canvas.removeEventListener("pointerup",this.onPointerUp)}enable(){this.enabled=!0}disable(){this.enabled=!1}pause(){this.paused=!0}resume(){this.paused=!1}get isEnabled(){return this.enabled}init(e,t){this.camera=e,this.canvas=t,this.subscribe()}addEventTarget(e){this.groups.push(e)}removeEventTarget(e){const t=this.groups.indexOf(e);t>=0&&this.groups.splice(t,1)}onPointerMove(e){if(!this.isReady())return;const t=this.getFirstIntersectedGroup(e.layerX,e.layerY,So.mouseEnter);if((!this.selected||this.selected!==t.target)&&(this.selected&&(this.selected.host.objRef?.dispatchEvent({type:So.mouseExit}),this.selected.emitOnMouseExit(),this.selected=null),t&&t.target)){this.selected=t.target;const n={type:So.mouseEnter,face:t.face};this.selected.host.objRef?.dispatchEvent(n),this.selected.emitOnMouseEnter(n)}}onPointerDown(e){if(this.maxClickDistance=e.width,this.pointerDownEvent=e,!this.isReady())return;const t=this.getFirstIntersectedGroup(e.layerX,e.layerY,So.pointerDown);if(t&&t.target&&t.target.host.objRef){const n={type:So.pointerDown,face:t.face};t.target.host.objRef.dispatchEvent(n),t.target.emitOnPointerDown(n)}}onPointerUp(e){const t=this.pointerDownEvent;if(this.pointerDownEvent=void 0,!this.isReady())return;let n=this.getFirstIntersectedGroup(e.layerX,e.layerY,So.pointerUp);if(n&&n.target&&n.target.host.objRef){const r={type:So.pointerUp,face:n.face};n.target.host.objRef.dispatchEvent(r),n.target.emitOnPointerUp(r)}if(!(this.calcPointerDownUpDinstance(e,t)>this.maxClickDistance)&&(n=this.getFirstIntersectedGroup(e.layerX,e.layerY,So.click),n&&n.target&&n.target.host.objRef)){const r={type:So.click,face:n.face};n.target.host.objRef.dispatchEvent(r),n.target.emitOnClick(r)}}isReady(e){return!!(this.enabled&&(e||!this.paused)&&this.camera&&this.camera.objRef&&this.groups&&this.groups.length>0)}calcPointerDownUpDinstance(e,t){if(!t)return Number.MAX_VALUE;const n=e.layerX-t.layerX,r=e.layerY-t.layerY;return Math.sqrt(n*n+r*r)}getFirstIntersectedGroup(e,t,n){if(!this.camera||!this.canvas||!this.camera.objRef)return{face:null,target:null};const r=new ue(e=e/this.canvas.clientWidth*2-1,t=-t/this.canvas.clientHeight*2+1);this.raycaster.setFromCamera(r,this.camera.objRef);let o,a,s=null;for(const l of this.groups){const c=l.host.objRef;if(!l[n]||!c)continue;const d=this.raycaster.intersectObject(c,!0);d.length>0&&(!o||o.distance>d[0].distance)&&(o=d[0],s=o.face,a=l)}return a?{target:a,face:s}:{target:null,face:null}}}function _n(i){return xn((e,t)=>{fs(i).subscribe(dn(t,()=>t.complete(),eM)),!t.closed&&e.subscribe(t)})}ro.instanceCnt=0,ro.\u0275fac=function(e){return new(e||ro)},ro.\u0275prov=Ne({token:ro,factory:ro.\u0275fac});const s5={alpha:!0,antialias:!0,preserveDrawingBuffer:!0};class To{get canvas(){return this.rendererParameters?.domElement}constructor(e){this.ngZone=e,this.clock=new up,this.destroyed$=new Wt,this.resizeEmitter=new Ct,this.beforeRenderEmitter=new Ct,this.views=[],this.beforeRender$=this.beforeRenderEmitter.pipe(_n(this.destroyed$)),this.resize$=this.resizeEmitter.pipe(_n(this.destroyed$))}get renderer(){return this._renderer}ngOnDestroy(){this.resizeObserver&&this.canvas&&this.resizeObserver.unobserve(this.canvas)}initResizeObserver(){this.ngZone.runOutsideAngular(()=>{if(!this.canvas)throw new Error("missing canvas element");this.resize(),this.resizeObserver||(this.resizeObserver=new ResizeObserver(()=>{this.resize()})),this.resizeObserver.observe(this.canvas)})}initRenderer(){this._renderer||(this._renderer=new VT({canvas:this.rendererParameters?.domElement,...s5}),Object.assign(this._renderer,{...s5,...this.rendererParameters}),this.resize())}setRenderer(e){this.rendererParameters=e,this.initRenderer(),this.initResizeObserver()}addView(e){this.views.push(e);const t=this.calcRendererSize();t&&this.adjustViewDimensions(e,t.width,t.height)}render(){this.beforeRenderEmitter.emit({engine:this,delta:this.clock.getDelta()});for(const e of this.views)this.renderView(e)}renderView(e){if(!this._renderer)return;const t=e.camera,n=e.scene;if(!(t&&n&&t.objRef&&n.objRef))return;const r=this._renderer;S0(e.onRender)&&this.ngZone.run(()=>e.onRender.emit({renderer:r,scene:n,camera:t})),this.applyRendererParametersFromView(e),e.effectComposer?e.effectComposer.render():this._renderer.render(n.objRef,t.objRef)}applyRendererParametersFromView(e){this._renderer&&(e.viewPort&&(e.viewPort instanceof ni?this._renderer.setViewport(e.viewPort):this._renderer.setViewport(e.viewPort.x,e.viewPort.y,e.viewPort.width,e.viewPort.height)),e.scissor&&(e.scissor instanceof ni?this._renderer.setScissor(e.scissor):this._renderer.setScissor(e.scissor.x,e.scissor.y,e.scissor.width,e.scissor.height)),void 0!==e.scissorTest&&this._renderer.setScissorTest(e.scissorTest),e.clearColor&&this._renderer.setClearColor(e.clearColor),void 0!==e.clearAlpha&&this._renderer.setClearAlpha(e.clearAlpha),void 0!==e.shadow&&(this._renderer.shadowMap.enabled=!0))}resize(){if(!this._renderer||!this.canvas)return!1;const{width:e,height:t}=this.calcRendererSize();this._renderer.setSize(e,t,!1);for(const n of this.views)this.adjustViewDimensions(n,e,t);return this.resizeEmitter.emit({width:e,height:t}),!0}calcRendererSize(){if(!this._renderer||!this.canvas)return;const e=window.devicePixelRatio;return{width:(this.canvas.clientWidth??0)*e,height:(this.canvas.clientHeight??0)*e}}adjustViewDimensions(e,t,n){e.viewPort||(e.camera&&e.camera.objRef.aspect&&(e.camera.objRef.aspect=t/n,e.camera.objRef.updateProjectionMatrix()),e.effectComposer?.setSize(t,n))}}To.\u0275fac=function(e){return new(e||To)(ye(at))},To.\u0275prov=Ne({token:To,factory:To.\u0275fac});class oa{constructor(e,t){this.engineService=e,this.ngZone=t,this.active=!0,this.destroyed$=new Wt,this.beforeRender$=this.engineService.beforeRender$,this.engineService.resize$.pipe(_n(this.destroyed$)).subscribe(()=>this.requestAnimationFrame())}ngOnDestroy(){this.stop(),this.destroyed$.next(),this.destroyed$.complete()}start(){this.active||(this.active=!0,this.requestAnimationFrame())}stop(){this.active=!1,void 0!==this.frameId&&(cancelAnimationFrame(this.frameId),this.frameId=void 0)}isActive(){return this.active}requestAnimationFrame(){void 0===this.frameId&&this.ngZone.runOutsideAngular(()=>this.frameId=requestAnimationFrame(()=>{this.frameId=void 0,this.engineService.render(),this.active&&this.requestAnimationFrame()}))}}oa.\u0275fac=function(e){return new(e||oa)(ye(To),ye(at))},oa.\u0275prov=Ne({token:oa,factory:oa.\u0275fac});class Is{constructor(e,t){this.engServ=e,this.raycaster=t,this.onRender=new Ct}set contentScene(e){e&&(this.scene=e)}set effectComposer(e){this._effectComposer=e,this.configureEffectComposerRenderTarget()}get effectComposer(){return this._effectComposer}set camera(e){this._camera=e,this.initRaycaster()}get camera(){return this._camera}set contentCamera(e){e&&(this.camera=e)}set viewPort(e){this._viewPort=e,this.configureEffectComposerRenderTarget()}get viewPort(){return this._viewPort}ngOnInit(){this.initRaycaster()}initRaycaster(){this.camera&&this.engServ.canvas&&this.raycaster.init(this.camera,this.engServ.canvas)}add(e){}remove(e){}configureEffectComposerRenderTarget(){if(this.viewPort&&this.effectComposer){let e,t;this.viewPort instanceof ni?(e=this.viewPort.z,t=this.viewPort?.width):(e=this.viewPort.width,t=this.viewPort.height),this.effectComposer.setSize(e,t)}}}Is.\u0275fac=function(e){return new(e||Is)(R(To),R(ro))},Is.\u0275cmp=$({type:Is,selectors:[["th-view"]],contentQueries:function(e,t,n){if(1&e&&(Fn(n,mn,5),Fn(n,Ms,5)),2&e){let r;Pt(r=kt())&&(t.contentScene=r.first),Pt(r=kt())&&(t.contentCamera=r.first)}},inputs:{scene:"scene",effectComposer:"effectComposer",camera:"camera",shadow:"shadow",viewPort:"viewPort",scissor:"scissor",scissorTest:"scissorTest",clearColor:"clearColor",clearAlpha:"clearAlpha"},outputs:{onRender:"onRender"},features:[se([{provide:Ye,useExisting:le(()=>Is)},{provide:Ix,useValue:new gu},ro])],decls:0,vars:0,template:function(e,t){},encapsulation:2});const Fle=["rendererCanvas"];class Vi extends Is{get obj(){return this}set views(e){e.forEach(t=>this.engServ.addView(t))}set rendererCanvas(e){e&&(this._rendererCanvas=e,e.nativeElement.id+=this.nid)}get rendererCanvas(){return this._rendererCanvas}constructor(e,t,n){super(e,n),this.engServ=e,this.animationLoop=t,this.raycaster=n,this.nid=Vi.instanceCnt++,this.disableDefaultView=!1}ngAfterContentChecked(){this.animationLoop.requestAnimationFrame()}ngAfterViewInit(){this.animationLoop.requestAnimationFrame()}ngOnInit(){this.applyRendererParameters(),super.ngOnInit(),this.disableDefaultView||this.engServ.addView(this)}applyRendererParameters(){if(!this.rendererCanvas)throw new Error("Missing Canvas");this.engServ.setRenderer({...this.rendererParameters,domElement:this.rendererCanvas.nativeElement})}}Vi.instanceCnt=0,Vi.\u0275fac=function(e){return new(e||Vi)(R(To),R(oa),R(le(()=>ro)))},Vi.\u0275cmp=$({type:Vi,selectors:[["th-canvas"]],contentQueries:function(e,t,n){if(1&e&&Fn(n,Is,4),2&e){let r;Pt(r=kt())&&(t.views=r)}},viewQuery:function(e,t){if(1&e&&Di(Fle,7),2&e){let n;Pt(n=kt())&&(t.rendererCanvas=n.first)}},inputs:{rendererParameters:"rendererParameters",disableDefaultView:"disableDefaultView"},features:[se([{provide:Ye,useExisting:le(()=>Vi)},To,oa,{provide:Ix,useValue:new gu},le(()=>ro),{provide:Is,useExisting:le(()=>Vi)}]),W],decls:2,vars:0,consts:[["id","rendererCanvas"],["rendererCanvas",""]],template:function(e,t){1&e&&ze(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{display:flex;flex:auto;line-height:0;height:100%}canvas[_ngcontent-%COMP%]{flex:auto;outline:none;width:100%;height:100%}"],changeDetection:0});var R0=function(){var i=0,e=document.createElement("div");function t(d){return e.appendChild(d.dom),d}function n(d){for(var u=0;u<e.children.length;u++)e.children[u].style.display=u===d?"block":"none";i=d}e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(d){d.preventDefault(),n(++i%e.children.length)},!1);var r=(performance||Date).now(),s=r,o=0,a=t(new R0.Panel("FPS","#0ff","#002")),l=t(new R0.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new R0.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:e,addPanel:t,showPanel:n,begin:function(){r=(performance||Date).now()},end:function(){o++;var d=(performance||Date).now();if(l.update(d-r,200),d>=s+1e3&&(a.update(1e3*o/(d-s),100),s=d,o=0,c)){var u=performance.memory;c.update(u.usedJSHeapSize/1048576,u.jsHeapSizeLimit/1048576)}return d},update:function(){r=this.end()},domElement:e,setMode:n}};R0.Panel=function(i,e,t){var n=1/0,r=0,s=Math.round,o=s(window.devicePixelRatio||1),a=80*o,l=48*o,c=3*o,d=2*o,u=3*o,h=15*o,f=74*o,m=30*o,p=document.createElement("canvas");p.width=a,p.height=l,p.style.cssText="width:80px;height:48px";var g=p.getContext("2d");return g.font="bold "+9*o+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=t,g.fillRect(0,0,a,l),g.fillStyle=e,g.fillText(i,c,d),g.fillRect(u,h,f,m),g.fillStyle=t,g.globalAlpha=.9,g.fillRect(u,h,f,m),{dom:p,update:function(_,v){n=Math.min(n,_),r=Math.max(r,_),g.fillStyle=t,g.globalAlpha=1,g.fillRect(0,0,a,h),g.fillStyle=e,g.fillText(s(_)+" "+i+" ("+s(n)+"-"+s(r)+")",c,d),g.drawImage(p,u+o,h,f-o,m,u,h,f-o,m),g.fillRect(u+f-o,h,o,m),g.fillStyle=t,g.globalAlpha=.9,g.fillRect(u+f-o,h,o,s((1-_/v)*m))}}};const Ble=R0;class Io{constructor(e){this.engineService=e,this.stats=Ble()}ngOnDestroy(){this.renderSubscription&&this.renderSubscription.unsubscribe()}ngOnInit(){if(!this.engineService.canvas)throw new Error("No canvas present");const e=this.engineService.canvas.parentElement;e&&(e.style.position="relative",this.stats.domElement.style.position="absolute",this.stats.showPanel(0),this.engineService.canvas.parentElement?.appendChild(this.stats.dom),this.renderSubscription=this.engineService.beforeRender$.subscribe(()=>{this.stats.update()}))}set thStats(e){this.stats.domElement.style.visibility=e?"visible":"hidden"}}Io.\u0275fac=function(e){return new(e||Io)(R(To))},Io.\u0275dir=ke({type:Io,selectors:[["","thStats",""]],inputs:{thStats:"thStats"}});const o5="https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/assets/",aa="assets/";class Lle extends yr{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Vle(t)}),this.register(function(t){return new Xle(t)}),this.register(function(t){return new Yle(t)}),this.register(function(t){return new Hle(t)}),this.register(function(t){return new Gle(t)}),this.register(function(t){return new Qle(t)}),this.register(function(t){return new Wle(t)}),this.register(function(t){return new Ule(t)}),this.register(function(t){return new qle(t)}),this.register(function(t){return new zle(t)}),this.register(function(t){return new Nle(t)}),this.register(function(t){return new Zle(t)}),this.register(function(t){return new Kle(t)})}load(e,t,n,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:Cs.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new Ar(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(d){t(d),s.manager.itemEnd(e)},a)}catch(d){a(d)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let s;const o={},a={};if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(Cs.decodeText(new Uint8Array(e,0,4))===a5){try{o[Ii.KHR_BINARY_GLTF]=new $le(e)}catch(d){return void(r&&r(d))}s=JSON.parse(o[Ii.KHR_BINARY_GLTF].content)}else s=JSON.parse(Cs.decodeText(new Uint8Array(e)));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new uce(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const d=this.pluginCallbacks[c](l);a[d.name]=d,o[d.name]=!0}if(s.extensionsUsed)for(let c=0;c<s.extensionsUsed.length;++c){const d=s.extensionsUsed[c],u=s.extensionsRequired||[];switch(d){case Ii.KHR_MATERIALS_UNLIT:o[d]=new jle;break;case Ii.KHR_DRACO_MESH_COMPRESSION:o[d]=new Jle(s,this.dracoLoader);break;case Ii.KHR_TEXTURE_TRANSFORM:o[d]=new ece;break;case Ii.KHR_MESH_QUANTIZATION:o[d]=new tce;break;default:u.indexOf(d)>=0&&void 0===a[d]&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(n,r)}parseAsync(e,t){const n=this;return new Promise(function(r,s){n.parse(e,t,r,s)})}}function Ole(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const Ii={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Nle{constructor(e){this.parser=e,this.name=Ii.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const s=t[n];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const d=new De(16777215);void 0!==l.color&&d.fromArray(l.color);const u=void 0!==l.range?l.range:0;switch(l.type){case"directional":c=new M0(d),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new dp(d),c.distance=u;break;case"spot":c=new w0(d),c.distance=u,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,wc(c,l),void 0!==l.intensity&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),t.cache.add(n,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,s=n.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(l){return n._getNodeRef(t.cache,a,l)})}}class jle{constructor(){this.name=Ii.KHR_MATERIALS_UNLIT}getMaterialType(){return Xn}extendParams(e,t,n){const r=[];e.color=new De(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(n.assignTexture(e,"map",s.baseColorTexture,hi))}return Promise.all(r)}}class Ule{constructor(e){this.parser=e,this.name=Ii.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class Vle{constructor(e){this.parser=e,this.name=Ii.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Oa:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new ue(a,a)}return Promise.all(s)}}class zle{constructor(e){this.parser=e,this.name=Ii.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Oa:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class Hle{constructor(e){this.parser=e,this.name=Ii.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Oa:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new De(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];return void 0!==o.sheenColorFactor&&t.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,hi)),void 0!==o.sheenRoughnessTexture&&s.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class Gle{constructor(e){this.parser=e,this.name=Ii.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Oa:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class Qle{constructor(e){this.parser=e,this.name=Ii.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Oa:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new De(a[0],a[1],a[2]),Promise.all(s)}}class Wle{constructor(e){this.parser=e,this.name=Ii.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Oa:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class qle{constructor(e){this.parser=e,this.name=Ii.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Oa:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new De(a[0],a[1],a[2]),void 0!==o.specularColorTexture&&s.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,hi)),Promise.all(s)}}class Xle{constructor(e){this.parser=e,this.name=Ii.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class Yle{constructor(e){this.parser=e,this.name=Ii.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class Zle{constructor(e){this.name=Ii.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const d=r.count,u=r.byteStride,h=new Uint8Array(a,r.byteOffset||0,r.byteLength||0);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(d,u,h,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){const f=new ArrayBuffer(d*u);return o.decodeGltfBuffer(new Uint8Array(f),d,u,h,r.mode,r.filter),f})})}return null}}class Kle{constructor(e){this.name=Ii.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;const r=t.meshes[n.mesh];for(const c of r.primitives)if(c.mode!==Ro.TRIANGLES&&c.mode!==Ro.TRIANGLE_STRIP&&c.mode!==Ro.TRIANGLE_FAN&&void 0!==c.mode)return null;const o=n.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(d=>(l[c]=d,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const d=c.pop(),u=d.isGroup?d.children:[d],h=c[0].count,f=[];for(const m of u){const p=new Ve,g=new T,_=new xi,v=new T(1,1,1),b=new ix(m.geometry,m.material,h);for(let y=0;y<h;y++)l.TRANSLATION&&g.fromBufferAttribute(l.TRANSLATION,y),l.ROTATION&&_.fromBufferAttribute(l.ROTATION,y),l.SCALE&&v.fromBufferAttribute(l.SCALE,y),b.setMatrixAt(y,p.compose(g,_,v));for(const y in l)"TRANSLATION"!==y&&"ROTATION"!==y&&"SCALE"!==y&&m.geometry.setAttribute(y,l[y]);wi.prototype.copy.call(b,m),b.frustumCulled=!1,this.parser.assignFinalMaterial(b),f.push(b)}return d.isGroup?(d.clear(),d.add(...f),d):f[0]}))}}const a5="glTF";class $le{constructor(e){this.name=Ii.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:Cs.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==a5)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-12,r=new DataView(e,12);let s=0;for(;s<n;){const o=r.getUint32(s,!0);s+=4;const a=r.getUint32(s,!0);if(s+=4,1313821514===a){const l=new Uint8Array(e,12+s,o);this.content=Cs.decodeText(l)}else if(5130562===a){const l=12+s;this.body=e.slice(l,l+o)}s+=o}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Jle{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ii.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const d in o){const u=NI[d]||d.toLowerCase();a[u]=o[d]}for(const d in e.attributes){const u=NI[d]||d.toLowerCase();if(void 0!==o[d]){const h=n.accessors[e.attributes[d]];c[u]=fp[h.componentType].name,l[u]=!0===h.normalized}}return t.getDependency("bufferView",s).then(function(d){return new Promise(function(u){r.decodeDracoFile(d,function(h){for(const f in h.attributes){const p=l[f];void 0!==p&&(h.attributes[f].normalized=p)}u(h)},a,c)})})}}class ece{constructor(){this.name=Ii.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class tce{constructor(){this.name=Ii.KHR_MESH_QUANTIZATION}}class c5 extends lp{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=n[s+o];return t}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=2*a,c=3*a,d=r-t,u=(n-t)/d,h=u*u,f=h*u,m=e*c,p=m-c,g=-2*f+3*h,_=f-h,v=1-g,b=_-h+u;for(let y=0;y!==a;y++)s[y]=v*o[p+y+a]+b*(o[p+y+l]*d)+g*o[m+y+a]+_*(o[m+y]*d);return s}}const ice=new xi;class nce extends c5{interpolate_(e,t,n,r){const s=super.interpolate_(e,t,n,r);return ice.fromArray(s).normalize().toArray(s),s}}const Ro={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},fp={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},d5={9728:$t,9729:Li,9984:U_,9985:lA,9986:mf,9987:Xs},u5={33071:gr,33648:pf,10497:Ao},OI={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},NI={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},xc={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},rce={CUBICSPLINE:void 0,LINEAR:Nd,STEP:Af};function P0(i,e,t){for(const n in t.extensions)void 0===i[n]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function wc(i,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function ace(i,e){if(i.updateMorphTargets(),void 0!==e.weights)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function lce(i){const e=i.extensions&&i.extensions[Ii.KHR_DRACO_MESH_COMPRESSION];let t;return t=e?"draco:"+e.bufferView+":"+e.indices+":"+h5(e.attributes):i.indices+":"+h5(i.attributes)+":"+i.mode,t}function h5(i){let e="";const t=Object.keys(i).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+i[t[n]]+";";return e}function UI(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const dce=new Ve;class uce{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Ole,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=!1,s=-1;typeof navigator<"u"&&(n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||n||r&&s<98?new bx(this.options.manager):new b4(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Ar(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:n,userData:{}};P0(s,a,r),wc(a,r),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(n[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),s=(o,a)=>{const l=this.associations.get(o);null!=l&&this.associations.set(a,l);for(const[c,d]of o.children.entries())s(d,a.children[c])};return s(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&n.push(s)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[Ii.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){n.load(Cs.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const s=t.byteOffset||0;return n.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const o=OI[r.type],l=!0===r.normalized,c=new(0,fp[r.componentType])(r.count*o);return Promise.resolve(new Ci(c,o,l))}const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=OI[r.type],c=fp[r.componentType],d=c.BYTES_PER_ELEMENT,h=r.byteOffset||0,f=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,m=!0===r.normalized;let p,g;if(f&&f!==d*l){const _=Math.floor(h/f),v="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+_+":"+r.count;let b=t.cache.get(v);b||(p=new c(a,_*f,r.count*f/d),b=new c0(p,f/d),t.cache.add(v,b)),g=new _c(b,l,h%f/d,m)}else p=null===a?new c(r.count*l):new c(a,h,r.count*l),g=new Ci(p,l,m);if(void 0!==r.sparse){const y=r.sparse.values.byteOffset||0,x=new(0,fp[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*OI.SCALAR),C=new c(o[2],y,r.sparse.count*l);null!==a&&(g=new Ci(g.array.slice(),g.itemSize,g.normalized));for(let M=0,w=x.length;M<w;M++){const E=x[M];if(g.setX(E,C[M*l]),l>=2&&g.setY(E,C[M*l+1]),l>=3&&g.setZ(E,C[M*l+2]),l>=4&&g.setW(E,C[M*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=this.options.manager.getHandler(o.uri);null!==l&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,n){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,n).then(function(d){d.flipY=!1,d.name=o.name||a.name||"";const h=(s.samplers||{})[o.sampler]||{};return d.magFilter=d5[h.magFilter]||Li,d.minFilter=d5[h.minFilter]||Xs,d.wrapS=u5[h.wrapS]||Ao,d.wrapT=u5[h.wrapT]||Ao,r.associations.set(d,{textures:e}),d}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(u=>u.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(void 0!==o.bufferView)l=this.getDependency("bufferView",o.bufferView).then(function(u){c=!0;const h=new Blob([u],{type:o.mimeType});return l=a.createObjectURL(h),l});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const d=Promise.resolve(l).then(function(u){return new Promise(function(h,f){let m=h;!0===t.isImageBitmapLoader&&(m=function(p){const g=new qn(p);g.needsUpdate=!0,h(g)}),t.load(Cs.resolveURL(u,s.path),m,void 0,f)})}).then(function(u){return!0===c&&a.revokeObjectURL(l),u.userData.mimeType=o.mimeType||function cce(i){return i.search(/\.jpe?g($|\?)/i)>0||0===i.search(/^data\:image\/jpeg/)?"image/jpeg":i.search(/\.webp($|\?)/i)>0||0===i.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),u}).catch(function(u){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),u});return this.sourceCache[e]=d,d}assignTexture(e,t,n,r){const s=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(void 0!==n.texCoord&&0!=n.texCoord&&!("aoMap"===t&&1==n.texCoord)&&console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),s.extensions[Ii.KHR_TEXTURE_TRANSFORM]){const a=void 0!==n.extensions?n.extensions[Ii.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[Ii.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return void 0!==r&&(o.encoding=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new El,On.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(a,l)),n=l}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new pn,On.prototype.copy.call(l,n),l.color.copy(n.color),this.cache.add(a,l)),n=l}if(r||s||o){let a="ClonedMaterial:"+n.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=n.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(n))),n=l}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=n}getMaterialType(){return La}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},c=[];if((s.extensions||{})[Ii.KHR_MATERIALS_UNLIT]){const u=r[Ii.KHR_MATERIALS_UNLIT];o=u.getMaterialType(),c.push(u.extendParams(a,s,t))}else{const u=s.pbrMetallicRoughness||{};if(a.color=new De(1,1,1),a.opacity=1,Array.isArray(u.baseColorFactor)){const h=u.baseColorFactor;a.color.fromArray(h),a.opacity=h[3]}void 0!==u.baseColorTexture&&c.push(t.assignTexture(a,"map",u.baseColorTexture,hi)),a.metalness=void 0!==u.metallicFactor?u.metallicFactor:1,a.roughness=void 0!==u.roughnessFactor?u.roughnessFactor:1,void 0!==u.metallicRoughnessTexture&&(c.push(t.assignTexture(a,"metalnessMap",u.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",u.metallicRoughnessTexture))),o=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=rc);const d=s.alphaMode||"OPAQUE";if("BLEND"===d?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===d&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==Xn&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new ue(1,1),void 0!==s.normalTexture.scale)){const u=s.normalTexture.scale;a.normalScale.set(u,u)}return void 0!==s.occlusionTexture&&o!==Xn&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==Xn&&(a.emissive=(new De).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&o!==Xn&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,hi)),Promise.all(c).then(function(){const u=new o(a);return s.name&&(u.name=s.name),wc(u,s),t.associations.set(u,{materials:e}),s.extensions&&P0(r,u,s),u})}createUniqueName(e){const t=Oi.sanitizeNodeName(e||"");let n=t;for(let r=1;this.nodeNamesUsed[n];++r)n=t+"_"+r;return this.nodeNamesUsed[n]=!0,n}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function s(a){return n[Ii.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return f5(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],d=lce(c),u=r[d];if(u)o.push(u.promise);else{let h;h=c.extensions&&c.extensions[Ii.KHR_DRACO_MESH_COMPRESSION]?s(c):f5(new xt,c,t),r[d]={primitive:c,promise:h},o.push(h)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const d=void 0===o[l].material?(void 0===(i=this.cache).DefaultMaterial&&(i.DefaultMaterial=new La({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:_l})),i.DefaultMaterial):this.getDependency("material",o[l].material);a.push(d)}var i;return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),d=l[l.length-1],u=[];for(let f=0,m=d.length;f<m;f++){const p=d[f],g=o[f];let _;const v=c[f];if(g.mode===Ro.TRIANGLES||g.mode===Ro.TRIANGLE_STRIP||g.mode===Ro.TRIANGLE_FAN||void 0===g.mode)_=!0===s.isSkinnedMesh?new f0(p,v):new Ke(p,v),!0===_.isSkinnedMesh&&!_.geometry.attributes.skinWeight.normalized&&_.normalizeSkinWeights(),g.mode===Ro.TRIANGLE_STRIP?_.geometry=p5(_.geometry,Rj):g.mode===Ro.TRIANGLE_FAN&&(_.geometry=p5(_.geometry,aT));else if(g.mode===Ro.LINES)_=new ws(p,v);else if(g.mode===Ro.LINE_STRIP)_=new Nn(p,v);else if(g.mode===Ro.LINE_LOOP)_=new rx(p,v);else{if(g.mode!==Ro.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);_=new $d(p,v)}Object.keys(_.geometry.morphAttributes).length>0&&ace(_,s),_.name=t.createUniqueName(s.name||"mesh_"+e),wc(_,s),g.extensions&&P0(r,_,g),t.assignFinalMaterial(_),u.push(_)}for(let f=0,m=u.length;f<m;f++)t.associations.set(u[f],{meshes:e,primitives:f});if(1===u.length)return u[0];const h=new xs;t.associations.set(h,{meshes:e});for(let f=0,m=u.length;f<m;f++)h.add(u[f]);return h})}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new Sn(gt.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new Pa(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),wc(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let r=0,s=t.joints.length;r<s;r++)n.push(this.getDependency("node",t.joints[r]));return n.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(n).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,d=o.length;c<d;c++){const u=o[c];if(u){a.push(u);const h=new Ve;null!==s&&h.fromArray(s.array,16*c),l.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new Xf(a,l)})}loadAnimation(e){const n=this.json.animations[e],r=[],s=[],o=[],a=[],l=[];for(let c=0,d=n.channels.length;c<d;c++){const u=n.channels[c],h=n.samplers[u.sampler],f=u.target,p=void 0!==n.parameters?n.parameters[h.input]:h.input,g=void 0!==n.parameters?n.parameters[h.output]:h.output;r.push(this.getDependency("node",f.node)),s.push(this.getDependency("accessor",p)),o.push(this.getDependency("accessor",g)),a.push(h),l.push(f)}return Promise.all([Promise.all(r),Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const d=c[0],u=c[1],h=c[2],f=c[3],m=c[4],p=[];for(let _=0,v=d.length;_<v;_++){const b=d[_],y=u[_],x=h[_],C=f[_],M=m[_];if(void 0===b)continue;let w;switch(b.updateMatrix(),xc[M.path]){case xc.weights:w=ou;break;case xc.rotation:w=Sl;break;default:w=lu}const E=b.name?b.name:b.uuid,I=void 0!==C.interpolation?rce[C.interpolation]:Nd,F=[];xc[M.path]===xc.weights?b.traverse(function(B){B.morphTargetInfluences&&F.push(B.name?B.name:B.uuid)}):F.push(E);let Q=x.array;if(x.normalized){const B=UI(Q.constructor),L=new Float32Array(Q.length);for(let X=0,P=Q.length;X<P;X++)L[X]=Q[X]*B;Q=L}for(let B=0,L=F.length;B<L;B++){const X=new w(F[B]+"."+xc[M.path],y.array,Q,I);"CUBICSPLINE"===C.interpolation&&(X.createInterpolant=function(V){return new(this instanceof Sl?nce:c5)(this.times,this.values,this.getValueSize()/3,V)},X.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),p.push(X)}}return new cu(n.name?n.name:"animation_"+e,void 0,p)})}createNodeMesh(e){const n=this,r=this.json.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then(function(s){const o=n._getNodeRef(n.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const n=this.extensions,r=this,s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"";return function(){const a=[],l=r._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});l&&a.push(l),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(h){return r._getNodeRef(r.cameraCache,s.camera,h)})),r._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){a.push(h)});const c=[],d=s.children||[];for(let h=0,f=d.length;h<f;h++)c.push(r.getDependency("node",d[h]));const u=void 0===s.skin?Promise.resolve(null):r.getDependency("skin",s.skin);return Promise.all([Promise.all(a),Promise.all(c),u])}().then(function(a){const l=a[0],c=a[1],d=a[2];let u;if(u=!0===s.isBone?new Kd:l.length>1?new xs:1===l.length?l[0]:new wi,u!==l[0])for(let h=0,f=l.length;h<f;h++)u.add(l[h]);if(s.name&&(u.userData.name=s.name,u.name=o),wc(u,s),s.extensions&&P0(n,u,s),void 0!==s.matrix){const h=new Ve;h.fromArray(s.matrix),u.applyMatrix4(h)}else void 0!==s.translation&&u.position.fromArray(s.translation),void 0!==s.rotation&&u.quaternion.fromArray(s.rotation),void 0!==s.scale&&u.scale.fromArray(s.scale);r.associations.has(u)||r.associations.set(u,{}),r.associations.get(u).nodes=e,null!==d&&u.traverse(function(h){h.isSkinnedMesh&&h.bind(d,dce)});for(let h=0,f=c.length;h<f;h++)u.add(c[h]);return u})}loadScene(e){const t=this.extensions,n=this.json.scenes[e],r=this,s=new xs;n.name&&(s.name=r.createUniqueName(n.name)),wc(s,n),n.extensions&&P0(t,s,n);const o=n.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let d=0,u=l.length;d<u;d++)s.add(l[d]);return r.associations=(d=>{const u=new Map;for(const[h,f]of r.associations)(h instanceof On||h instanceof qn)&&u.set(h,f);return d.traverse(h=>{const f=r.associations.get(h);null!=f&&u.set(h,f)}),u})(s),s})}}function f5(i,e,t){const n=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){i.setAttribute(a,l)})}for(const o in n){const a=NI[o]||o.toLowerCase();a in i.attributes||r.push(s(n[o],a))}if(void 0!==e.indices&&!i.index){const o=t.getDependency("accessor",e.indices).then(function(a){i.setIndex(a)});r.push(o)}return wc(i,e),function hce(i,e,t){const n=e.attributes,r=new Da;if(void 0===n.POSITION)return;{const a=t.json.accessors[n.POSITION],l=a.min,c=a.max;if(void 0===l||void 0===c)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new T(l[0],l[1],l[2]),new T(c[0],c[1],c[2])),a.normalized){const d=UI(fp[a.componentType]);r.min.multiplyScalar(d),r.max.multiplyScalar(d)}}const s=e.targets;if(void 0!==s){const a=new T,l=new T;for(let c=0,d=s.length;c<d;c++){const u=s[c];if(void 0!==u.POSITION){const h=t.json.accessors[u.POSITION],f=h.min,m=h.max;if(void 0!==f&&void 0!==m){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(m[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(m[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(m[2]))),h.normalized){const p=UI(fp[h.componentType]);l.multiplyScalar(p)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}i.boundingBox=r;const o=new Al;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,i.boundingSphere=o}(i,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function oce(i,e,t){let n=!1,r=!1,s=!1;for(let c=0,d=e.length;c<d;c++){const u=e[c];if(void 0!==u.POSITION&&(n=!0),void 0!==u.NORMAL&&(r=!0),void 0!==u.COLOR_0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(i);const o=[],a=[],l=[];for(let c=0,d=e.length;c<d;c++){const u=e[c];if(n){const h=void 0!==u.POSITION?t.getDependency("accessor",u.POSITION):i.attributes.position;o.push(h)}if(r){const h=void 0!==u.NORMAL?t.getDependency("accessor",u.NORMAL):i.attributes.normal;a.push(h)}if(s){const h=void 0!==u.COLOR_0?t.getDependency("accessor",u.COLOR_0):i.attributes.color;l.push(h)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[1],h=c[2];return n&&(i.morphAttributes.position=c[0]),r&&(i.morphAttributes.normal=u),s&&(i.morphAttributes.color=h),i.morphTargetsRelative=!0,i})}(i,e.targets,t):i})}function p5(i,e){let t=i.getIndex();if(null===t){const o=[],a=i.getAttribute("position");if(void 0===a)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i;for(let l=0;l<a.count;l++)o.push(l);i.setIndex(o),t=i.getIndex()}const n=t.count-2,r=[];if(e===aT)for(let o=1;o<=n;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==n&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=i.clone();return s.setIndex(r),s}class m5{setCrossOrigin(e){this.crossOrigin=e}setWithCredentials(e){this.withCredentials=e}createLoaderInstance(){const e=new this.clazz;return this.crossOrigin&&e.setCrossOrigin(this.crossOrigin),void 0!==this.withCredentials&&e.setWithCredentials(this.withCredentials),e}}class Na extends m5{load(...e){return this.createLoaderInstance().loadAsync(...e)}}Na.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Na)))(t||Na)}}(),Na.\u0275prov=Ne({token:Na,factory:Na.\u0275fac});class Rx{constructor(){this.animationLoop=Ut(oa)}transform(...e){return this.service.load(...e).then(t=>(this.animationLoop.requestAnimationFrame(),t))}}class _u{set url(e){this._url=e,this.load()}get url(){return this._url}get onLoaded(){return this.onLoaded$||(this.onLoaded$=new Ct),this.onLoaded$}get onProgress(){return this.onProgress$||(this.onProgress$=new Ct),this.onProgress$}constructor(e,t){this.host=e,this.zone=t,this.initialized=!1,this.animationLoop=Ut(oa),this.proxy=r5(),e.objRef=this.proxy}ngOnInit(){this.initialized=!0,this.load()}load(){var e=this;return ss(function*(){if(!e.initialized)return;if(void 0===e._url)throw new Error("missing url");if(!e.proxy)return;const t=e._url,n=S0(e.onProgress$)?s=>{e.zone.run(()=>{e.onProgress$?.next(s)})}:void 0,r=yield e.zone.runOutsideAngular(()=>e.service.load(t,n));e.animationLoop.requestAnimationFrame(),e.proxy.objRef=e.getRefFromResponse(r),e.host.objRef=e.proxy,e.onLoaded$&&void 0!==r&&e.zone.run(()=>e.onLoaded$?.next(r))})()}}_u.\u0275fac=function(e){Xg()},_u.\u0275dir=ke({type:_u,inputs:{url:"url"},outputs:{onLoaded:"onLoaded",onProgress:"onProgress"}});const VI=new WeakMap;class fce extends yr{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,r){const s=new Ar(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{this.decodeDracoFile(o,t).catch(r)},n,r)}decodeDracoFile(e,t,n,r){return this.decodeGeometry(e,{attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n}).then(t)}decodeGeometry(e,t){const n=JSON.stringify(t);if(VI.has(e)){const l=VI.get(e);if(l.key===n)return l.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,a=this._getWorker(s,e.byteLength).then(l=>(r=l,new Promise((c,d)=>{r._callbacks[s]={resolve:c,reject:d},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),VI.set(e,{key:n,promise:a}),a}_createGeometry(e){const t=new xt;e.index&&t.setIndex(new Ci(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n];t.setAttribute(r.name,new Ci(r.array,r.itemSize))}return t}_loadLibrary(e,t){const n=new Ar(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((r,s)=>{n.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const r=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const s=pce.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function pce(){let i,e;function r(o,a,l,c,d,u){const h=u.num_components(),m=l.num_points()*h,p=m*d.BYTES_PER_ELEMENT,g=function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}(o,d),_=o._malloc(p);a.GetAttributeDataArrayForAllPoints(l,u,g,p,_);const v=new d(o.HEAPF32.buffer,_,m).slice();return o._free(_),{name:c,array:v,itemSize:h}}onmessage=function(o){const a=o.data;switch(a.type){case"init":i=a.decoderConfig,e=new Promise(function(d){i.onModuleLoaded=function(u){d({draco:u})},DracoDecoderModule(i)});break;case"decode":const l=a.buffer,c=a.taskConfig;e.then(d=>{const u=d.draco,h=new u.Decoder,f=new u.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{const m=function t(o,a,l,c){const d=c.attributeIDs,u=c.attributeTypes;let h,f;const m=a.GetEncodedGeometryType(l);if(m===o.TRIANGULAR_MESH)h=new o.Mesh,f=a.DecodeBufferToMesh(l,h);else{if(m!==o.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");h=new o.PointCloud,f=a.DecodeBufferToPointCloud(l,h)}if(!f.ok()||0===h.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());const p={index:null,attributes:[]};for(const g in d){const _=self[u[g]];let v,b;if(c.useUniqueIDs)b=d[g],v=a.GetAttributeByUniqueId(h,b);else{if(b=a.GetAttributeId(h,o[d[g]]),-1===b)continue;v=a.GetAttribute(h,b)}p.attributes.push(r(o,a,h,g,_,v))}return m===o.TRIANGULAR_MESH&&(p.index=function n(o,a,l){const d=3*l.num_faces(),u=4*d,h=o._malloc(u);a.GetTrianglesUInt32Array(l,u,h);const f=new Uint32Array(o.HEAPF32.buffer,h,d).slice();return o._free(h),{array:f,itemSize:1}}(o,a,h)),o.destroy(h),p}(u,h,f,c),p=m.attributes.map(g=>g.array.buffer);m.index&&p.push(m.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:m},p)}catch(m){console.error(m),self.postMessage({type:"error",id:a.id,error:m.message})}finally{u.destroy(f),u.destroy(h)}})}}}class Do extends m5{load(...e){return this.createLoaderInstance().load(...e)}}class la{transform(...e){return this.service.load(...e)}}class Rs{set url(e){this._url=e,this.load()}get url(){return this._url}get onLoaded(){return this.onLoaded$||(this.onLoaded$=new Ct),this.onLoaded$}get onProgress(){return this.onProgress$||(this.onProgress$=new Ct),this.onProgress$}constructor(e,t){this.host=e,this.zone=t,this.initialized=!1}ngOnInit(){this.initialized=!0,this.load()}load(){var e=this;return ss(function*(){if(!e.initialized)return;if(void 0===e._url)throw new Error("missing url");const t=e._url,n=S0(e.onProgress$)?s=>{e.onProgress$?.next(s)}:void 0,r=S0(e.onLoaded$)?(...s)=>{e.onLoaded$?.next(s[0])}:void 0;e.host.objRef=e.zone.runOutsideAngular(()=>e.service.load(t,n,r))})()}}Rs.\u0275fac=function(e){Xg()},Rs.\u0275dir=ke({type:Rs,inputs:{url:"url"},outputs:{onLoaded:"onLoaded",onProgress:"onProgress"}});class Pl extends Do{constructor(){super(...arguments),this.clazz=fce,this.decoderPath=""}setDecoderPath(e){this.decoderPath=e}setDecoderConfig(e){this.decoderConfig=e}createLoaderInstance(){const e=super.createLoaderInstance();return e.setDecoderPath(this.decoderPath),this.decoderConfig&&e.setDecoderConfig(this.decoderConfig),e}}Pl.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Pl)))(t||Pl)}}(),Pl.\u0275prov=Ne({token:Pl,factory:Pl.\u0275fac,providedIn:"root"});class bu extends Na{constructor(e){super(),this.dracoLoaderService=e,this.clazz=Lle}createLoaderInstance(){const e=super.createLoaderInstance();return e.setDRACOLoader(this.dracoLoaderService.createLoaderInstance()),e}}bu.\u0275fac=function(e){return new(e||bu)(ye(Pl))},bu.\u0275prov=Ne({token:bu,factory:bu.\u0275fac,providedIn:"root"});class Dx extends Rx{constructor(e){super(),this.service=e}}Dx.\u0275fac=function(e){return new(e||Dx)(R(bu,16))},Dx.\u0275pipe=gi({name:"loadGLTF",type:Dx,pure:!0});class Po extends _u{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}getRefFromResponse(e){return e.scene}}Po.\u0275fac=function(e){return new(e||Po)(R(Ye,1),R(at),R(bu))},Po.\u0275dir=ke({type:Po,selectors:[["","loadGLTF",""]],features:[W]});class vu{constructor(e,t){this.engineService=e,this.animationLoopService=t}get beforeRender(){return this.engineService.beforeRender$}get onResize(){return this.engineService.resize$}set renderOnDemand(e){e?this.animationLoopService.stop():this.animationLoopService.start()}get renderOnDemand(){return!this.animationLoopService.isActive()}}vu.\u0275fac=function(e){return new(e||vu)(R(To),R(oa))},vu.\u0275dir=ke({type:vu,selectors:[["","beforeRender",""],["","onResize",""],["","renderOnDemand",""]],inputs:{renderOnDemand:"renderOnDemand"},outputs:{beforeRender:"beforeRender",onResize:"onResize"}});class k0{constructor(){this.assetPath=aa+"RobotExpressive.glb",this.states=["Idle","Walking","Running","Dance","Death","Sitting","Standing"],this.emotes=["Jump","Yes","No","Wave","Punch","ThumbsUp"],this.actions={}}onInit(e){this.animationMixer=new R4(e.scene),e.scene.traverse(t=>{t.isMesh&&(t.castShadow=!0,t.receiveShadow=!0)});for(const t of e.animations){const n=this.animationMixer.clipAction(t);this.actions[t.name]=n,(this.emotes.indexOf(t.name)>=0||this.states.indexOf(t.name)>=4)&&(n.clampWhenFinished=!0,n.loop=sT)}this.activeAction=this.actions.Walking,this.activeAction.play()}beforeRender(e){this.animationMixer&&this.animationMixer.update(e.delta)}fadeToAction(e,t){this.previousAction=this.activeAction,this.activeAction=this.actions[e],this.previousAction&&this.previousAction!==this.activeAction&&this.previousAction.fadeOut(t),this.activeAction.reset().setEffectiveTimeScale(1).setEffectiveWeight(1).fadeIn(t).play()}}k0.\u0275fac=function(e){return new(e||k0)},k0.\u0275cmp=$({type:k0,selectors:[["app-robot"]],decls:1,vars:2,consts:[["loadGLTF","",3,"url","castShadow","onLoaded","beforeRender"]],template:function(e,t){1&e&&(ve(0,"th-mesh",0),mt("onLoaded",function(r){return t.onInit(r)})("beforeRender",function(r){return t.beforeRender(r)}),Ie()),2&e&&K("url",t.assetPath)("castShadow",!0)},dependencies:[Vn,Po,vu],encapsulation:2,changeDetection:0});class pp{transform(e){return new l0(...e)}}pp.\u0275fac=function(e){return new(e||pp)},pp.\u0275pipe=gi({name:"fog",type:pp,pure:!0});const mce=["gridHelper"],gce=function(i){return{outputEncoding:i}},_ce=function(){return["#e0e0e0"]},bce=function(){return["#e0e0e0",20,100]},vce=function(){return[45,2,.25,100]},yce=function(i){return[i,5,10]},Ace=function(){return[0,2,0]},xce=function(){return["#ffffff","#444444"]},wce=function(){return[0,20,0]},Cce=function(){return["#ffffff"]},Mce=function(){return[0,20,10]},Ece=function(i){return[i,0,0]},Sce=function(){return[2e3,2e3]},Tce=function(){return{color:"#999999",depthWrite:!1}},Ice=function(){return[200,40,"#000000","#000000"]};class F0{constructor(){this.Math=Math,this.outputEncoding=hi}ngAfterViewInit(){const e=this.gridHelper?.objRef?.material;e&&(e.opacity=.2,e.transparent=!0)}onBeforeRender(){}}F0.\u0275fac=function(e){return new(e||F0)},F0.\u0275cmp=$({type:F0,selectors:[["app-animation-example"]],viewQuery:function(e,t){if(1&e&&Di(mce,7),2&e){let n;Pt(n=kt())&&(t.gridHelper=n.first)}},decls:12,vars:38,consts:[[3,"rendererParameters","thStats","shadow","onRender"],[3,"background","fog"],[3,"args","position","lookAt"],[3,"args","position"],[3,"args","position","castShadow"],[3,"rotation","receiveShadow"],[3,"args"],[3,"args","receiveShadow"],["gridHelper",""]],template:function(e,t){1&e&&(ve(0,"th-canvas",0),mt("onRender",function(){return t.onBeforeRender()}),ve(1,"th-scene",1),fr(2,"fog"),ze(3,"th-perspectiveCamera",2)(4,"th-hemisphereLight",3)(5,"th-directionalLight",4),ve(6,"th-mesh",5),ze(7,"th-planeGeometry",6)(8,"th-meshPhongMaterial",6),Ie(),ze(9,"th-gridHelper",7,8)(11,"app-robot"),Ie()()),2&e&&(K("rendererParameters",ui(21,gce,t.outputEncoding))("thStats",!0)("shadow",!0),oe(1),K("background",Re(23,_ce))("fog",Er(2,19,Re(24,bce))),oe(2),K("args",Re(25,vce))("position",ui(26,yce,-5))("lookAt",Re(28,Ace)),oe(1),K("args",Re(29,xce))("position",Re(30,wce)),oe(1),K("args",Re(31,Cce))("position",Re(32,Mce))("castShadow",!0),oe(1),K("rotation",ui(33,Ece,-.5*t.Math.PI))("receiveShadow",!0),oe(1),K("args",Re(35,Sce)),oe(1),K("args",Re(36,Tce)),oe(1),K("args",Re(37,Ice))("receiveShadow",!0))},dependencies:[rn,io,Dl,Ts,Vn,mn,no,sa,Vi,Io,k0,pp],encapsulation:2,changeDetection:0});class xr extends Ss{getType(){return vx}set type(e){this._objRef&&(this._objRef.type=e)}}xr.\u0275fac=function(){let i;return function(t){return(i||(i=ce(xr)))(t||xr)}}(),xr.\u0275cmp=$({type:xr,selectors:[["th-ambientLight"]],inputs:{type:"type"},features:[se([{provide:Ye,useExisting:le(()=>xr)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class ja extends Ei{getType(){return Xn}set type(e){this._objRef&&(this._objRef.type=e)}set color(e){this._objRef&&(this._objRef.color=Qe(this._objRef.color,e))}set map(e){this._objRef&&(this._objRef.map=e)}set lightMap(e){this._objRef&&(this._objRef.lightMap=e)}set lightMapIntensity(e){this._objRef&&(this._objRef.lightMapIntensity=e)}set aoMap(e){this._objRef&&(this._objRef.aoMap=e)}set aoMapIntensity(e){this._objRef&&(this._objRef.aoMapIntensity=e)}set specularMap(e){this._objRef&&(this._objRef.specularMap=e)}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}set envMap(e){this._objRef&&(this._objRef.envMap=e)}set combine(e){this._objRef&&(this._objRef.combine=e)}set reflectivity(e){this._objRef&&(this._objRef.reflectivity=e)}set refractionRatio(e){this._objRef&&(this._objRef.refractionRatio=e)}set wireframe(e){this._objRef&&(this._objRef.wireframe=e)}set wireframeLinewidth(e){this._objRef&&(this._objRef.wireframeLinewidth=e)}set wireframeLinecap(e){this._objRef&&(this._objRef.wireframeLinecap=e)}set wireframeLinejoin(e){this._objRef&&(this._objRef.wireframeLinejoin=e)}set fog(e){this._objRef&&(this._objRef.fog=e)}}ja.\u0275fac=function(){let i;return function(t){return(i||(i=ce(ja)))(t||ja)}}(),ja.\u0275cmp=$({type:ja,selectors:[["th-meshBasicMaterial"]],inputs:{type:"type",color:"color",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",specularMap:"specularMap",alphaMap:"alphaMap",envMap:"envMap",combine:"combine",reflectivity:"reflectivity",refractionRatio:"refractionRatio",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",fog:"fog"},features:[se([{provide:Ei,useExisting:le(()=>ja)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Ua extends Mt{getType(){return Ki}set type(e){this._objRef&&(this._objRef.type=e)}set parameters(e){this._objRef&&(this._objRef.parameters=e)}}Ua.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Ua)))(t||Ua)}}(),Ua.\u0275cmp=$({type:Ua,selectors:[["th-boxGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[se([{provide:Mt,useExisting:le(()=>Ua)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const Rce=function(){return{color:"purple"}},Dce=function(){return[75,2,.1,1e3]},Pce=function(){return[1,1,5]};class B0{}B0.\u0275fac=function(e){return new(e||B0)},B0.\u0275cmp=$({type:B0,selectors:[["app-basic-example"]],decls:7,vars:6,consts:[[3,"args"],[3,"args","position"]],template:function(e,t){1&e&&(ve(0,"th-canvas")(1,"th-scene")(2,"th-mesh"),ze(3,"th-boxGeometry")(4,"th-meshBasicMaterial",0),Ie(),ze(5,"th-ambientLight")(6,"th-perspectiveCamera",1),Ie()()),2&e&&(oe(4),K("args",Re(3,Rce)),oe(2),K("args",Re(4,Dce))("position",Re(5,Pce)))},dependencies:[rn,xr,Vn,mn,ja,Ua,Vi],encapsulation:2,changeDetection:0});const g5={type:"change"},zI={type:"start"},_5={type:"end"};class b5 extends os{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new T,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:yo.ROTATE,MIDDLE:yo.DOLLY,RIGHT:yo.PAN},this.touches={ONE:gl.ROTATE,TWO:gl.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(H){H.addEventListener("keydown",ft),this._domElementKeyEvents=H},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(g5),n.update(),s=r.NONE},this.update=function(){const H=new T,te=(new xi).setFromUnitVectors(e.up,new T(0,1,0)),tt=te.clone().invert(),lt=new T,nt=new xi,rt=2*Math.PI;return function(){const Jt=n.object.position;H.copy(Jt).sub(n.target),H.applyQuaternion(te),a.setFromVector3(H),n.autoRotate&&s===r.NONE&&E(function M(){return 2*Math.PI/60/60*n.autoRotateSpeed}()),n.enableDamping?(a.theta+=l.theta*n.dampingFactor,a.phi+=l.phi*n.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let Ft=n.minAzimuthAngle,Ot=n.maxAzimuthAngle;return isFinite(Ft)&&isFinite(Ot)&&(Ft<-Math.PI?Ft+=rt:Ft>Math.PI&&(Ft-=rt),Ot<-Math.PI?Ot+=rt:Ot>Math.PI&&(Ot-=rt),a.theta=Ft<=Ot?Math.max(Ft,Math.min(Ot,a.theta)):a.theta>(Ft+Ot)/2?Math.max(Ft,a.theta):Math.min(Ot,a.theta)),a.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=c,a.radius=Math.max(n.minDistance,Math.min(n.maxDistance,a.radius)),!0===n.enableDamping?n.target.addScaledVector(d,n.dampingFactor):n.target.add(d),H.setFromSpherical(a),H.applyQuaternion(tt),Jt.copy(n.target).add(H),n.object.lookAt(n.target),!0===n.enableDamping?(l.theta*=1-n.dampingFactor,l.phi*=1-n.dampingFactor,d.multiplyScalar(1-n.dampingFactor)):(l.set(0,0,0),d.set(0,0,0)),c=1,!!(u||lt.distanceToSquared(n.object.position)>o||8*(1-nt.dot(n.object.quaternion))>o)&&(n.dispatchEvent(g5),lt.copy(n.object.position),nt.copy(n.object.quaternion),u=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",_e),n.domElement.removeEventListener("pointerdown",Pe),n.domElement.removeEventListener("pointercancel",yt),n.domElement.removeEventListener("wheel",St),n.domElement.removeEventListener("pointermove",$e),n.domElement.removeEventListener("pointerup",We),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",ft)};const n=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new xx,l=new xx;let c=1;const d=new T;let u=!1;const h=new ue,f=new ue,m=new ue,p=new ue,g=new ue,_=new ue,v=new ue,b=new ue,y=new ue,x=[],C={};function w(){return Math.pow(.95,n.zoomSpeed)}function E(H){l.theta-=H}function I(H){l.phi-=H}const F=function(){const H=new T;return function(tt,lt){H.setFromMatrixColumn(lt,0),H.multiplyScalar(-tt),d.add(H)}}(),Q=function(){const H=new T;return function(tt,lt){!0===n.screenSpacePanning?H.setFromMatrixColumn(lt,1):(H.setFromMatrixColumn(lt,0),H.crossVectors(n.object.up,H)),H.multiplyScalar(tt),d.add(H)}}(),B=function(){const H=new T;return function(tt,lt){const nt=n.domElement;if(n.object.isPerspectiveCamera){H.copy(n.object.position).sub(n.target);let At=H.length();At*=Math.tan(n.object.fov/2*Math.PI/180),F(2*tt*At/nt.clientHeight,n.object.matrix),Q(2*lt*At/nt.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(F(tt*(n.object.right-n.object.left)/n.object.zoom/nt.clientWidth,n.object.matrix),Q(lt*(n.object.top-n.object.bottom)/n.object.zoom/nt.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function L(H){n.object.isPerspectiveCamera?c/=H:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*H)),n.object.updateProjectionMatrix(),u=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function X(H){n.object.isPerspectiveCamera?c*=H:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/H)),n.object.updateProjectionMatrix(),u=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function P(H){h.set(H.clientX,H.clientY)}function O(H){p.set(H.clientX,H.clientY)}function J(){1===x.length?h.set(x[0].pageX,x[0].pageY):h.set(.5*(x[0].pageX+x[1].pageX),.5*(x[0].pageY+x[1].pageY))}function ae(){1===x.length?p.set(x[0].pageX,x[0].pageY):p.set(.5*(x[0].pageX+x[1].pageX),.5*(x[0].pageY+x[1].pageY))}function G(){const H=x[0].pageX-x[1].pageX,te=x[0].pageY-x[1].pageY,tt=Math.sqrt(H*H+te*te);v.set(0,tt)}function Ee(H){if(1==x.length)f.set(H.pageX,H.pageY);else{const tt=bt(H);f.set(.5*(H.pageX+tt.x),.5*(H.pageY+tt.y))}m.subVectors(f,h).multiplyScalar(n.rotateSpeed);const te=n.domElement;E(2*Math.PI*m.x/te.clientHeight),I(2*Math.PI*m.y/te.clientHeight),h.copy(f)}function we(H){if(1===x.length)g.set(H.pageX,H.pageY);else{const te=bt(H);g.set(.5*(H.pageX+te.x),.5*(H.pageY+te.y))}_.subVectors(g,p).multiplyScalar(n.panSpeed),B(_.x,_.y),p.copy(g)}function et(H){const te=bt(H),tt=H.pageX-te.x,lt=H.pageY-te.y,nt=Math.sqrt(tt*tt+lt*lt);b.set(0,nt),y.set(0,Math.pow(b.y/v.y,n.zoomSpeed)),L(y.y),v.copy(b)}function Pe(H){!1!==n.enabled&&(0===x.length&&(n.domElement.setPointerCapture(H.pointerId),n.domElement.addEventListener("pointermove",$e),n.domElement.addEventListener("pointerup",We)),function Se(H){x.push(H)}(H),"touch"===H.pointerType?function N(H){switch(Ze(H),x.length){case 1:switch(n.touches.ONE){case gl.ROTATE:if(!1===n.enableRotate)return;J(),s=r.TOUCH_ROTATE;break;case gl.PAN:if(!1===n.enablePan)return;ae(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(n.touches.TWO){case gl.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function U(){n.enableZoom&&G(),n.enablePan&&ae()})(),s=r.TOUCH_DOLLY_PAN;break;case gl.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function de(){n.enableZoom&&G(),n.enableRotate&&J()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(zI)}(H):function ht(H){let te;switch(H.button){case 0:te=n.mouseButtons.LEFT;break;case 1:te=n.mouseButtons.MIDDLE;break;case 2:te=n.mouseButtons.RIGHT;break;default:te=-1}switch(te){case yo.DOLLY:if(!1===n.enableZoom)return;(function V(H){v.set(H.clientX,H.clientY)})(H),s=r.DOLLY;break;case yo.ROTATE:if(H.ctrlKey||H.metaKey||H.shiftKey){if(!1===n.enablePan)return;O(H),s=r.PAN}else{if(!1===n.enableRotate)return;P(H),s=r.ROTATE}break;case yo.PAN:if(H.ctrlKey||H.metaKey||H.shiftKey){if(!1===n.enableRotate)return;P(H),s=r.ROTATE}else{if(!1===n.enablePan)return;O(H),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(zI)}(H))}function $e(H){!1!==n.enabled&&("touch"===H.pointerType?function k(H){switch(Ze(H),s){case r.TOUCH_ROTATE:if(!1===n.enableRotate)return;Ee(H),n.update();break;case r.TOUCH_PAN:if(!1===n.enablePan)return;we(H),n.update();break;case r.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function Ae(H){n.enableZoom&&et(H),n.enablePan&&we(H)})(H),n.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function xe(H){n.enableZoom&&et(H),n.enableRotate&&Ee(H)})(H),n.update();break;default:s=r.NONE}}(H):function ot(H){switch(s){case r.ROTATE:if(!1===n.enableRotate)return;!function q(H){f.set(H.clientX,H.clientY),m.subVectors(f,h).multiplyScalar(n.rotateSpeed);const te=n.domElement;E(2*Math.PI*m.x/te.clientHeight),I(2*Math.PI*m.y/te.clientHeight),h.copy(f),n.update()}(H);break;case r.DOLLY:if(!1===n.enableZoom)return;!function ee(H){b.set(H.clientX,H.clientY),y.subVectors(b,v),y.y>0?L(w()):y.y<0&&X(w()),v.copy(b),n.update()}(H);break;case r.PAN:if(!1===n.enablePan)return;!function Z(H){g.set(H.clientX,H.clientY),_.subVectors(g,p).multiplyScalar(n.panSpeed),B(_.x,_.y),p.copy(g),n.update()}(H)}}(H))}function We(H){Ue(H),0===x.length&&(n.domElement.releasePointerCapture(H.pointerId),n.domElement.removeEventListener("pointermove",$e),n.domElement.removeEventListener("pointerup",We)),n.dispatchEvent(_5),s=r.NONE}function yt(H){Ue(H)}function St(H){!1===n.enabled||!1===n.enableZoom||s!==r.NONE||(H.preventDefault(),n.dispatchEvent(zI),function Y(H){H.deltaY<0?X(w()):H.deltaY>0&&L(w()),n.update()}(H),n.dispatchEvent(_5))}function ft(H){!1===n.enabled||!1===n.enablePan||function he(H){let te=!1;switch(H.code){case n.keys.UP:H.ctrlKey||H.metaKey||H.shiftKey?I(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):B(0,n.keyPanSpeed),te=!0;break;case n.keys.BOTTOM:H.ctrlKey||H.metaKey||H.shiftKey?I(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):B(0,-n.keyPanSpeed),te=!0;break;case n.keys.LEFT:H.ctrlKey||H.metaKey||H.shiftKey?E(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):B(n.keyPanSpeed,0),te=!0;break;case n.keys.RIGHT:H.ctrlKey||H.metaKey||H.shiftKey?E(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):B(-n.keyPanSpeed,0),te=!0}te&&(H.preventDefault(),n.update())}(H)}function _e(H){!1!==n.enabled&&H.preventDefault()}function Ue(H){delete C[H.pointerId];for(let te=0;te<x.length;te++)if(x[te].pointerId==H.pointerId)return void x.splice(te,1)}function Ze(H){let te=C[H.pointerId];void 0===te&&(te=new ue,C[H.pointerId]=te),te.set(H.pageX,H.pageY)}function bt(H){return C[(H.pointerId===x[0].pointerId?x[1]:x[0]).pointerId]}n.domElement.addEventListener("contextmenu",_e),n.domElement.addEventListener("pointerdown",Pe),n.domElement.addEventListener("pointercancel",yt),n.domElement.addEventListener("wheel",St,{passive:!1}),this.update()}}class kce extends b5{constructor(e,t){super(e,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=yo.PAN,this.mouseButtons.RIGHT=yo.ROTATE,this.touches.ONE=gl.PAN,this.touches.TWO=gl.DOLLY_ROTATE}}class zn extends Eo{constructor(e,t){super(),this._camera=e,this.canvas=t,this.renderLoop=Ut(oa)}createThreeInstance(e){e||(e=[this._camera.objRef,this.canvas?.rendererCanvas?.nativeElement]);const t=super.createThreeInstance(e);return this.patchDispatchEvent(t),this.subscribeControlUpdater(t),t}patchDispatchEvent(e){if(e.dispatchEvent){const t=this.origDispatchEventMethod=e.dispatchEvent;e.dispatchEvent=n=>{t.call(e,n),this.renderLoop.requestAnimationFrame()}}}ngOnDestroy(){super.ngOnDestroy(),this.unpatchDispatchEvent(),this.unsubscribeControlUpdater()}unpatchDispatchEvent(){this.origDispatchEventMethod&&this._objRef&&(this._objRef.dispatchEvent=this.origDispatchEventMethod)}subscribeControlUpdater(e){void 0!==e.update&&(this.beforeRenderSubscription=this.renderLoop.beforeRender$.subscribe(t=>{e.update(t.delta)}))}unsubscribeControlUpdater(){this.beforeRenderSubscription&&this.beforeRenderSubscription.unsubscribe()}}zn.\u0275fac=function(e){return new(e||zn)(R(Ye),R(Vi))},zn.\u0275cmp=$({type:zn,selectors:[["th-abs-control"]],features:[W],decls:0,vars:0,template:function(e,t){},encapsulation:2});class ds extends zn{getType(){return b5}set object(e){this._objRef&&(this._objRef.object=e)}set domElement(e){this._objRef&&(this._objRef.domElement=e)}set enabled(e){this._objRef&&(this._objRef.enabled=e)}set target(e){this._objRef&&(this._objRef.target=Qe(this._objRef.target,e))}set center(e){this._objRef&&(this._objRef.center=Qe(this._objRef.center,e))}set minDistance(e){this._objRef&&(this._objRef.minDistance=e)}set maxDistance(e){this._objRef&&(this._objRef.maxDistance=e)}set minZoom(e){this._objRef&&(this._objRef.minZoom=e)}set maxZoom(e){this._objRef&&(this._objRef.maxZoom=e)}set minPolarAngle(e){this._objRef&&(this._objRef.minPolarAngle=e)}set maxPolarAngle(e){this._objRef&&(this._objRef.maxPolarAngle=e)}set minAzimuthAngle(e){this._objRef&&(this._objRef.minAzimuthAngle=e)}set maxAzimuthAngle(e){this._objRef&&(this._objRef.maxAzimuthAngle=e)}set enableDamping(e){this._objRef&&(this._objRef.enableDamping=e)}set dampingFactor(e){this._objRef&&(this._objRef.dampingFactor=e)}set enableZoom(e){this._objRef&&(this._objRef.enableZoom=e)}set zoomSpeed(e){this._objRef&&(this._objRef.zoomSpeed=e)}set enableRotate(e){this._objRef&&(this._objRef.enableRotate=e)}set rotateSpeed(e){this._objRef&&(this._objRef.rotateSpeed=e)}set enablePan(e){this._objRef&&(this._objRef.enablePan=e)}set panSpeed(e){this._objRef&&(this._objRef.panSpeed=e)}set screenSpacePanning(e){this._objRef&&(this._objRef.screenSpacePanning=e)}set keyPanSpeed(e){this._objRef&&(this._objRef.keyPanSpeed=e)}set autoRotate(e){this._objRef&&(this._objRef.autoRotate=e)}set autoRotateSpeed(e){this._objRef&&(this._objRef.autoRotateSpeed=e)}set keys(e){this._objRef&&(this._objRef.keys=e)}set mouseButtons(e){this._objRef&&(this._objRef.mouseButtons=e)}set touches(e){this._objRef&&(this._objRef.touches=e)}set target0(e){this._objRef&&(this._objRef.target0=Qe(this._objRef.target0,e))}set position0(e){this._objRef&&(this._objRef.position0=Qe(this._objRef.position0,e))}set zoomO(e){this._objRef&&(this._objRef.zoomO=e)}}ds.\u0275fac=function(){let i;return function(t){return(i||(i=ce(ds)))(t||ds)}}(),ds.\u0275cmp=$({type:ds,selectors:[["th-orbitControls"]],inputs:{object:"object",domElement:"domElement",enabled:"enabled",target:"target",center:"center",minDistance:"minDistance",maxDistance:"maxDistance",minZoom:"minZoom",maxZoom:"maxZoom",minPolarAngle:"minPolarAngle",maxPolarAngle:"maxPolarAngle",minAzimuthAngle:"minAzimuthAngle",maxAzimuthAngle:"maxAzimuthAngle",enableDamping:"enableDamping",dampingFactor:"dampingFactor",enableZoom:"enableZoom",zoomSpeed:"zoomSpeed",enableRotate:"enableRotate",rotateSpeed:"rotateSpeed",enablePan:"enablePan",panSpeed:"panSpeed",screenSpacePanning:"screenSpacePanning",keyPanSpeed:"keyPanSpeed",autoRotate:"autoRotate",autoRotateSpeed:"autoRotateSpeed",keys:"keys",mouseButtons:"mouseButtons",touches:"touches",target0:"target0",position0:"position0",zoomO:"zoomO"},features:[se([{provide:zn,useExisting:le(()=>ds)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class so extends Ss{getType(){return dp}set type(e){this._objRef&&(this._objRef.type=e)}set intensity(e){this._objRef&&(this._objRef.intensity=e)}set distance(e){this._objRef&&(this._objRef.distance=e)}set castShadow(e){this._objRef&&(this._objRef.castShadow=e)}set decay(e){this._objRef&&(this._objRef.decay=e)}set shadow(e){this._objRef&&(this._objRef.shadow=e)}set power(e){this._objRef&&(this._objRef.power=e)}}so.\u0275fac=function(){let i;return function(t){return(i||(i=ce(so)))(t||so)}}(),so.\u0275cmp=$({type:so,selectors:[["th-pointLight"]],inputs:{type:"type",intensity:"intensity",distance:"distance",castShadow:"castShadow",decay:"decay",shadow:"shadow",power:"power"},features:[se([{provide:Ye,useExisting:le(()=>so)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Va{get onMouseEnter(){return this.mouseEnter||(this.mouseEnter=new Ct),this.mouseEnter}get onMouseExit(){return this.mouseExit||(this.mouseExit=new Ct),this.mouseExit}get onClick(){return this.click||(this.click=new Ct),this.click}get onPointerDown(){return this.pointerDown||(this.pointerDown=new Ct),this.pointerDown}get onPointerUp(){return this.pointerUp||(this.pointerUp=new Ct),this.pointerUp}constructor(e,t){this.host=e,this.raycasterService=t,this.emitOnMouseEnter=this.emitOnMouseEnter.bind(this),this.emitOnMouseExit=this.emitOnMouseExit.bind(this),this.emitOnClick=this.emitOnClick.bind(this)}ngAfterViewInit(){this.subscribeEvents()}subscribeEvents(){this.raycasterService.addEventTarget(this)}unSubscribeEvents(){this.raycasterService.removeEventTarget(this)}emitOnMouseExit(){this.mouseExit?.emit({component:this.host})}emitOnMouseEnter(e){this.mouseEnter?.emit({component:this.host,face:e.face})}emitOnClick(e){this.click?.emit({component:this.host,face:e.face})}emitOnPointerDown(e){this.pointerDown?.emit({component:this.host,face:e.face})}emitOnPointerUp(e){this.pointerUp?.emit({component:this.host,face:e.face})}ngOnDestroy(){this.unSubscribeEvents()}}Va.\u0275fac=function(e){return new(e||Va)(R(Ye,1),R(ro))},Va.\u0275dir=ke({type:Va,selectors:[["","onClick",""],["","onMouseEnter",""],["","onMouseExit",""],["","onPointerDown",""],["","onPointerUp",""]],outputs:{onMouseEnter:"onMouseEnter",onMouseExit:"onMouseExit",onClick:"onClick",onPointerDown:"onPointerDown",onPointerUp:"onPointerUp"}});const Fce=function(){return[2,2,2]},Bce=function(){return[1,1,1]},Lce=function(){return[10,10]},v5=function(){return[10,10,10]},Oce=function(){return[45,2,.1,100]},Nce=function(){return[0,0,0]};class L0{constructor(){this.selected=!1,this.glbPath=`${aa}DamagedHelmet.glb`}}L0.\u0275fac=function(e){return new(e||L0)},L0.\u0275cmp=$({type:L0,selectors:[["app-controls-example"]],decls:8,vars:15,consts:[[3,"thStats"],["loadGLTF","",3,"url","scale","onClick"],[3,"args"],[3,"position"],[3,"args","position","lookAt"]],template:function(e,t){1&e&&(ve(0,"th-canvas",0)(1,"th-scene"),ze(2,"th-ambientLight"),ve(3,"th-object3D",1),mt("onClick",function(){return t.selected=!t.selected}),Ie(),ze(4,"th-gridHelper",2)(5,"th-pointLight",3),ve(6,"th-perspectiveCamera",4),ze(7,"th-orbitControls"),Ie()()()),2&e&&(K("thStats",!0),oe(3),K("url",t.glbPath)("scale",t.selected?Re(8,Fce):Re(9,Bce)),oe(1),K("args",Re(10,Lce)),oe(1),K("position",Re(11,v5)),oe(1),K("args",Re(12,Oce))("position",Re(13,v5))("lookAt",Re(14,Nce)))},dependencies:[ds,rn,Ye,io,so,xr,mn,Vi,Po,Va,Io],encapsulation:2,changeDetection:0});const jce=function(){return[0,1,0]},Uce=function(){return[10,10]},y5=function(){return[10,10,10]},Vce=function(){return[45,2,.1,100]},zce=function(){return[0,0,0]};class O0{constructor(e){this.cdref=e,this.modelScale=[1,1,1],this.rotation=[0,0,0],this.modelUrl1=`${aa}DamagedHelmet.glb`,this.modelUrl2=`${aa}BoomBox.glb`,this.modelUrl=this.toggleModel(),this.intervalHandle=window.setInterval(()=>this.toggleModel(),3e3)}toggleModel(){return this.modelUrl=this.modelUrl!==this.modelUrl1?this.modelUrl1:this.modelUrl2,this.cdref.markForCheck(),this.modelUrl}onLoaded(){this.modelScale=this.modelUrl!==this.modelUrl1?[100,100,100]:[1,1,1]}onRefChange(e){}onBeforeRender(){this.rotation=[0,this.rotation[1]+.01,0]}ngOnDestroy(){window.clearInterval(this.intervalHandle)}}O0.\u0275fac=function(e){return new(e||O0)(R(er))},O0.\u0275cmp=$({type:O0,selectors:[["app-dynamic-loader-example"]],decls:7,vars:15,consts:[[3,"onRender"],["loadGLTF","",3,"url","scale","rotation","position","onLoaded","objRef$"],[3,"args"],[3,"position"],[3,"args","position","lookAt"]],template:function(e,t){1&e&&(ve(0,"th-canvas",0),mt("onRender",function(){return t.onBeforeRender()}),ve(1,"th-scene"),ze(2,"th-ambientLight"),ve(3,"th-object3D",1),mt("onLoaded",function(){return t.onLoaded()})("objRef$",function(r){return t.onRefChange(r)}),Ie(),ze(4,"th-gridHelper",2)(5,"th-pointLight",3)(6,"th-perspectiveCamera",4),Ie()()),2&e&&(oe(3),K("url",t.modelUrl)("scale",t.modelScale)("rotation",t.rotation)("position",Re(9,jce)),oe(1),K("args",Re(10,Uce)),oe(1),K("position",Re(11,y5)),oe(1),K("args",Re(12,Vce))("position",Re(13,y5))("lookAt",Re(14,zce)))},dependencies:[rn,Ye,io,so,xr,mn,Vi,Po],encapsulation:2});class N0{transform(e,t){return e.bind(t)}}function Hce(i,e){if(1&i&&(ve(0,"li"),qi(1),Ie()),2&i){const t=e.$implicit;oe(1),Jv(" ",t," ")}}N0.\u0275fac=function(e){return new(e||N0)},N0.\u0275pipe=gi({name:"bind",type:N0,pure:!0});const Gce=function(){return[10,10]},A5=function(){return[10,10,10]},Qce=function(){return[45,2,.1,100]},Wce=function(){return[0,0,0]},qce=function(i,e){return{change:i,end:e}};class j0{constructor(e){this.cdref=e,this.id="CID",this.changes=[],this.rotation=[0,0,0],this.position=[0,1,0],this.assetPath=`${aa}DamagedHelmet.glb`,this.onOrbitControlEnd=()=>{this.pushToChangesArray(`${this.id}: orbit control end`)},window.setInterval(()=>{this.rotation=[0,this.rotation[1]+.05,0],this.cdref.markForCheck()},1500),window.setInterval(()=>{this.position=[0,(this.position[1]+1)%5,0],this.cdref.markForCheck()},3e3)}logUpdates(e){this.pushToChangesArray(Object.keys(e).toString())}onLoaded(){this.changes.push("Model loaded")}onOrbitControlChange(){this.pushToChangesArray(`${this.id}: orbit control change`)}pushToChangesArray(e){this.changes.length>=20&&this.changes.shift(),this.changes.push(e)}}j0.\u0275fac=function(e){return new(e||j0)(R(er))},j0.\u0275cmp=$({type:j0,selectors:[["app-events-example"]],decls:14,vars:21,consts:[["loadGLTF","",3,"url","rotation","position","onUpdate","onLoaded"],[3,"args"],[3,"position"],[3,"args","position","lookAt"],[3,"threeEvents"],[1,"change-list"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(ve(0,"th-canvas")(1,"th-scene"),ze(2,"th-ambientLight"),ve(3,"th-object3D",0),mt("onUpdate",function(r){return t.logUpdates(r)})("onLoaded",function(){return t.onLoaded()}),Ie(),ze(4,"th-gridHelper",1)(5,"th-pointLight",2),ve(6,"th-perspectiveCamera",3),ze(7,"th-orbitControls",4),fr(8,"bind"),Ie()()(),ve(9,"div",5)(10,"h1"),qi(11,"Updates"),Ie(),ve(12,"ol"),Vt(13,Hce,2,1,"li",6),Ie()()),2&e&&(oe(3),K("url",t.assetPath)("rotation",t.rotation)("position",t.position),oe(1),K("args",Re(13,Gce)),oe(1),K("position",Re(14,A5)),oe(1),K("args",Re(15,Qce))("position",Re(16,A5))("lookAt",Re(17,Wce)),oe(1),K("threeEvents",wa(18,qce,function IL(i,e,t,n){const r=i+22,s=Le(),o=gh(s,r);return c_(s,r)?ML(s,es(),e,o.transform,t,n,o):o.transform(t,n)}(8,10,t.onOrbitControlChange,t),t.onOrbitControlEnd)),oe(6),K("ngForOf",t.changes))},dependencies:[$l,ds,rn,Ye,io,so,xr,mn,Vi,Po,N0],styles:[".change-list[_ngcontent-%COMP%]{padding:1em;box-shadow:0 4px 8px #0003;transition:.3s}[_nghost-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr)}"],changeDetection:0});const mp=JSON.parse('{"name":"ngx-three","version":"0.25.1","scripts":{"ng":"ng","start":"ng serve","build":"ng build ngx-three","build:prod":"ng build ngx-three --configuration production","build:demo":"ng build ngx-three-demo --configuration production --base-href /ngx-three/","test":"ng test","test-headless":"ng test --watch=false --browsers=ChromeHeadless","lint":"ng lint","e2e":"ng e2e","copy:docs":"(cp README.md dist/ngx-three/ || copy README.md dist\\\\ngx-three)","package":"ng build --configuration production ngx-three && npm run copy:docs","format":"prettier-eslint --write \\"{,!(node_modules|dist)/**/}*.{ts,tsx}\\""},"private":true,"dependencies":{"@angular/animations":"^15.1.1","@angular/cdk":"^15.1.1","@angular/common":"^15.1.1","@angular/compiler":"^15.1.1","@angular/core":"^15.1.1","@angular/forms":"^15.1.1","@angular/material":"^15.1.1","@angular/platform-browser":"^15.1.1","@angular/platform-browser-dynamic":"^15.1.1","@angular/router":"^15.1.1","@stackblitz/sdk":"^1.5.3","lil-gui":"^0.17.0","ngx-highlightjs":"^7.0.0","normalize.css":"^8.0.1","rxjs":"~7.5.5","simplex-noise":"^3.0.1","three":"~0.148.0","tslib":"^2.3.1","zone.js":"~0.11.4"},"devDependencies":{"@angular-devkit/build-angular":"^15.1.2","@angular-eslint/builder":"~15.2.0","@angular-eslint/eslint-plugin":"~15.2.0","@angular-eslint/eslint-plugin-template":"~15.2.0","@angular-eslint/schematics":"^15.2.0","@angular-eslint/template-parser":"~15.2.0","@angular/cli":"^15.1.2","@angular/compiler-cli":"^15.1.1","@types/jasmine":"~3.6.0","@types/node":"^18.0.0","@types/prettier":"^2.6.3","@types/three":"~0.148.0","@typescript-eslint/eslint-plugin":"^5.43.0","@typescript-eslint/parser":"^5.43.0","acorn":">=8","eslint":"^8.28.0","eslint-plugin-import":"^2.26.0","eslint-plugin-jsdoc":"^39.3.3","eslint-plugin-prefer-arrow":"^1.2.3","jasmine-core":"~3.6.0","jasmine-spec-reporter":"~5.0.0","karma":"~6.3.9","karma-chrome-launcher":"~3.1.0","karma-coverage":"~2.0.3","karma-jasmine":"~4.0.0","karma-jasmine-html-reporter":"^1.5.0","ng-packagr":"^15.1.1","prettier":"^2.7.1","prettier-eslint":"^15.0.1","prettier-eslint-cli":"^5.0.1","ts-node":"^10.8.1","typescript":"~4.9.4","utility-types":"^3.10.0"}}'),x5='\nimport "zone.js";';function HI(){return(HI=ss(function*(i,e){const n=U0(E5(i)),r=M5(n),s={"package.json":Zce(),"src/index.html":{content:C5(r)},"src/main.ts":{content:w5(n,e)},"src/polyfills.ts":{content:x5},"src/assets.ts":{content:`export const ASSET_PATH = '${o5}';`}};yield Yce(i,s),fetch("https://codesandbox.io/api/v1/sandboxes/define?json=1",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({files:s})}).then(o=>o.json()).then(o=>window.open(`https://codesandbox.io/s/${o.sandbox_id}`,"_blank"))})).apply(this,arguments)}function Yce(i,e){return Promise.all(i.map(t=>fetch(t).then(function(){var n=ss(function*(r){e[`src/app/${U0(t)}`]={content:yield r.text()}});return function(r){return n.apply(this,arguments)}}())))}function Zce(){return{content:{main:"src/main.ts",dependencies:{"ngx-three":"latest","@types/three":mp.devDependencies["@types/three"],...mp.dependencies},devDependencies:{...mp.devDependencies}}}}function U0(i){return i.replace(/^.*[\\\/]/,"")}function w5(i,e){const t=function Jce(i){if(i&&i.length>0)return i[0]}(e)??function Kce(i){return i.replace(".ts","").replace(/(?:^\w|[A-Z]|\b\w)/g,(e,t)=>e.toUpperCase()).replace(/[-.]/g,"")}(i),n=function ede(i,e){return i&&i.length>0?i.join(","):e}(e,t);return`\n            import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n            import { NgModule } from '@angular/core';\n            import { BrowserModule } from '@angular/platform-browser';\n            import { NgxThreeModule } from 'ngx-three';\n            import { FormsModule } from '@angular/forms';\n            import { ${n} } from './app/${i.replace(".ts","")}';\n\n            @NgModule({\n                imports: [\n                    BrowserModule,\n                    NgxThreeModule,\n                    FormsModule\n                ],\n                providers: [],\n                declarations: [${n}],\n                bootstrap: [${t}]\n            })\n            export class AppModule {}\n\n            platformBrowserDynamic().bootstrapModule(AppModule)\n            .catch(err => console.log(err));\n            `}function C5(i){return`\n    <!DOCTYPE html>\n    <html lang="en">\n    <head>\n        <meta charset="utf-8" />\n        <title>NgxThreeDemo</title>\n        <base href="/" />\n        <meta name="viewport" content="width=device-width, initial-scale=1" />\n        <link rel="icon" type="image/x-icon" href="favicon.ico" />\n    </head>\n    <body>\n        <${i}></${i}>\n    </body>\n    </html>\n    `}function M5(i){return"app-"+i.replace(".component.ts","")}function E5(i){for(const e of i)if(e.endsWith(".ts"))return e;return""}function $ce(i){for(const e of i)if(e.endsWith(".html"))return e}function gp(i){return i&&i.origin?i.origin:"https://stackblitz.com"}function S5(){return Math.random().toString(36).substring(7)}function _p(i){var e=[];return i&&(i.forceEmbedLayout&&e.push("embed=1"),i.clickToLoad&&e.push("ctl=1"),"string"==typeof i.openFile&&e.push("file="+i.openFile),"preview"!==i.view&&"editor"!==i.view||e.push("view="+i.view),"light"!==i.theme&&"dark"!==i.theme||e.push("theme="+i.theme),i.hideExplorer&&e.push("hideExplorer=1"),i.hideNavigation&&e.push("hideNavigation=1"),i.hideDevTools&&e.push("hidedevtools=1"),"number"==typeof i.devToolsHeight&&i.devToolsHeight>=0&&i.devToolsHeight<=100&&e.push("devtoolsheight="+Math.round(i.devToolsHeight))),e.length?"?"+e.join("&"):""}function GI(i,e,t){if(null===i.parentNode)throw new Error("Invalid Element");e.id=i.id,function ide(i,e){e&&(e.hasOwnProperty("height")&&(i.height=""+e.height),e.hasOwnProperty("width")&&(i.width=""+e.width)),i.height||(i.height="300"),i.width||i.setAttribute("style","width:100%;")}(e,t),i.parentNode.replaceChild(e,i)}function QI(i){if("string"==typeof i){var e=document.getElementById(i);if(null!==e)return e}else if(i instanceof HTMLElement)return i;throw new Error("Invalid Element")}function WI(i){return i&&!1===i.newWindow?"_self":"_blank"}var T5=function(i){var e=this;this.pending={},this.port=i,this.port.onmessage=function(t){if(t.data.payload.__reqid){var n=t.data.payload.__reqid,r=t.data.payload.__success;if(e.pending[n]){if(delete t.data.payload.__reqid,delete t.data.payload.__success,r){var s=0===Object.keys(t.data.payload).length&&t.data.payload.constructor===Object?null:t.data.payload;e.pending[n].resolve(s)}else e.pending[n].reject(t.data.payload.error?t.data.type+": "+t.data.payload.error:t.data.type);delete e.pending[n]}}}};T5.prototype.request=function(i){var e=this,t=S5();return new Promise(function(n,r){e.pending[t]={resolve:n,reject:r},i.payload.__reqid=t,e.port.postMessage(i)})};var Px=function(i,e){var t=this;this.rdc=new T5(i),this.preview={},Object.defineProperty(this.preview,"origin",{value:e.previewOrigin,writable:!1}),this.editor={openFile:function(n){return t.rdc.request({type:"SDK_OPEN_FILE",payload:{path:n}})}}};Px.prototype.applyFsDiff=function(i){return this.rdc.request({type:"SDK_APPLY_FS_DIFF",payload:i})},Px.prototype.getFsSnapshot=function(){return this.rdc.request({type:"SDK_GET_FS_SNAPSHOT",payload:{}})},Px.prototype.getDependencies=function(){return this.rdc.request({type:"SDK_GET_DEPS_SNAPSHOT",payload:{}})};var kx=[],nde=function(i){var e=this;this.id=S5(),this.element=i,this.pending=new Promise(function(t,n){var r=function(c){c.data.action&&"SDK_INIT_SUCCESS"===c.data.action&&c.data.id===e.id&&(e.vm=new Px(c.ports[0],c.data.payload),t(e.vm),o())},s=function(){e.element.contentWindow&&e.element.contentWindow.postMessage({action:"SDK_INIT",id:e.id},"*")};function o(){window.clearInterval(l),window.removeEventListener("message",r)}window.addEventListener("message",r),s();var a=0,l=window.setInterval(function(){if(e.vm)o();else{if(a>=20)return o(),n("Timeout: Unable to establish a connection with the StackBlitz VM"),void kx.forEach(function(c,d){c.id===e.id&&kx.splice(d,1)});a++,s()}},500)}),kx.push(this)},I5=["typescript","create-react-app","angular-cli","javascript","polymer","vue"];function yu(i,e){var t=document.createElement("input");return t.type="hidden",t.name=i,t.value=e,t}function R5(i){-1===I5.indexOf(i.template)&&console.warn("Unsupported project template, must be one of: "+I5.join(", "));var e=document.createElement("form");return e.method="POST",e.setAttribute("style","display:none;"),e.appendChild(yu("project[title]",i.title)),e.appendChild(yu("project[description]",i.description)),e.appendChild(yu("project[template]",i.template)),i.tags&&i.tags.forEach(function(t){e.appendChild(yu("project[tags][]",t))}),i.dependencies&&e.appendChild(yu("project[dependencies]",JSON.stringify(i.dependencies))),i.settings&&e.appendChild(yu("project[settings]",JSON.stringify(i.settings))),Object.keys(i.files).forEach(function(t){e.appendChild(yu("project[files]["+t+"]",i.files[t]))}),e}var Fx={connect:function(i){if(!i||!i.contentWindow)return Promise.reject("Provided element is not an iframe.");var e=function(i){var e=i instanceof Element?"element":"id";return kx.find(function(n){return n[e]===i})||null}(i);return e?e.pending:new nde(i).pending},openGithubProject:function(i,e){window.open(gp(e)+"/github/"+i+_p(e),WI(e))},openProject:function(i,e){!function ode(i,e){var t=R5(i);t.action=gp(e)+"/run"+_p(e),t.target=WI(e),document.body.appendChild(t),t.submit(),document.body.removeChild(t)}(i,e)},openProjectId:function(i,e){window.open(gp(e)+"/edit/"+i+_p(e),WI(e))},embedGithubProject:function(i,e,t){var n=QI(i),r=document.createElement("iframe");return r.src=gp(t)+"/github/"+e+_p(t),GI(n,r,t),Fx.connect(r)},embedProject:function(i,e,t){var n=QI(i),r=function sde(i,e){var t=R5(i);return t.action=gp(e)+"/run"+_p(e),t.id="sb","<html><head><title></title></head><body>"+t.outerHTML+"<script>document.getElementById('sb').submit();<\/script></body></html>"}(e,t),s=document.createElement("iframe");return GI(n,s,t),s.contentDocument&&s.contentDocument.write(r),Fx.connect(s)},embedProjectId:function(i,e,t){var n=QI(i),r=document.createElement("iframe");return r.src=gp(t)+"/edit/"+e+_p(t),GI(n,r,t),Fx.connect(r)}};const ade=Fx;function qI(){return(qI=ss(function*(i,e){const t=E5(i),n=$ce(i),r=U0(t),s=M5(r),o={template:"angular-cli",title:s,description:"ngx-three example "+s,files:{"src/index.html":C5(s),"src/main.ts":w5(r,e),"src/polyfills.ts":x5,"src/assets.ts":`export const ASSET_PATH = '${o5}';`},dependencies:{"ngx-three":"latest","@types/three":mp.devDependencies["@types/three"],...mp.dependencies},devDependencies:{...mp.devDependencies}};yield cde(i,o.files);const a=n?{openFile:`src/app/${U0(n)}`}:void 0;ade.openProject(o,a)})).apply(this,arguments)}function cde(i,e){return Promise.all(i.map(t=>fetch(t).then(function(){var n=ss(function*(r){const s=yield r.text();e[`src/app/${U0(t)}`]=s});return function(r){return n.apply(this,arguments)}}())))}class Bx{constructor(){this.urls=[],this.fileNames=[]}setUrls(e){this.urls=e,this.fileNames=this.extractFileNames()}extractFileNames(){return this.urls.map(e=>e.split("/").pop()??"")}toStackblitz(e){e?.preventDefault(),function lde(i,e){qI.apply(this,arguments)}(this.urls,this.declarations)}toCodeSandbox(e){e?.preventDefault(),function Xce(i,e){HI.apply(this,arguments)}(this.urls,this.declarations)}}let XI;try{XI=typeof Intl<"u"&&Intl.v8BreakIterator}catch{XI=!1}let V0,Lx,Au,YI,Hn=(()=>{class i{constructor(t){this._platformId=t,this.isBrowser=this._platformId?s3(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!XI)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return i.\u0275fac=function(t){return new(t||i)(ye(h_))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function z0(i){return function dde(){if(null==V0&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>V0=!0}))}finally{V0=V0||!1}return V0}()?i:!!i.capture}function P5(){if(null==Au){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Au=!1,Au;if("scrollBehavior"in document.documentElement.style)Au=!0;else{const i=Element.prototype.scrollTo;Au=!!i&&!/\{\s*\[native code\]\s*\}/.test(i.toString())}}return Au}function H0(){if("object"!=typeof document||!document)return 0;if(null==Lx){const i=document.createElement("div"),e=i.style;i.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),n=t.style;n.width="2px",n.height="1px",i.appendChild(t),document.body.appendChild(i),Lx=0,0===i.scrollLeft&&(i.scrollLeft=1,Lx=0===i.scrollLeft?1:2),i.remove()}return Lx}function Cc(i){return i.composedPath?i.composedPath()[0]:i.target}function ZI(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Ox(i,...e){return e.length?e.some(t=>i[t]):i.altKey||i.shiftKey||i.ctrlKey||i.metaKey}class Pde extends cn{constructor(e,t){super()}schedule(e,t=0){return this}}const Nx={setInterval(i,e,...t){const{delegate:n}=Nx;return n?.setInterval?n.setInterval(i,e,...t):setInterval(i,e,...t)},clearInterval(i){const{delegate:e}=Nx;return(e?.clearInterval||clearInterval)(i)},delegate:void 0};class KI extends Pde{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,n=0){return Nx.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;Nx.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,n=!1;try{this.work(e)}catch(s){n=!0,r=s||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Zb(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}class G0{constructor(e,t=G0.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}G0.now=FI.now;class $I extends G0{constructor(e,t=G0.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const JI=new $I(KI),kde=JI;function jx(i,e=JI){return xn((t,n)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const c=s;s=null,n.next(c)}};function l(){const c=o+i,d=e.now();if(d<c)return r=this.schedule(void 0,c-d),void n.add(r);a()}t.subscribe(dn(n,c=>{s=c,o=e.now(),r||(r=e.schedule(l,i),n.add(r))},()=>{a(),n.complete()},void 0,()=>{s=r=null}))})}function eR(i){return Bn((e,t)=>i<=t)}function tR(i,e=Ql){return i=i??Fde,xn((t,n)=>{let r,s=!0;t.subscribe(dn(n,o=>{const a=e(o);(s||!i(r,a))&&(s=!1,r=a,n.next(o))}))})}function Fde(i,e){return i===e}function zi(i){return null!=i&&"false"!=`${i}`}function us(i,e=0){return function Bde(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}(i)?Number(i):e}function Ux(i){return Array.isArray(i)?i:[i]}function rr(i){return null==i?"":"string"==typeof i?i:`${i}px`}function xu(i){return i instanceof Ht?i.nativeElement:i}let L5=(()=>{class i{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Lde=(()=>{class i{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,n)=>this._cleanupObserver(n))}observe(t){const n=xu(t);return new Fi(r=>{const o=this._observeElement(n).subscribe(r);return()=>{o.unsubscribe(),this._unobserveElement(n)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const n=new Wt,r=this._mutationObserverFactory.create(s=>n.next(s));r&&r.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:r,stream:n,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:n,stream:r}=this._observedElements.get(t);n&&n.disconnect(),r.complete(),this._observedElements.delete(t)}}}return i.\u0275fac=function(t){return new(t||i)(ye(L5))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),iR=(()=>{class i{get disabled(){return this._disabled}set disabled(t){this._disabled=zi(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=us(t),this._subscribe()}constructor(t,n,r){this._contentObserver=t,this._elementRef=n,this._ngZone=r,this.event=new Ct,this._disabled=!1,this._currentSubscription=null}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(jx(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(R(Lde),R(Ht),R(at))},i.\u0275dir=ke({type:i,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),i})(),Vx=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({providers:[L5]}),i})(),Ode=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({}),i})();const O5=new Set;let vp,Nde=(()=>{class i{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Ude}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function jde(i){if(!O5.has(i))try{vp||(vp=document.createElement("style"),vp.setAttribute("type","text/css"),document.head.appendChild(vp)),vp.sheet&&(vp.sheet.insertRule(`@media ${i} {body{ }}`,0),O5.add(i))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return i.\u0275fac=function(t){return new(t||i)(ye(Hn))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function Ude(i){return{matches:"all"===i||""===i,media:i,addListener:()=>{},removeListener:()=>{}}}let N5=(()=>{class i{constructor(t,n){this._mediaMatcher=t,this._zone=n,this._queries=new Map,this._destroySubject=new Wt}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return j5(Ux(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=uS(j5(Ux(t)).map(o=>this._registerQuery(o).observable));return s=ky(s.pipe(ps(1)),s.pipe(eR(1),jx(0))),s.pipe(vt(o=>{const a={matches:!1,breakpoints:{}};return o.forEach(({matches:l,query:c})=>{a.matches=a.matches||l,a.breakpoints[c]=l}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const n=this._mediaMatcher.matchMedia(t),s={observable:new Fi(o=>{const a=l=>this._zone.run(()=>o.next(l));return n.addListener(a),()=>{n.removeListener(a)}}).pipe(ec(n),vt(({matches:o})=>({query:t,matches:o})),_n(this._destroySubject)),mql:n};return this._queries.set(t,s),s}}return i.\u0275fac=function(t){return new(t||i)(ye(Nde),ye(at))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function j5(i){return i.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}class Gde{constructor(e){this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new Wt,this._typeaheadSubscription=cn.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=t=>t.disabled,this._pressedLetters=[],this.tabOut=new Wt,this.change=new Wt,e instanceof Sd&&(this._itemChangesSubscription=e.changes.subscribe(t=>{if(this._activeItem){const r=t.toArray().indexOf(this._activeItem);r>-1&&r!==this._activeItemIndex&&(this._activeItemIndex=r)}}))}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(nn(t=>this._pressedLetters.push(t)),jx(e),Bn(()=>this._pressedLetters.length>0),vt(()=>this._pressedLetters.join(""))).subscribe(t=>{const n=this._getItemsArray();for(let r=1;r<n.length+1;r++){const s=(this._activeItemIndex+r)%n.length,o=n[s];if(!this._skipPredicateFn(o)&&0===o.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(s);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}withPageUpDown(e=!0,t=10){return this._pageUpAndDown={enabled:e,delta:t},this}setActiveItem(e){const t=this._activeItem;this.updateActiveItem(e),this._activeItem!==t&&this.change.next(this._activeItemIndex)}onKeydown(e){const t=e.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!e[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;case 33:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(s>0?s:0,1);break}return;case 34:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex+this._pageUpAndDown.delta,o=this._getItemsArray().length;this._setActiveItemByIndex(s<o?s:o-1,-1);break}return;default:return void((r||Ox(e,"shiftKey"))&&(e.key&&1===e.key.length?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))))}this._pressedLetters=[],e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){const t=this._getItemsArray(),n="number"==typeof e?e:t.indexOf(e);this._activeItem=t[n]??null,this._activeItemIndex=n}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){const t=this._getItemsArray();for(let n=1;n<=t.length;n++){const r=(this._activeItemIndex+e*n+t.length)%t.length;if(!this._skipPredicateFn(t[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,t){const n=this._getItemsArray();if(n[e]){for(;this._skipPredicateFn(n[e]);)if(!n[e+=t])return;this.setActiveItem(e)}}_getItemsArray(){return this._items instanceof Sd?this._items.toArray():this._items}}class z5 extends Gde{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(e){return this._origin=e,this}setActiveItem(e){super.setActiveItem(e),this.activeItem&&this.activeItem.focus(this._origin)}}let H5=(()=>{class i{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function Wde(i){return!!(i.offsetWidth||i.offsetHeight||"function"==typeof i.getClientRects&&i.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const n=function Qde(i){try{return i.frameElement}catch{return null}}(function eue(i){return i.ownerDocument&&i.ownerDocument.defaultView||window}(t));if(n&&(-1===Q5(n)||!this.isVisible(n)))return!1;let r=t.nodeName.toLowerCase(),s=Q5(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function $de(i){let e=i.nodeName.toLowerCase(),t="input"===e&&i.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,n){return function Jde(i){return!function Xde(i){return function Zde(i){return"input"==i.nodeName.toLowerCase()}(i)&&"hidden"==i.type}(i)&&(function qde(i){let e=i.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(i)||function Yde(i){return function Kde(i){return"a"==i.nodeName.toLowerCase()}(i)&&i.hasAttribute("href")}(i)||i.hasAttribute("contenteditable")||G5(i))}(t)&&!this.isDisabled(t)&&(n?.ignoreVisibility||this.isVisible(t))}}return i.\u0275fac=function(t){return new(t||i)(ye(Hn))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function G5(i){if(!i.hasAttribute("tabindex")||void 0===i.tabIndex)return!1;let e=i.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function Q5(i){if(!G5(i))return null;const e=parseInt(i.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class tue{get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}constructor(e,t,n,r,s=!1){this._element=e,this._checker=t,this._ngZone=n,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const n=this._getFirstTabbableElement(t);return n?.focus(e),!!n}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let n=0;n<t.length;n++){const r=t[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[n]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let n=t.length-1;n>=0;n--){const r=t[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[n]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(ps(1)).subscribe(e)}}let iue=(()=>{class i{constructor(t,n,r){this._checker=t,this._ngZone=n,this._document=r}create(t,n=!1){return new tue(t,this._checker,this._ngZone,this._document,n)}}return i.\u0275fac=function(t){return new(t||i)(ye(H5),ye(at),ye(ii))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function W5(i){return 0===i.buttons||0===i.offsetX&&0===i.offsetY}function q5(i){const e=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const nue=new Fe("cdk-input-modality-detector-options"),rue={ignoreKeys:[18,17,224,91,16]},yp=z0({passive:!0,capture:!0});let sue=(()=>{class i{get mostRecentModality(){return this._modality.value}constructor(t,n,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new Qs(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(a=>a===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Cc(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(W5(o)?"keyboard":"mouse"),this._mostRecentTarget=Cc(o))},this._onTouchstart=o=>{q5(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Cc(o))},this._options={...rue,...s},this.modalityDetected=this._modality.pipe(eR(1)),this.modalityChanged=this.modalityDetected.pipe(tR()),t.isBrowser&&n.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,yp),r.addEventListener("mousedown",this._onMousedown,yp),r.addEventListener("touchstart",this._onTouchstart,yp)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,yp),document.removeEventListener("mousedown",this._onMousedown,yp),document.removeEventListener("touchstart",this._onTouchstart,yp))}}return i.\u0275fac=function(t){return new(t||i)(ye(Hn),ye(at),ye(ii),ye(nue,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const aue=new Fe("cdk-focus-monitor-default-options"),zx=z0({passive:!0,capture:!0});let nR=(()=>{class i{constructor(t,n,r,s,o){this._ngZone=t,this._platform=n,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Wt,this._rootNodeFocusAndBlurListener=a=>{for(let c=Cc(a);c;c=c.parentElement)"focus"===a.type?this._onFocus(a,c):this._onBlur(a,c)},this._document=s,this._detectionMode=o?.detectionMode||0}monitor(t,n=!1){const r=xu(t);if(!this._platform.isBrowser||1!==r.nodeType)return wt(null);const s=function hde(i){if(function ude(){if(null==YI){const i=typeof document<"u"?document.head:null;YI=!(!i||!i.createShadowRoot&&!i.attachShadow)}return YI}()){const e=i.getRootNode?i.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return n&&(o.checkChildren=!0),o.subject;const a={checkChildren:n,subject:new Wt,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const n=xu(t),r=this._elementInfo.get(n);r&&(r.subject.complete(),this._setClasses(n),this._elementInfo.delete(n),this._removeGlobalListeners(r))}focusVia(t,n,r){const s=xu(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,l])=>this._originChanged(a,n,l)):(this._setOrigin(n),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,n)=>this.stopMonitoring(n))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,n){t.classList.toggle("cdk-focused",!!n),t.classList.toggle("cdk-touch-focused","touch"===n),t.classList.toggle("cdk-keyboard-focused","keyboard"===n),t.classList.toggle("cdk-mouse-focused","mouse"===n),t.classList.toggle("cdk-program-focused","program"===n)}_setOrigin(t,n=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&n,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,n){const r=this._elementInfo.get(n),s=Cc(t);!r||!r.checkChildren&&n!==s||this._originChanged(n,this._getFocusOrigin(s),r)}_onBlur(t,n){const r=this._elementInfo.get(n);!r||r.checkChildren&&t.relatedTarget instanceof Node&&n.contains(t.relatedTarget)||(this._setClasses(n),this._emitOrigin(r,null))}_emitOrigin(t,n){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(n))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const n=t.rootNode,r=this._rootNodeFocusListenerCount.get(n)||0;r||this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",this._rootNodeFocusAndBlurListener,zx),n.addEventListener("blur",this._rootNodeFocusAndBlurListener,zx)}),this._rootNodeFocusListenerCount.set(n,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(_n(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const n=t.rootNode;if(this._rootNodeFocusListenerCount.has(n)){const r=this._rootNodeFocusListenerCount.get(n);r>1?this._rootNodeFocusListenerCount.set(n,r-1):(n.removeEventListener("focus",this._rootNodeFocusAndBlurListener,zx),n.removeEventListener("blur",this._rootNodeFocusAndBlurListener,zx),this._rootNodeFocusListenerCount.delete(n))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,n,r){this._setClasses(t,n),this._emitOrigin(r,n),this._lastFocusOrigin=n}_getClosestElementsInfo(t){const n=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&n.push([s,r])}),n}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:n,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!n||n===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const s=t.labels;if(s)for(let o=0;o<s.length;o++)if(s[o].contains(n))return!0;return!1}}return i.\u0275fac=function(t){return new(t||i)(ye(at),ye(Hn),ye(sue),ye(ii,8),ye(aue,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),lue=(()=>{class i{constructor(t,n){this._elementRef=t,this._focusMonitor=n,this._focusOrigin=null,this.cdkFocusChange=new Ct}get focusOrigin(){return this._focusOrigin}ngAfterViewInit(){const t=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(t,1===t.nodeType&&t.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(n=>{this._focusOrigin=n,this.cdkFocusChange.emit(n)})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(nR))},i.\u0275dir=ke({type:i,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"},exportAs:["cdkMonitorFocus"]}),i})();const Y5="cdk-high-contrast-black-on-white",Z5="cdk-high-contrast-white-on-black",rR="cdk-high-contrast-active";let K5=(()=>{class i{constructor(t,n){this._platform=t,this._document=n,this._breakpointSubscription=Ut(N5).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const n=this._document.defaultView||window,r=n&&n.getComputedStyle?n.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(rR,Y5,Z5),this._hasCheckedHighContrastMode=!0;const n=this.getHighContrastMode();1===n?t.add(rR,Y5):2===n&&t.add(rR,Z5)}}}return i.\u0275fac=function(t){return new(t||i)(ye(Hn),ye(ii))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),cue=(()=>{class i{constructor(t){t._applyBodyHighContrastModeCssClasses()}}return i.\u0275fac=function(t){return new(t||i)(ye(K5))},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[Vx]}),i})();const due=new Fe("cdk-dir-doc",{providedIn:"root",factory:function uue(){return Ut(ii)}}),hue=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let za=(()=>{class i{constructor(t){this.value="ltr",this.change=new Ct,t&&(this.value=function fue(i){const e=i?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?hue.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return i.\u0275fac=function(t){return new(t||i)(ye(due,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Q0=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({}),i})();const mue=new Fe("mat-sanity-checks",{providedIn:"root",factory:function pue(){return!0}});let bn=(()=>{class i{constructor(t,n,r){this._sanityChecks=n,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!ZI()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return i.\u0275fac=function(t){return new(t||i)(ye(K5),ye(mue,8),ye(ii))},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[Q0,Q0]}),i})();function sR(i){return class extends i{get disabled(){return this._disabled}set disabled(e){this._disabled=zi(e)}constructor(...e){super(...e),this._disabled=!1}}}function Hx(i,e){return class extends i{get color(){return this._color}set color(t){const n=t||this.defaultColor;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}constructor(...t){super(...t),this.defaultColor=e,this.color=e}}}function eV(i){return class extends i{get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=zi(e)}constructor(...e){super(...e),this._disableRipple=!1}}}class _ue{constructor(e,t,n,r=!1){this._renderer=e,this.element=t,this.config=n,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const tV=z0({passive:!0,capture:!0});class bue{constructor(){this._events=new Map,this._delegateEventHandler=e=>{const t=Cc(e);t&&this._events.get(e.type)?.forEach((n,r)=>{(r===t||r.contains(t))&&n.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,n,r){const s=this._events.get(t);if(s){const o=s.get(n);o?o.add(r):s.set(n,new Set([r]))}else this._events.set(t,new Map([[n,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,tV)})}removeHandler(e,t,n){const r=this._events.get(e);if(!r)return;const s=r.get(t);s&&(s.delete(n),0===s.size&&r.delete(t),0===r.size&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,tV)))}}const iV={enterDuration:225,exitDuration:150},nV=z0({passive:!0,capture:!0}),rV=["mousedown","touchstart"],sV=["mouseup","mouseleave","touchend","touchcancel"];class Ap{constructor(e,t,n,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=xu(n))}fadeInRipple(e,t,n={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...iV,...n.animation};n.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=n.radius||function yue(i,e,t){const n=Math.max(Math.abs(i-t.left),Math.abs(i-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(n*n+r*r)}(e,t,r),a=e-r.left,l=t-r.top,c=s.enterDuration,d=document.createElement("div");d.classList.add("mat-ripple-element"),d.style.left=a-o+"px",d.style.top=l-o+"px",d.style.height=2*o+"px",d.style.width=2*o+"px",null!=n.color&&(d.style.backgroundColor=n.color),d.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(d);const u=window.getComputedStyle(d),f=u.transitionDuration,m="none"===u.transitionProperty||"0s"===f||"0s, 0s"===f||0===r.width&&0===r.height,p=new _ue(this,d,n,m);d.style.transform="scale3d(1, 1, 1)",p.state=0,n.persistent||(this._mostRecentTransientRipple=p);let g=null;return!m&&(c||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const _=()=>this._finishRippleTransition(p),v=()=>this._destroyRipple(p);d.addEventListener("transitionend",_),d.addEventListener("transitioncancel",v),g={onTransitionEnd:_,onTransitionCancel:v}}),this._activeRipples.set(p,g),(m||!c)&&this._finishRippleTransition(p),p}fadeOutRipple(e){if(2===e.state||3===e.state)return;const t=e.element,n={...iV,...e.config.animation};t.style.transitionDuration=`${n.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=xu(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,rV.forEach(n=>{Ap._eventManager.addHandler(this._ngZone,n,t,this)}))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{sV.forEach(t=>{this._triggerElement.addEventListener(t,this,nV)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){0===e.state?this._startFadeOutTransition(e):2===e.state&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:n}=e.config;e.state=1,!n&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=W5(e),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!n&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!q5(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let n=0;n<t.length;n++)this.fadeInRipple(t[n].clientX,t[n].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const e=this._triggerElement;e&&(rV.forEach(t=>Ap._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&sV.forEach(t=>e.removeEventListener(t,this,nV)))}}Ap._eventManager=new bue;const Gx=new Fe("mat-ripple-global-options");let q0=(()=>{class i{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,n,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new Ap(this,n,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,n=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,n,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(at),R(Hn),R(Gx,8),R(rs,8))},i.\u0275dir=ke({type:i,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,n){2&t&&Mi("mat-ripple-unbounded",n.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),i})(),X0=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[bn,bn]}),i})(),oV=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[bn]}),i})(),aV=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[X0,Ea,bn,oV]}),i})();const Aue=["mat-button",""],xue=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],wue=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],Mue=["mat-icon-button",""],Eue=["*"],Sue=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],Tue=Hx(sR(eV(class{constructor(i){this._elementRef=i}})));let lV=(()=>{class i extends Tue{constructor(t,n,r,s){super(t),this._platform=n,this._ngZone=r,this._animationMode=s,this._focusMonitor=Ut(nR),this._isFab=!1;const o=t.nativeElement.classList;for(const a of Sue)this._hasHostAttributes(a.selector)&&a.mdcClasses.forEach(l=>{o.add(l)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t="program",n){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,n):this._elementRef.nativeElement.focus(n)}_hasHostAttributes(...t){return t.some(n=>this._elementRef.nativeElement.hasAttribute(n))}_isRippleDisabled(){return this.disableRipple||this.disabled}}return i.\u0275fac=function(t){Xg()},i.\u0275dir=ke({type:i,viewQuery:function(t,n){if(1&t&&Di(q0,5),2&t){let r;Pt(r=kt())&&(n.ripple=r.first)}},features:[W]}),i})(),cV=(()=>{class i extends lV{constructor(t,n,r,s){super(t,n,r,s)}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(Hn),R(at),R(rs,8))},i.\u0275cmp=$({type:i,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:7,hostBindings:function(t,n){2&t&&(hn("disabled",n.disabled||null),Mi("_mat-animation-noopable","NoopAnimations"===n._animationMode)("mat-unthemed",!n.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[W],attrs:Aue,ngContentSelectors:wue,decls:8,vars:6,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(t,n){1&t&&(Pn(xue),ze(0,"span",0),ti(1),ve(2,"span",1),ti(3,1),Ie(),ti(4,2),ze(5,"span",2)(6,"span",3)(7,"span",4)),2&t&&(Mi("mdc-button__ripple",!n._isFab)("mdc-fab__ripple",n._isFab),oe(6),K("matRippleDisabled",n._isRippleDisabled())("matRippleTrigger",n._elementRef.nativeElement))},dependencies:[q0],styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    );display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{height:var(--mdc-text-button-container-height, 36px);border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, inherit)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button{height:var(--mdc-filled-button-container-height, 36px);border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color, transparent)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, inherit)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button{height:var(--mdc-protected-button-container-height, 36px);border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px));box-shadow:var(--mdc-protected-button-container-elevation, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color, transparent)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, inherit)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button.mdc-ripple-upgraded--background-focused,.mat-mdc-raised-button:not(.mdc-ripple-upgraded):focus{box-shadow:var(--mdc-protected-button-focus-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled):active{box-shadow:var(--mdc-protected-button-pressed-container-elevation, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button{height:var(--mdc-outlined-button-container-height, 36px);border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px));padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, inherit)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width, 1px));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width, 1px))}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-button .mat-ripple-element,.mat-mdc-unelevated-button .mat-ripple-element,.mat-mdc-raised-button .mat-ripple-element,.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button[disabled],.mat-mdc-unelevated-button[disabled],.mat-mdc-raised-button[disabled],.mat-mdc-outlined-button[disabled]{cursor:default;pointer-events:none}.mat-mdc-button .mat-mdc-button-touch-target,.mat-mdc-unelevated-button .mat-mdc-button-touch-target,.mat-mdc-raised-button .mat-mdc-button-touch-target,.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .mat-mdc-button>.mat-icon,.mat-mdc-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}.mat-mdc-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon,.mat-mdc-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem;margin-left:-4px;margin-right:8px}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:-4px}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon,.mat-mdc-raised-button .mdc-button__label+.mat-icon,.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:-4px}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon,.mat-mdc-unelevated-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-raised-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-outlined-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:-4px;margin-right:8px}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px) * -1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),i})(),Due=(()=>{class i extends lV{constructor(t,n,r,s){super(t,n,r,s)}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(Hn),R(at),R(rs,8))},i.\u0275cmp=$({type:i,selectors:[["button","mat-icon-button",""]],hostVars:7,hostBindings:function(t,n){2&t&&(hn("disabled",n.disabled||null),Mi("_mat-animation-noopable","NoopAnimations"===n._animationMode)("mat-unthemed",!n.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[W],attrs:Mue,ngContentSelectors:Eue,decls:5,vars:3,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(t,n){1&t&&(Pn(),ze(0,"span",0),ti(1),ze(2,"span",1)(3,"span",2)(4,"span",3)),2&t&&(oe(3),K("matRippleDisabled",n._isRippleDisabled())("matRippleCentered",!0)("matRippleTrigger",n._elementRef.nativeElement))},dependencies:[q0],styles:['.mdc-icon-button{font-size:24px;width:48px;height:48px;padding:12px}.mdc-icon-button .mdc-icon-button__focus-ring{max-height:48px;max-width:48px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__ripple{width:40px;height:40px;margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__focus-ring{max-height:40px;max-width:40px}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-icon-button svg,.mdc-icon-button img{width:24px;height:24px}.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size, 48px);width:var(--mdc-icon-button-state-layer-size, 48px);color:var(--mdc-icon-button-icon-color, inherit);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size, 24px);height:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity, 0.38)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color, #000)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),i})(),oR=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[bn,X0,bn]}),i})();function dV(...i){const e=cM(i),{args:t,keys:n}=k3(i),r=new Fi(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let d=0;d<o;d++){let u=!1;fs(t[d]).subscribe(dn(s,h=>{u||(u=!0,c--),a[d]=h},()=>l--,void 0,()=>{(!l||!u)&&(c||s.next(n?F3(n,a):a),s.complete())}))}});return e?r.pipe(dS(e)):r}class Qx{}class aR{}class kl{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const n=t.indexOf(":");if(n>0){const r=t.slice(0,n),s=r.toLowerCase(),o=t.slice(n+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let n=e[t];const r=t.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof kl?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new kl;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof kl?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...n),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Pue{encodeKey(e){return uV(e)}encodeValue(e){return uV(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Fue=/%(\d[a-f0-9])/gi,Bue={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function uV(i){return encodeURIComponent(i).replace(Fue,(e,t)=>Bue[t]??e)}function Wx(i){return`${i}`}class Fl{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Pue,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function kue(i,e){const t=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t],r=Array.isArray(n)?n.map(Wx):[Wx(n)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const r=e[n];Array.isArray(r)?r.forEach(s=>{t.push({param:n,value:s,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Fl({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Wx(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let n=this.map.get(e.param)||[];const r=n.indexOf(Wx(e.value));-1!==r&&n.splice(r,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Lue{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function hV(i){return typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer}function fV(i){return typeof Blob<"u"&&i instanceof Blob}function pV(i){return typeof FormData<"u"&&i instanceof FormData}class Y0{constructor(e,t,n,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Oue(i){switch(i){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,s=r):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new kl),this.context||(this.context=new Lue),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new Fl,this.urlWithParams=t}serializeBody(){return null===this.body?null:hV(this.body)||fV(this.body)||pV(this.body)||function Nue(i){return typeof URLSearchParams<"u"&&i instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Fl?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||pV(this.body)?null:fV(this.body)?this.body.type||null:hV(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Fl?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,n=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let l=e.headers||this.headers,c=e.params||this.params;const d=e.context??this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((u,h)=>u.set(h,e.setHeaders[h]),l)),e.setParams&&(c=Object.keys(e.setParams).reduce((u,h)=>u.set(h,e.setParams[h]),c)),new Y0(t,n,s,{params:c,headers:l,context:d,reportProgress:a,responseType:r,withCredentials:o})}}var sr=(()=>((sr=sr||{})[sr.Sent=0]="Sent",sr[sr.UploadProgress=1]="UploadProgress",sr[sr.ResponseHeader=2]="ResponseHeader",sr[sr.DownloadProgress=3]="DownloadProgress",sr[sr.Response=4]="Response",sr[sr.User=5]="User",sr))();class lR{constructor(e,t=200,n="OK"){this.headers=e.headers||new kl,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class cR extends lR{constructor(e={}){super(e),this.type=sr.ResponseHeader}clone(e={}){return new cR({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class qx extends lR{constructor(e={}){super(e),this.type=sr.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new qx({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class mV extends lR{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function dR(i,e){return{body:e,headers:i.headers,context:i.context,observe:i.observe,params:i.params,reportProgress:i.reportProgress,responseType:i.responseType,withCredentials:i.withCredentials}}let Xx=(()=>{class i{constructor(t){this.handler=t}request(t,n,r={}){let s;if(t instanceof Y0)s=t;else{let l,c;l=r.headers instanceof kl?r.headers:new kl(r.headers),r.params&&(c=r.params instanceof Fl?r.params:new Fl({fromObject:r.params})),s=new Y0(t,n,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=wt(s).pipe(ic(l=>this.handler.handle(l)));if(t instanceof Y0||"events"===r.observe)return o;const a=o.pipe(Bn(l=>l instanceof qx));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(vt(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(vt(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(vt(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(vt(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,n={}){return this.request("DELETE",t,n)}get(t,n={}){return this.request("GET",t,n)}head(t,n={}){return this.request("HEAD",t,n)}jsonp(t,n){return this.request("JSONP",t,{params:(new Fl).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,n={}){return this.request("OPTIONS",t,n)}patch(t,n,r={}){return this.request("PATCH",t,dR(r,n))}post(t,n,r={}){return this.request("POST",t,dR(r,n))}put(t,n,r={}){return this.request("PUT",t,dR(r,n))}}return i.\u0275fac=function(t){return new(t||i)(ye(Qx))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();function gV(i,e){return e(i)}function jue(i,e){return(t,n)=>e.intercept(t,{handle:r=>i(r,n)})}const Vue=new Fe("HTTP_INTERCEPTORS"),Z0=new Fe("HTTP_INTERCEPTOR_FNS");function zue(){let i=null;return(e,t)=>(null===i&&(i=(Ut(Vue,{optional:!0})??[]).reduceRight(jue,gV)),i(e,t))}let _V=(()=>{class i extends Qx{constructor(t,n){super(),this.backend=t,this.injector=n,this.chain=null}handle(t){if(null===this.chain){const n=Array.from(new Set(this.injector.get(Z0)));this.chain=n.reduceRight((r,s)=>function Uue(i,e,t){return(n,r)=>t.runInContext(()=>e(n,s=>i(s,r)))}(r,s,this.injector),gV)}return this.chain(t,n=>this.backend.handle(n))}}return i.\u0275fac=function(t){return new(t||i)(ye(aR),ye(va))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();const Wue=/^\)\]\}',?\n/;let vV=(()=>{class i{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Fi(n=>{const r=this.xhrFactory.build();if(r.open(t.method,t.urlWithParams),t.withCredentials&&(r.withCredentials=!0),t.headers.forEach((f,m)=>r.setRequestHeader(f,m.join(","))),t.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const f=t.detectContentTypeHeader();null!==f&&r.setRequestHeader("Content-Type",f)}if(t.responseType){const f=t.responseType.toLowerCase();r.responseType="json"!==f?f:"text"}const s=t.serializeBody();let o=null;const a=()=>{if(null!==o)return o;const f=r.statusText||"OK",m=new kl(r.getAllResponseHeaders()),p=function que(i){return"responseURL"in i&&i.responseURL?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):null}(r)||t.url;return o=new cR({headers:m,status:r.status,statusText:f,url:p}),o},l=()=>{let{headers:f,status:m,statusText:p,url:g}=a(),_=null;204!==m&&(_=typeof r.response>"u"?r.responseText:r.response),0===m&&(m=_?200:0);let v=m>=200&&m<300;if("json"===t.responseType&&"string"==typeof _){const b=_;_=_.replace(Wue,"");try{_=""!==_?JSON.parse(_):null}catch(y){_=b,v&&(v=!1,_={error:y,text:_})}}v?(n.next(new qx({body:_,headers:f,status:m,statusText:p,url:g||void 0})),n.complete()):n.error(new mV({error:_,headers:f,status:m,statusText:p,url:g||void 0}))},c=f=>{const{url:m}=a(),p=new mV({error:f,status:r.status||0,statusText:r.statusText||"Unknown Error",url:m||void 0});n.error(p)};let d=!1;const u=f=>{d||(n.next(a()),d=!0);let m={type:sr.DownloadProgress,loaded:f.loaded};f.lengthComputable&&(m.total=f.total),"text"===t.responseType&&r.responseText&&(m.partialText=r.responseText),n.next(m)},h=f=>{let m={type:sr.UploadProgress,loaded:f.loaded};f.lengthComputable&&(m.total=f.total),n.next(m)};return r.addEventListener("load",l),r.addEventListener("error",c),r.addEventListener("timeout",c),r.addEventListener("abort",c),t.reportProgress&&(r.addEventListener("progress",u),null!==s&&r.upload&&r.upload.addEventListener("progress",h)),r.send(s),n.next({type:sr.Sent}),()=>{r.removeEventListener("error",c),r.removeEventListener("abort",c),r.removeEventListener("load",l),r.removeEventListener("timeout",c),t.reportProgress&&(r.removeEventListener("progress",u),null!==s&&r.upload&&r.upload.removeEventListener("progress",h)),r.readyState!==r.DONE&&r.abort()}})}}return i.\u0275fac=function(t){return new(t||i)(ye(a3))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();const uR=new Fe("XSRF_ENABLED"),yV="XSRF-TOKEN",AV=new Fe("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>yV}),xV="X-XSRF-TOKEN",wV=new Fe("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>xV});class CV{}let Xue=(()=>{class i{constructor(t,n,r){this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=QO(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return i.\u0275fac=function(t){return new(t||i)(ye(ii),ye(h_),ye(AV))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();function Yue(i,e){const t=i.url.toLowerCase();if(!Ut(uR)||"GET"===i.method||"HEAD"===i.method||t.startsWith("http://")||t.startsWith("https://"))return e(i);const n=Ut(CV).getToken(),r=Ut(wV);return null!=n&&!i.headers.has(r)&&(i=i.clone({headers:i.headers.set(r,n)})),e(i)}var Zn=(()=>((Zn=Zn||{})[Zn.Interceptors=0]="Interceptors",Zn[Zn.LegacyInterceptors=1]="LegacyInterceptors",Zn[Zn.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",Zn[Zn.NoXsrfProtection=3]="NoXsrfProtection",Zn[Zn.JsonpSupport=4]="JsonpSupport",Zn[Zn.RequestsMadeViaParent=5]="RequestsMadeViaParent",Zn))();function xp(i,e){return{\u0275kind:i,\u0275providers:e}}function Zue(...i){const e=[Xx,vV,_V,{provide:Qx,useExisting:_V},{provide:aR,useExisting:vV},{provide:Z0,useValue:Yue,multi:!0},{provide:uR,useValue:!0},{provide:CV,useClass:Xue}];for(const t of i)e.push(...t.\u0275providers);return function m7(i){return{\u0275providers:i}}(e)}const MV=new Fe("LEGACY_INTERCEPTOR_FN");function $ue({cookieName:i,headerName:e}){const t=[];return void 0!==i&&t.push({provide:AV,useValue:i}),void 0!==e&&t.push({provide:wV,useValue:e}),xp(Zn.CustomXsrfConfiguration,t)}let Jue=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({providers:[Zue(xp(Zn.LegacyInterceptors,[{provide:MV,useFactory:zue},{provide:Z0,useExisting:MV,multi:!0}]),$ue({cookieName:yV,headerName:xV}))]}),i})();const ehe=["*"];let Yx;function K0(i){return function the(){if(void 0===Yx&&(Yx=null,typeof window<"u")){const i=window;void 0!==i.trustedTypes&&(Yx=i.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return Yx}()?.createHTML(i)||i}function EV(i){return Error(`Unable to find icon with the name "${i}"`)}function SV(i){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${i}".`)}function TV(i){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${i}".`)}class wu{constructor(e,t,n){this.url=e,this.svgText=t,this.options=n}}let Zx=(()=>{class i{constructor(t,n,r,s){this._httpClient=t,this._sanitizer=n,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(t,n,r){return this.addSvgIconInNamespace("",t,n,r)}addSvgIconLiteral(t,n,r){return this.addSvgIconLiteralInNamespace("",t,n,r)}addSvgIconInNamespace(t,n,r,s){return this._addSvgIconConfig(t,n,new wu(r,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,n,r,s){const o=this._sanitizer.sanitize(Ri.HTML,r);if(!o)throw TV(r);const a=K0(o);return this._addSvgIconConfig(t,n,new wu("",a,s))}addSvgIconSet(t,n){return this.addSvgIconSetInNamespace("",t,n)}addSvgIconSetLiteral(t,n){return this.addSvgIconSetLiteralInNamespace("",t,n)}addSvgIconSetInNamespace(t,n,r){return this._addSvgIconSetConfig(t,new wu(n,null,r))}addSvgIconSetLiteralInNamespace(t,n,r){const s=this._sanitizer.sanitize(Ri.HTML,n);if(!s)throw TV(n);const o=K0(s);return this._addSvgIconSetConfig(t,new wu("",o,r))}registerFontClassAlias(t,n=t){return this._fontCssClassesByAlias.set(t,n),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const n=this._sanitizer.sanitize(Ri.RESOURCE_URL,t);if(!n)throw SV(t);const r=this._cachedIconsByUrl.get(n);return r?wt(Kx(r)):this._loadSvgIconFromConfig(new wu(t,null)).pipe(nn(s=>this._cachedIconsByUrl.set(n,s)),vt(s=>Kx(s)))}getNamedSvgIcon(t,n=""){const r=IV(n,t);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(n,t),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const o=this._iconSetConfigs.get(n);return o?this._getSvgFromIconSetConfigs(t,o):Zo(EV(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?wt(Kx(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(vt(n=>Kx(n)))}_getSvgFromIconSetConfigs(t,n){const r=this._extractIconWithNameFromAnySet(t,n);return r?wt(r):dV(n.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(Ko(a=>{const c=`Loading icon set URL: ${this._sanitizer.sanitize(Ri.RESOURCE_URL,o.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(c)),wt(null)})))).pipe(vt(()=>{const o=this._extractIconWithNameFromAnySet(t,n);if(!o)throw EV(t);return o}))}_extractIconWithNameFromAnySet(t,n){for(let r=n.length-1;r>=0;r--){const s=n[r];if(s.svgText&&s.svgText.toString().indexOf(t)>-1){const o=this._svgElementFromConfig(s),a=this._extractSvgIconFromSet(o,t,s.options);if(a)return a}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(nn(n=>t.svgText=n),vt(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?wt(null):this._fetchIcon(t).pipe(nn(n=>t.svgText=n))}_extractSvgIconFromSet(t,n,r){const s=t.querySelector(`[id="${n}"]`);if(!s)return null;const o=s.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,r);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),r);const a=this._svgElementFromString(K0("<svg></svg>"));return a.appendChild(o),this._setSvgAttributes(a,r)}_svgElementFromString(t){const n=this._document.createElement("DIV");n.innerHTML=t;const r=n.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const n=this._svgElementFromString(K0("<svg></svg>")),r=t.attributes;for(let s=0;s<r.length;s++){const{name:o,value:a}=r[s];"id"!==o&&n.setAttribute(o,a)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&n.appendChild(t.childNodes[s].cloneNode(!0));return n}_setSvgAttributes(t,n){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),n&&n.viewBox&&t.setAttribute("viewBox",n.viewBox),t}_fetchIcon(t){const{url:n,options:r}=t,s=r?.withCredentials??!1;if(!this._httpClient)throw function ihe(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==n)throw Error(`Cannot fetch icon from URL "${n}".`);const o=this._sanitizer.sanitize(Ri.RESOURCE_URL,n);if(!o)throw SV(n);const a=this._inProgressUrlFetches.get(o);if(a)return a;const l=this._httpClient.get(o,{responseType:"text",withCredentials:s}).pipe(vt(c=>K0(c)),Ly(()=>this._inProgressUrlFetches.delete(o)),dM());return this._inProgressUrlFetches.set(o,l),l}_addSvgIconConfig(t,n,r){return this._svgIconConfigs.set(IV(t,n),r),this}_addSvgIconSetConfig(t,n){const r=this._iconSetConfigs.get(t);return r?r.push(n):this._iconSetConfigs.set(t,[n]),this}_svgElementFromConfig(t){if(!t.svgElement){const n=this._svgElementFromString(t.svgText);this._setSvgAttributes(n,t.options),t.svgElement=n}return t.svgElement}_getIconConfigFromResolvers(t,n){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](n,t);if(s)return rhe(s)?new wu(s.url,null,s.options):new wu(s,null)}}}return i.\u0275fac=function(t){return new(t||i)(ye(Xx,8),ye(Dy),ye(ii,8),ye(cl))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function Kx(i){return i.cloneNode(!0)}function IV(i,e){return i+":"+e}function rhe(i){return!(!i.url||!i.options)}const she=Hx(class{constructor(i){this._elementRef=i}}),ohe=new Fe("MAT_ICON_DEFAULT_OPTIONS"),ahe=new Fe("mat-icon-location",{providedIn:"root",factory:function lhe(){const i=Ut(ii),e=i?i.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),RV=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],che=RV.map(i=>`[${i}]`).join(", "),dhe=/^url\(['"]?#(.*?)['"]?\)$/;let DV=(()=>{class i extends she{get inline(){return this._inline}set inline(t){this._inline=zi(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const n=this._cleanupFontValue(t);n!==this._fontSet&&(this._fontSet=n,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const n=this._cleanupFontValue(t);n!==this._fontIcon&&(this._fontIcon=n,this._updateFontIconClasses())}constructor(t,n,r,s,o,a){super(t),this._iconRegistry=n,this._location=s,this._errorHandler=o,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=cn.EMPTY,a&&(a.color&&(this.color=this.defaultColor=a.color),a.fontSet&&(this.fontSet=a.fontSet)),r||t.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(t){if(!t)return["",""];const n=t.split(":");switch(n.length){case 1:return["",n[0]];case 2:return n;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const n=this._location.getPathname();n!==this._previousPath&&(this._previousPath=n,this._prependPathToReferences(n))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const n=this._location.getPathname();this._previousPath=n,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(n),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let n=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();n--;){const r=t.childNodes[n];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,n=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>t.classList.remove(r)),n.forEach(r=>t.classList.add(r)),this._previousFontSetClass=n,this.fontIcon!==this._previousFontIconClass&&!n.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const n=this._elementsWithExternalReferences;n&&n.forEach((r,s)=>{r.forEach(o=>{s.setAttribute(o.name,`url('${t}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(t){const n=t.querySelectorAll(che),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<n.length;s++)RV.forEach(o=>{const a=n[s],l=a.getAttribute(o),c=l?l.match(dhe):null;if(c){let d=r.get(a);d||(d=[],r.set(a,d)),d.push({name:o,value:c[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[n,r]=this._splitIconName(t);n&&(this._svgNamespace=n),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,n).pipe(ps(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${n}:${r}! ${s.message}`))})}}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(Zx),Lg("aria-hidden"),R(ahe),R(cl),R(ohe,8))},i.\u0275cmp=$({type:i,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(t,n){2&t&&(hn("data-mat-icon-type",n._usingFontIcon()?"font":"svg")("data-mat-icon-name",n._svgName||n.fontIcon)("data-mat-icon-namespace",n._svgNamespace||n.fontSet)("fontIcon",n._usingFontIcon()?n.fontIcon:null),Mi("mat-icon-inline",n.inline)("mat-icon-no-color","primary"!==n.color&&"accent"!==n.color&&"warn"!==n.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[W],ngContentSelectors:ehe,decls:1,vars:0,template:function(t,n){1&t&&(Pn(),ti(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),i})(),hR=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[bn,bn]}),i})();const uhe=["*"],ghe=new Fe("MAT_CARD_CONFIG");let PV=(()=>{class i{constructor(t){this.appearance=t?.appearance||"raised"}}return i.\u0275fac=function(t){return new(t||i)(R(ghe,8))},i.\u0275cmp=$({type:i,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(t,n){2&t&&Mi("mat-mdc-card-outlined","outlined"===n.appearance)("mdc-card--outlined","outlined"===n.appearance)},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:uhe,decls:1,vars:0,template:function(t,n){1&t&&(Pn(),ti(0))},styles:['.mdc-card{display:flex;flex-direction:column;box-sizing:border-box}.mdc-card::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none;pointer-events:none}@media screen and (forced-colors: active){.mdc-card::after{border-color:CanvasText}}.mdc-card--outlined::after{border:none}.mdc-card__content{border-radius:inherit;height:100%}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__media--square::before{margin-top:100%}.mdc-card__media--16-9::before{margin-top:56.25%}.mdc-card__media-content{position:absolute;top:0;right:0;bottom:0;left:0;box-sizing:border-box}.mdc-card__primary-action{display:flex;flex-direction:column;box-sizing:border-box;position:relative;outline:none;color:inherit;text-decoration:none;cursor:pointer;overflow:hidden}.mdc-card__primary-action:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__primary-action:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mdc-card__actions--full-bleed{padding:0}.mdc-card__action-buttons,.mdc-card__action-icons{display:flex;flex-direction:row;align-items:center;box-sizing:border-box}.mdc-card__action-icons{flex-grow:1;justify-content:flex-end}.mdc-card__action-buttons+.mdc-card__action-icons{margin-left:16px;margin-right:0}[dir=rtl] .mdc-card__action-buttons+.mdc-card__action-icons,.mdc-card__action-buttons+.mdc-card__action-icons[dir=rtl]{margin-left:0;margin-right:16px}.mdc-card__action{display:inline-flex;flex-direction:row;align-items:center;box-sizing:border-box;justify-content:center;cursor:pointer;user-select:none}.mdc-card__action:focus{outline:none}.mdc-card__action--button{margin-left:0;margin-right:8px;padding:0 8px}[dir=rtl] .mdc-card__action--button,.mdc-card__action--button[dir=rtl]{margin-left:8px;margin-right:0}.mdc-card__action--button:last-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-card__action--button:last-child,.mdc-card__action--button:last-child[dir=rtl]{margin-left:0;margin-right:0}.mdc-card__actions--full-bleed .mdc-card__action--button{justify-content:space-between;width:100%;height:auto;max-height:none;margin:0;padding:8px 16px;text-align:left}[dir=rtl] .mdc-card__actions--full-bleed .mdc-card__action--button,.mdc-card__actions--full-bleed .mdc-card__action--button[dir=rtl]{text-align:right}.mdc-card__action--icon{margin:-6px 0;padding:12px}.mat-mdc-card{position:relative;border-radius:var(--mdc-elevated-card-container-shape, var(--mdc-shape-medium, 4px));background-color:var(--mdc-elevated-card-container-color, transparent);border-width:0;border-style:solid;border-color:var(--mdc-elevated-card-container-color, transparent)}.mat-mdc-card .mdc-card::after{border-radius:var(--mdc-elevated-card-container-shape, var(--mdc-shape-medium, 4px))}.mat-mdc-card-outlined{border-width:var(--mdc-outlined-card-outline-width, 1px);border-style:solid;border-color:var(--mdc-outlined-card-outline-color, transparent)}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0}),i})(),kV=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=ke({type:i,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"]}),i})(),FV=(()=>{class i{constructor(){this.align="start"}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=ke({type:i,selectors:[["mat-card-actions"]],hostAttrs:[1,"mat-mdc-card-actions","mdc-card__actions"],hostVars:2,hostBindings:function(t,n){2&t&&Mi("mat-mdc-card-actions-align-end","end"===n.align)},inputs:{align:"align"},exportAs:["matCardActions"]}),i})(),BV=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[bn,Ea,bn]}),i})();class fR{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class The extends fR{constructor(e,t,n,r,s){super(),this.component=e,this.viewContainerRef=t,this.injector=n,this.componentFactoryResolver=r,this.projectableNodes=s}}class pR extends fR{constructor(e,t,n,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=n,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class Ihe extends fR{constructor(e){super(),this.element=e instanceof Ht?e.nativeElement:e}}class LV{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof The?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof pR?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof Ihe?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class Rhe extends LV{constructor(e,t,n,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=n,this._defaultInjector=r,this.attachDomPortal=o=>{const a=o.element,l=this._document.createComment("dom-portal");a.parentNode.insertBefore(l,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(a,l)})},this._document=s}attachComponentPortal(e){const n=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(n,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=n.create(e.injector||this._defaultInjector||_s.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,n=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return n.rootNodes.forEach(r=>this.outletElement.appendChild(r)),n.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(n);-1!==r&&t.remove(r)}),this._attachedPortal=e,n}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let Dhe=(()=>{class i extends pR{constructor(t,n){super(t,n)}}return i.\u0275fac=function(t){return new(t||i)(R(bs),R(Qr))},i.\u0275dir=ke({type:i,selectors:[["","cdkPortal",""]],exportAs:["cdkPortal"],features:[W]}),i})(),mR=(()=>{class i extends LV{constructor(t,n,r){super(),this._componentFactoryResolver=t,this._viewContainerRef=n,this._isInitialized=!1,this.attached=new Ct,this.attachDomPortal=s=>{const o=s.element,a=this._document.createComment("dom-portal");s.setAttachedHost(this),o.parentNode.insertBefore(a,o),this._getRootNode().appendChild(o),this._attachedPortal=s,super.setDisposeFn(()=>{a.parentNode&&a.parentNode.replaceChild(o,a)})},this._document=r}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(t){t.setAttachedHost(this);const n=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,s=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),o=n.createComponent(s,n.length,t.injector||n.injector,t.projectableNodes||void 0);return n!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=t,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(t){t.setAttachedHost(this);const n=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=n,this.attached.emit(n),n}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}}return i.\u0275fac=function(t){return new(t||i)(R(Yl),R(Qr),R(ii))},i.\u0275dir=ke({type:i,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[W]}),i})(),OV=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({}),i})();const Phe=["addListener","removeListener"],khe=["addEventListener","removeEventListener"],Fhe=["on","off"];function Mc(i,e,t,n){if(Si(t)&&(n=t,t=void 0),n)return Mc(i,e,t).pipe(dS(n));const[r,s]=function Ohe(i){return Si(i.addEventListener)&&Si(i.removeEventListener)}(i)?khe.map(o=>a=>i[o](e,a,t)):function Bhe(i){return Si(i.addListener)&&Si(i.removeListener)}(i)?Phe.map(NV(i,e)):function Lhe(i){return Si(i.on)&&Si(i.off)}(i)?Fhe.map(NV(i,e)):[];if(!r&&aM(i))return Mr(o=>Mc(o,e,t))(fs(i));if(!r)throw new TypeError("Invalid event target");return new Fi(o=>{const a=(...l)=>o.next(1<l.length?l:l[0]);return r(a),()=>s(a)})}function NV(i,e){return t=>n=>i[t](e,n)}function jV(i=0,e,t=kde){let n=-1;return null!=e&&(Y2(e)?t=e:n=e),new Fi(r=>{let s=function Nhe(i){return i instanceof Date&&!isNaN(i)}(i)?+i-t.now():i;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=n?this.schedule(void 0,n):r.complete())},s)})}class UV{}class jhe{}const Bl="*";function $0(i,e){return{type:7,name:i,definitions:e,options:{}}}function Ec(i,e=null){return{type:4,styles:e,timings:i}}function VV(i,e=null){return{type:2,steps:i,options:e}}function Ds(i){return{type:6,styles:i,offset:null}}function Cu(i,e,t){return{type:0,name:i,styles:e,options:t}}function Ll(i,e,t=null){return{type:1,expr:i,animation:e,options:t}}function zV(i){Promise.resolve().then(i)}class J0{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){zV(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class HV{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,r=0;const s=this.players.length;0==s?zV(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++n==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const r=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(r)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}const eb={schedule(i){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:n}=eb;n&&(e=n.requestAnimationFrame,t=n.cancelAnimationFrame);const r=e(s=>{t=void 0,i(s)});return new cn(()=>t?.(r))},requestAnimationFrame(...i){const{delegate:e}=eb;return(e?.requestAnimationFrame||requestAnimationFrame)(...i)},cancelAnimationFrame(...i){const{delegate:e}=eb;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...i)},delegate:void 0},$x=new class Hhe extends $I{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;e=e||n.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=n[0])&&e.id===t&&n.shift());if(this._active=!1,r){for(;(e=n[0])&&e.id===t&&n.shift();)e.unsubscribe();throw r}}}(class zhe extends KI{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e._scheduled||(e._scheduled=eb.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,n=0){if(null!=n&&n>0||null==n&&this.delay>0)return super.recycleAsyncId(e,t,n);e.actions.some(r=>r.id===t)||(eb.cancelAnimationFrame(t),e._scheduled=void 0)}});let _R,Ghe=1;const Jx={};function GV(i){return i in Jx&&(delete Jx[i],!0)}const Qhe={setImmediate(i){const e=Ghe++;return Jx[e]=!0,_R||(_R=Promise.resolve()),_R.then(()=>GV(e)&&i()),e},clearImmediate(i){GV(i)}},{setImmediate:Whe,clearImmediate:qhe}=Qhe,ew={setImmediate(...i){const{delegate:e}=ew;return(e?.setImmediate||Whe)(...i)},clearImmediate(i){const{delegate:e}=ew;return(e?.clearImmediate||qhe)(i)},delegate:void 0},Zhe=new class Yhe extends $I{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;e=e||n.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=n[0])&&e.id===t&&n.shift());if(this._active=!1,r){for(;(e=n[0])&&e.id===t&&n.shift();)e.unsubscribe();throw r}}}(class Xhe extends KI{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e._scheduled||(e._scheduled=ew.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,n=0){if(null!=n&&n>0||null==n&&this.delay>0)return super.recycleAsyncId(e,t,n);e.actions.some(r=>r.id===t)||(ew.clearImmediate(t),e._scheduled=void 0)}});function bR(i,e=JI){return function Khe(i){return xn((e,t)=>{let n=!1,r=null,s=null,o=!1;const a=()=>{if(s?.unsubscribe(),s=null,n){n=!1;const c=r;r=null,t.next(c)}o&&t.complete()},l=()=>{s=null,o&&t.complete()};e.subscribe(dn(t,c=>{n=!0,r=c,s||fs(i(c)).subscribe(s=dn(t,a,l))},()=>{o=!0,(!n||!s||s.closed)&&t.complete()}))})}(()=>jV(i,e))}const $he=["contentWrapper"],Jhe=["*"],efe=new Fe("VIRTUAL_SCROLL_STRATEGY");let wp=(()=>{class i{constructor(t,n,r){this._ngZone=t,this._platform=n,this._scrolled=new Wt,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const n=this.scrollContainers.get(t);n&&(n.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new Fi(n=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(bR(t)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):wt()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(t,n){const r=this.getAncestorScrollContainers(t);return this.scrolled(n).pipe(Bn(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const n=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&n.push(s)}),n}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,n){let r=xu(n),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Mc(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return i.\u0275fac=function(t){return new(t||i)(ye(at),ye(Hn),ye(ii,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Mu=(()=>{class i{constructor(t,n,r,s){this.elementRef=t,this.scrollDispatcher=n,this.ngZone=r,this.dir=s,this._destroyed=new Wt,this._elementScrolled=new Fi(o=>this.ngZone.runOutsideAngular(()=>Mc(this.elementRef.nativeElement,"scroll").pipe(_n(this._destroyed)).subscribe(o)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const n=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=r?t.end:t.start),null==t.right&&(t.right=r?t.start:t.end),null!=t.bottom&&(t.top=n.scrollHeight-n.clientHeight-t.bottom),r&&0!=H0()?(null!=t.left&&(t.right=n.scrollWidth-n.clientWidth-t.left),2==H0()?t.left=t.right:1==H0()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=n.scrollWidth-n.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const n=this.elementRef.nativeElement;P5()?n.scrollTo(t):(null!=t.top&&(n.scrollTop=t.top),null!=t.left&&(n.scrollLeft=t.left))}measureScrollOffset(t){const n="left",r="right",s=this.elementRef.nativeElement;if("top"==t)return s.scrollTop;if("bottom"==t)return s.scrollHeight-s.clientHeight-s.scrollTop;const o=this.dir&&"rtl"==this.dir.value;return"start"==t?t=o?r:n:"end"==t&&(t=o?n:r),o&&2==H0()?t==n?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:o&&1==H0()?t==n?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:t==n?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(wp),R(at),R(za,8))},i.\u0275dir=ke({type:i,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0}),i})(),Eu=(()=>{class i{constructor(t,n,r){this._platform=t,this._change=new Wt,this._changeListener=s=>{this._change.next(s)},this._document=r,n.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:n,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+n,height:r,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,n=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||n.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||n.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(bR(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return i.\u0275fac=function(t){return new(t||i)(ye(Hn),ye(at),ye(ii,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const QV=new Fe("VIRTUAL_SCROLLABLE");let nfe=(()=>{class i extends Mu{constructor(t,n,r,s){super(t,n,r,s)}measureViewportSize(t){const n=this.elementRef.nativeElement;return"horizontal"===t?n.clientWidth:n.clientHeight}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(wp),R(at),R(za,8))},i.\u0275dir=ke({type:i,features:[W]}),i})();const sfe=typeof requestAnimationFrame<"u"?$x:Zhe;let ofe=(()=>{class i extends nfe{get orientation(){return this._orientation}set orientation(t){this._orientation!==t&&(this._orientation=t,this._calculateSpacerSize())}get appendOnly(){return this._appendOnly}set appendOnly(t){this._appendOnly=zi(t)}constructor(t,n,r,s,o,a,l,c){super(t,a,r,o),this.elementRef=t,this._changeDetectorRef=n,this._scrollStrategy=s,this.scrollable=c,this._platform=Ut(Hn),this._detachedSubject=new Wt,this._renderedRangeSubject=new Wt,this._orientation="vertical",this._appendOnly=!1,this.scrolledIndexChange=new Fi(d=>this._scrollStrategy.scrolledIndexChange.subscribe(u=>Promise.resolve().then(()=>this.ngZone.run(()=>d.next(u))))),this.renderedRangeStream=this._renderedRangeSubject,this._totalContentSize=0,this._totalContentWidth="",this._totalContentHeight="",this._renderedRange={start:0,end:0},this._dataLength=0,this._viewportSize=0,this._renderedContentOffset=0,this._renderedContentOffsetNeedsRewrite=!1,this._isChangeDetectionPending=!1,this._runAfterChangeDetection=[],this._viewportChanges=cn.EMPTY,this._viewportChanges=l.change().subscribe(()=>{this.checkViewportSize()}),this.scrollable||(this.elementRef.nativeElement.classList.add("cdk-virtual-scrollable"),this.scrollable=this)}ngOnInit(){this._platform.isBrowser&&(this.scrollable===this&&super.ngOnInit(),this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._measureViewportSize(),this._scrollStrategy.attach(this),this.scrollable.elementScrolled().pipe(ec(null),bR(0,sfe)).subscribe(()=>this._scrollStrategy.onContentScrolled()),this._markChangeDetectionNeeded()})))}ngOnDestroy(){this.detach(),this._scrollStrategy.detach(),this._renderedRangeSubject.complete(),this._detachedSubject.complete(),this._viewportChanges.unsubscribe(),super.ngOnDestroy()}attach(t){this.ngZone.runOutsideAngular(()=>{this._forOf=t,this._forOf.dataStream.pipe(_n(this._detachedSubject)).subscribe(n=>{const r=n.length;r!==this._dataLength&&(this._dataLength=r,this._scrollStrategy.onDataLengthChanged()),this._doChangeDetection()})})}detach(){this._forOf=null,this._detachedSubject.next()}getDataLength(){return this._dataLength}getViewportSize(){return this._viewportSize}getRenderedRange(){return this._renderedRange}measureBoundingClientRectWithScrollOffset(t){return this.getElementRef().nativeElement.getBoundingClientRect()[t]}setTotalContentSize(t){this._totalContentSize!==t&&(this._totalContentSize=t,this._calculateSpacerSize(),this._markChangeDetectionNeeded())}setRenderedRange(t){(function rfe(i,e){return i.start==e.start&&i.end==e.end})(this._renderedRange,t)||(this.appendOnly&&(t={start:0,end:Math.max(this._renderedRange.end,t.end)}),this._renderedRangeSubject.next(this._renderedRange=t),this._markChangeDetectionNeeded(()=>this._scrollStrategy.onContentRendered()))}getOffsetToRenderedContentStart(){return this._renderedContentOffsetNeedsRewrite?null:this._renderedContentOffset}setRenderedContentOffset(t,n="to-start"){t=this.appendOnly&&"to-start"===n?0:t;const s="horizontal"==this.orientation,o=s?"X":"Y";let l=`translate${o}(${Number((s&&this.dir&&"rtl"==this.dir.value?-1:1)*t)}px)`;this._renderedContentOffset=t,"to-end"===n&&(l+=` translate${o}(-100%)`,this._renderedContentOffsetNeedsRewrite=!0),this._renderedContentTransform!=l&&(this._renderedContentTransform=l,this._markChangeDetectionNeeded(()=>{this._renderedContentOffsetNeedsRewrite?(this._renderedContentOffset-=this.measureRenderedContentSize(),this._renderedContentOffsetNeedsRewrite=!1,this.setRenderedContentOffset(this._renderedContentOffset)):this._scrollStrategy.onRenderedOffsetChanged()}))}scrollToOffset(t,n="auto"){const r={behavior:n};"horizontal"===this.orientation?r.start=t:r.top=t,this.scrollable.scrollTo(r)}scrollToIndex(t,n="auto"){this._scrollStrategy.scrollToIndex(t,n)}measureScrollOffset(t){let n;return n=this.scrollable==this?r=>super.measureScrollOffset(r):r=>this.scrollable.measureScrollOffset(r),Math.max(0,n(t??("horizontal"===this.orientation?"start":"top"))-this.measureViewportOffset())}measureViewportOffset(t){let n;const r="left",s="right",o="rtl"==this.dir?.value;n="start"==t?o?s:r:"end"==t?o?r:s:t||("horizontal"===this.orientation?"left":"top");const a=this.scrollable.measureBoundingClientRectWithScrollOffset(n);return this.elementRef.nativeElement.getBoundingClientRect()[n]-a}measureRenderedContentSize(){const t=this._contentWrapper.nativeElement;return"horizontal"===this.orientation?t.offsetWidth:t.offsetHeight}measureRangeSize(t){return this._forOf?this._forOf.measureRangeSize(t,this.orientation):0}checkViewportSize(){this._measureViewportSize(),this._scrollStrategy.onDataLengthChanged()}_measureViewportSize(){this._viewportSize=this.scrollable.measureViewportSize(this.orientation)}_markChangeDetectionNeeded(t){t&&this._runAfterChangeDetection.push(t),this._isChangeDetectionPending||(this._isChangeDetectionPending=!0,this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._doChangeDetection()})))}_doChangeDetection(){this._isChangeDetectionPending=!1,this._contentWrapper.nativeElement.style.transform=this._renderedContentTransform,this.ngZone.run(()=>this._changeDetectorRef.markForCheck());const t=this._runAfterChangeDetection;this._runAfterChangeDetection=[];for(const n of t)n()}_calculateSpacerSize(){this._totalContentHeight="horizontal"===this.orientation?"":`${this._totalContentSize}px`,this._totalContentWidth="horizontal"===this.orientation?`${this._totalContentSize}px`:""}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(er),R(at),R(efe,8),R(za,8),R(wp),R(Eu),R(QV,8))},i.\u0275cmp=$({type:i,selectors:[["cdk-virtual-scroll-viewport"]],viewQuery:function(t,n){if(1&t&&Di($he,7),2&t){let r;Pt(r=kt())&&(n._contentWrapper=r.first)}},hostAttrs:[1,"cdk-virtual-scroll-viewport"],hostVars:4,hostBindings:function(t,n){2&t&&Mi("cdk-virtual-scroll-orientation-horizontal","horizontal"===n.orientation)("cdk-virtual-scroll-orientation-vertical","horizontal"!==n.orientation)},inputs:{orientation:"orientation",appendOnly:"appendOnly"},outputs:{scrolledIndexChange:"scrolledIndexChange"},standalone:!0,features:[se([{provide:Mu,useFactory:(e,t)=>e||t,deps:[[new ol,new Ev(QV)],i]}]),W,uE],ngContentSelectors:Jhe,decls:4,vars:4,consts:[[1,"cdk-virtual-scroll-content-wrapper"],["contentWrapper",""],[1,"cdk-virtual-scroll-spacer"]],template:function(t,n){1&t&&(Pn(),ve(0,"div",0,1),ti(2),Ie(),ze(3,"div",2)),2&t&&(oe(3),Hh("width",n._totalContentWidth)("height",n._totalContentHeight))},styles:["cdk-virtual-scroll-viewport{display:block;position:relative;transform:translateZ(0)}.cdk-virtual-scrollable{overflow:auto;will-change:scroll-position;contain:strict;-webkit-overflow-scrolling:touch}.cdk-virtual-scroll-content-wrapper{position:absolute;top:0;left:0;contain:content}[dir=rtl] .cdk-virtual-scroll-content-wrapper{right:0;left:auto}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper{min-height:100%}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-left:0;padding-right:0;margin-left:0;margin-right:0;border-left-width:0;border-right-width:0;outline:none}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:100%}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;border-top-width:0;border-bottom-width:0;outline:none}.cdk-virtual-scroll-spacer{height:1px;transform-origin:0 0;flex:0 0 auto}[dir=rtl] .cdk-virtual-scroll-spacer{transform-origin:100% 0}"],encapsulation:2,changeDetection:0}),i})(),tb=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({}),i})(),WV=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[Q0,tb,ofe,Q0,tb]}),i})();function afe(i,e){}const lfe=function(i){return{animationDuration:i}},cfe=function(i,e){return{value:i,params:e}};function dfe(i,e){1&i&&ti(0)}const qV=["*"],ufe=["tabListContainer"],hfe=["tabList"],ffe=["tabListInner"],pfe=["nextPaginator"],mfe=["previousPaginator"],gfe=["tabBodyWrapper"],_fe=["tabHeader"];function bfe(i,e){}function vfe(i,e){1&i&&Vt(0,bfe,0,0,"ng-template",14),2&i&&K("cdkPortalOutlet",bi().$implicit.templateLabel)}function yfe(i,e){1&i&&qi(0),2&i&&$v(bi().$implicit.textLabel)}function Afe(i,e){if(1&i){const t=Gs();ve(0,"div",6,7),mt("click",function(){const r=cr(t),s=r.$implicit,o=r.index,a=bi(),l=qt(1);return dr(a._handleClick(s,l,o))})("cdkFocusChange",function(r){const o=cr(t).index;return dr(bi()._tabFocusChanged(r,o))}),ze(2,"span",8)(3,"div",9),ve(4,"span",10)(5,"span",11),Vt(6,vfe,1,1,"ng-template",12),Vt(7,yfe,1,1,"ng-template",null,13,Td),Ie()()()}if(2&i){const t=e.$implicit,n=e.index,r=qt(1),s=qt(8),o=bi();Mi("mdc-tab--active",o.selectedIndex===n),K("id",o._getTabLabelId(n))("ngClass",t.labelClass)("disabled",t.disabled)("fitInkBarToContent",o.fitInkBarToContent),hn("tabIndex",o._getTabIndex(n))("aria-posinset",n+1)("aria-setsize",o._tabs.length)("aria-controls",o._getTabContentId(n))("aria-selected",o.selectedIndex===n)("aria-label",t.ariaLabel||null)("aria-labelledby",!t.ariaLabel&&t.ariaLabelledby?t.ariaLabelledby:null),oe(3),K("matRippleTrigger",r)("matRippleDisabled",t.disabled||o.disableRipple),oe(3),K("ngIf",t.templateLabel)("ngIfElse",s)}}function xfe(i,e){if(1&i){const t=Gs();ve(0,"mat-tab-body",15),mt("_onCentered",function(){return cr(t),dr(bi()._removeTabBodyWrapperHeight())})("_onCentering",function(r){return cr(t),dr(bi()._setTabBodyWrapperHeight(r))}),Ie()}if(2&i){const t=e.$implicit,n=e.index,r=bi();Mi("mat-mdc-tab-body-active",r.selectedIndex===n),K("id",r._getTabContentId(n))("ngClass",t.bodyClass)("content",t.content)("position",t.position)("origin",t.origin)("animationDuration",r.animationDuration)("preserveContent",r.preserveContent),hn("tabindex",null!=r.contentTabIndex&&r.selectedIndex===n?r.contentTabIndex:null)("aria-labelledby",r._getTabLabelId(n))}}const wfe={translateTab:$0("translateTab",[Cu("center, void, left-origin-center, right-origin-center",Ds({transform:"none"})),Cu("left",Ds({transform:"translate3d(-100%, 0, 0)",minHeight:"1px",visibility:"hidden"})),Cu("right",Ds({transform:"translate3d(100%, 0, 0)",minHeight:"1px",visibility:"hidden"})),Ll("* => left, * => right, left => center, right => center",Ec("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")),Ll("void => left-origin-center",[Ds({transform:"translate3d(-100%, 0, 0)",visibility:"hidden"}),Ec("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")]),Ll("void => right-origin-center",[Ds({transform:"translate3d(100%, 0, 0)",visibility:"hidden"}),Ec("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")])])};let Cfe=(()=>{class i extends mR{constructor(t,n,r,s){super(t,n,s),this._host=r,this._centeringSub=cn.EMPTY,this._leavingSub=cn.EMPTY}ngOnInit(){super.ngOnInit(),this._centeringSub=this._host._beforeCentering.pipe(ec(this._host._isCenterPosition(this._host._position))).subscribe(t=>{t&&!this.hasAttached()&&this.attach(this._host._content)}),this._leavingSub=this._host._afterLeavingCenter.subscribe(()=>{this._host.preserveContent||this.detach()})}ngOnDestroy(){super.ngOnDestroy(),this._centeringSub.unsubscribe(),this._leavingSub.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(R(Yl),R(Qr),R(le(()=>XV)),R(ii))},i.\u0275dir=ke({type:i,selectors:[["","matTabBodyHost",""]],features:[W]}),i})(),Mfe=(()=>{class i{set position(t){this._positionIndex=t,this._computePositionAnimationState()}constructor(t,n,r){this._elementRef=t,this._dir=n,this._dirChangeSubscription=cn.EMPTY,this._translateTabComplete=new Wt,this._onCentering=new Ct,this._beforeCentering=new Ct,this._afterLeavingCenter=new Ct,this._onCentered=new Ct(!0),this.animationDuration="500ms",this.preserveContent=!1,n&&(this._dirChangeSubscription=n.change.subscribe(s=>{this._computePositionAnimationState(s),r.markForCheck()})),this._translateTabComplete.pipe(tR((s,o)=>s.fromState===o.fromState&&s.toState===o.toState)).subscribe(s=>{this._isCenterPosition(s.toState)&&this._isCenterPosition(this._position)&&this._onCentered.emit(),this._isCenterPosition(s.fromState)&&!this._isCenterPosition(this._position)&&this._afterLeavingCenter.emit()})}ngOnInit(){"center"==this._position&&null!=this.origin&&(this._position=this._computePositionFromOrigin(this.origin))}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._translateTabComplete.complete()}_onTranslateTabStarted(t){const n=this._isCenterPosition(t.toState);this._beforeCentering.emit(n),n&&this._onCentering.emit(this._elementRef.nativeElement.clientHeight)}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_isCenterPosition(t){return"center"==t||"left-origin-center"==t||"right-origin-center"==t}_computePositionAnimationState(t=this._getLayoutDirection()){this._position=this._positionIndex<0?"ltr"==t?"left":"right":this._positionIndex>0?"ltr"==t?"right":"left":"center"}_computePositionFromOrigin(t){const n=this._getLayoutDirection();return"ltr"==n&&t<=0||"rtl"==n&&t>0?"left-origin-center":"right-origin-center"}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(za,8),R(er))},i.\u0275dir=ke({type:i,inputs:{_content:["content","_content"],origin:"origin",animationDuration:"animationDuration",preserveContent:"preserveContent",position:"position"},outputs:{_onCentering:"_onCentering",_beforeCentering:"_beforeCentering",_afterLeavingCenter:"_afterLeavingCenter",_onCentered:"_onCentered"}}),i})(),XV=(()=>{class i extends Mfe{constructor(t,n,r){super(t,n,r)}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(za,8),R(er))},i.\u0275cmp=$({type:i,selectors:[["mat-tab-body"]],viewQuery:function(t,n){if(1&t&&Di(mR,5),2&t){let r;Pt(r=kt())&&(n._portalHost=r.first)}},hostAttrs:[1,"mat-mdc-tab-body"],features:[W],decls:3,vars:6,consts:[["cdkScrollable","",1,"mat-mdc-tab-body-content"],["content",""],["matTabBodyHost",""]],template:function(t,n){1&t&&(ve(0,"div",0,1),mt("@translateTab.start",function(s){return n._onTranslateTabStarted(s)})("@translateTab.done",function(s){return n._translateTabComplete.next(s)}),Vt(2,afe,0,0,"ng-template",2),Ie()),2&t&&K("@translateTab",wa(3,cfe,n._position,ui(1,lfe,n.animationDuration)))},dependencies:[Cfe],styles:['.mat-mdc-tab-body{top:0;left:0;right:0;bottom:0;position:absolute;display:block;overflow:hidden;outline:0;flex-basis:100%}.mat-mdc-tab-body.mat-mdc-tab-body-active{position:relative;overflow-x:hidden;overflow-y:auto;z-index:1;flex-grow:1}.mat-mdc-tab-group.mat-mdc-tab-group-dynamic-height .mat-mdc-tab-body.mat-mdc-tab-body-active{overflow-y:hidden}.mat-mdc-tab-body-content{height:100%;overflow:auto}.mat-mdc-tab-group-dynamic-height .mat-mdc-tab-body-content{overflow:hidden}.mat-mdc-tab-body-content[style*="visibility: hidden"]{display:none}'],encapsulation:2,data:{animation:[wfe.translateTab]}}),i})();const Efe=new Fe("MatTabContent");let Sfe=(()=>{class i{constructor(t){this.template=t}}return i.\u0275fac=function(t){return new(t||i)(R(bs))},i.\u0275dir=ke({type:i,selectors:[["","matTabContent",""]],features:[se([{provide:Efe,useExisting:i}])]}),i})();const Tfe=new Fe("MatTabLabel"),YV=new Fe("MAT_TAB");let Ife=(()=>{class i extends Dhe{constructor(t,n,r){super(t,n),this._closestTab=r}}return i.\u0275fac=function(t){return new(t||i)(R(bs),R(Qr),R(YV,8))},i.\u0275dir=ke({type:i,selectors:[["","mat-tab-label",""],["","matTabLabel",""]],features:[se([{provide:Tfe,useExisting:i}]),W]}),i})();const vR="mdc-tab-indicator--active",ZV="mdc-tab-indicator--no-transition";class Rfe{constructor(e){this._items=e}hide(){this._items.forEach(e=>e.deactivateInkBar())}alignToElement(e){const t=this._items.find(r=>r.elementRef.nativeElement===e),n=this._currentItem;if(n?.deactivateInkBar(),t){const r=n?.elementRef.nativeElement.getBoundingClientRect?.();t.activateInkBar(r),this._currentItem=t}}}function Dfe(i){return class extends i{constructor(...e){super(...e),this._fitToContent=!1}get fitInkBarToContent(){return this._fitToContent}set fitInkBarToContent(e){const t=zi(e);this._fitToContent!==t&&(this._fitToContent=t,this._inkBarElement&&this._appendInkBarElement())}activateInkBar(e){const t=this.elementRef.nativeElement;if(!e||!t.getBoundingClientRect||!this._inkBarContentElement)return void t.classList.add(vR);const n=t.getBoundingClientRect(),r=e.width/n.width,s=e.left-n.left;t.classList.add(ZV),this._inkBarContentElement.style.setProperty("transform",`translateX(${s}px) scaleX(${r})`),t.getBoundingClientRect(),t.classList.remove(ZV),t.classList.add(vR),this._inkBarContentElement.style.setProperty("transform","")}deactivateInkBar(){this.elementRef.nativeElement.classList.remove(vR)}ngOnInit(){this._createInkBarElement()}ngOnDestroy(){this._inkBarElement?.remove(),this._inkBarElement=this._inkBarContentElement=null}_createInkBarElement(){const e=this.elementRef.nativeElement.ownerDocument||document;this._inkBarElement=e.createElement("span"),this._inkBarContentElement=e.createElement("span"),this._inkBarElement.className="mdc-tab-indicator",this._inkBarContentElement.className="mdc-tab-indicator__content mdc-tab-indicator__content--underline",this._inkBarElement.appendChild(this._inkBarContentElement),this._appendInkBarElement()}_appendInkBarElement(){(this._fitToContent?this.elementRef.nativeElement.querySelector(".mdc-tab__content"):this.elementRef.nativeElement).appendChild(this._inkBarElement)}}}const kfe=sR(class{}),Ffe=Dfe((()=>{class i extends kfe{constructor(t){super(),this.elementRef=t}focus(){this.elementRef.nativeElement.focus()}getOffsetLeft(){return this.elementRef.nativeElement.offsetLeft}getOffsetWidth(){return this.elementRef.nativeElement.offsetWidth}}return i.\u0275fac=function(t){return new(t||i)(R(Ht))},i.\u0275dir=ke({type:i,features:[W]}),i})());let KV=(()=>{class i extends Ffe{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=ce(i)))(n||i)}}(),i.\u0275dir=ke({type:i,selectors:[["","matTabLabelWrapper",""]],hostVars:3,hostBindings:function(t,n){2&t&&(hn("aria-disabled",!!n.disabled),Mi("mat-mdc-tab-disabled",n.disabled))},inputs:{disabled:"disabled",fitInkBarToContent:"fitInkBarToContent"},features:[W]}),i})();const Bfe=sR(class{}),$V=new Fe("MAT_TAB_GROUP");let Lfe=(()=>{class i extends Bfe{get content(){return this._contentPortal}constructor(t,n){super(),this._viewContainerRef=t,this._closestTabGroup=n,this.textLabel="",this._contentPortal=null,this._stateChanges=new Wt,this.position=null,this.origin=null,this.isActive=!1}ngOnChanges(t){(t.hasOwnProperty("textLabel")||t.hasOwnProperty("disabled"))&&this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}ngOnInit(){this._contentPortal=new pR(this._explicitContent||this._implicitContent,this._viewContainerRef)}_setTemplateLabelInput(t){t&&t._closestTab===this&&(this._templateLabel=t)}}return i.\u0275fac=function(t){return new(t||i)(R(Qr),R($V,8))},i.\u0275dir=ke({type:i,viewQuery:function(t,n){if(1&t&&Di(bs,7),2&t){let r;Pt(r=kt())&&(n._implicitContent=r.first)}},inputs:{textLabel:["label","textLabel"],ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],labelClass:"labelClass",bodyClass:"bodyClass"},features:[W,Pr]}),i})(),JV=(()=>{class i extends Lfe{get templateLabel(){return this._templateLabel}set templateLabel(t){this._setTemplateLabelInput(t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=ce(i)))(n||i)}}(),i.\u0275cmp=$({type:i,selectors:[["mat-tab"]],contentQueries:function(t,n,r){if(1&t&&(Fn(r,Sfe,7,bs),Fn(r,Ife,5)),2&t){let s;Pt(s=kt())&&(n._explicitContent=s.first),Pt(s=kt())&&(n.templateLabel=s.first)}},inputs:{disabled:"disabled"},exportAs:["matTab"],features:[se([{provide:YV,useExisting:i}]),W],ngContentSelectors:qV,decls:1,vars:0,template:function(t,n){1&t&&(Pn(),Vt(0,dfe,1,0,"ng-template"))},encapsulation:2}),i})();const ez=z0({passive:!0});let jfe=(()=>{class i{get disablePagination(){return this._disablePagination}set disablePagination(t){this._disablePagination=zi(t)}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){t=us(t),this._selectedIndex!=t&&(this._selectedIndexChanged=!0,this._selectedIndex=t,this._keyManager&&this._keyManager.updateActiveItem(t))}constructor(t,n,r,s,o,a,l){this._elementRef=t,this._changeDetectorRef=n,this._viewportRuler=r,this._dir=s,this._ngZone=o,this._platform=a,this._animationMode=l,this._scrollDistance=0,this._selectedIndexChanged=!1,this._destroyed=new Wt,this._showPaginationControls=!1,this._disableScrollAfter=!0,this._disableScrollBefore=!0,this._stopScrolling=new Wt,this._disablePagination=!1,this._selectedIndex=0,this.selectFocusedIndex=new Ct,this.indexFocused=new Ct,o.runOutsideAngular(()=>{Mc(t.nativeElement,"mouseleave").pipe(_n(this._destroyed)).subscribe(()=>{this._stopInterval()})})}ngAfterViewInit(){Mc(this._previousPaginator.nativeElement,"touchstart",ez).pipe(_n(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("before")}),Mc(this._nextPaginator.nativeElement,"touchstart",ez).pipe(_n(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("after")})}ngAfterContentInit(){const t=this._dir?this._dir.change:wt("ltr"),n=this._viewportRuler.change(150),r=()=>{this.updatePagination(),this._alignInkBarToSelectedTab()};this._keyManager=new z5(this._items).withHorizontalOrientation(this._getLayoutDirection()).withHomeAndEnd().withWrap().skipPredicate(()=>!1),this._keyManager.updateActiveItem(this._selectedIndex),this._ngZone.onStable.pipe(ps(1)).subscribe(r),ud(t,n,this._items.changes,this._itemsResized()).pipe(_n(this._destroyed)).subscribe(()=>{this._ngZone.run(()=>{Promise.resolve().then(()=>{this._scrollDistance=Math.max(0,Math.min(this._getMaxScrollDistance(),this._scrollDistance)),r()})}),this._keyManager.withHorizontalOrientation(this._getLayoutDirection())}),this._keyManager.change.subscribe(s=>{this.indexFocused.emit(s),this._setTabFocus(s)})}_itemsResized(){return"function"!=typeof ResizeObserver?jr:this._items.changes.pipe(ec(this._items),Ws(t=>new Fi(n=>this._ngZone.runOutsideAngular(()=>{const r=new ResizeObserver(s=>n.next(s));return t.forEach(s=>r.observe(s.elementRef.nativeElement)),()=>{r.disconnect()}}))),eR(1),Bn(t=>t.some(n=>n.contentRect.width>0&&n.contentRect.height>0)))}ngAfterContentChecked(){this._tabLabelCount!=this._items.length&&(this.updatePagination(),this._tabLabelCount=this._items.length,this._changeDetectorRef.markForCheck()),this._selectedIndexChanged&&(this._scrollToLabel(this._selectedIndex),this._checkScrollingControls(),this._alignInkBarToSelectedTab(),this._selectedIndexChanged=!1,this._changeDetectorRef.markForCheck()),this._scrollDistanceChanged&&(this._updateTabScrollPosition(),this._scrollDistanceChanged=!1,this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._keyManager?.destroy(),this._destroyed.next(),this._destroyed.complete(),this._stopScrolling.complete()}_handleKeydown(t){if(!Ox(t))switch(t.keyCode){case 13:case 32:if(this.focusIndex!==this.selectedIndex){const n=this._items.get(this.focusIndex);n&&!n.disabled&&(this.selectFocusedIndex.emit(this.focusIndex),this._itemSelected(t))}break;default:this._keyManager.onKeydown(t)}}_onContentChanges(){const t=this._elementRef.nativeElement.textContent;t!==this._currentTextContent&&(this._currentTextContent=t||"",this._ngZone.run(()=>{this.updatePagination(),this._alignInkBarToSelectedTab(),this._changeDetectorRef.markForCheck()}))}updatePagination(){this._checkPaginationEnabled(),this._checkScrollingControls(),this._updateTabScrollPosition()}get focusIndex(){return this._keyManager?this._keyManager.activeItemIndex:0}set focusIndex(t){!this._isValidIndex(t)||this.focusIndex===t||!this._keyManager||this._keyManager.setActiveItem(t)}_isValidIndex(t){return!this._items||!!this._items.toArray()[t]}_setTabFocus(t){if(this._showPaginationControls&&this._scrollToLabel(t),this._items&&this._items.length){this._items.toArray()[t].focus();const n=this._tabListContainer.nativeElement;n.scrollLeft="ltr"==this._getLayoutDirection()?0:n.scrollWidth-n.offsetWidth}}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_updateTabScrollPosition(){if(this.disablePagination)return;const t=this.scrollDistance,n="ltr"===this._getLayoutDirection()?-t:t;this._tabList.nativeElement.style.transform=`translateX(${Math.round(n)}px)`,(this._platform.TRIDENT||this._platform.EDGE)&&(this._tabListContainer.nativeElement.scrollLeft=0)}get scrollDistance(){return this._scrollDistance}set scrollDistance(t){this._scrollTo(t)}_scrollHeader(t){return this._scrollTo(this._scrollDistance+("before"==t?-1:1)*this._tabListContainer.nativeElement.offsetWidth/3)}_handlePaginatorClick(t){this._stopInterval(),this._scrollHeader(t)}_scrollToLabel(t){if(this.disablePagination)return;const n=this._items?this._items.toArray()[t]:null;if(!n)return;const r=this._tabListContainer.nativeElement.offsetWidth,{offsetLeft:s,offsetWidth:o}=n.elementRef.nativeElement;let a,l;"ltr"==this._getLayoutDirection()?(a=s,l=a+o):(l=this._tabListInner.nativeElement.offsetWidth-s,a=l-o);const c=this.scrollDistance,d=this.scrollDistance+r;a<c?this.scrollDistance-=c-a+60:l>d&&(this.scrollDistance+=l-d+60)}_checkPaginationEnabled(){if(this.disablePagination)this._showPaginationControls=!1;else{const t=this._tabListInner.nativeElement.scrollWidth>this._elementRef.nativeElement.offsetWidth;t||(this.scrollDistance=0),t!==this._showPaginationControls&&this._changeDetectorRef.markForCheck(),this._showPaginationControls=t}}_checkScrollingControls(){this.disablePagination?this._disableScrollAfter=this._disableScrollBefore=!0:(this._disableScrollBefore=0==this.scrollDistance,this._disableScrollAfter=this.scrollDistance==this._getMaxScrollDistance(),this._changeDetectorRef.markForCheck())}_getMaxScrollDistance(){return this._tabListInner.nativeElement.scrollWidth-this._tabListContainer.nativeElement.offsetWidth||0}_alignInkBarToSelectedTab(){const t=this._items&&this._items.length?this._items.toArray()[this.selectedIndex]:null,n=t?t.elementRef.nativeElement:null;n?this._inkBar.alignToElement(n):this._inkBar.hide()}_stopInterval(){this._stopScrolling.next()}_handlePaginatorPress(t,n){n&&null!=n.button&&0!==n.button||(this._stopInterval(),jV(650,100).pipe(_n(ud(this._stopScrolling,this._destroyed))).subscribe(()=>{const{maxScrollDistance:r,distance:s}=this._scrollHeader(t);(0===s||s>=r)&&this._stopInterval()}))}_scrollTo(t){if(this.disablePagination)return{maxScrollDistance:0,distance:0};const n=this._getMaxScrollDistance();return this._scrollDistance=Math.max(0,Math.min(n,t)),this._scrollDistanceChanged=!0,this._checkScrollingControls(),{maxScrollDistance:n,distance:this._scrollDistance}}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(er),R(Eu),R(za,8),R(at),R(Hn),R(rs,8))},i.\u0275dir=ke({type:i,inputs:{disablePagination:"disablePagination"}}),i})(),Ufe=(()=>{class i extends jfe{get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=zi(t)}constructor(t,n,r,s,o,a,l){super(t,n,r,s,o,a,l),this._disableRipple=!1}_itemSelected(t){t.preventDefault()}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(er),R(Eu),R(za,8),R(at),R(Hn),R(rs,8))},i.\u0275dir=ke({type:i,inputs:{disableRipple:"disableRipple"},features:[W]}),i})(),Vfe=(()=>{class i extends Ufe{constructor(t,n,r,s,o,a,l){super(t,n,r,s,o,a,l)}ngAfterContentInit(){this._inkBar=new Rfe(this._items),super.ngAfterContentInit()}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(er),R(Eu),R(za,8),R(at),R(Hn),R(rs,8))},i.\u0275cmp=$({type:i,selectors:[["mat-tab-header"]],contentQueries:function(t,n,r){if(1&t&&Fn(r,KV,4),2&t){let s;Pt(s=kt())&&(n._items=s)}},viewQuery:function(t,n){if(1&t&&(Di(ufe,7),Di(hfe,7),Di(ffe,7),Di(pfe,5),Di(mfe,5)),2&t){let r;Pt(r=kt())&&(n._tabListContainer=r.first),Pt(r=kt())&&(n._tabList=r.first),Pt(r=kt())&&(n._tabListInner=r.first),Pt(r=kt())&&(n._nextPaginator=r.first),Pt(r=kt())&&(n._previousPaginator=r.first)}},hostAttrs:[1,"mat-mdc-tab-header"],hostVars:4,hostBindings:function(t,n){2&t&&Mi("mat-mdc-tab-header-pagination-controls-enabled",n._showPaginationControls)("mat-mdc-tab-header-rtl","rtl"==n._getLayoutDirection())},inputs:{selectedIndex:"selectedIndex"},outputs:{selectFocusedIndex:"selectFocusedIndex",indexFocused:"indexFocused"},features:[W],ngContentSelectors:qV,decls:13,vars:10,consts:[["aria-hidden","true","type","button","mat-ripple","","tabindex","-1",1,"mat-mdc-tab-header-pagination","mat-mdc-tab-header-pagination-before",3,"matRippleDisabled","disabled","click","mousedown","touchend"],["previousPaginator",""],[1,"mat-mdc-tab-header-pagination-chevron"],[1,"mat-mdc-tab-label-container",3,"keydown"],["tabListContainer",""],["role","tablist",1,"mat-mdc-tab-list",3,"cdkObserveContent"],["tabList",""],[1,"mat-mdc-tab-labels"],["tabListInner",""],["aria-hidden","true","type","button","mat-ripple","","tabindex","-1",1,"mat-mdc-tab-header-pagination","mat-mdc-tab-header-pagination-after",3,"matRippleDisabled","disabled","mousedown","click","touchend"],["nextPaginator",""]],template:function(t,n){1&t&&(Pn(),ve(0,"button",0,1),mt("click",function(){return n._handlePaginatorClick("before")})("mousedown",function(s){return n._handlePaginatorPress("before",s)})("touchend",function(){return n._stopInterval()}),ze(2,"div",2),Ie(),ve(3,"div",3,4),mt("keydown",function(s){return n._handleKeydown(s)}),ve(5,"div",5,6),mt("cdkObserveContent",function(){return n._onContentChanges()}),ve(7,"div",7,8),ti(9),Ie()()(),ve(10,"button",9,10),mt("mousedown",function(s){return n._handlePaginatorPress("after",s)})("click",function(){return n._handlePaginatorClick("after")})("touchend",function(){return n._stopInterval()}),ze(12,"div",2),Ie()),2&t&&(Mi("mat-mdc-tab-header-pagination-disabled",n._disableScrollBefore),K("matRippleDisabled",n._disableScrollBefore||n.disableRipple)("disabled",n._disableScrollBefore||null),oe(3),Mi("_mat-animation-noopable","NoopAnimations"===n._animationMode),oe(7),Mi("mat-mdc-tab-header-pagination-disabled",n._disableScrollAfter),K("matRippleDisabled",n._disableScrollAfter||n.disableRipple)("disabled",n._disableScrollAfter||null))},dependencies:[q0,iR],styles:[".mat-mdc-tab-header{display:flex;overflow:hidden;position:relative;flex-shrink:0}.mat-mdc-tab-header-pagination{-webkit-user-select:none;user-select:none;position:relative;display:none;justify-content:center;align-items:center;min-width:32px;cursor:pointer;z-index:2;-webkit-tap-highlight-color:rgba(0,0,0,0);touch-action:none;box-sizing:content-box;background:none;border:none;outline:0;padding:0}.mat-mdc-tab-header-pagination::-moz-focus-inner{border:0}.mat-mdc-tab-header-pagination .mat-ripple-element{opacity:.12}.mat-mdc-tab-header-pagination-controls-enabled .mat-mdc-tab-header-pagination{display:flex}.mat-mdc-tab-header-pagination-before,.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-after{padding-left:4px}.mat-mdc-tab-header-pagination-before .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-after .mat-mdc-tab-header-pagination-chevron{transform:rotate(-135deg)}.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-before,.mat-mdc-tab-header-pagination-after{padding-right:4px}.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-before .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-header-pagination-after .mat-mdc-tab-header-pagination-chevron{transform:rotate(45deg)}.mat-mdc-tab-header-pagination-chevron{border-style:solid;border-width:2px 2px 0 0;height:8px;width:8px}.mat-mdc-tab-header-pagination-disabled{box-shadow:none;cursor:default;pointer-events:none}.mat-mdc-tab-header-pagination-disabled .mat-mdc-tab-header-pagination-chevron{opacity:.4}.mat-mdc-tab-list{flex-grow:1;position:relative;transition:transform 500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-mdc-tab-list{transition:none}._mat-animation-noopable span.mdc-tab-indicator__content,._mat-animation-noopable span.mdc-tab__text-label{transition:none}.mat-mdc-tab-label-container{display:flex;flex-grow:1;overflow:hidden;z-index:1}.mat-mdc-tab-labels{display:flex;flex:1 0 auto}[mat-align-tabs=center]>.mat-mdc-tab-header .mat-mdc-tab-labels{justify-content:center}[mat-align-tabs=end]>.mat-mdc-tab-header .mat-mdc-tab-labels{justify-content:flex-end}.mat-mdc-tab::before{margin:5px}.cdk-high-contrast-active .mat-mdc-tab[aria-disabled=true]{color:GrayText}"],encapsulation:2}),i})();const iz=new Fe("MAT_TABS_CONFIG");let zfe=0;const Hfe=Hx(eV(class{constructor(i){this._elementRef=i}}),"primary");let Gfe=(()=>{class i extends Hfe{get dynamicHeight(){return this._dynamicHeight}set dynamicHeight(t){this._dynamicHeight=zi(t)}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){this._indexToSelect=us(t,null)}get animationDuration(){return this._animationDuration}set animationDuration(t){this._animationDuration=/^\d+$/.test(t+"")?t+"ms":t}get contentTabIndex(){return this._contentTabIndex}set contentTabIndex(t){this._contentTabIndex=us(t,null)}get disablePagination(){return this._disablePagination}set disablePagination(t){this._disablePagination=zi(t)}get preserveContent(){return this._preserveContent}set preserveContent(t){this._preserveContent=zi(t)}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){const n=this._elementRef.nativeElement.classList;n.remove("mat-tabs-with-background",`mat-background-${this.backgroundColor}`),t&&n.add("mat-tabs-with-background",`mat-background-${t}`),this._backgroundColor=t}constructor(t,n,r,s){super(t),this._changeDetectorRef=n,this._animationMode=s,this._tabs=new Sd,this._indexToSelect=0,this._lastFocusedTabIndex=null,this._tabBodyWrapperHeight=0,this._tabsSubscription=cn.EMPTY,this._tabLabelSubscription=cn.EMPTY,this._dynamicHeight=!1,this._selectedIndex=null,this.headerPosition="above",this._disablePagination=!1,this._preserveContent=!1,this.selectedIndexChange=new Ct,this.focusChange=new Ct,this.animationDone=new Ct,this.selectedTabChange=new Ct(!0),this._groupId=zfe++,this.animationDuration=r&&r.animationDuration?r.animationDuration:"500ms",this.disablePagination=!(!r||null==r.disablePagination)&&r.disablePagination,this.dynamicHeight=!(!r||null==r.dynamicHeight)&&r.dynamicHeight,this.contentTabIndex=r?.contentTabIndex??null,this.preserveContent=!!r?.preserveContent}ngAfterContentChecked(){const t=this._indexToSelect=this._clampTabIndex(this._indexToSelect);if(this._selectedIndex!=t){const n=null==this._selectedIndex;if(!n){this.selectedTabChange.emit(this._createChangeEvent(t));const r=this._tabBodyWrapper.nativeElement;r.style.minHeight=r.clientHeight+"px"}Promise.resolve().then(()=>{this._tabs.forEach((r,s)=>r.isActive=s===t),n||(this.selectedIndexChange.emit(t),this._tabBodyWrapper.nativeElement.style.minHeight="")})}this._tabs.forEach((n,r)=>{n.position=r-t,null!=this._selectedIndex&&0==n.position&&!n.origin&&(n.origin=t-this._selectedIndex)}),this._selectedIndex!==t&&(this._selectedIndex=t,this._lastFocusedTabIndex=null,this._changeDetectorRef.markForCheck())}ngAfterContentInit(){this._subscribeToAllTabChanges(),this._subscribeToTabLabels(),this._tabsSubscription=this._tabs.changes.subscribe(()=>{const t=this._clampTabIndex(this._indexToSelect);if(t===this._selectedIndex){const n=this._tabs.toArray();let r;for(let s=0;s<n.length;s++)if(n[s].isActive){this._indexToSelect=this._selectedIndex=s,this._lastFocusedTabIndex=null,r=n[s];break}!r&&n[t]&&Promise.resolve().then(()=>{n[t].isActive=!0,this.selectedTabChange.emit(this._createChangeEvent(t))})}this._changeDetectorRef.markForCheck()})}_subscribeToAllTabChanges(){this._allTabs.changes.pipe(ec(this._allTabs)).subscribe(t=>{this._tabs.reset(t.filter(n=>n._closestTabGroup===this||!n._closestTabGroup)),this._tabs.notifyOnChanges()})}ngOnDestroy(){this._tabs.destroy(),this._tabsSubscription.unsubscribe(),this._tabLabelSubscription.unsubscribe()}realignInkBar(){this._tabHeader&&this._tabHeader._alignInkBarToSelectedTab()}updatePagination(){this._tabHeader&&this._tabHeader.updatePagination()}focusTab(t){const n=this._tabHeader;n&&(n.focusIndex=t)}_focusChanged(t){this._lastFocusedTabIndex=t,this.focusChange.emit(this._createChangeEvent(t))}_createChangeEvent(t){const n=new Wfe;return n.index=t,this._tabs&&this._tabs.length&&(n.tab=this._tabs.toArray()[t]),n}_subscribeToTabLabels(){this._tabLabelSubscription&&this._tabLabelSubscription.unsubscribe(),this._tabLabelSubscription=ud(...this._tabs.map(t=>t._stateChanges)).subscribe(()=>this._changeDetectorRef.markForCheck())}_clampTabIndex(t){return Math.min(this._tabs.length-1,Math.max(t||0,0))}_getTabLabelId(t){return`mat-tab-label-${this._groupId}-${t}`}_getTabContentId(t){return`mat-tab-content-${this._groupId}-${t}`}_setTabBodyWrapperHeight(t){if(!this._dynamicHeight||!this._tabBodyWrapperHeight)return;const n=this._tabBodyWrapper.nativeElement;n.style.height=this._tabBodyWrapperHeight+"px",this._tabBodyWrapper.nativeElement.offsetHeight&&(n.style.height=t+"px")}_removeTabBodyWrapperHeight(){const t=this._tabBodyWrapper.nativeElement;this._tabBodyWrapperHeight=t.clientHeight,t.style.height="",this.animationDone.emit()}_handleClick(t,n,r){n.focusIndex=r,t.disabled||(this.selectedIndex=r)}_getTabIndex(t){return t===(this._lastFocusedTabIndex??this.selectedIndex)?0:-1}_tabFocusChanged(t,n){t&&"mouse"!==t&&"touch"!==t&&(this._tabHeader.focusIndex=n)}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(er),R(iz,8),R(rs,8))},i.\u0275dir=ke({type:i,inputs:{dynamicHeight:"dynamicHeight",selectedIndex:"selectedIndex",headerPosition:"headerPosition",animationDuration:"animationDuration",contentTabIndex:"contentTabIndex",disablePagination:"disablePagination",preserveContent:"preserveContent",backgroundColor:"backgroundColor"},outputs:{selectedIndexChange:"selectedIndexChange",focusChange:"focusChange",animationDone:"animationDone",selectedTabChange:"selectedTabChange"},features:[W]}),i})(),Qfe=(()=>{class i extends Gfe{get fitInkBarToContent(){return this._fitInkBarToContent}set fitInkBarToContent(t){this._fitInkBarToContent=zi(t),this._changeDetectorRef.markForCheck()}get stretchTabs(){return this._stretchTabs}set stretchTabs(t){this._stretchTabs=zi(t)}constructor(t,n,r,s){super(t,n,r,s),this._fitInkBarToContent=!1,this._stretchTabs=!0,this.fitInkBarToContent=!(!r||null==r.fitInkBarToContent)&&r.fitInkBarToContent}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(er),R(iz,8),R(rs,8))},i.\u0275cmp=$({type:i,selectors:[["mat-tab-group"]],contentQueries:function(t,n,r){if(1&t&&Fn(r,JV,5),2&t){let s;Pt(s=kt())&&(n._allTabs=s)}},viewQuery:function(t,n){if(1&t&&(Di(gfe,5),Di(_fe,5)),2&t){let r;Pt(r=kt())&&(n._tabBodyWrapper=r.first),Pt(r=kt())&&(n._tabHeader=r.first)}},hostAttrs:[1,"mat-mdc-tab-group"],hostVars:6,hostBindings:function(t,n){2&t&&Mi("mat-mdc-tab-group-dynamic-height",n.dynamicHeight)("mat-mdc-tab-group-inverted-header","below"===n.headerPosition)("mat-mdc-tab-group-stretch-tabs",n.stretchTabs)},inputs:{color:"color",disableRipple:"disableRipple",fitInkBarToContent:"fitInkBarToContent",stretchTabs:["mat-stretch-tabs","stretchTabs"]},exportAs:["matTabGroup"],features:[se([{provide:$V,useExisting:i}]),W],decls:6,vars:6,consts:[[3,"selectedIndex","disableRipple","indexFocused","selectFocusedIndex"],["tabHeader",""],["class","mdc-tab mat-mdc-tab mat-mdc-focus-indicator","role","tab","matTabLabelWrapper","","cdkMonitorElementFocus","",3,"id","mdc-tab--active","ngClass","disabled","fitInkBarToContent","click","cdkFocusChange",4,"ngFor","ngForOf"],[1,"mat-mdc-tab-body-wrapper"],["tabBodyWrapper",""],["role","tabpanel",3,"id","mat-mdc-tab-body-active","ngClass","content","position","origin","animationDuration","preserveContent","_onCentered","_onCentering",4,"ngFor","ngForOf"],["role","tab","matTabLabelWrapper","","cdkMonitorElementFocus","",1,"mdc-tab","mat-mdc-tab","mat-mdc-focus-indicator",3,"id","ngClass","disabled","fitInkBarToContent","click","cdkFocusChange"],["tabNode",""],[1,"mdc-tab__ripple"],["mat-ripple","",1,"mat-mdc-tab-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mdc-tab__content"],[1,"mdc-tab__text-label"],[3,"ngIf","ngIfElse"],["tabTextLabel",""],[3,"cdkPortalOutlet"],["role","tabpanel",3,"id","ngClass","content","position","origin","animationDuration","preserveContent","_onCentered","_onCentering"]],template:function(t,n){1&t&&(ve(0,"mat-tab-header",0,1),mt("indexFocused",function(s){return n._focusChanged(s)})("selectFocusedIndex",function(s){return n.selectedIndex=s}),Vt(2,Afe,9,17,"div",2),Ie(),ve(3,"div",3,4),Vt(5,xfe,1,11,"mat-tab-body",5),Ie()),2&t&&(K("selectedIndex",n.selectedIndex||0)("disableRipple",n.disableRipple),oe(2),K("ngForOf",n._tabs),oe(1),Mi("_mat-animation-noopable","NoopAnimations"===n._animationMode),oe(2),K("ngForOf",n._tabs))},dependencies:[qO,$l,Dd,mR,q0,lue,XV,KV,Vfe],styles:['.mdc-tab{min-width:90px;padding-right:24px;padding-left:24px;display:flex;flex:1 0 auto;justify-content:center;box-sizing:border-box;margin:0;padding-top:0;padding-bottom:0;border:none;outline:none;text-align:center;white-space:nowrap;cursor:pointer;-webkit-appearance:none;z-index:1}.mdc-tab::-moz-focus-inner{padding:0;border:0}.mdc-tab[hidden]{display:none}.mdc-tab--min-width{flex:0 1 auto}.mdc-tab__content{display:flex;align-items:center;justify-content:center;height:inherit;pointer-events:none}.mdc-tab__text-label{transition:150ms color linear;display:inline-block;line-height:1;z-index:2}.mdc-tab__icon{transition:150ms color linear;z-index:2}.mdc-tab--stacked .mdc-tab__content{flex-direction:column;align-items:center;justify-content:center}.mdc-tab--stacked .mdc-tab__text-label{padding-top:6px;padding-bottom:4px}.mdc-tab--active .mdc-tab__text-label,.mdc-tab--active .mdc-tab__icon{transition-delay:100ms}.mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label{padding-left:8px;padding-right:0}[dir=rtl] .mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label,.mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label[dir=rtl]{padding-left:0;padding-right:8px}.mdc-tab-indicator .mdc-tab-indicator__content--underline{border-top-width:2px}.mdc-tab-indicator .mdc-tab-indicator__content--icon{height:34px;font-size:34px}.mdc-tab-indicator{display:flex;position:absolute;top:0;left:0;justify-content:center;width:100%;height:100%;pointer-events:none;z-index:1}.mdc-tab-indicator__content{transform-origin:left;opacity:0}.mdc-tab-indicator__content--underline{align-self:flex-end;box-sizing:border-box;width:100%;border-top-style:solid}.mdc-tab-indicator__content--icon{align-self:center;margin:0 auto}.mdc-tab-indicator--active .mdc-tab-indicator__content{opacity:1}.mdc-tab-indicator .mdc-tab-indicator__content{transition:250ms transform cubic-bezier(0.4, 0, 0.2, 1)}.mdc-tab-indicator--no-transition .mdc-tab-indicator__content{transition:none}.mdc-tab-indicator--fade .mdc-tab-indicator__content{transition:150ms opacity linear}.mdc-tab-indicator--active.mdc-tab-indicator--fade .mdc-tab-indicator__content{transition-delay:100ms}.mat-mdc-tab-ripple{position:absolute;top:0;left:0;bottom:0;right:0;pointer-events:none}.mat-mdc-tab{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-tab.mdc-tab{height:48px;flex-grow:0}.mat-mdc-tab .mdc-tab__ripple::before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;opacity:0;pointer-events:none}.mat-mdc-tab .mdc-tab__text-label{display:inline-flex;align-items:center}.mat-mdc-tab .mdc-tab__content{position:relative}.mat-mdc-tab:hover .mdc-tab__ripple::before{opacity:.04}.mat-mdc-tab.cdk-program-focused .mdc-tab__ripple::before,.mat-mdc-tab.cdk-keyboard-focused .mdc-tab__ripple::before{opacity:.12}.mat-mdc-tab .mat-ripple-element{opacity:.12}.mat-mdc-tab-group.mat-mdc-tab-group-stretch-tabs>.mat-mdc-tab-header .mat-mdc-tab{flex-grow:1}.mat-mdc-tab-disabled{opacity:.4}.mat-mdc-tab-group{display:flex;flex-direction:column;max-width:100%}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination{background-color:var(--mat-mdc-tab-header-with-background-background-color, transparent)}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-tab .mdc-tab__text-label,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-tab-link .mdc-tab__text-label{color:var(--mat-mdc-tab-header-with-background-foreground-color, inherit)}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mdc-tab-indicator__content--underline,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-focus-indicator::before{border-color:var(--mat-mdc-tab-header-with-background-foreground-color, inherit)}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-ripple-element,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mdc-tab__ripple::before,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mat-ripple-element,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mdc-tab__ripple::before{background-color:var(--mat-mdc-tab-header-with-background-foreground-color, inherit)}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mat-mdc-tab-header-pagination-chevron{border-color:var(--mat-mdc-tab-header-with-background-foreground-color, inherit)}.mat-mdc-tab-group.mat-mdc-tab-group-inverted-header{flex-direction:column-reverse}.mat-mdc-tab-group.mat-mdc-tab-group-inverted-header .mdc-tab-indicator__content--underline{align-self:flex-start}.mat-mdc-tab-body-wrapper{position:relative;overflow:hidden;display:flex;transition:height 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-mdc-tab-body-wrapper._mat-animation-noopable{transition:none !important;animation:none !important}'],encapsulation:2}),i})();class Wfe{}let nz=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[Ea,bn,OV,X0,Vx,cue,bn]}),i})();const{isArray:qfe}=Array;const tw=new Fe("HIGHLIGHT_OPTIONS");let Zfe=(()=>{class i{constructor(t,n,r){this.doc=t,this._options=r,this._ready=new Qs(null),this.ready=this._ready.asObservable().pipe(Bn(s=>!!s),vt(s=>s),ps(1)),s3(n)&&(t.defaultView.hljs?this._ready.next(t.defaultView.hljs):this._loadLibrary().pipe(Ws(s=>this._options&&this._options.lineNumbersLoader?(t.defaultView.hljs=s,this.loadLineNumbers().pipe(nn(()=>this._ready.next(s)))):(this._ready.next(s),jr)),Ko(s=>(console.error("[HLJS] ",s),jr))).subscribe(),this._options?.themePath&&this.loadTheme(this._options.themePath))}_loadLibrary(){if(this._options){if(this._options.fullLibraryLoader&&this._options.coreLibraryLoader)return Zo(()=>"The full library and the core library were imported, only one of them should be imported!");if(this._options.fullLibraryLoader&&this._options.languages)return Zo(()=>"The highlighting languages were imported they are not needed!");if(this._options.coreLibraryLoader&&!this._options.languages)return Zo(()=>"The highlighting languages were not imported!");if(!this._options.coreLibraryLoader&&this._options.languages)return Zo(()=>"The core library was not imported!");if(this._options.fullLibraryLoader)return this.loadFullLibrary();if(this._options.coreLibraryLoader&&this._options.languages&&Object.keys(this._options.languages).length)return this.loadCoreLibrary().pipe(Ws(t=>this._loadLanguages(t)))}return Zo(()=>"Highlight.js library was not imported!")}_loadLanguages(t){return function Yfe(...i){const e=cM(i),t=function Xfe(i){return 1===i.length&&qfe(i[0])?i[0]:i}(i);return t.length?new Fi(n=>{let r=t.map(()=>[]),s=t.map(()=>!1);n.add(()=>{r=s=null});for(let o=0;!n.closed&&o<t.length;o++)fs(t[o]).subscribe(dn(n,a=>{if(r[o].push(a),r.every(l=>l.length)){const l=r.map(c=>c.shift());n.next(e?e(...l):l),r.some((c,d)=>!c.length&&s[d])&&n.complete()}},()=>{s[o]=!0,!r[o].length&&n.complete()}));return()=>{r=s=null}}):jr}(...Object.entries(this._options.languages).map(([r,s])=>iw(s()).pipe(nn(o=>t.registerLanguage(r,o))))).pipe(vt(()=>t))}loadCoreLibrary(){return iw(this._options.coreLibraryLoader())}loadFullLibrary(){return iw(this._options.fullLibraryLoader())}loadLineNumbers(){return iw(this._options.lineNumbersLoader())}setTheme(t){this._themeLinkElement.href=t}loadTheme(t){this._themeLinkElement=this.doc.createElement("link"),this._themeLinkElement.href=t,this._themeLinkElement.type="text/css",this._themeLinkElement.rel="stylesheet",this._themeLinkElement.media="screen,print",this.doc.head.appendChild(this._themeLinkElement)}}return i.\u0275fac=function(t){return new(t||i)(ye(ii),ye(h_),ye(tw,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const iw=i=>wn(i).pipe(Bn(e=>!!e&&!!e.default),vt(e=>e.default));let Kfe=(()=>{class i{constructor(t,n){this._loader=t,this._hljs=null,t.ready.subscribe(r=>{this._hljs=r,n&&n.config&&(r.configure(n.config),r.listLanguages().length<1&&console.error("[HighlightJS]: No languages were registered!"))})}get hljs(){return this._hljs}highlight(t,{language:n,ignoreIllegals:r}){return this._loader.ready.pipe(vt(s=>s.highlight(t,{language:n,ignoreIllegals:r})))}highlightAuto(t,n){return this._loader.ready.pipe(vt(r=>r.highlightAuto(t,n)))}highlightElement(t){return this._loader.ready.pipe(vt(n=>n.highlightElement(t)))}highlightAll(){return this._loader.ready.pipe(vt(t=>t.highlightAll()))}configure(t){return this._loader.ready.pipe(vt(n=>n.configure(t)))}registerLanguage(t,n){return this._loader.ready.pipe(nn(r=>r.registerLanguage(t,n)))}unregisterLanguage(t){return this._loader.ready.pipe(nn(n=>n.unregisterLanguage(t)))}registerAliases(t,{languageName:n}){return this._loader.ready.pipe(nn(r=>r.registerAliases(t,{languageName:n})))}listLanguages(){return this._loader.ready.pipe(vt(t=>t.listLanguages()))}getLanguage(t){return this._loader.ready.pipe(vt(n=>n.getLanguage(t)))}safeMode(){return this._loader.ready.pipe(vt(t=>t.safeMode()))}debugMode(){return this._loader.ready.pipe(vt(t=>t.debugMode()))}lineNumbersBlock(t){return this._loader.ready.pipe(Bn(n=>!!n.lineNumbersBlock),nn(n=>n.lineNumbersBlock(t)))}}return i.\u0275fac=function(t){return new(t||i)(ye(Zfe),ye(tw,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),$fe=(()=>{class i{constructor(t,n,r,s){this._hljs=n,this._sanitizer=r,this._options=s,this.highlighted=new Ct,this._nativeElement=t.nativeElement}ngOnChanges(t){null!==t?.code?.currentValue&&t.code.currentValue!==t.code.previousValue&&(this.code?this.highlightElement(this.code,this.languages):this.setTextContent(""))}highlightElement(t,n){this.setTextContent(t),this._hljs.highlightAuto(t,n).subscribe(r=>{this.setInnerHTML(r?.value),this.lineNumbers&&this._options&&this._options.lineNumbersLoader&&this.addLineNumbers(),this.highlighted.emit(r)})}addLineNumbers(){this.destroyLineNumbersObserver(),$x.schedule(()=>{this._hljs.lineNumbersBlock(this._nativeElement).subscribe(),this._lineNumbersObs=new MutationObserver(()=>{this._nativeElement.firstElementChild&&"TABLE"===this._nativeElement.firstElementChild.tagName.toUpperCase()&&this._nativeElement.classList.add("hljs-line-numbers"),this.destroyLineNumbersObserver()}),this._lineNumbersObs.observe(this._nativeElement,{childList:!0})})}destroyLineNumbersObserver(){this._lineNumbersObs&&(this._lineNumbersObs.disconnect(),this._lineNumbersObs=null)}setTextContent(t){$x.schedule(()=>this._nativeElement.textContent=t)}setInnerHTML(t){$x.schedule(()=>this._nativeElement.innerHTML=this._sanitizer.sanitize(Ri.HTML,t)||"")}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(Kfe),R(Dy),R(tw,8))},i.\u0275dir=ke({type:i,selectors:[["","highlight",""]],hostVars:2,hostBindings:function(t,n){2&t&&Mi("hljs",!0)},inputs:{code:["highlight","code"],languages:"languages",lineNumbers:"lineNumbers"},outputs:{highlighted:"highlighted"},features:[Pr]}),i})(),rz=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({}),i})();const epe={connector:()=>new Wt};function npe(i,e,t,n){t&&!Si(t)&&(n=t);const r=Si(t)?t:void 0;return s=>function ipe(i,e){const t=Si(i)?i:()=>i;return Si(e)?function tpe(i,e=epe){const{connector:t}=e;return xn((n,r)=>{const s=t();wn(i(function Jfe(i){return new Fi(e=>i.subscribe(e))}(s))).subscribe(r),r.add(n.subscribe(s))})}(e,{connector:t}):n=>new hS(n,t)}(new BI(i,e,n),r)(s)}const rpe=new Fe("GIST_OPTIONS");let spe=(()=>{class i{constructor(t,n){this._http=t,this._options=n}getCodeFromGist(t){let n;return this.isOAuthProvided()&&(n=(new Fl).set("client_id",this._options.clientId).set("client_secret",this._options.clientSecret)),this.fetchFile(`https://api.github.com/gists/${t}`,{params:n,responseType:"json"})}getCodeFromUrl(t){return this.fetchFile(t,{responseType:"text"})}isOAuthProvided(){return!!this._options&&!!this._options.clientId&&!!this._options.clientSecret}fetchFile(t,n){return function ope(i){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(i)}(t)?this._http.get(t,n).pipe(npe(1),Fy(),Ko(r=>(console.error("[NgxHighlight]: Unable to fetch the URL!",r.message),jr))):jr}}return i.\u0275fac=function(t){return new(t||i)(ye(Xx),ye(rpe,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),ape=(()=>{class i{constructor(t){this._loader=t}transform(t){return this._loader.getCodeFromUrl(t)}}return i.\u0275fac=function(t){return new(t||i)(R(spe,16))},i.\u0275pipe=gi({name:"codeFromUrl",type:i,pure:!0}),i})(),lpe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[rz,Jue,rz]}),i})();function cpe(i,e){if(1&i&&(ve(0,"mat-tab",5)(1,"pre"),qi(2,"            "),ze(3,"code",6),fr(4,"async"),fr(5,"codeFromUrl"),qi(6,"\n        "),Ie()()),2&i){const t=e.$implicit,n=e.index,r=bi();K("label",r.fileNames[n]),oe(3),K("highlight",Er(4,3,Er(5,5,t)))("lineNumbers",r.lineNumbers)}}class ib{constructor(e){this.editorService=e,this.fileNames=[],this.lineNumbers=!1}set codeUrls(e){this.editorService.setUrls(e),this.fileNames=this.editorService.fileNames}get codeUrls(){return this.editorService.urls}}function dpe(i,e){1&i&&Jg(0)}ib.\u0275fac=function(e){return new(e||ib)(R(Bx))},ib.\u0275cmp=$({type:ib,selectors:[["app-code"]],inputs:{codeUrls:"codeUrls",lineNumbers:"lineNumbers"},decls:14,vars:1,consts:[[1,"code-wrapper","hljs"],["dynamicHeight","","color","primary","backgroundColor","primary"],[3,"label",4,"ngFor","ngForOf"],["align","end"],["mat-button","","href","#",1,"gist-url",3,"click"],[3,"label"],[3,"highlight","lineNumbers"]],template:function(e,t){1&e&&(ve(0,"mat-card")(1,"mat-card-content")(2,"div",0)(3,"mat-tab-group",1),Vt(4,cpe,7,7,"mat-tab",2),Ie()()(),ve(5,"mat-card-actions",3)(6,"button",4),mt("click",function(r){return t.editorService.toCodeSandbox(r)}),ve(7,"mat-icon"),qi(8,"crop_din"),Ie(),qi(9," CodeSandbox "),Ie(),ve(10,"button",4),mt("click",function(r){return t.editorService.toStackblitz(r)}),ve(11,"mat-icon"),qi(12,"bolt"),Ie(),qi(13," Stackblitz "),Ie()()()),2&e&&(oe(4),K("ngForOf",t.codeUrls))},dependencies:[$l,cV,DV,PV,FV,kV,JV,Qfe,$fe,$E,ape],styles:["pre[_ngcontent-%COMP%]{display:flex;margin-top:0;margin-bottom:0;word-wrap:break-word}pre[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{flex:1;line-height:1.8em;font-size:14px;min-height:100%;padding:1em 1.2em}pre[_ngcontent-%COMP%]   code.hljs-line-numbers[_ngcontent-%COMP%]{padding:0}.mat-mdc-card[_ngcontent-%COMP%]{padding:0;margin-bottom:3em}.mat-card-header[_ngcontent-%COMP%]{margin:0!important;padding:0!important;display:flex;align-items:center;height:40px}.mat-card-content[_ngcontent-%COMP%]{position:relative;overflow:hidden;padding:1px;margin-bottom:0}.mat-card-footer[_ngcontent-%COMP%]{padding:10px!important;margin:0!important;display:flex;flex-direction:row-reverse}.mat-card-footer[_ngcontent-%COMP%]   .gist-url[_ngcontent-%COMP%]{display:flex;align-items:center;font-weight:300;font-size:13px;text-decoration:unset}.mat-card-footer[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.mat-icon[_ngcontent-%COMP%]{margin:0 3px}.code-wrapper[_ngcontent-%COMP%]{border-radius:3px 3px 0 0}  .hljs{padding:0;border:none;transition:border ease 1s}  .hljs-ln{padding:10px 0}  .hljs-ln tr:first-child td{padding-top:10px!important}  .hljs-ln tr:last-child td{padding-bottom:10px!important}  td.hljs-ln-numbers{-webkit-user-select:none;user-select:none;text-align:center;color:#cccccc6b;border-right:1px solid rgba(204,204,204,.1098039216);vertical-align:top;padding-right:10px!important;padding-left:10px!important}  td.hljs-ln-code{padding-left:10px!important}"],changeDetection:0});class nb{constructor(e,t){this.editorService=e,this.route=t,this.exampleComponent=null,this.codeUrls=this.route.snapshot.data.codeUrls??[],this.editorService.declarations=this.route.snapshot.data.declarations,this.exampleComponent=this.route.snapshot.data.exampleComponent}ngOnInit(){}}nb.\u0275fac=function(e){return new(e||nb)(R(Bx),R(Ld))},nb.\u0275cmp=$({type:nb,selectors:[["app-example-page"]],decls:3,vars:3,consts:[[1,"example-container"],[4,"ngComponentOutlet"],[3,"lineNumbers","codeUrls"]],template:function(e,t){1&e&&(ve(0,"div",0),Vt(1,dpe,1,0,"ng-container",1),Ie(),ze(2,"app-code",2)),2&e&&(oe(1),K("ngComponentOutlet",t.exampleComponent),oe(1),K("lineNumbers",!0)("codeUrls",t.codeUrls))},dependencies:[XO,ib]});class Su{}Su.\u0275fac=function(e){return new(e||Su)},Su.\u0275mod=ci({type:Su}),Su.\u0275inj=oi({});class Cp{}Cp.\u0275fac=function(e){return new(e||Cp)},Cp.\u0275mod=ci({type:Cp}),Cp.\u0275inj=oi({imports:[Su,Ea,Su]});const upe=/^[og]\s*(.+)?/,hpe=/^mtllib /,fpe=/^usemtl /,ppe=/^usemap /,sz=/\s+/,oz=new T,yR=new T,az=new T,lz=new T,ko=new T,nw=new De;function mpe(){const i={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);const n=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(r,s){const o=this._finalize(!1);o&&(o.inherited||o.groupCount<=0)&&this.materials.splice(o.index,1);const a={index:this.materials.length,name:r||"",mtllib:Array.isArray(s)&&s.length>0?s[s.length-1]:"",smooth:void 0!==o?o.smooth:this.smooth,groupStart:void 0!==o?o.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(l){const c={index:"number"==typeof l?l:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return c.clone=this.clone.bind(c),c}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(r){const s=this.currentMaterial();if(s&&-1===s.groupEnd&&(s.groupEnd=this.geometry.vertices.length/3,s.groupCount=s.groupEnd-s.groupStart,s.inherited=!1),r&&this.materials.length>1)for(let o=this.materials.length-1;o>=0;o--)this.materials[o].groupCount<=0&&this.materials.splice(o,1);return r&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),s}},n&&n.name&&"function"==typeof n.clone){const r=n.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseNormalIndex:function(e,t){const n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseUVIndex:function(e,t){const n=parseInt(e,10);return 2*(n>=0?n-1:n+t/2)},addVertex:function(e,t,n){const r=this.vertices,s=this.object.geometry.vertices;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[n+0],r[n+1],r[n+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,n){const r=this.normals,s=this.object.geometry.normals;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[n+0],r[n+1],r[n+2])},addFaceNormal:function(e,t,n){const r=this.vertices,s=this.object.geometry.normals;oz.fromArray(r,e),yR.fromArray(r,t),az.fromArray(r,n),ko.subVectors(az,yR),lz.subVectors(oz,yR),ko.cross(lz),ko.normalize(),s.push(ko.x,ko.y,ko.z),s.push(ko.x,ko.y,ko.z),s.push(ko.x,ko.y,ko.z)},addColor:function(e,t,n){const r=this.colors,s=this.object.geometry.colors;void 0!==r[e]&&s.push(r[e+0],r[e+1],r[e+2]),void 0!==r[t]&&s.push(r[t+0],r[t+1],r[t+2]),void 0!==r[n]&&s.push(r[n+0],r[n+1],r[n+2])},addUV:function(e,t,n){const r=this.uvs,s=this.object.geometry.uvs;s.push(r[e+0],r[e+1]),s.push(r[t+0],r[t+1]),s.push(r[n+0],r[n+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,n,r,s,o,a,l,c){const d=this.vertices.length;let u=this.parseVertexIndex(e,d),h=this.parseVertexIndex(t,d),f=this.parseVertexIndex(n,d);if(this.addVertex(u,h,f),this.addColor(u,h,f),void 0!==a&&""!==a){const m=this.normals.length;u=this.parseNormalIndex(a,m),h=this.parseNormalIndex(l,m),f=this.parseNormalIndex(c,m),this.addNormal(u,h,f)}else this.addFaceNormal(u,h,f);if(void 0!==r&&""!==r){const m=this.uvs.length;u=this.parseUVIndex(r,m),h=this.parseUVIndex(s,m),f=this.parseUVIndex(o,m),this.addUV(u,h,f),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let n=0,r=e.length;n<r;n++){const s=this.parseVertexIndex(e[n],t);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const n=this.vertices.length,r=this.uvs.length;for(let s=0,o=e.length;s<o;s++)this.addVertexLine(this.parseVertexIndex(e[s],n));for(let s=0,o=t.length;s<o;s++)this.addUVLine(this.parseUVIndex(t[s],r))}};return i.startObject("",!1),i}class gpe extends yr{constructor(e){super(e),this.materials=null}load(e,t,n,r){const s=this,o=new Ar(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(a))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}setMaterials(e){return this.materials=e,this}parse(e){const t=new mpe;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));const n=e.split("\n");let r=[];for(let a=0,l=n.length;a<l;a++){const c=n[a].trimStart();if(0===c.length)continue;const d=c.charAt(0);if("#"!==d)if("v"===d){const u=c.split(sz);switch(u[0]){case"v":t.vertices.push(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])),u.length>=7?(nw.setRGB(parseFloat(u[4]),parseFloat(u[5]),parseFloat(u[6])).convertSRGBToLinear(),t.colors.push(nw.r,nw.g,nw.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]));break;case"vt":t.uvs.push(parseFloat(u[1]),parseFloat(u[2]))}}else if("f"===d){const h=c.slice(1).trim().split(sz),f=[];for(let p=0,g=h.length;p<g;p++){const _=h[p];if(_.length>0){const v=_.split("/");f.push(v)}}const m=f[0];for(let p=1,g=f.length-1;p<g;p++){const _=f[p],v=f[p+1];t.addFace(m[0],_[0],v[0],m[1],_[1],v[1],m[2],_[2],v[2])}}else if("l"===d){const u=c.substring(1).trim().split(" ");let h=[];const f=[];if(-1===c.indexOf("/"))h=u;else for(let m=0,p=u.length;m<p;m++){const g=u[m].split("/");""!==g[0]&&h.push(g[0]),""!==g[1]&&f.push(g[1])}t.addLineGeometry(h,f)}else if("p"===d){const h=c.slice(1).trim().split(" ");t.addPointGeometry(h)}else if(null!==(r=upe.exec(c))){const u=(" "+r[0].slice(1).trim()).slice(1);t.startObject(u)}else if(fpe.test(c))t.object.startMaterial(c.substring(7).trim(),t.materialLibraries);else if(hpe.test(c))t.materialLibraries.push(c.substring(7).trim());else if(ppe.test(c))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===d){if(r=c.split(" "),r.length>1){const h=r[1].trim().toLowerCase();t.object.smooth="0"!==h&&"off"!==h}else t.object.smooth=!0;const u=t.object.currentMaterial();u&&(u.smooth=t.object.smooth)}else{if("\0"===c)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+c+'"')}}t.finalize();const s=new xs;if(s.materialLibraries=[].concat(t.materialLibraries),1==!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length))for(let a=0,l=t.objects.length;a<l;a++){const c=t.objects[a],d=c.geometry,u=c.materials,h="Line"===d.type,f="Points"===d.type;let m=!1;if(0===d.vertices.length)continue;const p=new xt;p.setAttribute("position",new Ge(d.vertices,3)),d.normals.length>0&&p.setAttribute("normal",new Ge(d.normals,3)),d.colors.length>0&&(m=!0,p.setAttribute("color",new Ge(d.colors,3))),!0===d.hasUVIndices&&p.setAttribute("uv",new Ge(d.uvs,2));const g=[];for(let v=0,b=u.length;v<b;v++){const y=u[v],x=y.name+"_"+y.smooth+"_"+m;let C=t.materials[x];if(null!==this.materials)if(C=this.materials.create(y.name),!h||!C||C instanceof pn){if(f&&C&&!(C instanceof El)){const M=new El({size:10,sizeAttenuation:!1});On.prototype.copy.call(M,C),M.color.copy(C.color),M.map=C.map,C=M}}else{const M=new pn;On.prototype.copy.call(M,C),M.color.copy(C.color),C=M}void 0===C&&(C=h?new pn:f?new El({size:1,sizeAttenuation:!1}):new nu,C.name=y.name,C.flatShading=!y.smooth,C.vertexColors=m,t.materials[x]=C),g.push(C)}let _;if(g.length>1){for(let v=0,b=u.length;v<b;v++){const y=u[v];p.addGroup(y.groupStart,y.groupCount,v)}_=h?new ws(p,g):f?new $d(p,g):new Ke(p,g)}else _=h?new ws(p,g[0]):f?new $d(p,g[0]):new Ke(p,g[0]);_.name=c.name,s.add(_)}else if(t.vertices.length>0){const a=new El({size:1,sizeAttenuation:!1}),l=new xt;l.setAttribute("position",new Ge(t.vertices,3)),t.colors.length>0&&void 0!==t.colors[0]&&(l.setAttribute("color",new Ge(t.colors,3)),a.vertexColors=!0);const c=new $d(l,a);s.add(c)}return s}}class Sc extends Na{constructor(){super(...arguments),this.clazz=gpe}}Sc.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Sc)))(t||Sc)}}(),Sc.\u0275prov=Ne({token:Sc,factory:Sc.\u0275fac,providedIn:"root"});class rw extends Rx{constructor(e){super(),this.service=e}}rw.\u0275fac=function(e){return new(e||rw)(R(Sc,16))},rw.\u0275pipe=gi({name:"loadObj",type:rw,pure:!0});class sw extends _u{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}getRefFromResponse(e){return e}}sw.\u0275fac=function(e){return new(e||sw)(R(Ye,1),R(at),R(Sc))},sw.\u0275dir=ke({type:sw,selectors:[["","loadObj",""]],features:[W]});var AR=function(i){return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))};try{URL.revokeObjectURL(AR(""))}catch{AR=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)}}var Xi=Uint8Array,Tr=Uint16Array,Tc=Uint32Array,Mp=new Xi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ep=new Xi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),rb=new Xi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),uz=function(i,e){for(var t=new Tr(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];var r=new Tc(t[30]);for(n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)r[s]=s-t[n]<<5|n;return[t,r]},hz=uz(Mp,2),xR=hz[0],ow=hz[1];xR[28]=258,ow[258]=28;for(var pz=uz(Ep,0)[0],sb=new Tr(32768),gn=0;gn<32768;++gn){var Ic=(43690&gn)>>>1|(21845&gn)<<1;sb[gn]=((65280&(Ic=(61680&(Ic=(52428&Ic)>>>2|(13107&Ic)<<2))>>>4|(3855&Ic)<<4))>>>8|(255&Ic)<<8)>>>1}var Ha=function(i,e,t){for(var n=i.length,r=0,s=new Tr(e);r<n;++r)++s[i[r]-1];var a,o=new Tr(e);for(r=0;r<e;++r)o[r]=o[r-1]+s[r-1]<<1;if(t){a=new Tr(1<<e);var l=15-e;for(r=0;r<n;++r)if(i[r])for(var c=r<<4|i[r],d=e-i[r],u=o[i[r]-1]++<<d,h=u|(1<<d)-1;u<=h;++u)a[sb[u]>>>l]=c}else for(a=new Tr(n),r=0;r<n;++r)i[r]&&(a[r]=sb[o[i[r]-1]++]>>>15-i[r]);return a},Rc=new Xi(288);for(gn=0;gn<144;++gn)Rc[gn]=8;for(gn=144;gn<256;++gn)Rc[gn]=9;for(gn=256;gn<280;++gn)Rc[gn]=7;for(gn=280;gn<288;++gn)Rc[gn]=8;var ob=new Xi(32);for(gn=0;gn<32;++gn)ob[gn]=5;var gz=Ha(Rc,9,1),bz=Ha(ob,5,1),aw=function(i){for(var e=i[0],t=1;t<i.length;++t)i[t]>e&&(e=i[t]);return e},Fo=function(i,e,t){var n=e/8|0;return(i[n]|i[n+1]<<8)>>(7&e)&t},lw=function(i,e){var t=e/8|0;return(i[t]|i[t+1]<<8|i[t+2]<<16)>>(7&e)},ab=function(i){return(i/8|0)+(7&i&&1)},cw=function(i,e,t){var n=i.length;if(!n||t&&!t.l&&n<5)return e||new Xi(0);var r=!e||t,s=!t||t.i;t||(t={}),e||(e=new Xi(3*n));var o=function(G){var U=e.length;if(G>U){var de=new Xi(Math.max(2*U,G));de.set(e),e=de}},a=t.f||0,l=t.p||0,c=t.b||0,d=t.l,u=t.d,h=t.m,f=t.n,m=8*n;do{if(!d){t.f=a=Fo(i,l,1);var p=Fo(i,l+1,3);if(l+=3,!p){var _=i[(g=ab(l)+4)-4]|i[g-3]<<8,v=g+_;if(v>n){if(s)throw"unexpected EOF";break}r&&o(c+_),e.set(i.subarray(g,v),c),t.b=c+=_,t.p=l=8*v;continue}if(1==p)d=gz,u=bz,h=9,f=5;else{if(2!=p)throw"invalid block type";var b=Fo(i,l,31)+257,y=Fo(i,l+10,15)+4,x=b+Fo(i,l+5,31)+1;l+=14;for(var C=new Xi(x),M=new Xi(19),w=0;w<y;++w)M[rb[w]]=Fo(i,l+3*w,7);l+=3*y;var E=aw(M),I=(1<<E)-1,F=Ha(M,E,1);for(w=0;w<x;){var g,Q=F[Fo(i,l,I)];if(l+=15&Q,(g=Q>>>4)<16)C[w++]=g;else{var B=0,L=0;for(16==g?(L=3+Fo(i,l,3),l+=2,B=C[w-1]):17==g?(L=3+Fo(i,l,7),l+=3):18==g&&(L=11+Fo(i,l,127),l+=7);L--;)C[w++]=B}}var X=C.subarray(0,b),P=C.subarray(b);h=aw(X),f=aw(P),d=Ha(X,h,1),u=Ha(P,f,1)}if(l>m){if(s)throw"unexpected EOF";break}}r&&o(c+131072);for(var V=(1<<h)-1,O=(1<<f)-1,q=l;;q=l){var ee=(B=d[lw(i,l)&V])>>>4;if((l+=15&B)>m){if(s)throw"unexpected EOF";break}if(!B)throw"invalid length/literal";if(ee<256)e[c++]=ee;else{if(256==ee){q=l,d=null;break}var Z=ee-254;ee>264&&(Z=Fo(i,l,(1<<(Y=Mp[w=ee-257]))-1)+xR[w],l+=Y);var he=u[lw(i,l)&O],J=he>>>4;if(!he)throw"invalid distance";if(l+=15&he,P=pz[J],J>3){var Y=Ep[J];P+=lw(i,l)&(1<<Y)-1,l+=Y}if(l>m){if(s)throw"unexpected EOF";break}r&&o(c+131072);for(var ae=c+Z;c<ae;c+=4)e[c]=e[c-P],e[c+1]=e[c+1-P],e[c+2]=e[c+2-P],e[c+3]=e[c+3-P];c=ae}}t.l=d,t.p=q,t.b=c,d&&(a=1,t.m=h,t.d=u,t.n=f)}while(!a);return c==e.length?e:function(i,e,t){(null==e||e<0)&&(e=0),(null==t||t>i.length)&&(t=i.length);var n=new(i instanceof Tr?Tr:i instanceof Tc?Tc:Xi)(t-e);return n.set(i.subarray(e,t)),n}(e,0,c)},hw=new Xi(0);function kc(i,e){return cw((function(i){if(8!=(15&i[0])||i[0]>>>4>7||(i[0]<<8|i[1])%31)throw"invalid zlib data";if(32&i[1])throw"invalid zlib data: preset dictionaries not supported"}(i),i.subarray(2,-4)),e)}var PR=typeof TextDecoder<"u"&&new TextDecoder;try{PR.decode(hw,{stream:!0})}catch{}function yw(i,e,t){const n=t.length-i-1;if(e>=t[n])return n-1;if(e<=t[i])return i;let r=i,s=n,o=Math.floor((r+s)/2);for(;e<t[o]||e>=t[o+1];)e<t[o]?s=o:r=o,o=Math.floor((r+s)/2);return o}function kpe(i,e){let t=1;for(let r=2;r<=i;++r)t*=r;let n=1;for(let r=2;r<=e;++r)n*=r;for(let r=2;r<=i-e;++r)n*=r;return t/n}class Lpe extends Co{constructor(e,t,n,r,s){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=r||0,this.endKnot=s||this.knots.length-1;for(let o=0;o<n.length;++o){const a=n[o];this.controlPoints[o]=new ni(a.x,a.y,a.z,a.w)}}getPoint(e,t=new T){const n=t,s=function Rpe(i,e,t,n){const r=yw(i,n,e),s=function kR(i,e,t,n){const r=[],s=[],o=[];r[0]=1;for(let a=1;a<=t;++a){s[a]=e-n[i+1-a],o[a]=n[i+a]-e;let l=0;for(let c=0;c<a;++c){const d=o[c+1],u=s[a-c],h=r[c]/(d+u);r[c]=l+d*h,l=u*h}r[a]=l}return r}(r,n,i,e),o=new ni(0,0,0,0);for(let a=0;a<=i;++a){const l=t[r-i+a],c=s[a],d=l.w*c;o.x+=l.x*d,o.y+=l.y*d,o.z+=l.z*d,o.w+=l.w*c}return o}(this.degree,this.knots,this.controlPoints,this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]));return 1!==s.w&&s.divideScalar(s.w),n.set(s.x,s.y,s.z)}getTangent(e,t=new T){const n=t,s=function Bpe(i,e,t,n,r){const s=function Ppe(i,e,t,n,r){const s=r<i?r:i,o=[],a=yw(i,n,e),l=function Dpe(i,e,t,n,r){const s=[];for(let u=0;u<=t;++u)s[u]=0;const o=[];for(let u=0;u<=n;++u)o[u]=s.slice(0);const a=[];for(let u=0;u<=t;++u)a[u]=s.slice(0);a[0][0]=1;const l=s.slice(0),c=s.slice(0);for(let u=1;u<=t;++u){l[u]=e-r[i+1-u],c[u]=r[i+u]-e;let h=0;for(let f=0;f<u;++f){const m=c[f+1],p=l[u-f];a[u][f]=m+p;const g=a[f][u-1]/a[u][f];a[f][u]=h+m*g,h=p*g}a[u][u]=h}for(let u=0;u<=t;++u)o[0][u]=a[u][t];for(let u=0;u<=t;++u){let h=0,f=1;const m=[];for(let p=0;p<=t;++p)m[p]=s.slice(0);m[0][0]=1;for(let p=1;p<=n;++p){let g=0;const _=u-p,v=t-p;u>=p&&(m[f][0]=m[h][0]/a[v+1][_],g=m[f][0]*a[_][v]);const y=u-1<=v?p-1:t-u;for(let C=_>=-1?1:-_;C<=y;++C)m[f][C]=(m[h][C]-m[h][C-1])/a[v+1][_+C],g+=m[f][C]*a[_+C][v];u<=v&&(m[f][p]=-m[h][p-1]/a[v+1][u],g+=m[f][p]*a[u][v]),o[p][u]=g;const x=h;h=f,f=x}}let d=t;for(let u=1;u<=n;++u){for(let h=0;h<=t;++h)o[u][h]*=d;d*=t-u}return o}(a,n,i,s,e),c=[];for(let d=0;d<t.length;++d){const u=t[d].clone(),h=u.w;u.x*=h,u.y*=h,u.z*=h,c[d]=u}for(let d=0;d<=s;++d){const u=c[a-i].clone().multiplyScalar(l[d][0]);for(let h=1;h<=i;++h)u.add(c[a-i+h].clone().multiplyScalar(l[d][h]));o[d]=u}for(let d=s+1;d<=r+1;++d)o[d]=new ni(0,0,0);return o}(i,e,t,n,r);return function Fpe(i){const e=i.length,t=[],n=[];for(let s=0;s<e;++s){const o=i[s];t[s]=new T(o.x,o.y,o.z),n[s]=o.w}const r=[];for(let s=0;s<e;++s){const o=t[s].clone();for(let a=1;a<=s;++a)o.sub(r[s-a].clone().multiplyScalar(kpe(s,a)*n[a]));r[s]=o.divideScalar(n[0])}return r}(s)}(this.degree,this.knots,this.controlPoints,this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),1);return n.copy(s[1]).normalize(),n}}let yi,Kn,Ps;class Ope extends yr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=""===s.path?Cs.extractUrlBase(e):s.path,a=new Ar(this.manager);a.setPath(s.path),a.setResponseType("arraybuffer"),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(l){try{t(s.parse(l,o))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},n,r)}parse(e,t){if(function Hpe(i){const e="Kaydara FBX Binary  \0";return i.byteLength>=e.length&&e===Hz(i,0,e.length)}(e))yi=(new zpe).parse(e);else{const r=Hz(e);if(!function Gpe(i){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let t=0;function n(r){const s=i[r-1];return i=i.slice(t+r),t++,s}for(let r=0;r<e.length;++r)if(n(1)===e[r])return!1;return!0}(r))throw new Error("THREE.FBXLoader: Unknown format.");if(Uz(r)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+Uz(r));yi=(new Vpe).parse(r)}const n=new bx(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new Npe(n,this.manager).parse(yi)}}class Npe{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){Kn=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),r=this.parseDeformers(),s=(new jpe).parse(r);return this.parseScene(r,s,n),Ps}parseConnections(){const e=new Map;return"Connections"in yi&&yi.Connections.connections.forEach(function(n){const r=n[0],s=n[1],o=n[2];e.has(r)||e.set(r,{parents:[],children:[]});const a={ID:s,relationship:o};e.get(r).parents.push(a),e.has(s)||e.set(s,{parents:[],children:[]});const l={ID:r,relationship:o};e.get(s).children.push(l)}),e}parseImages(){const e={},t={};if("Video"in yi.Objects){const n=yi.Objects.Video;for(const r in n){const s=n[r];if(e[parseInt(r)]=s.RelativeFilename||s.Filename,"Content"in s&&(s.Content instanceof ArrayBuffer&&s.Content.byteLength>0||"string"==typeof s.Content&&""!==s.Content)){const c=this.parseImage(n[r]);t[s.RelativeFilename||s.Filename]=c}}}for(const n in e){const r=e[n];e[n]=void 0!==t[r]?t[r]:e[n].split("\\").pop()}return e}parseImage(e){const t=e.Content,n=e.RelativeFilename||e.Filename,r=n.slice(n.lastIndexOf(".")+1).toLowerCase();let s;switch(r){case"bmp":s="image/bmp";break;case"jpg":case"jpeg":s="image/jpeg";break;case"png":s="image/png";break;case"tif":s="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),s="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+r+'" is not supported.')}if("string"==typeof t)return"data:"+s+";base64,"+t;{const o=new Uint8Array(t);return window.URL.createObjectURL(new Blob([o],{type:s}))}}parseTextures(e){const t=new Map;if("Texture"in yi.Objects){const n=yi.Objects.Texture;for(const r in n){const s=this.parseTexture(n[r],e);t.set(parseInt(r),s)}}return t}parseTexture(e,t){const n=this.loadTexture(e,t);n.ID=e.id,n.name=e.attrName;const r=e.WrapModeU,s=e.WrapModeV,a=void 0!==s?s.value:0;if(n.wrapS=0===(void 0!==r?r.value:0)?Ao:gr,n.wrapT=0===a?Ao:gr,"Scaling"in e){const l=e.Scaling.value;n.repeat.x=l[0],n.repeat.y=l[1]}if("Translation"in e){const l=e.Translation.value;n.offset.x=l[0],n.offset.y=l[1]}return n}loadTexture(e,t){let n;const r=this.textureLoader.path,s=Kn.get(e.id).children;let o;void 0!==s&&s.length>0&&void 0!==t[s[0].ID]&&(n=t[s[0].ID],(0===n.indexOf("blob:")||0===n.indexOf("data:"))&&this.textureLoader.setPath(void 0));const a=e.FileName.slice(-3).toLowerCase();if("tga"===a){const l=this.manager.getHandler(".tga");null===l?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),o=new qn):(l.setPath(this.textureLoader.path),o=l.load(n))}else"psd"===a?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),o=new qn):o=this.textureLoader.load(n);return this.textureLoader.setPath(r),o}parseMaterials(e){const t=new Map;if("Material"in yi.Objects){const n=yi.Objects.Material;for(const r in n){const s=this.parseMaterial(n[r],e);null!==s&&t.set(parseInt(r),s)}}return t}parseMaterial(e,t){const n=e.id,r=e.attrName;let s=e.ShadingModel;if("object"==typeof s&&(s=s.value),!Kn.has(n))return null;const o=this.parseParameters(e,t,n);let a;switch(s.toLowerCase()){case"phong":a=new nu;break;case"lambert":a=new gx;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',s),a=new nu}return a.setValues(o),a.name=r,a}parseParameters(e,t,n){const r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=(new De).fromArray(e.Diffuse.value):e.DiffuseColor&&("Color"===e.DiffuseColor.type||"ColorRGB"===e.DiffuseColor.type)&&(r.color=(new De).fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=(new De).fromArray(e.Emissive.value):e.EmissiveColor&&("Color"===e.EmissiveColor.type||"ColorRGB"===e.EmissiveColor.type)&&(r.emissive=(new De).fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(r.opacity=parseFloat(e.Opacity.value)),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=(new De).fromArray(e.Specular.value):e.SpecularColor&&"Color"===e.SpecularColor.type&&(r.specular=(new De).fromArray(e.SpecularColor.value));const s=this;return Kn.get(n).children.forEach(function(o){const a=o.relationship;switch(a){case"Bump":r.bumpMap=s.getTexture(t,o.ID);break;case"Maya|TEX_ao_map":r.aoMap=s.getTexture(t,o.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=s.getTexture(t,o.ID),void 0!==r.map&&(r.map.encoding=hi);break;case"DisplacementColor":r.displacementMap=s.getTexture(t,o.ID);break;case"EmissiveColor":r.emissiveMap=s.getTexture(t,o.ID),void 0!==r.emissiveMap&&(r.emissiveMap.encoding=hi);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=s.getTexture(t,o.ID);break;case"ReflectionColor":r.envMap=s.getTexture(t,o.ID),void 0!==r.envMap&&(r.envMap.mapping=hf,r.envMap.encoding=hi);break;case"SpecularColor":r.specularMap=s.getTexture(t,o.ID),void 0!==r.specularMap&&(r.specularMap.encoding=hi);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=s.getTexture(t,o.ID),r.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",a)}}),r}getTexture(e,t){return"LayeredTexture"in yi.Objects&&t in yi.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=Kn.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in yi.Objects){const n=yi.Objects.Deformer;for(const r in n){const s=n[r],o=Kn.get(parseInt(r));if("Skin"===s.attrType){const a=this.parseSkeleton(o,n);a.ID=r,o.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),a.geometryID=o.parents[0].ID,e[r]=a}else if("BlendShape"===s.attrType){const a={id:r};a.rawTargets=this.parseMorphTargets(o,n),a.id=r,o.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[r]=a}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const n=[];return e.children.forEach(function(r){const s=t[r.ID];if("Cluster"!==s.attrType)return;const o={ID:r.ID,indices:[],weights:[],transformLink:(new Ve).fromArray(s.TransformLink.a)};"Indexes"in s&&(o.indices=s.Indexes.a,o.weights=s.Weights.a),n.push(o)}),{rawBones:n,bones:[]}}parseMorphTargets(e,t){const n=[];for(let r=0;r<e.children.length;r++){const s=e.children[r],o=t[s.ID],a={name:o.attrName,initialWeight:o.DeformPercent,id:o.id,fullWeights:o.FullWeights.a};if("BlendShapeChannel"!==o.attrType)return;a.geoID=Kn.get(parseInt(s.ID)).children.filter(function(l){return void 0===l.relationship})[0].ID,n.push(a)}return n}parseScene(e,t,n){Ps=new xs;const r=this.parseModels(e.skeletons,t,n),s=yi.Objects.Model,o=this;r.forEach(function(l){o.setLookAtProperties(l,s[l.ID]),Kn.get(l.ID).parents.forEach(function(u){const h=r.get(u.ID);void 0!==h&&h.add(l)}),null===l.parent&&Ps.add(l)}),this.bindSkeleton(e.skeletons,t,r),this.createAmbientLight(),Ps.traverse(function(l){if(l.userData.transformData){l.parent&&(l.userData.transformData.parentMatrix=l.parent.matrix,l.userData.transformData.parentMatrixWorld=l.parent.matrixWorld);const c=Vz(l.userData.transformData);l.applyMatrix4(c),l.updateWorldMatrix()}});const a=(new Upe).parse();1===Ps.children.length&&Ps.children[0].isGroup&&(Ps.children[0].animations=a,Ps=Ps.children[0]),Ps.animations=a}parseModels(e,t,n){const r=new Map,s=yi.Objects.Model;for(const o in s){const a=parseInt(o),l=s[o],c=Kn.get(a);let d=this.buildSkeleton(c,e,a,l.attrName);if(!d){switch(l.attrType){case"Camera":d=this.createCamera(c);break;case"Light":d=this.createLight(c);break;case"Mesh":d=this.createMesh(c,t,n);break;case"NurbsCurve":d=this.createCurve(c,t);break;case"LimbNode":case"Root":d=new Kd;break;default:d=new xs}d.name=l.attrName?Oi.sanitizeNodeName(l.attrName):"",d.ID=a}this.getTransformData(d,l),r.set(a,d)}return r}buildSkeleton(e,t,n,r){let s=null;return e.parents.forEach(function(o){for(const a in t){const l=t[a];l.rawBones.forEach(function(c,d){if(c.ID===o.ID){const u=s;s=new Kd,s.matrixWorld.copy(c.transformLink),s.name=r?Oi.sanitizeNodeName(r):"",s.ID=n,l.bones[d]=s,null!==u&&s.add(u)}})}}),s}createCamera(e){let t,n;if(e.children.forEach(function(r){const s=yi.Objects.NodeAttribute[r.ID];void 0!==s&&(n=s)}),void 0===n)t=new wi;else{let r=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(r=1);let s=1;void 0!==n.NearPlane&&(s=n.NearPlane.value/1e3);let o=1e3;void 0!==n.FarPlane&&(o=n.FarPlane.value/1e3);let a=window.innerWidth,l=window.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(a=n.AspectWidth.value,l=n.AspectHeight.value);const c=a/l;let d=45;void 0!==n.FieldOfView&&(d=n.FieldOfView.value);const u=n.FocalLength?n.FocalLength.value:null;switch(r){case 0:t=new Sn(d,c,s,o),null!==u&&t.setFocalLength(u);break;case 1:t=new Pa(-a/2,a/2,l/2,-l/2,s,o);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+r+"."),t=new wi}}return t}createLight(e){let t,n;if(e.children.forEach(function(r){const s=yi.Objects.NodeAttribute[r.ID];void 0!==s&&(n=s)}),void 0===n)t=new wi;else{let r;r=void 0===n.LightType?0:n.LightType.value;let s=16777215;void 0!==n.Color&&(s=(new De).fromArray(n.Color.value));let o=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(o=0);let a=0;void 0!==n.FarAttenuationEnd&&(a=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);const l=1;switch(r){case 0:t=new dp(s,o,a,l);break;case 1:t=new M0(s,o);break;case 2:let c=Math.PI/3;void 0!==n.InnerAngle&&(c=gt.degToRad(n.InnerAngle.value));let d=0;void 0!==n.OuterAngle&&(d=gt.degToRad(n.OuterAngle.value),d=Math.max(d,1)),t=new w0(s,o,a,c,d,l);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),t=new dp(s,o)}void 0!==n.CastShadows&&1===n.CastShadows.value&&(t.castShadow=!0)}return t}createMesh(e,t,n){let r,s=null,o=null;const a=[];return e.children.forEach(function(l){t.has(l.ID)&&(s=t.get(l.ID)),n.has(l.ID)&&a.push(n.get(l.ID))}),a.length>1?o=a:a.length>0?o=a[0]:(o=new nu({color:13421772}),a.push(o)),"color"in s.attributes&&a.forEach(function(l){l.vertexColors=!0}),s.FBX_Deformer?(r=new f0(s,o),r.normalizeSkinWeights()):r=new Ke(s,o),r}createCurve(e,t){const n=e.children.reduce(function(s,o){return t.has(o.ID)&&(s=t.get(o.ID)),s},null),r=new pn({color:3342591,linewidth:1});return new Nn(n,r)}getTransformData(e,t){const n={};"InheritType"in t&&(n.inheritType=parseInt(t.InheritType.value)),n.eulerOrder="RotationOrder"in t?zz(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(n.translation=t.Lcl_Translation.value),"PreRotation"in t&&(n.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(n.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(n.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(n.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(n.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(n.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(n.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(n.rotationPivot=t.RotationPivot.value),e.userData.transformData=n}setLookAtProperties(e,t){"LookAtProperty"in t&&Kn.get(e.ID).children.forEach(function(r){if("LookAtProperty"===r.relationship){const s=yi.Objects.Model[r.ID];if("Lcl_Translation"in s){const o=s.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(o),Ps.add(e.target)):e.lookAt((new T).fromArray(o))}}})}bindSkeleton(e,t,n){const r=this.parsePoseNodes();for(const s in e){const o=e[s];Kn.get(parseInt(o.ID)).parents.forEach(function(l){t.has(l.ID)&&Kn.get(l.ID).parents.forEach(function(u){n.has(u.ID)&&n.get(u.ID).bind(new Xf(o.bones),r[u.ID])})})}}parsePoseNodes(){const e={};if("Pose"in yi.Objects){const t=yi.Objects.Pose;for(const n in t)if("BindPose"===t[n].attrType&&t[n].NbPoseNodes>0){const r=t[n].PoseNode;Array.isArray(r)?r.forEach(function(s){e[s.Node]=(new Ve).fromArray(s.Matrix.a)}):e[r.Node]=(new Ve).fromArray(r.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in yi&&"AmbientColor"in yi.GlobalSettings){const e=yi.GlobalSettings.AmbientColor.value,t=e[0],n=e[1],r=e[2];if(0!==t||0!==n||0!==r){const s=new De(t,n,r);Ps.add(new vx(s,1))}}}}class jpe{constructor(){this.negativeMaterialIndices=!1}parse(e){const t=new Map;if("Geometry"in yi.Objects){const n=yi.Objects.Geometry;for(const r in n){const s=Kn.get(parseInt(r)),o=this.parseGeometry(s,n[r],e);t.set(parseInt(r),o)}}return!0===this.negativeMaterialIndices&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),t}parseGeometry(e,t,n){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,n);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,n){const r=n.skeletons,s=[],o=e.parents.map(function(u){return yi.Objects.Model[u.ID]});if(0===o.length)return;const a=e.children.reduce(function(u,h){return void 0!==r[h.ID]&&(u=r[h.ID]),u},null);e.children.forEach(function(u){void 0!==n.morphTargets[u.ID]&&s.push(n.morphTargets[u.ID])});const l=o[0],c={};"RotationOrder"in l&&(c.eulerOrder=zz(l.RotationOrder.value)),"InheritType"in l&&(c.inheritType=parseInt(l.InheritType.value)),"GeometricTranslation"in l&&(c.translation=l.GeometricTranslation.value),"GeometricRotation"in l&&(c.rotation=l.GeometricRotation.value),"GeometricScaling"in l&&(c.scale=l.GeometricScaling.value);const d=Vz(c);return this.genGeometry(t,a,s,d)}genGeometry(e,t,n,r){const s=new xt;e.attrName&&(s.name=e.attrName);const o=this.parseGeoNode(e,t),a=this.genBuffers(o),l=new Ge(a.vertex,3);if(l.applyMatrix4(r),s.setAttribute("position",l),a.colors.length>0&&s.setAttribute("color",new Ge(a.colors,3)),t&&(s.setAttribute("skinIndex",new kA(a.weightsIndices,4)),s.setAttribute("skinWeight",new Ge(a.vertexWeights,4)),s.FBX_Deformer=t),a.normal.length>0){const c=(new Xr).getNormalMatrix(r),d=new Ge(a.normal,3);d.applyNormalMatrix(c),s.setAttribute("normal",d)}if(a.uvs.forEach(function(c,d){let u="uv"+(d+1).toString();0===d&&(u="uv"),s.setAttribute(u,new Ge(a.uvs[d],2))}),o.material&&"AllSame"!==o.material.mappingType){let c=a.materialIndex[0],d=0;if(a.materialIndex.forEach(function(u,h){u!==c&&(s.addGroup(d,h-d,c),c=u,d=h)}),s.groups.length>0){const u=s.groups[s.groups.length-1],h=u.start+u.count;h!==a.materialIndex.length&&s.addGroup(h,a.materialIndex.length-h,c)}0===s.groups.length&&s.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(s,e,n,r),s}parseGeoNode(e,t){const n={};if(n.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],n.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(n.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(n.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){n.uv=[];let r=0;for(;e.LayerElementUV[r];)e.LayerElementUV[r].UV&&n.uv.push(this.parseUVs(e.LayerElementUV[r])),r++}return n.weightTable={},null!==t&&(n.skeleton=t,t.rawBones.forEach(function(r,s){r.indices.forEach(function(o,a){void 0===n.weightTable[o]&&(n.weightTable[o]=[]),n.weightTable[o].push({id:s,weight:r.weights[a]})})})),n}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,r=0,s=!1,o=[],a=[],l=[],c=[],d=[],u=[];const h=this;return e.vertexIndices.forEach(function(f,m){let p,g=!1;f<0&&(f^=-1,g=!0);let _=[],v=[];if(o.push(3*f,3*f+1,3*f+2),e.color){const b=Aw(m,n,f,e.color);l.push(b[0],b[1],b[2])}if(e.skeleton){if(void 0!==e.weightTable[f]&&e.weightTable[f].forEach(function(b){v.push(b.weight),_.push(b.id)}),v.length>4){s||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),s=!0);const b=[0,0,0,0],y=[0,0,0,0];v.forEach(function(x,C){let M=x,w=_[C];y.forEach(function(E,I,F){if(M>E){F[I]=M,M=E;const Q=b[I];b[I]=w,w=Q}})}),_=b,v=y}for(;v.length<4;)v.push(0),_.push(0);for(let b=0;b<4;++b)d.push(v[b]),u.push(_[b])}if(e.normal){const b=Aw(m,n,f,e.normal);a.push(b[0],b[1],b[2])}e.material&&"AllSame"!==e.material.mappingType&&(p=Aw(m,n,f,e.material)[0],p<0&&(h.negativeMaterialIndices=!0,p=0)),e.uv&&e.uv.forEach(function(b,y){const x=Aw(m,n,f,b);void 0===c[y]&&(c[y]=[]),c[y].push(x[0]),c[y].push(x[1])}),r++,g&&(r>4&&console.warn("THREE.FBXLoader: Polygons with more than four sides are not supported. Make sure to triangulate the geometry during export."),h.genFace(t,e,o,p,a,l,c,d,u,r),n++,r=0,o=[],a=[],l=[],c=[],d=[],u=[])}),t}genFace(e,t,n,r,s,o,a,l,c,d){for(let u=2;u<d;u++)e.vertex.push(t.vertexPositions[n[0]]),e.vertex.push(t.vertexPositions[n[1]]),e.vertex.push(t.vertexPositions[n[2]]),e.vertex.push(t.vertexPositions[n[3*(u-1)]]),e.vertex.push(t.vertexPositions[n[3*(u-1)+1]]),e.vertex.push(t.vertexPositions[n[3*(u-1)+2]]),e.vertex.push(t.vertexPositions[n[3*u]]),e.vertex.push(t.vertexPositions[n[3*u+1]]),e.vertex.push(t.vertexPositions[n[3*u+2]]),t.skeleton&&(e.vertexWeights.push(l[0]),e.vertexWeights.push(l[1]),e.vertexWeights.push(l[2]),e.vertexWeights.push(l[3]),e.vertexWeights.push(l[4*(u-1)]),e.vertexWeights.push(l[4*(u-1)+1]),e.vertexWeights.push(l[4*(u-1)+2]),e.vertexWeights.push(l[4*(u-1)+3]),e.vertexWeights.push(l[4*u]),e.vertexWeights.push(l[4*u+1]),e.vertexWeights.push(l[4*u+2]),e.vertexWeights.push(l[4*u+3]),e.weightsIndices.push(c[0]),e.weightsIndices.push(c[1]),e.weightsIndices.push(c[2]),e.weightsIndices.push(c[3]),e.weightsIndices.push(c[4*(u-1)]),e.weightsIndices.push(c[4*(u-1)+1]),e.weightsIndices.push(c[4*(u-1)+2]),e.weightsIndices.push(c[4*(u-1)+3]),e.weightsIndices.push(c[4*u]),e.weightsIndices.push(c[4*u+1]),e.weightsIndices.push(c[4*u+2]),e.weightsIndices.push(c[4*u+3])),t.color&&(e.colors.push(o[0]),e.colors.push(o[1]),e.colors.push(o[2]),e.colors.push(o[3*(u-1)]),e.colors.push(o[3*(u-1)+1]),e.colors.push(o[3*(u-1)+2]),e.colors.push(o[3*u]),e.colors.push(o[3*u+1]),e.colors.push(o[3*u+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(s[0]),e.normal.push(s[1]),e.normal.push(s[2]),e.normal.push(s[3*(u-1)]),e.normal.push(s[3*(u-1)+1]),e.normal.push(s[3*(u-1)+2]),e.normal.push(s[3*u]),e.normal.push(s[3*u+1]),e.normal.push(s[3*u+2])),t.uv&&t.uv.forEach(function(h,f){void 0===e.uvs[f]&&(e.uvs[f]=[]),e.uvs[f].push(a[f][0]),e.uvs[f].push(a[f][1]),e.uvs[f].push(a[f][2*(u-1)]),e.uvs[f].push(a[f][2*(u-1)+1]),e.uvs[f].push(a[f][2*u]),e.uvs[f].push(a[f][2*u+1])})}addMorphTargets(e,t,n,r){if(0===n.length)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const s=this;n.forEach(function(o){o.rawTargets.forEach(function(a){const l=yi.Objects.Geometry[a.geoID];void 0!==l&&s.genMorphGeometry(e,t,l,r,a.name)})})}genMorphGeometry(e,t,n,r,s){const o=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],a=void 0!==n.Vertices?n.Vertices.a:[],l=void 0!==n.Indexes?n.Indexes.a:[],d=new Float32Array(3*e.attributes.position.count);for(let m=0;m<l.length;m++){const p=3*l[m];d[p]=a[3*m],d[p+1]=a[3*m+1],d[p+2]=a[3*m+2]}const h=this.genBuffers({vertexIndices:o,vertexPositions:d}),f=new Ge(h.vertex,3);f.name=s||n.attrName,f.applyMatrix4(r),e.morphAttributes.position.push(f)}parseNormals(e){const n=e.ReferenceInformationType;let s=[];return"IndexToDirect"===n&&("NormalIndex"in e?s=e.NormalIndex.a:"NormalsIndex"in e&&(s=e.NormalsIndex.a)),{dataSize:3,buffer:e.Normals.a,indices:s,mappingType:e.MappingInformationType,referenceType:n}}parseUVs(e){const n=e.ReferenceInformationType;let s=[];return"IndexToDirect"===n&&(s=e.UVIndex.a),{dataSize:2,buffer:e.UV.a,indices:s,mappingType:e.MappingInformationType,referenceType:n}}parseVertexColors(e){const n=e.ReferenceInformationType;let s=[];return"IndexToDirect"===n&&(s=e.ColorIndex.a),{dataSize:4,buffer:e.Colors.a,indices:s,mappingType:e.MappingInformationType,referenceType:n}}parseMaterialIndices(e){const t=e.MappingInformationType,n=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const r=e.Materials.a,s=[];for(let o=0;o<r.length;++o)s.push(o);return{dataSize:1,buffer:r,indices:s,mappingType:t,referenceType:n}}parseNurbsGeometry(e){const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new xt;const n=t-1,r=e.KnotVector.a,s=[],o=e.Points.a;for(let u=0,h=o.length;u<h;u+=4)s.push((new ni).fromArray(o,u));let a,l;if("Closed"===e.Form)s.push(s[0]);else if("Periodic"===e.Form){a=n,l=r.length-1-a;for(let u=0;u<n;++u)s.push(s[u])}const d=new Lpe(n,r,s,a,l).getPoints(12*s.length);return(new xt).setFromPoints(d)}}class Upe{parse(){const e=[],t=this.parseClips();if(void 0!==t)for(const n in t){const s=this.addClip(t[n]);e.push(s)}return e}parseClips(){if(void 0===yi.Objects.AnimationCurve)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=yi.Objects.AnimationCurveNode,t=new Map;for(const n in e){const r=e[n];if(null!==r.attrName.match(/S|R|T|DeformPercent/)){const s={id:r.id,attr:r.attrName,curves:{}};t.set(s.id,s)}}return t}parseAnimationCurves(e){const t=yi.Objects.AnimationCurve;for(const n in t){const r={id:t[n].id,times:t[n].KeyTime.a.map(Qpe),values:t[n].KeyValueFloat.a},s=Kn.get(r.id);if(void 0!==s){const o=s.parents[0].ID,a=s.parents[0].relationship;a.match(/X/)?e.get(o).curves.x=r:a.match(/Y/)?e.get(o).curves.y=r:a.match(/Z/)?e.get(o).curves.z=r:a.match(/d|DeformPercent/)&&e.has(o)&&(e.get(o).curves.morph=r)}}}parseAnimationLayers(e){const t=yi.Objects.AnimationLayer,n=new Map;for(const r in t){const s=[],o=Kn.get(parseInt(r));void 0!==o&&(o.children.forEach(function(l,c){if(e.has(l.ID)){const d=e.get(l.ID);if(void 0!==d.curves.x||void 0!==d.curves.y||void 0!==d.curves.z){if(void 0===s[c]){const u=Kn.get(l.ID).parents.filter(function(h){return void 0!==h.relationship})[0].ID;if(void 0!==u){const h=yi.Objects.Model[u.toString()];if(void 0===h)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",l);const f={modelName:h.attrName?Oi.sanitizeNodeName(h.attrName):"",ID:h.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Ps.traverse(function(m){m.ID===h.id&&(f.transform=m.matrix,m.userData.transformData&&(f.eulerOrder=m.userData.transformData.eulerOrder))}),f.transform||(f.transform=new Ve),"PreRotation"in h&&(f.preRotation=h.PreRotation.value),"PostRotation"in h&&(f.postRotation=h.PostRotation.value),s[c]=f}}s[c]&&(s[c][d.attr]=d)}else if(void 0!==d.curves.morph){if(void 0===s[c]){const u=Kn.get(l.ID).parents.filter(function(_){return void 0!==_.relationship})[0].ID,h=Kn.get(u).parents[0].ID,f=Kn.get(h).parents[0].ID,m=Kn.get(f).parents[0].ID,p=yi.Objects.Model[m],g={modelName:p.attrName?Oi.sanitizeNodeName(p.attrName):"",morphName:yi.Objects.Deformer[u].attrName};s[c]=g}s[c][d.attr]=d}}}),n.set(parseInt(r),s))}return n}parseAnimStacks(e){const t=yi.Objects.AnimationStack,n={};for(const r in t){const s=Kn.get(parseInt(r)).children;s.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const o=e.get(s[0].ID);n[r]={name:t[r].attrName,layer:o}}return n}addClip(e){let t=[];const n=this;return e.layer.forEach(function(r){t=t.concat(n.generateTracks(r))}),new cu(e.name,-1,t)}generateTracks(e){const t=[];let n=new T,r=new xi,s=new T;if(e.transform&&e.transform.decompose(n,r,s),n=n.toArray(),r=(new $s).setFromQuaternion(r,e.eulerOrder).toArray(),s=s.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");void 0!==o&&t.push(o)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){const o=this.generateRotationTrack(e.modelName,e.R.curves,r,e.preRotation,e.postRotation,e.eulerOrder);void 0!==o&&t.push(o)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.S.curves,s,"scale");void 0!==o&&t.push(o)}if(void 0!==e.DeformPercent){const o=this.generateMorphTrack(e);void 0!==o&&t.push(o)}return t}generateVectorTrack(e,t,n,r){const s=this.getTimesForAllAxes(t),o=this.getKeyframeTrackValues(s,t,n);return new lu(e+"."+r,s,o)}generateRotationTrack(e,t,n,r,s,o){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(gt.degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(gt.degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(gt.degToRad));const a=this.getTimesForAllAxes(t),l=this.getKeyframeTrackValues(a,t,n);void 0!==r&&((r=r.map(gt.degToRad)).push(o),r=(new $s).fromArray(r),r=(new xi).setFromEuler(r)),void 0!==s&&((s=s.map(gt.degToRad)).push(o),s=(new $s).fromArray(s),s=(new xi).setFromEuler(s).invert());const c=new xi,d=new $s,u=[];for(let h=0;h<l.length;h+=3)d.set(l[h],l[h+1],l[h+2],o),c.setFromEuler(d),void 0!==r&&c.premultiply(r),void 0!==s&&c.multiply(s),c.toArray(u,h/3*4);return new Sl(e+".quaternion",a,u)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,n=t.values.map(function(s){return s/100}),r=Ps.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new ou(e.modelName+".morphTargetInfluences["+r+"]",t.times,n)}getTimesForAllAxes(e){let t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort(function(n,r){return n-r}),t.length>1){let n=1,r=t[0];for(let s=1;s<t.length;s++){const o=t[s];o!==r&&(t[n]=o,r=o,n++)}t=t.slice(0,n)}return t}getKeyframeTrackValues(e,t,n){const r=n,s=[];let o=-1,a=-1,l=-1;return e.forEach(function(c){if(t.x&&(o=t.x.times.indexOf(c)),t.y&&(a=t.y.times.indexOf(c)),t.z&&(l=t.z.times.indexOf(c)),-1!==o){const d=t.x.values[o];s.push(d),r[0]=d}else s.push(r[0]);if(-1!==a){const d=t.y.values[a];s.push(d),r[1]=d}else s.push(r[1]);if(-1!==l){const d=t.z.values[l];s.push(d),r[2]=d}else s.push(r[2])}),s}interpolateRotations(e){for(let t=1;t<e.values.length;t++){const n=e.values[t-1],r=e.values[t]-n,s=Math.abs(r);if(s>=180){const o=s/180,a=r/o;let l=n+a;const c=e.times[t-1],u=(e.times[t]-c)/o;let h=c+u;const f=[],m=[];for(;h<e.times[t];)f.push(h),h+=u,m.push(l),l+=a;e.times=Gz(e.times,t,f),e.values=Gz(e.values,t,m)}}}}class Vpe{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new jz,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,n=e.split(/[\r\n]+/);return n.forEach(function(r,s){const o=r.match(/^[\s\t]*;/),a=r.match(/^[\s\t]*$/);if(o||a)return;const l=r.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),c=r.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),d=r.match("^\\t{"+(t.currentIndent-1)+"}}");l?t.parseNodeBegin(r,l):c?t.parseNodeProperty(r,c,n[++s]):d?t.popStack():r.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(r)}),this.allNodes}parseNodeBegin(e,t){const n=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map(function(l){return l.trim().replace(/^"/,"").replace(/"$/,"")}),s={name:n},o=this.parseNodeAttr(r),a=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(n,s):n in a?("PoseNode"===n?a.PoseNode.push(s):void 0!==a[n].id&&(a[n]={},a[n][a[n].id]=a[n]),""!==o.id&&(a[n][o.id]=s)):"number"==typeof o.id?(a[n]={},a[n][o.id]=s):"Properties70"!==n&&(a[n]="PoseNode"===n?[s]:s),"number"==typeof o.id&&(s.id=o.id),""!==o.name&&(s.attrName=o.name),""!==o.type&&(s.attrType=o.type),this.pushStack(s)}parseNodeAttr(e){let t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let n="",r="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:n,type:r}}parseNodeProperty(e,t,n){let r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),s=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===r&&","===s&&(s=n.replace(/"/g,"").replace(/,$/,"").trim());const o=this.getCurrentNode();if("Properties70"!==o.name){if("C"===r){const l=s.split(",").slice(1),c=parseInt(l[0]),d=parseInt(l[1]);let u=s.split(",").slice(3);u=u.map(function(h){return h.trim().replace(/^"/,"")}),r="connections",s=[c,d],function qpe(i,e){for(let t=0,n=i.length,r=e.length;t<r;t++,n++)i[n]=e[t]}(s,u),void 0===o[r]&&(o[r]=[])}"Node"===r&&(o.id=s),r in o&&Array.isArray(o[r])?o[r].push(s):"a"!==r?o[r]=s:o.a=s,this.setCurrentProp(o,r),"a"===r&&","!==s.slice(-1)&&(o.a=BR(s))}else this.parseNodeSpecialProperty(e,r,s)}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=BR(t.a))}parseNodeSpecialProperty(e,t,n){const r=n.split('",').map(function(d){return d.trim().replace(/^\"/,"").replace(/\s/,"_")}),s=r[0],o=r[1],a=r[2],l=r[3];let c=r[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":c=parseFloat(c);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":c=BR(c)}this.getPrevNode()[s]={type:o,type2:a,flag:l,value:c},this.setCurrentProp(this.getPrevNode(),s)}}class zpe{parse(e){const t=new Nz(e);t.skip(23);const n=t.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const r=new jz;for(;!this.endOfContent(t);){const s=this.parseNode(t,n);null!==s&&r.add(s.name,s)}return r}endOfContent(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const n={},r=t>=7500?e.getUint64():e.getUint32(),s=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const o=e.getUint8(),a=e.getString(o);if(0===r)return null;const l=[];for(let h=0;h<s;h++)l.push(this.parseProperty(e));const c=l.length>0?l[0]:"",d=l.length>1?l[1]:"",u=l.length>2?l[2]:"";for(n.singleProperty=1===s&&e.getOffset()===r;r>e.getOffset();){const h=this.parseNode(e,t);null!==h&&this.parseSubNode(a,n,h)}return n.propertyList=l,"number"==typeof c&&(n.id=c),""!==d&&(n.attrName=d),""!==u&&(n.attrType=u),""!==a&&(n.name=a),n}parseSubNode(e,t,n){if(!0===n.singleProperty){const r=n.propertyList[0];Array.isArray(r)?(t[n.name]=n,n.a=r):t[n.name]=r}else if("Connections"===e&&"C"===n.name){const r=[];n.propertyList.forEach(function(s,o){0!==o&&r.push(s)}),void 0===t.connections&&(t.connections=[]),t.connections.push(r)}else if("Properties70"===n.name)Object.keys(n).forEach(function(s){t[s]=n[s]});else if("Properties70"===e&&"P"===n.name){let r=n.propertyList[0],s=n.propertyList[1];const o=n.propertyList[2],a=n.propertyList[3];let l;0===r.indexOf("Lcl ")&&(r=r.replace("Lcl ","Lcl_")),0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),l="Color"===s||"ColorRGB"===s||"Vector"===s||"Vector3D"===s||0===s.indexOf("Lcl_")?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],t[r]={type:s,type2:o,flag:a,value:l}}else void 0===t[n.name]?"number"==typeof n.id?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:"PoseNode"===n.name?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):void 0===t[n.name][n.id]&&(t[n.name][n.id]=n)}parseProperty(e){const t=e.getString(1);let n;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return n=e.getUint32(),e.getArrayBuffer(n);case"S":return n=e.getUint32(),e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const r=e.getUint32(),s=e.getUint32(),o=e.getUint32();if(0===s)switch(t){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}const a=kc(new Uint8Array(e.getArrayBuffer(o))),l=new Nz(a.buffer);switch(t){case"b":case"c":return l.getBooleanArray(r);case"d":return l.getFloat64Array(r);case"f":return l.getFloat32Array(r);case"i":return l.getInt32Array(r);case"l":return l.getInt64Array(r)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class Nz{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return 1==(1&this.getUint8())}getBooleanArray(e){const t=[];for(let n=0;n<e;n++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,e=4294967295&~e,4294967295===e&&(t=t+1&4294967295),e=e+1&4294967295,-(4294967296*t+e)):4294967296*t+e}getInt64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){let t=[];for(let r=0;r<e;r++)t[r]=this.getUint8();const n=t.indexOf(0);return n>=0&&(t=t.slice(0,n)),Cs.decodeText(new Uint8Array(t))}}class jz{add(e,t){this[e]=t}}function Uz(i){const t=i.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function Qpe(i){return i/46186158e3}const Wpe=[];function Aw(i,e,t,n){let r;switch(n.mappingType){case"ByPolygonVertex":r=i;break;case"ByPolygon":r=e;break;case"ByVertice":r=t;break;case"AllSame":r=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}"IndexToDirect"===n.referenceType&&(r=n.indices[r]);const s=r*n.dataSize;return function Xpe(i,e,t,n){for(let r=t,s=0;r<n;r++,s++)i[s]=e[r];return i}(Wpe,n.buffer,s,s+n.dataSize)}const FR=new $s,Rp=new T;function Vz(i){const e=new Ve,t=new Ve,n=new Ve,r=new Ve,s=new Ve,o=new Ve,a=new Ve,l=new Ve,c=new Ve,d=new Ve,u=new Ve,h=new Ve,f=i.inheritType?i.inheritType:0;if(i.translation&&e.setPosition(Rp.fromArray(i.translation)),i.preRotation){const I=i.preRotation.map(gt.degToRad);I.push(i.eulerOrder||$s.DefaultOrder),t.makeRotationFromEuler(FR.fromArray(I))}if(i.rotation){const I=i.rotation.map(gt.degToRad);I.push(i.eulerOrder||$s.DefaultOrder),n.makeRotationFromEuler(FR.fromArray(I))}if(i.postRotation){const I=i.postRotation.map(gt.degToRad);I.push(i.eulerOrder||$s.DefaultOrder),r.makeRotationFromEuler(FR.fromArray(I)),r.invert()}i.scale&&s.scale(Rp.fromArray(i.scale)),i.scalingOffset&&a.setPosition(Rp.fromArray(i.scalingOffset)),i.scalingPivot&&o.setPosition(Rp.fromArray(i.scalingPivot)),i.rotationOffset&&l.setPosition(Rp.fromArray(i.rotationOffset)),i.rotationPivot&&c.setPosition(Rp.fromArray(i.rotationPivot)),i.parentMatrixWorld&&(u.copy(i.parentMatrix),d.copy(i.parentMatrixWorld));const m=t.clone().multiply(n).multiply(r),p=new Ve;p.extractRotation(d);const g=new Ve;g.copyPosition(d);const _=g.clone().invert().multiply(d),v=p.clone().invert().multiply(_),b=s,y=new Ve;if(0===f)y.copy(p).multiply(m).multiply(v).multiply(b);else if(1===f)y.copy(p).multiply(v).multiply(m).multiply(b);else{const F=(new Ve).scale((new T).setFromMatrixScale(u)).clone().invert(),Q=v.clone().multiply(F);y.copy(p).multiply(m).multiply(Q).multiply(b)}const x=c.clone().invert(),C=o.clone().invert();let M=e.clone().multiply(l).multiply(c).multiply(t).multiply(n).multiply(r).multiply(x).multiply(a).multiply(o).multiply(s).multiply(C);const w=(new Ve).copyPosition(M),E=d.clone().multiply(w);return h.copyPosition(E),M=h.clone().multiply(y),M.premultiply(d.invert()),M}function zz(i){const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(i=i||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[i]}function BR(i){return i.split(",").map(function(t){return parseFloat(t)})}function Hz(i,e,t){return void 0===e&&(e=0),void 0===t&&(t=i.byteLength),Cs.decodeText(new Uint8Array(i,e,t))}function Gz(i,e,t){return i.slice(0,e).concat(t).concat(i.slice(e))}class Fc extends Na{constructor(){super(...arguments),this.clazz=Ope}}Fc.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Fc)))(t||Fc)}}(),Fc.\u0275prov=Ne({token:Fc,factory:Fc.\u0275fac,providedIn:"root"});class xw extends Rx{constructor(e){super(),this.service=e}}xw.\u0275fac=function(e){return new(e||xw)(R(Fc,16))},xw.\u0275pipe=gi({name:"loadFBX",type:xw,pure:!0});class ww extends _u{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}getRefFromResponse(e){return e}}ww.\u0275fac=function(e){return new(e||ww)(R(Ye,1),R(at),R(Fc))},ww.\u0275dir=ke({type:ww,selectors:[["","loadFBX",""]],features:[W]});const Zr={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor.a *= opacity;\n\n\n\t\t}"};class vn{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const Ype=new Pa(-1,1,1,-1,0,1),LR=new xt;LR.setAttribute("position",new Ge([-1,3,0,-1,-1,0,3,-1,0],3)),LR.setAttribute("uv",new Ge([0,2,0,0,2,0],2));class wr{constructor(e){this._mesh=new Ke(LR,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,Ype)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class OR extends vn{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof Rt?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=mi.clone(e.uniforms),this.material=new Rt({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new wr(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class NR extends vn{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){const r=e.getContext(),s=e.state;let o,a;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0),this.inverse?(o=0,a=1):(o=1,a=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),s.buffers.stencil.setClear(a),s.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}}class Qz extends vn{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class Zpe{constructor(e,t){if(this.renderer=e,void 0===t){const n=e.getSize(new ue);this._pixelRatio=e.getPixelRatio(),this._width=n.width,this._height=n.height,(t=new Gt(this._width*this._pixelRatio,this._height*this._pixelRatio)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new OR(Zr),this.clock=new up}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let n=!1;for(let r=0,s=this.passes.length;r<s;r++){const o=this.passes[r];if(!1!==o.enabled){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),o.needsSwap){if(n){const a=this.renderer.getContext(),l=this.renderer.state.buffers.stencil;l.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),l.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==NR&&(o instanceof NR?n=!0:o instanceof Qz&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new ue);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class Dp extends Eo{getType(){return Zpe}set renderer(e){this._objRef&&(this._objRef.renderer=e)}set renderTarget1(e){this._objRef&&(this._objRef.renderTarget1=e)}set renderTarget2(e){this._objRef&&(this._objRef.renderTarget2=e)}set writeBuffer(e){this._objRef&&(this._objRef.writeBuffer=e)}set readBuffer(e){this._objRef&&(this._objRef.readBuffer=e)}set passes(e){this._objRef&&(this._objRef.passes=e)}set copyPass(e){this._objRef&&(this._objRef.copyPass=e)}set clock(e){this._objRef&&(this._objRef.clock=e)}set renderToScreen(e){this._objRef&&(this._objRef.renderToScreen=e)}}Dp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Dp)))(t||Dp)}}(),Dp.\u0275cmp=$({type:Dp,selectors:[["th-effectComposerGen"]],inputs:{renderer:"renderer",renderTarget1:"renderTarget1",renderTarget2:"renderTarget2",writeBuffer:"writeBuffer",readBuffer:"readBuffer",passes:"passes",copyPass:"copyPass",clock:"clock",renderToScreen:"renderToScreen"},features:[se([]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Ol extends Dp{constructor(e,t){super(),this.view=e,this.engineService=t}createThreeInstance(e){return e||(e=new Array(5)),e[0]=e[0]??this.engineService.renderer,e[1]=e[1]??this.initRenderTarget(),super.createThreeInstance(e)}initRenderTarget(){if(this.view.viewPort){let e,t;return this.view.viewPort instanceof ni?(e=this.view.viewPort.z,t=this.view.viewPort?.width):(e=this.view.viewPort.width,t=this.view.viewPort.height),new Gt(e,t)}}addToParent(){this._objRef&&(this.view.effectComposer=this._objRef)}removeFromParent(){this.view.effectComposer=void 0}}Ol.\u0275fac=function(e){return new(e||Ol)(R(Is),R(To))},Ol.\u0275cmp=$({type:Ol,selectors:[["th-effectComposer"]],features:[se([]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Pi extends Eo{constructor(e){super(),this.effectComposer=e}addToParent(){this._objRef&&this.effectComposer&&this.effectComposer.objRef&&this.effectComposer.objRef.addPass(this._objRef)}removeFromParent(){this._objRef&&this.effectComposer&&this.effectComposer.objRef&&this.effectComposer.objRef.removePass(this._objRef)}}Pi.\u0275fac=function(e){return new(e||Pi)(R(Ol,8))},Pi.\u0275cmp=$({type:Pi,selectors:[["th-abs-control"]],features:[W],decls:0,vars:0,template:function(e,t){},encapsulation:2});class Kpe extends vn{constructor(e,t,n,r,s){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=void 0!==s?s:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new De}render(e,t,n){const r=e.autoClear;let s,o;e.autoClear=!1,void 0!==this.overrideMaterial&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),s=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,s),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=o),e.autoClear=r}}class Hi extends Pi{getType(){return vn}set enabled(e){this._objRef&&(this._objRef.enabled=e)}set needsSwap(e){this._objRef&&(this._objRef.needsSwap=e)}set clear(e){this._objRef&&(this._objRef.clear=e)}set renderToScreen(e){this._objRef&&(this._objRef.renderToScreen=e)}}Hi.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Hi)))(t||Hi)}}(),Hi.\u0275cmp=$({type:Hi,selectors:[["th-pass"]],inputs:{enabled:"enabled",needsSwap:"needsSwap",clear:"clear",renderToScreen:"renderToScreen"},features:[se([{provide:Pi,useExisting:le(()=>Hi)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Tu extends Hi{getType(){return Kpe}set scene(e){this._objRef&&(this._objRef.scene=e)}set camera(e){this._objRef&&(this._objRef.camera=e)}set overrideMaterial(e){this._objRef&&(this._objRef.overrideMaterial=e)}set clearColor(e){this._objRef&&(this._objRef.clearColor=Qe(this._objRef.clearColor,e))}set clearAlpha(e){this._objRef&&(this._objRef.clearAlpha=e)}set clearDepth(e){this._objRef&&(this._objRef.clearDepth=e)}}Tu.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Tu)))(t||Tu)}}(),Tu.\u0275cmp=$({type:Tu,selectors:[["th-renderPassGen"]],inputs:{scene:"scene",camera:"camera",overrideMaterial:"overrideMaterial",clearColor:"clearColor",clearAlpha:"clearAlpha",clearDepth:"clearDepth"},features:[se([{provide:Pi,useExisting:le(()=>Tu)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Bc extends Tu{constructor(e,t){super(e),this.effectComposer=e,this.view=t}createThreeInstance(e){return e||(e=new Array(5)),e[0]=e[0]??this.view.scene,e[1]=e[1]??this.view.camera,e[2]=e[2]??this.overrideMaterial,e[3]=e[3]??this.clearColor,e[4]=e[4]??this.clearAlpha,super.createThreeInstance(e)}ngAfterContentChecked(){this._objRef&&(this.view.scene&&this.view.scene.objRef&&(this._objRef.scene=this.view.scene.objRef),this.view.camera&&this.view.camera.objRef&&(this._objRef.camera=this.view.camera.objRef))}}Bc.\u0275fac=function(e){return new(e||Bc)(R(Ol),R(Is))},Bc.\u0275cmp=$({type:Bc,selectors:[["th-renderPass"]],features:[se([{provide:Pi,useExisting:le(()=>Bc)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const Iu=new gu,ks=new T,Lc=new T,yn=new xi,Wz={X:new T(1,0,0),Y:new T(0,1,0),Z:new T(0,0,1)},jR={type:"change"},qz={type:"mouseDown"},Xz={type:"mouseUp",mode:null},Yz={type:"objectChange"};class Zz extends wi{constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const n=new nme;this._gizmo=n,this.add(n);const r=new rme;this._plane=r,this.add(r);const s=this;function o(v,b){let y=b;Object.defineProperty(s,v,{get:function(){return void 0!==y?y:b},set:function(x){y!==x&&(y=x,r[v]=x,n[v]=x,s.dispatchEvent({type:v+"-changed",value:x}),s.dispatchEvent(jR))}}),s[v]=b,r[v]=b,n[v]=b}o("camera",e),o("object",void 0),o("enabled",!0),o("axis",null),o("mode","translate"),o("translationSnap",null),o("rotationSnap",null),o("scaleSnap",null),o("space","world"),o("size",1),o("dragging",!1),o("showX",!0),o("showY",!0),o("showZ",!0);const a=new T,l=new T,c=new xi,d=new xi,u=new T,h=new xi,f=new T,m=new T,p=new T,_=new T;o("worldPosition",a),o("worldPositionStart",l),o("worldQuaternion",c),o("worldQuaternionStart",d),o("cameraPosition",u),o("cameraQuaternion",h),o("pointStart",f),o("pointEnd",m),o("rotationAxis",p),o("rotationAngle",0),o("eye",_),this._offset=new T,this._startNorm=new T,this._endNorm=new T,this._cameraScale=new T,this._parentPosition=new T,this._parentQuaternion=new xi,this._parentQuaternionInv=new xi,this._parentScale=new T,this._worldScaleStart=new T,this._worldQuaternionInv=new xi,this._worldScale=new T,this._positionStart=new T,this._quaternionStart=new xi,this._scaleStart=new T,this._getPointer=$pe.bind(this),this._onPointerDown=eme.bind(this),this._onPointerHover=Jpe.bind(this),this._onPointerMove=tme.bind(this),this._onPointerUp=ime.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;Iu.setFromCamera(e,this.camera);const t=UR(this._gizmo.picker[this.mode],Iu);this.axis=t?t.object.name:null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){Iu.setFromCamera(e,this.camera);const t=UR(this._plane,Iu,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,qz.mode=this.mode,this.dispatchEvent(qz)}}pointerMove(e){const t=this.axis,n=this.mode,r=this.object;let s=this.space;if("scale"===n?s="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(s="world"),void 0===r||null===t||!1===this.dragging||-1!==e.button)return;Iu.setFromCamera(e,this.camera);const o=UR(this._plane,Iu,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),"translate"===n)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===s&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===s&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),r.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===s&&(r.position.applyQuaternion(yn.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this._quaternionStart)),"world"===s&&(r.parent&&r.position.add(ks.setFromMatrixPosition(r.parent.matrixWorld)),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(ks.setFromMatrixPosition(r.parent.matrixWorld))));else if("scale"===n){if(-1!==t.search("XYZ")){let a=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(a*=-1),Lc.set(a,a,a)}else ks.copy(this.pointStart),Lc.copy(this.pointEnd),ks.applyQuaternion(this._worldQuaternionInv),Lc.applyQuaternion(this._worldQuaternionInv),Lc.divide(ks),-1===t.search("X")&&(Lc.x=1),-1===t.search("Y")&&(Lc.y=1),-1===t.search("Z")&&(Lc.z=1);r.scale.copy(this._scaleStart).multiply(Lc),this.scaleSnap&&(-1!==t.search("X")&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===n){this._offset.copy(this.pointEnd).sub(this.pointStart);const a=20/this.worldPosition.distanceTo(ks.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(ks.copy(this.rotationAxis).cross(this.eye))*a):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(Wz[t]),ks.copy(Wz[t]),"local"===s&&ks.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(ks.cross(this.eye).normalize())*a),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===s&&"E"!==t&&"XYZE"!==t?(r.quaternion.copy(this._quaternionStart),r.quaternion.multiply(yn.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),r.quaternion.copy(yn.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(jR),this.dispatchEvent(Yz)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(Xz.mode=this.mode,this.dispatchEvent(Xz)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(jR),this.dispatchEvent(Yz),this.pointStart.copy(this.pointEnd))}getRaycaster(){return Iu}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}}function $pe(i){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:i.button};{const e=this.domElement.getBoundingClientRect();return{x:(i.clientX-e.left)/e.width*2-1,y:-(i.clientY-e.top)/e.height*2+1,button:i.button}}}function Jpe(i){if(this.enabled)switch(i.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(i))}}function eme(i){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(i)),this.pointerDown(this._getPointer(i)))}function tme(i){this.enabled&&this.pointerMove(this._getPointer(i))}function ime(i){this.enabled&&(this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(i)))}function UR(i,e,t){const n=e.intersectObject(i,!0);for(let r=0;r<n.length;r++)if(n[r].object.visible||t)return n[r];return!1}const Cw=new $s,$i=new T(0,1,0),Kz=new T(0,0,0),$z=new Ve,Mw=new xi,Ew=new xi,Qa=new T,Jz=new Ve,ub=new T(1,0,0),Ru=new T(0,1,0),hb=new T(0,0,1),Sw=new T,fb=new T,pb=new T;class nme extends wi{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new Xn({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new pn({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),n=e.clone();n.opacity=.15;const r=t.clone();r.opacity=.5;const s=e.clone();s.color.setHex(16711680);const o=e.clone();o.color.setHex(65280);const a=e.clone();a.color.setHex(255);const l=e.clone();l.color.setHex(16711680),l.opacity=.5;const c=e.clone();c.color.setHex(65280),c.opacity=.5;const d=e.clone();d.color.setHex(255),d.opacity=.5;const u=e.clone();u.opacity=.25;const h=e.clone();h.color.setHex(16776960),h.opacity=.25,e.clone().color.setHex(16776960);const m=e.clone();m.color.setHex(7895160);const p=new jn(0,.04,.1,12);p.translate(0,.05,0);const g=new Ki(.08,.08,.08);g.translate(0,.04,0);const _=new xt;_.setAttribute("position",new Ge([0,0,0,1,0,0],3));const v=new jn(.0075,.0075,.5,3);function b(X,P){const V=new na(X,.0075,3,64,P*Math.PI*2);return V.rotateY(Math.PI/2),V.rotateX(Math.PI/2),V}v.translate(0,.25,0);const x={X:[[new Ke(p,s),[.5,0,0],[0,0,-Math.PI/2]],[new Ke(p,s),[-.5,0,0],[0,0,Math.PI/2]],[new Ke(v,s),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new Ke(p,o),[0,.5,0]],[new Ke(p,o),[0,-.5,0],[Math.PI,0,0]],[new Ke(v,o)]],Z:[[new Ke(p,a),[0,0,.5],[Math.PI/2,0,0]],[new Ke(p,a),[0,0,-.5],[-Math.PI/2,0,0]],[new Ke(v,a),null,[Math.PI/2,0,0]]],XYZ:[[new Ke(new ia(.1,0),u.clone()),[0,0,0]]],XY:[[new Ke(new Ki(.15,.15,.01),d.clone()),[.15,.15,0]]],YZ:[[new Ke(new Ki(.15,.15,.01),l.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Ke(new Ki(.15,.15,.01),c.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},C={X:[[new Ke(new jn(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new Ke(new jn(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Ke(new jn(.2,0,.6,4),n),[0,.3,0]],[new Ke(new jn(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Ke(new jn(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new Ke(new jn(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new Ke(new ia(.2,0),n)]],XY:[[new Ke(new Ki(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new Ke(new Ki(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Ke(new Ki(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]]},M={START:[[new Ke(new ia(.01,2),r),null,null,null,"helper"]],END:[[new Ke(new ia(.01,2),r),null,null,null,"helper"]],DELTA:[[new Nn(function y(){const X=new xt;return X.setAttribute("position",new Ge([0,0,0,1,1,1],3)),X}(),r),null,null,null,"helper"]],X:[[new Nn(_,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Nn(_,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Nn(_,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},w={XYZE:[[new Ke(b(.5,1),m),null,[0,Math.PI/2,0]]],X:[[new Ke(b(.5,.5),s)]],Y:[[new Ke(b(.5,.5),o),null,[0,0,-Math.PI/2]]],Z:[[new Ke(b(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new Ke(b(.75,1),h),null,[0,Math.PI/2,0]]]},E={AXIS:[[new Nn(_,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},I={XYZE:[[new Ke(new vc(.25,10,8),n)]],X:[[new Ke(new na(.5,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new Ke(new na(.5,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new Ke(new na(.5,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new Ke(new na(.75,.1,2,24),n)]]},F={X:[[new Ke(g,s),[.5,0,0],[0,0,-Math.PI/2]],[new Ke(v,s),[0,0,0],[0,0,-Math.PI/2]],[new Ke(g,s),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new Ke(g,o),[0,.5,0]],[new Ke(v,o)],[new Ke(g,o),[0,-.5,0],[0,0,Math.PI]]],Z:[[new Ke(g,a),[0,0,.5],[Math.PI/2,0,0]],[new Ke(v,a),[0,0,0],[Math.PI/2,0,0]],[new Ke(g,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new Ke(new Ki(.15,.15,.01),d),[.15,.15,0]]],YZ:[[new Ke(new Ki(.15,.15,.01),l),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Ke(new Ki(.15,.15,.01),c),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Ke(new Ki(.1,.1,.1),u.clone())]]},Q={X:[[new Ke(new jn(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new Ke(new jn(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Ke(new jn(.2,0,.6,4),n),[0,.3,0]],[new Ke(new jn(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Ke(new jn(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new Ke(new jn(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new Ke(new Ki(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new Ke(new Ki(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Ke(new Ki(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Ke(new Ki(.2,.2,.2),n),[0,0,0]]]},B={X:[[new Nn(_,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Nn(_,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Nn(_,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function L(X){const P=new wi;for(const V in X)for(let O=X[V].length;O--;){const q=X[V][O][0].clone(),ee=X[V][O][1],Z=X[V][O][2],Y=X[V][O][3],he=X[V][O][4];q.name=V,q.tag=he,ee&&q.position.set(ee[0],ee[1],ee[2]),Z&&q.rotation.set(Z[0],Z[1],Z[2]),Y&&q.scale.set(Y[0],Y[1],Y[2]),q.updateMatrix();const J=q.geometry.clone();J.applyMatrix4(q.matrix),q.geometry=J,q.renderOrder=1/0,q.position.set(0,0,0),q.rotation.set(0,0,0),q.scale.set(1,1,1),P.add(q)}return P}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=L(x)),this.add(this.gizmo.rotate=L(w)),this.add(this.gizmo.scale=L(F)),this.add(this.picker.translate=L(C)),this.add(this.picker.rotate=L(I)),this.add(this.picker.scale=L(Q)),this.add(this.helper.translate=L(M)),this.add(this.helper.rotate=L(E)),this.add(this.helper.scale=L(B)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const n="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:Ew;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let r=[];r=r.concat(this.picker[this.mode].children),r=r.concat(this.gizmo[this.mode].children),r=r.concat(this.helper[this.mode].children);for(let s=0;s<r.length;s++){const o=r[s];let a;o.visible=!0,o.rotation.set(0,0,0),o.position.copy(this.worldPosition),a=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),o.scale.set(1,1,1).multiplyScalar(a*this.size/4),"helper"!==o.tag?(o.quaternion.copy(n),"translate"===this.mode||"scale"===this.mode?("X"===o.name&&Math.abs($i.copy(ub).applyQuaternion(n).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Y"===o.name&&Math.abs($i.copy(Ru).applyQuaternion(n).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Z"===o.name&&Math.abs($i.copy(hb).applyQuaternion(n).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XY"===o.name&&Math.abs($i.copy(hb).applyQuaternion(n).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"YZ"===o.name&&Math.abs($i.copy(ub).applyQuaternion(n).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XZ"===o.name&&Math.abs($i.copy(Ru).applyQuaternion(n).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1)):"rotate"===this.mode&&(Mw.copy(n),$i.copy(this.eye).applyQuaternion(yn.copy(n).invert()),-1!==o.name.search("E")&&o.quaternion.setFromRotationMatrix($z.lookAt(this.eye,Kz,Ru)),"X"===o.name&&(yn.setFromAxisAngle(ub,Math.atan2(-$i.y,$i.z)),yn.multiplyQuaternions(Mw,yn),o.quaternion.copy(yn)),"Y"===o.name&&(yn.setFromAxisAngle(Ru,Math.atan2($i.x,$i.z)),yn.multiplyQuaternions(Mw,yn),o.quaternion.copy(yn)),"Z"===o.name&&(yn.setFromAxisAngle(hb,Math.atan2($i.y,$i.x)),yn.multiplyQuaternions(Mw,yn),o.quaternion.copy(yn))),o.visible=o.visible&&(-1===o.name.indexOf("X")||this.showX),o.visible=o.visible&&(-1===o.name.indexOf("Y")||this.showY),o.visible=o.visible&&(-1===o.name.indexOf("Z")||this.showZ),o.visible=o.visible&&(-1===o.name.indexOf("E")||this.showX&&this.showY&&this.showZ),o.material._color=o.material._color||o.material.color.clone(),o.material._opacity=o.material._opacity||o.material.opacity,o.material.color.copy(o.material._color),o.material.opacity=o.material._opacity,this.enabled&&this.axis&&(o.name===this.axis||this.axis.split("").some(function(l){return o.name===l}))&&(o.material.color.setHex(16776960),o.material.opacity=1)):(o.visible=!1,"AXIS"===o.name?(o.visible=!!this.axis,"X"===this.axis&&(yn.setFromEuler(Cw.set(0,0,0)),o.quaternion.copy(n).multiply(yn),Math.abs($i.copy(ub).applyQuaternion(n).dot(this.eye))>.9&&(o.visible=!1)),"Y"===this.axis&&(yn.setFromEuler(Cw.set(0,0,Math.PI/2)),o.quaternion.copy(n).multiply(yn),Math.abs($i.copy(Ru).applyQuaternion(n).dot(this.eye))>.9&&(o.visible=!1)),"Z"===this.axis&&(yn.setFromEuler(Cw.set(0,Math.PI/2,0)),o.quaternion.copy(n).multiply(yn),Math.abs($i.copy(hb).applyQuaternion(n).dot(this.eye))>.9&&(o.visible=!1)),"XYZE"===this.axis&&(yn.setFromEuler(Cw.set(0,Math.PI/2,0)),$i.copy(this.rotationAxis),o.quaternion.setFromRotationMatrix($z.lookAt(Kz,$i,Ru)),o.quaternion.multiply(yn),o.visible=this.dragging),"E"===this.axis&&(o.visible=!1)):"START"===o.name?(o.position.copy(this.worldPositionStart),o.visible=this.dragging):"END"===o.name?(o.position.copy(this.worldPosition),o.visible=this.dragging):"DELTA"===o.name?(o.position.copy(this.worldPositionStart),o.quaternion.copy(this.worldQuaternionStart),ks.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),ks.applyQuaternion(this.worldQuaternionStart.clone().invert()),o.scale.copy(ks),o.visible=this.dragging):(o.quaternion.copy(n),o.position.copy(this.dragging?this.worldPositionStart:this.worldPosition),this.axis&&(o.visible=-1!==this.axis.search(o.name))))}super.updateMatrixWorld(e)}}class rme extends Ke{constructor(){super(new gc(1e5,1e5,2,2),new Xn({visible:!1,wireframe:!0,side:rc,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),Sw.copy(ub).applyQuaternion("local"===t?this.worldQuaternion:Ew),fb.copy(Ru).applyQuaternion("local"===t?this.worldQuaternion:Ew),pb.copy(hb).applyQuaternion("local"===t?this.worldQuaternion:Ew),$i.copy(fb),this.mode){case"translate":case"scale":switch(this.axis){case"X":$i.copy(this.eye).cross(Sw),Qa.copy(Sw).cross($i);break;case"Y":$i.copy(this.eye).cross(fb),Qa.copy(fb).cross($i);break;case"Z":$i.copy(this.eye).cross(pb),Qa.copy(pb).cross($i);break;case"XY":Qa.copy(pb);break;case"YZ":Qa.copy(Sw);break;case"XZ":$i.copy(pb),Qa.copy(fb);break;case"XYZ":case"E":Qa.set(0,0,0)}break;default:Qa.set(0,0,0)}0===Qa.length()?this.quaternion.copy(this.cameraQuaternion):(Jz.lookAt(ks.set(0,0,0),Qa,$i),this.quaternion.setFromRotationMatrix(Jz)),super.updateMatrixWorld(e)}}class Du extends zn{getType(){return Zz}set domElement(e){this._objRef&&(this._objRef.domElement=e)}set camera(e){this._objRef&&(this._objRef.camera=e)}set object(e){this._objRef&&(this._objRef.object=e)}set enabled(e){this._objRef&&(this._objRef.enabled=e)}set axis(e){this._objRef&&(this._objRef.axis=e)}set mode(e){this._objRef&&(this._objRef.mode=e)}set translationSnap(e){this._objRef&&(this._objRef.translationSnap=e)}set rotationSnap(e){this._objRef&&(this._objRef.rotationSnap=e)}set space(e){this._objRef&&(this._objRef.space=e)}set size(e){this._objRef&&(this._objRef.size=e)}set dragging(e){this._objRef&&(this._objRef.dragging=e)}set showX(e){this._objRef&&(this._objRef.showX=e)}set showY(e){this._objRef&&(this._objRef.showY=e)}set showZ(e){this._objRef&&(this._objRef.showZ=e)}set mouseButtons(e){this._objRef&&(this._objRef.mouseButtons=e)}}Du.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Du)))(t||Du)}}(),Du.\u0275cmp=$({type:Du,selectors:[["th-transformControlsGen"]],inputs:{domElement:"domElement",camera:"camera",object:"object",enabled:"enabled",axis:"axis",mode:"mode",translationSnap:"translationSnap",rotationSnap:"rotationSnap",space:"space",size:"size",dragging:"dragging",showX:"showX",showY:"showY",showZ:"showZ",mouseButtons:"mouseButtons"},features:[se([{provide:zn,useExisting:le(()=>Du)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Pu extends Du{getType(){return Zz}set object(e){this._objRef&&(this._objRef.object=e,e?this._objRef.attach(e):this._objRef.detach())}addToParent(){this._objRef&&this.canvas?.scene?.objRef?.add(this._objRef)}removeFromParent(){this._objRef&&this.canvas?.scene?.objRef?.remove(this._objRef)}}Pu.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Pu)))(t||Pu)}}(),Pu.\u0275cmp=$({type:Pu,selectors:[["th-transformControls"]],inputs:{object:"object"},features:[se([{provide:zn,useExisting:le(()=>Pu)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const VR_uniforms={tDiffuse:{value:null}},VR_vertexShader="\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",VR_fragmentShader="\n\n\t\t#include <common>\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tfloat l = luminance( texel.rgb );\n\n\t\t\tgl_FragColor = vec4( l, l, l, texel.w );\n\n\t\t}",zR_uniforms={tDiffuse:{value:null},averageLuminance:{value:1},luminanceMap:{value:null},maxLuminance:{value:16},minLuminance:{value:.01},middleGrey:{value:.6}},zR_vertexShader="\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",zR_fragmentShader="\n\n\t\t#include <common>\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tuniform float middleGrey;\n\t\tuniform float minLuminance;\n\t\tuniform float maxLuminance;\n\t\t#ifdef ADAPTED_LUMINANCE\n\t\t\tuniform sampler2D luminanceMap;\n\t\t#else\n\t\t\tuniform float averageLuminance;\n\t\t#endif\n\n\t\tvec3 ToneMap( vec3 vColor ) {\n\t\t\t#ifdef ADAPTED_LUMINANCE\n\t\t\t\t// Get the calculated average luminance\n\t\t\t\tfloat fLumAvg = texture2D(luminanceMap, vec2(0.5, 0.5)).r;\n\t\t\t#else\n\t\t\t\tfloat fLumAvg = averageLuminance;\n\t\t\t#endif\n\n\t\t\t// Calculate the luminance of the current pixel\n\t\t\tfloat fLumPixel = luminance( vColor );\n\n\t\t\t// Apply the modified operator (Eq. 4)\n\t\t\tfloat fLumScaled = (fLumPixel * middleGrey) / max( minLuminance, fLumAvg );\n\n\t\t\tfloat fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (maxLuminance * maxLuminance)))) / (1.0 + fLumScaled);\n\t\t\treturn fLumCompressed * vColor;\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tgl_FragColor = vec4( ToneMap( texel.xyz ), texel.w );\n\n\t\t}";class sme extends vn{constructor(e,t){super(),this.resolution=void 0!==t?t:256,this.needsInit=!0,this.adaptive=void 0===e||!!e,this.luminanceRT=null,this.previousLuminanceRT=null,this.currentLuminanceRT=null;const n=Zr;this.copyUniforms=mi.clone(n.uniforms),this.materialCopy=new Rt({uniforms:this.copyUniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,blending:Kt,depthTest:!1}),this.materialLuminance=new Rt({uniforms:mi.clone(VR_uniforms),vertexShader:VR_vertexShader,fragmentShader:VR_fragmentShader,blending:Kt}),this.adaptLuminanceShader={defines:{MIP_LEVEL_1X1:(Math.log(this.resolution)/Math.log(2)).toFixed(1)},uniforms:{lastLum:{value:null},currentLum:{value:null},minLuminance:{value:.01},delta:{value:.016},tau:{value:1}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D lastLum;\n\t\t\t\tuniform sampler2D currentLum;\n\t\t\t\tuniform float minLuminance;\n\t\t\t\tuniform float delta;\n\t\t\t\tuniform float tau;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec4 lastLum = texture2D( lastLum, vUv, MIP_LEVEL_1X1 );\n\t\t\t\t\tvec4 currentLum = texture2D( currentLum, vUv, MIP_LEVEL_1X1 );\n\n\t\t\t\t\tfloat fLastLum = max( minLuminance, lastLum.r );\n\t\t\t\t\tfloat fCurrentLum = max( minLuminance, currentLum.r );\n\n\t\t\t\t\t//The adaption seems to work better in extreme lighting differences\n\t\t\t\t\t//if the input luminance is squared.\n\t\t\t\t\tfCurrentLum *= fCurrentLum;\n\n\t\t\t\t\t// Adapt the luminance using Pattanaik's technique\n\t\t\t\t\tfloat fAdaptedLum = fLastLum + (fCurrentLum - fLastLum) * (1.0 - exp(-delta * tau));\n\t\t\t\t\t// \"fAdaptedLum = sqrt(fAdaptedLum);\n\t\t\t\t\tgl_FragColor.r = fAdaptedLum;\n\t\t\t\t}"},this.materialAdaptiveLum=new Rt({uniforms:mi.clone(this.adaptLuminanceShader.uniforms),vertexShader:this.adaptLuminanceShader.vertexShader,fragmentShader:this.adaptLuminanceShader.fragmentShader,defines:Object.assign({},this.adaptLuminanceShader.defines),blending:Kt}),this.materialToneMap=new Rt({uniforms:mi.clone(zR_uniforms),vertexShader:zR_vertexShader,fragmentShader:zR_fragmentShader,blending:Kt}),this.fsQuad=new wr(null)}render(e,t,n,r){this.needsInit&&(this.reset(e),this.luminanceRT.texture.type=n.texture.type,this.previousLuminanceRT.texture.type=n.texture.type,this.currentLuminanceRT.texture.type=n.texture.type,this.needsInit=!1),this.adaptive&&(this.fsQuad.material=this.materialLuminance,this.materialLuminance.uniforms.tDiffuse.value=n.texture,e.setRenderTarget(this.currentLuminanceRT),this.fsQuad.render(e),this.fsQuad.material=this.materialAdaptiveLum,this.materialAdaptiveLum.uniforms.delta.value=r,this.materialAdaptiveLum.uniforms.lastLum.value=this.previousLuminanceRT.texture,this.materialAdaptiveLum.uniforms.currentLum.value=this.currentLuminanceRT.texture,e.setRenderTarget(this.luminanceRT),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.luminanceRT.texture,e.setRenderTarget(this.previousLuminanceRT),this.fsQuad.render(e)),this.fsQuad.material=this.materialToneMap,this.materialToneMap.uniforms.tDiffuse.value=n.texture,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}reset(){this.luminanceRT&&this.luminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.luminanceRT=new Gt(this.resolution,this.resolution),this.luminanceRT.texture.name="AdaptiveToneMappingPass.l",this.luminanceRT.texture.generateMipmaps=!1,this.previousLuminanceRT=new Gt(this.resolution,this.resolution),this.previousLuminanceRT.texture.name="AdaptiveToneMappingPass.pl",this.previousLuminanceRT.texture.generateMipmaps=!1,this.currentLuminanceRT=new Gt(this.resolution,this.resolution,{minFilter:Xs,generateMipmaps:!0}),this.currentLuminanceRT.texture.name="AdaptiveToneMappingPass.cl",this.adaptive&&(this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture),this.fsQuad.material=new Xn({color:7829367}),this.materialLuminance.needsUpdate=!0,this.materialAdaptiveLum.needsUpdate=!0,this.materialToneMap.needsUpdate=!0}setAdaptive(e){e?(this.adaptive=!0,this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture):(this.adaptive=!1,delete this.materialToneMap.defines.ADAPTED_LUMINANCE,this.materialToneMap.uniforms.luminanceMap.value=null),this.materialToneMap.needsUpdate=!0}setAdaptionRate(e){e&&(this.materialAdaptiveLum.uniforms.tau.value=Math.abs(e))}setMinLuminance(e){e&&(this.materialToneMap.uniforms.minLuminance.value=e,this.materialAdaptiveLum.uniforms.minLuminance.value=e)}setMaxLuminance(e){e&&(this.materialToneMap.uniforms.maxLuminance.value=e)}setAverageLuminance(e){e&&(this.materialToneMap.uniforms.averageLuminance.value=e)}setMiddleGrey(e){e&&(this.materialToneMap.uniforms.middleGrey.value=e)}dispose(){this.luminanceRT&&this.luminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.materialLuminance&&this.materialLuminance.dispose(),this.materialAdaptiveLum&&this.materialAdaptiveLum.dispose(),this.materialCopy&&this.materialCopy.dispose(),this.materialToneMap&&this.materialToneMap.dispose()}}class Pp extends Hi{getType(){return sme}set adaptive(e){this._objRef&&(this._objRef.adaptive=e)}set resolution(e){this._objRef&&(this._objRef.resolution=e)}set needsInit(e){this._objRef&&(this._objRef.needsInit=e)}set luminanceRT(e){this._objRef&&(this._objRef.luminanceRT=e)}set previousLuminanceRT(e){this._objRef&&(this._objRef.previousLuminanceRT=e)}set currentLuminanceRT(e){this._objRef&&(this._objRef.currentLuminanceRT=e)}set copyUniforms(e){this._objRef&&(this._objRef.copyUniforms=e)}set materialCopy(e){this._objRef&&(this._objRef.materialCopy=e)}set materialLuminance(e){this._objRef&&(this._objRef.materialLuminance=e)}set adaptLuminanceShader(e){this._objRef&&(this._objRef.adaptLuminanceShader=e)}set materialAdaptiveLum(e){this._objRef&&(this._objRef.materialAdaptiveLum=e)}set materialToneMap(e){this._objRef&&(this._objRef.materialToneMap=e)}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}}Pp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Pp)))(t||Pp)}}(),Pp.\u0275cmp=$({type:Pp,selectors:[["th-adaptiveToneMappingPass"]],inputs:{adaptive:"adaptive",resolution:"resolution",needsInit:"needsInit",luminanceRT:"luminanceRT",previousLuminanceRT:"previousLuminanceRT",currentLuminanceRT:"currentLuminanceRT",copyUniforms:"copyUniforms",materialCopy:"materialCopy",materialLuminance:"materialLuminance",adaptLuminanceShader:"adaptLuminanceShader",materialAdaptiveLum:"materialAdaptiveLum",materialToneMap:"materialToneMap",fsQuad:"fsQuad"},features:[se([{provide:Pi,useExisting:le(()=>Pp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const ome={uniforms:{damp:{value:.96},tOld:{value:null},tNew:{value:null}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float damp;\n\n\t\tuniform sampler2D tOld;\n\t\tuniform sampler2D tNew;\n\n\t\tvarying vec2 vUv;\n\n\t\tvec4 when_gt( vec4 x, float y ) {\n\n\t\t\treturn max( sign( x - y ), 0.0 );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvec4 texelOld = texture2D( tOld, vUv );\n\t\t\tvec4 texelNew = texture2D( tNew, vUv );\n\n\t\t\ttexelOld *= damp * when_gt( texelOld, 0.1 );\n\n\t\t\tgl_FragColor = max(texelNew, texelOld);\n\n\t\t}"};class ame extends vn{constructor(e=.96){super(),this.shader=ome,this.uniforms=mi.clone(this.shader.uniforms),this.uniforms.damp.value=e,this.textureComp=new Gt(window.innerWidth,window.innerHeight,{magFilter:$t}),this.textureOld=new Gt(window.innerWidth,window.innerHeight,{magFilter:$t}),this.compFsMaterial=new Rt({uniforms:this.uniforms,vertexShader:this.shader.vertexShader,fragmentShader:this.shader.fragmentShader}),this.compFsQuad=new wr(this.compFsMaterial),this.copyFsMaterial=new Xn,this.copyFsQuad=new wr(this.copyFsMaterial)}render(e,t,n){this.uniforms.tOld.value=this.textureOld.texture,this.uniforms.tNew.value=n.texture,e.setRenderTarget(this.textureComp),this.compFsQuad.render(e),this.copyFsQuad.material.map=this.textureComp.texture,this.renderToScreen?(e.setRenderTarget(null),this.copyFsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.copyFsQuad.render(e));const r=this.textureOld;this.textureOld=this.textureComp,this.textureComp=r}setSize(e,t){this.textureComp.setSize(e,t),this.textureOld.setSize(e,t)}dispose(){this.textureComp.dispose(),this.textureOld.dispose(),this.compFsMaterial.dispose(),this.copyFsMaterial.dispose(),this.compFsQuad.dispose(),this.copyFsQuad.dispose()}}class kp extends Hi{getType(){return ame}set shader(e){this._objRef&&(this._objRef.shader=e)}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}set textureComp(e){this._objRef&&(this._objRef.textureComp=e)}set textureOld(e){this._objRef&&(this._objRef.textureOld=e)}set shaderMaterial(e){this._objRef&&(this._objRef.shaderMaterial=e)}set compFsQuad(e){this._objRef&&(this._objRef.compFsQuad=e)}set copyFsQuad(e){this._objRef&&(this._objRef.copyFsQuad=e)}}kp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(kp)))(t||kp)}}(),kp.\u0275cmp=$({type:kp,selectors:[["th-afterimagePass"]],inputs:{shader:"shader",uniforms:"uniforms",textureComp:"textureComp",textureOld:"textureOld",shaderMaterial:"shaderMaterial",compFsQuad:"compFsQuad",copyFsQuad:"copyFsQuad"},features:[se([{provide:Pi,useExisting:le(()=>kp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Oc extends Ss{getType(){return E0}set type(e){this._objRef&&(this._objRef.type=e)}set sh(e){this._objRef&&(this._objRef.sh=Qe(this._objRef.sh,e))}}Oc.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Oc)))(t||Oc)}}(),Oc.\u0275cmp=$({type:Oc,selectors:[["th-lightProbe"]],inputs:{type:"type",sh:"sh"},features:[se([{provide:Ye,useExisting:le(()=>Oc)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Fp extends Oc{getType(){return y4}}function mb(i){return(mb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(i)}function _t(i,e,t){return(e=function cme(i){var e=function lme(i,e){if("object"!==mb(i)||null===i)return i;var t=i[Symbol.toPrimitive];if(void 0!==t){var n=t.call(i,e||"default");if("object"!==mb(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(i)}(i,"string");return"symbol"===mb(e)?e:String(e)}(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}Fp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Fp)))(t||Fp)}}(),Fp.\u0275cmp=$({type:Fp,selectors:[["th-ambientLightProbe"]],features:[se([{provide:Ye,useExisting:le(()=>Fp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const Dt={IDLE:Symbol(),ROTATE:Symbol(),PAN:Symbol(),SCALE:Symbol(),FOV:Symbol(),FOCUS:Symbol(),ZROTATE:Symbol(),TOUCH_MULTI:Symbol(),ANIMATION_FOCUS:Symbol(),ANIMATION_ROTATE:Symbol()},Gi={NONE:Symbol(),ONE_FINGER:Symbol(),ONE_FINGER_SWITCHED:Symbol(),TWO_FINGER:Symbol(),MULT_FINGER:Symbol(),CURSOR:Symbol()},ri={x:0,y:0},oo={camera:new Ve,gizmos:new Ve},sn={type:"change"},da={type:"start"},Bo={type:"end"},dme=new gu,or=new T,eH=new Ve,tH=new Ve,ua=new T;class ume extends os{constructor(e,t,n=null){super(),_t(this,"onWindowResize",()=>{const r=(this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3;this._tbRadius=this.calculateTbRadius(this.camera);const s=this._tbRadius/r,a=new bc(0,0,s,s).getPoints(this._curvePts),l=(new xt).setFromPoints(a);for(const c in this._gizmos.children)this._gizmos.children[c].geometry=l;this.dispatchEvent(sn)}),_t(this,"onContextMenu",r=>{if(this.enabled)for(let s=0;s<this.mouseActions.length;s++)if(2==this.mouseActions[s].mouse){r.preventDefault();break}}),_t(this,"onPointerCancel",()=>{this._touchStart.splice(0,this._touchStart.length),this._touchCurrent.splice(0,this._touchCurrent.length),this._input=Gi.NONE}),_t(this,"onPointerDown",r=>{if(0==r.button&&r.isPrimary?(this._downValid=!0,this._downEvents.push(r),this._downStart=performance.now()):this._downValid=!1,"touch"==r.pointerType&&this._input!=Gi.CURSOR)switch(this._touchStart.push(r),this._touchCurrent.push(r),this._input){case Gi.NONE:this._input=Gi.ONE_FINGER,this.onSinglePanStart(r,"ROTATE"),window.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerup",this.onPointerUp);break;case Gi.ONE_FINGER:case Gi.ONE_FINGER_SWITCHED:this._input=Gi.TWO_FINGER,this.onRotateStart(),this.onPinchStart(),this.onDoublePanStart();break;case Gi.TWO_FINGER:this._input=Gi.MULT_FINGER,this.onTriplePanStart(r)}else if("touch"!=r.pointerType&&this._input==Gi.NONE){let s=null;r.ctrlKey||r.metaKey?s="CTRL":r.shiftKey&&(s="SHIFT"),this._mouseOp=this.getOpFromAction(r.button,s),null!=this._mouseOp&&(window.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerup",this.onPointerUp),this._input=Gi.CURSOR,this._button=r.button,this.onSinglePanStart(r,this._mouseOp))}}),_t(this,"onPointerMove",r=>{if("touch"==r.pointerType&&this._input!=Gi.CURSOR)switch(this._input){case Gi.ONE_FINGER:this.updateTouchEvent(r),this.onSinglePanMove(r,Dt.ROTATE);break;case Gi.ONE_FINGER_SWITCHED:if(this.calculatePointersDistance(this._touchCurrent[0],r)*this._devPxRatio>=this._switchSensibility){this._input=Gi.ONE_FINGER,this.updateTouchEvent(r),this.onSinglePanStart(r,"ROTATE");break}break;case Gi.TWO_FINGER:this.updateTouchEvent(r),this.onRotateMove(),this.onPinchMove(),this.onDoublePanMove();break;case Gi.MULT_FINGER:this.updateTouchEvent(r),this.onTriplePanMove(r)}else if("touch"!=r.pointerType&&this._input==Gi.CURSOR){let s=null;r.ctrlKey||r.metaKey?s="CTRL":r.shiftKey&&(s="SHIFT");const o=this.getOpStateFromAction(this._button,s);null!=o&&this.onSinglePanMove(r,o)}this._downValid&&this.calculatePointersDistance(this._downEvents[this._downEvents.length-1],r)*this._devPxRatio>this._movementThreshold&&(this._downValid=!1)}),_t(this,"onPointerUp",r=>{if("touch"==r.pointerType&&this._input!=Gi.CURSOR){const s=this._touchCurrent.length;for(let o=0;o<s;o++)if(this._touchCurrent[o].pointerId==r.pointerId){this._touchCurrent.splice(o,1),this._touchStart.splice(o,1);break}switch(this._input){case Gi.ONE_FINGER:case Gi.ONE_FINGER_SWITCHED:window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=Gi.NONE,this.onSinglePanEnd();break;case Gi.TWO_FINGER:this.onDoublePanEnd(r),this.onPinchEnd(r),this.onRotateEnd(r),this._input=Gi.ONE_FINGER_SWITCHED;break;case Gi.MULT_FINGER:0==this._touchCurrent.length&&(window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=Gi.NONE,this.onTriplePanEnd())}}else"touch"!=r.pointerType&&this._input==Gi.CURSOR&&(window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=Gi.NONE,this.onSinglePanEnd(),this._button=-1);if(r.isPrimary)if(this._downValid)if(r.timeStamp-this._downEvents[this._downEvents.length-1].timeStamp<=this._maxDownTime)if(0==this._nclicks)this._nclicks=1,this._clickStart=performance.now();else{const o=r.timeStamp-this._clickStart,a=this.calculatePointersDistance(this._downEvents[1],this._downEvents[0])*this._devPxRatio;o<=this._maxInterval&&a<=this._posThreshold?(this._nclicks=0,this._downEvents.splice(0,this._downEvents.length),this.onDoubleTap(r)):(this._nclicks=1,this._downEvents.shift(),this._clickStart=performance.now())}else this._downValid=!1,this._nclicks=0,this._downEvents.splice(0,this._downEvents.length);else this._nclicks=0,this._downEvents.splice(0,this._downEvents.length)}),_t(this,"onWheel",r=>{if(this.enabled&&this.enableZoom){let s=null;r.ctrlKey||r.metaKey?s="CTRL":r.shiftKey&&(s="SHIFT");const o=this.getOpFromAction("WHEEL",s);if(null!=o){r.preventDefault(),this.dispatchEvent(da);const a=125;let l=r.deltaY/a,c=1;switch(l>0?c=1/this.scaleFactor:l<0&&(c=this.scaleFactor),o){case"ZOOM":if(this.updateTbState(Dt.SCALE,!0),l>0?c=1/Math.pow(this.scaleFactor,l):l<0&&(c=Math.pow(this.scaleFactor,-l)),this.cursorZoom&&this.enablePan){let d;this.camera.isOrthographicCamera?d=this.unprojectOnTbPlane(this.camera,r.clientX,r.clientY,this.domElement).applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._gizmos.position):this.camera.isPerspectiveCamera&&(d=this.unprojectOnTbPlane(this.camera,r.clientX,r.clientY,this.domElement).applyQuaternion(this.camera.quaternion).add(this._gizmos.position)),this.applyTransformMatrix(this.scale(c,d))}else this.applyTransformMatrix(this.scale(c,this._gizmos.position));null!=this._grid&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(Dt.IDLE,!1),this.dispatchEvent(sn),this.dispatchEvent(Bo);break;case"FOV":if(this.camera.isPerspectiveCamera){this.updateTbState(Dt.FOV,!0),0!=r.deltaX&&(l=r.deltaX/a,c=1,l>0?c=1/Math.pow(this.scaleFactor,l):l<0&&(c=Math.pow(this.scaleFactor,-l))),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);const d=this._v3_1.distanceTo(this._gizmos.position);let u=d/c;u=gt.clamp(u,this.minDistance,this.maxDistance);const h=d*Math.tan(gt.DEG2RAD*this.camera.fov*.5);let f=gt.RAD2DEG*(2*Math.atan(h/u));f>this.maxFov?f=this.maxFov:f<this.minFov&&(f=this.minFov),c=d/(h/Math.tan(gt.DEG2RAD*(f/2))),this.setFov(f),this.applyTransformMatrix(this.scale(c,this._gizmos.position,!1))}null!=this._grid&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(Dt.IDLE,!1),this.dispatchEvent(sn),this.dispatchEvent(Bo)}}}}),_t(this,"onSinglePanStart",(r,s)=>{if(this.enabled)switch(this.dispatchEvent(da),this.setCenter(r.clientX,r.clientY),s){case"PAN":if(!this.enablePan)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(sn)),this.updateTbState(Dt.PAN,!0),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.camera,ri.x,ri.y,this.domElement)),this.enableGrid&&(this.drawGrid(),this.dispatchEvent(sn));break;case"ROTATE":if(!this.enableRotate)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1),this.updateTbState(Dt.ROTATE,!0),this._startCursorPosition.copy(this.unprojectOnTbSurface(this.camera,ri.x,ri.y,this.domElement,this._tbRadius)),this.activateGizmos(!0),this.enableAnimations&&(this._timePrev=this._timeCurrent=performance.now(),this._angleCurrent=this._anglePrev=0,this._cursorPosPrev.copy(this._startCursorPosition),this._cursorPosCurr.copy(this._cursorPosPrev),this._wCurr=0,this._wPrev=this._wCurr),this.dispatchEvent(sn);break;case"FOV":if(!this.camera.isPerspectiveCamera||!this.enableZoom)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(sn)),this.updateTbState(Dt.FOV,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(ri.x,ri.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition);break;case"ZOOM":if(!this.enableZoom)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(sn)),this.updateTbState(Dt.SCALE,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(ri.x,ri.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition)}}),_t(this,"onSinglePanMove",(r,s)=>{if(this.enabled){const o=s!=this._state;switch(this.setCenter(r.clientX,r.clientY),s){case Dt.PAN:this.enablePan&&(o?(this.dispatchEvent(Bo),this.dispatchEvent(da),this.updateTbState(s,!0),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.camera,ri.x,ri.y,this.domElement)),this.enableGrid&&this.drawGrid(),this.activateGizmos(!1)):(this._currentCursorPosition.copy(this.unprojectOnTbPlane(this.camera,ri.x,ri.y,this.domElement)),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition))));break;case Dt.ROTATE:if(this.enableRotate)if(o)this.dispatchEvent(Bo),this.dispatchEvent(da),this.updateTbState(s,!0),this._startCursorPosition.copy(this.unprojectOnTbSurface(this.camera,ri.x,ri.y,this.domElement,this._tbRadius)),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!0);else{this._currentCursorPosition.copy(this.unprojectOnTbSurface(this.camera,ri.x,ri.y,this.domElement,this._tbRadius));const a=this._startCursorPosition.distanceTo(this._currentCursorPosition),l=this._startCursorPosition.angleTo(this._currentCursorPosition),c=Math.max(a/this._tbRadius,l);this.applyTransformMatrix(this.rotate(this.calculateRotationAxis(this._startCursorPosition,this._currentCursorPosition),c)),this.enableAnimations&&(this._timePrev=this._timeCurrent,this._timeCurrent=performance.now(),this._anglePrev=this._angleCurrent,this._angleCurrent=c,this._cursorPosPrev.copy(this._cursorPosCurr),this._cursorPosCurr.copy(this._currentCursorPosition),this._wPrev=this._wCurr,this._wCurr=this.calculateAngularSpeed(this._anglePrev,this._angleCurrent,this._timePrev,this._timeCurrent))}break;case Dt.SCALE:if(this.enableZoom)if(o)this.dispatchEvent(Bo),this.dispatchEvent(da),this.updateTbState(s,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(ri.x,ri.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(.5*this.getCursorNDC(ri.x,ri.y,this.domElement).y);const l=this._currentCursorPosition.y-this._startCursorPosition.y;let c=1;l<0?c=1/Math.pow(this.scaleFactor,8*-l):l>0&&(c=Math.pow(this.scaleFactor,8*l)),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState),this.applyTransformMatrix(this.scale(c,this._v3_1))}break;case Dt.FOV:if(this.enableZoom&&this.camera.isPerspectiveCamera)if(o)this.dispatchEvent(Bo),this.dispatchEvent(da),this.updateTbState(s,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(ri.x,ri.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(.5*this.getCursorNDC(ri.x,ri.y,this.domElement).y);const l=this._currentCursorPosition.y-this._startCursorPosition.y;let c=1;l<0?c=1/Math.pow(this.scaleFactor,8*-l):l>0&&(c=Math.pow(this.scaleFactor,8*l)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);const d=this._v3_1.distanceTo(this._gizmos.position);let u=d/c;u=gt.clamp(u,this.minDistance,this.maxDistance);const h=d*Math.tan(gt.DEG2RAD*this._fovState*.5);let f=gt.RAD2DEG*(2*Math.atan(h/u));f=gt.clamp(f,this.minFov,this.maxFov);const m=h/Math.tan(gt.DEG2RAD*(f/2));c=d/m,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(f),this.applyTransformMatrix(this.scale(c,this._v3_2,!1)),or.copy(this._gizmos.position).sub(this.camera.position).normalize().multiplyScalar(m/d),this._m4_1.makeTranslation(or.x,or.y,or.z)}}this.dispatchEvent(sn)}}),_t(this,"onSinglePanEnd",()=>{if(this._state==Dt.ROTATE){if(!this.enableRotate)return;if(this.enableAnimations)if(performance.now()-this._timeCurrent<120){const s=Math.abs((this._wPrev+this._wCurr)/2),o=this;this._animationId=window.requestAnimationFrame(function(a){o.updateTbState(Dt.ANIMATION_ROTATE,!0);const l=o.calculateRotationAxis(o._cursorPosPrev,o._cursorPosCurr);o.onRotationAnim(a,l,Math.min(s,o.wMax))})}else this.updateTbState(Dt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(sn);else this.updateTbState(Dt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(sn)}else(this._state==Dt.PAN||this._state==Dt.IDLE)&&(this.updateTbState(Dt.IDLE,!1),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1),this.dispatchEvent(sn));this.dispatchEvent(Bo)}),_t(this,"onDoubleTap",r=>{if(this.enabled&&this.enablePan&&null!=this.scene){this.dispatchEvent(da),this.setCenter(r.clientX,r.clientY);const s=this.unprojectOnObj(this.getCursorNDC(ri.x,ri.y,this.domElement),this.camera);if(null!=s&&this.enableAnimations){const o=this;-1!=this._animationId&&window.cancelAnimationFrame(this._animationId),this._timeStart=-1,this._animationId=window.requestAnimationFrame(function(a){o.updateTbState(Dt.ANIMATION_FOCUS,!0),o.onFocusAnim(a,s,o._cameraMatrixState,o._gizmoMatrixState)})}else null!=s&&!this.enableAnimations&&(this.updateTbState(Dt.FOCUS,!0),this.focus(s,this.scaleFactor),this.updateTbState(Dt.IDLE,!1),this.dispatchEvent(sn))}this.dispatchEvent(Bo)}),_t(this,"onDoublePanStart",()=>{this.enabled&&this.enablePan&&(this.dispatchEvent(da),this.updateTbState(Dt.PAN,!0),this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.camera,ri.x,ri.y,this.domElement,!0)),this._currentCursorPosition.copy(this._startCursorPosition),this.activateGizmos(!1))}),_t(this,"onDoublePanMove",()=>{this.enabled&&this.enablePan&&(this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._state!=Dt.PAN&&(this.updateTbState(Dt.PAN,!0),this._startCursorPosition.copy(this._currentCursorPosition)),this._currentCursorPosition.copy(this.unprojectOnTbPlane(this.camera,ri.x,ri.y,this.domElement,!0)),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition,!0)),this.dispatchEvent(sn))}),_t(this,"onDoublePanEnd",()=>{this.updateTbState(Dt.IDLE,!1),this.dispatchEvent(Bo)}),_t(this,"onRotateStart",()=>{this.enabled&&this.enableRotate&&(this.dispatchEvent(da),this.updateTbState(Dt.ZROTATE,!0),this._startFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this._currentFingerRotation=this._startFingerRotation,this.camera.getWorldDirection(this._rotationAxis),!this.enablePan&&!this.enableZoom&&this.activateGizmos(!0))}),_t(this,"onRotateMove",()=>{if(this.enabled&&this.enableRotate){let r;this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._state!=Dt.ZROTATE&&(this.updateTbState(Dt.ZROTATE,!0),this._startFingerRotation=this._currentFingerRotation),this._currentFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this.enablePan?(this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),r=this.unprojectOnTbPlane(this.camera,ri.x,ri.y,this.domElement).applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._v3_2)):r=(new T).setFromMatrixPosition(this._gizmoMatrixState),this.applyTransformMatrix(this.zRotate(r,gt.DEG2RAD*(this._startFingerRotation-this._currentFingerRotation))),this.dispatchEvent(sn)}}),_t(this,"onRotateEnd",()=>{this.updateTbState(Dt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(Bo)}),_t(this,"onPinchStart",()=>{this.enabled&&this.enableZoom&&(this.dispatchEvent(da),this.updateTbState(Dt.SCALE,!0),this._startFingerDistance=this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),this._currentFingerDistance=this._startFingerDistance,this.activateGizmos(!1))}),_t(this,"onPinchMove",()=>{if(this.enabled&&this.enableZoom){this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2);const r=12;this._state!=Dt.SCALE&&(this._startFingerDistance=this._currentFingerDistance,this.updateTbState(Dt.SCALE,!0)),this._currentFingerDistance=Math.max(this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),r*this._devPxRatio);const s=this._currentFingerDistance/this._startFingerDistance;let o;this.enablePan?this.camera.isOrthographicCamera?o=this.unprojectOnTbPlane(this.camera,ri.x,ri.y,this.domElement).applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._gizmos.position):this.camera.isPerspectiveCamera&&(o=this.unprojectOnTbPlane(this.camera,ri.x,ri.y,this.domElement).applyQuaternion(this.camera.quaternion).add(this._gizmos.position)):o=this._gizmos.position,this.applyTransformMatrix(this.scale(s,o)),this.dispatchEvent(sn)}}),_t(this,"onPinchEnd",()=>{this.updateTbState(Dt.IDLE,!1),this.dispatchEvent(Bo)}),_t(this,"onTriplePanStart",()=>{if(this.enabled&&this.enableZoom){this.dispatchEvent(da),this.updateTbState(Dt.SCALE,!0);let r=0,s=0;const o=this._touchCurrent.length;for(let a=0;a<o;a++)r+=this._touchCurrent[a].clientX,s+=this._touchCurrent[a].clientY;this.setCenter(r/o,s/o),this._startCursorPosition.setY(.5*this.getCursorNDC(ri.x,ri.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition)}}),_t(this,"onTriplePanMove",()=>{if(this.enabled&&this.enableZoom){let r=0,s=0;const o=this._touchCurrent.length;for(let p=0;p<o;p++)r+=this._touchCurrent[p].clientX,s+=this._touchCurrent[p].clientY;this.setCenter(r/o,s/o);const a=8;this._currentCursorPosition.setY(.5*this.getCursorNDC(ri.x,ri.y,this.domElement).y);const l=this._currentCursorPosition.y-this._startCursorPosition.y;let c=1;l<0?c=1/Math.pow(this.scaleFactor,-l*a):l>0&&(c=Math.pow(this.scaleFactor,l*a)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);const d=this._v3_1.distanceTo(this._gizmos.position);let u=d/c;u=gt.clamp(u,this.minDistance,this.maxDistance);const h=d*Math.tan(gt.DEG2RAD*this._fovState*.5);let f=gt.RAD2DEG*(2*Math.atan(h/u));f=gt.clamp(f,this.minFov,this.maxFov);const m=h/Math.tan(gt.DEG2RAD*(f/2));c=d/m,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(f),this.applyTransformMatrix(this.scale(c,this._v3_2,!1)),or.copy(this._gizmos.position).sub(this.camera.position).normalize().multiplyScalar(m/d),this._m4_1.makeTranslation(or.x,or.y,or.z),this.dispatchEvent(sn)}}),_t(this,"onTriplePanEnd",()=>{this.updateTbState(Dt.IDLE,!1),this.dispatchEvent(Bo)}),_t(this,"setCenter",(r,s)=>{ri.x=r,ri.y=s}),_t(this,"initializeMouseActions",()=>{this.setMouseAction("PAN",0,"CTRL"),this.setMouseAction("PAN",2),this.setMouseAction("ROTATE",0),this.setMouseAction("ZOOM","WHEEL"),this.setMouseAction("ZOOM",1),this.setMouseAction("FOV","WHEEL","SHIFT"),this.setMouseAction("FOV",1,"SHIFT")}),_t(this,"compareMouseAction",(r,s)=>r.operation==s.operation&&r.mouse==s.mouse&&r.key==s.key),_t(this,"setMouseAction",(r,s,o=null)=>{let d;if(!["PAN","ROTATE","ZOOM","FOV"].includes(r)||![0,1,2,"WHEEL"].includes(s)||!["CTRL","SHIFT",null].includes(o)||"WHEEL"==s&&"ZOOM"!=r&&"FOV"!=r)return!1;switch(r){case"PAN":d=Dt.PAN;break;case"ROTATE":d=Dt.ROTATE;break;case"ZOOM":d=Dt.SCALE;break;case"FOV":d=Dt.FOV}const u={operation:r,mouse:s,key:o,state:d};for(let h=0;h<this.mouseActions.length;h++)if(this.mouseActions[h].mouse==u.mouse&&this.mouseActions[h].key==u.key)return this.mouseActions.splice(h,1,u),!0;return this.mouseActions.push(u),!0}),_t(this,"unsetMouseAction",(r,s=null)=>{for(let o=0;o<this.mouseActions.length;o++)if(this.mouseActions[o].mouse==r&&this.mouseActions[o].key==s)return this.mouseActions.splice(o,1),!0;return!1}),_t(this,"getOpFromAction",(r,s)=>{let o;for(let a=0;a<this.mouseActions.length;a++)if(o=this.mouseActions[a],o.mouse==r&&o.key==s)return o.operation;if(null!=s)for(let a=0;a<this.mouseActions.length;a++)if(o=this.mouseActions[a],o.mouse==r&&null==o.key)return o.operation;return null}),_t(this,"getOpStateFromAction",(r,s)=>{let o;for(let a=0;a<this.mouseActions.length;a++)if(o=this.mouseActions[a],o.mouse==r&&o.key==s)return o.state;if(null!=s)for(let a=0;a<this.mouseActions.length;a++)if(o=this.mouseActions[a],o.mouse==r&&null==o.key)return o.state;return null}),_t(this,"getAngle",(r,s)=>180*Math.atan2(s.clientY-r.clientY,s.clientX-r.clientX)/Math.PI),_t(this,"updateTouchEvent",r=>{for(let s=0;s<this._touchCurrent.length;s++)if(this._touchCurrent[s].pointerId==r.pointerId){this._touchCurrent.splice(s,1,r);break}}),_t(this,"calculateAngularSpeed",(r,s,o,a)=>{const c=(a-o)/1e3;return 0==c?0:(s-r)/c}),_t(this,"calculatePointersDistance",(r,s)=>Math.sqrt(Math.pow(s.clientX-r.clientX,2)+Math.pow(s.clientY-r.clientY,2))),_t(this,"calculateRotationAxis",(r,s)=>(this._rotationMatrix.extractRotation(this._cameraMatrixState),this._quat.setFromRotationMatrix(this._rotationMatrix),this._rotationAxis.crossVectors(r,s).applyQuaternion(this._quat),this._rotationAxis.normalize().clone())),_t(this,"calculateTbRadius",r=>{const s=r.position.distanceTo(this._gizmos.position);if("PerspectiveCamera"==r.type){const o=gt.DEG2RAD*r.fov*.5,a=Math.atan(r.aspect*Math.tan(o));return Math.tan(Math.min(o,a))*s*this.radiusFactor}if("OrthographicCamera"==r.type)return Math.min(r.top,r.right)*this.radiusFactor}),_t(this,"focus",(r,s,o=1)=>{or.copy(r).sub(this._gizmos.position).multiplyScalar(o),this._translationMatrix.makeTranslation(or.x,or.y,or.z),eH.copy(this._gizmoMatrixState),this._gizmoMatrixState.premultiply(this._translationMatrix),this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),tH.copy(this._cameraMatrixState),this._cameraMatrixState.premultiply(this._translationMatrix),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.enableZoom&&this.applyTransformMatrix(this.scale(s,this._gizmos.position)),this._gizmoMatrixState.copy(eH),this._cameraMatrixState.copy(tH)}),_t(this,"drawGrid",()=>{if(null!=this.scene){let o,a,l,c;if(this.camera.isOrthographicCamera)l=Math.max(this.camera.right-this.camera.left,this.camera.bottom-this.camera.top),c=l/20,o=l/this.camera.zoom*3,a=o/c*this.camera.zoom;else if(this.camera.isPerspectiveCamera){const d=this.camera.position.distanceTo(this._gizmos.position),u=gt.DEG2RAD*this.camera.fov*.5,h=Math.atan(this.camera.aspect*Math.tan(u));l=Math.tan(Math.max(u,h))*d*2,c=l/20,o=3*l,a=o/c}null==this._grid&&(this._grid=new PI(o,a,8947848,8947848),this._grid.position.copy(this._gizmos.position),this._gridPosition.copy(this._grid.position),this._grid.quaternion.copy(this.camera.quaternion),this._grid.rotateX(.5*Math.PI),this.scene.add(this._grid))}}),_t(this,"dispose",()=>{-1!=this._animationId&&window.cancelAnimationFrame(this._animationId),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("pointercancel",this.onPointerCancel),this.domElement.removeEventListener("wheel",this.onWheel),this.domElement.removeEventListener("contextmenu",this.onContextMenu),window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),window.removeEventListener("resize",this.onWindowResize),null!==this.scene&&this.scene.remove(this._gizmos),this.disposeGrid()}),_t(this,"disposeGrid",()=>{null!=this._grid&&null!=this.scene&&(this.scene.remove(this._grid),this._grid=null)}),_t(this,"easeOutCubic",r=>1-Math.pow(1-r,3)),_t(this,"activateGizmos",r=>{const s=this._gizmos.children[0],o=this._gizmos.children[1],a=this._gizmos.children[2];r?(s.material.setValues({opacity:1}),o.material.setValues({opacity:1}),a.material.setValues({opacity:1})):(s.material.setValues({opacity:.6}),o.material.setValues({opacity:.6}),a.material.setValues({opacity:.6}))}),_t(this,"getCursorNDC",(r,s,o)=>{const a=o.getBoundingClientRect();return this._v2_1.setX((r-a.left)/a.width*2-1),this._v2_1.setY((a.bottom-s)/a.height*2-1),this._v2_1.clone()}),_t(this,"getCursorPosition",(r,s,o)=>(this._v2_1.copy(this.getCursorNDC(r,s,o)),this._v2_1.x*=.5*(this.camera.right-this.camera.left),this._v2_1.y*=.5*(this.camera.top-this.camera.bottom),this._v2_1.clone())),_t(this,"setCamera",r=>{r.lookAt(this.target),r.updateMatrix(),"PerspectiveCamera"==r.type&&(this._fov0=r.fov,this._fovState=r.fov),this._cameraMatrixState0.copy(r.matrix),this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraProjectionState.copy(r.projectionMatrix),this._zoom0=r.zoom,this._zoomState=this._zoom0,this._initialNear=r.near,this._nearPos0=r.position.distanceTo(this.target)-r.near,this._nearPos=this._initialNear,this._initialFar=r.far,this._farPos0=r.position.distanceTo(this.target)-r.far,this._farPos=this._initialFar,this._up0.copy(r.up),this._upState.copy(r.up),this.camera=r,this.camera.updateProjectionMatrix(),this._tbRadius=this.calculateTbRadius(r),this.makeGizmos(this.target,this._tbRadius)}),_t(this,"makeGizmos",(r,s)=>{const a=new bc(0,0,s,s).getPoints(this._curvePts),l=(new xt).setFromPoints(a),c=new pn({color:16744576,fog:!1,transparent:!0,opacity:.6}),d=new pn({color:8454016,fog:!1,transparent:!0,opacity:.6}),u=new pn({color:8421631,fog:!1,transparent:!0,opacity:.6}),h=new Nn(l,c),f=new Nn(l,d),m=new Nn(l,u),p=.5*Math.PI;if(h.rotation.x=p,f.rotation.y=p,this._gizmoMatrixState0.identity().setPosition(r),this._gizmoMatrixState.copy(this._gizmoMatrixState0),1!==this.camera.zoom){const g=1/this.camera.zoom;this._scaleMatrix.makeScale(g,g,g),this._translationMatrix.makeTranslation(-r.x,-r.y,-r.z),this._gizmoMatrixState.premultiply(this._translationMatrix).premultiply(this._scaleMatrix),this._translationMatrix.makeTranslation(r.x,r.y,r.z),this._gizmoMatrixState.premultiply(this._translationMatrix)}this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.traverse(function(g){g.isLine&&(g.geometry.dispose(),g.material.dispose())}),this._gizmos.clear(),this._gizmos.add(h),this._gizmos.add(f),this._gizmos.add(m)}),_t(this,"onFocusAnim",(r,s,o,a)=>{if(-1==this._timeStart&&(this._timeStart=r),this._state==Dt.ANIMATION_FOCUS){const c=(r-this._timeStart)/this.focusAnimationTime;if(this._gizmoMatrixState.copy(a),c>=1)this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(s,this.scaleFactor),this._timeStart=-1,this.updateTbState(Dt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(sn);else{const d=this.easeOutCubic(c),u=1-d+this.scaleFactor*d;this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(s,u,d),this.dispatchEvent(sn);const h=this;this._animationId=window.requestAnimationFrame(function(f){h.onFocusAnim(f,s,o,a.clone())})}}else this._animationId=-1,this._timeStart=-1}),_t(this,"onRotationAnim",(r,s,o)=>{if(-1==this._timeStart&&(this._anglePrev=0,this._angleCurrent=0,this._timeStart=r),this._state==Dt.ANIMATION_ROTATE){const a=(r-this._timeStart)/1e3;if(o+-this.dampingFactor*a>0){this._angleCurrent=.5*-this.dampingFactor*Math.pow(a,2)+o*a+0,this.applyTransformMatrix(this.rotate(s,this._angleCurrent)),this.dispatchEvent(sn);const c=this;this._animationId=window.requestAnimationFrame(function(d){c.onRotationAnim(d,s,o)})}else this._animationId=-1,this._timeStart=-1,this.updateTbState(Dt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(sn)}else this._animationId=-1,this._timeStart=-1,this._state!=Dt.ROTATE&&(this.activateGizmos(!1),this.dispatchEvent(sn))}),_t(this,"pan",(r,s,o=!1)=>{const a=r.clone().sub(s);if(this.camera.isOrthographicCamera)a.multiplyScalar(1/this.camera.zoom);else if(this.camera.isPerspectiveCamera&&o){this._v3_1.setFromMatrixPosition(this._cameraMatrixState0),this._v3_2.setFromMatrixPosition(this._gizmoMatrixState0);const l=this._v3_1.distanceTo(this._v3_2)/this.camera.position.distanceTo(this._gizmos.position);a.multiplyScalar(1/l)}return this._v3_1.set(a.x,a.y,0).applyQuaternion(this.camera.quaternion),this._m4_1.makeTranslation(this._v3_1.x,this._v3_1.y,this._v3_1.z),this.setTransformationMatrices(this._m4_1,this._m4_1),oo}),_t(this,"reset",()=>{this.camera.zoom=this._zoom0,this.camera.isPerspectiveCamera&&(this.camera.fov=this._fov0),this.camera.near=this._nearPos,this.camera.far=this._farPos,this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.up.copy(this._up0),this.camera.updateMatrix(),this.camera.updateProjectionMatrix(),this._gizmoMatrixState.copy(this._gizmoMatrixState0),this._gizmoMatrixState0.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix(),this._tbRadius=this.calculateTbRadius(this.camera),this.makeGizmos(this._gizmos.position,this._tbRadius),this.camera.lookAt(this._gizmos.position),this.updateTbState(Dt.IDLE,!1),this.dispatchEvent(sn)}),_t(this,"rotate",(r,s)=>{const o=this._gizmos.position;return this._translationMatrix.makeTranslation(-o.x,-o.y,-o.z),this._rotationMatrix.makeRotationAxis(r,-s),this._m4_1.makeTranslation(o.x,o.y,o.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this.setTransformationMatrices(this._m4_1),oo}),_t(this,"copyState",()=>{let r;this.camera.isOrthographicCamera?r=JSON.stringify({arcballState:{cameraFar:this.camera.far,cameraMatrix:this.camera.matrix,cameraNear:this.camera.near,cameraUp:this.camera.up,cameraZoom:this.camera.zoom,gizmoMatrix:this._gizmos.matrix}}):this.camera.isPerspectiveCamera&&(r=JSON.stringify({arcballState:{cameraFar:this.camera.far,cameraFov:this.camera.fov,cameraMatrix:this.camera.matrix,cameraNear:this.camera.near,cameraUp:this.camera.up,cameraZoom:this.camera.zoom,gizmoMatrix:this._gizmos.matrix}})),navigator.clipboard.writeText(r)}),_t(this,"pasteState",()=>{const r=this;navigator.clipboard.readText().then(function(o){r.setStateFromJSON(o)})}),_t(this,"saveState",()=>{this._cameraMatrixState0.copy(this.camera.matrix),this._gizmoMatrixState0.copy(this._gizmos.matrix),this._nearPos=this.camera.near,this._farPos=this.camera.far,this._zoom0=this.camera.zoom,this._up0.copy(this.camera.up),this.camera.isPerspectiveCamera&&(this._fov0=this.camera.fov)}),_t(this,"scale",(r,s,o=!0)=>{ua.copy(s);let a=1/r;if(this.camera.isOrthographicCamera){this.camera.zoom=this._zoomState,this.camera.zoom*=r,this.camera.zoom>this.maxZoom?(this.camera.zoom=this.maxZoom,a=this._zoomState/this.maxZoom):this.camera.zoom<this.minZoom&&(this.camera.zoom=this.minZoom,a=this._zoomState/this.minZoom),this.camera.updateProjectionMatrix(),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState),this._scaleMatrix.makeScale(a,a,a),this._translationMatrix.makeTranslation(-this._v3_1.x,-this._v3_1.y,-this._v3_1.z),this._m4_2.makeTranslation(this._v3_1.x,this._v3_1.y,this._v3_1.z).multiply(this._scaleMatrix),this._m4_2.multiply(this._translationMatrix),ua.sub(this._v3_1);const l=ua.clone().multiplyScalar(a);return ua.sub(l),this._m4_1.makeTranslation(ua.x,ua.y,ua.z),this._m4_2.premultiply(this._m4_1),this.setTransformationMatrices(this._m4_1,this._m4_2),oo}if(this.camera.isPerspectiveCamera){this._v3_1.setFromMatrixPosition(this._cameraMatrixState),this._v3_2.setFromMatrixPosition(this._gizmoMatrixState);let l=this._v3_1.distanceTo(ua),c=l-l*a;const d=l-c;if(d<this.minDistance?(a=this.minDistance/l,c=l-l*a):d>this.maxDistance&&(a=this.maxDistance/l,c=l-l*a),or.copy(ua).sub(this._v3_1).normalize().multiplyScalar(c),this._m4_1.makeTranslation(or.x,or.y,or.z),o){const u=this._v3_2;l=u.distanceTo(ua),c=l-l*a,or.copy(ua).sub(this._v3_2).normalize().multiplyScalar(c),this._translationMatrix.makeTranslation(u.x,u.y,u.z),this._scaleMatrix.makeScale(a,a,a),this._m4_2.makeTranslation(or.x,or.y,or.z).multiply(this._translationMatrix),this._m4_2.multiply(this._scaleMatrix),this._translationMatrix.makeTranslation(-u.x,-u.y,-u.z),this._m4_2.multiply(this._translationMatrix),this.setTransformationMatrices(this._m4_1,this._m4_2)}else this.setTransformationMatrices(this._m4_1);return oo}}),_t(this,"setFov",r=>{this.camera.isPerspectiveCamera&&(this.camera.fov=gt.clamp(r,this.minFov,this.maxFov),this.camera.updateProjectionMatrix())}),_t(this,"zRotate",(r,s)=>(this._rotationMatrix.makeRotationAxis(this._rotationAxis,s),this._translationMatrix.makeTranslation(-r.x,-r.y,-r.z),this._m4_1.makeTranslation(r.x,r.y,r.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState).sub(r),this._v3_2.copy(this._v3_1).applyAxisAngle(this._rotationAxis,s),this._v3_2.sub(this._v3_1),this._m4_2.makeTranslation(this._v3_2.x,this._v3_2.y,this._v3_2.z),this.setTransformationMatrices(this._m4_1,this._m4_2),oo)),_t(this,"unprojectOnObj",(r,s)=>{const o=this.getRaycaster();o.near=s.near,o.far=s.far,o.setFromCamera(r,s);const a=o.intersectObjects(this.scene.children,!0);for(let l=0;l<a.length;l++)if(a[l].object.uuid!=this._gizmos.uuid&&null!=a[l].face)return a[l].point.clone();return null}),_t(this,"unprojectOnTbSurface",(r,s,o,a,l)=>{if("OrthographicCamera"==r.type){this._v2_1.copy(this.getCursorPosition(s,o,a)),this._v3_1.set(this._v2_1.x,this._v2_1.y,0);const c=Math.pow(this._v2_1.x,2),d=Math.pow(this._v2_1.y,2),u=Math.pow(this._tbRadius,2);return this._v3_1.setZ(c+d<=.5*u?Math.sqrt(u-(c+d)):.5*u/Math.sqrt(c+d)),this._v3_1}if("PerspectiveCamera"==r.type){this._v2_1.copy(this.getCursorNDC(s,o,a)),this._v3_1.set(this._v2_1.x,this._v2_1.y,-1),this._v3_1.applyMatrix4(r.projectionMatrixInverse);const c=this._v3_1.clone().normalize(),d=r.position.distanceTo(this._gizmos.position),u=Math.pow(l,2),h=this._v3_1.z,f=Math.sqrt(Math.pow(this._v3_1.x,2)+Math.pow(this._v3_1.y,2));if(0==f)return c.set(this._v3_1.x,this._v3_1.y,l),c;const m=h/f,p=d;let g=Math.pow(m,2)+1,_=2*m*p,v=Math.pow(p,2)-u,b=Math.pow(_,2)-4*g*v;if(b>=0&&(this._v2_1.setX((-_-Math.sqrt(b))/(2*g)),this._v2_1.setY(m*this._v2_1.x+p),gt.RAD2DEG*this._v2_1.angle()>=45)){const C=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(d-this._v2_1.y,2));return c.multiplyScalar(C),c.z+=d,c}g=m,_=p,v=.5*-u,b=Math.pow(_,2)-4*g*v,this._v2_1.setX((-_-Math.sqrt(b))/(2*g)),this._v2_1.setY(m*this._v2_1.x+p);const y=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(d-this._v2_1.y,2));return c.multiplyScalar(y),c.z+=d,c}}),_t(this,"unprojectOnTbPlane",(r,s,o,a,l=!1)=>{if("OrthographicCamera"==r.type)return this._v2_1.copy(this.getCursorPosition(s,o,a)),this._v3_1.set(this._v2_1.x,this._v2_1.y,0),this._v3_1.clone();if("PerspectiveCamera"==r.type){this._v2_1.copy(this.getCursorNDC(s,o,a)),this._v3_1.set(this._v2_1.x,this._v2_1.y,-1),this._v3_1.applyMatrix4(r.projectionMatrixInverse);const c=this._v3_1.clone().normalize(),d=this._v3_1.z,u=Math.sqrt(Math.pow(this._v3_1.x,2)+Math.pow(this._v3_1.y,2));let h;if(h=l?this._v3_1.setFromMatrixPosition(this._cameraMatrixState0).distanceTo(this._v3_2.setFromMatrixPosition(this._gizmoMatrixState0)):r.position.distanceTo(this._gizmos.position),0==u)return c.set(0,0,0),c;const p=-h/(d/u),g=Math.sqrt(Math.pow(h,2)+Math.pow(p,2));return c.multiplyScalar(g),c.z=0,c}}),_t(this,"updateMatrixState",()=>{this._cameraMatrixState.copy(this.camera.matrix),this._gizmoMatrixState.copy(this._gizmos.matrix),this.camera.isOrthographicCamera?(this._cameraProjectionState.copy(this.camera.projectionMatrix),this.camera.updateProjectionMatrix(),this._zoomState=this.camera.zoom):this.camera.isPerspectiveCamera&&(this._fovState=this.camera.fov)}),_t(this,"updateTbState",(r,s)=>{this._state=r,s&&this.updateMatrixState()}),_t(this,"update",()=>{if(!1===this.target.equals(this._currentTarget)&&(this._gizmos.position.copy(this.target),this._tbRadius=this.calculateTbRadius(this.camera),this.makeGizmos(this.target,this._tbRadius),this._currentTarget.copy(this.target)),this.camera.isOrthographicCamera){if(this.camera.zoom>this.maxZoom||this.camera.zoom<this.minZoom){const s=gt.clamp(this.camera.zoom,this.minZoom,this.maxZoom);this.applyTransformMatrix(this.scale(s/this.camera.zoom,this._gizmos.position,!0))}}else if(this.camera.isPerspectiveCamera){const s=this.camera.position.distanceTo(this._gizmos.position);if(s>this.maxDistance+1e-6||s<this.minDistance-1e-6){const a=gt.clamp(s,this.minDistance,this.maxDistance);this.applyTransformMatrix(this.scale(a/s,this._gizmos.position)),this.updateMatrixState()}(this.camera.fov<this.minFov||this.camera.fov>this.maxFov)&&(this.camera.fov=gt.clamp(this.camera.fov,this.minFov,this.maxFov),this.camera.updateProjectionMatrix());const o=this._tbRadius;if(this._tbRadius=this.calculateTbRadius(this.camera),o<this._tbRadius-1e-6||o>this._tbRadius+1e-6){const l=this._tbRadius/((this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3),d=new bc(0,0,l,l).getPoints(this._curvePts),u=(new xt).setFromPoints(d);for(const h in this._gizmos.children)this._gizmos.children[h].geometry=u}}this.camera.lookAt(this._gizmos.position)}),_t(this,"setStateFromJSON",r=>{const s=JSON.parse(r);if(null!=s.arcballState){this._cameraMatrixState.fromArray(s.arcballState.cameraMatrix.elements),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.up.copy(s.arcballState.cameraUp),this.camera.near=s.arcballState.cameraNear,this.camera.far=s.arcballState.cameraFar,this.camera.zoom=s.arcballState.cameraZoom,this.camera.isPerspectiveCamera&&(this.camera.fov=s.arcballState.cameraFov),this._gizmoMatrixState.fromArray(s.arcballState.gizmoMatrix.elements),this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.camera.updateMatrix(),this.camera.updateProjectionMatrix(),this._gizmos.updateMatrix(),this._tbRadius=this.calculateTbRadius(this.camera);const o=(new Ve).copy(this._gizmoMatrixState0);this.makeGizmos(this._gizmos.position,this._tbRadius),this._gizmoMatrixState0.copy(o),this.camera.lookAt(this._gizmos.position),this.updateTbState(Dt.IDLE,!1),this.dispatchEvent(sn)}}),this.camera=null,this.domElement=t,this.scene=n,this.target=new T,this._currentTarget=new T,this.radiusFactor=.67,this.mouseActions=[],this._mouseOp=null,this._v2_1=new ue,this._v3_1=new T,this._v3_2=new T,this._m4_1=new Ve,this._m4_2=new Ve,this._quat=new xi,this._translationMatrix=new Ve,this._rotationMatrix=new Ve,this._scaleMatrix=new Ve,this._rotationAxis=new T,this._cameraMatrixState=new Ve,this._cameraProjectionState=new Ve,this._fovState=1,this._upState=new T,this._zoomState=1,this._nearPos=0,this._farPos=0,this._gizmoMatrixState=new Ve,this._up0=new T,this._zoom0=1,this._fov0=0,this._initialNear=0,this._nearPos0=0,this._initialFar=0,this._farPos0=0,this._cameraMatrixState0=new Ve,this._gizmoMatrixState0=new Ve,this._button=-1,this._touchStart=[],this._touchCurrent=[],this._input=Gi.NONE,this._switchSensibility=32,this._startFingerDistance=0,this._currentFingerDistance=0,this._startFingerRotation=0,this._currentFingerRotation=0,this._devPxRatio=0,this._downValid=!0,this._nclicks=0,this._downEvents=[],this._downStart=0,this._clickStart=0,this._maxDownTime=250,this._maxInterval=300,this._posThreshold=24,this._movementThreshold=24,this._currentCursorPosition=new T,this._startCursorPosition=new T,this._grid=null,this._gridPosition=new T,this._gizmos=new xs,this._curvePts=128,this._timeStart=-1,this._animationId=-1,this.focusAnimationTime=500,this._timePrev=0,this._timeCurrent=0,this._anglePrev=0,this._angleCurrent=0,this._cursorPosPrev=new T,this._cursorPosCurr=new T,this._wPrev=0,this._wCurr=0,this.adjustNearFar=!1,this.scaleFactor=1.1,this.dampingFactor=25,this.wMax=20,this.enableAnimations=!0,this.enableGrid=!1,this.cursorZoom=!1,this.minFov=5,this.maxFov=90,this.enabled=!0,this.enablePan=!0,this.enableRotate=!0,this.enableZoom=!0,this.enableGizmos=!0,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this._tbRadius=1,this._state=Dt.IDLE,this.setCamera(e),null!=this.scene&&this.scene.add(this._gizmos),this.domElement.style.touchAction="none",this._devPxRatio=window.devicePixelRatio,this.initializeMouseActions(),this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("wheel",this.onWheel),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointercancel",this.onPointerCancel),window.addEventListener("resize",this.onWindowResize)}applyTransformMatrix(e){if(null!=e.camera&&(this._m4_1.copy(this._cameraMatrixState).premultiply(e.camera),this._m4_1.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.updateMatrix(),(this._state==Dt.ROTATE||this._state==Dt.ZROTATE||this._state==Dt.ANIMATION_ROTATE)&&this.camera.up.copy(this._upState).applyQuaternion(this.camera.quaternion)),null!=e.gizmos&&(this._m4_1.copy(this._gizmoMatrixState).premultiply(e.gizmos),this._m4_1.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix()),this._state==Dt.SCALE||this._state==Dt.FOCUS||this._state==Dt.ANIMATION_FOCUS)if(this._tbRadius=this.calculateTbRadius(this.camera),this.adjustNearFar){const t=this.camera.position.distanceTo(this._gizmos.position),n=new Da;n.setFromObject(this._gizmos);const r=new Al;n.getBoundingSphere(r);const s=Math.max(this._nearPos0,r.radius+r.center.length()),a=Math.min(s,t-this._initialNear);this.camera.near=t-a;const l=Math.min(this._farPos0,-r.radius+r.center.length()),d=Math.min(l,t-this._initialFar);this.camera.far=t-d,this.camera.updateProjectionMatrix()}else{let t=!1;this.camera.near!=this._initialNear&&(this.camera.near=this._initialNear,t=!0),this.camera.far!=this._initialFar&&(this.camera.far=this._initialFar,t=!0),t&&this.camera.updateProjectionMatrix()}}setGizmosVisible(e){this._gizmos.visible=e,this.dispatchEvent(sn)}setTbRadius(e){this.radiusFactor=e,this._tbRadius=this.calculateTbRadius(this.camera);const n=new bc(0,0,this._tbRadius,this._tbRadius).getPoints(this._curvePts),r=(new xt).setFromPoints(n);for(const s in this._gizmos.children)this._gizmos.children[s].geometry=r;this.dispatchEvent(sn)}setTransformationMatrices(e=null,t=null){null!=e?null!=oo.camera?oo.camera.copy(e):oo.camera=e.clone():oo.camera=null,null!=t?null!=oo.gizmos?oo.gizmos.copy(t):oo.gizmos=t.clone():oo.gizmos=null}getRaycaster(){return dme}}class ku extends zn{getType(){return ume}set camera(e){this._objRef&&(this._objRef.camera=e)}set domElement(e){this._objRef&&(this._objRef.domElement=e)}set scene(e){this._objRef&&(this._objRef.scene=e)}set focusAnimationTime(e){this._objRef&&(this._objRef.focusAnimationTime=e)}set enabled(e){this._objRef&&(this._objRef.enabled=e)}set enablePan(e){this._objRef&&(this._objRef.enablePan=e)}set enableRotate(e){this._objRef&&(this._objRef.enableRotate=e)}set enableZoom(e){this._objRef&&(this._objRef.enableZoom=e)}set enableGizmos(e){this._objRef&&(this._objRef.enableGizmos=e)}set adjustNearFar(e){this._objRef&&(this._objRef.adjustNearFar=e)}set scaleFactor(e){this._objRef&&(this._objRef.scaleFactor=e)}set dampingFactor(e){this._objRef&&(this._objRef.dampingFactor=e)}set wMax(e){this._objRef&&(this._objRef.wMax=e)}set enableAnimations(e){this._objRef&&(this._objRef.enableAnimations=e)}set enableGrid(e){this._objRef&&(this._objRef.enableGrid=e)}set cursorZoom(e){this._objRef&&(this._objRef.cursorZoom=e)}set minFov(e){this._objRef&&(this._objRef.minFov=e)}set maxFov(e){this._objRef&&(this._objRef.maxFov=e)}set minDistance(e){this._objRef&&(this._objRef.minDistance=e)}set maxDistance(e){this._objRef&&(this._objRef.maxDistance=e)}set minZoom(e){this._objRef&&(this._objRef.minZoom=e)}set maxZoom(e){this._objRef&&(this._objRef.maxZoom=e)}set target(e){this._objRef&&(this._objRef.target=Qe(this._objRef.target,e))}set radiusFactor(e){this._objRef&&(this._objRef.radiusFactor=e)}}ku.\u0275fac=function(){let i;return function(t){return(i||(i=ce(ku)))(t||ku)}}(),ku.\u0275cmp=$({type:ku,selectors:[["th-arcballControls"]],inputs:{camera:"camera",domElement:"domElement",scene:"scene",focusAnimationTime:"focusAnimationTime",enabled:"enabled",enablePan:"enablePan",enableRotate:"enableRotate",enableZoom:"enableZoom",enableGizmos:"enableGizmos",adjustNearFar:"adjustNearFar",scaleFactor:"scaleFactor",dampingFactor:"dampingFactor",wMax:"wMax",enableAnimations:"enableAnimations",enableGrid:"enableGrid",cursorZoom:"cursorZoom",minFov:"minFov",maxFov:"maxFov",minDistance:"minDistance",maxDistance:"maxDistance",minZoom:"minZoom",maxZoom:"maxZoom",target:"target",radiusFactor:"radiusFactor"},features:[se([{provide:zn,useExisting:le(()=>ku)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Fu extends rn{getType(){return jT}set cameras(e){this._objRef&&(this._objRef.cameras=e)}}Fu.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Fu)))(t||Fu)}}(),Fu.\u0275cmp=$({type:Fu,selectors:[["th-arrayCamera"]],inputs:{cameras:"cameras"},features:[se([{provide:Ye,useExisting:le(()=>Fu)},{provide:Ms,useExisting:le(()=>Fu)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Bp extends Ye{getType(){return $4}set type(e){this._objRef&&(this._objRef.type=e)}set line(e){this._objRef&&(this._objRef.line=e)}set cone(e){this._objRef&&(this._objRef.cone=e)}}Bp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Bp)))(t||Bp)}}(),Bp.\u0275cmp=$({type:Bp,selectors:[["th-arrowHelper"]],inputs:{type:"type",line:"line",cone:"cone"},features:[se([{provide:Ye,useExisting:le(()=>Bp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Bu extends Ye{getType(){return EI}set type(e){this._objRef&&(this._objRef.type=e)}set listener(e){this._objRef&&(this._objRef.listener=e)}set context(e){this._objRef&&(this._objRef.context=e)}set gain(e){this._objRef&&(this._objRef.gain=e)}set autoplay(e){this._objRef&&(this._objRef.autoplay=e)}set buffer(e){this._objRef&&(this._objRef.buffer=e)}set detune(e){this._objRef&&(this._objRef.detune=e)}set loop(e){this._objRef&&(this._objRef.loop=e)}set loopStart(e){this._objRef&&(this._objRef.loopStart=e)}set loopEnd(e){this._objRef&&(this._objRef.loopEnd=e)}set offset(e){this._objRef&&(this._objRef.offset=e)}set duration(e){this._objRef&&(this._objRef.duration=e)}set playbackRate(e){this._objRef&&(this._objRef.playbackRate=e)}set isPlaying(e){this._objRef&&(this._objRef.isPlaying=e)}set hasPlaybackControl(e){this._objRef&&(this._objRef.hasPlaybackControl=e)}set sourceType(e){this._objRef&&(this._objRef.sourceType=e)}set source(e){this._objRef&&(this._objRef.source=e)}set filters(e){this._objRef&&(this._objRef.filters=e)}}Bu.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Bu)))(t||Bu)}}(),Bu.\u0275cmp=$({type:Bu,selectors:[["th-audio"]],inputs:{type:"type",listener:"listener",context:"context",gain:"gain",autoplay:"autoplay",buffer:"buffer",detune:"detune",loop:"loop",loopStart:"loopStart",loopEnd:"loopEnd",offset:"offset",duration:"duration",playbackRate:"playbackRate",isPlaying:"isPlaying",hasPlaybackControl:"hasPlaybackControl",sourceType:"sourceType",source:"source",filters:"filters"},features:[se([{provide:Ye,useExisting:le(()=>Bu)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Lp extends Ye{getType(){return E4}set type(e){this._objRef&&(this._objRef.type=e)}set context(e){this._objRef&&(this._objRef.context=e)}set gain(e){this._objRef&&(this._objRef.gain=e)}set filter(e){this._objRef&&(this._objRef.filter=e)}set timeDelta(e){this._objRef&&(this._objRef.timeDelta=e)}}Lp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Lp)))(t||Lp)}}(),Lp.\u0275cmp=$({type:Lp,selectors:[["th-audioListener"]],inputs:{type:"type",context:"context",gain:"gain",filter:"filter",timeDelta:"timeDelta"},features:[se([{provide:Ye,useExisting:le(()=>Lp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Op extends Es{getType(){return J4}set type(e){this._objRef&&(this._objRef.type=e)}}Op.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Op)))(t||Op)}}(),Op.\u0275cmp=$({type:Op,selectors:[["th-axesHelper"]],inputs:{type:"type"},features:[se([{provide:Ye,useExisting:le(()=>Op)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const iH={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new ue(.001953125,0)},cKernel:{value:[]}},vertexShader:"\n\n\t\tuniform vec2 uImageIncrement;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float cKernel[ KERNEL_SIZE_INT ];\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec2 uImageIncrement;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec2 imageCoord = vUv;\n\t\t\tvec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );\n\n\t\t\tfor( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {\n\n\t\t\t\tsum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];\n\t\t\t\timageCoord += uImageIncrement;\n\n\t\t\t}\n\n\t\t\tgl_FragColor = sum;\n\n\t\t}",buildKernel:function(i){let t=2*Math.ceil(3*i)+1;t>25&&(t=25);const n=.5*(t-1),r=new Array(t);let s=0;for(let o=0;o<t;++o)r[o]=hme(o-n,i),s+=r[o];for(let o=0;o<t;++o)r[o]/=s;return r}};function hme(i,e){return Math.exp(-i*i/(2*e*e))}class Lu extends vn{constructor(e=1,t=25,n=4){super(),this.renderTargetX=new Gt,this.renderTargetX.texture.name="BloomPass.x",this.renderTargetY=new Gt,this.renderTargetY.texture.name="BloomPass.y",this.combineUniforms=mi.clone(HR.uniforms),this.combineUniforms.strength.value=e,this.materialCombine=new Rt({uniforms:this.combineUniforms,vertexShader:HR.vertexShader,fragmentShader:HR.fragmentShader,blending:lf,transparent:!0});const r=iH;this.convolutionUniforms=mi.clone(r.uniforms),this.convolutionUniforms.uImageIncrement.value=Lu.blurX,this.convolutionUniforms.cKernel.value=iH.buildKernel(n),this.materialConvolution=new Rt({uniforms:this.convolutionUniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,defines:{KERNEL_SIZE_FLOAT:t.toFixed(1),KERNEL_SIZE_INT:t.toFixed(0)}}),this.needsSwap=!1,this.fsQuad=new wr(null)}render(e,t,n,r,s){s&&e.state.buffers.stencil.setTest(!1),this.fsQuad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=n.texture,this.convolutionUniforms.uImageIncrement.value=Lu.blurX,e.setRenderTarget(this.renderTargetX),e.clear(),this.fsQuad.render(e),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=Lu.blurY,e.setRenderTarget(this.renderTargetY),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCombine,this.combineUniforms.tDiffuse.value=this.renderTargetY.texture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(n),this.clear&&e.clear(),this.fsQuad.render(e)}setSize(e,t){this.renderTargetX.setSize(e,t),this.renderTargetY.setSize(e,t)}dispose(){this.renderTargetX.dispose(),this.renderTargetY.dispose(),this.materialCombine.dispose(),this.materialConvolution.dispose(),this.fsQuad.dispose()}}const HR={uniforms:{tDiffuse:{value:null},strength:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float strength;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = strength * texel;\n\n\t\t}"};Lu.blurX=new ue(.001953125,0),Lu.blurY=new ue(0,.001953125);class Np extends Hi{getType(){return Lu}set renderTargetX(e){this._objRef&&(this._objRef.renderTargetX=e)}set renderTargetY(e){this._objRef&&(this._objRef.renderTargetY=e)}set copyUniforms(e){this._objRef&&(this._objRef.copyUniforms=e)}set materialCopy(e){this._objRef&&(this._objRef.materialCopy=e)}set convolutionUniforms(e){this._objRef&&(this._objRef.convolutionUniforms=e)}set materialConvolution(e){this._objRef&&(this._objRef.materialConvolution=e)}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}}Np.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Np)))(t||Np)}}(),Np.\u0275cmp=$({type:Np,selectors:[["th-bloomPass"]],inputs:{renderTargetX:"renderTargetX",renderTargetY:"renderTargetY",copyUniforms:"copyUniforms",materialCopy:"materialCopy",convolutionUniforms:"convolutionUniforms",materialConvolution:"materialConvolution",fsQuad:"fsQuad"},features:[se([{provide:Pi,useExisting:le(()=>Np)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const fme={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:.01},nearClip:{value:1},farClip:{value:1e3}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\t#include <common>\n\n\t\tvarying vec2 vUv;\n\n\t\tuniform sampler2D tColor;\n\t\tuniform sampler2D tDepth;\n\n\t\tuniform float maxblur; // max blur amount\n\t\tuniform float aperture; // aperture - bigger values for shallower depth of field\n\n\t\tuniform float nearClip;\n\t\tuniform float farClip;\n\n\t\tuniform float focus;\n\t\tuniform float aspect;\n\n\t\t#include <packing>\n\n\t\tfloat getDepth( const in vec2 screenPosition ) {\n\t\t\t#if DEPTH_PACKING == 1\n\t\t\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );\n\t\t\t#else\n\t\t\treturn texture2D( tDepth, screenPosition ).x;\n\t\t\t#endif\n\t\t}\n\n\t\tfloat getViewZ( const in float depth ) {\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\t\t\treturn perspectiveDepthToViewZ( depth, nearClip, farClip );\n\t\t\t#else\n\t\t\treturn orthographicDepthToViewZ( depth, nearClip, farClip );\n\t\t\t#endif\n\t\t}\n\n\n\t\tvoid main() {\n\n\t\t\tvec2 aspectcorrect = vec2( 1.0, aspect );\n\n\t\t\tfloat viewZ = getViewZ( getDepth( vUv ) );\n\n\t\t\tfloat factor = ( focus + viewZ ); // viewZ is <= 0, so this is a difference equation\n\n\t\t\tvec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );\n\n\t\t\tvec2 dofblur9 = dofblur * 0.9;\n\t\t\tvec2 dofblur7 = dofblur * 0.7;\n\t\t\tvec2 dofblur4 = dofblur * 0.4;\n\n\t\t\tvec4 col = vec4( 0.0 );\n\n\t\t\tcol += texture2D( tColor, vUv.xy );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );\n\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );\n\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );\n\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );\n\n\t\t\tgl_FragColor = col / 41.0;\n\t\t\tgl_FragColor.a = 1.0;\n\n\t\t}"};class pme extends vn{constructor(e,t,n){super(),this.scene=e,this.camera=t;const r=void 0!==n.focus?n.focus:1,s=void 0!==n.aspect?n.aspect:t.aspect,o=void 0!==n.aperture?n.aperture:.025,a=void 0!==n.maxblur?n.maxblur:1;this.renderTargetDepth=new Gt(1,1,{minFilter:$t,magFilter:$t}),this.renderTargetDepth.texture.name="BokehPass.depth",this.materialDepth=new Zd,this.materialDepth.depthPacking=W_,this.materialDepth.blending=Kt;const l=fme,c=mi.clone(l.uniforms);c.tDepth.value=this.renderTargetDepth.texture,c.focus.value=r,c.aspect.value=s,c.aperture.value=o,c.maxblur.value=a,c.nearClip.value=t.near,c.farClip.value=t.far,this.materialBokeh=new Rt({defines:Object.assign({},l.defines),uniforms:c,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}),this.uniforms=c,this.needsSwap=!1,this.fsQuad=new wr(this.materialBokeh),this._oldClearColor=new De}render(e,t,n){this.scene.overrideMaterial=this.materialDepth,e.getClearColor(this._oldClearColor);const r=e.getClearAlpha(),s=e.autoClear;e.autoClear=!1,e.setClearColor(16777215),e.setClearAlpha(1),e.setRenderTarget(this.renderTargetDepth),e.clear(),e.render(this.scene,this.camera),this.uniforms.tColor.value=n.texture,this.uniforms.nearClip.value=this.camera.near,this.uniforms.farClip.value=this.camera.far,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),e.clear(),this.fsQuad.render(e)),this.scene.overrideMaterial=null,e.setClearColor(this._oldClearColor),e.setClearAlpha(r),e.autoClear=s}setSize(e,t){this.renderTargetDepth.setSize(e,t)}dispose(){this.renderTargetDepth.dispose(),this.materialDepth.dispose(),this.materialBokeh.dispose(),this.fsQuad.dispose()}}class jp extends Hi{getType(){return pme}set scene(e){this._objRef&&(this._objRef.scene=e)}set camera(e){this._objRef&&(this._objRef.camera=e)}set renderTargetColor(e){this._objRef&&(this._objRef.renderTargetColor=e)}set renderTargetDepth(e){this._objRef&&(this._objRef.renderTargetDepth=e)}set materialDepth(e){this._objRef&&(this._objRef.materialDepth=e)}set materialBokeh(e){this._objRef&&(this._objRef.materialBokeh=e)}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}set oldClearColor(e){this._objRef&&(this._objRef.oldClearColor=Qe(this._objRef.oldClearColor,e))}}jp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(jp)))(t||jp)}}(),jp.\u0275cmp=$({type:jp,selectors:[["th-bokehPass"]],inputs:{scene:"scene",camera:"camera",renderTargetColor:"renderTargetColor",renderTargetDepth:"renderTargetDepth",materialDepth:"materialDepth",materialBokeh:"materialBokeh",uniforms:"uniforms",fsQuad:"fsQuad",oldClearColor:"oldClearColor"},features:[se([{provide:Pi,useExisting:le(()=>jp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Up extends Ye{getType(){return Kd}set type(e){this._objRef&&(this._objRef.type=e)}}Up.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Up)))(t||Up)}}(),Up.\u0275cmp=$({type:Up,selectors:[["th-bone"]],inputs:{type:"type"},features:[se([{provide:Ye,useExisting:le(()=>Up)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Ou extends Es{getType(){return Y4}set type(e){this._objRef&&(this._objRef.type=e)}set box(e){this._objRef&&(this._objRef.box=Qe(this._objRef.box,e))}}Ou.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Ou)))(t||Ou)}}(),Ou.\u0275cmp=$({type:Ou,selectors:[["th-box3Helper"]],inputs:{type:"type",box:"box"},features:[se([{provide:Ye,useExisting:le(()=>Ou)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Vp extends Es{getType(){return X4}set type(e){this._objRef&&(this._objRef.type=e)}}Vp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Vp)))(t||Vp)}}(),Vp.\u0275cmp=$({type:Vp,selectors:[["th-boxHelper"]],inputs:{type:"type"},features:[se([{provide:Ye,useExisting:le(()=>Vp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class mme extends xt{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super();const a=e/2,l=t/2,c=n/2,d=e/(r=Math.floor(r)),u=t/(s=Math.floor(s)),h=n/(o=Math.floor(o)),f=[];let m=-a,p=-l,g=-c;for(let _=0;_<=r;_++)f.push(m,-l,-c,m,l,-c),f.push(m,l,-c,m,l,c),f.push(m,l,c,m,-l,c),f.push(m,-l,c,m,-l,-c),m+=d;for(let _=0;_<=s;_++)f.push(-a,p,-c,a,p,-c),f.push(a,p,-c,a,p,c),f.push(a,p,c,-a,p,c),f.push(-a,p,c,-a,p,-c),p+=u;for(let _=0;_<=o;_++)f.push(-a,-l,g,-a,l,g),f.push(-a,l,g,a,l,g),f.push(a,l,g,a,-l,g),f.push(a,-l,g,-a,-l,g),g+=h;this.setAttribute("position",new Ge(f,3))}}class zp extends Mt{getType(){return mme}}zp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(zp)))(t||zp)}}(),zp.\u0275cmp=$({type:zp,selectors:[["th-boxLineGeometry"]],features:[se([{provide:Mt,useExisting:le(()=>zp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Hp extends Es{getType(){return q4}set camera(e){this._objRef&&(this._objRef.camera=e)}set pointMap(e){this._objRef&&(this._objRef.pointMap=e)}set type(e){this._objRef&&(this._objRef.type=e)}}Hp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Hp)))(t||Hp)}}(),Hp.\u0275cmp=$({type:Hp,selectors:[["th-cameraHelper"]],inputs:{camera:"camera",pointMap:"pointMap",type:"type"},features:[se([{provide:Ye,useExisting:le(()=>Hp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Cr extends Eo{}Cr.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Cr)))(t||Cr)}}(),Cr.\u0275cmp=$({type:Cr,selectors:[["th-abs-texture"]],features:[W],decls:0,vars:0,template:function(e,t){},encapsulation:2});class Ir extends Cr{getType(){return qn}set id(e){this._objRef&&(this._objRef.id=e)}set uuid(e){this._objRef&&(this._objRef.uuid=e)}set name(e){this._objRef&&(this._objRef.name=e)}set sourceFile(e){this._objRef&&(this._objRef.sourceFile=e)}set source(e){this._objRef&&(this._objRef.source=e)}set mipmaps(e){this._objRef&&(this._objRef.mipmaps=e)}set mapping(e){this._objRef&&(this._objRef.mapping=e)}set wrapS(e){this._objRef&&(this._objRef.wrapS=e)}set wrapT(e){this._objRef&&(this._objRef.wrapT=e)}set magFilter(e){this._objRef&&(this._objRef.magFilter=e)}set minFilter(e){this._objRef&&(this._objRef.minFilter=e)}set anisotropy(e){this._objRef&&(this._objRef.anisotropy=e)}set format(e){this._objRef&&(this._objRef.format=e)}set internalFormat(e){this._objRef&&(this._objRef.internalFormat=e)}set type(e){this._objRef&&(this._objRef.type=e)}set matrix(e){this._objRef&&(this._objRef.matrix=Qe(this._objRef.matrix,e))}set matrixAutoUpdate(e){this._objRef&&(this._objRef.matrixAutoUpdate=e)}set offset(e){this._objRef&&(this._objRef.offset=Qe(this._objRef.offset,e))}set repeat(e){this._objRef&&(this._objRef.repeat=Qe(this._objRef.repeat,e))}set center(e){this._objRef&&(this._objRef.center=Qe(this._objRef.center,e))}set rotation(e){this._objRef&&(this._objRef.rotation=e)}set generateMipmaps(e){this._objRef&&(this._objRef.generateMipmaps=e)}set premultiplyAlpha(e){this._objRef&&(this._objRef.premultiplyAlpha=e)}set flipY(e){this._objRef&&(this._objRef.flipY=e)}set unpackAlignment(e){this._objRef&&(this._objRef.unpackAlignment=e)}set encoding(e){this._objRef&&(this._objRef.encoding=e)}set isRenderTargetTexture(e){this._objRef&&(this._objRef.isRenderTargetTexture=e)}set needsPMREMUpdate(e){this._objRef&&(this._objRef.needsPMREMUpdate=e)}set userData(e){this._objRef&&(this._objRef.userData=e)}set version(e){this._objRef&&(this._objRef.version=e)}}Ir.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Ir)))(t||Ir)}}(),Ir.\u0275cmp=$({type:Ir,selectors:[["th-texture"]],inputs:{id:"id",uuid:"uuid",name:"name",sourceFile:"sourceFile",source:"source",mipmaps:"mipmaps",mapping:"mapping",wrapS:"wrapS",wrapT:"wrapT",magFilter:"magFilter",minFilter:"minFilter",anisotropy:"anisotropy",format:"format",internalFormat:"internalFormat",type:"type",matrix:"matrix",matrixAutoUpdate:"matrixAutoUpdate",offset:"offset",repeat:"repeat",center:"center",rotation:"rotation",generateMipmaps:"generateMipmaps",premultiplyAlpha:"premultiplyAlpha",flipY:"flipY",unpackAlignment:"unpackAlignment",encoding:"encoding",isRenderTargetTexture:"isRenderTargetTexture",needsPMREMUpdate:"needsPMREMUpdate",userData:"userData",version:"version"},features:[se([{provide:Cr,useExisting:le(()=>Ir)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Gp extends Ir{getType(){return ax}}Gp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Gp)))(t||Gp)}}(),Gp.\u0275cmp=$({type:Gp,selectors:[["th-canvasTexture"]],features:[se([{provide:Cr,useExisting:le(()=>Gp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Qp extends Mt{getType(){return Zf}set type(e){this._objRef&&(this._objRef.type=e)}set parameters(e){this._objRef&&(this._objRef.parameters=e)}}Qp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Qp)))(t||Qp)}}(),Qp.\u0275cmp=$({type:Qp,selectors:[["th-capsuleGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[se([{provide:Mt,useExisting:le(()=>Qp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Wp extends Mt{getType(){return Kf}set type(e){this._objRef&&(this._objRef.type=e)}set parameters(e){this._objRef&&(this._objRef.parameters=e)}}Wp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Wp)))(t||Wp)}}(),Wp.\u0275cmp=$({type:Wp,selectors:[["th-circleGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[se([{provide:Mt,useExisting:le(()=>Wp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class qp extends Hi{getType(){return Qz}}qp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(qp)))(t||qp)}}(),qp.\u0275cmp=$({type:qp,selectors:[["th-clearMaskPass"]],features:[se([{provide:Pi,useExisting:le(()=>qp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class gme extends vn{constructor(e,t){super(),this.needsSwap=!1,this.clearColor=void 0!==e?e:0,this.clearAlpha=void 0!==t?t:0,this._oldClearColor=new De}render(e,t,n){let r;this.clearColor&&(e.getClearColor(this._oldClearColor),r=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),e.setRenderTarget(this.renderToScreen?null:n),e.clear(),this.clearColor&&e.setClearColor(this._oldClearColor,r)}}class Xp extends Hi{getType(){return gme}set clearColor(e){this._objRef&&(this._objRef.clearColor=e)}set clearAlpha(e){this._objRef&&(this._objRef.clearAlpha=e)}}Xp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Xp)))(t||Xp)}}(),Xp.\u0275cmp=$({type:Xp,selectors:[["th-clearPass"]],inputs:{clearColor:"clearColor",clearAlpha:"clearAlpha"},features:[se([{provide:Pi,useExisting:le(()=>Xp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Wa extends Ir{getType(){return m0}set mipmaps(e){this._objRef&&(this._objRef.mipmaps=e)}set flipY(e){this._objRef&&(this._objRef.flipY=e)}set generateMipmaps(e){this._objRef&&(this._objRef.generateMipmaps=e)}}Wa.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Wa)))(t||Wa)}}(),Wa.\u0275cmp=$({type:Wa,selectors:[["th-compressedTexture"]],inputs:{mipmaps:"mipmaps",flipY:"flipY",generateMipmaps:"generateMipmaps"},features:[se([{provide:Cr,useExisting:le(()=>Wa)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Yp extends Wa{getType(){return qT}set isCompressedArrayTexture(e){this._objRef&&(this._objRef.isCompressedArrayTexture=e)}set wrapR(e){this._objRef&&(this._objRef.wrapR=e)}}Yp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Yp)))(t||Yp)}}(),Yp.\u0275cmp=$({type:Yp,selectors:[["th-compressedArrayTexture"]],inputs:{isCompressedArrayTexture:"isCompressedArrayTexture",wrapR:"wrapR"},features:[se([{provide:Cr,useExisting:le(()=>Yp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Nu extends Mt{getType(){return jn}set type(e){this._objRef&&(this._objRef.type=e)}set parameters(e){this._objRef&&(this._objRef.parameters=e)}}Nu.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Nu)))(t||Nu)}}(),Nu.\u0275cmp=$({type:Nu,selectors:[["th-cylinderGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[se([{provide:Mt,useExisting:le(()=>Nu)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Zp extends Nu{getType(){return $f}set type(e){this._objRef&&(this._objRef.type=e)}}Zp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Zp)))(t||Zp)}}(),Zp.\u0275cmp=$({type:Zp,selectors:[["th-coneGeometry"]],inputs:{type:"type"},features:[se([{provide:Mt,useExisting:le(()=>Zp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const bme=new T,nH=new F4,GR=new to,rH=new T,Iw=new Js;class vme{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new sH,this.unassigned=new sH,this.vertices=[]}setFromPoints(e){if(e.length>=4){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.vertices.push(new yme(e[t]));this.compute()}return this}setFromObject(e){const t=[];return e.updateMatrixWorld(!0),e.traverse(function(n){const r=n.geometry;if(void 0!==r){const s=r.attributes.position;if(void 0!==s)for(let o=0,a=s.count;o<a;o++){const l=new T;l.fromBufferAttribute(s,o).applyMatrix4(n.matrixWorld),t.push(l)}}}),this.setFromPoints(t)}containsPoint(e){const t=this.faces;for(let n=0,r=t.length;n<r;n++)if(t[n].distanceToPoint(e)>this.tolerance)return!1;return!0}intersectRay(e,t){const n=this.faces;let r=-1/0,s=1/0;for(let o=0,a=n.length;o<a;o++){const l=n[o],c=l.distanceToPoint(e.origin),d=l.normal.dot(e.direction);if(c>0&&d>=0)return null;const u=0!==d?-c/d:0;if(!(u<=0)&&(d>0?s=Math.min(u,s):r=Math.max(u,r),r>s))return null}return e.at(r!==-1/0?r:s,t),t}intersectsRay(e){return null!==this.intersectRay(e,bme)}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(e,t){return e.face=t,null===t.outside?this.assigned.append(e):this.assigned.insertBefore(t.outside,e),t.outside=e,this}removeVertexFromFace(e,t){return e===t.outside&&(t.outside=null!==e.next&&e.next.face===t?e.next:null),this.assigned.remove(e),this}removeAllVerticesFromFace(e){if(null!==e.outside){const t=e.outside;let n=e.outside;for(;null!==n.next&&n.next.face===e;)n=n.next;return this.assigned.removeSubList(t,n),t.prev=n.next=null,e.outside=null,t}}deleteFaceVertices(e,t){const n=this.removeAllVerticesFromFace(e);if(void 0!==n)if(void 0===t)this.unassigned.appendChain(n);else{let r=n;do{const s=r.next;t.distanceToPoint(r.point)>this.tolerance?this.addVertexToFace(r,t):this.unassigned.append(r),r=s}while(null!==r)}return this}resolveUnassignedPoints(e){if(!1===this.unassigned.isEmpty()){let t=this.unassigned.first();do{const n=t.next;let r=this.tolerance,s=null;for(let o=0;o<e.length;o++){const a=e[o];if(0===a.mark){const l=a.distanceToPoint(t.point);if(l>r&&(r=l,s=a),r>1e3*this.tolerance)break}}null!==s&&this.addVertexToFace(t,s),t=n}while(null!==t)}return this}computeExtremes(){const e=new T,t=new T,n=[],r=[];for(let s=0;s<3;s++)n[s]=r[s]=this.vertices[0];e.copy(this.vertices[0].point),t.copy(this.vertices[0].point);for(let s=0,o=this.vertices.length;s<o;s++){const a=this.vertices[s],l=a.point;for(let c=0;c<3;c++)l.getComponent(c)<e.getComponent(c)&&(e.setComponent(c,l.getComponent(c)),n[c]=a);for(let c=0;c<3;c++)l.getComponent(c)>t.getComponent(c)&&(t.setComponent(c,l.getComponent(c)),r[c]=a)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(e.x),Math.abs(t.x))+Math.max(Math.abs(e.y),Math.abs(t.y))+Math.max(Math.abs(e.z),Math.abs(t.z))),{min:n,max:r}}computeInitialHull(){const e=this.vertices,t=this.computeExtremes(),n=t.min,r=t.max;let s=0,o=0;for(let h=0;h<3;h++){const f=r[h].point.getComponent(h)-n[h].point.getComponent(h);f>s&&(s=f,o=h)}const a=n[o],l=r[o];let c,d;s=0,nH.set(a.point,l.point);for(let h=0,f=this.vertices.length;h<f;h++){const m=e[h];if(m!==a&&m!==l){nH.closestPointToPoint(m.point,!0,rH);const p=rH.distanceToSquared(m.point);p>s&&(s=p,c=m)}}s=-1,GR.setFromCoplanarPoints(a.point,l.point,c.point);for(let h=0,f=this.vertices.length;h<f;h++){const m=e[h];if(m!==a&&m!==l&&m!==c){const p=Math.abs(GR.distanceToPoint(m.point));p>s&&(s=p,d=m)}}const u=[];if(GR.distanceToPoint(d.point)<0){u.push(ha.create(a,l,c),ha.create(d,l,a),ha.create(d,c,l),ha.create(d,a,c));for(let h=0;h<3;h++){const f=(h+1)%3;u[h+1].getEdge(2).setTwin(u[0].getEdge(f)),u[h+1].getEdge(1).setTwin(u[f+1].getEdge(0))}}else{u.push(ha.create(a,c,l),ha.create(d,a,l),ha.create(d,l,c),ha.create(d,c,a));for(let h=0;h<3;h++){const f=(h+1)%3;u[h+1].getEdge(2).setTwin(u[0].getEdge((3-h)%3)),u[h+1].getEdge(0).setTwin(u[f+1].getEdge(1))}}for(let h=0;h<4;h++)this.faces.push(u[h]);for(let h=0,f=e.length;h<f;h++){const m=e[h];if(m!==a&&m!==l&&m!==c&&m!==d){s=this.tolerance;let p=null;for(let g=0;g<4;g++){const _=this.faces[g].distanceToPoint(m.point);_>s&&(s=_,p=this.faces[g])}null!==p&&this.addVertexToFace(m,p)}}return this}reindexFaces(){const e=[];for(let t=0;t<this.faces.length;t++){const n=this.faces[t];0===n.mark&&e.push(n)}return this.faces=e,this}nextVertexToAdd(){if(!1===this.assigned.isEmpty()){let e,t=0;const n=this.assigned.first().face;let r=n.outside;do{const s=n.distanceToPoint(r.point);s>t&&(t=s,e=r),r=r.next}while(null!==r&&r.face===n);return e}}computeHorizon(e,t,n,r){let s;this.deleteFaceVertices(n),n.mark=1,s=null===t?t=n.getEdge(0):t.next;do{const o=s.twin,a=o.face;0===a.mark&&(a.distanceToPoint(e)>this.tolerance?this.computeHorizon(e,o,a,r):r.push(s)),s=s.next}while(s!==t);return this}addAdjoiningFace(e,t){const n=ha.create(e,t.tail(),t.head());return this.faces.push(n),n.getEdge(-1).setTwin(t.twin),n.getEdge(0)}addNewFaces(e,t){this.newFaces=[];let n=null,r=null;for(let s=0;s<t.length;s++){const a=this.addAdjoiningFace(e,t[s]);null===n?n=a:a.next.setTwin(r),this.newFaces.push(a.face),r=a}return n.next.setTwin(r),this}addVertexToHull(e){const t=[];return this.unassigned.clear(),this.removeVertexFromFace(e,e.face),this.computeHorizon(e.point,null,e.face,t),this.addNewFaces(e,t),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let e;for(this.computeInitialHull();void 0!==(e=this.nextVertexToAdd());)this.addVertexToHull(e);return this.reindexFaces(),this.cleanup(),this}}class ha{constructor(){this.normal=new T,this.midpoint=new T,this.area=0,this.constant=0,this.outside=null,this.mark=0,this.edge=null}static create(e,t,n){const r=new ha,s=new QR(e,r),o=new QR(t,r),a=new QR(n,r);return s.next=a.prev=o,o.next=s.prev=a,a.next=o.prev=s,r.edge=s,r.compute()}getEdge(e){let t=this.edge;for(;e>0;)t=t.next,e--;for(;e<0;)t=t.prev,e++;return t}compute(){const e=this.edge.tail(),t=this.edge.head(),n=this.edge.next.head();return Iw.set(e.point,t.point,n.point),Iw.getNormal(this.normal),Iw.getMidpoint(this.midpoint),this.area=Iw.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(e){return this.normal.dot(e)-this.constant}}class QR{constructor(e,t){this.vertex=e,this.prev=null,this.next=null,this.twin=null,this.face=t}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const e=this.head(),t=this.tail();return null!==t?t.point.distanceTo(e.point):-1}lengthSquared(){const e=this.head(),t=this.tail();return null!==t?t.point.distanceToSquared(e.point):-1}setTwin(e){return this.twin=e,e.twin=this,this}}class yme{constructor(e){this.point=e,this.prev=null,this.next=null,this.face=null}}class sH{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(e,t){return t.prev=e.prev,t.next=e,null===t.prev?this.head=t:t.prev.next=t,e.prev=t,this}insertAfter(e,t){return t.prev=e,t.next=e.next,null===t.next?this.tail=t:t.next.prev=t,e.next=t,this}append(e){return null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e,this}appendChain(e){for(null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail;null!==e.next;)e=e.next;return this.tail=e,this}remove(e){return null===e.prev?this.head=e.next:e.prev.next=e.next,null===e.next?this.tail=e.prev:e.next.prev=e.prev,this}removeSubList(e,t){return null===e.prev?this.head=t.next:e.prev.next=t.next,null===t.next?this.tail=e.prev:t.next.prev=e.prev,this}isEmpty(){return null===this.head}}class Ame extends xt{constructor(e=[]){super();const t=[],n=[],s=(new vme).setFromPoints(e).faces;for(let o=0;o<s.length;o++){const a=s[o];let l=a.edge;do{const c=l.head().point;t.push(c.x,c.y,c.z),n.push(a.normal.x,a.normal.y,a.normal.z),l=l.next}while(l!==a.edge)}this.setAttribute("position",new Ge(t,3)),this.setAttribute("normal",new Ge(n,3))}}class Kp extends Mt{getType(){return Ame}}Kp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Kp)))(t||Kp)}}(),Kp.\u0275cmp=$({type:Kp,selectors:[["th-convexGeometry"]],features:[se([{provide:Mt,useExisting:le(()=>Kp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class $p extends Ye{getType(){return DT}set type(e){this._objRef&&(this._objRef.type=e)}set renderTarget(e){this._objRef&&(this._objRef.renderTarget=e)}}$p.\u0275fac=function(){let i;return function(t){return(i||(i=ce($p)))(t||$p)}}(),$p.\u0275cmp=$({type:$p,selectors:[["th-cubeCamera"]],inputs:{type:"type",renderTarget:"renderTarget"},features:[se([{provide:Ye,useExisting:le(()=>$p)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Jp extends Ir{getType(){return qd}set images(e){this._objRef&&(this._objRef.images=e)}set flipY(e){this._objRef&&(this._objRef.flipY=e)}}Jp.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Jp)))(t||Jp)}}(),Jp.\u0275cmp=$({type:Jp,selectors:[["th-cubeTexture"]],inputs:{images:"images",flipY:"flipY"},features:[se([{provide:Cr,useExisting:le(()=>Jp)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class xme extends vn{constructor(e,t,n=1){super(),this.camera=e,this.needsSwap=!1,this.cubeShader=wo.cube,this.cubeMesh=new Ke(new Ki(10,10,10),new Rt({uniforms:mi.clone(this.cubeShader.uniforms),vertexShader:this.cubeShader.vertexShader,fragmentShader:this.cubeShader.fragmentShader,depthTest:!1,depthWrite:!1,side:ys})),Object.defineProperty(this.cubeMesh.material,"envMap",{get:function(){return this.uniforms.tCube.value}}),this.tCube=t,this.opacity=n,this.cubeScene=new YA,this.cubeCamera=new Sn,this.cubeScene.add(this.cubeMesh)}render(e,t,n){const r=e.autoClear;e.autoClear=!1,this.cubeCamera.projectionMatrix.copy(this.camera.projectionMatrix),this.cubeCamera.quaternion.setFromRotationMatrix(this.camera.matrixWorld),this.cubeMesh.material.uniforms.tCube.value=this.tCube,this.cubeMesh.material.uniforms.tFlip.value=this.tCube.isCubeTexture&&!1===this.tCube.isRenderTargetTexture?-1:1,this.cubeMesh.material.uniforms.opacity.value=this.opacity,this.cubeMesh.material.transparent=this.opacity<1,e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(),e.render(this.cubeScene,this.cubeCamera),e.autoClear=r}dispose(){this.cubeMesh.geometry.dispose(),this.cubeMesh.material.dispose()}}class em extends Hi{getType(){return xme}set camera(e){this._objRef&&(this._objRef.camera=e)}set cubeShader(e){this._objRef&&(this._objRef.cubeShader=e)}set cubeMesh(e){this._objRef&&(this._objRef.cubeMesh=e)}set envMap(e){this._objRef&&(this._objRef.envMap=e)}set opacity(e){this._objRef&&(this._objRef.opacity=e)}set cubeScene(e){this._objRef&&(this._objRef.cubeScene=e)}set cubeCamera(e){this._objRef&&(this._objRef.cubeCamera=e)}}em.\u0275fac=function(){let i;return function(t){return(i||(i=ce(em)))(t||em)}}(),em.\u0275cmp=$({type:em,selectors:[["th-cubeTexturePass"]],inputs:{camera:"camera",cubeShader:"cubeShader",cubeMesh:"cubeMesh",envMap:"envMap",opacity:"opacity",cubeScene:"cubeScene",cubeCamera:"cubeCamera"},features:[se([{provide:Pi,useExisting:le(()=>em)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class ju extends Ir{getType(){return Ef}set magFilter(e){this._objRef&&(this._objRef.magFilter=e)}set minFilter(e){this._objRef&&(this._objRef.minFilter=e)}set wrapR(e){this._objRef&&(this._objRef.wrapR=e)}set flipY(e){this._objRef&&(this._objRef.flipY=e)}set generateMipmaps(e){this._objRef&&(this._objRef.generateMipmaps=e)}}ju.\u0275fac=function(){let i;return function(t){return(i||(i=ce(ju)))(t||ju)}}(),ju.\u0275cmp=$({type:ju,selectors:[["th-data3DTexture"]],inputs:{magFilter:"magFilter",minFilter:"minFilter",wrapR:"wrapR",flipY:"flipY",generateMipmaps:"generateMipmaps"},features:[se([{provide:Cr,useExisting:le(()=>ju)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Uu extends Ir{getType(){return Mf}set magFilter(e){this._objRef&&(this._objRef.magFilter=e)}set minFilter(e){this._objRef&&(this._objRef.minFilter=e)}set wrapR(e){this._objRef&&(this._objRef.wrapR=e)}set flipY(e){this._objRef&&(this._objRef.flipY=e)}set generateMipmaps(e){this._objRef&&(this._objRef.generateMipmaps=e)}}Uu.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Uu)))(t||Uu)}}(),Uu.\u0275cmp=$({type:Uu,selectors:[["th-dataArrayTexture"]],inputs:{magFilter:"magFilter",minFilter:"minFilter",wrapR:"wrapR",flipY:"flipY",generateMipmaps:"generateMipmaps"},features:[se([{provide:Cr,useExisting:le(()=>Uu)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class fa extends Ir{getType(){return ka}set flipY(e){this._objRef&&(this._objRef.flipY=e)}set generateMipmaps(e){this._objRef&&(this._objRef.generateMipmaps=e)}set unpackAlignment(e){this._objRef&&(this._objRef.unpackAlignment=e)}set format(e){this._objRef&&(this._objRef.format=e)}}fa.\u0275fac=function(){let i;return function(t){return(i||(i=ce(fa)))(t||fa)}}(),fa.\u0275cmp=$({type:fa,selectors:[["th-dataTexture"]],inputs:{flipY:"flipY",generateMipmaps:"generateMipmaps",unpackAlignment:"unpackAlignment",format:"format"},features:[se([{provide:Cr,useExisting:le(()=>fa)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class tm extends Uu{getType(){return e5}}tm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(tm)))(t||tm)}}(),tm.\u0275cmp=$({type:tm,selectors:[["th-dataTexture2DArray"]],features:[se([{provide:Cr,useExisting:le(()=>tm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class im extends ju{getType(){return t5}}im.\u0275fac=function(){let i;return function(t){return(i||(i=ce(im)))(t||im)}}(),im.\u0275cmp=$({type:im,selectors:[["th-dataTexture3D"]],features:[se([{provide:Cr,useExisting:le(()=>im)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class wme extends xt{constructor(e,t,n,r){super();const s=[],o=[],a=[],l=new T,c=new Ve;c.makeRotationFromEuler(n),c.setPosition(t);const d=new Ve;function h(p,g,_){g.applyMatrix4(e.matrixWorld),g.applyMatrix4(d),_.transformDirection(e.matrixWorld),p.push(new oH(g.clone(),_.clone()))}function f(p,g){const _=[],v=.5*Math.abs(r.dot(g));for(let b=0;b<p.length;b+=3){let x,C,M,w,y=0;const Q=p[b+0].position.dot(g)-v>0,B=p[b+1].position.dot(g)-v>0,L=p[b+2].position.dot(g)-v>0;switch(y=(Q?1:0)+(B?1:0)+(L?1:0),y){case 0:_.push(p[b]),_.push(p[b+1]),_.push(p[b+2]);break;case 1:if(Q&&(x=p[b+1],C=p[b+2],M=m(p[b],x,g,v),w=m(p[b],C,g,v)),B){x=p[b],C=p[b+2],M=m(p[b+1],x,g,v),w=m(p[b+1],C,g,v),_.push(M),_.push(C.clone()),_.push(x.clone()),_.push(C.clone()),_.push(M.clone()),_.push(w);break}L&&(x=p[b],C=p[b+1],M=m(p[b+2],x,g,v),w=m(p[b+2],C,g,v)),_.push(x.clone()),_.push(C.clone()),_.push(M),_.push(w),_.push(M.clone()),_.push(C.clone());break;case 2:Q||(x=p[b].clone(),C=m(x,p[b+1],g,v),M=m(x,p[b+2],g,v),_.push(x),_.push(C),_.push(M)),B||(x=p[b+1].clone(),C=m(x,p[b+2],g,v),M=m(x,p[b],g,v),_.push(x),_.push(C),_.push(M)),L||(x=p[b+2].clone(),C=m(x,p[b],g,v),M=m(x,p[b+1],g,v),_.push(x),_.push(C),_.push(M))}}return _}function m(p,g,_,v){const b=p.position.dot(_)-v,x=b/(b-(g.position.dot(_)-v));return new oH(new T(p.position.x+x*(g.position.x-p.position.x),p.position.y+x*(g.position.y-p.position.y),p.position.z+x*(g.position.z-p.position.z)),new T(p.normal.x+x*(g.normal.x-p.normal.x),p.normal.y+x*(g.normal.y-p.normal.y),p.normal.z+x*(g.normal.z-p.normal.z)))}d.copy(c).invert(),function u(){let p=[];const g=new T,_=new T,v=e.geometry,b=v.attributes.position,y=v.attributes.normal;if(null!==v.index){const x=v.index;for(let C=0;C<x.count;C++)g.fromBufferAttribute(b,x.getX(C)),_.fromBufferAttribute(y,x.getX(C)),h(p,g,_)}else for(let x=0;x<b.count;x++)g.fromBufferAttribute(b,x),_.fromBufferAttribute(y,x),h(p,g,_);p=f(p,l.set(1,0,0)),p=f(p,l.set(-1,0,0)),p=f(p,l.set(0,1,0)),p=f(p,l.set(0,-1,0)),p=f(p,l.set(0,0,1)),p=f(p,l.set(0,0,-1));for(let x=0;x<p.length;x++){const C=p[x];a.push(.5+C.position.x/r.x,.5+C.position.y/r.y),C.position.applyMatrix4(c),s.push(C.position.x,C.position.y,C.position.z),o.push(C.normal.x,C.normal.y,C.normal.z)}}(),this.setAttribute("position",new Ge(s,3)),this.setAttribute("normal",new Ge(o,3)),this.setAttribute("uv",new Ge(a,2))}}class oH{constructor(e,t){this.position=e,this.normal=t}clone(){return new this.constructor(this.position.clone(),this.normal.clone())}}class nm extends Mt{getType(){return wme}}nm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(nm)))(t||nm)}}(),nm.\u0275cmp=$({type:nm,selectors:[["th-decalGeometry"]],features:[se([{provide:Mt,useExisting:le(()=>nm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class rm extends Ir{getType(){return Hf}set flipY(e){this._objRef&&(this._objRef.flipY=e)}set generateMipmaps(e){this._objRef&&(this._objRef.generateMipmaps=e)}}rm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(rm)))(t||rm)}}(),rm.\u0275cmp=$({type:rm,selectors:[["th-depthTexture"]],inputs:{flipY:"flipY",generateMipmaps:"generateMipmaps"},features:[se([{provide:Cr,useExisting:le(()=>rm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class sm extends Ye{getType(){return W4}set light(e){this._objRef&&(this._objRef.light=e)}set lightPlane(e){this._objRef&&(this._objRef.lightPlane=e)}set targetLine(e){this._objRef&&(this._objRef.targetLine=e)}set color(e){this._objRef&&(this._objRef.color=e)}set matrix(e){this._objRef&&(this._objRef.matrix=Qe(this._objRef.matrix,e))}set matrixAutoUpdate(e){this._objRef&&(this._objRef.matrixAutoUpdate=e)}}sm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(sm)))(t||sm)}}(),sm.\u0275cmp=$({type:sm,selectors:[["th-directionalLightHelper"]],inputs:{light:"light",lightPlane:"lightPlane",targetLine:"targetLine",color:"color",matrix:"matrix",matrixAutoUpdate:"matrixAutoUpdate"},features:[se([{provide:Ye,useExisting:le(()=>sm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class qa extends Mt{getType(){return Fa}set type(e){this._objRef&&(this._objRef.type=e)}set parameters(e){this._objRef&&(this._objRef.parameters=e)}}qa.\u0275fac=function(){let i;return function(t){return(i||(i=ce(qa)))(t||qa)}}(),qa.\u0275cmp=$({type:qa,selectors:[["th-polyhedronGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[se([{provide:Mt,useExisting:le(()=>qa)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class om extends qa{getType(){return Jf}set type(e){this._objRef&&(this._objRef.type=e)}}om.\u0275fac=function(){let i;return function(t){return(i||(i=ce(om)))(t||om)}}(),om.\u0275cmp=$({type:om,selectors:[["th-dodecahedronGeometry"]],inputs:{type:"type"},features:[se([{provide:Mt,useExisting:le(()=>om)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const WR={uniforms:{tDiffuse:{value:null},tSize:{value:new ue(256,256)},center:{value:new ue(.5,.5)},angle:{value:1.57},scale:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform vec2 center;\n\t\tuniform float angle;\n\t\tuniform float scale;\n\t\tuniform vec2 tSize;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tfloat pattern() {\n\n\t\t\tfloat s = sin( angle ), c = cos( angle );\n\n\t\t\tvec2 tex = vUv * tSize - center;\n\t\t\tvec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;\n\n\t\t\treturn ( sin( point.x ) * sin( point.y ) ) * 4.0;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvec4 color = texture2D( tDiffuse, vUv );\n\n\t\t\tfloat average = ( color.r + color.g + color.b ) / 3.0;\n\n\t\t\tgl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );\n\n\t\t}"};class Cme extends vn{constructor(e,t,n){super();const r=WR;this.uniforms=mi.clone(r.uniforms),void 0!==e&&this.uniforms.center.value.copy(e),void 0!==t&&(this.uniforms.angle.value=t),void 0!==n&&(this.uniforms.scale.value=n),this.material=new Rt({uniforms:this.uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}),this.fsQuad=new wr(this.material)}render(e,t,n){this.uniforms.tDiffuse.value=n.texture,this.uniforms.tSize.value.set(n.width,n.height),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class am extends Hi{getType(){return Cme}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}set material(e){this._objRef&&(this._objRef.material=e)}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}}am.\u0275fac=function(){let i;return function(t){return(i||(i=ce(am)))(t||am)}}(),am.\u0275cmp=$({type:am,selectors:[["th-dotScreenPass"]],inputs:{uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[se([{provide:Pi,useExisting:le(()=>am)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const lm=new to,Nc=new gu,gb=new ue,aH=new T,Rw=new T,qR=new T,lH=new Ve;class Mme extends os{constructor(e,t,n){super(),n.style.touchAction="none";let r=null,s=null;const o=[],a=this;function l(){n.addEventListener("pointermove",f),n.addEventListener("pointerdown",m),n.addEventListener("pointerup",p),n.addEventListener("pointerleave",p)}function c(){n.removeEventListener("pointermove",f),n.removeEventListener("pointerdown",m),n.removeEventListener("pointerup",p),n.removeEventListener("pointerleave",p),n.style.cursor=""}function f(_){if(!1!==a.enabled){if(g(_),Nc.setFromCamera(gb,t),r)return Nc.ray.intersectPlane(lm,Rw)&&r.position.copy(Rw.sub(aH).applyMatrix4(lH)),void a.dispatchEvent({type:"drag",object:r});if("mouse"===_.pointerType||"pen"===_.pointerType)if(o.length=0,Nc.setFromCamera(gb,t),Nc.intersectObjects(e,!0,o),o.length>0){const v=o[0].object;lm.setFromNormalAndCoplanarPoint(t.getWorldDirection(lm.normal),qR.setFromMatrixPosition(v.matrixWorld)),s!==v&&null!==s&&(a.dispatchEvent({type:"hoveroff",object:s}),n.style.cursor="auto",s=null),s!==v&&(a.dispatchEvent({type:"hoveron",object:v}),n.style.cursor="pointer",s=v)}else null!==s&&(a.dispatchEvent({type:"hoveroff",object:s}),n.style.cursor="auto",s=null)}}function m(_){!1!==a.enabled&&(g(_),o.length=0,Nc.setFromCamera(gb,t),Nc.intersectObjects(e,!0,o),o.length>0&&(r=!0===a.transformGroup?e[0]:o[0].object,lm.setFromNormalAndCoplanarPoint(t.getWorldDirection(lm.normal),qR.setFromMatrixPosition(r.matrixWorld)),Nc.ray.intersectPlane(lm,Rw)&&(lH.copy(r.parent.matrixWorld).invert(),aH.copy(Rw).sub(qR.setFromMatrixPosition(r.matrixWorld))),n.style.cursor="move",a.dispatchEvent({type:"dragstart",object:r})))}function p(){!1!==a.enabled&&(r&&(a.dispatchEvent({type:"dragend",object:r}),r=null),n.style.cursor=s?"pointer":"auto")}function g(_){const v=n.getBoundingClientRect();gb.x=(_.clientX-v.left)/v.width*2-1,gb.y=-(_.clientY-v.top)/v.height*2+1}l(),this.enabled=!0,this.transformGroup=!1,this.activate=l,this.deactivate=c,this.dispose=function d(){c()},this.getObjects=function u(){return e},this.getRaycaster=function h(){return Nc}}}class Vu extends zn{getType(){return Mme}set object(e){this._objRef&&(this._objRef.object=e)}set enabled(e){this._objRef&&(this._objRef.enabled=e)}set transformGroup(e){this._objRef&&(this._objRef.transformGroup=e)}}Vu.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Vu)))(t||Vu)}}(),Vu.\u0275cmp=$({type:Vu,selectors:[["th-dragControls"]],inputs:{object:"object",enabled:"enabled",transformGroup:"transformGroup"},features:[se([{provide:zn,useExisting:le(()=>Vu)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class cm extends Mt{getType(){return rI}set type(e){this._objRef&&(this._objRef.type=e)}set parameters(e){this._objRef&&(this._objRef.parameters=e)}}cm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(cm)))(t||cm)}}(),cm.\u0275cmp=$({type:cm,selectors:[["th-edgesGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[se([{provide:Mt,useExisting:le(()=>cm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class zu extends Mt{getType(){return iu}set type(e){this._objRef&&(this._objRef.type=e)}}zu.\u0275fac=function(){let i;return function(t){return(i||(i=ce(zu)))(t||zu)}}(),zu.\u0275cmp=$({type:zu,selectors:[["th-extrudeGeometry"]],inputs:{type:"type"},features:[se([{provide:Mt,useExisting:le(()=>zu)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const Eme={uniforms:{tDiffuse:{value:null},time:{value:0},nIntensity:{value:.5},sIntensity:{value:.05},sCount:{value:4096},grayscale:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\t#include <common>\n\n\t\t// control parameter\n\t\tuniform float time;\n\n\t\tuniform bool grayscale;\n\n\t\t// noise effect intensity value (0 = no effect, 1 = full effect)\n\t\tuniform float nIntensity;\n\n\t\t// scanlines effect intensity value (0 = no effect, 1 = full effect)\n\t\tuniform float sIntensity;\n\n\t\t// scanlines effect count value (0 = no effect, 4096 = full effect)\n\t\tuniform float sCount;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t// sample the source\n\t\t\tvec4 cTextureScreen = texture2D( tDiffuse, vUv );\n\n\t\t// make some noise\n\t\t\tfloat dx = rand( vUv + time );\n\n\t\t// add noise\n\t\t\tvec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );\n\n\t\t// get us a sine and cosine\n\t\t\tvec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );\n\n\t\t// add scanlines\n\t\t\tcResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;\n\n\t\t// interpolate between source and result by intensity\n\t\t\tcResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );\n\n\t\t// convert to grayscale if desired\n\t\t\tif( grayscale ) {\n\n\t\t\t\tcResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );\n\n\t\t\t}\n\n\t\t\tgl_FragColor =  vec4( cResult, cTextureScreen.a );\n\n\t\t}"};class Sme extends vn{constructor(e,t,n,r){super();const s=Eme;this.uniforms=mi.clone(s.uniforms),this.material=new Rt({uniforms:this.uniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader}),void 0!==r&&(this.uniforms.grayscale.value=r),void 0!==e&&(this.uniforms.nIntensity.value=e),void 0!==t&&(this.uniforms.sIntensity.value=t),void 0!==n&&(this.uniforms.sCount.value=n),this.fsQuad=new wr(this.material)}render(e,t,n,r){this.uniforms.tDiffuse.value=n.texture,this.uniforms.time.value+=r,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class Hu extends Hi{getType(){return Sme}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}set material(e){this._objRef&&(this._objRef.material=e)}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}}Hu.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Hu)))(t||Hu)}}(),Hu.\u0275cmp=$({type:Hu,selectors:[["th-filmPass"]],inputs:{uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[se([{provide:Pi,useExisting:le(()=>Hu)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const cH=new T,XR=new xx,YR=new T;class Tme{constructor(e,t){this.object=e,this.domElement=t,this.enabled=!0,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.mouseDragOn=!1,this.autoSpeedFactor=0,this.pointerX=0,this.pointerY=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.viewHalfX=0,this.viewHalfY=0;let n=0,r=0;this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onPointerDown=function(u){if(this.domElement!==document&&this.domElement.focus(),this.activeLook)switch(u.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0},this.onPointerUp=function(u){if(this.activeLook)switch(u.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1},this.onPointerMove=function(u){this.domElement===document?(this.pointerX=u.pageX-this.viewHalfX,this.pointerY=u.pageY-this.viewHalfY):(this.pointerX=u.pageX-this.domElement.offsetLeft-this.viewHalfX,this.pointerY=u.pageY-this.domElement.offsetTop-this.viewHalfY)},this.onKeyDown=function(u){switch(u.code){case"ArrowUp":case"KeyW":this.moveForward=!0;break;case"ArrowLeft":case"KeyA":this.moveLeft=!0;break;case"ArrowDown":case"KeyS":this.moveBackward=!0;break;case"ArrowRight":case"KeyD":this.moveRight=!0;break;case"KeyR":this.moveUp=!0;break;case"KeyF":this.moveDown=!0}},this.onKeyUp=function(u){switch(u.code){case"ArrowUp":case"KeyW":this.moveForward=!1;break;case"ArrowLeft":case"KeyA":this.moveLeft=!1;break;case"ArrowDown":case"KeyS":this.moveBackward=!1;break;case"ArrowRight":case"KeyD":this.moveRight=!1;break;case"KeyR":this.moveUp=!1;break;case"KeyF":this.moveDown=!1}},this.lookAt=function(u,h,f){return u.isVector3?YR.copy(u):YR.set(u,h,f),this.object.lookAt(YR),d(this),this},this.update=function(){const u=new T;return function(f){if(!1===this.enabled)return;if(this.heightSpeed){const x=gt.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=f*(x*this.heightCoef)}else this.autoSpeedFactor=0;const m=f*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(m+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(m),this.moveLeft&&this.object.translateX(-m),this.moveRight&&this.object.translateX(m),this.moveUp&&this.object.translateY(m),this.moveDown&&this.object.translateY(-m);let p=f*this.lookSpeed;this.activeLook||(p=0);let g=1;this.constrainVertical&&(g=Math.PI/(this.verticalMax-this.verticalMin)),r-=this.pointerX*p,this.lookVertical&&(n-=this.pointerY*p*g),n=Math.max(-85,Math.min(85,n));let _=gt.degToRad(90-n);const v=gt.degToRad(r);this.constrainVertical&&(_=gt.mapLinear(_,0,Math.PI,this.verticalMin,this.verticalMax));const b=this.object.position;u.setFromSphericalCoords(1,_,v).add(b),this.object.lookAt(u)}}(),this.dispose=function(){this.domElement.removeEventListener("contextmenu",dH),this.domElement.removeEventListener("pointerdown",o),this.domElement.removeEventListener("pointermove",s),this.domElement.removeEventListener("pointerup",a),window.removeEventListener("keydown",l),window.removeEventListener("keyup",c)};const s=this.onPointerMove.bind(this),o=this.onPointerDown.bind(this),a=this.onPointerUp.bind(this),l=this.onKeyDown.bind(this),c=this.onKeyUp.bind(this);function d(u){const h=u.object.quaternion;cH.set(0,0,-1).applyQuaternion(h),XR.setFromVector3(cH),n=90-gt.radToDeg(XR.phi),r=gt.radToDeg(XR.theta)}this.domElement.addEventListener("contextmenu",dH),this.domElement.addEventListener("pointerdown",o),this.domElement.addEventListener("pointermove",s),this.domElement.addEventListener("pointerup",a),window.addEventListener("keydown",l),window.addEventListener("keyup",c),this.handleResize(),d(this)}}function dH(i){i.preventDefault()}class Gu extends zn{getType(){return Tme}set object(e){this._objRef&&(this._objRef.object=e)}set domElement(e){this._objRef&&(this._objRef.domElement=e)}set enabled(e){this._objRef&&(this._objRef.enabled=e)}set movementSpeed(e){this._objRef&&(this._objRef.movementSpeed=e)}set lookSpeed(e){this._objRef&&(this._objRef.lookSpeed=e)}set lookVertical(e){this._objRef&&(this._objRef.lookVertical=e)}set autoForward(e){this._objRef&&(this._objRef.autoForward=e)}set activeLook(e){this._objRef&&(this._objRef.activeLook=e)}set heightSpeed(e){this._objRef&&(this._objRef.heightSpeed=e)}set heightCoef(e){this._objRef&&(this._objRef.heightCoef=e)}set heightMin(e){this._objRef&&(this._objRef.heightMin=e)}set heightMax(e){this._objRef&&(this._objRef.heightMax=e)}set constrainVertical(e){this._objRef&&(this._objRef.constrainVertical=e)}set verticalMin(e){this._objRef&&(this._objRef.verticalMin=e)}set verticalMax(e){this._objRef&&(this._objRef.verticalMax=e)}set mouseDragOn(e){this._objRef&&(this._objRef.mouseDragOn=e)}}Gu.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Gu)))(t||Gu)}}(),Gu.\u0275cmp=$({type:Gu,selectors:[["th-firstPersonControls"]],inputs:{object:"object",domElement:"domElement",enabled:"enabled",movementSpeed:"movementSpeed",lookSpeed:"lookSpeed",lookVertical:"lookVertical",autoForward:"autoForward",activeLook:"activeLook",heightSpeed:"heightSpeed",heightCoef:"heightCoef",heightMin:"heightMin",heightMax:"heightMax",constrainVertical:"constrainVertical",verticalMin:"verticalMin",verticalMax:"verticalMax",mouseDragOn:"mouseDragOn"},features:[se([{provide:zn,useExisting:le(()=>Gu)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const Ime={type:"change"};class Rme extends os{constructor(e,t){super(),this.object=e,this.domElement=t,this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1;const n=this,r=1e-6,s=new xi,o=new T;this.tmpQuaternion=new xi,this.status=0,this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this.moveVector=new T(0,0,0),this.rotationVector=new T(0,0,0),this.keydown=function(h){if(!h.altKey){switch(h.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this.moveState.forward=1;break;case"KeyS":this.moveState.back=1;break;case"KeyA":this.moveState.left=1;break;case"KeyD":this.moveState.right=1;break;case"KeyR":this.moveState.up=1;break;case"KeyF":this.moveState.down=1;break;case"ArrowUp":this.moveState.pitchUp=1;break;case"ArrowDown":this.moveState.pitchDown=1;break;case"ArrowLeft":this.moveState.yawLeft=1;break;case"ArrowRight":this.moveState.yawRight=1;break;case"KeyQ":this.moveState.rollLeft=1;break;case"KeyE":this.moveState.rollRight=1}this.updateMovementVector(),this.updateRotationVector()}},this.keyup=function(h){switch(h.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this.moveState.forward=0;break;case"KeyS":this.moveState.back=0;break;case"KeyA":this.moveState.left=0;break;case"KeyD":this.moveState.right=0;break;case"KeyR":this.moveState.up=0;break;case"KeyF":this.moveState.down=0;break;case"ArrowUp":this.moveState.pitchUp=0;break;case"ArrowDown":this.moveState.pitchDown=0;break;case"ArrowLeft":this.moveState.yawLeft=0;break;case"ArrowRight":this.moveState.yawRight=0;break;case"KeyQ":this.moveState.rollLeft=0;break;case"KeyE":this.moveState.rollRight=0}this.updateMovementVector(),this.updateRotationVector()},this.pointerdown=function(h){if(this.dragToLook)this.status++;else{switch(h.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1}this.updateMovementVector()}},this.pointermove=function(h){if(!this.dragToLook||this.status>0){const f=this.getContainerDimensions(),m=f.size[0]/2,p=f.size[1]/2;this.moveState.yawLeft=-(h.pageX-f.offset[0]-m)/m,this.moveState.pitchDown=(h.pageY-f.offset[1]-p)/p,this.updateRotationVector()}},this.pointerup=function(h){if(this.dragToLook)this.status--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(h.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0}this.updateMovementVector()}this.updateRotationVector()},this.update=function(h){const f=h*n.movementSpeed,m=h*n.rollSpeed;n.object.translateX(n.moveVector.x*f),n.object.translateY(n.moveVector.y*f),n.object.translateZ(n.moveVector.z*f),n.tmpQuaternion.set(n.rotationVector.x*m,n.rotationVector.y*m,n.rotationVector.z*m,1).normalize(),n.object.quaternion.multiply(n.tmpQuaternion),(o.distanceToSquared(n.object.position)>r||8*(1-s.dot(n.object.quaternion))>r)&&(n.dispatchEvent(Ime),s.copy(n.object.quaternion),o.copy(n.object.position))},this.updateMovementVector=function(){const h=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-h+this.moveState.back},this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft},this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}},this.dispose=function(){this.domElement.removeEventListener("contextmenu",uH),this.domElement.removeEventListener("pointerdown",l),this.domElement.removeEventListener("pointermove",a),this.domElement.removeEventListener("pointerup",c),window.removeEventListener("keydown",d),window.removeEventListener("keyup",u)};const a=this.pointermove.bind(this),l=this.pointerdown.bind(this),c=this.pointerup.bind(this),d=this.keydown.bind(this),u=this.keyup.bind(this);this.domElement.addEventListener("contextmenu",uH),this.domElement.addEventListener("pointerdown",l),this.domElement.addEventListener("pointermove",a),this.domElement.addEventListener("pointerup",c),window.addEventListener("keydown",d),window.addEventListener("keyup",u),this.updateMovementVector(),this.updateRotationVector()}}function uH(i){i.preventDefault()}class Qu extends zn{getType(){return Rme}set object(e){this._objRef&&(this._objRef.object=e)}set domElement(e){this._objRef&&(this._objRef.domElement=e)}set movementSpeed(e){this._objRef&&(this._objRef.movementSpeed=e)}set rollSpeed(e){this._objRef&&(this._objRef.rollSpeed=e)}set dragToLook(e){this._objRef&&(this._objRef.dragToLook=e)}set autoForward(e){this._objRef&&(this._objRef.autoForward=e)}}Qu.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Qu)))(t||Qu)}}(),Qu.\u0275cmp=$({type:Qu,selectors:[["th-flyControls"]],inputs:{object:"object",domElement:"domElement",movementSpeed:"movementSpeed",rollSpeed:"rollSpeed",dragToLook:"dragToLook",autoForward:"autoForward"},features:[se([{provide:zn,useExisting:le(()=>Qu)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class dm extends Ir{getType(){return HU}}dm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(dm)))(t||dm)}}(),dm.\u0275cmp=$({type:dm,selectors:[["th-framebufferTexture"]],features:[se([{provide:Cr,useExisting:le(()=>dm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const Dme={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t}",fragmentShader:"\n\n\t\tuniform int byp; //should we apply the glitch ?\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tDisp;\n\n\t\tuniform float amount;\n\t\tuniform float angle;\n\t\tuniform float seed;\n\t\tuniform float seed_x;\n\t\tuniform float seed_y;\n\t\tuniform float distortion_x;\n\t\tuniform float distortion_y;\n\t\tuniform float col_s;\n\n\t\tvarying vec2 vUv;\n\n\n\t\tfloat rand(vec2 co){\n\t\t\treturn fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n\t\t}\n\n\t\tvoid main() {\n\t\t\tif(byp<1) {\n\t\t\t\tvec2 p = vUv;\n\t\t\t\tfloat xs = floor(gl_FragCoord.x / 0.5);\n\t\t\t\tfloat ys = floor(gl_FragCoord.y / 0.5);\n\t\t\t\t//based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch\n\t\t\t\tfloat disp = texture2D(tDisp, p*seed*seed).r;\n\t\t\t\tif(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {\n\t\t\t\t\tif(seed_x>0.){\n\t\t\t\t\t\tp.y = 1. - (p.y + distortion_y);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tp.y = distortion_y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {\n\t\t\t\t\tif(seed_y>0.){\n\t\t\t\t\t\tp.x=distortion_x;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tp.x = 1. - (p.x + distortion_x);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tp.x+=disp*seed_x*(seed/5.);\n\t\t\t\tp.y+=disp*seed_y*(seed/5.);\n\t\t\t\t//base from RGB shift shader\n\t\t\t\tvec2 offset = amount * vec2( cos(angle), sin(angle));\n\t\t\t\tvec4 cr = texture2D(tDiffuse, p + offset);\n\t\t\t\tvec4 cga = texture2D(tDiffuse, p);\n\t\t\t\tvec4 cb = texture2D(tDiffuse, p - offset);\n\t\t\t\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);\n\t\t\t\t//add noise\n\t\t\t\tvec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);\n\t\t\t\tgl_FragColor = gl_FragColor+ snow;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tgl_FragColor=texture2D (tDiffuse, vUv);\n\t\t\t}\n\t\t}"};class Pme extends vn{constructor(e=64){super();const t=Dme;this.uniforms=mi.clone(t.uniforms),this.heightMap=this.generateHeightmap(e),this.uniforms.tDisp.value=this.heightMap,this.material=new Rt({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.fsQuad=new wr(this.material),this.goWild=!1,this.curF=0,this.generateTrigger()}render(e,t,n){!1===e.capabilities.isWebGL2&&(this.uniforms.tDisp.value.format=cA),this.uniforms.tDiffuse.value=n.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||1==this.goWild?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=gt.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=gt.randFloat(-1,1),this.uniforms.seed_y.value=gt.randFloat(-1,1),this.uniforms.distortion_x.value=gt.randFloat(0,1),this.uniforms.distortion_y.value=gt.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=gt.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=gt.randFloat(0,1),this.uniforms.distortion_y.value=gt.randFloat(0,1),this.uniforms.seed_x.value=gt.randFloat(-.3,.3),this.uniforms.seed_y.value=gt.randFloat(-.3,.3)):0==this.goWild&&(this.uniforms.byp.value=1),this.curF++,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}generateTrigger(){this.randX=gt.randInt(120,240)}generateHeightmap(e){const t=new Float32Array(e*e),n=e*e;for(let s=0;s<n;s++){const o=gt.randFloat(0,1);t[s]=o}const r=new ka(t,e,e,bl,Ln);return r.needsUpdate=!0,r}dispose(){this.material.dispose(),this.heightMap.dispose(),this.fsQuad.dispose()}}class Wu extends Hi{getType(){return Pme}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}set material(e){this._objRef&&(this._objRef.material=e)}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}set goWild(e){this._objRef&&(this._objRef.goWild=e)}set curF(e){this._objRef&&(this._objRef.curF=e)}set randX(e){this._objRef&&(this._objRef.randX=e)}}Wu.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Wu)))(t||Wu)}}(),Wu.\u0275cmp=$({type:Wu,selectors:[["th-glitchPass"]],inputs:{uniforms:"uniforms",material:"material",fsQuad:"fsQuad",goWild:"goWild",curF:"curF",randX:"randX"},features:[se([{provide:Pi,useExisting:le(()=>Wu)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Nl extends Ye{getType(){return xs}set type(e){this._objRef&&(this._objRef.type=e)}}Nl.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Nl)))(t||Nl)}}(),Nl.\u0275cmp=$({type:Nl,selectors:[["th-group"]],inputs:{type:"type"},features:[se([{provide:Ye,useExisting:le(()=>Nl)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const ZR={uniforms:{tDiffuse:{value:null},shape:{value:1},radius:{value:4},rotateR:{value:Math.PI/12*1},rotateG:{value:Math.PI/12*2},rotateB:{value:Math.PI/12*3},scatter:{value:0},width:{value:1},height:{value:1},blending:{value:1},blendingMode:{value:1},greyscale:{value:!1},disable:{value:!1}},vertexShader:"\n\n\t\tvarying vec2 vUV;\n\n\t\tvoid main() {\n\n\t\t\tvUV = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\n\t\t}",fragmentShader:"\n\n\t\t#define SQRT2_MINUS_ONE 0.41421356\n\t\t#define SQRT2_HALF_MINUS_ONE 0.20710678\n\t\t#define PI2 6.28318531\n\t\t#define SHAPE_DOT 1\n\t\t#define SHAPE_ELLIPSE 2\n\t\t#define SHAPE_LINE 3\n\t\t#define SHAPE_SQUARE 4\n\t\t#define BLENDING_LINEAR 1\n\t\t#define BLENDING_MULTIPLY 2\n\t\t#define BLENDING_ADD 3\n\t\t#define BLENDING_LIGHTER 4\n\t\t#define BLENDING_DARKER 5\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float radius;\n\t\tuniform float rotateR;\n\t\tuniform float rotateG;\n\t\tuniform float rotateB;\n\t\tuniform float scatter;\n\t\tuniform float width;\n\t\tuniform float height;\n\t\tuniform int shape;\n\t\tuniform bool disable;\n\t\tuniform float blending;\n\t\tuniform int blendingMode;\n\t\tvarying vec2 vUV;\n\t\tuniform bool greyscale;\n\t\tconst int samples = 8;\n\n\t\tfloat blend( float a, float b, float t ) {\n\n\t\t// linear blend\n\t\t\treturn a * ( 1.0 - t ) + b * t;\n\n\t\t}\n\n\t\tfloat hypot( float x, float y ) {\n\n\t\t// vector magnitude\n\t\t\treturn sqrt( x * x + y * y );\n\n\t\t}\n\n\t\tfloat rand( vec2 seed ){\n\n\t\t// get pseudo-random number\n\t\t\treturn fract( sin( dot( seed.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453 );\n\n\t\t}\n\n\t\tfloat distanceToDotRadius( float channel, vec2 coord, vec2 normal, vec2 p, float angle, float rad_max ) {\n\n\t\t// apply shape-specific transforms\n\t\t\tfloat dist = hypot( coord.x - p.x, coord.y - p.y );\n\t\t\tfloat rad = channel;\n\n\t\t\tif ( shape == SHAPE_DOT ) {\n\n\t\t\t\trad = pow( abs( rad ), 1.125 ) * rad_max;\n\n\t\t\t} else if ( shape == SHAPE_ELLIPSE ) {\n\n\t\t\t\trad = pow( abs( rad ), 1.125 ) * rad_max;\n\n\t\t\t\tif ( dist != 0.0 ) {\n\t\t\t\t\tfloat dot_p = abs( ( p.x - coord.x ) / dist * normal.x + ( p.y - coord.y ) / dist * normal.y );\n\t\t\t\t\tdist = ( dist * ( 1.0 - SQRT2_HALF_MINUS_ONE ) ) + dot_p * dist * SQRT2_MINUS_ONE;\n\t\t\t\t}\n\n\t\t\t} else if ( shape == SHAPE_LINE ) {\n\n\t\t\t\trad = pow( abs( rad ), 1.5) * rad_max;\n\t\t\t\tfloat dot_p = ( p.x - coord.x ) * normal.x + ( p.y - coord.y ) * normal.y;\n\t\t\t\tdist = hypot( normal.x * dot_p, normal.y * dot_p );\n\n\t\t\t} else if ( shape == SHAPE_SQUARE ) {\n\n\t\t\t\tfloat theta = atan( p.y - coord.y, p.x - coord.x ) - angle;\n\t\t\t\tfloat sin_t = abs( sin( theta ) );\n\t\t\t\tfloat cos_t = abs( cos( theta ) );\n\t\t\t\trad = pow( abs( rad ), 1.4 );\n\t\t\t\trad = rad_max * ( rad + ( ( sin_t > cos_t ) ? rad - sin_t * rad : rad - cos_t * rad ) );\n\n\t\t\t}\n\n\t\t\treturn rad - dist;\n\n\t\t}\n\n\t\tstruct Cell {\n\n\t\t// grid sample positions\n\t\t\tvec2 normal;\n\t\t\tvec2 p1;\n\t\t\tvec2 p2;\n\t\t\tvec2 p3;\n\t\t\tvec2 p4;\n\t\t\tfloat samp2;\n\t\t\tfloat samp1;\n\t\t\tfloat samp3;\n\t\t\tfloat samp4;\n\n\t\t};\n\n\t\tvec4 getSample( vec2 point ) {\n\n\t\t// multi-sampled point\n\t\t\tvec4 tex = texture2D( tDiffuse, vec2( point.x / width, point.y / height ) );\n\t\t\tfloat base = rand( vec2( floor( point.x ), floor( point.y ) ) ) * PI2;\n\t\t\tfloat step = PI2 / float( samples );\n\t\t\tfloat dist = radius * 0.66;\n\n\t\t\tfor ( int i = 0; i < samples; ++i ) {\n\n\t\t\t\tfloat r = base + step * float( i );\n\t\t\t\tvec2 coord = point + vec2( cos( r ) * dist, sin( r ) * dist );\n\t\t\t\ttex += texture2D( tDiffuse, vec2( coord.x / width, coord.y / height ) );\n\n\t\t\t}\n\n\t\t\ttex /= float( samples ) + 1.0;\n\t\t\treturn tex;\n\n\t\t}\n\n\t\tfloat getDotColour( Cell c, vec2 p, int channel, float angle, float aa ) {\n\n\t\t// get colour for given point\n\t\t\tfloat dist_c_1, dist_c_2, dist_c_3, dist_c_4, res;\n\n\t\t\tif ( channel == 0 ) {\n\n\t\t\t\tc.samp1 = getSample( c.p1 ).r;\n\t\t\t\tc.samp2 = getSample( c.p2 ).r;\n\t\t\t\tc.samp3 = getSample( c.p3 ).r;\n\t\t\t\tc.samp4 = getSample( c.p4 ).r;\n\n\t\t\t} else if (channel == 1) {\n\n\t\t\t\tc.samp1 = getSample( c.p1 ).g;\n\t\t\t\tc.samp2 = getSample( c.p2 ).g;\n\t\t\t\tc.samp3 = getSample( c.p3 ).g;\n\t\t\t\tc.samp4 = getSample( c.p4 ).g;\n\n\t\t\t} else {\n\n\t\t\t\tc.samp1 = getSample( c.p1 ).b;\n\t\t\t\tc.samp3 = getSample( c.p3 ).b;\n\t\t\t\tc.samp2 = getSample( c.p2 ).b;\n\t\t\t\tc.samp4 = getSample( c.p4 ).b;\n\n\t\t\t}\n\n\t\t\tdist_c_1 = distanceToDotRadius( c.samp1, c.p1, c.normal, p, angle, radius );\n\t\t\tdist_c_2 = distanceToDotRadius( c.samp2, c.p2, c.normal, p, angle, radius );\n\t\t\tdist_c_3 = distanceToDotRadius( c.samp3, c.p3, c.normal, p, angle, radius );\n\t\t\tdist_c_4 = distanceToDotRadius( c.samp4, c.p4, c.normal, p, angle, radius );\n\t\t\tres = ( dist_c_1 > 0.0 ) ? clamp( dist_c_1 / aa, 0.0, 1.0 ) : 0.0;\n\t\t\tres += ( dist_c_2 > 0.0 ) ? clamp( dist_c_2 / aa, 0.0, 1.0 ) : 0.0;\n\t\t\tres += ( dist_c_3 > 0.0 ) ? clamp( dist_c_3 / aa, 0.0, 1.0 ) : 0.0;\n\t\t\tres += ( dist_c_4 > 0.0 ) ? clamp( dist_c_4 / aa, 0.0, 1.0 ) : 0.0;\n\t\t\tres = clamp( res, 0.0, 1.0 );\n\n\t\t\treturn res;\n\n\t\t}\n\n\t\tCell getReferenceCell( vec2 p, vec2 origin, float grid_angle, float step ) {\n\n\t\t// get containing cell\n\t\t\tCell c;\n\n\t\t// calc grid\n\t\t\tvec2 n = vec2( cos( grid_angle ), sin( grid_angle ) );\n\t\t\tfloat threshold = step * 0.5;\n\t\t\tfloat dot_normal = n.x * ( p.x - origin.x ) + n.y * ( p.y - origin.y );\n\t\t\tfloat dot_line = -n.y * ( p.x - origin.x ) + n.x * ( p.y - origin.y );\n\t\t\tvec2 offset = vec2( n.x * dot_normal, n.y * dot_normal );\n\t\t\tfloat offset_normal = mod( hypot( offset.x, offset.y ), step );\n\t\t\tfloat normal_dir = ( dot_normal < 0.0 ) ? 1.0 : -1.0;\n\t\t\tfloat normal_scale = ( ( offset_normal < threshold ) ? -offset_normal : step - offset_normal ) * normal_dir;\n\t\t\tfloat offset_line = mod( hypot( ( p.x - offset.x ) - origin.x, ( p.y - offset.y ) - origin.y ), step );\n\t\t\tfloat line_dir = ( dot_line < 0.0 ) ? 1.0 : -1.0;\n\t\t\tfloat line_scale = ( ( offset_line < threshold ) ? -offset_line : step - offset_line ) * line_dir;\n\n\t\t// get closest corner\n\t\t\tc.normal = n;\n\t\t\tc.p1.x = p.x - n.x * normal_scale + n.y * line_scale;\n\t\t\tc.p1.y = p.y - n.y * normal_scale - n.x * line_scale;\n\n\t\t// scatter\n\t\t\tif ( scatter != 0.0 ) {\n\n\t\t\t\tfloat off_mag = scatter * threshold * 0.5;\n\t\t\t\tfloat off_angle = rand( vec2( floor( c.p1.x ), floor( c.p1.y ) ) ) * PI2;\n\t\t\t\tc.p1.x += cos( off_angle ) * off_mag;\n\t\t\t\tc.p1.y += sin( off_angle ) * off_mag;\n\n\t\t\t}\n\n\t\t// find corners\n\t\t\tfloat normal_step = normal_dir * ( ( offset_normal < threshold ) ? step : -step );\n\t\t\tfloat line_step = line_dir * ( ( offset_line < threshold ) ? step : -step );\n\t\t\tc.p2.x = c.p1.x - n.x * normal_step;\n\t\t\tc.p2.y = c.p1.y - n.y * normal_step;\n\t\t\tc.p3.x = c.p1.x + n.y * line_step;\n\t\t\tc.p3.y = c.p1.y - n.x * line_step;\n\t\t\tc.p4.x = c.p1.x - n.x * normal_step + n.y * line_step;\n\t\t\tc.p4.y = c.p1.y - n.y * normal_step - n.x * line_step;\n\n\t\t\treturn c;\n\n\t\t}\n\n\t\tfloat blendColour( float a, float b, float t ) {\n\n\t\t// blend colours\n\t\t\tif ( blendingMode == BLENDING_LINEAR ) {\n\t\t\t\treturn blend( a, b, 1.0 - t );\n\t\t\t} else if ( blendingMode == BLENDING_ADD ) {\n\t\t\t\treturn blend( a, min( 1.0, a + b ), t );\n\t\t\t} else if ( blendingMode == BLENDING_MULTIPLY ) {\n\t\t\t\treturn blend( a, max( 0.0, a * b ), t );\n\t\t\t} else if ( blendingMode == BLENDING_LIGHTER ) {\n\t\t\t\treturn blend( a, max( a, b ), t );\n\t\t\t} else if ( blendingMode == BLENDING_DARKER ) {\n\t\t\t\treturn blend( a, min( a, b ), t );\n\t\t\t} else {\n\t\t\t\treturn blend( a, b, 1.0 - t );\n\t\t\t}\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tif ( ! disable ) {\n\n\t\t// setup\n\t\t\t\tvec2 p = vec2( vUV.x * width, vUV.y * height );\n\t\t\t\tvec2 origin = vec2( 0, 0 );\n\t\t\t\tfloat aa = ( radius < 2.5 ) ? radius * 0.5 : 1.25;\n\n\t\t// get channel samples\n\t\t\t\tCell cell_r = getReferenceCell( p, origin, rotateR, radius );\n\t\t\t\tCell cell_g = getReferenceCell( p, origin, rotateG, radius );\n\t\t\t\tCell cell_b = getReferenceCell( p, origin, rotateB, radius );\n\t\t\t\tfloat r = getDotColour( cell_r, p, 0, rotateR, aa );\n\t\t\t\tfloat g = getDotColour( cell_g, p, 1, rotateG, aa );\n\t\t\t\tfloat b = getDotColour( cell_b, p, 2, rotateB, aa );\n\n\t\t// blend with original\n\t\t\t\tvec4 colour = texture2D( tDiffuse, vUV );\n\t\t\t\tr = blendColour( r, colour.r, blending );\n\t\t\t\tg = blendColour( g, colour.g, blending );\n\t\t\t\tb = blendColour( b, colour.b, blending );\n\n\t\t\t\tif ( greyscale ) {\n\t\t\t\t\tr = g = b = (r + b + g) / 3.0;\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = vec4( r, g, b, 1.0 );\n\n\t\t\t} else {\n\n\t\t\t\tgl_FragColor = texture2D( tDiffuse, vUV );\n\n\t\t\t}\n\n\t\t}"};class kme extends vn{constructor(e,t,n){super(),this.uniforms=mi.clone(ZR.uniforms),this.material=new Rt({uniforms:this.uniforms,fragmentShader:ZR.fragmentShader,vertexShader:ZR.vertexShader}),this.uniforms.width.value=e,this.uniforms.height.value=t;for(const r in n)n.hasOwnProperty(r)&&this.uniforms.hasOwnProperty(r)&&(this.uniforms[r].value=n[r]);this.fsQuad=new wr(this.material)}render(e,t,n){this.material.uniforms.tDiffuse.value=n.texture,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}setSize(e,t){this.uniforms.width.value=e,this.uniforms.height.value=t}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class um extends Hi{getType(){return kme}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}set material(e){this._objRef&&(this._objRef.material=e)}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}}um.\u0275fac=function(){let i;return function(t){return(i||(i=ce(um)))(t||um)}}(),um.\u0275cmp=$({type:um,selectors:[["th-halftonePass"]],inputs:{uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[se([{provide:Pi,useExisting:le(()=>um)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class hm extends Ye{getType(){return z4}set light(e){this._objRef&&(this._objRef.light=e)}set matrix(e){this._objRef&&(this._objRef.matrix=Qe(this._objRef.matrix,e))}set matrixAutoUpdate(e){this._objRef&&(this._objRef.matrixAutoUpdate=e)}set material(e){this._objRef&&(this._objRef.material=e)}set color(e){this._objRef&&(this._objRef.color=e)}}hm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(hm)))(t||hm)}}(),hm.\u0275cmp=$({type:hm,selectors:[["th-hemisphereLightHelper"]],inputs:{light:"light",matrix:"matrix",matrixAutoUpdate:"matrixAutoUpdate",material:"material",color:"color"},features:[se([{provide:Ye,useExisting:le(()=>hm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class fm extends Oc{getType(){return v4}}fm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(fm)))(t||fm)}}(),fm.\u0275cmp=$({type:fm,selectors:[["th-hemisphereLightProbe"]],features:[se([{provide:Ye,useExisting:le(()=>fm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class qu extends qa{getType(){return tp}set type(e){this._objRef&&(this._objRef.type=e)}}qu.\u0275fac=function(){let i;return function(t){return(i||(i=ce(qu)))(t||qu)}}(),qu.\u0275cmp=$({type:qu,selectors:[["th-icosahedronGeometry"]],inputs:{type:"type"},features:[se([{provide:Mt,useExisting:le(()=>qu)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class pm extends Mt{getType(){return CI}set type(e){this._objRef&&(this._objRef.type=e)}set isInstancedBufferGeometry(e){this._objRef&&(this._objRef.isInstancedBufferGeometry=e)}set instanceCount(e){this._objRef&&(this._objRef.instanceCount=e)}}pm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(pm)))(t||pm)}}(),pm.\u0275cmp=$({type:pm,selectors:[["th-instancedBufferGeometry"]],inputs:{type:"type",isInstancedBufferGeometry:"isInstancedBufferGeometry",instanceCount:"instanceCount"},features:[se([{provide:Mt,useExisting:le(()=>pm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Xu extends Vn{getType(){return ix}set count(e){this._objRef&&(this._objRef.count=e)}set instanceColor(e){this._objRef&&(this._objRef.instanceColor=Qe(this._objRef.instanceColor,e))}set instanceMatrix(e){this._objRef&&(this._objRef.instanceMatrix=Qe(this._objRef.instanceMatrix,e))}}Xu.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Xu)))(t||Xu)}}(),Xu.\u0275cmp=$({type:Xu,selectors:[["th-instancedMesh"]],inputs:{count:"count",instanceColor:"instanceColor",instanceMatrix:"instanceMatrix"},features:[se([{provide:Ye,useExisting:le(()=>Xu)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class mm extends Mt{getType(){return Jd}set type(e){this._objRef&&(this._objRef.type=e)}set parameters(e){this._objRef&&(this._objRef.parameters=e)}}mm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(mm)))(t||mm)}}(),mm.\u0275cmp=$({type:mm,selectors:[["th-latheGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[se([{provide:Mt,useExisting:le(()=>mm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Dw{constructor(e=Math){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(let t=0;t<256;t++)this.p[t]=Math.floor(256*e.random());this.perm=[];for(let t=0;t<512;t++)this.perm[t]=this.p[255&t];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}dot(e,t,n){return e[0]*t+e[1]*n}dot3(e,t,n,r){return e[0]*t+e[1]*n+e[2]*r}dot4(e,t,n,r,s){return e[0]*t+e[1]*n+e[2]*r+e[3]*s}noise(e,t){let n,r,s;const a=(e+t)*(.5*(Math.sqrt(3)-1)),l=Math.floor(e+a),c=Math.floor(t+a),d=(3-Math.sqrt(3))/6,u=(l+c)*d,m=e-(l-u),p=t-(c-u);let g,_;m>p?(g=1,_=0):(g=0,_=1);const v=m-g+d,b=p-_+d,y=m-1+2*d,x=p-1+2*d,C=255&l,M=255&c,E=this.perm[C+g+this.perm[M+_]]%12,I=this.perm[C+1+this.perm[M+1]]%12;let F=.5-m*m-p*p;F<0?n=0:(F*=F,n=F*F*this.dot(this.grad3[this.perm[C+this.perm[M]]%12],m,p));let Q=.5-v*v-b*b;Q<0?r=0:(Q*=Q,r=Q*Q*this.dot(this.grad3[E],v,b));let B=.5-y*y-x*x;return B<0?s=0:(B*=B,s=B*B*this.dot(this.grad3[I],y,x)),70*(n+r+s)}noise3d(e,t,n){let r,s,o,a;const c=.3333333333333333*(e+t+n),d=Math.floor(e+c),u=Math.floor(t+c),h=Math.floor(n+c),f=1/6,m=(d+u+h)*f,v=e-(d-m),b=t-(u-m),y=n-(h-m);let x,C,M,w,E,I;v>=b?b>=y?(x=1,C=0,M=0,w=1,E=1,I=0):v>=y?(x=1,C=0,M=0,w=1,E=0,I=1):(x=0,C=0,M=1,w=1,E=0,I=1):b<y?(x=0,C=0,M=1,w=0,E=1,I=1):v<y?(x=0,C=1,M=0,w=0,E=1,I=1):(x=0,C=1,M=0,w=1,E=1,I=0);const F=v-x+f,Q=b-C+f,B=y-M+f,L=v-w+2*f,X=b-E+2*f,P=y-I+2*f,V=v-1+.5,O=b-1+.5,q=y-1+.5,ee=255&d,Z=255&u,Y=255&h,J=this.perm[ee+x+this.perm[Z+C+this.perm[Y+M]]]%12,ae=this.perm[ee+w+this.perm[Z+E+this.perm[Y+I]]]%12,G=this.perm[ee+1+this.perm[Z+1+this.perm[Y+1]]]%12;let U=.6-v*v-b*b-y*y;U<0?r=0:(U*=U,r=U*U*this.dot3(this.grad3[this.perm[ee+this.perm[Z+this.perm[Y]]]%12],v,b,y));let de=.6-F*F-Q*Q-B*B;de<0?s=0:(de*=de,s=de*de*this.dot3(this.grad3[J],F,Q,B));let Ee=.6-L*L-X*X-P*P;Ee<0?o=0:(Ee*=Ee,o=Ee*Ee*this.dot3(this.grad3[ae],L,X,P));let we=.6-V*V-O*O-q*q;return we<0?a=0:(we*=we,a=we*we*this.dot3(this.grad3[G],V,O,q)),32*(r+s+o+a)}noise4d(e,t,n,r){const s=this.grad4,o=this.simplex,a=this.perm,l=(Math.sqrt(5)-1)/4,c=(5-Math.sqrt(5))/20;let d,u,h,f,m;const p=(e+t+n+r)*l,g=Math.floor(e+p),_=Math.floor(t+p),v=Math.floor(n+p),b=Math.floor(r+p),y=(g+_+v+b)*c,E=e-(g-y),I=t-(_-y),F=n-(v-y),Q=r-(b-y),q=(E>I?32:0)+(E>F?16:0)+(I>F?8:0)+(E>Q?4:0)+(I>Q?2:0)+(F>Q?1:0),ee=o[q][0]>=3?1:0,Z=o[q][1]>=3?1:0,Y=o[q][2]>=3?1:0,he=o[q][3]>=3?1:0,J=o[q][0]>=2?1:0,ae=o[q][1]>=2?1:0,G=o[q][2]>=2?1:0,U=o[q][3]>=2?1:0,de=o[q][0]>=1?1:0,Ee=o[q][1]>=1?1:0,we=o[q][2]>=1?1:0,et=o[q][3]>=1?1:0,Ae=E-ee+c,xe=I-Z+c,Pe=F-Y+c,$e=Q-he+c,We=E-J+2*c,yt=I-ae+2*c,ht=F-G+2*c,ot=Q-U+2*c,St=E-de+3*c,ft=I-Ee+3*c,N=F-we+3*c,k=Q-et+3*c,_e=E-1+4*c,Se=I-1+4*c,Ue=F-1+4*c,Ze=Q-1+4*c,bt=255&g,H=255&_,te=255&v,tt=255&b,nt=a[bt+ee+a[H+Z+a[te+Y+a[tt+he]]]]%32,rt=a[bt+J+a[H+ae+a[te+G+a[tt+U]]]]%32,At=a[bt+de+a[H+Ee+a[te+we+a[tt+et]]]]%32,Jt=a[bt+1+a[H+1+a[te+1+a[tt+1]]]]%32;let Ft=.6-E*E-I*I-F*F-Q*Q;Ft<0?d=0:(Ft*=Ft,d=Ft*Ft*this.dot4(s[a[bt+a[H+a[te+a[tt]]]]%32],E,I,F,Q));let Ot=.6-Ae*Ae-xe*xe-Pe*Pe-$e*$e;Ot<0?u=0:(Ot*=Ot,u=Ot*Ot*this.dot4(s[nt],Ae,xe,Pe,$e));let re=.6-We*We-yt*yt-ht*ht-ot*ot;re<0?h=0:(re*=re,h=re*re*this.dot4(s[rt],We,yt,ht,ot));let ie=.6-St*St-ft*ft-N*N-k*k;ie<0?f=0:(ie*=ie,f=ie*ie*this.dot4(s[At],St,ft,N,k));let je=.6-_e*_e-Se*Se-Ue*Ue-Ze*Ze;return je<0?m=0:(je*=je,m=je*je*this.dot4(s[Jt],_e,Se,Ue,Ze)),27*(d+u+h+f+m)}}class An extends xt{constructor(e={}){super(),this.isLightningStrike=!0,this.type="LightningStrike",this.init(An.copyParameters(e,e)),this.createMesh()}static createRandomGenerator(){const t=[];for(let r=0;r<2053;r++)t.push(Math.random());const n={currentSeed:0,random:function(){const r=t[n.currentSeed];return n.currentSeed=(n.currentSeed+1)%2053,r},getSeed:function(){return n.currentSeed/2053},setSeed:function(r){n.currentSeed=Math.floor(2053*r)%2053}};return n}static copyParameters(e={},t={}){const n=function(r){return t===e?r:r.clone()};return e.sourceOffset=void 0!==t.sourceOffset?n(t.sourceOffset):new T(0,100,0),e.destOffset=void 0!==t.destOffset?n(t.destOffset):new T(0,0,0),e.timeScale=void 0!==t.timeScale?t.timeScale:1,e.roughness=void 0!==t.roughness?t.roughness:.9,e.straightness=void 0!==t.straightness?t.straightness:.7,e.up0=void 0!==t.up0?n(t.up0):new T(0,0,1),e.up1=void 0!==t.up1?n(t.up1):new T(0,0,1),e.radius0=void 0!==t.radius0?t.radius0:1,e.radius1=void 0!==t.radius1?t.radius1:1,e.radius0Factor=void 0!==t.radius0Factor?t.radius0Factor:.5,e.radius1Factor=void 0!==t.radius1Factor?t.radius1Factor:.2,e.minRadius=void 0!==t.minRadius?t.minRadius:.2,e.isEternal=void 0!==t.isEternal?t.isEternal:void 0===t.birthTime||void 0===t.deathTime,e.birthTime=t.birthTime,e.deathTime=t.deathTime,e.propagationTimeFactor=void 0!==t.propagationTimeFactor?t.propagationTimeFactor:.1,e.vanishingTimeFactor=void 0!==t.vanishingTimeFactor?t.vanishingTimeFactor:.9,e.subrayPeriod=void 0!==t.subrayPeriod?t.subrayPeriod:4,e.subrayDutyCycle=void 0!==t.subrayDutyCycle?t.subrayDutyCycle:.6,e.maxIterations=void 0!==t.maxIterations?t.maxIterations:9,e.isStatic=void 0!==t.isStatic&&t.isStatic,e.ramification=void 0!==t.ramification?t.ramification:5,e.maxSubrayRecursion=void 0!==t.maxSubrayRecursion?t.maxSubrayRecursion:3,e.recursionProbability=void 0!==t.recursionProbability?t.recursionProbability:.6,e.generateUVs=void 0!==t.generateUVs&&t.generateUVs,e.randomGenerator=t.randomGenerator,e.noiseSeed=t.noiseSeed,e.onDecideSubrayCreation=t.onDecideSubrayCreation,e.onSubrayCreation=t.onSubrayCreation,e}update(e){this.isStatic||(this.rayParameters.isEternal||this.rayParameters.birthTime<=e&&e<=this.rayParameters.deathTime?(this.updateMesh(e),this.state=e<this.subrays[0].endPropagationTime?An.RAY_PROPAGATING:e>this.subrays[0].beginVanishingTime?An.RAY_VANISHING:An.RAY_STEADY,this.visible=!0):(this.visible=!1,this.state=e<this.rayParameters.birthTime?An.RAY_UNBORN:An.RAY_EXTINGUISHED))}init(e){this.rayParameters=e,this.maxIterations=void 0!==e.maxIterations?Math.floor(e.maxIterations):9,e.maxIterations=this.maxIterations,this.isStatic=void 0!==e.isStatic&&e.isStatic,e.isStatic=this.isStatic,this.ramification=void 0!==e.ramification?Math.floor(e.ramification):5,e.ramification=this.ramification,this.maxSubrayRecursion=void 0!==e.maxSubrayRecursion?Math.floor(e.maxSubrayRecursion):3,e.maxSubrayRecursion=this.maxSubrayRecursion,this.recursionProbability=void 0!==e.recursionProbability?e.recursionProbability:.6,e.recursionProbability=this.recursionProbability,this.generateUVs=void 0!==e.generateUVs&&e.generateUVs,e.generateUVs=this.generateUVs,void 0!==e.randomGenerator?(this.randomGenerator=e.randomGenerator,this.seedGenerator=e.randomGenerator,void 0!==e.noiseSeed&&this.seedGenerator.setSeed(e.noiseSeed)):(this.randomGenerator=An.createRandomGenerator(),this.seedGenerator=Math),void 0!==e.onDecideSubrayCreation?this.onDecideSubrayCreation=e.onDecideSubrayCreation:(this.createDefaultSubrayCreationCallbacks(),void 0!==e.onSubrayCreation&&(this.onSubrayCreation=e.onSubrayCreation)),this.state=An.RAY_INITIALIZED,this.maxSubrays=Math.ceil(1+Math.pow(this.ramification,Math.max(0,this.maxSubrayRecursion-1))),e.maxSubrays=this.maxSubrays,this.maxRaySegments=2*(1<<this.maxIterations),this.subrays=[];for(let t=0;t<this.maxSubrays;t++)this.subrays.push(this.createSubray());this.raySegments=[];for(let t=0;t<this.maxRaySegments;t++)this.raySegments.push(this.createSegment());this.time=0,this.timeFraction=0,this.currentSegmentCallback=null,this.currentCreateTriangleVertices=this.generateUVs?this.createTriangleVerticesWithUVs:this.createTriangleVerticesWithoutUVs,this.numSubrays=0,this.currentSubray=null,this.currentSegmentIndex=0,this.isInitialSegment=!1,this.subrayProbability=0,this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.vertices=null,this.uvs=null,this.indices=null,this.positionAttribute=null,this.uvsAttribute=null,this.simplexX=new Dw(this.seedGenerator),this.simplexY=new Dw(this.seedGenerator),this.simplexZ=new Dw(this.seedGenerator),this.forwards=new T,this.forwardsFill=new T,this.side=new T,this.down=new T,this.middlePos=new T,this.middleLinPos=new T,this.newPos=new T,this.vPos=new T,this.cross1=new T}createMesh(){const e=1<<this.maxIterations,t=3*(e+1)*this.maxSubrays,n=18*e*this.maxSubrays;this.vertices=new Float32Array(3*t),this.indices=new Uint32Array(n),this.generateUVs&&(this.uvs=new Float32Array(2*t)),this.fillMesh(0),this.setIndex(new FA(this.indices,1)),this.positionAttribute=new Ge(this.vertices,3),this.setAttribute("position",this.positionAttribute),this.generateUVs&&(this.uvsAttribute=new Ge(new Float32Array(this.uvs),2),this.setAttribute("uv",this.uvsAttribute)),this.isStatic||(this.index.usage=vA,this.positionAttribute.usage=vA,this.generateUVs&&(this.uvsAttribute.usage=vA)),this.vertices=this.positionAttribute.array,this.indices=this.index.array,this.generateUVs&&(this.uvs=this.uvsAttribute.array)}updateMesh(e){this.fillMesh(e),this.drawRange.count=this.currentIndex,this.index.needsUpdate=!0,this.positionAttribute.needsUpdate=!0,this.generateUVs&&(this.uvsAttribute.needsUpdate=!0)}fillMesh(e){const t=this;this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.fractalRay(e,function(r){const s=t.currentSubray;e<s.birthTime||(this.rayParameters.isEternal&&0==t.currentSubray.recursion?(t.createPrism(r),t.onDecideSubrayCreation(r,t)):e<s.endPropagationTime?t.timeFraction>=r.fraction0*s.propagationTimeFactor&&(t.createPrism(r),t.onDecideSubrayCreation(r,t)):e<s.beginVanishingTime?(t.createPrism(r),t.onDecideSubrayCreation(r,t)):(t.timeFraction<=s.vanishingTimeFactor+r.fraction1*(1-s.vanishingTimeFactor)&&t.createPrism(r),t.onDecideSubrayCreation(r,t)))})}addNewSubray(){return this.subrays[this.numSubrays++]}initSubray(e,t){e.pos0.copy(t.sourceOffset),e.pos1.copy(t.destOffset),e.up0.copy(t.up0),e.up1.copy(t.up1),e.radius0=t.radius0,e.radius1=t.radius1,e.birthTime=t.birthTime,e.deathTime=t.deathTime,e.timeScale=t.timeScale,e.roughness=t.roughness,e.straightness=t.straightness,e.propagationTimeFactor=t.propagationTimeFactor,e.vanishingTimeFactor=t.vanishingTimeFactor,e.maxIterations=this.maxIterations,e.seed=void 0!==t.noiseSeed?t.noiseSeed:0,e.recursion=0}fractalRay(e,t){this.time=e,this.currentSegmentCallback=t,this.numSubrays=0,this.initSubray(this.addNewSubray(),this.rayParameters);for(let n=0;n<this.numSubrays;n++){const r=this.subrays[n];this.currentSubray=r,this.randomGenerator.setSeed(r.seed),r.endPropagationTime=gt.lerp(r.birthTime,r.deathTime,r.propagationTimeFactor),r.beginVanishingTime=gt.lerp(r.deathTime,r.birthTime,1-r.vanishingTimeFactor);const s=this.randomGenerator.random;r.linPos0.set(s(),s(),s()).multiplyScalar(1e3),r.linPos1.set(s(),s(),s()).multiplyScalar(1e3),this.timeFraction=(e-r.birthTime)/(r.deathTime-r.birthTime),this.currentSegmentIndex=0,this.isInitialSegment=!0;const o=this.getNewSegment();o.iteration=0,o.pos0.copy(r.pos0),o.pos1.copy(r.pos1),o.linPos0.copy(r.linPos0),o.linPos1.copy(r.linPos1),o.up0.copy(r.up0),o.up1.copy(r.up1),o.radius0=r.radius0,o.radius1=r.radius1,o.fraction0=0,o.fraction1=1,o.positionVariationFactor=1-r.straightness,this.subrayProbability=this.ramification*Math.pow(this.recursionProbability,r.recursion)/(1<<r.maxIterations),this.fractalRayRecursive(o)}this.currentSegmentCallback=null,this.currentSubray=null}fractalRayRecursive(e){if(e.iteration>=this.currentSubray.maxIterations)return void this.currentSegmentCallback(e);this.forwards.subVectors(e.pos1,e.pos0);let t=this.forwards.length();t<1e-6&&(this.forwards.set(0,0,.01),t=this.forwards.length());const n=.5*(e.radius0+e.radius1),r=.5*(e.fraction0+e.fraction1),s=this.time*this.currentSubray.timeScale*Math.pow(2,e.iteration);this.middlePos.lerpVectors(e.pos0,e.pos1,.5),this.middleLinPos.lerpVectors(e.linPos0,e.linPos1,.5);const o=this.middleLinPos;this.newPos.set(this.simplexX.noise4d(o.x,o.y,o.z,s),this.simplexY.noise4d(o.x,o.y,o.z,s),this.simplexZ.noise4d(o.x,o.y,o.z,s)),this.newPos.multiplyScalar(e.positionVariationFactor*t),this.newPos.add(this.middlePos);const a=this.getNewSegment();a.pos0.copy(e.pos0),a.pos1.copy(this.newPos),a.linPos0.copy(e.linPos0),a.linPos1.copy(this.middleLinPos),a.up0.copy(e.up0),a.up1.copy(e.up1),a.radius0=e.radius0,a.radius1=n,a.fraction0=e.fraction0,a.fraction1=r,a.positionVariationFactor=e.positionVariationFactor*this.currentSubray.roughness,a.iteration=e.iteration+1;const l=this.getNewSegment();l.pos0.copy(this.newPos),l.pos1.copy(e.pos1),l.linPos0.copy(this.middleLinPos),l.linPos1.copy(e.linPos1),this.cross1.crossVectors(e.up0,this.forwards.normalize()),l.up0.crossVectors(this.forwards,this.cross1).normalize(),l.up1.copy(e.up1),l.radius0=n,l.radius1=e.radius1,l.fraction0=r,l.fraction1=e.fraction1,l.positionVariationFactor=e.positionVariationFactor*this.currentSubray.roughness,l.iteration=e.iteration+1,this.fractalRayRecursive(a),this.fractalRayRecursive(l)}createPrism(e){this.forwardsFill.subVectors(e.pos1,e.pos0).normalize(),this.isInitialSegment&&(this.currentCreateTriangleVertices(e.pos0,e.up0,this.forwardsFill,e.radius0,0),this.isInitialSegment=!1),this.currentCreateTriangleVertices(e.pos1,e.up0,this.forwardsFill,e.radius1,e.fraction1),this.createPrismFaces()}createTriangleVerticesWithoutUVs(e,t,n,r){this.side.crossVectors(t,n).multiplyScalar(r*An.COS30DEG),this.down.copy(t).multiplyScalar(-r*An.SIN30DEG);const s=this.vPos,o=this.vertices;s.copy(e).sub(this.side).add(this.down),o[this.currentCoordinate++]=s.x,o[this.currentCoordinate++]=s.y,o[this.currentCoordinate++]=s.z,s.copy(e).add(this.side).add(this.down),o[this.currentCoordinate++]=s.x,o[this.currentCoordinate++]=s.y,o[this.currentCoordinate++]=s.z,s.copy(t).multiplyScalar(r).add(e),o[this.currentCoordinate++]=s.x,o[this.currentCoordinate++]=s.y,o[this.currentCoordinate++]=s.z,this.currentVertex+=3}createTriangleVerticesWithUVs(e,t,n,r,s){this.side.crossVectors(t,n).multiplyScalar(r*An.COS30DEG),this.down.copy(t).multiplyScalar(-r*An.SIN30DEG);const o=this.vPos,a=this.vertices,l=this.uvs;o.copy(e).sub(this.side).add(this.down),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=s,l[this.currentUVCoordinate++]=0,o.copy(e).add(this.side).add(this.down),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=s,l[this.currentUVCoordinate++]=.5,o.copy(t).multiplyScalar(r).add(e),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=s,l[this.currentUVCoordinate++]=1,this.currentVertex+=3}createPrismFaces(e){const t=this.indices;e=this.currentVertex-6,t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+5,t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+5,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+5}createDefaultSubrayCreationCallbacks(){const e=this.randomGenerator.random;this.onDecideSubrayCreation=function(o,a){const l=a.currentSubray,c=a.rayParameters.subrayPeriod,d=a.rayParameters.subrayDutyCycle,u=a.rayParameters.isEternal&&0==l.recursion?-e()*c:gt.lerp(l.birthTime,l.endPropagationTime,o.fraction0)-e()*c,h=a.time-u,f=Math.floor(h/c),m=e()*(f+1);let g=0;if(h%c<=d*c&&(g=a.subrayProbability),l.recursion<a.maxSubrayRecursion&&a.numSubrays<a.maxSubrays&&e()<g){const _=a.addNewSubray(),v=a.randomGenerator.getSeed();_.seed=m,a.randomGenerator.setSeed(m),_.recursion=l.recursion+1,_.maxIterations=Math.max(1,l.maxIterations-1),_.linPos0.set(e(),e(),e()).multiplyScalar(1e3),_.linPos1.set(e(),e(),e()).multiplyScalar(1e3),_.up0.copy(l.up0),_.up1.copy(l.up1),_.radius0=o.radius0*a.rayParameters.radius0Factor,_.radius1=Math.min(a.rayParameters.minRadius,o.radius1*a.rayParameters.radius1Factor),_.birthTime=u+f*c,_.deathTime=_.birthTime+c*d,!a.rayParameters.isEternal&&0==l.recursion&&(_.birthTime=Math.max(_.birthTime,l.birthTime),_.deathTime=Math.min(_.deathTime,l.deathTime)),_.timeScale=2*l.timeScale,_.roughness=l.roughness,_.straightness=l.straightness,_.propagationTimeFactor=l.propagationTimeFactor,_.vanishingTimeFactor=l.vanishingTimeFactor,a.onSubrayCreation(o,l,_,a),a.randomGenerator.setSeed(v)}};const t=new T,n=new T,r=new T,s=new T;this.onSubrayCreation=function(o,a,l,c){c.subrayCylinderPosition(o,a,l,.5,.6,.2)},this.subrayConePosition=function(o,a,l,c,d,u){l.pos0.copy(o.pos0),t.subVectors(a.pos1,a.pos0),n.copy(t).normalize(),t.multiplyScalar(o.fraction0+(1-o.fraction0)*(e()*c));const h=t.length();r.crossVectors(a.up0,n);const f=2*Math.PI*e();r.multiplyScalar(Math.cos(f)),s.copy(a.up0).multiplyScalar(Math.sin(f)),l.pos1.copy(r).add(s).multiplyScalar(h*d*(u+e()*(1-u))).add(t).add(a.pos0)},this.subrayCylinderPosition=function(o,a,l,c,d,u){l.pos0.copy(o.pos0),t.subVectors(a.pos1,a.pos0),n.copy(t).normalize(),t.multiplyScalar(o.fraction0+(1-o.fraction0)*((2*e()-1)*c));const h=t.length();r.crossVectors(a.up0,n);const f=2*Math.PI*e();r.multiplyScalar(Math.cos(f)),s.copy(a.up0).multiplyScalar(Math.sin(f)),l.pos1.copy(r).add(s).multiplyScalar(h*d*(u+e()*(1-u))).add(t).add(a.pos0)}}createSubray(){return{seed:0,maxIterations:0,recursion:0,pos0:new T,pos1:new T,linPos0:new T,linPos1:new T,up0:new T,up1:new T,radius0:0,radius1:0,birthTime:0,deathTime:0,timeScale:0,roughness:0,straightness:0,propagationTimeFactor:0,vanishingTimeFactor:0,endPropagationTime:0,beginVanishingTime:0}}createSegment(){return{iteration:0,pos0:new T,pos1:new T,linPos0:new T,linPos1:new T,up0:new T,up1:new T,radius0:0,radius1:0,fraction0:0,fraction1:0,positionVariationFactor:0}}getNewSegment(){return this.raySegments[this.currentSegmentIndex++]}copy(e){return super.copy(e),this.init(An.copyParameters({},e.rayParameters)),this}clone(){return new this.constructor(An.copyParameters({},this.rayParameters))}}An.RAY_INITIALIZED=0,An.RAY_UNBORN=1,An.RAY_PROPAGATING=2,An.RAY_STEADY=3,An.RAY_VANISHING=4,An.RAY_EXTINGUISHED=5,An.COS30DEG=Math.cos(30*Math.PI/180),An.SIN30DEG=Math.sin(30*Math.PI/180);class gm extends Mt{getType(){return An}set state(e){this._objRef&&(this._objRef.state=e)}}gm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(gm)))(t||gm)}}(),gm.\u0275cmp=$({type:gm,selectors:[["th-lightningStrike"]],inputs:{state:"state"},features:[se([{provide:Mt,useExisting:le(()=>gm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Yu extends Ei{getType(){return pn}set type(e){this._objRef&&(this._objRef.type=e)}set color(e){this._objRef&&(this._objRef.color=Qe(this._objRef.color,e))}set fog(e){this._objRef&&(this._objRef.fog=e)}set linewidth(e){this._objRef&&(this._objRef.linewidth=e)}set linecap(e){this._objRef&&(this._objRef.linecap=e)}set linejoin(e){this._objRef&&(this._objRef.linejoin=e)}}Yu.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Yu)))(t||Yu)}}(),Yu.\u0275cmp=$({type:Yu,selectors:[["th-lineBasicMaterial"]],inputs:{type:"type",color:"color",fog:"fog",linewidth:"linewidth",linecap:"linecap",linejoin:"linejoin"},features:[se([{provide:Ei,useExisting:le(()=>Yu)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class _m extends Yu{getType(){return hI}set type(e){this._objRef&&(this._objRef.type=e)}set scale(e){this._objRef&&(this._objRef.scale=e)}set dashSize(e){this._objRef&&(this._objRef.dashSize=e)}set gapSize(e){this._objRef&&(this._objRef.gapSize=e)}}_m.\u0275fac=function(){let i;return function(t){return(i||(i=ce(_m)))(t||_m)}}(),_m.\u0275cmp=$({type:_m,selectors:[["th-lineDashedMaterial"]],inputs:{type:"type",scale:"scale",dashSize:"dashSize",gapSize:"gapSize"},features:[se([{provide:Ei,useExisting:le(()=>_m)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class bm extends Ac{getType(){return rx}set type(e){this._objRef&&(this._objRef.type=e)}}bm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(bm)))(t||bm)}}(),bm.\u0275cmp=$({type:bm,selectors:[["th-lineLoop"]],inputs:{type:"type"},features:[se([{provide:Ye,useExisting:le(()=>bm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class vm extends Ye{getType(){return GT}set type(e){this._objRef&&(this._objRef.type=e)}set levels(e){this._objRef&&(this._objRef.levels=e)}set autoUpdate(e){this._objRef&&(this._objRef.autoUpdate=e)}set objects(e){this._objRef&&(this._objRef.objects=e)}}vm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(vm)))(t||vm)}}(),vm.\u0275cmp=$({type:vm,selectors:[["th-lOD"]],inputs:{type:"type",levels:"levels",autoUpdate:"autoUpdate",objects:"objects"},features:[se([{provide:Ye,useExisting:le(()=>vm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const Fme={defines:{USE_3DTEXTURE:1},uniforms:{lut3d:{value:null},lut:{value:null},lutSize:{value:0},tDiffuse:{value:null},intensity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}\n\n\t",fragmentShader:"\n\n\t\tuniform float lutSize;\n\t\t#if USE_3DTEXTURE\n\t\tprecision highp sampler3D;\n\t\tuniform sampler3D lut3d;\n\t\t#else\n\t\tuniform sampler2D lut;\n\n\t\tvec3 lutLookup( sampler2D tex, float size, vec3 rgb ) {\n\n\t\t\tfloat sliceHeight = 1.0 / size;\n\t\t\tfloat yPixelHeight = 1.0 / ( size * size );\n\n\t\t\t// Get the slices on either side of the sample\n\t\t\tfloat slice = rgb.b * size;\n\t\t\tfloat interp = fract( slice );\n\t\t\tfloat slice0 = slice - interp;\n\t\t\tfloat centeredInterp = interp - 0.5;\n\n\t\t\tfloat slice1 = slice0 + sign( centeredInterp );\n\n\t\t\t// Pull y sample in by half a pixel in each direction to avoid color\n\t\t\t// bleeding from adjacent slices.\n\t\t\tfloat greenOffset = clamp( rgb.g * sliceHeight, yPixelHeight * 0.5, sliceHeight - yPixelHeight * 0.5 );\n\n\t\t\tvec2 uv0 = vec2(\n\t\t\t\trgb.r,\n\t\t\t\tslice0 * sliceHeight + greenOffset\n\t\t\t);\n\t\t\tvec2 uv1 = vec2(\n\t\t\t\trgb.r,\n\t\t\t\tslice1 * sliceHeight + greenOffset\n\t\t\t);\n\n\t\t\tvec3 sample0 = texture2D( tex, uv0 ).rgb;\n\t\t\tvec3 sample1 = texture2D( tex, uv1 ).rgb;\n\n\t\t\treturn mix( sample0, sample1, abs( centeredInterp ) );\n\n\t\t}\n\t\t#endif\n\n\t\tvarying vec2 vUv;\n\t\tuniform float intensity;\n\t\tuniform sampler2D tDiffuse;\n\t\tvoid main() {\n\n\t\t\tvec4 val = texture2D( tDiffuse, vUv );\n\t\t\tvec4 lutVal;\n\n\t\t\t// pull the sample in by half a pixel so the sample begins\n\t\t\t// at the center of the edge pixels.\n\t\t\tfloat pixelWidth = 1.0 / lutSize;\n\t\t\tfloat halfPixelWidth = 0.5 / lutSize;\n\t\t\tvec3 uvw = vec3( halfPixelWidth ) + val.rgb * ( 1.0 - pixelWidth );\n\n\t\t\t#if USE_3DTEXTURE\n\n\t\t\tlutVal = vec4( texture( lut3d, uvw ).rgb, val.a );\n\n\t\t\t#else\n\n\t\t\tlutVal = vec4( lutLookup( lut, lutSize, uvw ), val.a );\n\n\t\t\t#endif\n\n\t\t\tgl_FragColor = vec4( mix( val, lutVal, intensity ) );\n\n\t\t}\n\n\t"};class Bme extends OR{set lut(e){const t=this.material;if(e!==this.lut&&(t.uniforms.lut3d.value=null,t.uniforms.lut.value=null,e)){const n=e.isData3DTexture?1:0;n!==t.defines.USE_3DTEXTURE&&(t.defines.USE_3DTEXTURE=n,t.needsUpdate=!0),t.uniforms.lutSize.value=e.image.width,e.isData3DTexture?t.uniforms.lut3d.value=e:t.uniforms.lut.value=e}}get lut(){return this.material.uniforms.lut.value||this.material.uniforms.lut3d.value}set intensity(e){this.material.uniforms.intensity.value=e}get intensity(){return this.material.uniforms.intensity.value}constructor(e={}){super(Fme),this.lut=e.lut||null,this.intensity="intensity"in e?e.intensity:1}}class jl extends Hi{getType(){return OR}set textureID(e){this._objRef&&(this._objRef.textureID=e)}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}set material(e){this._objRef&&(this._objRef.material=e)}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}}jl.\u0275fac=function(){let i;return function(t){return(i||(i=ce(jl)))(t||jl)}}(),jl.\u0275cmp=$({type:jl,selectors:[["th-shaderPass"]],inputs:{textureID:"textureID",uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[se([{provide:Pi,useExisting:le(()=>jl)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class ym extends jl{getType(){return Bme}set lut(e){this._objRef&&(this._objRef.lut=e)}set intensity(e){this._objRef&&(this._objRef.intensity=e)}}ym.\u0275fac=function(){let i;return function(t){return(i||(i=ce(ym)))(t||ym)}}(),ym.\u0275cmp=$({type:ym,selectors:[["th-lUTPass"]],inputs:{lut:"lut",intensity:"intensity"},features:[se([{provide:Pi,useExisting:le(()=>ym)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Zu extends ds{getType(){return kce}}Zu.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Zu)))(t||Zu)}}(),Zu.\u0275cmp=$({type:Zu,selectors:[["th-mapControls"]],features:[se([{provide:zn,useExisting:le(()=>Zu)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Am extends Hi{getType(){return NR}set scene(e){this._objRef&&(this._objRef.scene=e)}set camera(e){this._objRef&&(this._objRef.camera=e)}set inverse(e){this._objRef&&(this._objRef.inverse=e)}}Am.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Am)))(t||Am)}}(),Am.\u0275cmp=$({type:Am,selectors:[["th-maskPass"]],inputs:{scene:"scene",camera:"camera",inverse:"inverse"},features:[se([{provide:Pi,useExisting:le(()=>Am)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class xm extends Ei{getType(){return Zd}set type(e){this._objRef&&(this._objRef.type=e)}set map(e){this._objRef&&(this._objRef.map=e)}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}set depthPacking(e){this._objRef&&(this._objRef.depthPacking=e)}set displacementMap(e){this._objRef&&(this._objRef.displacementMap=e)}set displacementScale(e){this._objRef&&(this._objRef.displacementScale=e)}set displacementBias(e){this._objRef&&(this._objRef.displacementBias=e)}set wireframe(e){this._objRef&&(this._objRef.wireframe=e)}set wireframeLinewidth(e){this._objRef&&(this._objRef.wireframeLinewidth=e)}set fog(e){this._objRef&&(this._objRef.fog=e)}}xm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(xm)))(t||xm)}}(),xm.\u0275cmp=$({type:xm,selectors:[["th-meshDepthMaterial"]],inputs:{type:"type",map:"map",alphaMap:"alphaMap",depthPacking:"depthPacking",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",fog:"fog"},features:[se([{provide:Ei,useExisting:le(()=>xm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class wm extends Ei{getType(){return qA}set type(e){this._objRef&&(this._objRef.type=e)}set map(e){this._objRef&&(this._objRef.map=e)}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}set displacementMap(e){this._objRef&&(this._objRef.displacementMap=e)}set displacementScale(e){this._objRef&&(this._objRef.displacementScale=e)}set displacementBias(e){this._objRef&&(this._objRef.displacementBias=e)}set farDistance(e){this._objRef&&(this._objRef.farDistance=e)}set nearDistance(e){this._objRef&&(this._objRef.nearDistance=e)}set referencePosition(e){this._objRef&&(this._objRef.referencePosition=Qe(this._objRef.referencePosition,e))}set fog(e){this._objRef&&(this._objRef.fog=e)}}wm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(wm)))(t||wm)}}(),wm.\u0275cmp=$({type:wm,selectors:[["th-meshDistanceMaterial"]],inputs:{type:"type",map:"map",alphaMap:"alphaMap",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",farDistance:"farDistance",nearDistance:"nearDistance",referencePosition:"referencePosition",fog:"fog"},features:[se([{provide:Ei,useExisting:le(()=>wm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Cm extends Ei{getType(){return gx}set type(e){this._objRef&&(this._objRef.type=e)}set color(e){this._objRef&&(this._objRef.color=Qe(this._objRef.color,e))}set bumpMap(e){this._objRef&&(this._objRef.bumpMap=e)}set bumpScale(e){this._objRef&&(this._objRef.bumpScale=e)}set displacementMap(e){this._objRef&&(this._objRef.displacementMap=e)}set displacementScale(e){this._objRef&&(this._objRef.displacementScale=e)}set displacementBias(e){this._objRef&&(this._objRef.displacementBias=e)}set emissive(e){this._objRef&&(this._objRef.emissive=Qe(this._objRef.emissive,e))}set emissiveIntensity(e){this._objRef&&(this._objRef.emissiveIntensity=e)}set emissiveMap(e){this._objRef&&(this._objRef.emissiveMap=e)}set flatShading(e){this._objRef&&(this._objRef.flatShading=e)}set map(e){this._objRef&&(this._objRef.map=e)}set lightMap(e){this._objRef&&(this._objRef.lightMap=e)}set lightMapIntensity(e){this._objRef&&(this._objRef.lightMapIntensity=e)}set normalMap(e){this._objRef&&(this._objRef.normalMap=e)}set normalMapType(e){this._objRef&&(this._objRef.normalMapType=e)}set normalScale(e){this._objRef&&(this._objRef.normalScale=Qe(this._objRef.normalScale,e))}set aoMap(e){this._objRef&&(this._objRef.aoMap=e)}set aoMapIntensity(e){this._objRef&&(this._objRef.aoMapIntensity=e)}set specularMap(e){this._objRef&&(this._objRef.specularMap=e)}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}set envMap(e){this._objRef&&(this._objRef.envMap=e)}set combine(e){this._objRef&&(this._objRef.combine=e)}set reflectivity(e){this._objRef&&(this._objRef.reflectivity=e)}set refractionRatio(e){this._objRef&&(this._objRef.refractionRatio=e)}set wireframe(e){this._objRef&&(this._objRef.wireframe=e)}set wireframeLinewidth(e){this._objRef&&(this._objRef.wireframeLinewidth=e)}set wireframeLinecap(e){this._objRef&&(this._objRef.wireframeLinecap=e)}set wireframeLinejoin(e){this._objRef&&(this._objRef.wireframeLinejoin=e)}set fog(e){this._objRef&&(this._objRef.fog=e)}}Cm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Cm)))(t||Cm)}}(),Cm.\u0275cmp=$({type:Cm,selectors:[["th-meshLambertMaterial"]],inputs:{type:"type",color:"color",bumpMap:"bumpMap",bumpScale:"bumpScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",emissive:"emissive",emissiveIntensity:"emissiveIntensity",emissiveMap:"emissiveMap",flatShading:"flatShading",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",specularMap:"specularMap",alphaMap:"alphaMap",envMap:"envMap",combine:"combine",reflectivity:"reflectivity",refractionRatio:"refractionRatio",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",fog:"fog"},features:[se([{provide:Ei,useExisting:le(()=>Cm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Mm extends Ei{getType(){return uI}set type(e){this._objRef&&(this._objRef.type=e)}set defines(e){this._objRef&&(this._objRef.defines=e)}set color(e){this._objRef&&(this._objRef.color=Qe(this._objRef.color,e))}set matcap(e){this._objRef&&(this._objRef.matcap=e)}set map(e){this._objRef&&(this._objRef.map=e)}set bumpMap(e){this._objRef&&(this._objRef.bumpMap=e)}set bumpScale(e){this._objRef&&(this._objRef.bumpScale=e)}set normalMap(e){this._objRef&&(this._objRef.normalMap=e)}set normalMapType(e){this._objRef&&(this._objRef.normalMapType=e)}set normalScale(e){this._objRef&&(this._objRef.normalScale=Qe(this._objRef.normalScale,e))}set displacementMap(e){this._objRef&&(this._objRef.displacementMap=e)}set displacementScale(e){this._objRef&&(this._objRef.displacementScale=e)}set displacementBias(e){this._objRef&&(this._objRef.displacementBias=e)}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}set flatShading(e){this._objRef&&(this._objRef.flatShading=e)}set fog(e){this._objRef&&(this._objRef.fog=e)}}Mm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Mm)))(t||Mm)}}(),Mm.\u0275cmp=$({type:Mm,selectors:[["th-meshMatcapMaterial"]],inputs:{type:"type",defines:"defines",color:"color",matcap:"matcap",map:"map",bumpMap:"bumpMap",bumpScale:"bumpScale",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",alphaMap:"alphaMap",flatShading:"flatShading",fog:"fog"},features:[se([{provide:Ei,useExisting:le(()=>Mm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Em extends Ei{getType(){return ap}set type(e){this._objRef&&(this._objRef.type=e)}set bumpMap(e){this._objRef&&(this._objRef.bumpMap=e)}set bumpScale(e){this._objRef&&(this._objRef.bumpScale=e)}set normalMap(e){this._objRef&&(this._objRef.normalMap=e)}set normalMapType(e){this._objRef&&(this._objRef.normalMapType=e)}set normalScale(e){this._objRef&&(this._objRef.normalScale=Qe(this._objRef.normalScale,e))}set displacementMap(e){this._objRef&&(this._objRef.displacementMap=e)}set displacementScale(e){this._objRef&&(this._objRef.displacementScale=e)}set displacementBias(e){this._objRef&&(this._objRef.displacementBias=e)}set wireframe(e){this._objRef&&(this._objRef.wireframe=e)}set wireframeLinewidth(e){this._objRef&&(this._objRef.wireframeLinewidth=e)}set flatShading(e){this._objRef&&(this._objRef.flatShading=e)}}Em.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Em)))(t||Em)}}(),Em.\u0275cmp=$({type:Em,selectors:[["th-meshNormalMaterial"]],inputs:{type:"type",bumpMap:"bumpMap",bumpScale:"bumpScale",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",flatShading:"flatShading"},features:[se([{provide:Ei,useExisting:le(()=>Em)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Ul extends Ei{getType(){return La}set type(e){this._objRef&&(this._objRef.type=e)}set defines(e){this._objRef&&(this._objRef.defines=e)}set color(e){this._objRef&&(this._objRef.color=Qe(this._objRef.color,e))}set roughness(e){this._objRef&&(this._objRef.roughness=e)}set metalness(e){this._objRef&&(this._objRef.metalness=e)}set map(e){this._objRef&&(this._objRef.map=e)}set lightMap(e){this._objRef&&(this._objRef.lightMap=e)}set lightMapIntensity(e){this._objRef&&(this._objRef.lightMapIntensity=e)}set aoMap(e){this._objRef&&(this._objRef.aoMap=e)}set aoMapIntensity(e){this._objRef&&(this._objRef.aoMapIntensity=e)}set emissive(e){this._objRef&&(this._objRef.emissive=Qe(this._objRef.emissive,e))}set emissiveIntensity(e){this._objRef&&(this._objRef.emissiveIntensity=e)}set emissiveMap(e){this._objRef&&(this._objRef.emissiveMap=e)}set bumpMap(e){this._objRef&&(this._objRef.bumpMap=e)}set bumpScale(e){this._objRef&&(this._objRef.bumpScale=e)}set normalMap(e){this._objRef&&(this._objRef.normalMap=e)}set normalMapType(e){this._objRef&&(this._objRef.normalMapType=e)}set normalScale(e){this._objRef&&(this._objRef.normalScale=Qe(this._objRef.normalScale,e))}set displacementMap(e){this._objRef&&(this._objRef.displacementMap=e)}set displacementScale(e){this._objRef&&(this._objRef.displacementScale=e)}set displacementBias(e){this._objRef&&(this._objRef.displacementBias=e)}set roughnessMap(e){this._objRef&&(this._objRef.roughnessMap=e)}set metalnessMap(e){this._objRef&&(this._objRef.metalnessMap=e)}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}set envMap(e){this._objRef&&(this._objRef.envMap=e)}set envMapIntensity(e){this._objRef&&(this._objRef.envMapIntensity=e)}set wireframe(e){this._objRef&&(this._objRef.wireframe=e)}set wireframeLinewidth(e){this._objRef&&(this._objRef.wireframeLinewidth=e)}set wireframeLinecap(e){this._objRef&&(this._objRef.wireframeLinecap=e)}set wireframeLinejoin(e){this._objRef&&(this._objRef.wireframeLinejoin=e)}set flatShading(e){this._objRef&&(this._objRef.flatShading=e)}set fog(e){this._objRef&&(this._objRef.fog=e)}set isMeshStandardMaterial(e){this._objRef&&(this._objRef.isMeshStandardMaterial=e)}}Ul.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Ul)))(t||Ul)}}(),Ul.\u0275cmp=$({type:Ul,selectors:[["th-meshStandardMaterial"]],inputs:{type:"type",defines:"defines",color:"color",roughness:"roughness",metalness:"metalness",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",emissive:"emissive",emissiveIntensity:"emissiveIntensity",emissiveMap:"emissiveMap",bumpMap:"bumpMap",bumpScale:"bumpScale",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",roughnessMap:"roughnessMap",metalnessMap:"metalnessMap",alphaMap:"alphaMap",envMap:"envMap",envMapIntensity:"envMapIntensity",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",flatShading:"flatShading",fog:"fog",isMeshStandardMaterial:"isMeshStandardMaterial"},features:[se([{provide:Ei,useExisting:le(()=>Ul)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Sm extends Ul{getType(){return Oa}set type(e){this._objRef&&(this._objRef.type=e)}set defines(e){this._objRef&&(this._objRef.defines=e)}set clearcoat(e){this._objRef&&(this._objRef.clearcoat=e)}set clearcoatMap(e){this._objRef&&(this._objRef.clearcoatMap=e)}set clearcoatRoughness(e){this._objRef&&(this._objRef.clearcoatRoughness=e)}set clearcoatRoughnessMap(e){this._objRef&&(this._objRef.clearcoatRoughnessMap=e)}set clearcoatNormalScale(e){this._objRef&&(this._objRef.clearcoatNormalScale=Qe(this._objRef.clearcoatNormalScale,e))}set clearcoatNormalMap(e){this._objRef&&(this._objRef.clearcoatNormalMap=e)}set reflectivity(e){this._objRef&&(this._objRef.reflectivity=e)}set ior(e){this._objRef&&(this._objRef.ior=e)}set sheen(e){this._objRef&&(this._objRef.sheen=e)}set sheenColor(e){this._objRef&&(this._objRef.sheenColor=Qe(this._objRef.sheenColor,e))}set sheenColorMap(e){this._objRef&&(this._objRef.sheenColorMap=e)}set sheenRoughness(e){this._objRef&&(this._objRef.sheenRoughness=e)}set sheenRoughnessMap(e){this._objRef&&(this._objRef.sheenRoughnessMap=e)}set transmission(e){this._objRef&&(this._objRef.transmission=e)}set transmissionMap(e){this._objRef&&(this._objRef.transmissionMap=e)}set thickness(e){this._objRef&&(this._objRef.thickness=e)}set thicknessMap(e){this._objRef&&(this._objRef.thicknessMap=e)}set attenuationDistance(e){this._objRef&&(this._objRef.attenuationDistance=e)}set attenuationColor(e){this._objRef&&(this._objRef.attenuationColor=Qe(this._objRef.attenuationColor,e))}set specularIntensity(e){this._objRef&&(this._objRef.specularIntensity=e)}set specularColor(e){this._objRef&&(this._objRef.specularColor=Qe(this._objRef.specularColor,e))}set specularIntensityMap(e){this._objRef&&(this._objRef.specularIntensityMap=e)}set specularColorMap(e){this._objRef&&(this._objRef.specularColorMap=e)}set iridescenceMap(e){this._objRef&&(this._objRef.iridescenceMap=e)}set iridescenceIOR(e){this._objRef&&(this._objRef.iridescenceIOR=e)}set iridescence(e){this._objRef&&(this._objRef.iridescence=e)}set iridescenceThicknessRange(e){this._objRef&&(this._objRef.iridescenceThicknessRange=e)}set iridescenceThicknessMap(e){this._objRef&&(this._objRef.iridescenceThicknessMap=e)}}Sm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Sm)))(t||Sm)}}(),Sm.\u0275cmp=$({type:Sm,selectors:[["th-meshPhysicalMaterial"]],inputs:{type:"type",defines:"defines",clearcoat:"clearcoat",clearcoatMap:"clearcoatMap",clearcoatRoughness:"clearcoatRoughness",clearcoatRoughnessMap:"clearcoatRoughnessMap",clearcoatNormalScale:"clearcoatNormalScale",clearcoatNormalMap:"clearcoatNormalMap",reflectivity:"reflectivity",ior:"ior",sheen:"sheen",sheenColor:"sheenColor",sheenColorMap:"sheenColorMap",sheenRoughness:"sheenRoughness",sheenRoughnessMap:"sheenRoughnessMap",transmission:"transmission",transmissionMap:"transmissionMap",thickness:"thickness",thicknessMap:"thicknessMap",attenuationDistance:"attenuationDistance",attenuationColor:"attenuationColor",specularIntensity:"specularIntensity",specularColor:"specularColor",specularIntensityMap:"specularIntensityMap",specularColorMap:"specularColorMap",iridescenceMap:"iridescenceMap",iridescenceIOR:"iridescenceIOR",iridescence:"iridescence",iridescenceThicknessRange:"iridescenceThicknessRange",iridescenceThicknessMap:"iridescenceThicknessMap"},features:[se([{provide:Ei,useExisting:le(()=>Sm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Tm extends Ei{getType(){return dI}set type(e){this._objRef&&(this._objRef.type=e)}set defines(e){this._objRef&&(this._objRef.defines=e)}set color(e){this._objRef&&(this._objRef.color=Qe(this._objRef.color,e))}set gradientMap(e){this._objRef&&(this._objRef.gradientMap=e)}set map(e){this._objRef&&(this._objRef.map=e)}set lightMap(e){this._objRef&&(this._objRef.lightMap=e)}set lightMapIntensity(e){this._objRef&&(this._objRef.lightMapIntensity=e)}set aoMap(e){this._objRef&&(this._objRef.aoMap=e)}set aoMapIntensity(e){this._objRef&&(this._objRef.aoMapIntensity=e)}set emissive(e){this._objRef&&(this._objRef.emissive=Qe(this._objRef.emissive,e))}set emissiveIntensity(e){this._objRef&&(this._objRef.emissiveIntensity=e)}set emissiveMap(e){this._objRef&&(this._objRef.emissiveMap=e)}set bumpMap(e){this._objRef&&(this._objRef.bumpMap=e)}set bumpScale(e){this._objRef&&(this._objRef.bumpScale=e)}set normalMap(e){this._objRef&&(this._objRef.normalMap=e)}set normalMapType(e){this._objRef&&(this._objRef.normalMapType=e)}set normalScale(e){this._objRef&&(this._objRef.normalScale=Qe(this._objRef.normalScale,e))}set displacementMap(e){this._objRef&&(this._objRef.displacementMap=e)}set displacementScale(e){this._objRef&&(this._objRef.displacementScale=e)}set displacementBias(e){this._objRef&&(this._objRef.displacementBias=e)}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}set wireframe(e){this._objRef&&(this._objRef.wireframe=e)}set wireframeLinewidth(e){this._objRef&&(this._objRef.wireframeLinewidth=e)}set wireframeLinecap(e){this._objRef&&(this._objRef.wireframeLinecap=e)}set wireframeLinejoin(e){this._objRef&&(this._objRef.wireframeLinejoin=e)}set fog(e){this._objRef&&(this._objRef.fog=e)}}Tm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Tm)))(t||Tm)}}(),Tm.\u0275cmp=$({type:Tm,selectors:[["th-meshToonMaterial"]],inputs:{type:"type",defines:"defines",color:"color",gradientMap:"gradientMap",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",emissive:"emissive",emissiveIntensity:"emissiveIntensity",emissiveMap:"emissiveMap",bumpMap:"bumpMap",bumpScale:"bumpScale",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",alphaMap:"alphaMap",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",fog:"fog"},features:[se([{provide:Ei,useExisting:le(()=>Tm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Im extends qa{getType(){return ia}set type(e){this._objRef&&(this._objRef.type=e)}}Im.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Im)))(t||Im)}}(),Im.\u0275cmp=$({type:Im,selectors:[["th-octahedronGeometry"]],inputs:{type:"type"},features:[se([{provide:Mt,useExisting:le(()=>Im)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Ku extends Ms{getType(){return Pa}set type(e){this._objRef&&(this._objRef.type=e)}set zoom(e){this._objRef&&(this._objRef.zoom=e)}set view(e){this._objRef&&(this._objRef.view=e)}set left(e){this._objRef&&(this._objRef.left=e)}set right(e){this._objRef&&(this._objRef.right=e)}set top(e){this._objRef&&(this._objRef.top=e)}set bottom(e){this._objRef&&(this._objRef.bottom=e)}set near(e){this._objRef&&(this._objRef.near=e)}set far(e){this._objRef&&(this._objRef.far=e)}}Ku.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Ku)))(t||Ku)}}(),Ku.\u0275cmp=$({type:Ku,selectors:[["th-orthographicCamera"]],inputs:{type:"type",zoom:"zoom",view:"view",left:"left",right:"right",top:"top",bottom:"bottom",near:"near",far:"far"},features:[se([{provide:Ye,useExisting:le(()=>Ku)},{provide:Ms,useExisting:le(()=>Ku)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class jc extends vn{constructor(e,t,n,r){super(),this.renderScene=t,this.renderCamera=n,this.selectedObjects=void 0!==r?r:[],this.visibleEdgeColor=new De(1,1,1),this.hiddenEdgeColor=new De(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this.resolution=void 0!==e?new ue(e.x,e.y):new ue(256,256);const s=Math.round(this.resolution.x/this.downSampleRatio),o=Math.round(this.resolution.y/this.downSampleRatio);this.renderTargetMaskBuffer=new Gt(this.resolution.x,this.resolution.y),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new Zd,this.depthMaterial.side=rc,this.depthMaterial.depthPacking=W_,this.depthMaterial.blending=Kt,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=rc,this.prepareMaskMaterial.fragmentShader=function d(u,h){return u.replace(/DEPTH_TO_VIEW_Z/g,(h.isPerspectiveCamera?"perspective":"orthographic")+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new Gt(this.resolution.x,this.resolution.y),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new Gt(s,o),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new Gt(s,o),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new Gt(Math.round(s/2),Math.round(o/2)),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new Gt(s,o),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new Gt(Math.round(s/2),Math.round(o/2)),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1,this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value.set(s,o),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(s/2),Math.round(o/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial();const c=Zr;this.copyUniforms=mi.clone(c.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new Rt({uniforms:this.copyUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,blending:Kt,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new De,this.oldClearAlpha=1,this.fsQuad=new wr(null),this.tempPulseColor1=new De,this.tempPulseColor2=new De,this.textureMatrix=new Ve}dispose(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose(),this.depthMaterial.dispose(),this.prepareMaskMaterial.dispose(),this.edgeDetectionMaterial.dispose(),this.separableBlurMaterial1.dispose(),this.separableBlurMaterial2.dispose(),this.overlayMaterial.dispose(),this.materialCopy.dispose(),this.fsQuad.dispose()}setSize(e,t){this.renderTargetMaskBuffer.setSize(e,t),this.renderTargetDepthBuffer.setSize(e,t);let n=Math.round(e/this.downSampleRatio),r=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(n,r),this.renderTargetBlurBuffer1.setSize(n,r),this.renderTargetEdgeBuffer1.setSize(n,r),this.separableBlurMaterial1.uniforms.texSize.value.set(n,r),n=Math.round(n/2),r=Math.round(r/2),this.renderTargetBlurBuffer2.setSize(n,r),this.renderTargetEdgeBuffer2.setSize(n,r),this.separableBlurMaterial2.uniforms.texSize.value.set(n,r)}changeVisibilityOfSelectedObjects(e){const t=this._visibilityCache;function n(r){r.isMesh&&(!0===e?r.visible=t.get(r):(t.set(r,r.visible),r.visible=e))}for(let r=0;r<this.selectedObjects.length;r++)this.selectedObjects[r].traverse(n)}changeVisibilityOfNonSelectedObjects(e){const t=this._visibilityCache,n=[];function r(o){o.isMesh&&n.push(o)}for(let o=0;o<this.selectedObjects.length;o++)this.selectedObjects[o].traverse(r);this.renderScene.traverse(function s(o){if(o.isMesh||o.isSprite){let a=!1;for(let l=0;l<n.length;l++)if(n[l].id===o.id){a=!0;break}if(!1===a){const l=o.visible;(!1===e||!0===t.get(o))&&(o.visible=e),t.set(o,l)}}else(o.isPoints||o.isLine)&&(!0===e?o.visible=t.get(o):(t.set(o,o.visible),o.visible=e))})}updateTextureMatrix(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)}render(e,t,n,r,s){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,s&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);const a=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this.renderScene.background=a,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){const l=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(l),this.tempPulseColor2.multiplyScalar(l)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=jc.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=jc.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=jc.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=jc.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(n),this.fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=n.texture,e.setRenderTarget(null),this.fsQuad.render(e))}getPrepareMaskMaterial(){return new Rt({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new ue(.5,.5)},textureMatrix:{value:null}},vertexShader:"#include <morphtarget_pars_vertex>\n\t\t\t\t#include <skinning_pars_vertex>\n\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tuniform mat4 textureMatrix;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <morphtarget_vertex>\n\t\t\t\t\t#include <skinning_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t\tvPosition = mvPosition;\n\n\t\t\t\t\tvec4 worldPosition = vec4( transformed, 1.0 );\n\n\t\t\t\t\t#ifdef USE_INSTANCING\n\n\t\t\t\t\t\tworldPosition = instanceMatrix * worldPosition;\n\n\t\t\t\t\t#endif\n\t\t\t\t\t\n\t\t\t\t\tworldPosition = modelMatrix * worldPosition;\n\n\t\t\t\t\tprojTexCoord = textureMatrix * worldPosition;\n\n\t\t\t\t}",fragmentShader:"#include <packing>\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tuniform sampler2D depthTexture;\n\t\t\t\tuniform vec2 cameraNearFar;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));\n\t\t\t\t\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );\n\t\t\t\t\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;\n\t\t\t\t\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);\n\n\t\t\t\t}"})}getEdgeDetectionMaterial(){return new Rt({uniforms:{maskTexture:{value:null},texSize:{value:new ue(.5,.5)},visibleEdgeColor:{value:new T(1,1,1)},hiddenEdgeColor:{value:new T(1,1,1)}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec3 visibleEdgeColor;\n\t\t\t\tuniform vec3 hiddenEdgeColor;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\n\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\n\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\n\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\n\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\n\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\n\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\n\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\n\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\n\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\n\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\n\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\n\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\n\t\t\t\t}"})}getSeperableBlurMaterial(e){return new Rt({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new ue(.5,.5)},direction:{value:new ue(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\t\t\t\tuniform float kernelRadius;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat sigma = kernelRadius/2.0;\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, sigma);\n\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\n\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\n\t\t\t\t\tvec2 uvOffset = delta;\n\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = kernelRadius * float(i) / float(MAX_RADIUS);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, sigma);\n\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\n\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\n\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\n\t\t\t\t\t\tweightSum += (2.0 * w);\n\t\t\t\t\t\tuvOffset += delta;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\n\t\t\t\t}"})}getOverlayMaterial(){return new Rt({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform sampler2D edgeTexture1;\n\t\t\t\tuniform sampler2D edgeTexture2;\n\t\t\t\tuniform sampler2D patternTexture;\n\t\t\t\tuniform float edgeStrength;\n\t\t\t\tuniform float edgeGlow;\n\t\t\t\tuniform bool usePatternTexture;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\n\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\n\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\n\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\n\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\n\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\n\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\n\t\t\t\t\tif(usePatternTexture)\n\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\n\t\t\t\t\tgl_FragColor = finalColor;\n\t\t\t\t}",blending:lf,depthTest:!1,depthWrite:!1,transparent:!0})}}jc.BlurDirectionX=new ue(1,0),jc.BlurDirectionY=new ue(0,1);class $u extends Hi{getType(){return jc}set renderScene(e){this._objRef&&(this._objRef.renderScene=e)}set renderCamera(e){this._objRef&&(this._objRef.renderCamera=e)}set selectedObjects(e){this._objRef&&(this._objRef.selectedObjects=e)}set visibleEdgeColor(e){this._objRef&&(this._objRef.visibleEdgeColor=Qe(this._objRef.visibleEdgeColor,e))}set hiddenEdgeColor(e){this._objRef&&(this._objRef.hiddenEdgeColor=Qe(this._objRef.hiddenEdgeColor,e))}set edgeGlow(e){this._objRef&&(this._objRef.edgeGlow=e)}set usePatternTexture(e){this._objRef&&(this._objRef.usePatternTexture=e)}set edgeThickness(e){this._objRef&&(this._objRef.edgeThickness=e)}set edgeStrength(e){this._objRef&&(this._objRef.edgeStrength=e)}set downSampleRatio(e){this._objRef&&(this._objRef.downSampleRatio=e)}set pulsePeriod(e){this._objRef&&(this._objRef.pulsePeriod=e)}set resolution(e){this._objRef&&(this._objRef.resolution=Qe(this._objRef.resolution,e))}set patternTexture(e){this._objRef&&(this._objRef.patternTexture=e)}set maskBufferMaterial(e){this._objRef&&(this._objRef.maskBufferMaterial=e)}set renderTargetMaskBuffer(e){this._objRef&&(this._objRef.renderTargetMaskBuffer=e)}set depthMaterial(e){this._objRef&&(this._objRef.depthMaterial=e)}set prepareMaskMaterial(e){this._objRef&&(this._objRef.prepareMaskMaterial=e)}set renderTargetDepthBuffer(e){this._objRef&&(this._objRef.renderTargetDepthBuffer=e)}set renderTargetMaskDownSampleBuffer(e){this._objRef&&(this._objRef.renderTargetMaskDownSampleBuffer=e)}set renderTargetBlurBuffer1(e){this._objRef&&(this._objRef.renderTargetBlurBuffer1=e)}set renderTargetBlurBuffer2(e){this._objRef&&(this._objRef.renderTargetBlurBuffer2=e)}set edgeDetectionMaterial(e){this._objRef&&(this._objRef.edgeDetectionMaterial=e)}set renderTargetEdgeBuffer1(e){this._objRef&&(this._objRef.renderTargetEdgeBuffer1=e)}set renderTargetEdgeBuffer2(e){this._objRef&&(this._objRef.renderTargetEdgeBuffer2=e)}set separableBlurMaterial1(e){this._objRef&&(this._objRef.separableBlurMaterial1=e)}set separableBlurMaterial2(e){this._objRef&&(this._objRef.separableBlurMaterial2=e)}set overlayMaterial(e){this._objRef&&(this._objRef.overlayMaterial=e)}set copyUniforms(e){this._objRef&&(this._objRef.copyUniforms=e)}set materialCopy(e){this._objRef&&(this._objRef.materialCopy=e)}set oldClearColor(e){this._objRef&&(this._objRef.oldClearColor=Qe(this._objRef.oldClearColor,e))}set oldClearAlpha(e){this._objRef&&(this._objRef.oldClearAlpha=e)}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}set tempPulseColor1(e){this._objRef&&(this._objRef.tempPulseColor1=Qe(this._objRef.tempPulseColor1,e))}set tempPulseColor2(e){this._objRef&&(this._objRef.tempPulseColor2=Qe(this._objRef.tempPulseColor2,e))}set textureMatrix(e){this._objRef&&(this._objRef.textureMatrix=Qe(this._objRef.textureMatrix,e))}}$u.\u0275fac=function(){let i;return function(t){return(i||(i=ce($u)))(t||$u)}}(),$u.\u0275cmp=$({type:$u,selectors:[["th-outlinePass"]],inputs:{renderScene:"renderScene",renderCamera:"renderCamera",selectedObjects:"selectedObjects",visibleEdgeColor:"visibleEdgeColor",hiddenEdgeColor:"hiddenEdgeColor",edgeGlow:"edgeGlow",usePatternTexture:"usePatternTexture",edgeThickness:"edgeThickness",edgeStrength:"edgeStrength",downSampleRatio:"downSampleRatio",pulsePeriod:"pulsePeriod",resolution:"resolution",patternTexture:"patternTexture",maskBufferMaterial:"maskBufferMaterial",renderTargetMaskBuffer:"renderTargetMaskBuffer",depthMaterial:"depthMaterial",prepareMaskMaterial:"prepareMaskMaterial",renderTargetDepthBuffer:"renderTargetDepthBuffer",renderTargetMaskDownSampleBuffer:"renderTargetMaskDownSampleBuffer",renderTargetBlurBuffer1:"renderTargetBlurBuffer1",renderTargetBlurBuffer2:"renderTargetBlurBuffer2",edgeDetectionMaterial:"edgeDetectionMaterial",renderTargetEdgeBuffer1:"renderTargetEdgeBuffer1",renderTargetEdgeBuffer2:"renderTargetEdgeBuffer2",separableBlurMaterial1:"separableBlurMaterial1",separableBlurMaterial2:"separableBlurMaterial2",overlayMaterial:"overlayMaterial",copyUniforms:"copyUniforms",materialCopy:"materialCopy",oldClearColor:"oldClearColor",oldClearAlpha:"oldClearAlpha",fsQuad:"fsQuad",tempPulseColor1:"tempPulseColor1",tempPulseColor2:"tempPulseColor2",textureMatrix:"textureMatrix"},features:[se([{provide:Pi,useExisting:le(()=>$u)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Lme extends xt{constructor(e=((r,s,o)=>o.set(r,s,Math.cos(r)*Math.sin(s))),t=8,n=8){super(),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n};const r=[],s=[],o=[],a=[],l=1e-5,c=new T,d=new T,u=new T,h=new T,f=new T,m=t+1;for(let p=0;p<=n;p++){const g=p/n;for(let _=0;_<=t;_++){const v=_/t;e(v,g,d),s.push(d.x,d.y,d.z),v-l>=0?(e(v-l,g,u),h.subVectors(d,u)):(e(v+l,g,u),h.subVectors(u,d)),g-l>=0?(e(v,g-l,u),f.subVectors(d,u)):(e(v,g+l,u),f.subVectors(u,d)),c.crossVectors(h,f).normalize(),o.push(c.x,c.y,c.z),a.push(v,g)}}for(let p=0;p<n;p++)for(let g=0;g<t;g++){const v=p*m+g+1,b=(p+1)*m+g+1,y=(p+1)*m+g;r.push(p*m+g,v,y),r.push(v,b,y)}this.setIndex(r),this.setAttribute("position",new Ge(s,3)),this.setAttribute("normal",new Ge(o,3)),this.setAttribute("uv",new Ge(a,2))}}class Rm extends Mt{getType(){return Lme}set type(e){this._objRef&&(this._objRef.type=e)}set parameters(e){this._objRef&&(this._objRef.parameters=e)}}Rm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Rm)))(t||Rm)}}(),Rm.\u0275cmp=$({type:Rm,selectors:[["th-parametricGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[se([{provide:Mt,useExisting:le(()=>Rm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Dm extends Es{getType(){return Z4}set type(e){this._objRef&&(this._objRef.type=e)}set plane(e){this._objRef&&(this._objRef.plane=Qe(this._objRef.plane,e))}set size(e){this._objRef&&(this._objRef.size=e)}}Dm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Dm)))(t||Dm)}}(),Dm.\u0275cmp=$({type:Dm,selectors:[["th-planeHelper"]],inputs:{type:"type",plane:"plane",size:"size"},features:[se([{provide:Ye,useExisting:le(()=>Dm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const Pm=new $s(0,0,0,"YXZ"),km=new T,Ome={type:"change"},Nme={type:"lock"},jme={type:"unlock"},hH=Math.PI/2;class Ume extends os{constructor(e,t){super(),this.domElement=t,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1;const n=this;function r(a){if(!1===n.isLocked)return;const l=a.movementX||a.mozMovementX||a.webkitMovementX||0,c=a.movementY||a.mozMovementY||a.webkitMovementY||0;Pm.setFromQuaternion(e.quaternion),Pm.y-=.002*l*n.pointerSpeed,Pm.x-=.002*c*n.pointerSpeed,Pm.x=Math.max(hH-n.maxPolarAngle,Math.min(hH-n.minPolarAngle,Pm.x)),e.quaternion.setFromEuler(Pm),n.dispatchEvent(Ome)}function s(){n.domElement.ownerDocument.pointerLockElement===n.domElement?(n.dispatchEvent(Nme),n.isLocked=!0):(n.dispatchEvent(jme),n.isLocked=!1)}function o(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}this.connect=function(){n.domElement.ownerDocument.addEventListener("mousemove",r),n.domElement.ownerDocument.addEventListener("pointerlockchange",s),n.domElement.ownerDocument.addEventListener("pointerlockerror",o)},this.disconnect=function(){n.domElement.ownerDocument.removeEventListener("mousemove",r),n.domElement.ownerDocument.removeEventListener("pointerlockchange",s),n.domElement.ownerDocument.removeEventListener("pointerlockerror",o)},this.dispose=function(){this.disconnect()},this.getObject=function(){return e},this.getDirection=function(){const a=new T(0,0,-1);return function(l){return l.copy(a).applyQuaternion(e.quaternion)}}(),this.moveForward=function(a){km.setFromMatrixColumn(e.matrix,0),km.crossVectors(e.up,km),e.position.addScaledVector(km,a)},this.moveRight=function(a){km.setFromMatrixColumn(e.matrix,0),e.position.addScaledVector(km,a)},this.lock=function(){this.domElement.requestPointerLock()},this.unlock=function(){n.domElement.ownerDocument.exitPointerLock()},this.connect()}}class Fm extends zn{getType(){return Ume}set domElement(e){this._objRef&&(this._objRef.domElement=e)}set isLocked(e){this._objRef&&(this._objRef.isLocked=e)}set minPolarAngle(e){this._objRef&&(this._objRef.minPolarAngle=e)}set maxPolarAngle(e){this._objRef&&(this._objRef.maxPolarAngle=e)}}Fm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Fm)))(t||Fm)}}(),Fm.\u0275cmp=$({type:Fm,selectors:[["th-pointerLockControls"]],inputs:{domElement:"domElement",isLocked:"isLocked",minPolarAngle:"minPolarAngle",maxPolarAngle:"maxPolarAngle"},features:[se([{provide:zn,useExisting:le(()=>Fm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Bm extends Ye{getType(){return j4}set type(e){this._objRef&&(this._objRef.type=e)}set light(e){this._objRef&&(this._objRef.light=e)}set color(e){this._objRef&&(this._objRef.color=e)}set matrix(e){this._objRef&&(this._objRef.matrix=Qe(this._objRef.matrix,e))}set matrixAutoUpdate(e){this._objRef&&(this._objRef.matrixAutoUpdate=e)}}Bm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Bm)))(t||Bm)}}(),Bm.\u0275cmp=$({type:Bm,selectors:[["th-pointLightHelper"]],inputs:{type:"type",light:"light",color:"color",matrix:"matrix",matrixAutoUpdate:"matrixAutoUpdate"},features:[se([{provide:Ye,useExisting:le(()=>Bm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Lm extends Ye{getType(){return $d}set type(e){this._objRef&&(this._objRef.type=e)}set morphTargetInfluences(e){this._objRef&&(this._objRef.morphTargetInfluences=e)}set morphTargetDictionary(e){this._objRef&&(this._objRef.morphTargetDictionary=e)}set geometry(e){this._objRef&&(this._objRef.geometry=e)}set material(e){this._objRef&&(this._objRef.material=e)}}Lm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Lm)))(t||Lm)}}(),Lm.\u0275cmp=$({type:Lm,selectors:[["th-points"]],inputs:{type:"type",morphTargetInfluences:"morphTargetInfluences",morphTargetDictionary:"morphTargetDictionary",geometry:"geometry",material:"material"},features:[se([{provide:Ye,useExisting:le(()=>Lm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Om extends Ei{getType(){return El}set type(e){this._objRef&&(this._objRef.type=e)}set color(e){this._objRef&&(this._objRef.color=Qe(this._objRef.color,e))}set map(e){this._objRef&&(this._objRef.map=e)}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}set size(e){this._objRef&&(this._objRef.size=e)}set sizeAttenuation(e){this._objRef&&(this._objRef.sizeAttenuation=e)}set fog(e){this._objRef&&(this._objRef.fog=e)}}Om.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Om)))(t||Om)}}(),Om.\u0275cmp=$({type:Om,selectors:[["th-pointsMaterial"]],inputs:{type:"type",color:"color",map:"map",alphaMap:"alphaMap",size:"size",sizeAttenuation:"sizeAttenuation",fog:"fog"},features:[se([{provide:Ei,useExisting:le(()=>Om)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Nm extends Es{getType(){return H4}set type(e){this._objRef&&(this._objRef.type=e)}}Nm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Nm)))(t||Nm)}}(),Nm.\u0275cmp=$({type:Nm,selectors:[["th-polarGridHelper"]],inputs:{type:"type"},features:[se([{provide:Ye,useExisting:le(()=>Nm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class jm extends Bu{getType(){return T4}set panner(e){this._objRef&&(this._objRef.panner=e)}}jm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(jm)))(t||jm)}}(),jm.\u0275cmp=$({type:jm,selectors:[["th-positionalAudio"]],inputs:{panner:"panner"},features:[se([{provide:Ye,useExisting:le(()=>jm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Uc extends Ei{getType(){return Rt}set type(e){this._objRef&&(this._objRef.type=e)}set defines(e){this._objRef&&(this._objRef.defines=e)}set uniforms(e){this._objRef&&(this._objRef.uniforms=e)}set vertexShader(e){this._objRef&&(this._objRef.vertexShader=e)}set fragmentShader(e){this._objRef&&(this._objRef.fragmentShader=e)}set linewidth(e){this._objRef&&(this._objRef.linewidth=e)}set wireframe(e){this._objRef&&(this._objRef.wireframe=e)}set wireframeLinewidth(e){this._objRef&&(this._objRef.wireframeLinewidth=e)}set fog(e){this._objRef&&(this._objRef.fog=e)}set lights(e){this._objRef&&(this._objRef.lights=e)}set clipping(e){this._objRef&&(this._objRef.clipping=e)}set derivatives(e){this._objRef&&(this._objRef.derivatives=e)}set extensions(e){this._objRef&&(this._objRef.extensions=e)}set defaultAttributeValues(e){this._objRef&&(this._objRef.defaultAttributeValues=e)}set index0AttributeName(e){this._objRef&&(this._objRef.index0AttributeName=e)}set uniformsNeedUpdate(e){this._objRef&&(this._objRef.uniformsNeedUpdate=e)}set glslVersion(e){this._objRef&&(this._objRef.glslVersion=e)}set isShaderMaterial(e){this._objRef&&(this._objRef.isShaderMaterial=e)}}Uc.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Uc)))(t||Uc)}}(),Uc.\u0275cmp=$({type:Uc,selectors:[["th-shaderMaterial"]],inputs:{type:"type",defines:"defines",uniforms:"uniforms",vertexShader:"vertexShader",fragmentShader:"fragmentShader",linewidth:"linewidth",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",fog:"fog",lights:"lights",clipping:"clipping",derivatives:"derivatives",extensions:"extensions",defaultAttributeValues:"defaultAttributeValues",index0AttributeName:"index0AttributeName",uniformsNeedUpdate:"uniformsNeedUpdate",glslVersion:"glslVersion",isShaderMaterial:"isShaderMaterial"},features:[se([{provide:Ei,useExisting:le(()=>Uc)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Um extends Uc{getType(){return cI}}Um.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Um)))(t||Um)}}(),Um.\u0275cmp=$({type:Um,selectors:[["th-rawShaderMaterial"]],features:[se([{provide:Ei,useExisting:le(()=>Um)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Vm extends Ss{getType(){return wI}set type(e){this._objRef&&(this._objRef.type=e)}set width(e){this._objRef&&(this._objRef.width=e)}set height(e){this._objRef&&(this._objRef.height=e)}set intensity(e){this._objRef&&(this._objRef.intensity=e)}set power(e){this._objRef&&(this._objRef.power=e)}}Vm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Vm)))(t||Vm)}}(),Vm.\u0275cmp=$({type:Vm,selectors:[["th-rectAreaLight"]],inputs:{type:"type",width:"width",height:"height",intensity:"intensity",power:"power"},features:[se([{provide:Ye,useExisting:le(()=>Vm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class zm extends Mt{getType(){return ip}set type(e){this._objRef&&(this._objRef.type=e)}set parameters(e){this._objRef&&(this._objRef.parameters=e)}}zm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(zm)))(t||zm)}}(),zm.\u0275cmp=$({type:zm,selectors:[["th-ringGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[se([{provide:Mt,useExisting:le(()=>zm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const _b=new T;function Lo(i,e,t,n,r,s){const o=2*Math.PI*r/4,a=Math.max(s-2*r,0),l=Math.PI/4;_b.copy(e),_b[n]=0,_b.normalize();const c=.5*o/(o+a),d=1-_b.angleTo(i)/l;return 1===Math.sign(_b[t])?d*c:a/(o+a)+c+c*(1-d)}class Vme extends Ki{constructor(e=1,t=1,n=1,r=2,s=.1){if(r=2*r+1,s=Math.min(e/2,t/2,n/2,s),super(1,1,1,r,r,r),1===r)return;const o=this.toNonIndexed();this.index=null,this.attributes.position=o.attributes.position,this.attributes.normal=o.attributes.normal,this.attributes.uv=o.attributes.uv;const a=new T,l=new T,c=new T(e,t,n).divideScalar(2).subScalar(s),d=this.attributes.position.array,u=this.attributes.normal.array,h=this.attributes.uv.array,f=d.length/6,m=new T,p=.5/r;for(let g=0,_=0;g<d.length;g+=3,_+=2)switch(a.fromArray(d,g),l.copy(a),l.x-=Math.sign(l.x)*p,l.y-=Math.sign(l.y)*p,l.z-=Math.sign(l.z)*p,l.normalize(),d[g+0]=c.x*Math.sign(a.x)+l.x*s,d[g+1]=c.y*Math.sign(a.y)+l.y*s,d[g+2]=c.z*Math.sign(a.z)+l.z*s,u[g+0]=l.x,u[g+1]=l.y,u[g+2]=l.z,Math.floor(g/f)){case 0:m.set(1,0,0),h[_+0]=Lo(m,l,"z","y",s,n),h[_+1]=1-Lo(m,l,"y","z",s,t);break;case 1:m.set(-1,0,0),h[_+0]=1-Lo(m,l,"z","y",s,n),h[_+1]=1-Lo(m,l,"y","z",s,t);break;case 2:m.set(0,1,0),h[_+0]=1-Lo(m,l,"x","z",s,e),h[_+1]=Lo(m,l,"z","x",s,n);break;case 3:m.set(0,-1,0),h[_+0]=1-Lo(m,l,"x","z",s,e),h[_+1]=1-Lo(m,l,"z","x",s,n);break;case 4:m.set(0,0,1),h[_+0]=1-Lo(m,l,"x","y",s,e),h[_+1]=1-Lo(m,l,"y","x",s,t);break;case 5:m.set(0,0,-1),h[_+0]=Lo(m,l,"x","y",s,e),h[_+1]=1-Lo(m,l,"y","x",s,t)}}}class Hm extends Ua{getType(){return Vme}}Hm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Hm)))(t||Hm)}}(),Hm.\u0275cmp=$({type:Hm,selectors:[["th-roundedBoxGeometry"]],features:[se([{provide:Mt,useExisting:le(()=>Hm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const Pw={defines:{NUM_SAMPLES:7,NUM_RINGS:4,NORMAL_TEXTURE:0,DIFFUSE_TEXTURE:0,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},tDiffuse:{value:null},tNormal:{value:null},size:{value:new ue(512,512)},cameraNear:{value:1},cameraFar:{value:100},cameraProjectionMatrix:{value:new Ve},cameraInverseProjectionMatrix:{value:new Ve},scale:{value:1},intensity:{value:.1},bias:{value:.5},minResolution:{value:0},kernelRadius:{value:100},randomSeed:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t}",fragmentShader:"\n\n\t\t#include <common>\n\n\t\tvarying vec2 vUv;\n\n\t\t#if DIFFUSE_TEXTURE == 1\n\t\tuniform sampler2D tDiffuse;\n\t\t#endif\n\n\t\tuniform sampler2D tDepth;\n\n\t\t#if NORMAL_TEXTURE == 1\n\t\tuniform sampler2D tNormal;\n\t\t#endif\n\n\t\tuniform float cameraNear;\n\t\tuniform float cameraFar;\n\t\tuniform mat4 cameraProjectionMatrix;\n\t\tuniform mat4 cameraInverseProjectionMatrix;\n\n\t\tuniform float scale;\n\t\tuniform float intensity;\n\t\tuniform float bias;\n\t\tuniform float kernelRadius;\n\t\tuniform float minResolution;\n\t\tuniform vec2 size;\n\t\tuniform float randomSeed;\n\n\t\t// RGBA depth\n\n\t\t#include <packing>\n\n\t\tvec4 getDefaultColor( const in vec2 screenPosition ) {\n\t\t\t#if DIFFUSE_TEXTURE == 1\n\t\t\treturn texture2D( tDiffuse, vUv );\n\t\t\t#else\n\t\t\treturn vec4( 1.0 );\n\t\t\t#endif\n\t\t}\n\n\t\tfloat getDepth( const in vec2 screenPosition ) {\n\t\t\t#if DEPTH_PACKING == 1\n\t\t\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );\n\t\t\t#else\n\t\t\treturn texture2D( tDepth, screenPosition ).x;\n\t\t\t#endif\n\t\t}\n\n\t\tfloat getViewZ( const in float depth ) {\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\t\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#else\n\t\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#endif\n\t\t}\n\n\t\tvec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {\n\t\t\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];\n\t\t\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );\n\t\t\tclipPosition *= clipW; // unprojection.\n\n\t\t\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;\n\t\t}\n\n\t\tvec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {\n\t\t\t#if NORMAL_TEXTURE == 1\n\t\t\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );\n\t\t\t#else\n\t\t\treturn normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );\n\t\t\t#endif\n\t\t}\n\n\t\tfloat scaleDividedByCameraFar;\n\t\tfloat minResolutionMultipliedByCameraFar;\n\n\t\tfloat getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {\n\t\t\tvec3 viewDelta = sampleViewPosition - centerViewPosition;\n\t\t\tfloat viewDistance = length( viewDelta );\n\t\t\tfloat scaledScreenDistance = scaleDividedByCameraFar * viewDistance;\n\n\t\t\treturn max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );\n\t\t}\n\n\t\t// moving costly divides into consts\n\t\tconst float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );\n\t\tconst float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );\n\n\t\tfloat getAmbientOcclusion( const in vec3 centerViewPosition ) {\n\t\t\t// precompute some variables require in getOcclusion.\n\t\t\tscaleDividedByCameraFar = scale / cameraFar;\n\t\t\tminResolutionMultipliedByCameraFar = minResolution * cameraFar;\n\t\t\tvec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );\n\n\t\t\t// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/\n\t\t\tfloat angle = rand( vUv + randomSeed ) * PI2;\n\t\t\tvec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;\n\t\t\tvec2 radiusStep = radius;\n\n\t\t\tfloat occlusionSum = 0.0;\n\t\t\tfloat weightSum = 0.0;\n\n\t\t\tfor( int i = 0; i < NUM_SAMPLES; i ++ ) {\n\t\t\t\tvec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;\n\t\t\t\tradius += radiusStep;\n\t\t\t\tangle += ANGLE_STEP;\n\n\t\t\t\tfloat sampleDepth = getDepth( sampleUv );\n\t\t\t\tif( sampleDepth >= ( 1.0 - EPSILON ) ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tfloat sampleViewZ = getViewZ( sampleDepth );\n\t\t\t\tvec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );\n\t\t\t\tocclusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );\n\t\t\t\tweightSum += 1.0;\n\t\t\t}\n\n\t\t\tif( weightSum == 0.0 ) discard;\n\n\t\t\treturn occlusionSum * ( intensity / weightSum );\n\t\t}\n\n\t\tvoid main() {\n\t\t\tfloat centerDepth = getDepth( vUv );\n\t\t\tif( centerDepth >= ( 1.0 - EPSILON ) ) {\n\t\t\t\tdiscard;\n\t\t\t}\n\n\t\t\tfloat centerViewZ = getViewZ( centerDepth );\n\t\t\tvec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );\n\n\t\t\tfloat ambientOcclusion = getAmbientOcclusion( viewPosition );\n\n\t\t\tgl_FragColor = getDefaultColor( vUv );\n\t\t\tgl_FragColor.xyz *=  1.0 - ambientOcclusion;\n\t\t}"},Vc={defines:{KERNEL_RADIUS:4,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDiffuse:{value:null},size:{value:new ue(512,512)},sampleUvOffsets:{value:[new ue(0,0)]},sampleWeights:{value:[1]},tDepth:{value:null},cameraNear:{value:10},cameraFar:{value:1e3},depthCutoff:{value:10}},vertexShader:"\n\n\t\t#include <common>\n\n\t\tuniform vec2 size;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec2 vInvSize;\n\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tvInvSize = 1.0 / size;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t}",fragmentShader:"\n\n\t\t#include <common>\n\t\t#include <packing>\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tDepth;\n\n\t\tuniform float cameraNear;\n\t\tuniform float cameraFar;\n\t\tuniform float depthCutoff;\n\n\t\tuniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];\n\t\tuniform float sampleWeights[ KERNEL_RADIUS + 1 ];\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec2 vInvSize;\n\n\t\tfloat getDepth( const in vec2 screenPosition ) {\n\t\t\t#if DEPTH_PACKING == 1\n\t\t\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );\n\t\t\t#else\n\t\t\treturn texture2D( tDepth, screenPosition ).x;\n\t\t\t#endif\n\t\t}\n\n\t\tfloat getViewZ( const in float depth ) {\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\t\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#else\n\t\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#endif\n\t\t}\n\n\t\tvoid main() {\n\t\t\tfloat depth = getDepth( vUv );\n\t\t\tif( depth >= ( 1.0 - EPSILON ) ) {\n\t\t\t\tdiscard;\n\t\t\t}\n\n\t\t\tfloat centerViewZ = -getViewZ( depth );\n\t\t\tbool rBreak = false, lBreak = false;\n\n\t\t\tfloat weightSum = sampleWeights[0];\n\t\t\tvec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;\n\n\t\t\tfor( int i = 1; i <= KERNEL_RADIUS; i ++ ) {\n\n\t\t\t\tfloat sampleWeight = sampleWeights[i];\n\t\t\t\tvec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;\n\n\t\t\t\tvec2 sampleUv = vUv + sampleUvOffset;\n\t\t\t\tfloat viewZ = -getViewZ( getDepth( sampleUv ) );\n\n\t\t\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;\n\n\t\t\t\tif( ! rBreak ) {\n\t\t\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;\n\t\t\t\t\tweightSum += sampleWeight;\n\t\t\t\t}\n\n\t\t\t\tsampleUv = vUv - sampleUvOffset;\n\t\t\t\tviewZ = -getViewZ( getDepth( sampleUv ) );\n\n\t\t\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;\n\n\t\t\t\tif( ! lBreak ) {\n\t\t\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;\n\t\t\t\t\tweightSum += sampleWeight;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tgl_FragColor = diffuseSum / weightSum;\n\t\t}"},kw={createSampleWeights:function(i,e){const t=[];for(let n=0;n<=i;n++)t.push(zme(n,e));return t},createSampleOffsets:function(i,e){const t=[];for(let n=0;n<=i;n++)t.push(e.clone().multiplyScalar(n));return t},configure:function(i,e,t,n){i.defines.KERNEL_RADIUS=e,i.uniforms.sampleUvOffsets.value=kw.createSampleOffsets(e,n),i.uniforms.sampleWeights.value=kw.createSampleWeights(e,t),i.needsUpdate=!0}};function zme(i,e){return Math.exp(-i*i/(e*e*2))/(Math.sqrt(2*Math.PI)*e)}const KR_uniforms={tDiffuse:{value:null},opacity:{value:1}},KR_vertexShader="\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",KR_fragmentShader="\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\t#include <packing>\n\n\t\tvoid main() {\n\n\t\t\tfloat depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );\n\t\t\tgl_FragColor = vec4( vec3( depth ), opacity );\n\n\t\t}";let Hme=(()=>{class i extends vn{constructor(t,n,r=!1,s=!1,o=new ue(256,256)){let a;super(),this.scene=t,this.camera=n,this.clear=!0,this.needsSwap=!1,this.supportsDepthTextureExtension=r,this.supportsNormalTexture=s,this.originalClearColor=new De,this._oldClearColor=new De,this.oldClearAlpha=1,this.params={output:0,saoBias:.5,saoIntensity:.18,saoScale:1,saoKernelRadius:100,saoMinResolution:0,saoBlur:!0,saoBlurRadius:8,saoBlurStdDev:4,saoBlurDepthCutoff:.01},this.resolution=new ue(o.x,o.y),this.saoRenderTarget=new Gt(this.resolution.x,this.resolution.y),this.blurIntermediateRenderTarget=this.saoRenderTarget.clone(),this.beautyRenderTarget=this.saoRenderTarget.clone(),this.normalRenderTarget=new Gt(this.resolution.x,this.resolution.y,{minFilter:$t,magFilter:$t}),this.depthRenderTarget=this.normalRenderTarget.clone(),this.supportsDepthTextureExtension&&(a=new Hf,a.type=V_,this.beautyRenderTarget.depthTexture=a,this.beautyRenderTarget.depthBuffer=!0),this.depthMaterial=new Zd,this.depthMaterial.depthPacking=W_,this.depthMaterial.blending=Kt,this.normalMaterial=new ap,this.normalMaterial.blending=Kt,this.saoMaterial=new Rt({defines:Object.assign({},Pw.defines),fragmentShader:Pw.fragmentShader,vertexShader:Pw.vertexShader,uniforms:mi.clone(Pw.uniforms)}),this.saoMaterial.extensions.derivatives=!0,this.saoMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.saoMaterial.defines.NORMAL_TEXTURE=this.supportsNormalTexture?1:0,this.saoMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.saoMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?a:this.depthRenderTarget.texture,this.saoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.saoMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.blending=Kt,this.vBlurMaterial=new Rt({uniforms:mi.clone(Vc.uniforms),defines:Object.assign({},Vc.defines),vertexShader:Vc.vertexShader,fragmentShader:Vc.fragmentShader}),this.vBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.vBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.vBlurMaterial.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.vBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?a:this.depthRenderTarget.texture,this.vBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.vBlurMaterial.blending=Kt,this.hBlurMaterial=new Rt({uniforms:mi.clone(Vc.uniforms),defines:Object.assign({},Vc.defines),vertexShader:Vc.vertexShader,fragmentShader:Vc.fragmentShader}),this.hBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.hBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.hBlurMaterial.uniforms.tDiffuse.value=this.blurIntermediateRenderTarget.texture,this.hBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?a:this.depthRenderTarget.texture,this.hBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.hBlurMaterial.blending=Kt,this.materialCopy=new Rt({uniforms:mi.clone(Zr.uniforms),vertexShader:Zr.vertexShader,fragmentShader:Zr.fragmentShader,blending:Kt}),this.materialCopy.transparent=!0,this.materialCopy.depthTest=!1,this.materialCopy.depthWrite=!1,this.materialCopy.blending=cf,this.materialCopy.blendSrc=sA,this.materialCopy.blendDst=df,this.materialCopy.blendEquation=As,this.materialCopy.blendSrcAlpha=rA,this.materialCopy.blendDstAlpha=df,this.materialCopy.blendEquationAlpha=As,this.depthCopy=new Rt({uniforms:mi.clone(KR_uniforms),vertexShader:KR_vertexShader,fragmentShader:KR_fragmentShader,blending:Kt}),this.fsQuad=new wr(null)}render(t,n,r){if(this.renderToScreen&&(this.materialCopy.blending=Kt,this.materialCopy.uniforms.tDiffuse.value=r.texture,this.materialCopy.needsUpdate=!0,this.renderPass(t,this.materialCopy,null)),1===this.params.output)return;t.getClearColor(this._oldClearColor),this.oldClearAlpha=t.getClearAlpha();const s=t.autoClear;t.autoClear=!1,t.setRenderTarget(this.depthRenderTarget),t.clear(),this.saoMaterial.uniforms.bias.value=this.params.saoBias,this.saoMaterial.uniforms.intensity.value=this.params.saoIntensity,this.saoMaterial.uniforms.scale.value=this.params.saoScale,this.saoMaterial.uniforms.kernelRadius.value=this.params.saoKernelRadius,this.saoMaterial.uniforms.minResolution.value=this.params.saoMinResolution,this.saoMaterial.uniforms.cameraNear.value=this.camera.near,this.saoMaterial.uniforms.cameraFar.value=this.camera.far;const o=this.params.saoBlurDepthCutoff*(this.camera.far-this.camera.near);this.vBlurMaterial.uniforms.depthCutoff.value=o,this.hBlurMaterial.uniforms.depthCutoff.value=o,this.vBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.vBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.hBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.hBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.params.saoBlurRadius=Math.floor(this.params.saoBlurRadius),(this.prevStdDev!==this.params.saoBlurStdDev||this.prevNumSamples!==this.params.saoBlurRadius)&&(kw.configure(this.vBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new ue(0,1)),kw.configure(this.hBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new ue(1,0)),this.prevStdDev=this.params.saoBlurStdDev,this.prevNumSamples=this.params.saoBlurRadius),t.setClearColor(0),t.setRenderTarget(this.beautyRenderTarget),t.clear(),t.render(this.scene,this.camera),this.supportsDepthTextureExtension||this.renderOverride(t,this.depthMaterial,this.depthRenderTarget,0,1),this.supportsNormalTexture&&this.renderOverride(t,this.normalMaterial,this.normalRenderTarget,7829503,1),this.renderPass(t,this.saoMaterial,this.saoRenderTarget,16777215,1),this.params.saoBlur&&(this.renderPass(t,this.vBlurMaterial,this.blurIntermediateRenderTarget,16777215,1),this.renderPass(t,this.hBlurMaterial,this.saoRenderTarget,16777215,1));let a=this.materialCopy;3===this.params.output?this.supportsDepthTextureExtension?(this.materialCopy.uniforms.tDiffuse.value=this.beautyRenderTarget.depthTexture,this.materialCopy.needsUpdate=!0):(this.depthCopy.uniforms.tDiffuse.value=this.depthRenderTarget.texture,this.depthCopy.needsUpdate=!0,a=this.depthCopy):4===this.params.output?(this.materialCopy.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.materialCopy.needsUpdate=!0):(this.materialCopy.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.materialCopy.needsUpdate=!0),a.blending=0===this.params.output?cf:Kt,this.renderPass(t,a,this.renderToScreen?null:r),t.setClearColor(this._oldClearColor,this.oldClearAlpha),t.autoClear=s}renderPass(t,n,r,s,o){t.getClearColor(this.originalClearColor);const a=t.getClearAlpha(),l=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,null!=s&&(t.setClearColor(s),t.setClearAlpha(o||0),t.clear()),this.fsQuad.material=n,this.fsQuad.render(t),t.autoClear=l,t.setClearColor(this.originalClearColor),t.setClearAlpha(a)}renderOverride(t,n,r,s,o){t.getClearColor(this.originalClearColor);const a=t.getClearAlpha(),l=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,o=n.clearAlpha||o,null!=(s=n.clearColor||s)&&(t.setClearColor(s),t.setClearAlpha(o||0),t.clear()),this.scene.overrideMaterial=n,t.render(this.scene,this.camera),this.scene.overrideMaterial=null,t.autoClear=l,t.setClearColor(this.originalClearColor),t.setClearAlpha(a)}setSize(t,n){this.beautyRenderTarget.setSize(t,n),this.saoRenderTarget.setSize(t,n),this.blurIntermediateRenderTarget.setSize(t,n),this.normalRenderTarget.setSize(t,n),this.depthRenderTarget.setSize(t,n),this.saoMaterial.uniforms.size.value.set(t,n),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.needsUpdate=!0,this.vBlurMaterial.uniforms.size.value.set(t,n),this.vBlurMaterial.needsUpdate=!0,this.hBlurMaterial.uniforms.size.value.set(t,n),this.hBlurMaterial.needsUpdate=!0}dispose(){this.saoRenderTarget.dispose(),this.blurIntermediateRenderTarget.dispose(),this.beautyRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.depthRenderTarget.dispose(),this.depthMaterial.dispose(),this.normalMaterial.dispose(),this.saoMaterial.dispose(),this.vBlurMaterial.dispose(),this.hBlurMaterial.dispose(),this.materialCopy.dispose(),this.depthCopy.dispose(),this.fsQuad.dispose()}}return i.OUTPUT={Beauty:1,Default:0,SAO:2,Depth:3,Normal:4},i})();class Gm extends Hi{getType(){return Hme}set scene(e){this._objRef&&(this._objRef.scene=e)}set camera(e){this._objRef&&(this._objRef.camera=e)}set supportsDepthTextureExtension(e){this._objRef&&(this._objRef.supportsDepthTextureExtension=e)}set supportsNormalTexture(e){this._objRef&&(this._objRef.supportsNormalTexture=e)}set originalClearColor(e){this._objRef&&(this._objRef.originalClearColor=Qe(this._objRef.originalClearColor,e))}set oldClearColor(e){this._objRef&&(this._objRef.oldClearColor=Qe(this._objRef.oldClearColor,e))}set oldClearAlpha(e){this._objRef&&(this._objRef.oldClearAlpha=e)}set resolution(e){this._objRef&&(this._objRef.resolution=Qe(this._objRef.resolution,e))}set saoRenderTarget(e){this._objRef&&(this._objRef.saoRenderTarget=e)}set blurIntermediateRenderTarget(e){this._objRef&&(this._objRef.blurIntermediateRenderTarget=e)}set beautyRenderTarget(e){this._objRef&&(this._objRef.beautyRenderTarget=e)}set normalRenderTarget(e){this._objRef&&(this._objRef.normalRenderTarget=e)}set depthRenderTarget(e){this._objRef&&(this._objRef.depthRenderTarget=e)}set depthMaterial(e){this._objRef&&(this._objRef.depthMaterial=e)}set normalMaterial(e){this._objRef&&(this._objRef.normalMaterial=e)}set saoMaterial(e){this._objRef&&(this._objRef.saoMaterial=e)}set vBlurMaterial(e){this._objRef&&(this._objRef.vBlurMaterial=e)}set hBlurMaterial(e){this._objRef&&(this._objRef.hBlurMaterial=e)}set materialCopy(e){this._objRef&&(this._objRef.materialCopy=e)}set depthCopy(e){this._objRef&&(this._objRef.depthCopy=e)}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}set params(e){this._objRef&&(this._objRef.params=e)}}Gm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Gm)))(t||Gm)}}(),Gm.\u0275cmp=$({type:Gm,selectors:[["th-sAOPass"]],inputs:{scene:"scene",camera:"camera",supportsDepthTextureExtension:"supportsDepthTextureExtension",supportsNormalTexture:"supportsNormalTexture",originalClearColor:"originalClearColor",oldClearColor:"oldClearColor",oldClearAlpha:"oldClearAlpha",resolution:"resolution",saoRenderTarget:"saoRenderTarget",blurIntermediateRenderTarget:"blurIntermediateRenderTarget",beautyRenderTarget:"beautyRenderTarget",normalRenderTarget:"normalRenderTarget",depthRenderTarget:"depthRenderTarget",depthMaterial:"depthMaterial",normalMaterial:"normalMaterial",saoMaterial:"saoMaterial",vBlurMaterial:"vBlurMaterial",hBlurMaterial:"hBlurMaterial",materialCopy:"materialCopy",depthCopy:"depthCopy",fsQuad:"fsQuad",params:"params"},features:[se([{provide:Pi,useExisting:le(()=>Gm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Gme extends vn{constructor(e){super();const t=Zr;this.textureID="tDiffuse",this.uniforms=mi.clone(t.uniforms),this.material=new Rt({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.renderTarget=e,void 0===this.renderTarget&&(this.renderTarget=new Gt,this.renderTarget.texture.name="SavePass.rt"),this.needsSwap=!1,this.fsQuad=new wr(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),e.setRenderTarget(this.renderTarget),this.clear&&e.clear(),this.fsQuad.render(e)}setSize(e,t){this.renderTarget.setSize(e,t)}dispose(){this.renderTarget.dispose(),this.material.dispose(),this.fsQuad.dispose()}}class Qm extends Hi{getType(){return Gme}set textureID(e){this._objRef&&(this._objRef.textureID=e)}set renderTarget(e){this._objRef&&(this._objRef.renderTarget=e)}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}set material(e){this._objRef&&(this._objRef.material=e)}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}}Qm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Qm)))(t||Qm)}}(),Qm.\u0275cmp=$({type:Qm,selectors:[["th-savePass"]],inputs:{textureID:"textureID",renderTarget:"renderTarget",uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[se([{provide:Pi,useExisting:le(()=>Qm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Wm extends Ei{getType(){return lI}set type(e){this._objRef&&(this._objRef.type=e)}set color(e){this._objRef&&(this._objRef.color=Qe(this._objRef.color,e))}set transparent(e){this._objRef&&(this._objRef.transparent=e)}set fog(e){this._objRef&&(this._objRef.fog=e)}}Wm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Wm)))(t||Wm)}}(),Wm.\u0275cmp=$({type:Wm,selectors:[["th-shadowMaterial"]],inputs:{type:"type",color:"color",transparent:"transparent",fog:"fog"},features:[se([{provide:Ei,useExisting:le(()=>Wm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class qm extends Mt{getType(){return np}set type(e){this._objRef&&(this._objRef.type=e)}}qm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(qm)))(t||qm)}}(),qm.\u0275cmp=$({type:qm,selectors:[["th-shapeGeometry"]],inputs:{type:"type"},features:[se([{provide:Mt,useExisting:le(()=>qm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Xm extends Es{getType(){return O4}set type(e){this._objRef&&(this._objRef.type=e)}set bones(e){this._objRef&&(this._objRef.bones=e)}set root(e){this._objRef&&(this._objRef.root=e)}set matrix(e){this._objRef&&(this._objRef.matrix=Qe(this._objRef.matrix,e))}set matrixAutoUpdate(e){this._objRef&&(this._objRef.matrixAutoUpdate=e)}}Xm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Xm)))(t||Xm)}}(),Xm.\u0275cmp=$({type:Xm,selectors:[["th-skeletonHelper"]],inputs:{type:"type",bones:"bones",root:"root",matrix:"matrix",matrixAutoUpdate:"matrixAutoUpdate"},features:[se([{provide:Ye,useExisting:le(()=>Xm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Ym extends Vn{getType(){return f0}set bindMode(e){this._objRef&&(this._objRef.bindMode=e)}set bindMatrix(e){this._objRef&&(this._objRef.bindMatrix=Qe(this._objRef.bindMatrix,e))}set bindMatrixInverse(e){this._objRef&&(this._objRef.bindMatrixInverse=Qe(this._objRef.bindMatrixInverse,e))}set skeleton(e){this._objRef&&(this._objRef.skeleton=e)}}Ym.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Ym)))(t||Ym)}}(),Ym.\u0275cmp=$({type:Ym,selectors:[["th-skinnedMesh"]],inputs:{bindMode:"bindMode",bindMatrix:"bindMatrix",bindMatrixInverse:"bindMatrixInverse",skeleton:"skeleton"},features:[se([{provide:Ye,useExisting:le(()=>Ym)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const Fw={defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new ue(1/1024,1/512)}},vertexShader:"\n\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 3 ];\n\n\t\tvoid SMAAEdgeDetectionVS( vec2 texcoord ) {\n\t\t\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 ); // WebGL port note: Changed sign in W component\n\t\t\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component\n\t\t\tvOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 ); // WebGL port note: Changed sign in W component\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tSMAAEdgeDetectionVS( vUv );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 3 ];\n\n\t\tvec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {\n\t\t\tvec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );\n\n\t\t\t// Calculate color deltas:\n\t\t\tvec4 delta;\n\t\t\tvec3 C = texture2D( colorTex, texcoord ).rgb;\n\n\t\t\tvec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;\n\t\t\tvec3 t = abs( C - Cleft );\n\t\t\tdelta.x = max( max( t.r, t.g ), t.b );\n\n\t\t\tvec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;\n\t\t\tt = abs( C - Ctop );\n\t\t\tdelta.y = max( max( t.r, t.g ), t.b );\n\n\t\t\t// We do the usual threshold:\n\t\t\tvec2 edges = step( threshold, delta.xy );\n\n\t\t\t// Then discard if there is no edge:\n\t\t\tif ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )\n\t\t\t\tdiscard;\n\n\t\t\t// Calculate right and bottom deltas:\n\t\t\tvec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;\n\t\t\tt = abs( C - Cright );\n\t\t\tdelta.z = max( max( t.r, t.g ), t.b );\n\n\t\t\tvec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;\n\t\t\tt = abs( C - Cbottom );\n\t\t\tdelta.w = max( max( t.r, t.g ), t.b );\n\n\t\t\t// Calculate the maximum delta in the direct neighborhood:\n\t\t\tfloat maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );\n\n\t\t\t// Calculate left-left and top-top deltas:\n\t\t\tvec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;\n\t\t\tt = abs( C - Cleftleft );\n\t\t\tdelta.z = max( max( t.r, t.g ), t.b );\n\n\t\t\tvec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;\n\t\t\tt = abs( C - Ctoptop );\n\t\t\tdelta.w = max( max( t.r, t.g ), t.b );\n\n\t\t\t// Calculate the final maximum delta:\n\t\t\tmaxDelta = max( max( maxDelta, delta.z ), delta.w );\n\n\t\t\t// Local contrast adaptation in action:\n\t\t\tedges.xy *= step( 0.5 * maxDelta, delta.xy );\n\n\t\t\treturn vec4( edges, 0.0, 0.0 );\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );\n\n\t\t}"},Bw={defines:{SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},uniforms:{tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new ue(1/1024,1/512)}},vertexShader:"\n\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 3 ];\n\t\tvarying vec2 vPixcoord;\n\n\t\tvoid SMAABlendingWeightCalculationVS( vec2 texcoord ) {\n\t\t\tvPixcoord = texcoord / resolution;\n\n\t\t\t// We will use these offsets for the searches later on (see @PSEUDO_GATHER4):\n\t\t\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 ); // WebGL port note: Changed sign in Y and W components\n\t\t\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 ); // WebGL port note: Changed sign in Y and W components\n\n\t\t\t// And these for the searches, they indicate the ends of the loops:\n\t\t\tvOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tSMAABlendingWeightCalculationVS( vUv );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\t#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tArea;\n\t\tuniform sampler2D tSearch;\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[3];\n\t\tvarying vec2 vPixcoord;\n\n\t\t#if __VERSION__ == 100\n\t\tvec2 round( vec2 x ) {\n\t\t\treturn sign( x ) * floor( abs( x ) + 0.5 );\n\t\t}\n\t\t#endif\n\n\t\tfloat SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {\n\t\t\t// Not required if searchTex accesses are set to point:\n\t\t\t// float2 SEARCH_TEX_PIXEL_SIZE = 1.0 / float2(66.0, 33.0);\n\t\t\t// e = float2(bias, 0.0) + 0.5 * SEARCH_TEX_PIXEL_SIZE +\n\t\t\t//     e * float2(scale, 1.0) * float2(64.0, 32.0) * SEARCH_TEX_PIXEL_SIZE;\n\t\t\te.r = bias + e.r * scale;\n\t\t\treturn 255.0 * texture2D( searchTex, e, 0.0 ).r;\n\t\t}\n\n\t\tfloat SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\t\t\t/**\n\t\t\t\t* @PSEUDO_GATHER4\n\t\t\t\t* This texcoord has been offset by (-0.25, -0.125) in the vertex shader to\n\t\t\t\t* sample between edge, thus fetching four edges in a row.\n\t\t\t\t* Sampling with different offsets in each direction allows to disambiguate\n\t\t\t\t* which edges are active from the four fetched ones.\n\t\t\t\t*/\n\t\t\tvec2 e = vec2( 0.0, 1.0 );\n\n\t\t\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n\t\t\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\t\t\ttexcoord -= vec2( 2.0, 0.0 ) * resolution;\n\t\t\t\tif ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;\n\t\t\t}\n\n\t\t\t// We correct the previous (-0.25, -0.125) offset we applied:\n\t\t\ttexcoord.x += 0.25 * resolution.x;\n\n\t\t\t// The searches are bias by 1, so adjust the coords accordingly:\n\t\t\ttexcoord.x += resolution.x;\n\n\t\t\t// Disambiguate the length added by the last step:\n\t\t\ttexcoord.x += 2.0 * resolution.x; // Undo last step\n\t\t\ttexcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);\n\n\t\t\treturn texcoord.x;\n\t\t}\n\n\t\tfloat SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\t\t\tvec2 e = vec2( 0.0, 1.0 );\n\n\t\t\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n\t\t\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\t\t\ttexcoord += vec2( 2.0, 0.0 ) * resolution;\n\t\t\t\tif ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;\n\t\t\t}\n\n\t\t\ttexcoord.x -= 0.25 * resolution.x;\n\t\t\ttexcoord.x -= resolution.x;\n\t\t\ttexcoord.x -= 2.0 * resolution.x;\n\t\t\ttexcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );\n\n\t\t\treturn texcoord.x;\n\t\t}\n\n\t\tfloat SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\t\t\tvec2 e = vec2( 1.0, 0.0 );\n\n\t\t\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n\t\t\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\t\t\ttexcoord += vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign\n\t\t\t\tif ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;\n\t\t\t}\n\n\t\t\ttexcoord.y -= 0.25 * resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y -= resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y -= 2.0 * resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 ); // WebGL port note: Changed sign\n\n\t\t\treturn texcoord.y;\n\t\t}\n\n\t\tfloat SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\t\t\tvec2 e = vec2( 1.0, 0.0 );\n\n\t\t\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n\t\t\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\t\t\ttexcoord -= vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign\n\t\t\t\tif ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;\n\t\t\t}\n\n\t\t\ttexcoord.y += 0.25 * resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y += resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y += 2.0 * resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 ); // WebGL port note: Changed sign\n\n\t\t\treturn texcoord.y;\n\t\t}\n\n\t\tvec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {\n\t\t\t// Rounding prevents precision errors of bilinear filtering:\n\t\t\tvec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;\n\n\t\t\t// We do a scale and bias for mapping to texel space:\n\t\t\ttexcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );\n\n\t\t\t// Move to proper place, according to the subpixel offset:\n\t\t\ttexcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;\n\n\t\t\treturn texture2D( areaTex, texcoord, 0.0 ).rg;\n\t\t}\n\n\t\tvec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {\n\t\t\tvec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );\n\n\t\t\tvec2 e = texture2D( edgesTex, texcoord ).rg;\n\n\t\t\tif ( e.g > 0.0 ) { // Edge at north\n\t\t\t\tvec2 d;\n\n\t\t\t\t// Find the distance to the left:\n\t\t\t\tvec2 coords;\n\t\t\t\tcoords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );\n\t\t\t\tcoords.y = offset[ 1 ].y; // offset[1].y = texcoord.y - 0.25 * resolution.y (@CROSSING_OFFSET)\n\t\t\t\td.x = coords.x;\n\n\t\t\t\t// Now fetch the left crossing edges, two at a time using bilinear\n\t\t\t\t// filtering. Sampling at -0.25 (see @CROSSING_OFFSET) enables to\n\t\t\t\t// discern what value each edge has:\n\t\t\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).r;\n\n\t\t\t\t// Find the distance to the right:\n\t\t\t\tcoords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );\n\t\t\t\td.y = coords.x;\n\n\t\t\t\t// We want the distances to be in pixel units (doing this here allow to\n\t\t\t\t// better interleave arithmetic and memory accesses):\n\t\t\t\td = d / resolution.x - pixcoord.x;\n\n\t\t\t\t// SMAAArea below needs a sqrt, as the areas texture is compressed\n\t\t\t\t// quadratically:\n\t\t\t\tvec2 sqrt_d = sqrt( abs( d ) );\n\n\t\t\t\t// Fetch the right crossing edges:\n\t\t\t\tcoords.y -= 1.0 * resolution.y; // WebGL port note: Added\n\t\t\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;\n\n\t\t\t\t// Ok, we know how this pattern looks like, now it is time for getting\n\t\t\t\t// the actual area:\n\t\t\t\tweights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );\n\t\t\t}\n\n\t\t\tif ( e.r > 0.0 ) { // Edge at west\n\t\t\t\tvec2 d;\n\n\t\t\t\t// Find the distance to the top:\n\t\t\t\tvec2 coords;\n\n\t\t\t\tcoords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );\n\t\t\t\tcoords.x = offset[ 0 ].x; // offset[1].x = texcoord.x - 0.25 * resolution.x;\n\t\t\t\td.x = coords.y;\n\n\t\t\t\t// Fetch the top crossing edges:\n\t\t\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).g;\n\n\t\t\t\t// Find the distance to the bottom:\n\t\t\t\tcoords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );\n\t\t\t\td.y = coords.y;\n\n\t\t\t\t// We want the distances to be in pixel units:\n\t\t\t\td = d / resolution.y - pixcoord.y;\n\n\t\t\t\t// SMAAArea below needs a sqrt, as the areas texture is compressed\n\t\t\t\t// quadratically:\n\t\t\t\tvec2 sqrt_d = sqrt( abs( d ) );\n\n\t\t\t\t// Fetch the bottom crossing edges:\n\t\t\t\tcoords.y -= 1.0 * resolution.y; // WebGL port note: Added\n\t\t\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;\n\n\t\t\t\t// Get the area for this direction:\n\t\t\t\tweights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );\n\t\t\t}\n\n\t\t\treturn weights;\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );\n\n\t\t}"},$R={uniforms:{tDiffuse:{value:null},tColor:{value:null},resolution:{value:new ue(1/1024,1/512)}},vertexShader:"\n\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 2 ];\n\n\t\tvoid SMAANeighborhoodBlendingVS( vec2 texcoord ) {\n\t\t\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 ); // WebGL port note: Changed sign in W component\n\t\t\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tSMAANeighborhoodBlendingVS( vUv );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tColor;\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 2 ];\n\n\t\tvec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {\n\t\t\t// Fetch the blending weights for current pixel:\n\t\t\tvec4 a;\n\t\t\ta.xz = texture2D( blendTex, texcoord ).xz;\n\t\t\ta.y = texture2D( blendTex, offset[ 1 ].zw ).g;\n\t\t\ta.w = texture2D( blendTex, offset[ 1 ].xy ).a;\n\n\t\t\t// Is there any blending weight with a value greater than 0.0?\n\t\t\tif ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {\n\t\t\t\treturn texture2D( colorTex, texcoord, 0.0 );\n\t\t\t} else {\n\t\t\t\t// Up to 4 lines can be crossing a pixel (one through each edge). We\n\t\t\t\t// favor blending by choosing the line with the maximum weight for each\n\t\t\t\t// direction:\n\t\t\t\tvec2 offset;\n\t\t\t\toffset.x = a.a > a.b ? a.a : -a.b; // left vs. right\n\t\t\t\toffset.y = a.g > a.r ? -a.g : a.r; // top vs. bottom // WebGL port note: Changed signs\n\n\t\t\t\t// Then we go in the direction that has the maximum weight:\n\t\t\t\tif ( abs( offset.x ) > abs( offset.y )) { // horizontal vs. vertical\n\t\t\t\t\toffset.y = 0.0;\n\t\t\t\t} else {\n\t\t\t\t\toffset.x = 0.0;\n\t\t\t\t}\n\n\t\t\t\t// Fetch the opposite color and lerp by hand:\n\t\t\t\tvec4 C = texture2D( colorTex, texcoord, 0.0 );\n\t\t\t\ttexcoord += sign( offset ) * resolution;\n\t\t\t\tvec4 Cop = texture2D( colorTex, texcoord, 0.0 );\n\t\t\t\tfloat s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );\n\n\t\t\t\t// WebGL port note: Added gamma correction\n\t\t\t\tC.xyz = pow(C.xyz, vec3(2.2));\n\t\t\t\tCop.xyz = pow(Cop.xyz, vec3(2.2));\n\t\t\t\tvec4 mixed = mix(C, Cop, s);\n\t\t\t\tmixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));\n\n\t\t\t\treturn mixed;\n\t\t\t}\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );\n\n\t\t}"};class Qme extends vn{constructor(e,t){super(),this.edgesRT=new Gt(e,t,{depthBuffer:!1}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new Gt(e,t,{depthBuffer:!1}),this.weightsRT.texture.name="SMAAPass.weights";const n=this,r=new Image;r.src=this.getAreaTexture(),r.onload=function(){n.areaTexture.needsUpdate=!0},this.areaTexture=new qn,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=r,this.areaTexture.minFilter=Li,this.areaTexture.generateMipmaps=!1,this.areaTexture.flipY=!1;const s=new Image;s.src=this.getSearchTexture(),s.onload=function(){n.searchTexture.needsUpdate=!0},this.searchTexture=new qn,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=s,this.searchTexture.magFilter=$t,this.searchTexture.minFilter=$t,this.searchTexture.generateMipmaps=!1,this.searchTexture.flipY=!1,this.uniformsEdges=mi.clone(Fw.uniforms),this.uniformsEdges.resolution.value.set(1/e,1/t),this.materialEdges=new Rt({defines:Object.assign({},Fw.defines),uniforms:this.uniformsEdges,vertexShader:Fw.vertexShader,fragmentShader:Fw.fragmentShader}),this.uniformsWeights=mi.clone(Bw.uniforms),this.uniformsWeights.resolution.value.set(1/e,1/t),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new Rt({defines:Object.assign({},Bw.defines),uniforms:this.uniformsWeights,vertexShader:Bw.vertexShader,fragmentShader:Bw.fragmentShader}),this.uniformsBlend=mi.clone($R.uniforms),this.uniformsBlend.resolution.value.set(1/e,1/t),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new Rt({uniforms:this.uniformsBlend,vertexShader:$R.vertexShader,fragmentShader:$R.fragmentShader}),this.needsSwap=!1,this.fsQuad=new wr(null)}render(e,t,n){this.uniformsEdges.tDiffuse.value=n.texture,this.fsQuad.material=this.materialEdges,e.setRenderTarget(this.edgesRT),this.clear&&e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialWeights,e.setRenderTarget(this.weightsRT),this.clear&&e.clear(),this.fsQuad.render(e),this.uniformsBlend.tColor.value=n.texture,this.fsQuad.material=this.materialBlend,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}setSize(e,t){this.edgesRT.setSize(e,t),this.weightsRT.setSize(e,t),this.materialEdges.uniforms.resolution.value.set(1/e,1/t),this.materialWeights.uniforms.resolution.value.set(1/e,1/t),this.materialBlend.uniforms.resolution.value.set(1/e,1/t)}getAreaTexture(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAIAAACOVPcQAACBeklEQVR42u39W4xlWXrnh/3WWvuciIzMrKxrV8/0rWbY0+SQFKcb4owIkSIFCjY9AC1BT/LYBozRi+EX+cV+8IMsYAaCwRcBwjzMiw2jAWtgwC8WR5Q8mDFHZLNHTarZGrLJJllt1W2qKrsumZWZcTvn7L3W54e1vrXX3vuciLPPORFR1XE2EomorB0nVuz//r71re/y/1eMvb4Cb3N11xV/PP/2v4UBAwJG/7H8urx6/25/Gf8O5hypMQ0EEEQwAqLfoN/Z+97f/SW+/NvcgQk4sGBJK6H7N4PFVL+K+e0N11yNfkKvwUdwdlUAXPHHL38oa15f/i/46Ih6SuMSPmLAYAwyRKn7dfMGH97jaMFBYCJUgotIC2YAdu+LyW9vvubxAP8kAL8H/koAuOKP3+q6+xGnd5kdYCeECnGIJViwGJMAkQKfDvB3WZxjLKGh8VSCCzhwEWBpMc5/kBbjawT4HnwJfhr+pPBIu7uu+OOTo9vsmtQcniMBGkKFd4jDWMSCRUpLjJYNJkM+IRzQ+PQvIeAMTrBS2LEiaiR9b/5PuT6Ap/AcfAFO4Y3dA3DFH7/VS+M8k4baEAQfMI4QfbVDDGIRg7GKaIY52qAjTAgTvGBAPGIIghOCYAUrGFNgzA7Q3QhgCwfwAnwe5vDejgG44o/fbm1C5ZlYQvQDARPAIQGxCWBM+wWl37ZQESb4gImexGMDouhGLx1Cst0Saa4b4AqO4Hk4gxo+3DHAV/nx27p3JziPM2pVgoiia5MdEzCGULprIN7gEEeQ5IQxEBBBQnxhsDb5auGmAAYcHMA9eAAz8PBol8/xij9+C4Djlim4gJjWcwZBhCBgMIIYxGAVIkH3ZtcBuLdtRFMWsPGoY9rN+HoBji9VBYdwD2ZQg4cnO7OSq/z4rU5KKdwVbFAjNojCQzTlCLPFSxtamwh2jMUcEgg2Wm/6XgErIBhBckQtGN3CzbVacERgCnfgLswhnvqf7QyAq/z4rRZm1YglYE3affGITaZsdIe2FmMIpnOCap25I6jt2kCwCW0D1uAD9sZctNGXcQIHCkINDQgc78aCr+zjtw3BU/ijdpw3zhCwcaONwBvdeS2YZKkJNJsMPf2JKEvC28RXxxI0ASJyzQCjCEQrO4Q7sFArEzjZhaFc4cdv+/JFdKULM4px0DfUBI2hIsy06BqLhGTQEVdbfAIZXYMPesq6VoCHICzUyjwInO4Y411//LYLs6TDa9wvg2CC2rElgAnpTBziThxaL22MYhzfkghz6GAs2VHbbdM91VZu1MEEpupMMwKyVTb5ij9+u4VJG/5EgEMMmFF01cFai3isRbKbzb+YaU/MQbAm2XSMoUPAmvZzbuKYRIFApbtlrfFuUGd6vq2hXNnH78ZLh/iFhsQG3T4D1ib7k5CC6vY0DCbtrohgLEIClXiGtl10zc0CnEGIhhatLBva7NP58Tvw0qE8yWhARLQ8h4+AhQSP+I4F5xoU+VilGRJs6wnS7ruti/4KvAY/CfdgqjsMy4pf8fodQO8/gnuX3f/3xi3om1/h7THr+co3x93PP9+FBUfbNUjcjEmhcrkT+8K7ml7V10Jo05mpIEFy1NmCJWx9SIKKt+EjAL4Ez8EBVOB6havuT/rByPvHXK+9zUcfcbb254+9fydJknYnRr1oGfdaiAgpxu1Rx/Rek8KISftx3L+DfsLWAANn8Hvw0/AFeAGO9DFV3c6D+CcWbL8Dj9e7f+T1k8AZv/d7+PXWM/Z+VvdCrIvuAKO09RpEEQJM0Ci6+B4xhTWr4cZNOvhktabw0ta0rSJmqz3Yw5/AKXwenod7cAhTmBSPKf6JBdvH8IP17h95pXqw50/+BFnj88fev4NchyaK47OPhhtI8RFSvAfDSNh0Ck0p2gLxGkib5NJj/JWCr90EWQJvwBzO4AHcgztwAFN1evHPUVGwfXON+0debT1YeGON9Yy9/63X+OguiwmhIhQhD7l4sMqlG3D86Suc3qWZ4rWjI1X7u0Ytw6x3rIMeIOPDprfe2XzNgyj6PahhBjO4C3e6puDgXrdg+/5l948vF3bqwZetZ+z9Rx9zdIY5pInPK4Nk0t+l52xdK2B45Qd87nM8fsD5EfUhIcJcERw4RdqqH7Yde5V7m1vhNmtedkz6EDzUMF/2jJYWbC+4fzzA/Y+/8PPH3j9dcBAPIRP8JLXd5BpAu03aziOL3VVHZzz3CXWDPWd+SH2AnxIqQoTZpo9Ckc6HIrFbAbzNmlcg8Ag8NFDDAhbJvTBZXbC94P7t68EXfv6o+21gUtPETU7bbkLxvNKRFG2+KXzvtObonPP4rBvsgmaKj404DlshFole1Glfh02fE7bYR7dZ82oTewIBGn1Md6CG6YUF26X376oevOLzx95vhUmgblI6LBZwTCDY7vMq0op5WVXgsObOXJ+1x3qaBl9j1FeLxbhU9w1F+Wiba6s1X/TBz1LnUfuYDi4r2C69f1f14BWfP+p+W2GFKuC9phcELMYRRLur9DEZTUdEH+iEqWdaM7X4WOoPGI+ZYD2+wcQ+y+ioHUZ9dTDbArzxmi/bJI9BND0Ynd6lBdve/butBw8+f/T9D3ABa3AG8W3VPX4hBin+bj8dMMmSpp5pg7fJ6xrBFE2WQQEWnV8Qg3FbAWzYfM1rREEnmvkN2o1+acG2d/9u68GDzx91v3mAjb1zkpqT21OipPKO0b9TO5W0nTdOmAQm0TObts3aBKgwARtoPDiCT0gHgwnbArzxmtcLc08HgF1asN0C4Ms/fvD5I+7PhfqyXE/b7RbbrGyRQRT9ARZcwAUmgdoz0ehJ9Fn7QAhUjhDAQSw0bV3T3WbNa59jzmiP6GsWbGXDX2ytjy8+f9T97fiBPq9YeLdBmyuizZHaqXITnXiMUEEVcJ7K4j3BFPurtB4bixW8wTpweL8DC95szWMOqucFYGsWbGU7p3TxxxefP+r+oTVktxY0v5hbq3KiOKYnY8ddJVSBxuMMVffNbxwIOERShst73HZ78DZrHpmJmH3K6sGz0fe3UUj0eyRrSCGTTc+rjVNoGzNSv05srAxUBh8IhqChiQgVNIIBH3AVPnrsnXQZbLTm8ammv8eVXn/vWpaTem5IXRlt+U/LA21zhSb9cye6jcOfCnOwhIAYXAMVTUNV0QhVha9xjgA27ODJbLbmitt3tRN80lqG6N/khgot4ZVlOyO4WNg3OIMzhIZQpUEHieg2im6F91hB3I2tubql6BYNN9Hj5S7G0G2tahslBWKDnOiIvuAEDzakDQKDNFQT6gbn8E2y4BBubM230YIpBnDbMa+y3dx0n1S0BtuG62lCCXwcY0F72T1VRR3t2ONcsmDjbmzNt9RFs2LO2hQNyb022JisaI8rAWuw4HI3FuAIhZdOGIcdjLJvvObqlpqvWTJnnQbyi/1M9O8UxWhBs//H42I0q1Yb/XPGONzcmm+ri172mHKvZBpHkJaNJz6v9jxqiklDj3U4CA2ugpAaYMWqNXsdXbmJNd9egCnJEsphXNM+MnK3m0FCJ5S1kmJpa3DgPVbnQnPGWIDspW9ozbcO4K/9LkfaQO2KHuqlfFXSbdNzcEcwoqNEFE9zcIXu9/6n/ym/BC/C3aJLzEKPuYVlbFnfhZ8kcWxV3dbv4bKl28566wD+8C53aw49lTABp9PWbsB+knfc/Li3eVizf5vv/xmvnPKg5ihwKEwlrcHqucuVcVOxEv8aH37E3ZqpZypUulrHEtIWKUr+txHg+ojZDGlwnqmkGlzcVi1dLiNSJiHjfbRNOPwKpx9TVdTn3K05DBx4psIk4Ei8aCkJahRgffk4YnEXe07T4H2RR1u27E6wfQsBDofUgjFUFnwC2AiVtA+05J2zpiDK2Oa0c5fmAecN1iJzmpqFZxqYBCYhFTCsUNEmUnIcZ6aEA5rQVhEywG6w7HSW02XfOoBlQmjwulOFQAg66SvJblrTEX1YtJ3uG15T/BH1OfOQeuR8g/c0gdpT5fx2SKbs9EfHTKdM8A1GaJRHLVIwhcGyydZsbifAFVKl5EMKNU2Hryo+06BeTgqnxzYjThVySDikbtJPieco75lYfKAJOMEZBTjoITuWHXXZVhcUDIS2hpiXHV9Ku4u44bN5OYLDOkJo8w+xJSMbhBRHEdEs9JZUCkQrPMAvaHyLkxgkEHxiNkx/x2YB0mGsQ8EUWj/stW5YLhtS5SMu+/YBbNPDCkGTUybN8krRLBGPlZkVOA0j+a1+rkyQKWGaPHPLZOkJhioQYnVZ2hS3zVxMtgC46KuRwbJNd9nV2PHgb36F194ecf/Yeu2vAFe5nm/bRBFrnY4BauE8ERmZRFUn0k8hbftiVYSKMEme2dJCJSCGYAlNqh87bXOPdUkGy24P6d1ll21MBqqx48Fvv8ZHH8HZFY7j/uAq1xMJUFqCSUlJPmNbIiNsmwuMs/q9CMtsZsFO6SprzCS1Z7QL8xCQClEelpjTduDMsmWD8S1PT152BtvmIGvUeDA/yRn83u/x0/4qxoPHjx+PXY9pqX9bgMvh/Nz9kpP4pOe1/fYf3axUiMdHLlPpZCNjgtNFAhcHEDxTumNONhHrBduW+vOyY++70WWnPXj98eA4kOt/mj/5E05l9+O4o8ePx67HFqyC+qSSnyselqjZGaVK2TadbFLPWAQ4NBhHqDCCV7OTpo34AlSSylPtIdd2AJZlyzYQrDJ5lcWGNceD80CunPLGGzsfD+7wRb95NevJI5docQ3tgCyr5bGnyaPRlmwNsFELViOOx9loebGNq2moDOKpHLVP5al2cymWHbkfzGXL7kfRl44H9wZy33tvt+PB/Xnf93e+nh5ZlU18wCiRUa9m7kib9LYuOk+hudQNbxwm0AQqbfloimaB2lM5fChex+ylMwuTbfmXQtmWlenZljbdXTLuOxjI/fDDHY4Hjx8/Hrse0zXfPFxbUN1kKqSCCSk50m0Ajtx3ub9XHBKHXESb8iO6E+qGytF4nO0OG3SXzbJlhxBnKtKyl0NwybjvYCD30aMdjgePHz8eu56SVTBbgxJMliQ3Oauwg0QHxXE2Ez/EIReLdQj42Gzb4CLS0YJD9xUx7bsi0vJi5mUbW1QzL0h0PFk17rtiIPfJk52MB48fPx67npJJwyrBa2RCCQRTbGZSPCxTPOiND4G2pYyOQ4h4jINIJh5wFU1NFZt+IsZ59LSnDqBjZ2awbOku+yInunLcd8VA7rNnOxkPHj9+PGY9B0MWJJNozOJmlglvDMXDEozdhQWbgs/U6oBanGzLrdSNNnZFjOkmbi5bNt1lX7JLLhn3vXAg9/h4y/Hg8ePHI9dzQMEkWCgdRfYykYKnkP7D4rIujsujaKPBsB54vE2TS00ccvFY/Tth7JXeq1hz+qgVy04sAJawTsvOknHfCwdyT062HA8eP348Zj0vdoXF4pilKa2BROed+9fyw9rWRXeTFXESMOanvDZfJuJaSXouQdMdDJZtekZcLLvEeK04d8m474UDuaenW44Hjx8/Xns9YYqZpszGWB3AN/4VHw+k7WSFtJ3Qicuqb/NlVmgXWsxh570xg2UwxUw3WfO6B5nOuO8aA7lnZxuPB48fPx6znm1i4bsfcbaptF3zNT78eFPtwi1OaCNOqp1x3zUGcs/PN++AGD1+fMXrSVm2baTtPhPahbPhA71wIHd2bXzRa69nG+3CraTtPivahV/55tXWg8fyRY/9AdsY8VbSdp8V7cKrrgdfM//z6ILQFtJ2nxHtwmuoB4/kf74+gLeRtvvMaBdeSz34+vifx0YG20jbfTa0C6+tHrwe//NmOG0L8EbSdp8R7cLrrQe/996O+ai3ujQOskpTNULa7jOjXXj99eCd8lHvoFiwsbTdZ0a78PrrwTvlo966pLuRtB2fFe3Cm6oHP9kNH/W2FryxtN1nTLvwRurBO+Kj3pWXHidtx2dFu/Bm68Fb81HvykuPlrb7LGkX3mw9eGs+6h1Y8MbSdjegXcguQLjmevDpTQLMxtJ2N6NdyBZu9AbrwVvwUW+LbteULUpCdqm0HTelXbhNPe8G68Gb8lFvVfYfSNuxvrTdTWoXbozAzdaDZzfkorOj1oxVxlIMlpSIlpLrt8D4hrQL17z+c3h6hU/wv4Q/utps4+bm+6P/hIcf0JwQ5oQGPBL0eKPTYEXTW+eL/2DKn73J9BTXYANG57hz1cEMviVf/4tf5b/6C5pTQkMIWoAq7hTpOJjtAM4pxKu5vg5vXeUrtI09/Mo/5H+4z+Mp5xULh7cEm2QbRP2tFIKR7WM3fPf/jZ3SWCqLM2l4NxID5zB72HQXv3jj/8mLR5xXNA5v8EbFQEz7PpRfl1+MB/hlAN65qgDn3wTgH13hK7T59bmP+NIx1SHHU84nLOITt3iVz8mNO+lPrjGAnBFqmioNn1mTyk1ta47R6d4MrX7tjrnjYUpdUbv2rVr6YpVfsGG58AG8Ah9eyUN8CX4WfgV+G8LVWPDGb+Zd4cU584CtqSbMKxauxTg+dyn/LkVgA+IR8KHtejeFKRtTmLLpxN6mYVLjYxwXf5x2VofiZcp/lwKk4wGOpYDnoIZPdg/AAbwMfx0+ge9dgZvYjuqKe4HnGnykYo5TvJbG0Vj12JagRhwKa44H95ShkZa5RyLGGdfYvG7aw1TsF6iapPAS29mNS3NmsTQZCmgTzFwgL3upCTgtBTRwvGMAKrgLn4evwin8+afJRcff+8izUGUM63GOOuAs3tJkw7J4kyoNreqrpO6cYLQeFUd7TTpr5YOTLc9RUUogUOVJQ1GYJaFLAW0oTmKyYS46ZooP4S4EON3xQ5zC8/CX4CnM4c1PE8ApexpoYuzqlP3d4S3OJP8ZDK7cKWNaTlqmgDiiHwl1YsE41w1zT4iRTm3DBqxvOUsbMKKDa/EHxagtnta072ejc3DOIh5ojvh8l3tk1JF/AV6FU6jh3U8HwEazLgdCLYSQ+MYiAI2ltomkzttUb0gGHdSUUgsIYjTzLG3mObX4FBRaYtpDVNZrih9TgTeYOBxsEnN1gOCTM8Bsw/ieMc75w9kuAT6A+/AiHGvN/+Gn4KRkiuzpNNDYhDGFndWRpE6SVfm8U5bxnSgVV2jrg6JCKmneqey8VMFgq2+AM/i4L4RUbfSi27lNXZ7R7W9RTcq/q9fk4Xw3AMQd4I5ifAZz8FcVtm9SAom/dyN4lczJQW/kC42ZrHgcCoIf1oVMKkVItmMBi9cOeNHGLqOZk+QqQmrbc5YmYgxELUUN35z2iohstgfLIFmcMV7s4CFmI74L9+EFmGsi+tGnAOD4Yk9gIpo01Y4cA43BWGygMdr4YZekG3OBIUXXNukvJS8tqa06e+lSDCtnqqMFu6hWHXCF+WaYt64m9QBmNxi7Ioy7D+fa1yHw+FMAcPt7SysFLtoG4PXAk7JOA3aAxBRqUiAdU9Yp5lK3HLSRFtOim0sa8euEt08xvKjYjzeJ2GU7YawexrnKI9tmobInjFXCewpwriY9+RR4aaezFhMhGCppKwom0ChrgFlKzyPKkGlTW1YQrE9HJqu8hKGgMc6hVi5QRq0PZxNfrYNgE64utmRv6KKHRpxf6VDUaOvNP5jCEx5q185My/7RKz69UQu2im5k4/eownpxZxNLwiZ1AZTO2ZjWjkU9uaB2HFn6Q3u0JcsSx/qV9hTEApRzeBLDJQXxYmTnq7bdLa3+uqFrxLJ5w1TehnNHx5ECvCh2g2c3hHH5YsfdaSKddztfjQ6imKFGSyFwlLzxEGPp6r5IevVjk1AMx3wMqi1NxDVjLBiPs9tbsCkIY5we5/ML22zrCScFxnNtzsr9Wcc3CnD+pYO+4VXXiDE0oc/vQQ/fDK3oPESJMYXNmJa/DuloJZkcTpcYE8lIH8Dz8DJMiynNC86Mb2lNaaqP/+L7f2fcE/yP7/Lde8xfgSOdMxvOixZf/9p3+M4hT1+F+zApxg9XfUvYjc8qX2lfOOpK2gNRtB4flpFu9FTKCp2XJRgXnX6olp1zyYjTKJSkGmLE2NjUr1bxFM4AeAAHBUFIeSLqXR+NvH/M9fOnfHzOD2vCSyQJKzfgsCh+yi/Mmc35F2fUrw7miW33W9hBD1vpuUojFphIyvg7aTeoymDkIkeW3XLHmguMzbIAJejN6B5MDrhipE2y6SoFRO/AK/AcHHZHNIfiWrEe/C6cr3f/yOvrQKB+zMM55/GQdLDsR+ifr5Fiuu+/y+M78LzOE5dsNuXC3PYvYWd8NXvphLSkJIasrlD2/HOqQ+RjcRdjKTGWYhhVUm4yxlyiGPuMsZR7sMCHUBeTuNWA7if+ifXgc/hovftHXs/DV+Fvwe+f8shzMiMcweFgBly3//vwJfg5AN4450fn1Hd1Rm1aBLu22Dy3y3H2+OqMemkbGZ4jozcDjJf6596xOLpC0eMTHbKnxLxH27uZ/bMTGs2jOaMOY4m87CfQwF0dw53oa1k80JRuz/XgS+8fX3N9Af4qPIMfzKgCp4H5TDGe9GGeFPzSsZz80SlPTxXjgwJmC45njzgt2vbQ4b4OAdUK4/vWhO8d8v6EE8fMUsfakXbPpFJeLs2ubM/qdm/la3WP91uWhxXHjoWhyRUq2iJ/+5mA73zwIIo+LoZ/SgvIRjAd1IMvvn98PfgOvAJfhhm8scAKVWDuaRaK8aQ9f7vuPDH6Bj47ZXau7rqYJ66mTDwEDU6lLbCjCK0qTXyl5mnDoeNRxanj3FJbaksTk0faXxHxLrssgPkWB9LnA/MFleXcJozzjwsUvUG0X/QCve51qkMDXp9mtcyOy3rwBfdvVJK7D6/ACSzg3RoruIq5UDeESfEmVclDxnniU82vxMLtceD0hGZWzBNPMM/jSPne2OVatiTKUpY5vY7gc0LdUAWeWM5tH+O2I66AOWw9xT2BuyRVLGdoDHUsVRXOo/c+ZdRXvFfnxWyIV4upFLCl9eAL7h8Zv0QH8Ry8pA2cHzQpGesctVA37ZtklBTgHjyvdSeKY/RZw/kJMk0Y25cSNRWSigQtlULPTw+kzuJPeYEkXjQRpoGZobYsLF79pyd1dMRHInbgFTZqNLhDqiIsTNpoex2WLcy0/X6rHcdMMQvFSd5dWA++4P7xv89deACnmr36uGlL69bRCL6BSZsS6c0TU2TKK5gtWCzgAOOwQcurqk9j8whvziZSMLcq5hbuwBEsYjopUBkqw1yYBGpLA97SRElEmx5MCInBY5vgLk94iKqSWmhIGmkJ4Bi9m4L645J68LyY4wsFYBfUg5feP/6gWWm58IEmKQM89hq7KsZNaKtP5TxxrUZZVkNmMJtjbKrGxLNEbHPJxhqy7lAmbC32ZqeF6lTaknRWcYaFpfLUBh/rwaQycCCJmW15Kstv6jRHyJFry2C1ahkkIW0LO75s61+owxK1y3XqweX9m5YLM2DPFeOjn/iiqCKJ+yKXF8t5Yl/kNsqaSCryxPq5xWTFIaP8KSW0RYxqupaUf0RcTNSSdJZGcKYdYA6kdtrtmyBckfKXwqk0pHpUHlwWaffjNRBYFPUDWa8e3Lt/o0R0CdisKDM89cX0pvRHEfM8ca4t0s2Xx4kgo91MPQJ/0c9MQYq0co8MBh7bz1fio0UUHLR4aAIOvOmoYO6kwlEVODSSTliWtOtH6sPkrtctF9ZtJ9GIerBskvhdVS5cFNv9s1BU0AbdUgdK4FG+dRnjFmDTzniRMdZO1QhzMK355vigbdkpz9P6qjUGE5J2qAcXmwJ20cZUiAD0z+pGMx6xkzJkmEf40Hr4qZfVg2XzF9YOyoV5BjzVkUJngKf8lgNYwKECEHrCNDrWZzMlflS3yBhr/InyoUgBc/lKT4pxVrrC6g1YwcceK3BmNxZcAtz3j5EIpqguh9H6wc011YN75cKDLpFDxuwkrPQmUwW4KTbj9mZTwBwLq4aQMUZbHm1rylJ46dzR0dua2n3RYCWZsiHROeywyJGR7mXKlpryyCiouY56sFkBWEnkEB/raeh/Sw4162KeuAxMQpEkzy5alMY5wamMsWKKrtW2WpEWNnReZWONKWjrdsKZarpFjqCslq773PLmEhM448Pc3+FKr1+94vv/rfw4tEcu+lKTBe4kZSdijBrykwv9vbCMPcLQTygBjzVckSLPRVGslqdunwJ4oegtFOYb4SwxNgWLCmD7T9kVjTv5YDgpo0XBmN34Z/rEHp0sgyz7lngsrm4lvMm2Mr1zNOJYJ5cuxuQxwMGJq/TP5emlb8fsQBZviK4t8hFL+zbhtlpwaRSxQRWfeETjuauPsdGxsBVdO7nmP4xvzSoT29pRl7kGqz+k26B3Oy0YNV+SXbbQas1ctC/GarskRdFpKczVAF1ZXnLcpaMuzVe6lZ2g/1ndcvOVgRG3sdUAY1bKD6achijMPdMxV4muKVorSpiDHituH7rSTs7n/4y5DhRXo4FVBN4vO/zbAcxhENzGbHCzU/98Mcx5e7a31kWjw9FCe/zNeYyQjZsWb1uc7U33pN4Mji6hCLhivqfa9Ss6xLg031AgfesA/l99m9fgvnaF9JoE6bYKmkGNK3aPbHB96w3+DnxFm4hs0drLsk7U8kf/N/CvwQNtllna0rjq61sH8L80HAuvwH1tvBy2ChqWSCaYTaGN19sTvlfzFD6n+iKTbvtayfrfe9ueWh6GJFoxLdr7V72a5ZpvHcCPDzma0wTO4EgbLyedxstO81n57LYBOBzyfsOhUKsW1J1BB5vr/tz8RyqOFylQP9Tvst2JALsC5lsH8PyQ40DV4ANzYa4dedNiKNR1s+x2wwbR7q4/4cTxqEk4LWDebfisuo36JXLiWFjOtLrlNWh3K1rRS4xvHcDNlFnNmWBBAl5SWaL3oPOfnvbr5pdjVnEaeBJSYjuLEkyLLsWhKccadmOphZkOPgVdalj2QpSmfOsADhMWE2ZBu4+EEJI4wKTAuCoC4xwQbWXBltpxbjkXJtKxxabo9e7tyhlgb6gNlSbUpMh+l/FaqzVwewGu8BW1Zx7pTpQDJUjb8tsUTW6+GDXbMn3mLbXlXJiGdggxFAoUrtPS3wE4Nk02UZG2OOzlk7fRs7i95QCLo3E0jtrjnM7SR3uS1p4qtS2nJ5OwtQVHgOvArLBFijZUV9QtSl8dAY5d0E0hM0w3HS2DpIeB6m/A1+HfhJcGUq4sOxH+x3f5+VO+Ds9rYNI7zPXOYWPrtf8bYMx6fuOAX5jzNR0PdsuON+X1f7EERxMJJoU6GkTEWBvVolVlb5lh3tKCg6Wx1IbaMDdJ+9sUCc5KC46hKGCk3IVOS4TCqdBNfUs7Kd4iXf2RjnT/LLysJy3XDcHLh/vde3x8DoGvwgsa67vBk91G5Pe/HbOe7xwym0NXbtiuuDkGO2IJDh9oQvJ4cY4vdoqLDuoH9Zl2F/ofsekn8lkuhIlhQcffUtSjytFyp++p6NiE7Rqx/lodgKVoceEp/CP4FfjrquZaTtj2AvH5K/ywpn7M34K/SsoYDAdIN448I1/0/wveW289T1/lX5xBzc8N5IaHr0XMOQdHsIkDuJFifj20pBm5jzwUv9e2FhwRsvhAbalCIuIw3bhJihY3p6nTFFIZgiSYjfTf3aXuOjmeGn4bPoGvwl+CFzTRczBIuHBEeImHc37/lGfwZR0cXzVDOvaKfNHvwe+suZ771K/y/XcBlsoN996JpBhoE2toYxOznNEOS5TJc6Id5GEXLjrWo+LEWGNpPDU4WAwsIRROu+1vM+0oW37z/MBN9kqHnSArwPfgFJ7Cq/Ai3Ie7g7ncmI09v8sjzw9mzOAEXoIHxURueaAce5V80f/DOuuZwHM8vsMb5wBzOFWM7wymTXPAEvm4vcFpZ2ut0VZRjkiP2MlmLd6DIpbGSiHOjdnUHN90hRYmhTnmvhzp1iKDNj+b7t5hi79lWGwQ+HN9RsfFMy0FXbEwhfuczKgCbyxYwBmcFhhvo/7a44v+i3XWcwDP86PzpGQYdWh7csP5dBvZ1jNzdxC8pBGuxqSW5vw40nBpj5JhMwvOzN0RWqERHMr4Lv1kWX84xLR830G3j6yqZ1a8UstTlW+qJPOZ+sZ7xZPKTJLhiNOAFd6tk+jrTH31ncLOxid8+nzRb128HhUcru/y0Wn6iT254YPC6FtVSIMoW2sk727AhvTtrWKZTvgsmckfXYZWeNRXx/3YQ2OUxLDrbHtN11IwrgXT6c8dATDwLniYwxzO4RzuQqTKSC5gAofMZ1QBK3zQ4JWobFbcvJm87FK+6JXrKahLn54m3p+McXzzYtP8VF/QpJuh1OwieElEoI1pRxPS09FBrkq2tWCU59+HdhNtTIqKm8EBrw2RTOEDpG3IKo2Y7mFdLm3ZeVjYwVw11o/oznceMve4CgMfNym/utA/d/ILMR7gpXzRy9eDsgLcgbs8O2Va1L0zzIdwGGemTBuwROHeoMShkUc7P+ISY3KH5ZZeWqO8mFTxQYeXTNuzvvK5FGPdQfuu00DwYFY9dyhctEt+OJDdnucfpmyhzUJzfsJjr29l8S0bXBfwRS9ZT26tmMIdZucch5ZboMz3Nio3nIOsYHCGoDT4kUA9MiXEp9Xsui1S8th/kbWIrMBxDGLodWUQIWcvnXy+9M23xPiSMOiRPqM+YMXkUN3gXFrZJwXGzUaMpJfyRS9ZT0lPe8TpScuRlbMHeUmlaKDoNuy62iWNTWNFYjoxFzuJs8oR+RhRx7O4SVNSXpa0ZJQ0K1LAHDQ+D9IepkMXpcsq5EVCvClBUIzDhDoyKwDw1Lc59GbTeORivugw1IcuaEOaGWdNm+Ps5fQ7/tm0DjMegq3yM3vb5j12qUId5UZD2oxDSEWOZMSqFl/W+5oynWDa/aI04tJRQ2eTXusg86SQVu/nwSYwpW6wLjlqIzwLuxGIvoAvul0PS+ZNz0/akp/pniO/8JDnGyaCkzbhl6YcqmK/69prxPqtpx2+Km9al9sjL+rwMgHw4jE/C8/HQ3m1vBuL1fldbzd8mOueVJ92syqdEY4KJjSCde3mcRw2TA6szxedn+zwhZMps0XrqEsiUjnC1hw0TELC2Ek7uAAdzcheXv1BYLagspxpzSAoZZUsIzIq35MnFQ9DOrlNB30jq3L4pkhccKUAA8/ocvN1Rzx9QyOtERs4CVsJRK/DF71kPYrxYsGsm6RMh4cps5g1DOmM54Ly1ii0Hd3Y/BMk8VWFgBVmhqrkJCPBHAolwZaWzLR9Vb7bcWdX9NyUYE+uB2BKfuaeBUcjDljbYVY4DdtsVWvzRZdWnyUzDpjNl1Du3aloAjVJTNDpcIOVVhrHFF66lLfJL1zJr9PQ2nFJSBaKoDe+sAvLufZVHVzYh7W0h/c6AAZ+7Tvj6q9j68G/cTCS/3n1vLKHZwNi+P+pS0WkZNMBMUl+LDLuiE4omZy71r3UFMwNJV+VJ/GC5ixVUkBStsT4gGKh0Gm4Oy3qvq7Lbmq24nPdDuDR9deR11XzP4vFu3TYzfnIyiSVmgizUYGqkIXNdKTY9pgb9D2Ix5t0+NHkVzCdU03suWkkVZAoCONCn0T35gAeW38de43mf97sMOpSvj4aa1KYUm58USI7Wxxes03bAZdRzk6UtbzMaCQ6IxO0dy7X+XsjoD16hpsBeGz9dfzHj+R/Hp8nCxZRqkEDTaCKCSywjiaoMJ1TITE9eg7Jqnq8HL6gDwiZb0u0V0Rr/rmvqjxKuaLCX7ZWXTvAY+uvm3z8CP7nzVpngqrJpZKwWnCUjIviYVlirlGOzPLI3SMVyp/elvBUjjDkNhrtufFFErQ8pmdSlbK16toBHlt/HV8uHMX/vEGALkV3RJREiSlopxwdMXOZPLZ+ix+kAHpMKIk8UtE1ygtquttwxNhphrIZ1IBzjGF3IIGxGcBj6q8bHJBG8T9vdsoWrTFEuebEZuVxhhClH6P5Zo89OG9fwHNjtNQTpD0TG9PJLEYqvEY6Rlxy+ZZGfL0Aj62/bnQCXp//eeM4KzfQVJbgMQbUjlMFIm6TpcfWlZje7NBSV6IsEVmumWIbjiloUzQX9OzYdo8L1wjw2PrrpimONfmfNyzKklrgnEkSzT5QWYQW40YShyzqsRmMXbvVxKtGuYyMKaU1ugenLDm5Ily4iT14fP11Mx+xJv+zZ3MvnfdFqxU3a1W/FTB4m3Qfsyc1XUcdVhDeUDZXSFHHLQj/Y5jtC7ZqM0CXGwB4bP11i3LhOvzPGygYtiUBiwQV/4wFO0majijGsafHyRLu0yG6q35cL1rOpVxr2s5cM2jJYMCdc10Aj6q/blRpWJ//+dmm5psMl0KA2+AFRx9jMe2WbC4jQxnikd4DU8TwUjRVacgdlhmr3bpddzuJ9zXqr2xnxJfzP29RexdtjDVZqzkqa6PyvcojGrfkXiJ8SEtml/nYskicv0ivlxbqjemwUjMw5evdg8fUX9nOiC/lf94Q2i7MURk9nW1MSj5j8eAyV6y5CN2S6qbnw3vdA1Iwq+XOSCl663udN3IzLnrt+us25cI1+Z83SXQUldqQq0b5XOT17bGpLd6ssN1VMPf8c+jG8L3NeCnMdF+Ra3fRa9dft39/LuZ/3vwHoHrqGmQFafmiQw6eyzMxS05K4bL9uA+SKUQzCnSDkqOGokXyJvbgJ/BHI+qvY69//4rl20NsmK2ou2dTsyIALv/91/8n3P2Aao71WFGi8KKv1fRC5+J67Q/507/E/SOshqN5TsmYIjVt+kcjAx98iz/4SaojbIV1rexE7/C29HcYD/DX4a0rBOF5VTu7omsb11L/AWcVlcVZHSsqGuXLLp9ha8I//w3Mv+T4Ew7nTBsmgapoCrNFObIcN4pf/Ob/mrvHTGqqgAupL8qWjWPS9m/31jAe4DjA+4+uCoQoT/zOzlrNd3qd4SdphFxsUvYwGWbTWtISc3wNOWH+kHBMfc6kpmpwPgHWwqaSUG2ZWWheYOGQGaHB+eQ/kn6b3pOgLV+ODSn94wDvr8Bvb70/LLuiPPEr8OGVWfDmr45PZyccEmsVXZGe1pRNX9SU5+AVQkNTIVPCHF/jGmyDC9j4R9LfWcQvfiETmgMMUCMN1uNCakkweZsowdYobiMSlnKA93u7NzTXlSfe+SVbfnPQXmg9LpYAQxpwEtONyEyaueWM4FPjjyjG3uOaFmBTWDNgBXGEiQpsaWhnAqIijB07Dlsy3fUGeP989xbWkyf+FF2SNEtT1E0f4DYYVlxFlbaSMPIRMk/3iMU5pME2SIWJvjckciebkQuIRRyhUvkHg/iUljG5kzVog5hV7vIlCuBrmlhvgPfNHQM8lCf+FEGsYbMIBC0qC9a0uuy2wLXVbLBaP5kjHokCRxapkQyzI4QEcwgYHRZBp+XEFTqXFuNVzMtjXLJgX4gAid24Hjwc4N3dtVSe+NNiwTrzH4WVUOlDobUqr1FuAgYllc8pmzoVrELRHSIW8ViPxNy4xwjBpyR55I6J220qQTZYR4guvUICJiSpr9gFFle4RcF/OMB7BRiX8sSfhpNSO3lvEZCQfLUVTKT78Ek1LRLhWN+yLyTnp8qWUZ46b6vxdRGXfHVqx3eI75YaLa4iNNiK4NOW7wPW6lhbSOF9/M9qw8e/aoB3d156qTzxp8pXx5BKAsYSTOIIiPkp68GmTq7sZtvyzBQaRLNxIZ+paozHWoLFeExIhRBrWitHCAHrCF7/thhD8JhYz84wg93QRV88wLuLY8zF8sQ36qF1J455bOlgnELfshKVxYOXKVuKx0jaj22sczTQqPqtV/XDgpswmGTWWMSDw3ssyUunLLrVPGjYRsH5ggHeHSWiV8kT33ycFSfMgkoOK8apCye0J6VW6GOYvffgU9RWsukEi2kUV2nl4dOYUzRik9p7bcA4ggdJ53LxKcEe17B1R8eqAd7dOepV8sTXf5lhejoL85hUdhDdknPtKHFhljOT+bdq0hxbm35p2nc8+Ja1Iw+tJykgp0EWuAAZYwMVwac5KzYMslhvgHdHRrxKnvhTYcfKsxTxtTETkjHO7rr3zjoV25lAQHrqpV7bTiy2aXMmUhTBnKS91jhtR3GEoF0oLnWhWNnYgtcc4N0FxlcgT7yz3TgNIKkscx9jtV1ZKpWW+Ub1tc1eOv5ucdgpx+FJy9pgbLE7xDyXb/f+hLHVGeitHOi6A7ybo3sF8sS7w7cgdk0nJaOn3hLj3uyD0Zp5pazFIUXUpuTTU18d1EPkDoX8SkmWTnVIozEdbTcZjoqxhNHf1JrSS/AcvHjZ/SMHhL/7i5z+POsTUh/8BvNfYMTA8n+yU/MlTZxSJDRStqvEuLQKWwDctMTQogUDyQRoTQG5Kc6oQRE1yV1jCA7ri7jdZyK0sYTRjCR0Hnnd+y7nHxNgTULqw+8wj0mQKxpYvhjm9uSUxg+TTy7s2GtLUGcywhXSKZN275GsqlclX90J6bRI1aouxmgL7Q0Nen5ziM80SqMIo8cSOo+8XplT/5DHNWsSUr/6lLN/QQ3rDyzLruEW5enpf7KqZoShEduuSFOV7DLX7Ye+GmXb6/hnNNqKsVXuMDFpb9Y9eH3C6NGEzuOuI3gpMH/I6e+zDiH1fXi15t3vA1czsLws0TGEtmPEJdiiFPwlwKbgLHAFk4P6ZyPdymYYHGE0dutsChQBl2JcBFlrEkY/N5bQeXQ18gjunuMfMfsBlxJSx3niO485fwO4fGD5T/+3fPQqkneWVdwnw/3bMPkW9Wbqg+iC765Zk+xcT98ibKZc2EdgHcLoF8cSOo/Oc8fS+OyEULF4g4sJqXVcmfMfsc7A8v1/yfGXmL9I6Fn5pRwZhsPv0TxFNlAfZCvG+Oohi82UC5f/2IsJo0cTOm9YrDoKhFPEUr/LBYTUNht9zelHXDqwfPCIw4owp3mOcIQcLttWXFe3VZ/j5H3cIc0G6oPbCR+6Y2xF2EC5cGUm6wKC5tGEzhsWqw5hNidUiKX5gFWE1GXh4/Qplw4sVzOmx9QxU78g3EF6wnZlEN4FzJ1QPSLEZz1KfXC7vd8ssGdIbNUYpVx4UapyFUHzJoTOo1McSkeNn1M5MDQfs4qQuhhX5vQZFw8suwWTcyYTgioISk2YdmkhehG4PkE7w51inyAGGaU+uCXADabGzJR1fn3lwkty0asIo8cROm9Vy1g0yDxxtPvHDAmpu+PKnM8Ix1wwsGw91YJqhteaWgjYBmmQiebmSpwKKzE19hx7jkzSWOm66oPbzZ8Yj6kxVSpYjVAuvLzYMCRo3oTQecOOjjgi3NQ4l9K5/hOGhNTdcWVOTrlgYNkEXINbpCkBRyqhp+LdRB3g0OU6rMfW2HPCFFMV9nSp+uB2woepdbLBuJQyaw/ZFysXrlXwHxI0b0LovEkiOpXGA1Ijagf+KUNC6rKNa9bQnLFqYNkEnMc1uJrg2u64ELPBHpkgWbmwKpJoDhMwNbbGzAp7Yg31wS2T5rGtzit59PrKhesWG550CZpHEzpv2NGRaxlNjbMqpmEIzygJqQfjypycs2pg2cS2RY9r8HUqkqdEgKTWtWTKoRvOBPDYBltja2SO0RGjy9UHtxwRjA11ujbKF+ti5cIR9eCnxUg6owidtyoU5tK4NLji5Q3HCtiyF2IqLGYsHViOXTXOYxucDqG0HyttqYAKqYo3KTY1ekyDXRAm2AWh9JmsVh/ccg9WJ2E8YjG201sPq5ULxxX8n3XLXuMInbft2mk80rRGjCGctJ8/GFdmEQ9Ug4FlE1ll1Y7jtiraqm5Fe04VV8lvSVBL8hiPrfFVd8+7QH3Qbu2ipTVi8cvSGivc9cj8yvH11YMHdNSERtuOslM97feYFOPKzGcsI4zW0YGAbTAOaxCnxdfiYUmVWslxiIblCeAYr9VYR1gM7GmoPrilunSxxeT3DN/2eBQ9H11+nk1adn6VK71+5+Jfct4/el10/7KBZfNryUunWSCPxPECk1rdOv1WVSrQmpC+Tl46YD3ikQYcpunSQgzVB2VHFhxHVGKDgMEY5GLlQnP7FMDzw7IacAWnO6sBr12u+XanW2AO0wQ8pknnFhsL7KYIqhkEPmEXFkwaN5KQphbkUmG72wgw7WSm9RiL9QT925hkjiVIIhphFS9HKI6/8QAjlpXqg9W2C0apyaVDwKQwrwLY3j6ADR13ZyUNByQXHQu6RY09Hu6zMqXRaNZGS/KEJs0cJEe9VH1QdvBSJv9h09eiRmy0V2uJcqHcShcdvbSNg5fxkenkVprXM9rDVnX24/y9MVtncvbKY706anNl3ASll9a43UiacVquXGhvq4s2FP62NGKfQLIQYu9q1WmdMfmUrDGt8eDS0cXozH/fjmUH6Jruvm50hBDSaEU/2Ru2LEN/dl006TSc/g7tfJERxGMsgDUEr104pfWH9lQaN+M4KWQjwZbVc2rZVNHsyHal23wZtIs2JJqtIc/WLXXRFCpJkfE9jvWlfFbsNQ9pP5ZBS0zKh4R0aMFj1IjTcTnvi0Zz2rt7NdvQb2mgbju1plsH8MmbnEk7KbK0b+wC2iy3aX3szW8xeZvDwET6hWZYwqTXSSG+wMETKum0Dq/q+x62gt2ua2ppAo309TRk9TPazfV3qL9H8z7uhGqGqxNVg/FKx0HBl9OVUORn8Q8Jx9gFttGQUDr3tzcXX9xGgN0EpzN9mdZ3GATtPhL+CjxFDmkeEU6x56kqZRusLzALXVqkCN7zMEcqwjmywDQ6OhyUe0Xao1Qpyncrg6wKp9XfWDsaZplElvQ/b3sdweeghorwBDlHzgk1JmMc/wiERICVy2VJFdMjFuLQSp3S0W3+sngt2njwNgLssFGVQdJ0tu0KH4ky1LW4yrbkuaA6Iy9oz/qEMMXMMDWyIHhsAyFZc2peV9hc7kiKvfULxCl9iddfRK1f8kk9qvbdOoBtOg7ZkOZ5MsGrSHsokgLXUp9y88smniwWyuFSIRVmjplga3yD8Uij5QS1ZiM4U3Qw5QlSm2bXjFe6jzzBFtpg+/YBbLAWG7OPynNjlCw65fukGNdkJRf7yM1fOxVzbxOJVocFoYIaGwH22mIQkrvu1E2nGuebxIgW9U9TSiukPGU+Lt++c3DJPKhyhEEbXCQLUpae2exiKy6tMPe9mDRBFCEMTWrtwxN8qvuGnt6MoihKWS5NSyBhbH8StXoAz8PLOrRgLtOT/+4vcu+7vDLnqNvztOq7fmd8sMmY9Xzn1zj8Dq8+XVdu2Nv0IIySgEdQo3xVHps3Q5i3fLFsV4aiqzAiBhbgMDEd1uh8qZZ+lwhjkgokkOIv4xNJmyncdfUUzgB4oFMBtiu71Xumpz/P+cfUP+SlwFExwWW62r7b+LSPxqxn/gvMZ5z9C16t15UbNlq+jbGJtco7p8wbYlL4alSyfWdeuu0j7JA3JFNuVAwtst7F7FhWBbPFNKIUORndWtLraFLmMu7KFVDDOzqkeaiN33YAW/r76wR4XDN/yN1z7hejPau06EddkS/6XThfcz1fI/4K736fO48vlxt2PXJYFaeUkFS8U15XE3428xdtn2kc8GQlf1vkIaNRRnOMvLTWrZbElEHeLWi1o0dlKPAh1MVgbbVquPJ5+Cr8LU5/H/+I2QlHIU2ClXM9G8v7Rr7oc/hozfUUgsPnb3D+I+7WF8kNO92GY0SNvuxiE+2Bt8prVJTkzE64sfOstxuwfxUUoyk8VjcTlsqe2qITSFoSj6Epd4KsT6BZOWmtgE3hBfir8IzZDwgV4ZTZvD8VvPHERo8v+vL1DASHTz/i9OlKueHDjK5Rnx/JB1Vb1ioXdBra16dmt7dgik10yA/FwJSVY6XjA3oy4SqM2frqDPPSRMex9qs3XQtoWxMj7/Er8GWYsXgjaVz4OYumP2+9kbxvny/6kvWsEBw+fcb5bInc8APdhpOSs01tEqIkoiZjbAqKMruLbJYddHuHFRIyJcbdEdbl2sVLaySygunutBg96Y2/JjKRCdyHV+AEFtTvIpbKIXOamknYSiB6KV/0JetZITgcjjk5ZdaskBtWO86UF0ap6ozGXJk2WNiRUlCPFir66lzdm/SLSuK7EUdPz8f1z29Skq6F1fXg8+5UVR6bszncP4Tn4KUkkdJ8UFCY1zR1i8RmL/qQL3rlei4THG7OODlnKko4oI01kd3CaM08Ia18kC3GNoVaO9iDh+hWxSyTXFABXoau7Q6q9OxYg/OVEMw6jdbtSrJ9cBcewGmaZmg+bvkUnUUaGr+ZfnMH45Ivevl61hMcXsxYLFTu1hTm2zViCp7u0o5l+2PSUh9bDj6FgYypufBDhqK2+oXkiuHFHR3zfj+9PtA8oR0xnqX8qn+sx3bFODSbbF0X8EUvWQ8jBIcjo5bRmLOljDNtcqNtOe756h3l0VhKa9hDd2l1eqmsnh0MNMT/Cqnx6BInumhLT8luljzQ53RiJeA/0dxe5NK0o2fA1+GLXr6eNQWHNUOJssQaTRlGpLHKL9fD+IrQzTOMZS9fNQD4AnRNVxvTdjC+fJdcDDWQcyB00B0t9BDwTxXgaAfzDZ/DBXzRnfWMFRwuNqocOmX6OKNkY63h5n/fFcB28McVHqnXZVI27K0i4rDLNE9lDKV/rT+udVbD8dFFu2GGZ8mOt0kAXcoX3ZkIWVtw+MNf5NjR2FbivROHmhV1/pj2egv/fMGIOWTIWrV3Av8N9imV9IWml36H6cUjqEWNv9aNc+veb2sH46PRaHSuMBxvtW+twxctq0z+QsHhux8Q7rCY4Ct8lqsx7c6Sy0dl5T89rIeEuZKoVctIk1hNpfavER6yyH1Vvm3MbsUHy4ab4hWr/OZPcsRBphnaV65/ZcdYPNNwsjN/djlf9NqCw9U5ExCPcdhKxUgLSmfROpLp4WSUr8ojdwbncbvCf+a/YzRaEc6QOvXcGO256TXc5Lab9POvB+AWY7PigWYjzhifbovuunzRawsO24ZqQQAqguBtmpmPB7ysXJfyDDaV/aPGillgz1MdQg4u5MYaEtBNNHFjkRlSpd65lp4hd2AVPTfbV7FGpyIOfmNc/XVsPfg7vzaS/3nkvLL593ANLvMuRMGpQIhiF7kUEW9QDpAUbTWYBcbp4WpacHHY1aacqQyjGZS9HI3yCBT9kUZJhVOD+zUDvEH9ddR11fzPcTDQ5TlgB0KwqdXSavk9BC0pKp0WmcuowSw07VXmXC5guzSa4p0UvRw2lbDiYUx0ExJJRzWzi6Gm8cnEkfXXsdcG/M/jAJa0+bmCgdmQ9CYlNlSYZOKixmRsgiFxkrmW4l3KdFKv1DM8tk6WxPYJZhUUzcd8Kdtgrw/gkfXXDT7+avmfVak32qhtkg6NVdUS5wgkru1YzIkSduTW1FDwVWV3JQVJVuieTc0y4iDpFwc7/BvSalvKdQM8sv662cevz/+8sQVnjVAT0W2wLllw1JiMhJRxgDjCjLQsOzSFSgZqx7lAW1JW0e03yAD3asC+GD3NbQhbe+mN5GXH1F83KDOM4n/e5JIuH4NpdQARrFPBVptUNcjj4cVMcFSRTE2NpR1LEYbYMmfWpXgP9KejaPsLUhuvLCsVXznAG9dfx9SR1ud/3hZdCLHb1GMdPqRJgqDmm76mHbvOXDtiO2QPUcKo/TWkQ0i2JFXpBoo7vij1i1Lp3ADAo+qvG3V0rM//vFnnTE4hxd5Ka/Cor5YEdsLVJyKtDgVoHgtW11pWSjolPNMnrlrVj9Fv2Qn60twMwKPqr+N/wvr8z5tZcDsDrv06tkqyzESM85Ycv6XBWA2birlNCXrI6VbD2lx2L0vQO0QVTVVLH4SE67fgsfVXv8n7sz7/85Z7cMtbE6f088wSaR4kCkCm10s6pKbJhfqiUNGLq+0gLWC6eUAZFPnLjwqtKd8EwGvWX59t7iPW4X/eAN1svgRVSY990YZg06BD1ohLMtyFTI4pKTJsS9xREq9EOaPWiO2gpms7397x6nQJkbh+Fz2q/rqRROX6/M8bJrqlVW4l6JEptKeUFuMYUbtCQ7CIttpGc6MY93x1r1vgAnRXvY5cvwWPqb9uWQm+lP95QxdNMeWhOq1x0Db55C7GcUv2ZUuN6n8iKzsvOxibC//Yfs9Na8r2Rlz02vXXDT57FP/zJi66/EJSmsJKa8QxnoqW3VLQ+jZVUtJwJ8PNX1NQCwfNgdhhHD9on7PdRdrdGPF28rJr1F+3LBdeyv+8yYfLoMYet1vX4upNAjVvwOUWnlNXJXlkzk5Il6kqeoiL0C07qno+/CYBXq/+utlnsz7/Mzvy0tmI4zm4ag23PRN3t/CWryoUVJGm+5+K8RJ0V8Hc88/XHUX/HfiAq7t+BH+x6v8t438enWmdJwFA6ZINriLGKv/95f8lT9/FnyA1NMVEvQyaXuu+gz36f/DD73E4pwqpLcvm/o0Vle78n//+L/NPvoefp1pTJye6e4A/D082FERa5/opeH9zpvh13cNm19/4v/LDe5xMWTi8I0Ta0qKlK27AS/v3/r+/x/2GO9K2c7kVMonDpq7//jc5PKCxeNPpFVzaRr01wF8C4Pu76hXuX18H4LduTr79guuFD3n5BHfI+ZRFhY8w29TYhbbLi/bvBdqKE4fUgg1pBKnV3FEaCWOWyA+m3WpORZr/j+9TKJtW8yBTF2/ZEODI9/QavHkVdGFp/Pjn4Q+u5hXapsP5sOH+OXXA1LiKuqJxiMNbhTkbdJTCy4llEt6NnqRT4dhg1V3nbdrm6dYMecA1yTOL4PWTE9L5VzPFlLBCvlG58AhehnN4uHsAYinyJ+AZ/NkVvELbfOBUuOO5syBIEtiqHU1k9XeISX5bsimrkUUhnGDxourN8SgUsCZVtKyGbyGzHXdjOhsAvOAswSRyIBddRdEZWP6GZhNK/yjwew9ehBo+3jEADu7Ay2n8mDc+TS7awUHg0OMzR0LABhqLD4hJEh/BEGyBdGlSJoXYXtr+3HS4ijzVpgi0paWXtdruGTknXBz+11qT1Q2inxaTzQCO46P3lfLpyS4fou2PH/PupwZgCxNhGlj4IvUuWEsTkqMWm6i4xCSMc9N1RDQoCVcuGItJ/MRWefais+3synowi/dESgJjkilnWnBTGvRWmaw8oR15257t7CHmCf8HOn7cwI8+NQBXMBEmAa8PMRemrNCEhLGEhDQKcGZWS319BX9PFBEwGTbRBhLbDcaV3drFcDqk5kCTd2JF1Wp0HraqBx8U0wwBTnbpCadwBA/gTH/CDrcCs93LV8E0YlmmcyQRQnjBa8JESmGUfIjK/7fkaDJpmD2QptFNVJU1bbtIAjjWQizepOKptRjbzR9Kag6xZmMLLjHOtcLT3Tx9o/0EcTT1XN3E45u24AiwEypDJXihKjQxjLprEwcmRKclaDNZCVqr/V8mYWyFADbusiY5hvgFoU2vio49RgJLn5OsReRFN6tabeetiiy0V7KFHT3HyZLx491u95sn4K1QQSPKM9hNT0wMVvAWbzDSVdrKw4zRjZMyJIHkfq1VAVCDl/bUhNKlGq0zGr05+YAceXVPCttVk0oqjVwMPt+BBefx4yPtGVkUsqY3CHDPiCM5ngupUwCdbkpd8kbPrCWHhkmtIKLEetF2499eS1jZlIPGYnlcPXeM2KD9vLS0bW3ktYNqUllpKLn5ZrsxlIzxvDu5eHxzGLctkZLEY4PgSOg2IUVVcUONzUDBEpRaMoXNmUc0tFZrTZquiLyKxrSm3DvIW9Fil+AkhXu5PhEPx9mUNwqypDvZWdKlhIJQY7vn2OsnmBeOWnYZ0m1iwbbw1U60by5om47iHRV6fOgzjMf/DAZrlP40Z7syxpLK0lJ0gqaAK1c2KQKu7tabTXkLFz0sCftuwX++MyNeNn68k5Buq23YQhUh0SNTJa1ioQ0p4nUG2y0XilF1JqODqdImloPS4Bp111DEWT0jJjVv95uX9BBV7eB3bUWcu0acSVM23YZdd8R8UbQUxJ9wdu3oMuhdt929ME+mh6JXJ8di2RxbTi6TbrDquqV4aUKR2iwT6aZbyOwEXN3DUsWr8Hn4EhwNyHuXHh7/pdaUjtR7vnDh/d8c9xD/s5f501eQ1+CuDiCvGhk1AN/4Tf74RfxPwD3toLarR0zNtsnPzmS64KIRk861dMWCU8ArasG9T9H0ZBpsDGnjtAOM2+/LuIb2iIUGXNgl5ZmKD/Tw8TlaAuihaFP5yrw18v4x1898zIdP+DDAX1bM3GAMvPgRP/cJn3zCW013nrhHkrITyvYuwOUkcHuKlRSW5C6rzIdY4ppnF7J8aAJbQepgbJYBjCY9usGXDKQxq7RZfh9eg5d1UHMVATRaD/4BHK93/1iAgYZ/+jqPn8Dn4UExmWrpa3+ZOK6MvM3bjwfzxNWA2dhs8+51XHSPJiaAhGSpWevEs5xHLXcEGFXYiCONySH3fPWq93JIsBiSWvWyc3CAN+EcXoT7rCSANloPPoa31rt/5PUA/gp8Q/jDD3hyrjzlR8VkanfOvB1XPubt17vzxAfdSVbD1pzAnfgyF3ycadOTOTXhpEUoLC1HZyNGW3dtmjeXgr2r56JNmRwdNNWaQVBddd6rh4MhviEB9EFRD/7RGvePvCbwAL4Mx/D6M541hHO4D3e7g6PafdcZVw689z7NGTwo5om7A8sPhccT6qKcl9NJl9aM/9kX+e59Hh1yPqGuCCZxuITcsmNaJ5F7d0q6J3H48TO1/+M57085q2icdu2U+W36Ldllz9Agiv4YGljoEN908EzvDOrBF98/vtJwCC/BF2AG75xxEmjmMIcjxbjoaxqOK3/4hPOZzhMPBpYPG44CM0dTVm1LjLtUWWVz1Bcf8tEx0zs8O2A2YVHRxKYOiy/aOVoAaMu0i7ubu43njjmd4ibMHU1sIDHaQNKrZND/FZYdk54oCXetjq7E7IVl9eAL7t+oHnwXXtLx44czzoRFHBztYVwtH1d+NOMkupZ5MTM+gUmq90X+Bh9zjRlmaQ+m7YMqUL/veemcecAtOJ0yq1JnVlN27di2E0+Klp1tAJ4KRw1eMI7aJjsO3R8kPSI3fUFXnIOfdQe86sIIVtWDL7h//Ok6vj8vwDk08NEcI8zz7OhBy+WwalzZeZ4+0XniRfst9pAJqQHDGLzVQ2pheZnnv1OWhwO43/AgcvAEXEVVpa4db9sGvNK8wjaENHkfFQ4Ci5i7dqnQlPoLQrHXZDvO3BIXZbJOBrOaEbML6sFL798I4FhKihjHMsPjBUZYCMFr6nvaArxqXPn4lCa+cHfSa2cP27g3Z3ziYTRrcbQNGLQmGF3F3cBdzzzX7AILx0IB9rbwn9kx2G1FW3Inic+ZLIsVvKR8Zwfj0l1fkqo8LWY1M3IX14OX3r9RKTIO+d9XzAI8qRPGPn/4NC2n6o4rN8XJ82TOIvuVA8zLKUHRFgBCetlDZlqR1gLKjS39xoE7Bt8UvA6BxuEDjU3tFsEijgA+615tmZkXKqiEENrh41iLDDZNq4pKTWR3LZfnos81LOuNa15cD956vLMsJd1rqYp51gDUQqMYm2XsxnUhD2jg1DM7SeuJxxgrmpfISSXVIJIS5qJJSvJPEQ49DQTVIbYWJ9QWa/E2+c/oPK1drmC7WSfJRNKBO5Yjvcp7Gc3dmmI/Xh1kDTEuiSnWqQf37h+fTMhGnDf6dsS8SQfQWlqqwXXGlc/PEZ/SC5mtzIV0nAshlQdM/LvUtYutrEZ/Y+EAFtq1k28zQhOwLr1AIeANzhF8t9qzTdZf2qRKO6MWE9ohBYwibbOmrFtNmg3mcS+tB28xv2uKd/agYCvOP+GkSc+0lr7RXzyufL7QbkUpjLjEWFLqOIkAGu2B0tNlO9Eau2W1qcOUvVRgKzypKIQZ5KI3q0MLzqTNRYqiZOqmtqloIRlmkBHVpHmRYV6/HixbO6UC47KOFJnoMrVyr7wYz+SlW6GUaghYbY1I6kkxA2W1fSJokUdSh2LQ1GAimRGm0MT+uu57H5l7QgOWxERpO9moLRPgTtquWCfFlGlIjQaRly9odmzMOWY+IBO5tB4sW/0+VWGUh32qYk79EidWKrjWuiLpiVNGFWFRJVktyeXWmbgBBzVl8anPuXyNJlBJOlKLTgAbi/EYHVHxWiDaVR06GnHQNpJcWcK2jJtiCfG2sEHLzuI66sGrMK47nPIInPnu799935aOK2cvmvubrE38ZzZjrELCmXM2hM7UcpXD2oC3+ECVp7xtIuxptJ0jUr3sBmBS47TVxlvJ1Sqb/E0uLdvLj0lLr29ypdd/eMX3f6lrxGlKwKQxEGvw0qHbkbwrF3uHKwVENbIV2wZ13kNEF6zD+x24aLNMfDTCbDPnEikZFyTNttxWBXDaBuM8KtI2rmaMdUY7cXcUPstqTGvBGSrFWIpNMfbdea990bvAOC1YX0qbc6smDS1mPxSJoW4fwEXvjMmhlijDRq6qale6aJEuFGoppYDoBELQzLBuh/mZNx7jkinv0EtnUp50lO9hbNK57lZaMAWuWR5Yo9/kYwcYI0t4gWM47Umnl3YmpeBPqSyNp3K7s2DSAS/39KRuEN2bS4xvowV3dFRMx/VFcp2Yp8w2nTO9hCXtHG1kF1L4KlrJr2wKfyq77R7MKpFKzWlY9UkhYxyHWW6nBWPaudvEAl3CGcNpSXPZ6R9BbBtIl6cHL3gIBi+42CYXqCx1gfGWe7Ap0h3luyXdt1MKy4YUT9xSF01G16YEdWsouW9mgDHd3veyA97H+Ya47ZmEbqMY72oPztCGvK0onL44AvgC49saZKkWRz4veWljE1FHjbRJaWv6ZKKtl875h4CziFCZhG5rx7tefsl0aRT1bMHZjm8dwL/6u7wCRysaQblQoG5yAQN5zpatMNY/+yf8z+GLcH/Qn0iX2W2oEfXP4GvwQHuIL9AYGnaO3zqAX6946nkgqZNnUhx43DIdQtMFeOPrgy/y3Yd85HlJWwjLFkU3kFwq28xPnuPhMWeS+tDLV9Otllq7pQCf3uXJDN9wFDiUTgefHaiYbdfi3b3u8+iY6TnzhgehI1LTe8lcd7s1wJSzKbahCRxKKztTLXstGAiu3a6rPuQs5pk9TWAan5f0BZmGf7Ylxzzk/A7PAs4QPPPAHeFQ2hbFHszlgZuKZsJcUmbDC40sEU403cEjczstOEypa+YxevL4QBC8oRYqWdK6b7sK25tfE+oDZgtOQ2Jg8T41HGcBE6fTWHn4JtHcu9S7uYgU5KSCkl/mcnq+5/YBXOEr6lCUCwOTOM1taOI8mSxx1NsCXBEmLKbMAg5MkwbLmpBaFOPrNSlO2HnLiEqW3tHEwd8AeiQLmn+2gxjC3k6AxREqvKcJbTEzlpLiw4rNZK6oJdidbMMGX9FULKr0AkW+2qDEPBNNm5QAt2Ik2nftNWHetubosHLo2nG4vQA7GkcVCgVCgaDixHqo9UUn1A6OshapaNR/LPRYFV8siT1cCtJE0k/3WtaNSuUZYKPnsVIW0xXWnMUxq5+En4Kvw/MqQmVXnAXj9Z+9zM98zM/Agy7F/qqj2Nh67b8HjFnPP3iBn/tkpdzwEJX/whIcQUXOaikeliCRGUk7tiwF0rItwMEhjkZ309hikFoRAmLTpEXWuHS6y+am/KB/fM50aLEhGnSMwkpxzOov4H0AvgovwJ1iGzDLtJn/9BU+fAINfwUe6FHSLhu83viV/+/HrOePX+STT2B9uWGbrMHHLldRBlhS/CJQmcRxJFqZica01XixAZsYiH1uolZxLrR/SgxVIJjkpQP4PE9sE59LKLr7kltSBogS5tyszzH8Fvw8/AS8rNOg0xUS9fIaHwb+6et8Q/gyvKRjf5OusOzGx8evA/BP4IP11uN/grca5O0lcsPLJ5YjwI4QkJBOHa0WdMZYGxPbh2W2nR9v3WxEWqgp/G3+6VZbRLSAAZ3BhdhAaUL33VUSw9yjEsvbaQ9u4A/gGXwZXoEHOuU1GSj2chf+Mo+f8IcfcAxfIKVmyunRbYQVnoevwgfw3TXXcw++xNuP4fhyueEUNttEduRVaDttddoP0eSxLe2LENk6itYxlrxBNBYrNNKSQmeaLcm9c8UsaB5WyO6675yyQIAWSDpBVoA/gxmcwEvwoDv0m58UE7gHn+fJOa8/Ywan8EKRfjsopF83eCglX/Sfr7OeaRoQfvt1CGvIDccH5BCvw1sWIzRGC/66t0VTcLZQZtm6PlAasbOJ9iwWtUo7biktTSIPxnR24jxP1ZKaqq+2RcXM9OrBAm/AAs7hDJ5bNmGb+KIfwCs8a3jnjBrOFeMjHSCdbKr+2uOLfnOd9eiA8Hvvwwq54VbP2OqwkB48Ytc4YEOiH2vTXqodabfWEOzso4qxdbqD5L6tbtNPECqbhnA708DZH4QOJUXqScmUlks7Ot6FBuZw3n2mEbaUX7kDzxHOOQk8nKWMzAzu6ZZ8sOFw4RK+6PcuXo9tB4SbMz58ApfKDXf3szjNIIbGpD5TKTRxGkEMLjLl+K3wlWXBsCUxIDU+jbOiysESqAy1MGUJpXgwbTWzNOVEziIXZrJ+VIztl1PUBxTSo0dwn2bOmfDRPD3TRTGlfbCJvO9KvuhL1hMHhB9wPuPRLGHcdOWG2xc0U+5bQtAJT0nRTewXL1pgk2+rZAdeWmz3jxAqfNQQdzTlbF8uJ5ecEIWvTkevAHpwz7w78QujlD/Lr491bD8/1vhM2yrUQRrWXNQY4fGilfctMWYjL72UL/qS9eiA8EmN88nbNdour+PBbbAjOjIa4iBhfFg6rxeKdEGcL6p3EWR1Qq2Qkhs2DrnkRnmN9tG2EAqmgPw6hoL7Oza7B+3SCrR9tRftko+Lsf2F/mkTndN2LmzuMcKTuj/mX2+4Va3ki16+nnJY+S7MefpkidxwnV+4wkXH8TKnX0tsYzYp29DOOoSW1nf7nTh2akYiWmcJOuTidSaqESrTYpwjJJNVGQr+rLI7WsqerHW6Kp/oM2pKuV7T1QY9gjqlZp41/WfKpl56FV/0kvXQFRyeQ83xaTu5E8p5dNP3dUF34ihyI3GSpeCsywSh22ZJdWto9winhqifb7VRvgktxp13vyjrS0EjvrRfZ62uyqddSWaWYlwTPAtJZ2oZ3j/Sgi/mi+6vpzesfAcWNA0n8xVyw90GVFGuZjTXEQy+6GfLGLMLL523f5E0OmxVjDoOuRiH91RKU+vtoCtH7TgmvBLvtFXWLW15H9GTdVw8ow4IlRLeHECN9ym1e9K0I+Cbnhgv4Yu+aD2HaQJ80XDqOzSGAV4+4yCqBxrsJAX6ZTIoX36QnvzhhzzMfFW2dZVLOJfo0zbce5OvwXMFaZ81mOnlTVXpDZsQNuoYWveketKb5+6JOOsgX+NTm7H49fUTlx+WLuWL7qxnOFh4BxpmJx0p2gDzA/BUARuS6phR+pUsY7MMboAHx5xNsSVfVZcYSwqCKrqon7zM+8ecCkeS4nm3rINuaWvVNnMRI1IRpxTqx8PZUZ0Br/UEduo3B3hNvmgZfs9gQPj8vIOxd2kndir3awvJ6BLvoUuOfFWNYB0LR1OQJoUySKb9IlOBx74q1+ADC2G6rOdmFdJcD8BkfualA+BdjOOzP9uUhGUEX/TwhZsUduwRr8wNuXKurCixLBgpQI0mDbJr9dIqUuV+92ngkJZ7xduCk2yZKbfWrH1VBiTg9VdzsgRjW3CVXCvAwDd+c1z9dWw9+B+8MJL/eY15ZQ/HqvTwVdsZn5WQsgRRnMaWaecu3jFvMBEmgg+FJFZsnSl0zjB9OqPYaBD7qmoVyImFvzi41usesV0julaAR9dfR15Xzv9sEruRDyk1nb+QaLU67T885GTls6YgcY+UiMa25M/pwGrbCfzkvR3e0jjtuaFtnwuagHTSb5y7boBH119HXhvwP487jJLsLJ4XnUkHX5sLbS61dpiAXRoZSCrFJ+EjpeU3puVfitngYNo6PJrAigKktmwjyQdZpfq30mmtulaAx9Zfx15Xzv+cyeuiBFUs9zq8Kq+XB9a4PVvph3GV4E3y8HENJrN55H1X2p8VyqSKwVusJDKzXOZzplWdzBUFK9e+B4+uv468xvI/b5xtSAkBHQaPvtqWzllVvEOxPbuiE6+j2pvjcKsbvI7txnRErgfH7LdXqjq0IokKzga14GzQ23SSbCQvO6r+Or7SMIr/efOkkqSdMnj9mBx2DRsiY29Uj6+qK9ZrssCKaptR6HKURdwUYeUWA2kPzVKQO8ku2nU3Anhs/XWkBx3F/7wJtCTTTIKftthue1ty9xvNYLY/zo5KSbIuKbXpbEdSyeRyYdAIwKY2neyoc3+k1XUaufYga3T9daMUx/r8z1s10ITknIO0kuoMt+TB8jK0lpayqqjsJ2qtXAYwBU932zinimgmd6mTRDnQfr88q36NAI+tv24E8Pr8zxtasBqx0+xHH9HhlrwsxxNUfKOHQaZBITNf0uccj8GXiVmXAuPEAKSdN/4GLHhs/XWj92dN/uetNuBMnVR+XWDc25JLjo5Mg5IZIq226tmCsip2zZliL213YrTlL2hcFjpCduyim3M7/eB16q/blQsv5X/esDRbtJeabLIosWy3ycavwLhtxdWzbMmHiBTiVjJo6lCLjXZsi7p9PEPnsq6X6wd4bP11i0rD5fzPm/0A6brrIsllenZs0lCJlU4abakR59enZKrKe3BZihbTxlyZ2zl1+g0wvgmA166/bhwDrcn/7Ddz0eWZuJvfSESug6NzZsox3Z04FIxz0mUjMwVOOVTq1CQ0AhdbBGVdjG/CgsfUX7esJl3K/7ytWHRv683praW/8iDOCqWLLhpljDY1ZpzK75QiaZoOTpLKl60auHS/97oBXrv+umU9+FL+5+NtLFgjqVLCdbmj7pY5zPCPLOHNCwXGOcLquOhi8CmCWvbcuO73XmMUPab+ug3A6/A/78Bwe0bcS2+tgHn4J5pyS2WbOck0F51Vq3LcjhLvZ67p1ABbaL2H67bg78BfjKi/jr3+T/ABV3ilLmNXTI2SpvxWBtt6/Z//D0z/FXaGbSBgylzlsEGp+5//xrd4/ae4d8DUUjlslfIYS3t06HZpvfQtvv0N7AHWqtjP2pW08QD/FLy//da38vo8PNlKHf5y37Dxdfe/oj4kVIgFq3koLReSR76W/bx//n9k8jonZxzWTANVwEniDsg87sOSd/z7//PvMp3jQiptGVWFX2caezzAXwfgtzYUvbr0iozs32c3Uge7varH+CNE6cvEYmzbPZ9hMaYDdjK4V2iecf6EcEbdUDVUARda2KzO/JtCuDbNQB/iTeL0EG1JSO1jbXS+nLxtPMDPw1fh5+EPrgSEKE/8Gry5A73ui87AmxwdatyMEBCPNOCSKUeRZ2P6Myb5MRvgCHmA9ywsMifU+AYXcB6Xa5GibUC5TSyerxyh0j6QgLVpdyhfArRTTLqQjwe4HOD9s92D4Ap54odXAPBWLAwB02igG5Kkc+piN4lvODIFGAZgT+EO4Si1s7fjSR7vcQETUkRm9O+MXyo9OYhfe4xt9STQ2pcZRLayCV90b4D3jR0DYAfyxJ+eywg2IL7NTMXna7S/RpQ63JhWEM8U41ZyQGjwsVS0QBrEKLu8xwZsbi4wLcCT+OGidPIOCe1PiSc9Qt+go+vYqB7cG+B9d8cAD+WJPz0Am2gxXgU9IneOqDpAAXOsOltVuMzpdakJXrdPCzXiNVUpCeOos5cxnpQT39G+XVLhs1osQVvJKPZyNq8HDwd4d7pNDuWJPxVX7MSzqUDU6gfadKiNlUFTzLeFHHDlzO4kpa7aiKhBPGKwOqxsBAmYkOIpipyXcQSPlRTf+Tii0U3EJGaZsDER2qoB3h2hu0qe+NNwUooYU8y5mILbJe6OuX+2FTKy7bieTDAemaQyQ0CPthljSWO+xmFDIYiESjM5xKd6Ik5lvLq5GrQ3aCMLvmCA9wowLuWJb9xF59hVVP6O0CrBi3ZjZSNOvRy+I6klNVRJYRBaEzdN+imiUXQ8iVF8fsp+W4JXw7WISW7fDh7lptWkCwZ4d7QTXyBPfJMYK7SijjFppGnlIVJBJBYj7eUwtiP1IBXGI1XCsjNpbjENVpSAJ2hq2LTywEly3hUYazt31J8w2+aiLx3g3fohXixPfOMYm6zCGs9LVo9MoW3MCJE7R5u/WsOIjrqBoHUO0bJE9vxBpbhsd3+Nb4/vtPCZ4oZYCitNeYuC/8UDvDvy0qvkiW/cgqNqRyzqSZa/s0mqNGjtKOoTm14zZpUauiQgVfqtQiZjq7Q27JNaSK5ExRcrGCXO1FJYh6jR6CFqK7bZdQZ4t8g0rSlPfP1RdBtqaa9diqtzJkQ9duSryi2brQXbxDwbRUpFMBHjRj8+Nt7GDKgvph9okW7LX47gu0SpGnnFQ1S1lYldOsC7hYteR574ZuKs7Ei1lBsfdz7IZoxzzCVmmVqaSySzQbBVAWDek+N4jh9E/4VqZrJjPwiv9BC1XcvOWgO8275CVyBPvAtTVlDJfZkaZGU7NpqBogAj/xEHkeAuJihWYCxGN6e8+9JtSegFXF1TrhhLGP1fak3pebgPz192/8gB4d/6WT7+GdYnpH7hH/DJzzFiYPn/vjW0SgNpTNuPIZoAEZv8tlGw4+RLxy+ZjnKa5NdFoC7UaW0aduoYse6+bXg1DLg6UfRYwmhGEjqPvF75U558SANrElK/+MdpXvmqBpaXOa/MTZaa1DOcSiLaw9j0NNNst3c+63c7EKTpkvKHzu6bPbP0RkuHAVcbRY8ijP46MIbQeeT1mhA+5PV/inyDdQipf8LTvMXbwvoDy7IruDNVZKTfV4CTSRUYdybUCnGU7KUTDxLgCknqUm5aAW6/1p6eMsOYsphLzsHrE0Y/P5bQedx1F/4yPHnMB3/IOoTU9+BL8PhtjuFKBpZXnYNJxTuv+2XqolKR2UQgHhS5novuxVySJhBNRF3SoKK1XZbbXjVwWNyOjlqWJjrWJIy+P5bQedyldNScP+HZ61xKSK3jyrz+NiHG1hcOLL/+P+PDF2gOkekKGiNWKgJ+8Z/x8Iv4DdQHzcpZyF4v19I27w9/yPGDFQvmEpKtqv/TLiWMfn4sofMm9eAH8Ao0zzh7h4sJqYtxZd5/D7hkYPneDzl5idlzNHcIB0jVlQ+8ULzw/nc5/ojzl2juE0apD7LRnJxe04dMz2iOCFNtGFpTuXA5AhcTRo8mdN4kz30nVjEC4YTZQy4gpC7GlTlrePKhGsKKgeXpCYeO0MAd/GH7yKQUlXPLOasOH3FnSphjHuDvEu4gB8g66oNbtr6eMbFIA4fIBJkgayoXriw2XEDQPJrQeROAlY6aeYOcMf+IVYTU3XFlZufMHinGywaW3YLpObVBAsbjF4QJMsVUSayjk4voPsHJOQfPWDhCgDnmDl6XIRerD24HsGtw86RMHOLvVSHrKBdeVE26gKB5NKHzaIwLOmrqBWJYZDLhASG16c0Tn+CdRhWDgWXnqRZUTnPIHuMJTfLVpkoYy5CzylHVTGZMTwkGAo2HBlkQplrJX6U+uF1wZz2uwS1SQ12IqWaPuO4baZaEFBdukksJmkcTOm+YJSvoqPFzxFA/YUhIvWxcmSdPWTWwbAKVp6rxTtPFUZfKIwpzm4IoMfaYQLWgmlG5FME2gdBgm+J7J+rtS/XBbaVLsR7bpPQnpMFlo2doWaVceHk9+MkyguZNCJ1He+kuHTWyQAzNM5YSUg/GlTk9ZunAsg1qELVOhUSAK0LABIJHLKbqaEbHZLL1VA3VgqoiOKXYiS+HRyaEKgsfIqX64HYWbLRXy/qWoylIV9gudL1OWBNgBgTNmxA6b4txDT4gi3Ri7xFSLxtXpmmYnzAcWDZgY8d503LFogz5sbonDgkKcxGsWsE1OI+rcQtlgBBCSOKD1mtqYpIU8cTvBmAT0yZe+zUzeY92fYjTtGipXLhuR0ePoHk0ofNWBX+lo8Z7pAZDk8mEw5L7dVyZZoE/pTewbI6SNbiAL5xeygW4xPRuLCGbhcO4RIeTMFYHEJkYyEO9HmJfXMDEj/LaH781wHHZEtqSQ/69UnGpzH7LKIAZEDSPJnTesJTUa+rwTepI9dLJEawYV+ZkRn9g+QirD8vF8Mq0jFQ29js6kCS3E1+jZIhgPNanHdHFqFvPJLHqFwQqbIA4jhDxcNsOCCQLDomaL/dr5lyJaJU6FxPFjO3JOh3kVMcROo8u+C+jo05GjMF3P3/FuDLn5x2M04xXULPwaS6hBYki+MrMdZJSgPHlcB7nCR5bJ9Kr5ACUn9jk5kivdd8tk95SOGrtqu9lr2IhK65ZtEl7ZKrp7DrqwZfRUSN1el7+7NJxZbywOC8neNKTch5vsTEMNsoCCqHBCqIPRjIPkm0BjvFODGtto99rCl+d3wmHkW0FPdpZtC7MMcVtGFQjJLX5bdQ2+x9ypdc313uj8xlsrfuLgWXz1cRhZvJYX0iNVBRcVcmCXZs6aEf3RQF2WI/TcCbKmGU3IOoDJGDdDub0+hYckt6PlGu2BcxmhbTdj/klhccLGJMcqRjMJP1jW2ETqLSWJ/29MAoORluJ+6LPffBZbi5gqi5h6catQpmOT7/OFf5UorRpLzCqcMltBLhwd1are3kztrSzXO0LUbXRQcdLh/RdSZ+swRm819REDrtqzC4es6Gw4JCKlSnjYVpo0xeq33PrADbFLL3RuCmObVmPN+24kfa+AojDuM4umKe2QwCf6EN906HwjujaitDs5o0s1y+k3lgbT2W2i7FJdnwbLXhJUBq/9liTctSmFC/0OqUinb0QddTWamtjbHRFuWJJ6NpqZ8vO3fZJ37Db+2GkaPYLGHs7XTTdiFQJ68SkVJFVmY6McR5UycflNCsccHFaV9FNbR4NttLxw4pQ7wJd066Z0ohVbzihaxHVExd/ay04oxUKWt+AsdiQ9OUyZ2krzN19IZIwafSTFgIBnMV73ADj7V/K8u1MaY2sJp2HWm0f41tqwajEvdHWOJs510MaAqN4aoSiPCXtN2KSi46dUxHdaMquar82O1x5jqhDGvqmoE9LfxcY3zqA7/x3HA67r9ZG4O6Cuxu12/+TP+eLP+I+HErqDDCDVmBDO4larujNe7x8om2rMug0MX0rL1+IWwdwfR+p1TNTyNmVJ85ljWzbWuGv8/C7HD/izjkHNZNYlhZcUOKVzKFUxsxxN/kax+8zPWPSFKw80rJr9Tizyj3o1gEsdwgWGoxPezDdZ1TSENE1dLdNvuKL+I84nxKesZgxXVA1VA1OcL49dFlpFV5yJMhzyCmNQ+a4BqusPJ2bB+xo8V9u3x48VVIEPS/mc3DvAbXyoYr6VgDfh5do5hhHOCXMqBZUPhWYbWZECwVJljLgMUWOCB4MUuMaxGNUQDVI50TQ+S3kFgIcu2qKkNSHVoM0SHsgoZxP2d5HH8B9woOk4x5bPkKtAHucZsdykjxuIpbUrSILgrT8G7G5oCW+K0990o7E3T6AdW4TilH5kDjds+H64kS0mz24grtwlzDHBJqI8YJQExotPvoC4JBq0lEjjQkyBZ8oH2LnRsQ4Hu1QsgDTJbO8fQDnllitkxuVskoiKbRF9VwzMDvxHAdwB7mD9yCplhHFEyUWHx3WtwCbSMMTCUCcEmSGlg4gTXkHpZXWQ7kpznK3EmCHiXInqndkQjunG5kxTKEeGye7jWz9cyMR2mGiFQ15ENRBTbCp+Gh86vAyASdgmJq2MC6hoADQ3GosP0QHbnMHjyBQvQqfhy/BUbeHd5WY/G/9LK/8Ka8Jd7UFeNWEZvzPb458Dn8DGLOe3/wGL/4xP+HXlRt+M1PE2iLhR8t+lfgxsuh7AfO2AOf+owWhSZRYQbd622hbpKWKuU+XuvNzP0OseRDa+mObgDHJUSc/pKx31QdKffQ5OIJpt8GWjlgTwMc/w5MPCR/yl1XC2a2Yut54SvOtMev55Of45BOat9aWG27p2ZVORRvnEk1hqWMVUmqa7S2YtvlIpspuF1pt0syuZS2NV14mUidCSfzQzg+KqvIYCMljIx2YK2AO34fX4GWdu5xcIAb8MzTw+j/lyWM+Dw/gjs4GD6ehNgA48kX/AI7XXM/XAN4WHr+9ntywqoCakCqmKP0rmQrJJEErG2Upg1JObr01lKQy4jskWalKYfJ/EDLMpjNSHFEUAde2fltaDgmrNaWQ9+AAb8I5vKjz3L1n1LriB/BXkG/wwR9y/oRX4LlioHA4LzP2inzRx/DWmutRweFjeP3tNeSGlaE1Fde0OS11yOpmbIp2u/jF1n2RRZviJM0yBT3IZl2HWImKjQOxIyeU325b/qWyU9Moj1o07tS0G7qJDoGHg5m8yeCxMoEH8GU45tnrNM84D2l297DQ9t1YP7jki/7RmutRweEA77/HWXOh3HCxkRgldDQkAjNTMl2Iloc1qN5JfJeeTlyTRzxURTdn1Ixv2uKjs12AbdEWlBtmVdk2k7FFwj07PCZ9XAwW3dG+8xKzNFr4EnwBZpy9Qzhh3jDXebBpYcpuo4fQ44u+fD1dweEnHzI7v0xuuOALRUV8rXpFyfSTQYkhd7IHm07jpyhlkCmI0ALYqPTpUxXS+z4jgDj1Pflvmz5ecuItpIBxyTHpSTGWd9g1ApfD/bvwUhL4nT1EzqgX7cxfCcNmb3mPL/qi9SwTHJ49oj5ZLjccbTG3pRmlYi6JCG0mQrAt1+i2UXTZ2dv9IlQpN5naMYtviaXlTrFpoMsl3bOAFEa8sqPj2WCMrx3Yjx99qFwO59Aw/wgx+HlqNz8oZvA3exRDvuhL1jMQHPaOJ0+XyA3fp1OfM3qObEVdhxjvynxNMXQV4+GJyvOEFqeQBaIbbO7i63rpxCltdZShPFxkjM2FPVkn3TG+Rp9pO3l2RzFegGfxGDHIAh8SteR0C4HopXzRF61nheDw6TFN05Ebvq8M3VKKpGjjO6r7nhudTEGMtYM92HTDaR1FDMXJ1eThsbKfywyoWwrzRSXkc51flG3vIid62h29bIcFbTGhfV+faaB+ohj7dPN0C2e2lC96+XouFByen9AsunLDJZ9z7NExiUc0OuoYW6UZkIyx2YUR2z6/TiRjyKMx5GbbjLHvHuf7YmtKghf34LJfx63Yg8vrvN2zC7lY0x0tvKezo4HmGYDU+Gab6dFL+KI761lDcNifcjLrrr9LWZJctG1FfU1uwhoQE22ObjdfkSzY63CbU5hzs21WeTddH2BaL11Gi7lVdlxP1nkxqhnKhVY6knS3EPgVGg1JpN5cP/hivujOelhXcPj8HC/LyI6MkteVjlolBdMmF3a3DbsuAYhL44dxzthWSN065xxUd55Lmf0wRbOYOqH09/o9WbO2VtFdaMb4qBgtFJoT1SqoN8wPXMoXLb3p1PUEhxfnnLzGzBI0Ku7FxrKsNJj/8bn/H8fPIVOd3rfrklUB/DOeO+nkghgSPzrlPxluCMtOnDL4Yml6dK1r3vsgMxgtPOrMFUZbEUbTdIzii5beq72G4PD0DKnwjmBULUVFmy8t+k7fZ3pKc0Q4UC6jpVRqS9Umv8bxw35flZVOU1X7qkjnhZlsMbk24qQ6Hz7QcuL6sDC0iHHki96Uh2UdvmgZnjIvExy2TeJdMDZNSbdZyAHe/Yd1xsQhHiKzjh7GxQ4yqMPaywPkjMamvqrYpmO7Knad+ZQC5msCuAPWUoxrxVhrGv7a+KLXFhyONdTMrZ7ke23qiO40ZJUyzgYyX5XyL0mV7NiUzEs9mjtbMN0dERqwyAJpigad0B3/zRV7s4PIfXSu6YV/MK7+OrYe/JvfGMn/PHJe2fyUdtnFrKRNpXV0Y2559aWPt/G4BlvjTMtXlVIWCnNyA3YQBDmYIodFz41PvXPSa6rq9lWZawZ4dP115HXV/M/tnFkkrBOdzg6aP4pID+MZnTJ1SuuB6iZlyiox4HT2y3YBtkUKWooacBQUDTpjwaDt5poBHl1/HXltwP887lKKXxNUEyPqpGTyA699UqY/lt9yGdlUKra0fFWS+36iylVWrAyd7Uw0CZM0z7xKTOduznLIjG2Hx8cDPLb+OvK6Bv7n1DYci4CxUuRxrjBc0bb4vD3rN5Zz36ntLb83eVJIB8LiIzCmn6SMPjlX+yNlTjvIGjs+QzHPf60Aj62/jrzG8j9vYMFtm1VoRWCJdmw7z9N0t+c8cxZpPeK4aTRicS25QhrVtUp7U578chk4q04Wx4YoQSjFryUlpcQ1AbxZ/XVMknIU//OGl7Q6z9Zpxi0+3yFhSkjUDpnCIUhLWVX23KQ+L9vKvFKI0ZWFQgkDLvBoylrHNVmaw10zwCPrr5tlodfnf94EWnQ0lFRWy8pW9LbkLsyUVDc2NSTHGDtnD1uMtchjbCeb1mpxFP0YbcClhzdLu6lfO8Bj6q+bdT2sz/+8SZCV7VIxtt0DUn9L7r4cLYWDSXnseEpOGFuty0qbOVlS7NNzs5FOGJUqQpl2Q64/yBpZf90sxbE+//PGdZ02HSipCbmD6NItmQ4Lk5XUrGpDMkhbMm2ZVheNYV+VbUWTcv99+2NyX1VoafSuC+AN6q9bFIMv5X/eagNWXZxEa9JjlMwNWb00akGUkSoepp1/yRuuqHGbUn3UdBSTxBU6SEVklzWRUkPndVvw2PrrpjvxOvzPmwHc0hpmq82npi7GRro8dXp0KXnUQmhZbRL7NEVp1uuZmO45vuzKsHrktS3GLWXODVjw+vXXLYx4Hf7njRPd0i3aoAGX6W29GnaV5YdyDj9TFkakje7GHYzDoObfddHtOSpoi2SmzJHrB3hM/XUDDEbxP2/oosszcRlehWXUvzHv4TpBVktHqwenFo8uLVmy4DKLa5d3RtLrmrM3aMFr1183E4sewf+85VWeg1c5ag276NZrM9IJVNcmLEvDNaV62aq+14IAOGFsBt973Ra8Xv11YzXwNfmft7Jg2oS+XOyoC8/cwzi66Dhmgk38kUmP1CUiYWOX1bpD2zWXt2FCp7uq8703APAa9dfNdscR/M/bZLIyouVxqJfeWvG9Je+JVckHQ9+CI9NWxz+blX/KYYvO5n2tAP/vrlZ7+8/h9y+9qeB/Hnt967e5mevX10rALDWK//FaAT5MXdBXdP0C/BAes792c40H+AiAp1e1oH8HgH94g/Lttx1gp63op1eyoM/Bvw5/G/7xFbqJPcCXnmBiwDPb/YKO4FX4OjyCb289db2/Noqicw4i7N6TVtoz8tNwDH+8x/i6Ae7lmaQVENzJFb3Di/BFeAwz+Is9SjeQySpPqbLFlNmyz47z5a/AF+AYFvDmHqibSXTEzoT4Gc3OALaqAP4KPFUJ6n+1x+rGAM6Zd78bgJ0a8QN4GU614vxwD9e1Amy6CcskNrczLx1JIp6HE5UZD/DBHrFr2oNlgG4Odv226BodoryjGJ9q2T/AR3vQrsOCS0ctXZi3ruLlhpFDJYl4HmYtjQCP9rhdn4suySLKDt6wLcC52h8xPlcjju1fn+yhuw4LZsAGUuo2b4Fx2UwQu77uqRHXGtg92aN3tQCbFexc0uk93vhTXbct6y7MulLycoUljx8ngDMBg1tvJjAazpEmOtxlzclvj1vQf1Tx7QlPDpGpqgtdSKz/d9/hdy1vTfFHSmC9dGDZbLiezz7Ac801HirGZsWjydfZyPvHXL/Y8Mjzg8BxTZiuwKz4Eb8sBE9zznszmjvFwHKPIWUnwhqfVRcd4Ck0K6ate48m1oOfrX3/yOtvAsJ8zsPAM89sjnddmuLuDPjX9Bu/L7x7xpMzFk6nWtyQfPg278Gn4Aekz2ZgOmU9eJ37R14vwE/BL8G3aibCiWMWWDQ0ZtkPMnlcGeAu/Ag+8ZyecU5BPuy2ILD+sQqyZhAKmn7XZd+jIMTN9eBL7x95xVLSX4On8EcNlXDqmBlqS13jG4LpmGbkF/0CnOi3H8ETOIXzmnmtb0a16Tzxj1sUvQCBiXZGDtmB3KAefPH94xcUa/6vwRn80GOFyjEXFpba4A1e8KQfFF+259tx5XS4egYn8fQsLGrqGrHbztr+uByTahWuL1NUGbDpsnrwBfePPwHHIf9X4RnM4Z2ABWdxUBlqQ2PwhuDxoS0vvqB1JzS0P4h2nA/QgTrsJFn+Y3AOjs9JFC07CGWX1oNX3T/yHOzgDjwPn1PM3g9Jk9lZrMEpxnlPmBbjyo2+KFXRU52TJM/2ALcY57RUzjObbjqxVw++4P6RAOf58pcVsw9Daje3htriYrpDOonre3CudSe6bfkTEgHBHuDiyu5MCsc7BHhYDx7ePxLjqigXZsw+ijMHFhuwBmtoTPtOxOrTvYJDnC75dnUbhfwu/ZW9AgYd+peL68HD+0emKquiXHhWjJg/UrkJYzuiaL3E9aI/ytrCvAd4GcYZMCkSQxfUg3v3j8c4e90j5ZTPdvmJJGHnOCI2nHS8081X013pHuBlV1gB2MX1YNmWLHqqGN/TWmG0y6clJWthxNUl48q38Bi8vtMKyzzpFdSDhxZ5WBA5ZLt8Jv3895DduBlgbPYAj8C4B8hO68FDkoh5lydC4FiWvBOVqjYdqjiLv92t8yPDjrDaiHdUD15qkSURSGmXJwOMSxWAXYwr3zaAufJ66l+94vv3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/wHuD9tQd4f+0B3l97gPfXHuD9tQd4f+0B3l97gG8LwP8G/AL8O/A5OCq0Ys2KIdv/qOIXG/4mvFAMF16gZD+2Xvu/B8as5+8bfllWyg0zaNO5bfXj6vfhhwD86/Aq3NfRS9t9WPnhfnvCIw/CT8GLcFTMnpntdF/z9V+PWc/vWoIH+FL3Znv57PitcdGP4R/C34avw5fgRVUInCwbsn1yyA8C8zm/BH8NXoXnVE6wVPjdeCI38kX/3+Ct9dbz1pTmHFRu+Hm4O9Ch3clr99negxfwj+ER/DR8EV6B5+DuQOnTgUw5rnkY+FbNU3gNXh0o/JYTuWOvyBf9FvzX663HH/HejO8LwAl8Hl5YLTd8q7sqA3wbjuExfAFegQdwfyDoSkWY8swzEf6o4Qyewefg+cHNbqMQruSL/u/WWc+E5g7vnnEXgDmcDeSGb/F4cBcCgT+GGRzDU3hZYburAt9TEtHgbM6JoxJ+6NMzzTcf6c2bycv2+KK/f+l6LBzw5IwfqZJhA3M472pWT/ajKxnjv4AFnMEpnBTPND6s2J7qHbPAqcMK74T2mZ4VGB9uJA465It+/eL1WKhYOD7xHOkr1ajK7d0C4+ke4Hy9qXZwpgLr+Znm/uNFw8xQOSy8H9IzjUrd9+BIfenYaylf9FsXr8fBAadnPIEDna8IBcwlxnuA0/Wv6GAWPd7dDIKjMdSWueAsBj4M7TOd06qBbwDwKr7oleuxMOEcTuEZTHWvDYUO7aHqAe0Bbq+HEFRzOz7WVoTDQkVds7A4sIIxfCQdCefFRoIOF/NFL1mPab/nvOakSL/Q1aFtNpUb/nFOVX6gzyg/1nISyDfUhsokIzaBR9Kxm80s5mK+6P56il1jXic7nhQxsxSm3OwBHl4fFdLqi64nDQZvqE2at7cWAp/IVvrN6/BFL1mPhYrGMBfOi4PyjuSGf6wBBh7p/FZTghCNWGgMzlBbrNJoPJX2mW5mwZfyRffXo7OFi5pZcS4qZUrlViptrXtw+GQoyhDPS+ANjcGBNRiLCQDPZPMHuiZfdFpPSTcQwwKYdRNqpkjm7AFeeT0pJzALgo7g8YYGrMHS0iocy+YTm2vyRUvvpXCIpQ5pe666TJrcygnScUf/p0NDs/iAI/nqDHC8TmQT8x3NF91l76oDdQGwu61Z6E0ABv7uO1dbf/37Zlv+Zw/Pbh8f1s4Avur6657/+YYBvur6657/+YYBvur6657/+YYBvur6657/+aYBvuL6657/+VMA8FXWX/f8zzcN8BXXX/f8zzcNMFdbf93zP38KLPiK6697/uebtuArrr/u+Z9vGmCusP6653/+1FjwVdZf9/zPN7oHX339dc//fNMu+irrr3v+50+Bi+Zq6697/uebA/jz8Pudf9ht/fWv517J/XUzAP8C/BAeX9WCDrUpZ3/dEMBxgPcfbtTVvsYV5Yn32u03B3Ac4P3b8I+vxNBKeeL9dRMAlwO83959qGO78sT769oB7g3w/vGVYFzKE++v6wV4OMD7F7tckFkmT7y/rhHgpQO8b+4Y46XyxPvrugBeNcB7BRiX8sT767oAvmCA9woAHsoT76+rBJjLBnh3txOvkifeX1dswZcO8G6N7sXyxPvr6i340gHe3TnqVfLE++uKAb50gHcXLnrX8sR7gNdPRqwzwLu7Y/FO5Yn3AK9jXCMGeHdgxDuVJ75VAI8ljP7PAb3/RfjcZfePHBB+79dpfpH1CanN30d+mT1h9GqAxxJGM5LQeeQ1+Tb+EQJrElLb38VHQ94TRq900aMIo8cSOo+8Dp8QfsB8zpqE1NO3OI9Zrj1h9EV78PqE0WMJnUdeU6E+Jjyk/hbrEFIfeWbvId8H9oTRFwdZaxJGvziW0Hn0gqYB/wyZ0PwRlxJST+BOw9m77Amj14ii1yGM/txYQudN0qDzGe4EqfA/5GJCagsHcPaEPWH0esekSwmjRxM6b5JEcZ4ww50ilvAOFxBSx4yLW+A/YU8YvfY5+ALC6NGEzhtmyZoFZoarwBLeZxUhtY4rc3bKnjB6TKJjFUHzJoTOozF2YBpsjcyxDgzhQ1YRUse8+J4wenwmaylB82hC5w0zoRXUNXaRBmSMQUqiWSWkLsaVqc/ZE0aPTFUuJWgeTei8SfLZQeMxNaZSIzbII4aE1Nmr13P2hNHjc9E9guYNCZ032YlNwESMLcZiLQHkE4aE1BFg0yAR4z1h9AiAGRA0jyZ03tyIxWMajMPWBIsxYJCnlITU5ShiHYdZ94TR4wCmSxg9jtB5KyPGYzymAYexWEMwAPIsAdYdV6aObmNPGD0aYLoEzaMJnTc0Ygs+YDw0GAtqxBjkuP38bMRWCHn73xNGjz75P73WenCEJnhwyVe3AEe8TtKdJcYhBl97wuhNAObK66lvD/9J9NS75v17wuitAN5fe4D31x7g/bUHeH/tAd5fe4D3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/w/toDvAd4f/24ABzZ8o+KLsSLS+Pv/TqTb3P4hKlQrTGh+fbIBT0Axqznnb+L/V2mb3HkN5Mb/nEHeK7d4IcDld6lmDW/iH9E+AH1MdOw/Jlu2T1xNmY98sv4wHnD7D3uNHu54WUuOsBTbQuvBsPT/UfzNxGYzwkP8c+Yz3C+r/i6DcyRL/rZ+utRwWH5PmfvcvYEt9jLDS/bg0/B64DWKrQM8AL8FPwS9beQCe6EMKNZYJol37jBMy35otdaz0Bw2H/C2Smc7+WGB0HWDELBmOByA3r5QONo4V+DpzR/hFS4U8wMW1PXNB4TOqYz9urxRV++ntWCw/U59Ty9ebdWbrgfRS9AYKKN63ZokZVygr8GZ/gfIhZXIXPsAlNjPOLBby5c1eOLvmQ9lwkOy5x6QV1j5TYqpS05JtUgUHUp5toHGsVfn4NX4RnMCe+AxTpwmApTYxqMxwfCeJGjpXzRF61nbcHhUBPqWze9svwcHJ+S6NPscKrEjug78Dx8Lj3T8D4YxGIdxmJcwhi34fzZUr7olevZCw5vkOhoClq5zBPZAnygD/Tl9EzDh6kl3VhsHYcDEb+hCtJSvuiV69kLDm+WycrOTArHmB5/VYyP6jOVjwgGawk2zQOaTcc1L+aLXrKeveDwZqlKrw8U9Y1p66uK8dEzdYwBeUQAY7DbyYNezBfdWQ97weEtAKYQg2xJIkuveAT3dYeLGH+ShrWNwZgN0b2YL7qznr3g8JYAo5bQBziPjx7BPZ0d9RCQp4UZbnFdzBddor4XHN4KYMrB2qHFRIzzcLAHQZ5the5ovui94PCWAPefaYnxIdzRwdHCbuR4B+tbiy96Lzi8E4D7z7S0mEPd+eqO3cT53Z0Y8SV80XvB4Z0ADJi/f7X113f+7p7/+UYBvur6657/+YYBvur6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+VMA8FXWX/f8z58OgK+y/rrnf75RgLna+uue//lTA/CV1V/3/M837aKvvv6653++UQvmauuve/7nTwfAV1N/3fM/fzr24Cuuv+75nz8FFnxl9dc9//MOr/8/glixwRuUfM4AAAAASUVORK5CYII="}getSearchTexture(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}dispose(){this.edgesRT.dispose(),this.weightsRT.dispose(),this.areaTexture.dispose(),this.searchTexture.dispose(),this.materialEdges.dispose(),this.materialWeights.dispose(),this.materialBlend.dispose(),this.fsQuad.dispose()}}class Zm extends Hi{getType(){return Qme}set edgesRT(e){this._objRef&&(this._objRef.edgesRT=e)}set weightsRT(e){this._objRef&&(this._objRef.weightsRT=e)}set areaTexture(e){this._objRef&&(this._objRef.areaTexture=e)}set searchTexture(e){this._objRef&&(this._objRef.searchTexture=e)}set uniformsEdges(e){this._objRef&&(this._objRef.uniformsEdges=e)}set materialEdges(e){this._objRef&&(this._objRef.materialEdges=e)}set uniformsWeights(e){this._objRef&&(this._objRef.uniformsWeights=e)}set materialWeights(e){this._objRef&&(this._objRef.materialWeights=e)}set uniformsBlend(e){this._objRef&&(this._objRef.uniformsBlend=e)}set materialBlend(e){this._objRef&&(this._objRef.materialBlend=e)}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}}Zm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Zm)))(t||Zm)}}(),Zm.\u0275cmp=$({type:Zm,selectors:[["th-sMAAPass"]],inputs:{edgesRT:"edgesRT",weightsRT:"weightsRT",areaTexture:"areaTexture",searchTexture:"searchTexture",uniformsEdges:"uniformsEdges",materialEdges:"materialEdges",uniformsWeights:"uniformsWeights",materialWeights:"materialWeights",uniformsBlend:"uniformsBlend",materialBlend:"materialBlend",fsQuad:"fsQuad"},features:[se([{provide:Pi,useExisting:le(()=>Zm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Xa extends Mt{getType(){return vc}set type(e){this._objRef&&(this._objRef.type=e)}set parameters(e){this._objRef&&(this._objRef.parameters=e)}}Xa.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Xa)))(t||Xa)}}(),Xa.\u0275cmp=$({type:Xa,selectors:[["th-sphereGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[se([{provide:Mt,useExisting:le(()=>Xa)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Km extends Ss{getType(){return w0}set type(e){this._objRef&&(this._objRef.type=e)}set position(e){this._objRef&&(this._objRef.position=Qe(this._objRef.position,e))}set target(e){this._objRef&&(this._objRef.target=e)}set intensity(e){this._objRef&&(this._objRef.intensity=e)}set distance(e){this._objRef&&(this._objRef.distance=e)}set angle(e){this._objRef&&(this._objRef.angle=e)}set decay(e){this._objRef&&(this._objRef.decay=e)}set shadow(e){this._objRef&&(this._objRef.shadow=e)}set power(e){this._objRef&&(this._objRef.power=e)}set penumbra(e){this._objRef&&(this._objRef.penumbra=e)}set map(e){this._objRef&&(this._objRef.map=e)}}Km.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Km)))(t||Km)}}(),Km.\u0275cmp=$({type:Km,selectors:[["th-spotLight"]],inputs:{type:"type",position:"position",target:"target",intensity:"intensity",distance:"distance",angle:"angle",decay:"decay",shadow:"shadow",power:"power",penumbra:"penumbra",map:"map"},features:[se([{provide:Ye,useExisting:le(()=>Km)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class $m extends Ye{getType(){return L4}set light(e){this._objRef&&(this._objRef.light=e)}set matrix(e){this._objRef&&(this._objRef.matrix=Qe(this._objRef.matrix,e))}set matrixAutoUpdate(e){this._objRef&&(this._objRef.matrixAutoUpdate=e)}set color(e){this._objRef&&(this._objRef.color=e)}set cone(e){this._objRef&&(this._objRef.cone=e)}}$m.\u0275fac=function(){let i;return function(t){return(i||(i=ce($m)))(t||$m)}}(),$m.\u0275cmp=$({type:$m,selectors:[["th-spotLightHelper"]],inputs:{light:"light",matrix:"matrix",matrixAutoUpdate:"matrixAutoUpdate",color:"color",cone:"cone"},features:[se([{provide:Ye,useExisting:le(()=>$m)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Jm extends Ye{getType(){return HT}set type(e){this._objRef&&(this._objRef.type=e)}set geometry(e){this._objRef&&(this._objRef.geometry=e)}set material(e){this._objRef&&(this._objRef.material=e)}set center(e){this._objRef&&(this._objRef.center=Qe(this._objRef.center,e))}}Jm.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Jm)))(t||Jm)}}(),Jm.\u0275cmp=$({type:Jm,selectors:[["th-sprite"]],inputs:{type:"type",geometry:"geometry",material:"material",center:"center"},features:[se([{provide:Ye,useExisting:le(()=>Jm)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class eg extends Ei{getType(){return ZA}set type(e){this._objRef&&(this._objRef.type=e)}set color(e){this._objRef&&(this._objRef.color=Qe(this._objRef.color,e))}set map(e){this._objRef&&(this._objRef.map=e)}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}set rotation(e){this._objRef&&(this._objRef.rotation=e)}set sizeAttenuation(e){this._objRef&&(this._objRef.sizeAttenuation=e)}set transparent(e){this._objRef&&(this._objRef.transparent=e)}set fog(e){this._objRef&&(this._objRef.fog=e)}}eg.\u0275fac=function(){let i;return function(t){return(i||(i=ce(eg)))(t||eg)}}(),eg.\u0275cmp=$({type:eg,selectors:[["th-spriteMaterial"]],inputs:{type:"type",color:"color",map:"map",alphaMap:"alphaMap",rotation:"rotation",sizeAttenuation:"sizeAttenuation",transparent:"transparent",fog:"fog"},features:[se([{provide:Ei,useExisting:le(()=>eg)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class fH extends vn{constructor(e,t,n,r){super(),this.scene=e,this.camera=t,this.sampleLevel=4,this.unbiased=!0,this.clearColor=void 0!==n?n:0,this.clearAlpha=void 0!==r?r:0,this._oldClearColor=new De;const s=Zr;this.copyUniforms=mi.clone(s.uniforms),this.copyMaterial=new Rt({uniforms:this.copyUniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blending:cf,blendEquation:As,blendDst:L_,blendDstAlpha:L_,blendSrc:uf,blendSrcAlpha:L_}),this.fsQuad=new wr(this.copyMaterial)}dispose(){this.sampleRenderTarget&&(this.sampleRenderTarget.dispose(),this.sampleRenderTarget=null),this.copyMaterial.dispose(),this.fsQuad.dispose()}setSize(e,t){this.sampleRenderTarget&&this.sampleRenderTarget.setSize(e,t)}render(e,t,n){this.sampleRenderTarget||(this.sampleRenderTarget=new Gt(n.width,n.height),this.sampleRenderTarget.texture.name="SSAARenderPass.sample");const r=Wme[Math.max(0,Math.min(this.sampleLevel,5))],s=e.autoClear;e.autoClear=!1,e.getClearColor(this._oldClearColor);const o=e.getClearAlpha(),a=1/r.length;this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture;const c={fullWidth:n.width,fullHeight:n.height,offsetX:0,offsetY:0,width:n.width,height:n.height},d=Object.assign({},this.camera.view);d.enabled&&Object.assign(c,d);for(let u=0;u<r.length;u++){const h=r[u];this.camera.setViewOffset&&this.camera.setViewOffset(c.fullWidth,c.fullHeight,c.offsetX+.0625*h[0],c.offsetY+.0625*h[1],c.width,c.height);let f=a;this.unbiased&&(f+=.03125*((u+.5)/r.length-.5)),this.copyUniforms.opacity.value=f,e.setClearColor(this.clearColor,this.clearAlpha),e.setRenderTarget(this.sampleRenderTarget),e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(this.renderToScreen?null:t),0===u&&(e.setClearColor(0,0),e.clear()),this.fsQuad.render(e)}this.camera.setViewOffset&&d.enabled?this.camera.setViewOffset(d.fullWidth,d.fullHeight,d.offsetX,d.offsetY,d.width,d.height):this.camera.clearViewOffset&&this.camera.clearViewOffset(),e.autoClear=s,e.setClearColor(this._oldClearColor,o)}}const Wme=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]];class Ju extends Hi{getType(){return fH}set scene(e){this._objRef&&(this._objRef.scene=e)}set camera(e){this._objRef&&(this._objRef.camera=e)}set sampleLevel(e){this._objRef&&(this._objRef.sampleLevel=e)}set unbiased(e){this._objRef&&(this._objRef.unbiased=e)}set clearColor(e){this._objRef&&(this._objRef.clearColor=e)}set clearAlpha(e){this._objRef&&(this._objRef.clearAlpha=e)}set copyUniforms(e){this._objRef&&(this._objRef.copyUniforms=e)}set copyMaterial(e){this._objRef&&(this._objRef.copyMaterial=e)}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}set sampleRenderTarget(e){this._objRef&&(this._objRef.sampleRenderTarget=e)}}Ju.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Ju)))(t||Ju)}}(),Ju.\u0275cmp=$({type:Ju,selectors:[["th-sSAARenderPass"]],inputs:{scene:"scene",camera:"camera",sampleLevel:"sampleLevel",unbiased:"unbiased",clearColor:"clearColor",clearAlpha:"clearAlpha",copyUniforms:"copyUniforms",copyMaterial:"copyMaterial",fsQuad:"fsQuad",sampleRenderTarget:"sampleRenderTarget"},features:[se([{provide:Pi,useExisting:le(()=>Ju)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const Lw={defines:{PERSPECTIVE_CAMERA:1,KERNEL_SIZE:32},uniforms:{tDiffuse:{value:null},tNormal:{value:null},tDepth:{value:null},tNoise:{value:null},kernel:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new ue},cameraProjectionMatrix:{value:new Ve},cameraInverseProjectionMatrix:{value:new Ve},kernelRadius:{value:8},minDistance:{value:.005},maxDistance:{value:.05}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tNormal;\n\t\tuniform sampler2D tDepth;\n\t\tuniform sampler2D tNoise;\n\n\t\tuniform vec3 kernel[ KERNEL_SIZE ];\n\n\t\tuniform vec2 resolution;\n\n\t\tuniform float cameraNear;\n\t\tuniform float cameraFar;\n\t\tuniform mat4 cameraProjectionMatrix;\n\t\tuniform mat4 cameraInverseProjectionMatrix;\n\n\t\tuniform float kernelRadius;\n\t\tuniform float minDistance; // avoid artifacts caused by neighbour fragments with minimal depth difference\n\t\tuniform float maxDistance; // avoid the influence of fragments which are too far away\n\n\t\tvarying vec2 vUv;\n\n\t\t#include <packing>\n\n\t\tfloat getDepth( const in vec2 screenPosition ) {\n\n\t\t\treturn texture2D( tDepth, screenPosition ).x;\n\n\t\t}\n\n\t\tfloat getLinearDepth( const in vec2 screenPosition ) {\n\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\n\t\t\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;\n\t\t\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );\n\t\t\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );\n\n\t\t\t#else\n\n\t\t\t\treturn texture2D( tDepth, screenPosition ).x;\n\n\t\t\t#endif\n\n\t\t}\n\n\t\tfloat getViewZ( const in float depth ) {\n\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\n\t\t\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\n\n\t\t\t#else\n\n\t\t\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );\n\n\t\t\t#endif\n\n\t\t}\n\n\t\tvec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {\n\n\t\t\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];\n\n\t\t\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );\n\n\t\t\tclipPosition *= clipW; // unprojection.\n\n\t\t\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;\n\n\t\t}\n\n\t\tvec3 getViewNormal( const in vec2 screenPosition ) {\n\n\t\t\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tfloat depth = getDepth( vUv );\n\t\t\tfloat viewZ = getViewZ( depth );\n\n\t\t\tvec3 viewPosition = getViewPosition( vUv, depth, viewZ );\n\t\t\tvec3 viewNormal = getViewNormal( vUv );\n\n\t\t\tvec2 noiseScale = vec2( resolution.x / 4.0, resolution.y / 4.0 );\n\t\t\tvec3 random = vec3( texture2D( tNoise, vUv * noiseScale ).r );\n\n\t\t\t// compute matrix used to reorient a kernel vector\n\n\t\t\tvec3 tangent = normalize( random - viewNormal * dot( random, viewNormal ) );\n\t\t\tvec3 bitangent = cross( viewNormal, tangent );\n\t\t\tmat3 kernelMatrix = mat3( tangent, bitangent, viewNormal );\n\n\t\t float occlusion = 0.0;\n\n\t\t for ( int i = 0; i < KERNEL_SIZE; i ++ ) {\n\n\t\t\t\tvec3 sampleVector = kernelMatrix * kernel[ i ]; // reorient sample vector in view space\n\t\t\t\tvec3 samplePoint = viewPosition + ( sampleVector * kernelRadius ); // calculate sample point\n\n\t\t\t\tvec4 samplePointNDC = cameraProjectionMatrix * vec4( samplePoint, 1.0 ); // project point and calculate NDC\n\t\t\t\tsamplePointNDC /= samplePointNDC.w;\n\n\t\t\t\tvec2 samplePointUv = samplePointNDC.xy * 0.5 + 0.5; // compute uv coordinates\n\n\t\t\t\tfloat realDepth = getLinearDepth( samplePointUv ); // get linear depth from depth texture\n\t\t\t\tfloat sampleDepth = viewZToOrthographicDepth( samplePoint.z, cameraNear, cameraFar ); // compute linear depth of the sample view Z value\n\t\t\t\tfloat delta = sampleDepth - realDepth;\n\n\t\t\t\tif ( delta > minDistance && delta < maxDistance ) { // if fragment is before sample point, increase occlusion\n\n\t\t\t\t\tocclusion += 1.0;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tocclusion = clamp( occlusion / float( KERNEL_SIZE ), 0.0, 1.0 );\n\n\t\t\tgl_FragColor = vec4( vec3( 1.0 - occlusion ), 1.0 );\n\n\t\t}"},Ow_defines={PERSPECTIVE_CAMERA:1},Ow_uniforms={tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null}},Ow_vertexShader="varying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",Ow_fragmentShader="uniform sampler2D tDepth;\n\n\t\tuniform float cameraNear;\n\t\tuniform float cameraFar;\n\n\t\tvarying vec2 vUv;\n\n\t\t#include <packing>\n\n\t\tfloat getLinearDepth( const in vec2 screenPosition ) {\n\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\n\t\t\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;\n\t\t\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );\n\t\t\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );\n\n\t\t\t#else\n\n\t\t\t\treturn texture2D( tDepth, screenPosition ).x;\n\n\t\t\t#endif\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tfloat depth = getLinearDepth( vUv );\n\t\t\tgl_FragColor = vec4( vec3( 1.0 - depth ), 1.0 );\n\n\t\t}",Nw={uniforms:{tDiffuse:{value:null},resolution:{value:new ue}},vertexShader:"varying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"uniform sampler2D tDiffuse;\n\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec2 texelSize = ( 1.0 / resolution );\n\t\t\tfloat result = 0.0;\n\n\t\t\tfor ( int i = - 2; i <= 2; i ++ ) {\n\n\t\t\t\tfor ( int j = - 2; j <= 2; j ++ ) {\n\n\t\t\t\t\tvec2 offset = ( vec2( float( i ), float( j ) ) ) * texelSize;\n\t\t\t\t\tresult += texture2D( tDiffuse, vUv + offset ).r;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tgl_FragColor = vec4( vec3( result / ( 5.0 * 5.0 ) ), 1.0 );\n\n\t\t}"};let qme=(()=>{class i extends vn{constructor(t,n,r,s){super(),this.width=void 0!==r?r:512,this.height=void 0!==s?s:512,this.clear=!0,this.camera=n,this.scene=t,this.kernelRadius=8,this.kernelSize=32,this.kernel=[],this.noiseTexture=null,this.output=0,this.minDistance=.005,this.maxDistance=.1,this._visibilityCache=new Map,this.generateSampleKernel(),this.generateRandomKernelRotations();const o=new Hf;o.format=dc,o.type=lc,this.beautyRenderTarget=new Gt(this.width,this.height),this.normalRenderTarget=new Gt(this.width,this.height,{minFilter:$t,magFilter:$t,depthTexture:o}),this.ssaoRenderTarget=new Gt(this.width,this.height),this.blurRenderTarget=this.ssaoRenderTarget.clone(),this.ssaoMaterial=new Rt({defines:Object.assign({},Lw.defines),uniforms:mi.clone(Lw.uniforms),vertexShader:Lw.vertexShader,fragmentShader:Lw.fragmentShader,blending:Kt}),this.ssaoMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.ssaoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.ssaoMaterial.uniforms.tDepth.value=this.normalRenderTarget.depthTexture,this.ssaoMaterial.uniforms.tNoise.value=this.noiseTexture,this.ssaoMaterial.uniforms.kernel.value=this.kernel,this.ssaoMaterial.uniforms.cameraNear.value=this.camera.near,this.ssaoMaterial.uniforms.cameraFar.value=this.camera.far,this.ssaoMaterial.uniforms.resolution.value.set(this.width,this.height),this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.normalMaterial=new ap,this.normalMaterial.blending=Kt,this.blurMaterial=new Rt({defines:Object.assign({},Nw.defines),uniforms:mi.clone(Nw.uniforms),vertexShader:Nw.vertexShader,fragmentShader:Nw.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.blurMaterial.uniforms.resolution.value.set(this.width,this.height),this.depthRenderMaterial=new Rt({defines:Object.assign({},Ow_defines),uniforms:mi.clone(Ow_uniforms),vertexShader:Ow_vertexShader,fragmentShader:Ow_fragmentShader,blending:Kt}),this.depthRenderMaterial.uniforms.tDepth.value=this.normalRenderTarget.depthTexture,this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.copyMaterial=new Rt({uniforms:mi.clone(Zr.uniforms),vertexShader:Zr.vertexShader,fragmentShader:Zr.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:sA,blendDst:df,blendEquation:As,blendSrcAlpha:rA,blendDstAlpha:df,blendEquationAlpha:As}),this.fsQuad=new wr(null),this.originalClearColor=new De}dispose(){this.beautyRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.ssaoRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.normalMaterial.dispose(),this.blurMaterial.dispose(),this.copyMaterial.dispose(),this.depthRenderMaterial.dispose(),this.fsQuad.dispose()}render(t,n){switch(!1===t.capabilities.isWebGL2&&(this.noiseTexture.format=cA),t.setRenderTarget(this.beautyRenderTarget),t.clear(),t.render(this.scene,this.camera),this.overrideVisibility(),this.renderOverride(t,this.normalMaterial,this.normalRenderTarget,7829503,1),this.restoreVisibility(),this.ssaoMaterial.uniforms.kernelRadius.value=this.kernelRadius,this.ssaoMaterial.uniforms.minDistance.value=this.minDistance,this.ssaoMaterial.uniforms.maxDistance.value=this.maxDistance,this.renderPass(t,this.ssaoMaterial,this.ssaoRenderTarget),this.renderPass(t,this.blurMaterial,this.blurRenderTarget),this.output){case i.OUTPUT.SSAO:this.copyMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Blur:this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Beauty:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Depth:this.renderPass(t,this.depthRenderMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Normal:this.copyMaterial.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Default:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n),this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=cf,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;default:console.warn("THREE.SSAOPass: Unknown output type.")}}renderPass(t,n,r,s,o){t.getClearColor(this.originalClearColor);const a=t.getClearAlpha(),l=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,null!=s&&(t.setClearColor(s),t.setClearAlpha(o||0),t.clear()),this.fsQuad.material=n,this.fsQuad.render(t),t.autoClear=l,t.setClearColor(this.originalClearColor),t.setClearAlpha(a)}renderOverride(t,n,r,s,o){t.getClearColor(this.originalClearColor);const a=t.getClearAlpha(),l=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,o=n.clearAlpha||o,null!=(s=n.clearColor||s)&&(t.setClearColor(s),t.setClearAlpha(o||0),t.clear()),this.scene.overrideMaterial=n,t.render(this.scene,this.camera),this.scene.overrideMaterial=null,t.autoClear=l,t.setClearColor(this.originalClearColor),t.setClearAlpha(a)}setSize(t,n){this.width=t,this.height=n,this.beautyRenderTarget.setSize(t,n),this.ssaoRenderTarget.setSize(t,n),this.normalRenderTarget.setSize(t,n),this.blurRenderTarget.setSize(t,n),this.ssaoMaterial.uniforms.resolution.value.set(t,n),this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.blurMaterial.uniforms.resolution.value.set(t,n)}generateSampleKernel(){const t=this.kernelSize,n=this.kernel;for(let r=0;r<t;r++){const s=new T;s.x=2*Math.random()-1,s.y=2*Math.random()-1,s.z=Math.random(),s.normalize();let o=r/t;o=gt.lerp(.1,1,o*o),s.multiplyScalar(o),n.push(s)}}generateRandomKernelRotations(){const r=new Dw,o=new Float32Array(16);for(let a=0;a<16;a++){const l=2*Math.random()-1,c=2*Math.random()-1;o[a]=r.noise3d(l,c,0)}this.noiseTexture=new ka(o,4,4,bl,Ln),this.noiseTexture.wrapS=Ao,this.noiseTexture.wrapT=Ao,this.noiseTexture.needsUpdate=!0}overrideVisibility(){const n=this._visibilityCache;this.scene.traverse(function(r){n.set(r,r.visible),(r.isPoints||r.isLine)&&(r.visible=!1)})}restoreVisibility(){const n=this._visibilityCache;this.scene.traverse(function(r){const s=n.get(r);r.visible=s}),n.clear()}}return i.OUTPUT={Default:0,SSAO:1,Blur:2,Beauty:3,Depth:4,Normal:5},i})();class tg extends Hi{getType(){return qme}set scene(e){this._objRef&&(this._objRef.scene=e)}set camera(e){this._objRef&&(this._objRef.camera=e)}set width(e){this._objRef&&(this._objRef.width=e)}set height(e){this._objRef&&(this._objRef.height=e)}set clear(e){this._objRef&&(this._objRef.clear=e)}set kernelRadius(e){this._objRef&&(this._objRef.kernelRadius=e)}set kernelSize(e){this._objRef&&(this._objRef.kernelSize=e)}set kernel(e){this._objRef&&(this._objRef.kernel=e)}set noiseTexture(e){this._objRef&&(this._objRef.noiseTexture=e)}set output(e){this._objRef&&(this._objRef.output=e)}set minDistance(e){this._objRef&&(this._objRef.minDistance=e)}set maxDistance(e){this._objRef&&(this._objRef.maxDistance=e)}set beautyRenderTarget(e){this._objRef&&(this._objRef.beautyRenderTarget=e)}set normalRenderTarget(e){this._objRef&&(this._objRef.normalRenderTarget=e)}set ssaoRenderTarget(e){this._objRef&&(this._objRef.ssaoRenderTarget=e)}set blurRenderTarget(e){this._objRef&&(this._objRef.blurRenderTarget=e)}set ssaoMaterial(e){this._objRef&&(this._objRef.ssaoMaterial=e)}set normalMaterial(e){this._objRef&&(this._objRef.normalMaterial=e)}set blurMaterial(e){this._objRef&&(this._objRef.blurMaterial=e)}set depthRenderMaterial(e){this._objRef&&(this._objRef.depthRenderMaterial=e)}set copyMaterial(e){this._objRef&&(this._objRef.copyMaterial=e)}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}set originalClearColor(e){this._objRef&&(this._objRef.originalClearColor=Qe(this._objRef.originalClearColor,e))}}tg.\u0275fac=function(){let i;return function(t){return(i||(i=ce(tg)))(t||tg)}}(),tg.\u0275cmp=$({type:tg,selectors:[["th-sSAOPass"]],inputs:{scene:"scene",camera:"camera",width:"width",height:"height",clear:"clear",kernelRadius:"kernelRadius",kernelSize:"kernelSize",kernel:"kernel",noiseTexture:"noiseTexture",output:"output",minDistance:"minDistance",maxDistance:"maxDistance",beautyRenderTarget:"beautyRenderTarget",normalRenderTarget:"normalRenderTarget",ssaoRenderTarget:"ssaoRenderTarget",blurRenderTarget:"blurRenderTarget",ssaoMaterial:"ssaoMaterial",normalMaterial:"normalMaterial",blurMaterial:"blurMaterial",depthRenderMaterial:"depthRenderMaterial",copyMaterial:"copyMaterial",fsQuad:"fsQuad",originalClearColor:"originalClearColor"},features:[se([{provide:Pi,useExisting:le(()=>tg)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const Ya={defines:{MAX_STEP:0,PERSPECTIVE_CAMERA:!0,DISTANCE_ATTENUATION:!0,FRESNEL:!0,INFINITE_THICK:!1,SELECTIVE:!1},uniforms:{tDiffuse:{value:null},tNormal:{value:null},tMetalness:{value:null},tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new ue},cameraProjectionMatrix:{value:new Ve},cameraInverseProjectionMatrix:{value:new Ve},opacity:{value:.5},maxDistance:{value:180},cameraRange:{value:0},thickness:{value:.018}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}\n\n\t",fragmentShader:'\n\t\t// precision highp float;\n\t\tprecision highp sampler2D;\n\t\tvarying vec2 vUv;\n\t\tuniform sampler2D tDepth;\n\t\tuniform sampler2D tNormal;\n\t\tuniform sampler2D tMetalness;\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float cameraRange;\n\t\tuniform vec2 resolution;\n\t\tuniform float opacity;\n\t\tuniform float cameraNear;\n\t\tuniform float cameraFar;\n\t\tuniform float maxDistance;\n\t\tuniform float thickness;\n\t\tuniform mat4 cameraProjectionMatrix;\n\t\tuniform mat4 cameraInverseProjectionMatrix;\n\t\t#include <packing>\n\t\tfloat pointToLineDistance(vec3 x0, vec3 x1, vec3 x2) {\n\t\t\t//x0: point, x1: linePointA, x2: linePointB\n\t\t\t//https://mathworld.wolfram.com/Point-LineDistance3-Dimensional.html\n\t\t\treturn length(cross(x0-x1,x0-x2))/length(x2-x1);\n\t\t}\n\t\tfloat pointPlaneDistance(vec3 point,vec3 planePoint,vec3 planeNormal){\n\t\t\t// https://mathworld.wolfram.com/Point-PlaneDistance.html\n\t\t\t//// https://en.wikipedia.org/wiki/Plane_(geometry)\n\t\t\t//// http://paulbourke.net/geometry/pointlineplane/\n\t\t\tfloat a=planeNormal.x,b=planeNormal.y,c=planeNormal.z;\n\t\t\tfloat x0=point.x,y0=point.y,z0=point.z;\n\t\t\tfloat x=planePoint.x,y=planePoint.y,z=planePoint.z;\n\t\t\tfloat d=-(a*x+b*y+c*z);\n\t\t\tfloat distance=(a*x0+b*y0+c*z0+d)/sqrt(a*a+b*b+c*c);\n\t\t\treturn distance;\n\t\t}\n\t\tfloat getDepth( const in vec2 uv ) {\n\t\t\treturn texture2D( tDepth, uv ).x;\n\t\t}\n\t\tfloat getViewZ( const in float depth ) {\n\t\t\t#ifdef PERSPECTIVE_CAMERA\n\t\t\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#else\n\t\t\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#endif\n\t\t}\n\t\tvec3 getViewPosition( const in vec2 uv, const in float depth/*clip space*/, const in float clipW ) {\n\t\t\tvec4 clipPosition = vec4( ( vec3( uv, depth ) - 0.5 ) * 2.0, 1.0 );//ndc\n\t\t\tclipPosition *= clipW; //clip\n\t\t\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;//view\n\t\t}\n\t\tvec3 getViewNormal( const in vec2 uv ) {\n\t\t\treturn unpackRGBToNormal( texture2D( tNormal, uv ).xyz );\n\t\t}\n\t\tvec2 viewPositionToXY(vec3 viewPosition){\n\t\t\tvec2 xy;\n\t\t\tvec4 clip=cameraProjectionMatrix*vec4(viewPosition,1);\n\t\t\txy=clip.xy;//clip\n\t\t\tfloat clipW=clip.w;\n\t\t\txy/=clipW;//NDC\n\t\t\txy=(xy+1.)/2.;//uv\n\t\t\txy*=resolution;//screen\n\t\t\treturn xy;\n\t\t}\n\t\tvoid main(){\n\t\t\t#ifdef SELECTIVE\n\t\t\t\tfloat metalness=texture2D(tMetalness,vUv).r;\n\t\t\t\tif(metalness==0.) return;\n\t\t\t#endif\n\n\t\t\tfloat depth = getDepth( vUv );\n\t\t\tfloat viewZ = getViewZ( depth );\n\t\t\tif(-viewZ>=cameraFar) return;\n\n\t\t\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ+cameraProjectionMatrix[3][3];\n\t\t\tvec3 viewPosition=getViewPosition( vUv, depth, clipW );\n\n\t\t\tvec2 d0=gl_FragCoord.xy;\n\t\t\tvec2 d1;\n\n\t\t\tvec3 viewNormal=getViewNormal( vUv );\n\n\t\t\t#ifdef PERSPECTIVE_CAMERA\n\t\t\t\tvec3 viewIncidentDir=normalize(viewPosition);\n\t\t\t\tvec3 viewReflectDir=reflect(viewIncidentDir,viewNormal);\n\t\t\t#else\n\t\t\t\tvec3 viewIncidentDir=vec3(0,0,-1);\n\t\t\t\tvec3 viewReflectDir=reflect(viewIncidentDir,viewNormal);\n\t\t\t#endif\n\n\t\t\tfloat maxReflectRayLen=maxDistance/dot(-viewIncidentDir,viewNormal);\n\t\t\t// dot(a,b)==length(a)*length(b)*cos(theta) // https://www.mathsisfun.com/algebra/vectors-dot-product.html\n\t\t\t// if(a.isNormalized&&b.isNormalized) dot(a,b)==cos(theta)\n\t\t\t// maxDistance/maxReflectRayLen=cos(theta)\n\t\t\t// maxDistance/maxReflectRayLen==dot(a,b)\n\t\t\t// maxReflectRayLen==maxDistance/dot(a,b)\n\n\t\t\tvec3 d1viewPosition=viewPosition+viewReflectDir*maxReflectRayLen;\n\t\t\t#ifdef PERSPECTIVE_CAMERA\n\t\t\t\tif(d1viewPosition.z>-cameraNear){\n\t\t\t\t\t//https://tutorial.math.lamar.edu/Classes/CalcIII/EqnsOfLines.aspx\n\t\t\t\t\tfloat t=(-cameraNear-viewPosition.z)/viewReflectDir.z;\n\t\t\t\t\td1viewPosition=viewPosition+viewReflectDir*t;\n\t\t\t\t}\n\t\t\t#endif\n\t\t\td1=viewPositionToXY(d1viewPosition);\n\n\t\t\tfloat totalLen=length(d1-d0);\n\t\t\tfloat xLen=d1.x-d0.x;\n\t\t\tfloat yLen=d1.y-d0.y;\n\t\t\tfloat totalStep=max(abs(xLen),abs(yLen));\n\t\t\tfloat xSpan=xLen/totalStep;\n\t\t\tfloat ySpan=yLen/totalStep;\n\t\t\tfor(float i=0.;i<float(MAX_STEP);i++){\n\t\t\t\tif(i>=totalStep) break;\n\t\t\t\tvec2 xy=vec2(d0.x+i*xSpan,d0.y+i*ySpan);\n\t\t\t\tif(xy.x<0.||xy.x>resolution.x||xy.y<0.||xy.y>resolution.y) break;\n\t\t\t\tfloat s=length(xy-d0)/totalLen;\n\t\t\t\tvec2 uv=xy/resolution;\n\n\t\t\t\tfloat d = getDepth(uv);\n\t\t\t\tfloat vZ = getViewZ( d );\n\t\t\t\tif(-vZ>=cameraFar) continue;\n\t\t\t\tfloat cW = cameraProjectionMatrix[2][3] * vZ+cameraProjectionMatrix[3][3];\n\t\t\t\tvec3 vP=getViewPosition( uv, d, cW );\n\n\t\t\t\t#ifdef PERSPECTIVE_CAMERA\n\t\t\t\t\t// https://comp.nus.edu.sg/~lowkl/publications/lowk_persp_interp_techrep.pdf\n\t\t\t\t\tfloat recipVPZ=1./viewPosition.z;\n\t\t\t\t\tfloat viewReflectRayZ=1./(recipVPZ+s*(1./d1viewPosition.z-recipVPZ));\n\t\t\t\t#else\n\t\t\t\t\tfloat viewReflectRayZ=viewPosition.z+s*(d1viewPosition.z-viewPosition.z);\n\t\t\t\t#endif\n\n\t\t\t\t// if(viewReflectRayZ>vZ) continue; // will cause "npm run make-screenshot webgl_postprocessing_ssr" high probability hang.\n\t\t\t\t// https://github.com/mrdoob/three.js/pull/21539#issuecomment-821061164\n\t\t\t\tif(viewReflectRayZ<=vZ){\n\n\t\t\t\t\tbool hit;\n\t\t\t\t\t#ifdef INFINITE_THICK\n\t\t\t\t\t\thit=true;\n\t\t\t\t\t#else\n\t\t\t\t\t\tfloat away=pointToLineDistance(vP,viewPosition,d1viewPosition);\n\n\t\t\t\t\t\tfloat minThickness;\n\t\t\t\t\t\tvec2 xyNeighbor=xy;\n\t\t\t\t\t\txyNeighbor.x+=1.;\n\t\t\t\t\t\tvec2 uvNeighbor=xyNeighbor/resolution;\n\t\t\t\t\t\tvec3 vPNeighbor=getViewPosition(uvNeighbor,d,cW);\n\t\t\t\t\t\tminThickness=vPNeighbor.x-vP.x;\n\t\t\t\t\t\tminThickness*=3.;\n\t\t\t\t\t\tfloat tk=max(minThickness,thickness);\n\n\t\t\t\t\t\thit=away<=tk;\n\t\t\t\t\t#endif\n\n\t\t\t\t\tif(hit){\n\t\t\t\t\t\tvec3 vN=getViewNormal( uv );\n\t\t\t\t\t\tif(dot(viewReflectDir,vN)>=0.) continue;\n\t\t\t\t\t\tfloat distance=pointPlaneDistance(vP,viewPosition,viewNormal);\n\t\t\t\t\t\tif(distance>maxDistance) break;\n\t\t\t\t\t\tfloat op=opacity;\n\t\t\t\t\t\t#ifdef DISTANCE_ATTENUATION\n\t\t\t\t\t\t\tfloat ratio=1.-(distance/maxDistance);\n\t\t\t\t\t\t\tfloat attenuation=ratio*ratio;\n\t\t\t\t\t\t\top=opacity*attenuation;\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\t#ifdef FRESNEL\n\t\t\t\t\t\t\tfloat fresnelCoe=(dot(viewIncidentDir,viewReflectDir)+1.)/2.;\n\t\t\t\t\t\t\top*=fresnelCoe;\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\tvec4 reflectColor=texture2D(tDiffuse,uv);\n\t\t\t\t\t\tgl_FragColor.xyz=reflectColor.xyz;\n\t\t\t\t\t\tgl_FragColor.a=op;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t'},jw_defines={PERSPECTIVE_CAMERA:1},jw_uniforms={tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null}},jw_vertexShader="\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}\n\n\t",jw_fragmentShader="\n\n\t\tuniform sampler2D tDepth;\n\n\t\tuniform float cameraNear;\n\t\tuniform float cameraFar;\n\n\t\tvarying vec2 vUv;\n\n\t\t#include <packing>\n\n\t\tfloat getLinearDepth( const in vec2 uv ) {\n\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\n\t\t\t\tfloat fragCoordZ = texture2D( tDepth, uv ).x;\n\t\t\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );\n\t\t\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );\n\n\t\t\t#else\n\n\t\t\t\treturn texture2D( tDepth, uv ).x;\n\n\t\t\t#endif\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tfloat depth = getLinearDepth( vUv );\n\t\t\tfloat d = 1.0 - depth;\n\t\t\t// d=(d-.999)*1000.;\n\t\t\tgl_FragColor = vec4( vec3( d ), 1.0 );\n\n\t\t}\n\n\t",zc={uniforms:{tDiffuse:{value:null},resolution:{value:new ue},opacity:{value:.5}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}\n\n\t",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec2 resolution;\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\t//reverse engineering from PhotoShop blur filter, then change coefficient\n\n\t\t\tvec2 texelSize = ( 1.0 / resolution );\n\n\t\t\tvec4 c=texture2D(tDiffuse,vUv);\n\n\t\t\tvec2 offset;\n\n\t\t\toffset=(vec2(-1,0))*texelSize;\n\t\t\tvec4 cl=texture2D(tDiffuse,vUv+offset);\n\n\t\t\toffset=(vec2(1,0))*texelSize;\n\t\t\tvec4 cr=texture2D(tDiffuse,vUv+offset);\n\n\t\t\toffset=(vec2(0,-1))*texelSize;\n\t\t\tvec4 cb=texture2D(tDiffuse,vUv+offset);\n\n\t\t\toffset=(vec2(0,1))*texelSize;\n\t\t\tvec4 ct=texture2D(tDiffuse,vUv+offset);\n\n\t\t\t// float coeCenter=.5;\n\t\t\t// float coeSide=.125;\n\t\t\tfloat coeCenter=.2;\n\t\t\tfloat coeSide=.2;\n\t\t\tfloat a=c.a*coeCenter+cl.a*coeSide+cr.a*coeSide+cb.a*coeSide+ct.a*coeSide;\n\t\t\tvec3 rgb=(c.rgb*c.a*coeCenter+cl.rgb*cl.a*coeSide+cr.rgb*cr.a*coeSide+cb.rgb*cb.a*coeSide+ct.rgb*ct.a*coeSide)/a;\n\t\t\tgl_FragColor=vec4(rgb,a);\n\n\t\t}\n\t"};let Xme=(()=>{class i extends vn{constructor({renderer:t,scene:n,camera:r,width:s,height:o,selects:a,bouncing:l=!1,groundReflector:c}){super(),this.width=void 0!==s?s:512,this.height=void 0!==o?o:512,this.clear=!0,this.renderer=t,this.scene=n,this.camera=r,this.groundReflector=c,this.opacity=Ya.uniforms.opacity.value,this.output=0,this.maxDistance=Ya.uniforms.maxDistance.value,this.thickness=Ya.uniforms.thickness.value,this.tempColor=new De,this._selects=a,this.selective=Array.isArray(this._selects),Object.defineProperty(this,"selects",{get(){return this._selects},set(u){this._selects!==u&&(this._selects=u,Array.isArray(u)?(this.selective=!0,this.ssrMaterial.defines.SELECTIVE=!0,this.ssrMaterial.needsUpdate=!0):(this.selective=!1,this.ssrMaterial.defines.SELECTIVE=!1,this.ssrMaterial.needsUpdate=!0))}}),this._bouncing=l,Object.defineProperty(this,"bouncing",{get(){return this._bouncing},set(u){this._bouncing!==u&&(this._bouncing=u,this.ssrMaterial.uniforms.tDiffuse.value=u?this.prevRenderTarget.texture:this.beautyRenderTarget.texture)}}),this.blur=!0,this._distanceAttenuation=Ya.defines.DISTANCE_ATTENUATION,Object.defineProperty(this,"distanceAttenuation",{get(){return this._distanceAttenuation},set(u){this._distanceAttenuation!==u&&(this._distanceAttenuation=u,this.ssrMaterial.defines.DISTANCE_ATTENUATION=u,this.ssrMaterial.needsUpdate=!0)}}),this._fresnel=Ya.defines.FRESNEL,Object.defineProperty(this,"fresnel",{get(){return this._fresnel},set(u){this._fresnel!==u&&(this._fresnel=u,this.ssrMaterial.defines.FRESNEL=u,this.ssrMaterial.needsUpdate=!0)}}),this._infiniteThick=Ya.defines.INFINITE_THICK,Object.defineProperty(this,"infiniteThick",{get(){return this._infiniteThick},set(u){this._infiniteThick!==u&&(this._infiniteThick=u,this.ssrMaterial.defines.INFINITE_THICK=u,this.ssrMaterial.needsUpdate=!0)}});const d=new Hf;d.type=V_,d.minFilter=$t,d.magFilter=$t,this.beautyRenderTarget=new Gt(this.width,this.height,{minFilter:$t,magFilter:$t,depthTexture:d,depthBuffer:!0}),this.prevRenderTarget=new Gt(this.width,this.height,{minFilter:$t,magFilter:$t}),this.normalRenderTarget=new Gt(this.width,this.height,{minFilter:$t,magFilter:$t,type:fn}),this.metalnessRenderTarget=new Gt(this.width,this.height,{minFilter:$t,magFilter:$t}),this.ssrRenderTarget=new Gt(this.width,this.height,{minFilter:$t,magFilter:$t}),this.blurRenderTarget=this.ssrRenderTarget.clone(),this.blurRenderTarget2=this.ssrRenderTarget.clone(),this.ssrMaterial=new Rt({defines:Object.assign({},Ya.defines,{MAX_STEP:Math.sqrt(this.width*this.width+this.height*this.height)}),uniforms:mi.clone(Ya.uniforms),vertexShader:Ya.vertexShader,fragmentShader:Ya.fragmentShader,blending:Kt}),this.ssrMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.ssrMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.ssrMaterial.defines.SELECTIVE=this.selective,this.ssrMaterial.needsUpdate=!0,this.ssrMaterial.uniforms.tMetalness.value=this.metalnessRenderTarget.texture,this.ssrMaterial.uniforms.tDepth.value=this.beautyRenderTarget.depthTexture,this.ssrMaterial.uniforms.cameraNear.value=this.camera.near,this.ssrMaterial.uniforms.cameraFar.value=this.camera.far,this.ssrMaterial.uniforms.thickness.value=this.thickness,this.ssrMaterial.uniforms.resolution.value.set(this.width,this.height),this.ssrMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssrMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.normalMaterial=new ap,this.normalMaterial.blending=Kt,this.metalnessOnMaterial=new Xn({color:"white"}),this.metalnessOffMaterial=new Xn({color:"black"}),this.blurMaterial=new Rt({defines:Object.assign({},zc.defines),uniforms:mi.clone(zc.uniforms),vertexShader:zc.vertexShader,fragmentShader:zc.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.blurMaterial.uniforms.resolution.value.set(this.width,this.height),this.blurMaterial2=new Rt({defines:Object.assign({},zc.defines),uniforms:mi.clone(zc.uniforms),vertexShader:zc.vertexShader,fragmentShader:zc.fragmentShader}),this.blurMaterial2.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.blurMaterial2.uniforms.resolution.value.set(this.width,this.height),this.depthRenderMaterial=new Rt({defines:Object.assign({},jw_defines),uniforms:mi.clone(jw_uniforms),vertexShader:jw_vertexShader,fragmentShader:jw_fragmentShader,blending:Kt}),this.depthRenderMaterial.uniforms.tDepth.value=this.beautyRenderTarget.depthTexture,this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.copyMaterial=new Rt({uniforms:mi.clone(Zr.uniforms),vertexShader:Zr.vertexShader,fragmentShader:Zr.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:uf,blendDst:O_,blendEquation:As,blendSrcAlpha:uf,blendDstAlpha:O_,blendEquationAlpha:As}),this.fsQuad=new wr(null),this.originalClearColor=new De}dispose(){this.beautyRenderTarget.dispose(),this.prevRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.metalnessRenderTarget.dispose(),this.ssrRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.blurRenderTarget2.dispose(),this.normalMaterial.dispose(),this.metalnessOnMaterial.dispose(),this.metalnessOffMaterial.dispose(),this.blurMaterial.dispose(),this.blurMaterial2.dispose(),this.copyMaterial.dispose(),this.depthRenderMaterial.dispose(),this.fsQuad.dispose()}render(t,n){switch(t.setRenderTarget(this.beautyRenderTarget),t.clear(),this.groundReflector&&(this.groundReflector.visible=!1,this.groundReflector.doRender(this.renderer,this.scene,this.camera),this.groundReflector.visible=!0),t.render(this.scene,this.camera),this.groundReflector&&(this.groundReflector.visible=!1),this.renderOverride(t,this.normalMaterial,this.normalRenderTarget,0,0),this.selective&&this.renderMetalness(t,this.metalnessOnMaterial,this.metalnessRenderTarget,0,0),this.ssrMaterial.uniforms.opacity.value=this.opacity,this.ssrMaterial.uniforms.maxDistance.value=this.maxDistance,this.ssrMaterial.uniforms.thickness.value=this.thickness,this.renderPass(t,this.ssrMaterial,this.ssrRenderTarget),this.blur&&(this.renderPass(t,this.blurMaterial,this.blurRenderTarget),this.renderPass(t,this.blurMaterial2,this.blurRenderTarget2)),this.output){case i.OUTPUT.Default:this.bouncing?(this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.prevRenderTarget),this.copyMaterial.uniforms.tDiffuse.value=this.blur?this.blurRenderTarget2.texture:this.ssrRenderTarget.texture,this.copyMaterial.blending=Ia,this.renderPass(t,this.copyMaterial,this.prevRenderTarget),this.copyMaterial.uniforms.tDiffuse.value=this.prevRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n)):(this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n),this.copyMaterial.uniforms.tDiffuse.value=this.blur?this.blurRenderTarget2.texture:this.ssrRenderTarget.texture,this.copyMaterial.blending=Ia,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n));break;case i.OUTPUT.SSR:this.copyMaterial.uniforms.tDiffuse.value=this.blur?this.blurRenderTarget2.texture:this.ssrRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n),this.bouncing&&(this.copyMaterial.uniforms.tDiffuse.value=this.blur?this.blurRenderTarget2.texture:this.beautyRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.prevRenderTarget),this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=Ia,this.renderPass(t,this.copyMaterial,this.prevRenderTarget));break;case i.OUTPUT.Beauty:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Depth:this.renderPass(t,this.depthRenderMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Normal:this.copyMaterial.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Metalness:this.copyMaterial.uniforms.tDiffuse.value=this.metalnessRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;default:console.warn("THREE.SSRPass: Unknown output type.")}}renderPass(t,n,r,s,o){this.originalClearColor.copy(t.getClearColor(this.tempColor));const a=t.getClearAlpha(this.tempColor),l=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,null!=s&&(t.setClearColor(s),t.setClearAlpha(o||0),t.clear()),this.fsQuad.material=n,this.fsQuad.render(t),t.autoClear=l,t.setClearColor(this.originalClearColor),t.setClearAlpha(a)}renderOverride(t,n,r,s,o){this.originalClearColor.copy(t.getClearColor(this.tempColor));const a=t.getClearAlpha(this.tempColor),l=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,o=n.clearAlpha||o,null!=(s=n.clearColor||s)&&(t.setClearColor(s),t.setClearAlpha(o||0),t.clear()),this.scene.overrideMaterial=n,t.render(this.scene,this.camera),this.scene.overrideMaterial=null,t.autoClear=l,t.setClearColor(this.originalClearColor),t.setClearAlpha(a)}renderMetalness(t,n,r,s,o){this.originalClearColor.copy(t.getClearColor(this.tempColor));const a=t.getClearAlpha(this.tempColor),l=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,o=n.clearAlpha||o,null!=(s=n.clearColor||s)&&(t.setClearColor(s),t.setClearAlpha(o||0),t.clear()),this.scene.traverseVisible(c=>{c._SSRPassBackupMaterial=c.material,c.material=this._selects.includes(c)?this.metalnessOnMaterial:this.metalnessOffMaterial}),t.render(this.scene,this.camera),this.scene.traverseVisible(c=>{c.material=c._SSRPassBackupMaterial}),t.autoClear=l,t.setClearColor(this.originalClearColor),t.setClearAlpha(a)}setSize(t,n){this.width=t,this.height=n,this.ssrMaterial.defines.MAX_STEP=Math.sqrt(t*t+n*n),this.ssrMaterial.needsUpdate=!0,this.beautyRenderTarget.setSize(t,n),this.prevRenderTarget.setSize(t,n),this.ssrRenderTarget.setSize(t,n),this.normalRenderTarget.setSize(t,n),this.metalnessRenderTarget.setSize(t,n),this.blurRenderTarget.setSize(t,n),this.blurRenderTarget2.setSize(t,n),this.ssrMaterial.uniforms.resolution.value.set(t,n),this.ssrMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssrMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.blurMaterial.uniforms.resolution.value.set(t,n),this.blurMaterial2.uniforms.resolution.value.set(t,n)}}return i.OUTPUT={Default:0,SSR:1,Beauty:3,Depth:4,Normal:5,Metalness:7},i})();class ig extends Hi{getType(){return Xme}set width(e){this._objRef&&(this._objRef.width=e)}set height(e){this._objRef&&(this._objRef.height=e)}set clear(e){this._objRef&&(this._objRef.clear=e)}set renderer(e){this._objRef&&(this._objRef.renderer=e)}set scene(e){this._objRef&&(this._objRef.scene=e)}set camera(e){this._objRef&&(this._objRef.camera=e)}set groundReflector(e){this._objRef&&(this._objRef.groundReflector=e)}set opacity(e){this._objRef&&(this._objRef.opacity=e)}set output(e){this._objRef&&(this._objRef.output=e)}set maxDistance(e){this._objRef&&(this._objRef.maxDistance=e)}set thickness(e){this._objRef&&(this._objRef.thickness=e)}set tempColor(e){this._objRef&&(this._objRef.tempColor=Qe(this._objRef.tempColor,e))}set selective(e){this._objRef&&(this._objRef.selective=e)}set blur(e){this._objRef&&(this._objRef.blur=e)}set thickTolerance(e){this._objRef&&(this._objRef.thickTolerance=e)}set beautyRenderTarget(e){this._objRef&&(this._objRef.beautyRenderTarget=e)}set prevRenderTarget(e){this._objRef&&(this._objRef.prevRenderTarget=e)}set normalRenderTarget(e){this._objRef&&(this._objRef.normalRenderTarget=e)}set metalnessRenderTarget(e){this._objRef&&(this._objRef.metalnessRenderTarget=e)}set ssrRenderTarget(e){this._objRef&&(this._objRef.ssrRenderTarget=e)}set blurRenderTarget(e){this._objRef&&(this._objRef.blurRenderTarget=e)}set blurRenderTarget2(e){this._objRef&&(this._objRef.blurRenderTarget2=e)}set ssrMaterial(e){this._objRef&&(this._objRef.ssrMaterial=e)}set normalMaterial(e){this._objRef&&(this._objRef.normalMaterial=e)}set metalnessOnMaterial(e){this._objRef&&(this._objRef.metalnessOnMaterial=e)}set metalnessOffMaterial(e){this._objRef&&(this._objRef.metalnessOffMaterial=e)}set blurMaterial(e){this._objRef&&(this._objRef.blurMaterial=e)}set blurMaterial2(e){this._objRef&&(this._objRef.blurMaterial2=e)}set depthRenderMaterial(e){this._objRef&&(this._objRef.depthRenderMaterial=e)}set copyMaterial(e){this._objRef&&(this._objRef.copyMaterial=e)}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}set originalClearColor(e){this._objRef&&(this._objRef.originalClearColor=Qe(this._objRef.originalClearColor,e))}set dispose(e){this._objRef&&(this._objRef.dispose=e)}set renderPass(e){this._objRef&&(this._objRef.renderPass=e)}set renderOverride(e){this._objRef&&(this._objRef.renderOverride=e)}set renderMetalness(e){this._objRef&&(this._objRef.renderMetalness=e)}}ig.\u0275fac=function(){let i;return function(t){return(i||(i=ce(ig)))(t||ig)}}(),ig.\u0275cmp=$({type:ig,selectors:[["th-sSRPass"]],inputs:{width:"width",height:"height",clear:"clear",renderer:"renderer",scene:"scene",camera:"camera",groundReflector:"groundReflector",opacity:"opacity",output:"output",maxDistance:"maxDistance",thickness:"thickness",tempColor:"tempColor",selective:"selective",blur:"blur",thickTolerance:"thickTolerance",beautyRenderTarget:"beautyRenderTarget",prevRenderTarget:"prevRenderTarget",normalRenderTarget:"normalRenderTarget",metalnessRenderTarget:"metalnessRenderTarget",ssrRenderTarget:"ssrRenderTarget",blurRenderTarget:"blurRenderTarget",blurRenderTarget2:"blurRenderTarget2",ssrMaterial:"ssrMaterial",normalMaterial:"normalMaterial",metalnessOnMaterial:"metalnessOnMaterial",metalnessOffMaterial:"metalnessOffMaterial",blurMaterial:"blurMaterial",blurMaterial2:"blurMaterial2",depthRenderMaterial:"depthRenderMaterial",copyMaterial:"copyMaterial",fsQuad:"fsQuad",originalClearColor:"originalClearColor",dispose:"dispose",renderPass:"renderPass",renderOverride:"renderOverride",renderMetalness:"renderMetalness"},features:[se([{provide:Pi,useExisting:le(()=>ig)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class eh extends Ms{getType(){return w4}set type(e){this._objRef&&(this._objRef.type=e)}set aspect(e){this._objRef&&(this._objRef.aspect=e)}set eyeSep(e){this._objRef&&(this._objRef.eyeSep=e)}set cameraL(e){this._objRef&&(this._objRef.cameraL=e)}set cameraR(e){this._objRef&&(this._objRef.cameraR=e)}}eh.\u0275fac=function(){let i;return function(t){return(i||(i=ce(eh)))(t||eh)}}(),eh.\u0275cmp=$({type:eh,selectors:[["th-stereoCamera"]],inputs:{type:"type",aspect:"aspect",eyeSep:"eyeSep",cameraL:"cameraL",cameraR:"cameraR"},features:[se([{provide:Ye,useExisting:le(()=>eh)},{provide:Ms,useExisting:le(()=>eh)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Yme extends fH{constructor(e,t,n,r){super(e,t,n,r),this.sampleLevel=0,this.accumulate=!1}render(e,t,n,r){if(!1===this.accumulate)return super.render(e,t,n,r),void(this.accumulateIndex=-1);const s=Zme[5];void 0===this.sampleRenderTarget&&(this.sampleRenderTarget=new Gt(n.width,n.height,this.params),this.sampleRenderTarget.texture.name="TAARenderPass.sample"),void 0===this.holdRenderTarget&&(this.holdRenderTarget=new Gt(n.width,n.height,this.params),this.holdRenderTarget.texture.name="TAARenderPass.hold"),-1===this.accumulateIndex&&(super.render(e,this.holdRenderTarget,n,r),this.accumulateIndex=0);const o=e.autoClear;e.autoClear=!1;const a=1/s.length;if(this.accumulateIndex>=0&&this.accumulateIndex<s.length){this.copyUniforms.opacity.value=a,this.copyUniforms.tDiffuse.value=t.texture;const c=Math.pow(2,this.sampleLevel);for(let d=0;d<c;d++){const h=s[this.accumulateIndex];if(this.camera.setViewOffset&&this.camera.setViewOffset(n.width,n.height,.0625*h[0],.0625*h[1],n.width,n.height),e.setRenderTarget(t),e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(this.sampleRenderTarget),0===this.accumulateIndex&&e.clear(),this.fsQuad.render(e),this.accumulateIndex++,this.accumulateIndex>=s.length)break}this.camera.clearViewOffset&&this.camera.clearViewOffset()}const l=this.accumulateIndex*a;l>0&&(this.copyUniforms.opacity.value=1,this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture,e.setRenderTarget(t),e.clear(),this.fsQuad.render(e)),l<1&&(this.copyUniforms.opacity.value=1-l,this.copyUniforms.tDiffuse.value=this.holdRenderTarget.texture,e.setRenderTarget(t),0===l&&e.clear(),this.fsQuad.render(e)),e.autoClear=o}dispose(){super.dispose(),void 0!==this.sampleRenderTarget&&this.sampleRenderTarget.dispose(),void 0!==this.holdRenderTarget&&this.holdRenderTarget.dispose()}}const Zme=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]];class ng extends Ju{getType(){return Yme}set accumulate(e){this._objRef&&(this._objRef.accumulate=e)}}ng.\u0275fac=function(){let i;return function(t){return(i||(i=ce(ng)))(t||ng)}}(),ng.\u0275cmp=$({type:ng,selectors:[["th-tAARenderPass"]],inputs:{accumulate:"accumulate"},features:[se([{provide:Pi,useExisting:le(()=>ng)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Kme extends xt{constructor(e=50,t=10,n=!0,r=!0,s=!0,o=!0,a=!0){const l=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,3,16,17,18,7,19,20,21,11,22,23,24,15,25,26,27,18,28,29,30,21,31,32,33,24,34,35,36,27,37,38,39,30,40,41,0,33,42,43,4,36,44,45,8,39,46,47,12,12,13,14,15,48,49,50,51,52,53,54,55,56,57,58,59,15,25,26,27,51,60,61,62,55,63,64,65,59,66,67,68,27,37,38,39,62,69,70,71,65,72,73,74,68,75,76,77,39,46,47,12,71,78,79,48,74,80,81,52,77,82,83,56,56,57,58,59,84,85,86,87,88,89,90,91,92,93,94,95,59,66,67,68,87,96,97,98,91,99,100,101,95,102,103,104,68,75,76,77,98,105,106,107,101,108,109,110,104,111,112,113,77,82,83,56,107,114,115,84,110,116,117,88,113,118,119,92,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,123,136,137,120,127,138,139,124,131,140,141,128,135,142,143,132,132,133,134,135,144,145,146,147,148,149,150,151,68,152,153,154,135,142,143,132,147,155,156,144,151,157,158,148,154,159,160,68,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,164,177,178,161,168,179,180,165,172,181,182,169,176,183,184,173,173,174,175,176,185,186,187,188,189,190,191,192,193,194,195,196,176,183,184,173,188,197,198,185,192,199,200,189,196,201,202,193,203,203,203,203,204,205,206,207,208,208,208,208,209,210,211,212,203,203,203,203,207,213,214,215,208,208,208,208,212,216,217,218,203,203,203,203,215,219,220,221,208,208,208,208,218,222,223,224,203,203,203,203,221,225,226,204,208,208,208,208,224,227,228,209,209,210,211,212,229,230,231,232,233,234,235,236,237,238,239,240,212,216,217,218,232,241,242,243,236,244,245,246,240,247,248,249,218,222,223,224,243,250,251,252,246,253,254,255,249,256,257,258,224,227,228,209,252,259,260,229,255,261,262,233,258,263,264,237,265,265,265,265,266,267,268,269,270,271,272,273,92,119,118,113,265,265,265,265,269,274,275,276,273,277,278,279,113,112,111,104,265,265,265,265,276,280,281,282,279,283,284,285,104,103,102,95,265,265,265,265,282,286,287,266,285,288,289,270,95,94,93,92],c=[1.4,0,2.4,1.4,-.784,2.4,.784,-1.4,2.4,0,-1.4,2.4,1.3375,0,2.53125,1.3375,-.749,2.53125,.749,-1.3375,2.53125,0,-1.3375,2.53125,1.4375,0,2.53125,1.4375,-.805,2.53125,.805,-1.4375,2.53125,0,-1.4375,2.53125,1.5,0,2.4,1.5,-.84,2.4,.84,-1.5,2.4,0,-1.5,2.4,-.784,-1.4,2.4,-1.4,-.784,2.4,-1.4,0,2.4,-.749,-1.3375,2.53125,-1.3375,-.749,2.53125,-1.3375,0,2.53125,-.805,-1.4375,2.53125,-1.4375,-.805,2.53125,-1.4375,0,2.53125,-.84,-1.5,2.4,-1.5,-.84,2.4,-1.5,0,2.4,-1.4,.784,2.4,-.784,1.4,2.4,0,1.4,2.4,-1.3375,.749,2.53125,-.749,1.3375,2.53125,0,1.3375,2.53125,-1.4375,.805,2.53125,-.805,1.4375,2.53125,0,1.4375,2.53125,-1.5,.84,2.4,-.84,1.5,2.4,0,1.5,2.4,.784,1.4,2.4,1.4,.784,2.4,.749,1.3375,2.53125,1.3375,.749,2.53125,.805,1.4375,2.53125,1.4375,.805,2.53125,.84,1.5,2.4,1.5,.84,2.4,1.75,0,1.875,1.75,-.98,1.875,.98,-1.75,1.875,0,-1.75,1.875,2,0,1.35,2,-1.12,1.35,1.12,-2,1.35,0,-2,1.35,2,0,.9,2,-1.12,.9,1.12,-2,.9,0,-2,.9,-.98,-1.75,1.875,-1.75,-.98,1.875,-1.75,0,1.875,-1.12,-2,1.35,-2,-1.12,1.35,-2,0,1.35,-1.12,-2,.9,-2,-1.12,.9,-2,0,.9,-1.75,.98,1.875,-.98,1.75,1.875,0,1.75,1.875,-2,1.12,1.35,-1.12,2,1.35,0,2,1.35,-2,1.12,.9,-1.12,2,.9,0,2,.9,.98,1.75,1.875,1.75,.98,1.875,1.12,2,1.35,2,1.12,1.35,1.12,2,.9,2,1.12,.9,2,0,.45,2,-1.12,.45,1.12,-2,.45,0,-2,.45,1.5,0,.225,1.5,-.84,.225,.84,-1.5,.225,0,-1.5,.225,1.5,0,.15,1.5,-.84,.15,.84,-1.5,.15,0,-1.5,.15,-1.12,-2,.45,-2,-1.12,.45,-2,0,.45,-.84,-1.5,.225,-1.5,-.84,.225,-1.5,0,.225,-.84,-1.5,.15,-1.5,-.84,.15,-1.5,0,.15,-2,1.12,.45,-1.12,2,.45,0,2,.45,-1.5,.84,.225,-.84,1.5,.225,0,1.5,.225,-1.5,.84,.15,-.84,1.5,.15,0,1.5,.15,1.12,2,.45,2,1.12,.45,.84,1.5,.225,1.5,.84,.225,.84,1.5,.15,1.5,.84,.15,-1.6,0,2.025,-1.6,-.3,2.025,-1.5,-.3,2.25,-1.5,0,2.25,-2.3,0,2.025,-2.3,-.3,2.025,-2.5,-.3,2.25,-2.5,0,2.25,-2.7,0,2.025,-2.7,-.3,2.025,-3,-.3,2.25,-3,0,2.25,-2.7,0,1.8,-2.7,-.3,1.8,-3,-.3,1.8,-3,0,1.8,-1.5,.3,2.25,-1.6,.3,2.025,-2.5,.3,2.25,-2.3,.3,2.025,-3,.3,2.25,-2.7,.3,2.025,-3,.3,1.8,-2.7,.3,1.8,-2.7,0,1.575,-2.7,-.3,1.575,-3,-.3,1.35,-3,0,1.35,-2.5,0,1.125,-2.5,-.3,1.125,-2.65,-.3,.9375,-2.65,0,.9375,-2,-.3,.9,-1.9,-.3,.6,-1.9,0,.6,-3,.3,1.35,-2.7,.3,1.575,-2.65,.3,.9375,-2.5,.3,1.125,-1.9,.3,.6,-2,.3,.9,1.7,0,1.425,1.7,-.66,1.425,1.7,-.66,.6,1.7,0,.6,2.6,0,1.425,2.6,-.66,1.425,3.1,-.66,.825,3.1,0,.825,2.3,0,2.1,2.3,-.25,2.1,2.4,-.25,2.025,2.4,0,2.025,2.7,0,2.4,2.7,-.25,2.4,3.3,-.25,2.4,3.3,0,2.4,1.7,.66,.6,1.7,.66,1.425,3.1,.66,.825,2.6,.66,1.425,2.4,.25,2.025,2.3,.25,2.1,3.3,.25,2.4,2.7,.25,2.4,2.8,0,2.475,2.8,-.25,2.475,3.525,-.25,2.49375,3.525,0,2.49375,2.9,0,2.475,2.9,-.15,2.475,3.45,-.15,2.5125,3.45,0,2.5125,2.8,0,2.4,2.8,-.15,2.4,3.2,-.15,2.4,3.2,0,2.4,3.525,.25,2.49375,2.8,.25,2.475,3.45,.15,2.5125,2.9,.15,2.475,3.2,.15,2.4,2.8,.15,2.4,0,0,3.15,.8,0,3.15,.8,-.45,3.15,.45,-.8,3.15,0,-.8,3.15,0,0,2.85,.2,0,2.7,.2,-.112,2.7,.112,-.2,2.7,0,-.2,2.7,-.45,-.8,3.15,-.8,-.45,3.15,-.8,0,3.15,-.112,-.2,2.7,-.2,-.112,2.7,-.2,0,2.7,-.8,.45,3.15,-.45,.8,3.15,0,.8,3.15,-.2,.112,2.7,-.112,.2,2.7,0,.2,2.7,.45,.8,3.15,.8,.45,3.15,.112,.2,2.7,.2,.112,2.7,.4,0,2.55,.4,-.224,2.55,.224,-.4,2.55,0,-.4,2.55,1.3,0,2.55,1.3,-.728,2.55,.728,-1.3,2.55,0,-1.3,2.55,1.3,0,2.4,1.3,-.728,2.4,.728,-1.3,2.4,0,-1.3,2.4,-.224,-.4,2.55,-.4,-.224,2.55,-.4,0,2.55,-.728,-1.3,2.55,-1.3,-.728,2.55,-1.3,0,2.55,-.728,-1.3,2.4,-1.3,-.728,2.4,-1.3,0,2.4,-.4,.224,2.55,-.224,.4,2.55,0,.4,2.55,-1.3,.728,2.55,-.728,1.3,2.55,0,1.3,2.55,-1.3,.728,2.4,-.728,1.3,2.4,0,1.3,2.4,.224,.4,2.55,.4,.224,2.55,.728,1.3,2.55,1.3,.728,2.55,.728,1.3,2.4,1.3,.728,2.4,0,0,0,1.425,0,0,1.425,.798,0,.798,1.425,0,0,1.425,0,1.5,0,.075,1.5,.84,.075,.84,1.5,.075,0,1.5,.075,-.798,1.425,0,-1.425,.798,0,-1.425,0,0,-.84,1.5,.075,-1.5,.84,.075,-1.5,0,.075,-1.425,-.798,0,-.798,-1.425,0,0,-1.425,0,-1.5,-.84,.075,-.84,-1.5,.075,0,-1.5,.075,.798,-1.425,0,1.425,-.798,0,.84,-1.5,.075,1.5,-.84,.075];super(),t=Math.max(2,Math.floor(t));const h=3.15*(a?1:1.3)/2,f=e/h;let m=n?(8*t-4)*t:0;m+=r?(16*t-4)*t:0,m+=s?40*t*t:0;const p=new Uint32Array(3*m);let g=n?4:0;g+=r?8:0,g+=s?20:0,g*=(t+1)*(t+1);const _=new Float32Array(3*g),v=new Float32Array(3*g),b=new Float32Array(2*g),y=new Ve;y.set(-1,3,-3,1,3,-6,3,0,-3,3,0,0,1,0,0,0);const x=[],C=[],M=[],w=[],E=[],I=[],F=[],Q=[],B=[],L=new T;let X,P,V,O,q=0,ee=0;const Z=new T,Y=new Ve,he=new Ve,J=new ni,ae=new ni,G=new ni,U=new ni,de=new T,Ee=new T,we=y.clone();we.transpose();const et=(St,ft,N)=>!(_[3*St]===_[3*ft]&&_[3*St+1]===_[3*ft+1]&&_[3*St+2]===_[3*ft+2]||_[3*St]===_[3*N]&&_[3*St+1]===_[3*N+1]&&_[3*St+2]===_[3*N+2]||_[3*ft]===_[3*N]&&_[3*ft+1]===_[3*N+1]&&_[3*ft+2]===_[3*N+2]);for(let St=0;St<3;St++)I[St]=new Ve;const xe=n?32:28,Pe=t+1;let $e=0,We=0,yt=0,ht=0,ot=0;for(let St=s?0:20;St<xe;St++)if(r||St<20||St>=28){for(let ft=0;ft<3;ft++){for(let N=0;N<4;N++)for(let k=0;k<4;k++)x[4*k+N]=c[3*l[16*St+4*N+k]+ft],o&&St>=20&&St<28&&2!==ft&&(x[4*k+N]*=1.077),!a&&2===ft&&(x[4*k+N]*=1.3);Y.set(x[0],x[1],x[2],x[3],x[4],x[5],x[6],x[7],x[8],x[9],x[10],x[11],x[12],x[13],x[14],x[15]),he.multiplyMatrices(Y,y),I[ft].multiplyMatrices(we,he)}for(let ft=0;ft<=t;ft++){const N=ft/t;for(let k=0;k<=t;k++){const _e=k/t;for(O=4,P=V=1;O--;)C[O]=P,M[O]=V,P*=N,V*=_e,3===O?(w[O]=E[O]=0,q=ee=1):(w[O]=q*(3-O),E[O]=ee*(3-O),q*=N,ee*=_e);J.fromArray(C),ae.fromArray(M),G.fromArray(w),U.fromArray(E);for(let Se=0;Se<3;Se++)X=J.clone(),X.applyMatrix4(I[Se]),F[Se]=X.dot(ae),X=G.clone(),X.applyMatrix4(I[Se]),Q[Se]=X.dot(ae),X=J.clone(),X.applyMatrix4(I[Se]),B[Se]=X.dot(U);de.fromArray(Q),Ee.fromArray(B),L.crossVectors(Ee,de),L.normalize(),0===F[0]&&0===F[1]?Z.set(0,F[2]>h?1:-1,0):Z.set(L.x,L.z,-L.y),_[We++]=f*F[0],_[We++]=f*(F[2]-h),_[We++]=-f*F[1],v[yt++]=Z.x,v[yt++]=Z.y,v[yt++]=Z.z,b[ht++]=1-_e,b[ht++]=1-N}}for(let ft=0;ft<t;ft++)for(let N=0;N<t;N++){const k=$e*Pe*Pe+ft*Pe+N,_e=k+1,Se=_e+Pe,Ue=k+Pe;et(k,_e,Se)&&(p[ot++]=k,p[ot++]=_e,p[ot++]=Se),et(k,Se,Ue)&&(p[ot++]=k,p[ot++]=Se,p[ot++]=Ue)}$e++}this.setIndex(new Ci(p,1)),this.setAttribute("position",new Ci(_,3)),this.setAttribute("normal",new Ci(v,3)),this.setAttribute("uv",new Ci(b,2)),this.computeBoundingSphere()}}class rg extends Mt{getType(){return Kme}}rg.\u0275fac=function(){let i;return function(t){return(i||(i=ce(rg)))(t||rg)}}(),rg.\u0275cmp=$({type:rg,selectors:[["th-teapotGeometry"]],features:[se([{provide:Mt,useExisting:le(()=>rg)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class sg extends qa{getType(){return rp}set type(e){this._objRef&&(this._objRef.type=e)}}sg.\u0275fac=function(){let i;return function(t){return(i||(i=ce(sg)))(t||sg)}}(),sg.\u0275cmp=$({type:sg,selectors:[["th-tetrahedronGeometry"]],inputs:{type:"type"},features:[se([{provide:Mt,useExisting:le(()=>sg)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class $me extends iu{constructor(e,t={}){const n=t.font;if(void 0===n)super();else{const r=n.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),super(r,t)}this.type="TextGeometry"}}class og extends zu{getType(){return $me}set type(e){this._objRef&&(this._objRef.type=e)}set parameters(e){this._objRef&&(this._objRef.parameters=e)}}og.\u0275fac=function(){let i;return function(t){return(i||(i=ce(og)))(t||og)}}(),og.\u0275cmp=$({type:og,selectors:[["th-textGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[se([{provide:Mt,useExisting:le(()=>og)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Jme extends vn{constructor(e,t){super();const n=Zr;this.map=e,this.opacity=void 0!==t?t:1,this.uniforms=mi.clone(n.uniforms),this.material=new Rt({uniforms:this.uniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,depthTest:!1,depthWrite:!1}),this.needsSwap=!1,this.fsQuad=new wr(null)}render(e,t,n){const r=e.autoClear;e.autoClear=!1,this.fsQuad.material=this.material,this.uniforms.opacity.value=this.opacity,this.uniforms.tDiffuse.value=this.map,this.material.transparent=this.opacity<1,e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(),this.fsQuad.render(e),e.autoClear=r}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class ag extends Hi{getType(){return Jme}set map(e){this._objRef&&(this._objRef.map=e)}set opacity(e){this._objRef&&(this._objRef.opacity=e)}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}set material(e){this._objRef&&(this._objRef.material=e)}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}}ag.\u0275fac=function(){let i;return function(t){return(i||(i=ce(ag)))(t||ag)}}(),ag.\u0275cmp=$({type:ag,selectors:[["th-texturePass"]],inputs:{map:"map",opacity:"opacity",uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[se([{provide:Pi,useExisting:le(()=>ag)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class lg extends Mt{getType(){return na}set type(e){this._objRef&&(this._objRef.type=e)}set parameters(e){this._objRef&&(this._objRef.parameters=e)}}lg.\u0275fac=function(){let i;return function(t){return(i||(i=ce(lg)))(t||lg)}}(),lg.\u0275cmp=$({type:lg,selectors:[["th-torusGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[se([{provide:Mt,useExisting:le(()=>lg)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class cg extends Mt{getType(){return sp}set type(e){this._objRef&&(this._objRef.type=e)}set parameters(e){this._objRef&&(this._objRef.parameters=e)}}cg.\u0275fac=function(){let i;return function(t){return(i||(i=ce(cg)))(t||cg)}}(),cg.\u0275cmp=$({type:cg,selectors:[["th-torusKnotGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[se([{provide:Mt,useExisting:le(()=>cg)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const JR={type:"change"},eD={type:"start"},tD={type:"end"};class ege extends os{constructor(e,t){super();const n=this;this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:yo.ROTATE,MIDDLE:yo.DOLLY,RIGHT:yo.PAN},this.target=new T;const s=1e-6,o=new T;let a=1,l=-1,c=-1,d=0,u=0,h=0;const f=new T,m=new ue,p=new ue,g=new T,_=new ue,v=new ue,b=new ue,y=new ue,x=[],C={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const U=n.domElement.getBoundingClientRect(),de=n.domElement.ownerDocument.documentElement;n.screen.left=U.left+window.pageXOffset-de.clientLeft,n.screen.top=U.top+window.pageYOffset-de.clientTop,n.screen.width=U.width,n.screen.height=U.height};const M=function(){const U=new ue;return function(Ee,we){return U.set((Ee-n.screen.left)/n.screen.width,(we-n.screen.top)/n.screen.height),U}}(),w=function(){const U=new ue;return function(Ee,we){return U.set((Ee-.5*n.screen.width-n.screen.left)/(.5*n.screen.width),(n.screen.height+2*(n.screen.top-we))/n.screen.width),U}}();function E(U){!1!==n.enabled&&(0===x.length&&(n.domElement.setPointerCapture(U.pointerId),n.domElement.addEventListener("pointermove",I),n.domElement.addEventListener("pointerup",F)),function he(U){x.push(U)}(U),"touch"===U.pointerType?function q(U){if(1===(ae(U),x.length))l=3,p.copy(w(x[0].pageX,x[0].pageY)),m.copy(p);else{l=4;const de=x[0].pageX-x[1].pageX,Ee=x[0].pageY-x[1].pageY;u=d=Math.sqrt(de*de+Ee*Ee),b.copy(M((x[0].pageX+x[1].pageX)/2,(x[0].pageY+x[1].pageY)/2)),y.copy(b)}n.dispatchEvent(eD)}(U):function X(U){if(-1===l)switch(U.button){case n.mouseButtons.LEFT:l=0;break;case n.mouseButtons.MIDDLE:l=1;break;case n.mouseButtons.RIGHT:l=2}const de=-1!==c?c:l;0!==de||n.noRotate?1!==de||n.noZoom?2===de&&!n.noPan&&(b.copy(M(U.pageX,U.pageY)),y.copy(b)):(_.copy(M(U.pageX,U.pageY)),v.copy(_)):(p.copy(w(U.pageX,U.pageY)),m.copy(p)),n.dispatchEvent(eD)}(U))}function I(U){!1!==n.enabled&&("touch"===U.pointerType?function ee(U){if(1===(ae(U),x.length))m.copy(p),p.copy(w(U.pageX,U.pageY));else{const de=function G(U){return C[(U.pointerId===x[0].pointerId?x[1]:x[0]).pointerId]}(U),Ee=U.pageX-de.x,we=U.pageY-de.y;u=Math.sqrt(Ee*Ee+we*we),y.copy(M((U.pageX+de.x)/2,(U.pageY+de.y)/2))}}(U):function P(U){const de=-1!==c?c:l;0!==de||n.noRotate?1!==de||n.noZoom?2===de&&!n.noPan&&y.copy(M(U.pageX,U.pageY)):v.copy(M(U.pageX,U.pageY)):(m.copy(p),p.copy(w(U.pageX,U.pageY)))}(U))}function F(U){!1!==n.enabled&&("touch"===U.pointerType?function Z(U){switch(x.length){case 0:l=-1;break;case 1:l=3,p.copy(w(U.pageX,U.pageY)),m.copy(p);break;case 2:l=4;for(let de=0;de<x.length;de++)if(x[de].pointerId!==U.pointerId){const Ee=C[x[de].pointerId];p.copy(w(Ee.x,Ee.y)),m.copy(p);break}}n.dispatchEvent(tD)}(U):function V(){l=-1,n.dispatchEvent(tD)}(),J(U),0===x.length&&(n.domElement.releasePointerCapture(U.pointerId),n.domElement.removeEventListener("pointermove",I),n.domElement.removeEventListener("pointerup",F)))}function Q(U){J(U)}function B(U){!1!==n.enabled&&(window.removeEventListener("keydown",B),-1===c&&(U.code!==n.keys[0]||n.noRotate?U.code!==n.keys[1]||n.noZoom?U.code===n.keys[2]&&!n.noPan&&(c=2):c=1:c=0))}function L(){!1!==n.enabled&&(c=-1,window.addEventListener("keydown",B))}function O(U){if(!1!==n.enabled&&!0!==n.noZoom){switch(U.preventDefault(),U.deltaMode){case 2:_.y-=.025*U.deltaY;break;case 1:_.y-=.01*U.deltaY;break;default:_.y-=25e-5*U.deltaY}n.dispatchEvent(eD),n.dispatchEvent(tD)}}function Y(U){!1!==n.enabled&&U.preventDefault()}function J(U){delete C[U.pointerId];for(let de=0;de<x.length;de++)if(x[de].pointerId==U.pointerId)return void x.splice(de,1)}function ae(U){let de=C[U.pointerId];void 0===de&&(de=new ue,C[U.pointerId]=de),de.set(U.pageX,U.pageY)}this.rotateCamera=function(){const U=new T,de=new xi,Ee=new T,we=new T,et=new T,Ae=new T;return function(){Ae.set(p.x-m.x,p.y-m.y,0);let Pe=Ae.length();Pe?(f.copy(n.object.position).sub(n.target),Ee.copy(f).normalize(),we.copy(n.object.up).normalize(),et.crossVectors(we,Ee).normalize(),we.setLength(p.y-m.y),et.setLength(p.x-m.x),Ae.copy(we.add(et)),U.crossVectors(Ae,f).normalize(),Pe*=n.rotateSpeed,de.setFromAxisAngle(U,Pe),f.applyQuaternion(de),n.object.up.applyQuaternion(de),g.copy(U),h=Pe):!n.staticMoving&&h&&(h*=Math.sqrt(1-n.dynamicDampingFactor),f.copy(n.object.position).sub(n.target),de.setFromAxisAngle(g,h),f.applyQuaternion(de),n.object.up.applyQuaternion(de)),m.copy(p)}}(),this.zoomCamera=function(){let U;4===l?(U=d/u,d=u,n.object.isPerspectiveCamera?f.multiplyScalar(U):n.object.isOrthographicCamera?(n.object.zoom/=U,n.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(U=1+(v.y-_.y)*n.zoomSpeed,1!==U&&U>0&&(n.object.isPerspectiveCamera?f.multiplyScalar(U):n.object.isOrthographicCamera?(n.object.zoom/=U,n.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),n.staticMoving?_.copy(v):_.y+=(v.y-_.y)*this.dynamicDampingFactor)},this.panCamera=function(){const U=new ue,de=new T,Ee=new T;return function(){if(U.copy(y).sub(b),U.lengthSq()){if(n.object.isOrthographicCamera){const Ae=(n.object.top-n.object.bottom)/n.object.zoom/n.domElement.clientWidth;U.x*=(n.object.right-n.object.left)/n.object.zoom/n.domElement.clientWidth,U.y*=Ae}U.multiplyScalar(f.length()*n.panSpeed),Ee.copy(f).cross(n.object.up).setLength(U.x),Ee.add(de.copy(n.object.up).setLength(U.y)),n.object.position.add(Ee),n.target.add(Ee),n.staticMoving?b.copy(y):b.add(U.subVectors(y,b).multiplyScalar(n.dynamicDampingFactor))}}}(),this.checkDistances=function(){(!n.noZoom||!n.noPan)&&(f.lengthSq()>n.maxDistance*n.maxDistance&&(n.object.position.addVectors(n.target,f.setLength(n.maxDistance)),_.copy(v)),f.lengthSq()<n.minDistance*n.minDistance&&(n.object.position.addVectors(n.target,f.setLength(n.minDistance)),_.copy(v)))},this.update=function(){f.subVectors(n.object.position,n.target),n.noRotate||n.rotateCamera(),n.noZoom||n.zoomCamera(),n.noPan||n.panCamera(),n.object.position.addVectors(n.target,f),n.object.isPerspectiveCamera?(n.checkDistances(),n.object.lookAt(n.target),o.distanceToSquared(n.object.position)>s&&(n.dispatchEvent(JR),o.copy(n.object.position))):n.object.isOrthographicCamera?(n.object.lookAt(n.target),(o.distanceToSquared(n.object.position)>s||a!==n.object.zoom)&&(n.dispatchEvent(JR),o.copy(n.object.position),a=n.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){l=-1,c=-1,n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.up.copy(n.up0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),f.subVectors(n.object.position,n.target),n.object.lookAt(n.target),n.dispatchEvent(JR),o.copy(n.object.position),a=n.object.zoom},this.dispose=function(){n.domElement.removeEventListener("contextmenu",Y),n.domElement.removeEventListener("pointerdown",E),n.domElement.removeEventListener("pointercancel",Q),n.domElement.removeEventListener("wheel",O),n.domElement.removeEventListener("pointermove",I),n.domElement.removeEventListener("pointerup",F),window.removeEventListener("keydown",B),window.removeEventListener("keyup",L)},this.domElement.addEventListener("contextmenu",Y),this.domElement.addEventListener("pointerdown",E),this.domElement.addEventListener("pointercancel",Q),this.domElement.addEventListener("wheel",O,{passive:!1}),window.addEventListener("keydown",B),window.addEventListener("keyup",L),this.handleResize(),this.update()}}class th extends zn{getType(){return ege}set object(e){this._objRef&&(this._objRef.object=e)}set domElement(e){this._objRef&&(this._objRef.domElement=e)}set enabled(e){this._objRef&&(this._objRef.enabled=e)}set screen(e){this._objRef&&(this._objRef.screen=e)}set rotateSpeed(e){this._objRef&&(this._objRef.rotateSpeed=e)}set zoomSpeed(e){this._objRef&&(this._objRef.zoomSpeed=e)}set panSpeed(e){this._objRef&&(this._objRef.panSpeed=e)}set noRotate(e){this._objRef&&(this._objRef.noRotate=e)}set noZoom(e){this._objRef&&(this._objRef.noZoom=e)}set noPan(e){this._objRef&&(this._objRef.noPan=e)}set noRoll(e){this._objRef&&(this._objRef.noRoll=e)}set staticMoving(e){this._objRef&&(this._objRef.staticMoving=e)}set dynamicDampingFactor(e){this._objRef&&(this._objRef.dynamicDampingFactor=e)}set minDistance(e){this._objRef&&(this._objRef.minDistance=e)}set maxDistance(e){this._objRef&&(this._objRef.maxDistance=e)}set keys(e){this._objRef&&(this._objRef.keys=e)}set mouseButtons(e){this._objRef&&(this._objRef.mouseButtons=e)}set target(e){this._objRef&&(this._objRef.target=Qe(this._objRef.target,e))}set position0(e){this._objRef&&(this._objRef.position0=Qe(this._objRef.position0,e))}set target0(e){this._objRef&&(this._objRef.target0=Qe(this._objRef.target0,e))}set up0(e){this._objRef&&(this._objRef.up0=Qe(this._objRef.up0,e))}}th.\u0275fac=function(){let i;return function(t){return(i||(i=ce(th)))(t||th)}}(),th.\u0275cmp=$({type:th,selectors:[["th-trackballControls"]],inputs:{object:"object",domElement:"domElement",enabled:"enabled",screen:"screen",rotateSpeed:"rotateSpeed",zoomSpeed:"zoomSpeed",panSpeed:"panSpeed",noRotate:"noRotate",noZoom:"noZoom",noPan:"noPan",noRoll:"noRoll",staticMoving:"staticMoving",dynamicDampingFactor:"dynamicDampingFactor",minDistance:"minDistance",maxDistance:"maxDistance",keys:"keys",mouseButtons:"mouseButtons",target:"target",position0:"position0",target0:"target0",up0:"up0"},features:[se([{provide:zn,useExisting:le(()=>th)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class dg extends Mt{getType(){return op}set type(e){this._objRef&&(this._objRef.type=e)}set parameters(e){this._objRef&&(this._objRef.parameters=e)}set tangents(e){this._objRef&&(this._objRef.tangents=e)}set normals(e){this._objRef&&(this._objRef.normals=e)}set binormals(e){this._objRef&&(this._objRef.binormals=e)}}dg.\u0275fac=function(){let i;return function(t){return(i||(i=ce(dg)))(t||dg)}}(),dg.\u0275cmp=$({type:dg,selectors:[["th-tubeGeometry"]],inputs:{type:"type",parameters:"parameters",tangents:"tangents",normals:"normals",binormals:"binormals"},features:[se([{provide:Mt,useExisting:le(()=>dg)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});const tge={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new De(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};class ug extends vn{constructor(e,t,n,r){super(),this.strength=void 0!==t?t:1,this.radius=n,this.threshold=r,this.resolution=void 0!==e?new ue(e.x,e.y):new ue(256,256),this.clearColor=new De(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);this.renderTargetBright=new Gt(s,o),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let u=0;u<this.nMips;u++){const h=new Gt(s,o);h.texture.name="UnrealBloomPass.h"+u,h.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(h);const f=new Gt(s,o);f.texture.name="UnrealBloomPass.v"+u,f.texture.generateMipmaps=!1,this.renderTargetsVertical.push(f),s=Math.round(s/2),o=Math.round(o/2)}const a=tge;this.highPassUniforms=mi.clone(a.uniforms),this.highPassUniforms.luminosityThreshold.value=r,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new Rt({uniforms:this.highPassUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const l=[3,5,7,9,11];s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);for(let u=0;u<this.nMips;u++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(l[u])),this.separableBlurMaterials[u].uniforms.texSize.value=new ue(s,o),s=Math.round(s/2),o=Math.round(o/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new T(1,1,1),new T(1,1,1),new T(1,1,1),new T(1,1,1),new T(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const d=Zr;this.copyUniforms=mi.clone(d.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new Rt({uniforms:this.copyUniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,blending:lf,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new De,this.oldClearAlpha=1,this.basic=new Xn,this.fsQuad=new wr(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose();for(let e=0;e<this.separableBlurMaterials.length;e++)this.separableBlurMaterials[e].dispose();this.compositeMaterial.dispose(),this.materialCopy.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(e,t){let n=Math.round(e/2),r=Math.round(t/2);this.renderTargetBright.setSize(n,r);for(let s=0;s<this.nMips;s++)this.renderTargetsHorizontal[s].setSize(n,r),this.renderTargetsVertical[s].setSize(n,r),this.separableBlurMaterials[s].uniforms.texSize.value=new ue(n,r),n=Math.round(n/2),r=Math.round(r/2)}render(e,t,n,r,s){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),s&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=n.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=n.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let a=this.renderTargetBright;for(let l=0;l<this.nMips;l++)this.fsQuad.material=this.separableBlurMaterials[l],this.separableBlurMaterials[l].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[l].uniforms.direction.value=ug.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[l]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[l].uniforms.colorTexture.value=this.renderTargetsHorizontal[l].texture,this.separableBlurMaterials[l].uniforms.direction.value=ug.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[l]),e.clear(),this.fsQuad.render(e),a=this.renderTargetsVertical[l];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,s&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(n),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}getSeperableBlurMaterial(e){return new Rt({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new ue(.5,.5)},direction:{value:new ue(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat fSigma = float(SIGMA);\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}getCompositeMaterial(e){return new Rt({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}}ug.BlurDirectionX=new ue(1,0),ug.BlurDirectionY=new ue(0,1);class Hc extends Hi{getType(){return ug}set resolution(e){this._objRef&&(this._objRef.resolution=Qe(this._objRef.resolution,e))}set strength(e){this._objRef&&(this._objRef.strength=e)}set radius(e){this._objRef&&(this._objRef.radius=e)}set threshold(e){this._objRef&&(this._objRef.threshold=e)}set clearColor(e){this._objRef&&(this._objRef.clearColor=Qe(this._objRef.clearColor,e))}set renderTargetsHorizontal(e){this._objRef&&(this._objRef.renderTargetsHorizontal=e)}set renderTargetsVertical(e){this._objRef&&(this._objRef.renderTargetsVertical=e)}set nMips(e){this._objRef&&(this._objRef.nMips=e)}set renderTargetBright(e){this._objRef&&(this._objRef.renderTargetBright=e)}set highPassUniforms(e){this._objRef&&(this._objRef.highPassUniforms=e)}set materialHighPassFilter(e){this._objRef&&(this._objRef.materialHighPassFilter=e)}set separableBlurMaterials(e){this._objRef&&(this._objRef.separableBlurMaterials=e)}set compositeMaterial(e){this._objRef&&(this._objRef.compositeMaterial=e)}set bloomTintColors(e){this._objRef&&(this._objRef.bloomTintColors=e)}set copyUniforms(e){this._objRef&&(this._objRef.copyUniforms=e)}set materialCopy(e){this._objRef&&(this._objRef.materialCopy=e)}set oldClearColor(e){this._objRef&&(this._objRef.oldClearColor=Qe(this._objRef.oldClearColor,e))}set oldClearAlpha(e){this._objRef&&(this._objRef.oldClearAlpha=e)}set basic(e){this._objRef&&(this._objRef.basic=e)}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}}Hc.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Hc)))(t||Hc)}}(),Hc.\u0275cmp=$({type:Hc,selectors:[["th-unrealBloomPass"]],inputs:{resolution:"resolution",strength:"strength",radius:"radius",threshold:"threshold",clearColor:"clearColor",renderTargetsHorizontal:"renderTargetsHorizontal",renderTargetsVertical:"renderTargetsVertical",nMips:"nMips",renderTargetBright:"renderTargetBright",highPassUniforms:"highPassUniforms",materialHighPassFilter:"materialHighPassFilter",separableBlurMaterials:"separableBlurMaterials",compositeMaterial:"compositeMaterial",bloomTintColors:"bloomTintColors",copyUniforms:"copyUniforms",materialCopy:"materialCopy",oldClearColor:"oldClearColor",oldClearAlpha:"oldClearAlpha",basic:"basic",fsQuad:"fsQuad"},features:[se([{provide:Pi,useExisting:le(()=>Hc)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class hg extends Ir{getType(){return zU}set generateMipmaps(e){this._objRef&&(this._objRef.generateMipmaps=e)}}hg.\u0275fac=function(){let i;return function(t){return(i||(i=ce(hg)))(t||hg)}}(),hg.\u0275cmp=$({type:hg,selectors:[["th-videoTexture"]],inputs:{generateMipmaps:"generateMipmaps"},features:[se([{provide:Cr,useExisting:le(()=>hg)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class fg extends Mt{getType(){return aI}set type(e){this._objRef&&(this._objRef.type=e)}set parameters(e){this._objRef&&(this._objRef.parameters=e)}}fg.\u0275fac=function(){let i;return function(t){return(i||(i=ce(fg)))(t||fg)}}(),fg.\u0275cmp=$({type:fg,selectors:[["th-wireframeGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[se([{provide:Mt,useExisting:le(()=>fg)}]),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Uw{transform(e){if(e)return e instanceof Eo?e.objRef?.clone():e.clone()}}Uw.\u0275fac=function(e){return new(e||Uw)},Uw.\u0275pipe=gi({name:"clone",type:Uw,pure:!0});class Gc{transform(e){return Array.isArray(e)?new De(...e):new De(e)}}Gc.\u0275fac=function(e){return new(e||Gc)},Gc.\u0275pipe=gi({name:"color",type:Gc,pure:!0});class Vw{transform(e){return new ue(...e)}}Vw.\u0275fac=function(e){return new(e||Vw)},Vw.\u0275pipe=gi({name:"vector2",type:Vw,pure:!0});class zw{transform(e){return new T(...e)}}zw.\u0275fac=function(e){return new(e||zw)},zw.\u0275pipe=gi({name:"vector3",type:zw,pure:!0});class Hw{transform(e){return new ni(...e)}}Hw.\u0275fac=function(e){return new(e||Hw)},Hw.\u0275pipe=gi({name:"vector4",type:Hw,pure:!0});class Gw{transform(e,t){return new to(new T(...e),t)}}Gw.\u0275fac=function(e){return new(e||Gw)},Gw.\u0275pipe=gi({name:"plane",type:Gw,pure:!0});class Qc extends Do{constructor(){super(...arguments),this.clazz=bx}}Qc.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Qc)))(t||Qc)}}(),Qc.\u0275prov=Ne({token:Qc,factory:Qc.\u0275fac,providedIn:"root"});class Qw extends la{constructor(e){super(),this.service=e}}Qw.\u0275fac=function(e){return new(e||Qw)(R(Qc,16))},Qw.\u0275pipe=gi({name:"loadTexture",type:Qw,pure:!0});class Ww extends Rs{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}Ww.\u0275fac=function(e){return new(e||Ww)(R(Ir,1),R(at),R(Qc))},Ww.\u0275dir=ke({type:Ww,selectors:[["","loadTexture",""]],features:[W]});class nge extends cp{constructor(e){super(e)}parse(e){e.length<19&&console.error("THREE.TGALoader: Not enough data to contain header.");let w=0;const E=new Uint8Array(e),I={id_length:E[w++],colormap_type:E[w++],image_type:E[w++],colormap_index:E[w++]|E[w++]<<8,colormap_length:E[w++]|E[w++]<<8,colormap_size:E[w++],origin:[E[w++]|E[w++]<<8,E[w++]|E[w++]<<8],width:E[w++]|E[w++]<<8,height:E[w++]|E[w++]<<8,pixel_size:E[w++],flags:E[w++]};(function t(P){switch(P.image_type){case 1:case 9:(P.colormap_length>256||24!==P.colormap_size||1!==P.colormap_type)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case 2:case 3:case 10:case 11:P.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case 0:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',P.image_type)}(P.width<=0||P.height<=0)&&console.error("THREE.TGALoader: Invalid image size."),8!==P.pixel_size&&16!==P.pixel_size&&24!==P.pixel_size&&32!==P.pixel_size&&console.error('THREE.TGALoader: Invalid pixel size "%s".',P.pixel_size)})(I),I.id_length+w>e.length&&console.error("THREE.TGALoader: No data."),w+=I.id_length;let F=!1,Q=!1,B=!1;switch(I.image_type){case 9:F=!0,Q=!0;break;case 1:Q=!0;break;case 10:F=!0;break;case 2:break;case 11:F=!0,B=!0;break;case 3:B=!0}const L=new Uint8Array(I.width*I.height*4),X=function n(P,V,O,q,ee){let Z,Y;const he=O.pixel_size>>3,J=O.width*O.height*he;if(V&&(Y=ee.subarray(q,q+=O.colormap_length*(O.colormap_size>>3))),P){Z=new Uint8Array(J);let ae,G,U,de=0;const Ee=new Uint8Array(he);for(;de<J;)if(ae=ee[q++],G=1+(127&ae),128&ae){for(U=0;U<he;++U)Ee[U]=ee[q++];for(U=0;U<G;++U)Z.set(Ee,de+U*he);de+=he*G}else{for(G*=he,U=0;U<G;++U)Z[de+U]=ee[q++];de+=G}}else Z=ee.subarray(q,q+=V?O.width*O.height:J);return{pixel_data:Z,palettes:Y}}(F,Q,I,w,E);return function d(P,V,O,q,ee){let Z,Y,he,J,ae,G;switch((48&I.flags)>>4){default:case 2:Z=0,he=1,ae=V,Y=0,J=1,G=O;break;case 0:Z=0,he=1,ae=V,Y=O-1,J=-1,G=-1;break;case 3:Z=V-1,he=-1,ae=-1,Y=0,J=1,G=O;break;case 1:Z=V-1,he=-1,ae=-1,Y=O-1,J=-1,G=-1}if(B)switch(I.pixel_size){case 8:!function l(P,V,O,q,ee,Z,Y,he){let J,G,U,ae=0;const de=I.width;for(U=V;U!==q;U+=O)for(G=ee;G!==Y;G+=Z,ae++)J=he[ae],P[4*(G+de*U)+0]=J,P[4*(G+de*U)+1]=J,P[4*(G+de*U)+2]=J,P[4*(G+de*U)+3]=255}(P,Y,J,G,Z,he,ae,q);break;case 16:!function c(P,V,O,q,ee,Z,Y,he){let ae,G,J=0;const U=I.width;for(G=V;G!==q;G+=O)for(ae=ee;ae!==Y;ae+=Z,J+=2)P[4*(ae+U*G)+0]=he[J+0],P[4*(ae+U*G)+1]=he[J+0],P[4*(ae+U*G)+2]=he[J+0],P[4*(ae+U*G)+3]=he[J+1]}(P,Y,J,G,Z,he,ae,q);break;default:console.error("THREE.TGALoader: Format not supported.")}else switch(I.pixel_size){case 8:!function r(P,V,O,q,ee,Z,Y,he,J){const ae=J;let G,de,Ee,U=0;const we=I.width;for(Ee=V;Ee!==q;Ee+=O)for(de=ee;de!==Y;de+=Z,U++)G=he[U],P[4*(de+we*Ee)+3]=255,P[4*(de+we*Ee)+2]=ae[3*G+0],P[4*(de+we*Ee)+1]=ae[3*G+1],P[4*(de+we*Ee)+0]=ae[3*G+2]}(P,Y,J,G,Z,he,ae,q,ee);break;case 16:!function s(P,V,O,q,ee,Z,Y,he){let J,G,U,ae=0;const de=I.width;for(U=V;U!==q;U+=O)for(G=ee;G!==Y;G+=Z,ae+=2)J=he[ae+0]+(he[ae+1]<<8),P[4*(G+de*U)+0]=(31744&J)>>7,P[4*(G+de*U)+1]=(992&J)>>2,P[4*(G+de*U)+2]=(31&J)<<3,P[4*(G+de*U)+3]=32768&J?0:255}(P,Y,J,G,Z,he,ae,q);break;case 24:!function o(P,V,O,q,ee,Z,Y,he){let ae,G,J=0;const U=I.width;for(G=V;G!==q;G+=O)for(ae=ee;ae!==Y;ae+=Z,J+=3)P[4*(ae+U*G)+3]=255,P[4*(ae+U*G)+2]=he[J+0],P[4*(ae+U*G)+1]=he[J+1],P[4*(ae+U*G)+0]=he[J+2]}(P,Y,J,G,Z,he,ae,q);break;case 32:!function a(P,V,O,q,ee,Z,Y,he){let ae,G,J=0;const U=I.width;for(G=V;G!==q;G+=O)for(ae=ee;ae!==Y;ae+=Z,J+=4)P[4*(ae+U*G)+2]=he[J+0],P[4*(ae+U*G)+1]=he[J+1],P[4*(ae+U*G)+0]=he[J+2],P[4*(ae+U*G)+3]=he[J+3]}(P,Y,J,G,Z,he,ae,q);break;default:console.error("THREE.TGALoader: Format not supported.")}}(L,I.width,I.height,X.pixel_data,X.palettes),{data:L,width:I.width,height:I.height,flipY:!0,generateMipmaps:!0,minFilter:Xs}}}class Wc extends Do{constructor(){super(...arguments),this.clazz=nge}}Wc.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Wc)))(t||Wc)}}(),Wc.\u0275prov=Ne({token:Wc,factory:Wc.\u0275fac,providedIn:"root"});class qw extends la{constructor(e){super(),this.service=e}}qw.\u0275fac=function(e){return new(e||qw)(R(Wc,16))},qw.\u0275pipe=gi({name:"loadTGATexture",type:qw,pure:!0});class Xw extends Rs{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}Xw.\u0275fac=function(e){return new(e||Xw)(R(fa,1),R(at),R(Wc))},Xw.\u0275dir=ke({type:Xw,selectors:[["","loadTGATexture",""]],features:[W]});class qc extends Do{constructor(){super(...arguments),this.clazz=d4}}qc.\u0275fac=function(){let i;return function(t){return(i||(i=ce(qc)))(t||qc)}}(),qc.\u0275prov=Ne({token:qc,factory:qc.\u0275fac,providedIn:"root"});class Yw extends la{constructor(e){super(),this.service=e}}Yw.\u0275fac=function(e){return new(e||Yw)(R(qc,16))},Yw.\u0275pipe=gi({name:"loadCubeTexture",type:Yw,pure:!0});class Zw extends Rs{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}Zw.\u0275fac=function(e){return new(e||Zw)(R(Ir,1),R(at),R(qc))},Zw.\u0275dir=ke({type:Zw,selectors:[["","loadCubeTexture",""]],features:[W]});class rge extends _x{constructor(e){super(e)}parse(e,t){const n={mipmaps:[],width:0,height:0,format:null,mipmapCount:1};function f(ae){return ae.charCodeAt(0)+(ae.charCodeAt(1)<<8)+(ae.charCodeAt(2)<<16)+(ae.charCodeAt(3)<<24)}function p(ae,G,U,de){const Ee=U*de*4,we=new Uint8Array(ae,G,Ee),et=new Uint8Array(Ee);let Ae=0,xe=0;for(let Pe=0;Pe<de;Pe++)for(let $e=0;$e<U;$e++){const We=we[xe];xe++;const yt=we[xe];xe++;const ht=we[xe];xe++;const ot=we[xe];xe++,et[Ae]=ht,Ae++,et[Ae]=yt,Ae++,et[Ae]=We,Ae++,et[Ae]=ot,Ae++}return et}const g=f("DXT1"),_=f("DXT3"),v=f("DXT5"),b=f("ETC1"),O=new Int32Array(e,0,31);if(542327876!==O[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),n;let q;const ee=O[21];let Z=!1;switch(ee){case g:q=8,n.format=_f;break;case _:q=16,n.format=z_;break;case v:q=16,n.format=bf;break;case b:q=8,n.format=uA;break;default:if(!(32===O[22]&&16711680&O[23]&&65280&O[24]&&255&O[25]&&4278190080&O[26]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",function m(ae){return String.fromCharCode(255&ae,ae>>8&255,ae>>16&255,ae>>24&255)}(ee)),n;Z=!0,q=64,n.format=En}n.mipmapCount=1,131072&O[2]&&!1!==t&&(n.mipmapCount=Math.max(1,O[7]));const Y=O[28];if(n.isCubemap=!!(512&Y),n.isCubemap&&(!(1024&Y)||!(2048&Y)||!(4096&Y)||!(8192&Y)||!(16384&Y)||!(32768&Y)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),n;n.width=O[4],n.height=O[3];let he=O[1]+4;const J=n.isCubemap?6:1;for(let ae=0;ae<J;ae++){let G=n.width,U=n.height;for(let de=0;de<n.mipmapCount;de++){let Ee,we;Z?(Ee=p(e,he,G,U),we=Ee.length):(we=Math.max(4,G)/4*Math.max(4,U)/4*q,Ee=new Uint8Array(e,he,we)),n.mipmaps.push({data:Ee,width:G,height:U}),he+=we,G=Math.max(G>>1,1),U=Math.max(U>>1,1)}}return n}}class Xc extends Do{constructor(){super(...arguments),this.clazz=rge}}Xc.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Xc)))(t||Xc)}}(),Xc.\u0275prov=Ne({token:Xc,factory:Xc.\u0275fac,providedIn:"root"});class Kw extends la{constructor(e){super(),this.service=e}}Kw.\u0275fac=function(e){return new(e||Kw)(R(Xc,16))},Kw.\u0275pipe=gi({name:"loadDDSTexture",type:Kw,pure:!0});class $w extends Rs{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}$w.\u0275fac=function(e){return new(e||$w)(R(Wa,1),R(at),R(Xc))},$w.\u0275dir=ke({type:$w,selectors:[["","loadDDSTexture",""]],features:[W]});class sge{constructor(e=4){this.pool=e,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(e){if(!this.workers[e]){const t=this.workerCreator();t.addEventListener("message",this._onMessage.bind(this,e)),this.workers[e]=t}}_getIdleWorker(){for(let e=0;e<this.pool;e++)if(!(this.workerStatus&1<<e))return e;return-1}_onMessage(e,t){const n=this.workersResolve[e];if(n&&n(t),this.queue.length){const{resolve:r,msg:s,transfer:o}=this.queue.shift();this.workersResolve[e]=r,this.workers[e].postMessage(s,o)}else this.workerStatus^=1<<e}setWorkerCreator(e){this.workerCreator=e}setWorkerLimit(e){this.pool=e}postMessage(e,t){return new Promise(n=>{const r=this._getIdleWorker();-1!==r?(this._initWorker(r),this.workerStatus|=1<<r,this.workersResolve[r]=n,this.workers[r].postMessage(e,t)):this.queue.push({resolve:n,msg:e,transfer:t})})}dispose(){this.workers.forEach(e=>e.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}class uge{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class bb{constructor(e,t,n,r){this._dataView=new DataView(e.buffer,e.byteOffset+t,n),this._littleEndian=r,this._offset=0}_nextUint8(){const e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){const e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){const e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){const e=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,e}_nextInt32(){const e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_skip(e){return this._offset+=e,this}_scan(e,t=0){const n=this._offset;let r=0;for(;this._dataView.getUint8(this._offset)!==t&&r<e;)r++,this._offset++;return r<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+n,r)}}new Uint8Array([0]);const Or=[171,75,84,88,32,50,48,187,13,10,26,10];function MH(i){return typeof TextDecoder<"u"?(new TextDecoder).decode(i):Buffer.from(i).toString("utf8")}let oD,Vl,aD;const lD={env:{emscripten_notify_memory_growth:function(i){aD=new Uint8Array(Vl.exports.memory.buffer)}}};class pge{init(){return oD||(oD=typeof fetch<"u"?fetch("data:application/wasm;base64,"+EH).then(e=>e.arrayBuffer()).then(e=>WebAssembly.instantiate(e,lD)).then(this._init):WebAssembly.instantiate(Buffer.from(EH,"base64"),lD).then(this._init),oD)}_init(e){Vl=e.instance,lD.env.emscripten_notify_memory_growth(0)}decode(e,t=0){if(!Vl)throw new Error("ZSTDDecoder: Await .init() before decoding.");const n=e.byteLength,r=Vl.exports.malloc(n);aD.set(e,r),t=t||Number(Vl.exports.ZSTD_findDecompressedSize(r,n));const s=Vl.exports.malloc(t),o=Vl.exports.ZSTD_decompress(s,t,r,n),a=aD.slice(s,s+o);return Vl.exports.free(r),Vl.exports.free(s),a}}const EH="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ",cD=new WeakMap;let uD,dD=0,mge=(()=>{class i extends yr{constructor(t){super(t),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new sge,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(t){return this.transcoderPath=t,this}setWorkerLimit(t){return this.workerPool.setWorkerLimit(t),this}detectSupport(t){return this.workerConfig={astcSupported:t.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:t.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:t.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:t.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:t.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:t.extensions.has("WEBGL_compressed_texture_pvrtc")||t.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},t.capabilities.isWebGL2&&(this.workerConfig.etc1Supported=!1),this}init(){if(!this.transcoderPending){const t=new Ar(this.manager);t.setPath(this.transcoderPath),t.setWithCredentials(this.withCredentials);const n=t.loadAsync("basis_transcoder.js"),r=new Ar(this.manager);r.setPath(this.transcoderPath),r.setResponseType("arraybuffer"),r.setWithCredentials(this.withCredentials);const s=r.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([n,s]).then(([o,a])=>{const l=i.BasisWorker.toString(),c=["/* constants */","let _EngineFormat = "+JSON.stringify(i.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(i.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(i.BasisFormat),"/* basis_transcoder.js */",o,"/* worker */",l.substring(l.indexOf("{")+1,l.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([c])),this.transcoderBinary=a,this.workerPool.setWorkerCreator(()=>{const d=new Worker(this.workerSourceURL),u=this.transcoderBinary.slice(0);return d.postMessage({type:"init",config:this.workerConfig,transcoderBinary:u},[u]),d})}),dD>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),dD++}return this.transcoderPending}load(t,n,r,s){if(null===this.workerConfig)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const o=new Ar(this.manager);o.setResponseType("arraybuffer"),o.setWithCredentials(this.withCredentials),o.load(t,a=>{if(cD.has(a))return cD.get(a).promise.then(n).catch(s);this._createTexture(a).then(l=>n?n(l):null).catch(s)},r,s)}_createTextureFrom(t,n){const{mipmaps:r,width:s,height:o,format:a,type:l,error:c,dfdTransferFn:d,dfdFlags:u}=t;if("error"===l)return Promise.reject(c);const h=n.layerCount>1?new qT(r,s,o,n.layerCount,a,Wr):new m0(r,s,o,a,Wr);return h.minFilter=1===r.length?Li:Xs,h.magFilter=Li,h.generateMipmaps=!1,h.needsUpdate=!0,h.encoding=2===d?hi:Ys,h.premultiplyAlpha=!!(1&u),h}_createTexture(t,n={}){var r=this;return ss(function*(){const s=function hge(i){const e=new Uint8Array(i.buffer,i.byteOffset,Or.length);if(e[0]!==Or[0]||e[1]!==Or[1]||e[2]!==Or[2]||e[3]!==Or[3]||e[4]!==Or[4]||e[5]!==Or[5]||e[6]!==Or[6]||e[7]!==Or[7]||e[8]!==Or[8]||e[9]!==Or[9]||e[10]!==Or[10]||e[11]!==Or[11])throw new Error("Missing KTX 2.0 identifier.");const t=new uge,n=17*Uint32Array.BYTES_PER_ELEMENT,r=new bb(i,Or.length,n,!0);t.vkFormat=r._nextUint32(),t.typeSize=r._nextUint32(),t.pixelWidth=r._nextUint32(),t.pixelHeight=r._nextUint32(),t.pixelDepth=r._nextUint32(),t.layerCount=r._nextUint32(),t.faceCount=r._nextUint32();const s=r._nextUint32();t.supercompressionScheme=r._nextUint32();const o=r._nextUint32(),a=r._nextUint32(),l=r._nextUint32(),c=r._nextUint32(),d=r._nextUint64(),u=r._nextUint64(),h=new bb(i,Or.length+n,3*s*8,!0);for(let V=0;V<s;V++)t.levels.push({levelData:new Uint8Array(i.buffer,i.byteOffset+h._nextUint64(),h._nextUint64()),uncompressedByteLength:h._nextUint64()});const f=new bb(i,o,a,!0),m={vendorId:f._skip(4)._nextUint16(),descriptorType:f._nextUint16(),versionNumber:f._nextUint16(),descriptorBlockSize:f._nextUint16(),colorModel:f._nextUint8(),colorPrimaries:f._nextUint8(),transferFunction:f._nextUint8(),flags:f._nextUint8(),texelBlockDimension:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],bytesPlane:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],samples:[]},p=(m.descriptorBlockSize/4-6)/4;for(let V=0;V<p;V++){const O={bitOffset:f._nextUint16(),bitLength:f._nextUint8(),channelType:f._nextUint8(),samplePosition:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&O.channelType?(O.sampleLower=f._nextInt32(),O.sampleUpper=f._nextInt32()):(O.sampleLower=f._nextUint32(),O.sampleUpper=f._nextUint32()),m.samples[V]=O}t.dataFormatDescriptor.length=0,t.dataFormatDescriptor.push(m);const g=new bb(i,l,c,!0);for(;g._offset<c;){const V=g._nextUint32(),O=g._scan(V),q=MH(O),ee=g._scan(V-O.byteLength);t.keyValue[q]=q.match(/^ktx/i)?MH(ee):ee,g._offset%4&&g._skip(4-g._offset%4)}if(u<=0)return t;const _=new bb(i,d,u,!0),v=_._nextUint16(),b=_._nextUint16(),y=_._nextUint32(),x=_._nextUint32(),C=_._nextUint32(),M=_._nextUint32(),w=[];for(let V=0;V<s;V++)w.push({imageFlags:_._nextUint32(),rgbSliceByteOffset:_._nextUint32(),rgbSliceByteLength:_._nextUint32(),alphaSliceByteOffset:_._nextUint32(),alphaSliceByteLength:_._nextUint32()});const E=d+_._offset,I=E+y,F=I+x,Q=F+C,B=new Uint8Array(i.buffer,i.byteOffset+E,y),L=new Uint8Array(i.buffer,i.byteOffset+I,x),X=new Uint8Array(i.buffer,i.byteOffset+F,C),P=new Uint8Array(i.buffer,i.byteOffset+Q,M);return t.globalData={endpointCount:v,selectorCount:b,imageDescs:w,endpointsData:B,selectorsData:L,tablesData:X,extendedData:P},t}(new Uint8Array(t));if(0!==s.vkFormat)return function _ge(i){return fD.apply(this,arguments)}(s);const o=n,a=r.init().then(()=>r.workerPool.postMessage({type:"transcode",buffer:t,taskConfig:o},[t])).then(l=>r._createTextureFrom(l.data,s));return cD.set(t,{promise:a}),a})()}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),dD--,this}}return i.BasisFormat={ETC1S:0,UASTC_4x4:1},i.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16},i.EngineFormat={RGBAFormat:En,RGBA_ASTC_4x4_Format:pA,RGBA_BPTC_Format:mA,RGBA_ETC2_EAC_Format:fA,RGBA_PVRTC_4BPPV1_Format:yf,RGBA_S3TC_DXT5_Format:bf,RGB_ETC1_Format:uA,RGB_ETC2_Format:hA,RGB_PVRTC_4BPPV1_Format:vf,RGB_S3TC_DXT1_Format:_f},i.BasisWorker=function(){let e,t,n;const r=_EngineFormat,s=_TranscoderFormat,o=_BasisFormat;self.addEventListener("message",function(p){const g=p.data;switch(g.type){case"init":e=g.config,function a(p){t=new Promise(g=>{n={wasmBinary:p,onRuntimeInitialized:g},BASIS(n)}).then(()=>{n.initializeBasis(),void 0===n.KTX2File&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}(g.transcoderBinary);break;case"transcode":t.then(()=>{try{const{width:_,height:v,hasAlpha:b,mipmaps:y,format:x,dfdTransferFn:C,dfdFlags:M}=function l(p){const g=new n.KTX2File(new Uint8Array(p));function _(){g.close(),g.delete()}if(!g.isValid())throw _(),new Error("THREE.KTX2Loader:\tInvalid or unsupported .ktx2 file");const v=g.isUASTC()?o.UASTC_4x4:o.ETC1S,b=g.getWidth(),y=g.getHeight(),x=g.getLayers()||1,C=g.getLevels(),M=g.getHasAlpha(),w=g.getDFDTransferFunc(),E=g.getDFDFlags(),{transcoderFormat:I,engineFormat:F}=function h(p,g,_,v){let b,y;const x=p===o.ETC1S?d:u;for(let C=0;C<x.length;C++){const M=x[C];if(e[M.if]&&M.basisFormat.includes(p)&&!(v&&M.transcoderFormat.length<2)&&(!M.needsPowerOfTwo||f(g)&&f(_)))return b=M.transcoderFormat[v?1:0],y=M.engineFormat[v?1:0],{transcoderFormat:b,engineFormat:y}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),b=s.RGBA32,y=r.RGBAFormat,{transcoderFormat:b,engineFormat:y}}(v,b,y,M);if(!b||!y||!C)throw _(),new Error("THREE.KTX2Loader:\tInvalid texture");if(!g.startTranscoding())throw _(),new Error("THREE.KTX2Loader: .startTranscoding failed");const Q=[];for(let B=0;B<C;B++){const L=[];let X,P;for(let V=0;V<x;V++){const O=g.getImageLevelInfo(B,V,0);X=O.origWidth,P=O.origHeight;const q=new Uint8Array(g.getImageTranscodedSizeInBytes(B,V,0,I));if(!g.transcodeImage(q,B,V,0,I,0,-1,-1))throw _(),new Error("THREE.KTX2Loader: .transcodeImage failed.");L.push(q)}Q.push({data:m(L),width:X,height:P})}return _(),{width:b,height:y,hasAlpha:M,mipmaps:Q,format:F,dfdTransferFn:w,dfdFlags:E}}(g.buffer),w=[];for(let E=0;E<y.length;++E)w.push(y[E].data.buffer);self.postMessage({type:"transcode",id:g.id,width:_,height:v,hasAlpha:b,mipmaps:y,format:x,dfdTransferFn:C,dfdFlags:M},w)}catch(_){console.error(_),self.postMessage({type:"error",id:g.id,error:_.message})}})}});const c=[{if:"astcSupported",basisFormat:[o.UASTC_4x4],transcoderFormat:[s.ASTC_4x4,s.ASTC_4x4],engineFormat:[r.RGBA_ASTC_4x4_Format,r.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[s.BC7_M5,s.BC7_M5],engineFormat:[r.RGBA_BPTC_Format,r.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[s.BC1,s.BC3],engineFormat:[r.RGB_S3TC_DXT1_Format,r.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[s.ETC1,s.ETC2],engineFormat:[r.RGB_ETC2_Format,r.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[s.ETC1],engineFormat:[r.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[s.PVRTC1_4_RGB,s.PVRTC1_4_RGBA],engineFormat:[r.RGB_PVRTC_4BPPV1_Format,r.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],d=c.sort(function(p,g){return p.priorityETC1S-g.priorityETC1S}),u=c.sort(function(p,g){return p.priorityUASTC-g.priorityUASTC});function f(p){return p<=2||0==(p&p-1)&&0!==p}function m(p){let g=0;for(const b of p)g+=b.byteLength;const _=new Uint8Array(g);let v=0;for(const b of p)_.set(b,v),v+=b.byteLength;return _}},i})();const SH={109:En,97:En,37:En,43:En,103:gf,83:gf,16:gf,22:gf,100:bl,76:bl,15:bl,9:bl},hD={109:Ln,97:fn,37:Wr,43:Wr,103:Ln,83:fn,16:Wr,22:Wr,100:Ln,76:fn,15:Wr,9:Wr},gge={43:hi,22:hi,15:hi};function fD(){return fD=ss(function*(i){const{vkFormat:e,pixelWidth:t,pixelHeight:n,pixelDepth:r}=i;if(void 0===SH[e])throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");const s=i.levels[0];let o,a;if(0===i.supercompressionScheme)o=s.levelData;else{if(2!==i.supercompressionScheme)throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");uD||(uD=new Promise(function(){var c=ss(function*(d){const u=new pge;yield u.init(),d(u)});return function(d){return c.apply(this,arguments)}}())),o=(yield uD).decode(s.levelData,s.uncompressedByteLength)}a=hD[e]===Ln?new Float32Array(o.buffer,o.byteOffset,o.byteLength/Float32Array.BYTES_PER_ELEMENT):hD[e]===fn?new Uint16Array(o.buffer,o.byteOffset,o.byteLength/Uint16Array.BYTES_PER_ELEMENT):o;const l=0===r?new ka(a,t,n):new Ef(a,t,n,r);return l.type=hD[e],l.format=SH[e],l.encoding=gge[e]||Ys,l.needsUpdate=!0,Promise.resolve(l)}),fD.apply(this,arguments)}class Yc extends Do{constructor(){super(...arguments),this.clazz=mge,this.transcoderPath=""}setDecoderPath(e){this.transcoderPath=e}createLoaderInstance(){const e=super.createLoaderInstance();return e.setTranscoderPath(this.transcoderPath),e}}Yc.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Yc)))(t||Yc)}}(),Yc.\u0275prov=Ne({token:Yc,factory:Yc.\u0275fac,providedIn:"root"});class eC extends la{constructor(e){super(),this.service=e}}eC.\u0275fac=function(e){return new(e||eC)(R(Yc,16))},eC.\u0275pipe=gi({name:"loadKTX2Texture",type:eC,pure:!0});class tC extends Rs{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}tC.\u0275fac=function(e){return new(e||tC)(R(Ir,1),R(at),R(Yc))},tC.\u0275dir=ke({type:tC,selectors:[["","loadKTX2Texture",""]],features:[W]});class bge extends _x{constructor(e){super(e)}parse(e,t){const n=new Age(e,1);return{mipmaps:n.mipmaps(t),width:n.pixelWidth,height:n.pixelHeight,format:n.glInternalFormat,isCubemap:6===n.numberOfFaces,mipmapCount:n.numberOfMipmapLevels}}}class Age{constructor(e,t){this.arrayBuffer=e;const n=new Uint8Array(this.arrayBuffer,0,12);if(171!==n[0]||75!==n[1]||84!==n[2]||88!==n[3]||32!==n[4]||49!==n[5]||49!==n[6]||187!==n[7]||13!==n[8]||10!==n[9]||26!==n[10]||10!==n[11])return void console.error("texture missing KTX identifier");const r=Uint32Array.BYTES_PER_ELEMENT,s=new DataView(this.arrayBuffer,12,13*r),a=67305985===s.getUint32(0,!0);this.glType=s.getUint32(1*r,a),this.glTypeSize=s.getUint32(2*r,a),this.glFormat=s.getUint32(3*r,a),this.glInternalFormat=s.getUint32(4*r,a),this.glBaseInternalFormat=s.getUint32(5*r,a),this.pixelWidth=s.getUint32(6*r,a),this.pixelHeight=s.getUint32(7*r,a),this.pixelDepth=s.getUint32(8*r,a),this.numberOfArrayElements=s.getUint32(9*r,a),this.numberOfFaces=s.getUint32(10*r,a),this.numberOfMipmapLevels=s.getUint32(11*r,a),this.bytesOfKeyValueData=s.getUint32(12*r,a),0===this.glType?(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0!==this.pixelHeight&&0===this.pixelDepth?0===this.numberOfArrayElements?this.numberOfFaces===t?this.loadType=0:console.warn("number of faces expected"+t+", but found "+this.numberOfFaces):console.warn("texture arrays not currently supported"):console.warn("only 2D textures currently supported")):console.warn("only compressed formats currently supported")}mipmaps(e){const t=[];let n=64+this.bytesOfKeyValueData,r=this.pixelWidth,s=this.pixelHeight;const o=e?this.numberOfMipmapLevels:1;for(let a=0;a<o;a++){const l=new Int32Array(this.arrayBuffer,n,1)[0];n+=4;for(let c=0;c<this.numberOfFaces;c++){const d=new Uint8Array(this.arrayBuffer,n,l);t.push({data:d,width:r,height:s}),n+=l,n+=3-(l+3)%4}r=Math.max(1,.5*r),s=Math.max(1,.5*s)}return t}}class Zc extends Do{constructor(){super(...arguments),this.clazz=bge}}Zc.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Zc)))(t||Zc)}}(),Zc.\u0275prov=Ne({token:Zc,factory:Zc.\u0275fac,providedIn:"root"});class iC extends la{constructor(e){super(),this.service=e}}iC.\u0275fac=function(e){return new(e||iC)(R(Zc,16))},iC.\u0275pipe=gi({name:"loadKTXTexture",type:iC,pure:!0});class nC extends Rs{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}nC.\u0275fac=function(e){return new(e||nC)(R(Wa,1),R(at),R(Zc))},nC.\u0275dir=ke({type:nC,selectors:[["","loadKTXTexture",""]],features:[W]});class xge extends _x{constructor(e){super(e)}parse(e,t){const r=new Uint32Array(e,0,13),s={buffer:e,header:r,loadMipmaps:t};return 55727696===r[0]?function wge(i){const e=i.header;let t,n;const r=e[12],s=e[2],o=e[6],a=e[7],l=e[10],c=e[11];switch(s){case 0:t=2,n=H_;break;case 1:t=2,n=G_;break;case 2:t=4,n=vf;break;case 3:t=4,n=yf;break;default:console.error("THREE.PVRLoader: Unsupported PVR format:",s)}return i.dataPtr=52+r,i.bpp=t,i.format=n,i.width=a,i.height=o,i.numSurfaces=l,i.numMipmaps=c,i.isCubemap=6===l,TH(i)}(s):559044176===r[11]?function Cge(i){const e=i.header,t=e[0],n=e[1],r=e[2],s=e[3],l=e[12],h=255&e[4];let f,m;const p=e[10]>0;return 25===h?(m=p?yf:vf,f=4):24===h?(m=p?G_:H_,f=2):console.error("THREE.PVRLoader: Unknown PVR format:",h),i.dataPtr=t,i.bpp=f,i.format=m,i.width=r,i.height=n,i.numSurfaces=l,i.numMipmaps=s+1,i.isCubemap=6===l,TH(i)}(s):void console.error("THREE.PVRLoader: Unknown PVR format.")}}function TH(i){const e={mipmaps:[],width:i.width,height:i.height,format:i.format,mipmapCount:i.numMipmaps,isCubemap:i.isCubemap},t=i.buffer;let n=i.dataPtr,r=0,s=0,o=0,a=0,l=0,c=0;const d=i.bpp,u=i.numSurfaces;2===d?(o=8,a=4):(o=4,a=4),s=o*a*d/8,e.mipmaps.length=i.numMipmaps*u;let h=0;for(;h<i.numMipmaps;){const f=i.width>>h,m=i.height>>h;l=f/o,c=m/a,l<2&&(l=2),c<2&&(c=2),r=l*c*s;for(let p=0;p<u;p++){const _={data:new Uint8Array(t,n,r),width:f,height:m};e.mipmaps[p*i.numMipmaps+h]=_,n+=r}h++}return e}class Kc extends Do{constructor(){super(...arguments),this.clazz=xge}}Kc.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Kc)))(t||Kc)}}(),Kc.\u0275prov=Ne({token:Kc,factory:Kc.\u0275fac,providedIn:"root"});class rC extends la{constructor(e){super(),this.service=e}}rC.\u0275fac=function(e){return new(e||rC)(R(Kc,16))},rC.\u0275pipe=gi({name:"loadPVRTexture",type:rC,pure:!0});class sC extends Rs{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}sC.\u0275fac=function(e){return new(e||sC)(R(Wa,1),R(at),R(Kc))},sC.\u0275dir=ke({type:sC,selectors:[["","loadPVRTexture",""]],features:[W]});class Mge extends cp{constructor(e){super(e),this.type=fn}parse(e){const E=Math.pow(2.7182818,2.2),Q={l:0,c:0,lc:0};function B(S,D,z,ne,be){for(;z<S;)D=D<<8|At(ne,be),z+=8;Q.l=D>>(z-=S)&(1<<S)-1,Q.c=D,Q.lc=z}const L=new Array(59);function V(S){return 63&S}function O(S){return S>>6}const ee={c:0,lc:0};function Z(S,D,z,ne){S=S<<8|At(z,ne),D+=8,ee.c=S,ee.lc=D}const Y={c:0,lc:0};function he(S,D,z,ne,be,fe,Ce,Oe,qe){if(S==D){ne<8&&(Z(z,ne,be,fe),z=ee.c,ne=ee.lc);let Be=z>>(ne-=8);if(Be=new Uint8Array([Be])[0],Oe.value+Be>qe)return!1;const Xe=Ce[Oe.value-1];for(;Be-- >0;)Ce[Oe.value++]=Xe}else{if(!(Oe.value<qe))return!1;Ce[Oe.value++]=S}Y.c=z,Y.lc=ne}function J(S){return 65535&S}function ae(S){const D=J(S);return D>32767?D-65536:D}const G={a:0,b:0};function U(S,D){const z=ae(S),be=ae(D),fe=z+(1&be)+(be>>1),Oe=fe-be;G.a=fe,G.b=Oe}function de(S,D){const z=J(S),ne=J(D),be=z-(ne>>1)&65535;G.a=ne+be-32768&65535,G.b=be}function Ee(S,D,z,ne,be,fe,Ce){const Oe=Ce<16384,qe=z>be?be:z;let Xe,Je,Be=1;for(;Be<=qe;)Be<<=1;for(Be>>=1,Xe=Be,Be>>=1;Be>=1;){Je=0;const He=Je+fe*(be-Xe),Bt=fe*Be,Et=fe*Xe,pt=ne*Be,It=ne*Xe;let ei,an,Ai,$n;for(;Je<=He;Je+=Et){let Qi=Je;const Qt=Je+ne*(z-Xe);for(;Qi<=Qt;Qi+=It){const Rn=Qi+pt,Bs=Qi+Bt,Jn=Bs+pt;Oe?(U(S[Qi+D],S[Bs+D]),ei=G.a,Ai=G.b,U(S[Rn+D],S[Jn+D]),an=G.a,$n=G.b,U(ei,an),S[Qi+D]=G.a,S[Rn+D]=G.b,U(Ai,$n),S[Bs+D]=G.a,S[Jn+D]=G.b):(de(S[Qi+D],S[Bs+D]),ei=G.a,Ai=G.b,de(S[Rn+D],S[Jn+D]),an=G.a,$n=G.b,de(ei,an),S[Qi+D]=G.a,S[Rn+D]=G.b,de(Ai,$n),S[Bs+D]=G.a,S[Jn+D]=G.b)}if(z&Be){const Rn=Qi+Bt;Oe?U(S[Qi+D],S[Rn+D]):de(S[Qi+D],S[Rn+D]),ei=G.a,S[Rn+D]=G.b,S[Qi+D]=ei}}if(be&Be){let Qi=Je;const Qt=Je+ne*(z-Xe);for(;Qi<=Qt;Qi+=It){const Rn=Qi+pt;Oe?U(S[Qi+D],S[Rn+D]):de(S[Qi+D],S[Rn+D]),ei=G.a,S[Rn+D]=G.b,S[Qi+D]=ei}}Xe=Be,Be>>=1}return Je}function et(S,D,z,ne,be,fe){const Oe=z.value,qe=rt(D,z),Be=rt(D,z);z.value+=4;const Xe=rt(D,z);if(z.value+=4,qe<0||qe>=65537||Be<0||Be>=65537)throw new Error("Something wrong with HUF_ENCSIZE");const Je=new Array(65537),He=new Array(16384);if(function F(S){for(let D=0;D<16384;D++)S[D]={},S[D].len=0,S[D].lit=0,S[D].p=null}(He),function P(S,D,z,ne,be,fe){const Ce=D;let Oe=0,qe=0;for(;ne<=be;ne++){if(Ce.value-D.value>z)return!1;B(6,Oe,qe,S,Ce);const Be=Q.l;if(Oe=Q.c,qe=Q.lc,fe[ne]=Be,63==Be){if(Ce.value-D.value>z)throw new Error("Something wrong with hufUnpackEncTable");B(8,Oe,qe,S,Ce);let Xe=Q.l+6;if(Oe=Q.c,qe=Q.lc,ne+Xe>be+1)throw new Error("Something wrong with hufUnpackEncTable");for(;Xe--;)fe[ne++]=0;ne--}else if(Be>=59){let Xe=Be-59+2;if(ne+Xe>be+1)throw new Error("Something wrong with hufUnpackEncTable");for(;Xe--;)fe[ne++]=0;ne--}}!function X(S){for(let z=0;z<=58;++z)L[z]=0;for(let z=0;z<65537;++z)L[S[z]]+=1;let D=0;for(let z=58;z>0;--z){const ne=D+L[z]>>1;L[z]=D,D=ne}for(let z=0;z<65537;++z){const ne=S[z];ne>0&&(S[z]=ne|L[ne]++<<6)}}(fe)}(S,z,ne-(z.value-Oe),qe,Be,Je),Xe>8*(ne-(z.value-Oe)))throw new Error("Something wrong with hufUncompress");(function q(S,D,z,ne){for(;D<=z;D++){const be=O(S[D]),fe=V(S[D]);if(be>>fe)throw new Error("Invalid table entry");if(fe>14){const Ce=ne[be>>fe-14];if(Ce.len)throw new Error("Invalid table entry");if(Ce.lit++,Ce.p){const Oe=Ce.p;Ce.p=new Array(Ce.lit);for(let qe=0;qe<Ce.lit-1;++qe)Ce.p[qe]=Oe[qe]}else Ce.p=new Array(1);Ce.p[Ce.lit-1]=D}else if(fe){let Ce=0;for(let Oe=1<<14-fe;Oe>0;Oe--){const qe=ne[(be<<14-fe)+Ce];if(qe.len||qe.p)throw new Error("Invalid table entry");qe.len=fe,qe.lit=D,Ce++}}}})(Je,qe,Be,He),function we(S,D,z,ne,be,fe,Ce,Oe,qe){let Be=0,Xe=0;const Je=Ce,He=Math.trunc(ne.value+(be+7)/8);for(;ne.value<He;)for(Z(Be,Xe,z,ne),Be=ee.c,Xe=ee.lc;Xe>=14;){const pt=D[Be>>Xe-14&16383];if(pt.len)Xe-=pt.len,he(pt.lit,fe,Be,Xe,z,ne,Oe,qe,Je),Be=Y.c,Xe=Y.lc;else{if(!pt.p)throw new Error("hufDecode issues");let It;for(It=0;It<pt.lit;It++){const ei=V(S[pt.p[It]]);for(;Xe<ei&&ne.value<He;)Z(Be,Xe,z,ne),Be=ee.c,Xe=ee.lc;if(Xe>=ei&&O(S[pt.p[It]])==(Be>>Xe-ei&(1<<ei)-1)){Xe-=ei,he(pt.p[It],fe,Be,Xe,z,ne,Oe,qe,Je),Be=Y.c,Xe=Y.lc;break}}if(It==pt.lit)throw new Error("hufDecode issues")}}const Bt=8-be&7;for(Be>>=Bt,Xe-=Bt;Xe>0;){const Et=D[Be<<14-Xe&16383];if(!Et.len)throw new Error("hufDecode issues");Xe-=Et.len,he(Et.lit,fe,Be,Xe,z,ne,Oe,qe,Je),Be=Y.c,Xe=Y.lc}}(Je,He,S,z,Xe,Be,fe,be,{value:0})}function xe(S){for(let D=1;D<S.length;D++)S[D]=S[D-1]+S[D]-128}function Pe(S,D){let z=0,ne=Math.floor((S.length+1)/2),be=0;const fe=S.length-1;for(;!(be>fe||(D[be++]=S[z++],be>fe));)D[be++]=S[ne++]}function $e(S){let D=S.byteLength;const z=new Array;let ne=0;const be=new DataView(S);for(;D>0;){const fe=be.getInt8(ne++);if(fe<0){const Ce=-fe;D-=Ce+1;for(let Oe=0;Oe<Ce;Oe++)z.push(be.getUint8(ne++))}else{const Ce=fe;D-=2;const Oe=be.getUint8(ne++);for(let qe=0;qe<Ce+1;qe++)z.push(Oe)}}return z}function yt(S,D,z){let ne,be=1;for(;be<64;)ne=D[S.value],65280==ne?be=64:ne>>8==255?be+=255&ne:(z[be]=ne,be++),S.value++}function ht(S,D){D[0]=ie(S[0]),D[1]=ie(S[1]),D[2]=ie(S[5]),D[3]=ie(S[6]),D[4]=ie(S[14]),D[5]=ie(S[15]),D[6]=ie(S[27]),D[7]=ie(S[28]),D[8]=ie(S[2]),D[9]=ie(S[4]),D[10]=ie(S[7]),D[11]=ie(S[13]),D[12]=ie(S[16]),D[13]=ie(S[26]),D[14]=ie(S[29]),D[15]=ie(S[42]),D[16]=ie(S[3]),D[17]=ie(S[8]),D[18]=ie(S[12]),D[19]=ie(S[17]),D[20]=ie(S[25]),D[21]=ie(S[30]),D[22]=ie(S[41]),D[23]=ie(S[43]),D[24]=ie(S[9]),D[25]=ie(S[11]),D[26]=ie(S[18]),D[27]=ie(S[24]),D[28]=ie(S[31]),D[29]=ie(S[40]),D[30]=ie(S[44]),D[31]=ie(S[53]),D[32]=ie(S[10]),D[33]=ie(S[19]),D[34]=ie(S[23]),D[35]=ie(S[32]),D[36]=ie(S[39]),D[37]=ie(S[45]),D[38]=ie(S[52]),D[39]=ie(S[54]),D[40]=ie(S[20]),D[41]=ie(S[22]),D[42]=ie(S[33]),D[43]=ie(S[38]),D[44]=ie(S[46]),D[45]=ie(S[51]),D[46]=ie(S[55]),D[47]=ie(S[60]),D[48]=ie(S[21]),D[49]=ie(S[34]),D[50]=ie(S[37]),D[51]=ie(S[47]),D[52]=ie(S[50]),D[53]=ie(S[56]),D[54]=ie(S[59]),D[55]=ie(S[61]),D[56]=ie(S[35]),D[57]=ie(S[36]),D[58]=ie(S[48]),D[59]=ie(S[49]),D[60]=ie(S[57]),D[61]=ie(S[58]),D[62]=ie(S[62]),D[63]=ie(S[63])}function ot(S){const D=.5*Math.cos(.7853975),z=.5*Math.cos(3.14159/16),ne=.5*Math.cos(3.14159/8),be=.5*Math.cos(3*3.14159/16),fe=.5*Math.cos(.981746875),Ce=.5*Math.cos(3*3.14159/8),Oe=.5*Math.cos(1.374445625),qe=new Array(4),Be=new Array(4),Xe=new Array(4),Je=new Array(4);for(let He=0;He<8;++He){const Bt=8*He;qe[0]=ne*S[Bt+2],qe[1]=Ce*S[Bt+2],qe[2]=ne*S[Bt+6],qe[3]=Ce*S[Bt+6],Be[0]=z*S[Bt+1]+be*S[Bt+3]+fe*S[Bt+5]+Oe*S[Bt+7],Be[1]=be*S[Bt+1]-Oe*S[Bt+3]-z*S[Bt+5]-fe*S[Bt+7],Be[2]=fe*S[Bt+1]-z*S[Bt+3]+Oe*S[Bt+5]+be*S[Bt+7],Be[3]=Oe*S[Bt+1]-fe*S[Bt+3]+be*S[Bt+5]-z*S[Bt+7],Xe[0]=D*(S[Bt+0]+S[Bt+4]),Xe[3]=D*(S[Bt+0]-S[Bt+4]),Xe[1]=qe[0]+qe[3],Xe[2]=qe[1]-qe[2],Je[0]=Xe[0]+Xe[1],Je[1]=Xe[3]+Xe[2],Je[2]=Xe[3]-Xe[2],Je[3]=Xe[0]-Xe[1],S[Bt+0]=Je[0]+Be[0],S[Bt+1]=Je[1]+Be[1],S[Bt+2]=Je[2]+Be[2],S[Bt+3]=Je[3]+Be[3],S[Bt+4]=Je[3]-Be[3],S[Bt+5]=Je[2]-Be[2],S[Bt+6]=Je[1]-Be[1],S[Bt+7]=Je[0]-Be[0]}for(let He=0;He<8;++He)qe[0]=ne*S[16+He],qe[1]=Ce*S[16+He],qe[2]=ne*S[48+He],qe[3]=Ce*S[48+He],Be[0]=z*S[8+He]+be*S[24+He]+fe*S[40+He]+Oe*S[56+He],Be[1]=be*S[8+He]-Oe*S[24+He]-z*S[40+He]-fe*S[56+He],Be[2]=fe*S[8+He]-z*S[24+He]+Oe*S[40+He]+be*S[56+He],Be[3]=Oe*S[8+He]-fe*S[24+He]+be*S[40+He]-z*S[56+He],Xe[0]=D*(S[He]+S[32+He]),Xe[3]=D*(S[He]-S[32+He]),Xe[1]=qe[0]+qe[3],Xe[2]=qe[1]-qe[2],Je[0]=Xe[0]+Xe[1],Je[1]=Xe[3]+Xe[2],Je[2]=Xe[3]-Xe[2],Je[3]=Xe[0]-Xe[1],S[0+He]=Je[0]+Be[0],S[8+He]=Je[1]+Be[1],S[16+He]=Je[2]+Be[2],S[24+He]=Je[3]+Be[3],S[32+He]=Je[3]-Be[3],S[40+He]=Je[2]-Be[2],S[48+He]=Je[1]-Be[1],S[56+He]=Je[0]-Be[0]}function St(S){for(let D=0;D<64;++D){const z=S[0][D],ne=S[1][D],be=S[2][D];S[0][D]=z+1.5747*be,S[1][D]=z-.1873*ne-.4682*be,S[2][D]=z+1.8556*ne}}function ft(S,D,z){for(let ne=0;ne<64;++ne)D[z+ne]=cs.toHalfFloat(N(S[ne]))}function N(S){return S<=1?Math.sign(S)*Math.pow(Math.abs(S),2.2):Math.sign(S)*Math.pow(E,Math.abs(S)-1)}function k(S){return new DataView(S.array.buffer,S.offset.value,S.size)}function _e(S){const D=S.viewer.buffer.slice(S.offset.value,S.offset.value+S.size),z=new Uint8Array($e(D)),ne=new Uint8Array(z.length);return xe(z),Pe(z,ne),new DataView(ne.buffer)}function Se(S){const z=kc(S.array.slice(S.offset.value,S.offset.value+S.size)),ne=new Uint8Array(z.length);return xe(z),Pe(z,ne),new DataView(ne.buffer)}function Ue(S){const D=S.viewer,z={value:S.offset.value},ne=new Uint16Array(S.width*S.scanlineBlockSize*(S.channels*S.type)),be=new Uint8Array(8192);let fe=0;const Ce=new Array(S.channels);for(let Et=0;Et<S.channels;Et++)Ce[Et]={},Ce[Et].start=fe,Ce[Et].end=Ce[Et].start,Ce[Et].nx=S.width,Ce[Et].ny=S.lines,Ce[Et].size=S.type,fe+=Ce[Et].nx*Ce[Et].ny*Ce[Et].size;const Oe=je(D,z),qe=je(D,z);if(qe>=8192)throw new Error("Something is wrong with PIZ_COMPRESSION BITMAP_SIZE");if(Oe<=qe)for(let Et=0;Et<qe-Oe+1;Et++)be[Et+Oe]=Jt(D,z);const Be=new Uint16Array(65536),Xe=function I(S,D){let z=0;for(let be=0;be<65536;++be)(0==be||S[be>>3]&1<<(7&be))&&(D[z++]=be);const ne=z-1;for(;z<65536;)D[z++]=0;return ne}(be,Be),Je=rt(D,z);et(S.array,D,z,Je,ne,fe);for(let Et=0;Et<S.channels;++Et){const pt=Ce[Et];for(let It=0;It<Ce[Et].size;++It)Ee(ne,pt.start+It,pt.nx,pt.size,pt.ny,pt.nx*pt.size,Xe)}!function Ae(S,D,z){for(let ne=0;ne<z;++ne)D[ne]=S[D[ne]]}(Be,ne,fe);let He=0;const Bt=new Uint8Array(ne.buffer.byteLength);for(let Et=0;Et<S.lines;Et++)for(let pt=0;pt<S.channels;pt++){const It=Ce[pt],ei=It.nx*It.size,an=new Uint8Array(ne.buffer,2*It.end,2*ei);Bt.set(an,He),He+=2*ei,It.end+=ei}return new DataView(Bt.buffer)}function Ze(S){const z=kc(S.array.slice(S.offset.value,S.offset.value+S.size)),ne=S.lines*S.channels*S.width,be=1==S.type?new Uint16Array(ne):new Uint32Array(ne);let fe=0,Ce=0;const Oe=new Array(4);for(let qe=0;qe<S.lines;qe++)for(let Be=0;Be<S.channels;Be++){let Xe=0;switch(S.type){case 1:Oe[0]=fe,Oe[1]=Oe[0]+S.width,fe=Oe[1]+S.width;for(let Je=0;Je<S.width;++Je)Xe+=z[Oe[0]++]<<8|z[Oe[1]++],be[Ce]=Xe,Ce++;break;case 2:Oe[0]=fe,Oe[1]=Oe[0]+S.width,Oe[2]=Oe[1]+S.width,fe=Oe[2]+S.width;for(let Je=0;Je<S.width;++Je)Xe+=z[Oe[0]++]<<24|z[Oe[1]++]<<16|z[Oe[2]++]<<8,be[Ce]=Xe,Ce++}}return new DataView(be.buffer)}function bt(S){const D=S.viewer,z={value:S.offset.value},ne=new Uint8Array(S.width*S.lines*(S.channels*S.type*2)),be={version:Ft(D,z),unknownUncompressedSize:Ft(D,z),unknownCompressedSize:Ft(D,z),acCompressedSize:Ft(D,z),dcCompressedSize:Ft(D,z),rleCompressedSize:Ft(D,z),rleUncompressedSize:Ft(D,z),rleRawSize:Ft(D,z),totalAcUncompressedCount:Ft(D,z),totalDcUncompressedCount:Ft(D,z),acCompression:Ft(D,z)};if(be.version<2)throw new Error("EXRLoader.parse: "+ge.compression+" version "+be.version+" is unsupported");const fe=new Array;let Ce=je(D,z)-2;for(;Ce>0;){const pt=H(D.buffer,z),It=Jt(D,z),ei=It>>2&3,Ai=new Int8Array([(It>>4)-1])[0],$n=Jt(D,z);fe.push({name:pt,index:Ai,type:$n,compression:ei}),Ce-=pt.length+3}const Oe=ge.channels,qe=new Array(S.channels);for(let pt=0;pt<S.channels;++pt){const It=qe[pt]={},ei=Oe[pt];It.name=ei.name,It.compression=0,It.decoded=!1,It.type=ei.pixelType,It.pLinear=ei.pLinear,It.width=S.width,It.height=S.lines}const Be={idx:new Array(3)};for(let pt=0;pt<S.channels;++pt){const It=qe[pt];for(let ei=0;ei<fe.length;++ei){const an=fe[ei];It.name==an.name&&(It.compression=an.compression,an.index>=0&&(Be.idx[an.index]=pt),It.offset=pt)}}let Xe,Je,He;if(be.acCompressedSize>0)switch(be.acCompression){case 0:Xe=new Uint16Array(be.totalAcUncompressedCount),et(S.array,D,z,be.acCompressedSize,Xe,be.totalAcUncompressedCount);break;case 1:const It=kc(S.array.slice(z.value,z.value+be.totalAcUncompressedCount));Xe=new Uint16Array(It.buffer),z.value+=be.totalAcUncompressedCount}be.dcCompressedSize>0&&(Je=new Uint16Array(Se({array:S.array,offset:z,size:be.dcCompressedSize}).buffer),z.value+=be.dcCompressedSize),be.rleRawSize>0&&(He=$e(kc(S.array.slice(z.value,z.value+be.rleCompressedSize)).buffer),z.value+=be.rleCompressedSize);let Bt=0;const Et=new Array(qe.length);for(let pt=0;pt<Et.length;++pt)Et[pt]=new Array;for(let pt=0;pt<S.lines;++pt)for(let It=0;It<qe.length;++It)Et[It].push(Bt),Bt+=qe[It].width*S.type*2;!function We(S,D,z,ne,be,fe){let Ce=new DataView(fe.buffer);const Oe=z[S.idx[0]].width,qe=z[S.idx[0]].height,Xe=Math.floor(Oe/8),Je=Math.ceil(Oe/8),He=Math.ceil(qe/8),Bt=Oe-8*(Je-1),Et=qe-8*(He-1),pt={value:0},It=new Array(3),ei=new Array(3),an=new Array(3),Ai=new Array(3),$n=new Array(3);for(let Qt=0;Qt<3;++Qt)$n[Qt]=D[S.idx[Qt]],It[Qt]=Qt<1?0:It[Qt-1]+Je*He,ei[Qt]=new Float32Array(64),an[Qt]=new Uint16Array(64),Ai[Qt]=new Uint16Array(64*Je);for(let Qt=0;Qt<He;++Qt){let Rn=8;Qt==He-1&&(Rn=Et);let Bs=8;for(let Wi=0;Wi<Je;++Wi){Wi==Je-1&&(Bs=Bt);for(let ln=0;ln<3;++ln)an[ln].fill(0),an[ln][0]=be[It[ln]++],yt(pt,ne,an[ln]),ht(an[ln],ei[ln]),ot(ei[ln]);St(ei);for(let ln=0;ln<3;++ln)ft(ei[ln],Ai[ln],64*Wi)}let Jn=0;for(let Wi=0;Wi<3;++Wi){const ln=z[S.idx[Wi]].type;for(let Gl=8*Qt;Gl<8*Qt+Rn;++Gl){Jn=$n[Wi][Gl];for(let Yb=0;Yb<Xe;++Yb){const Ja=64*Yb+8*(7&Gl);Ce.setUint16(Jn+0*ln,Ai[Wi][Ja+0],!0),Ce.setUint16(Jn+2*ln,Ai[Wi][Ja+1],!0),Ce.setUint16(Jn+4*ln,Ai[Wi][Ja+2],!0),Ce.setUint16(Jn+6*ln,Ai[Wi][Ja+3],!0),Ce.setUint16(Jn+8*ln,Ai[Wi][Ja+4],!0),Ce.setUint16(Jn+10*ln,Ai[Wi][Ja+5],!0),Ce.setUint16(Jn+12*ln,Ai[Wi][Ja+6],!0),Ce.setUint16(Jn+14*ln,Ai[Wi][Ja+7],!0),Jn+=16*ln}}if(Xe!=Je)for(let Gl=8*Qt;Gl<8*Qt+Rn;++Gl){const Yb=$n[Wi][Gl]+8*Xe*2*ln,Ja=64*Xe+8*(7&Gl);for(let ZC=0;ZC<Bs;++ZC)Ce.setUint16(Yb+2*ZC*ln,Ai[Wi][Ja+ZC],!0)}}}const Qi=new Uint16Array(Oe);Ce=new DataView(fe.buffer);for(let Qt=0;Qt<3;++Qt){z[S.idx[Qt]].decoded=!0;const Rn=z[S.idx[Qt]].type;if(2==z[Qt].type)for(let Bs=0;Bs<qe;++Bs){const Jn=$n[Qt][Bs];for(let Wi=0;Wi<Oe;++Wi)Qi[Wi]=Ce.getUint16(Jn+2*Wi*Rn,!0);for(let Wi=0;Wi<Oe;++Wi)Ce.setFloat32(Jn+2*Wi*Rn,ie(Qi[Wi]),!0)}}}(Be,Et,qe,Xe,Je,ne);for(let pt=0;pt<qe.length;++pt){const It=qe[pt];if(!It.decoded){if(2!==It.compression)throw new Error("EXRLoader.parse: unsupported channel compression");{let ei=0,an=0;for(let Ai=0;Ai<S.lines;++Ai){let $n=Et[pt][ei];for(let Qi=0;Qi<It.width;++Qi){for(let Qt=0;Qt<2*It.type;++Qt)ne[$n++]=He[an+Qt*It.width*It.height];an++}ei++}}}}return new DataView(ne.buffer)}function H(S,D){const z=new Uint8Array(S);let ne=0;for(;0!=z[D.value+ne];)ne+=1;const be=(new TextDecoder).decode(z.slice(D.value,D.value+ne));return D.value=D.value+ne+1,be}function nt(S,D){const z=S.getInt32(D.value,!0);return D.value=D.value+4,z}function rt(S,D){const z=S.getUint32(D.value,!0);return D.value=D.value+4,z}function At(S,D){const z=S[D.value];return D.value=D.value+1,z}function Jt(S,D){const z=S.getUint8(D.value);return D.value=D.value+1,z}const Ft=function(S,D){const z=Number(S.getBigInt64(D.value,!0));return D.value+=8,z};function Ot(S,D){const z=S.getFloat32(D.value,!0);return D.value+=4,z}function re(S,D){return cs.toHalfFloat(Ot(S,D))}function ie(S){const D=(31744&S)>>10,z=1023&S;return(S>>15?-1:1)*(D?31===D?z?NaN:1/0:Math.pow(2,D-15)*(1+z/1024):z/1024*6103515625e-14)}function je(S,D){const z=S.getUint16(D.value,!0);return D.value+=2,z}function dt(S,D){return ie(je(S,D))}function Fs(S,D,z,ne,be){return"string"===ne||"stringvector"===ne||"iccProfile"===ne?function te(S,D,z){const ne=(new TextDecoder).decode(new Uint8Array(S).slice(D.value,D.value+z));return D.value=D.value+z,ne}(D,z,be):"chlist"===ne?function Tt(S,D,z,ne){const be=z.value,fe=[];for(;z.value<be+ne-1;){const Ce=H(D,z),Oe=nt(S,z),qe=Jt(S,z);z.value+=3;const Be=nt(S,z),Xe=nt(S,z);fe.push({name:Ce,pixelType:Oe,pLinear:qe,xSampling:Be,ySampling:Xe})}return z.value+=1,fe}(S,D,z,be):"chromaticities"===ne?function ki(S,D){return{redX:Ot(S,D),redY:Ot(S,D),greenX:Ot(S,D),greenY:Ot(S,D),blueX:Ot(S,D),blueY:Ot(S,D),whiteX:Ot(S,D),whiteY:Ot(S,D)}}(S,z):"compression"===ne?function lr(S,D){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][Jt(S,D)]}(S,z):"box2i"===ne?function Dr(S,D){return{xMin:rt(S,D),yMin:rt(S,D),xMax:rt(S,D),yMax:rt(S,D)}}(S,z):"lineOrder"===ne?function Hl(S,D){return["INCREASING_Y"][Jt(S,D)]}(S,z):"float"===ne?Ot(S,z):"v2f"===ne?function on(S,D){return[Ot(S,D),Ot(S,D)]}(S,z):"v3f"===ne?function pa(S,D){return[Ot(S,D),Ot(S,D),Ot(S,D)]}(S,z):"int"===ne?nt(S,z):"rational"===ne?function tt(S,D){return[nt(S,D),rt(S,D)]}(S,z):"timecode"===ne?function lt(S,D){return[rt(S,D),rt(S,D)]}(S,z):"preview"===ne?(z.value+=be,"skipped"):void(z.value+=be)}const xg=new DataView(e),S2=new Uint8Array(e),j={value:0},ge=function YC(S,D,z){const ne={};if(20000630!=S.getUint32(0,!0))throw new Error("THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.");ne.version=S.getUint8(4);const be=S.getUint8(5);ne.spec={singleTile:!!(2&be),longName:!!(4&be),deepFormat:!!(8&be),multiPart:!!(16&be)},z.value=8;let fe=!0;for(;fe;){const Ce=H(D,z);if(0==Ce)fe=!1;else{const Oe=H(D,z),Be=Fs(S,D,z,Oe,rt(S,z));void 0===Be?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${Oe}'.`):ne[Ce]=Be}}if(-5&be)throw console.error("EXRHeader:",ne),new Error("THREE.EXRLoader: provided file is currently unsupported.");return ne}(xg,e,j),me=function E2(S,D,z,ne,be){const fe={size:0,viewer:D,array:z,offset:ne,width:S.dataWindow.xMax-S.dataWindow.xMin+1,height:S.dataWindow.yMax-S.dataWindow.yMin+1,channels:S.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:S.channels[0].pixelType,uncompress:null,getter:null,format:null,encoding:null};switch(S.compression){case"NO_COMPRESSION":fe.lines=1,fe.uncompress=k;break;case"RLE_COMPRESSION":fe.lines=1,fe.uncompress=_e;break;case"ZIPS_COMPRESSION":fe.lines=1,fe.uncompress=Se;break;case"ZIP_COMPRESSION":fe.lines=16,fe.uncompress=Se;break;case"PIZ_COMPRESSION":fe.lines=32,fe.uncompress=Ue;break;case"PXR24_COMPRESSION":fe.lines=16,fe.uncompress=Ze;break;case"DWAA_COMPRESSION":fe.lines=32,fe.uncompress=bt;break;case"DWAB_COMPRESSION":fe.lines=256,fe.uncompress=bt;break;default:throw new Error("EXRLoader.parse: "+S.compression+" is unsupported")}if(fe.scanlineBlockSize=fe.lines,1==fe.type)switch(be){case Ln:fe.getter=dt,fe.inputSize=2;break;case fn:fe.getter=je,fe.inputSize=2}else{if(2!=fe.type)throw new Error("EXRLoader.parse: unsupported pixelType "+fe.type+" for "+S.compression+".");switch(be){case Ln:fe.getter=Ot,fe.inputSize=4;break;case fn:fe.getter=re,fe.inputSize=4}}fe.blockCount=(S.dataWindow.yMax+1)/fe.scanlineBlockSize;for(let Oe=0;Oe<fe.blockCount;Oe++)Ft(D,ne);fe.outputChannels=3==fe.channels?4:fe.channels;const Ce=fe.width*fe.height*fe.outputChannels;switch(be){case Ln:fe.byteArray=new Float32Array(Ce),fe.channels<fe.outputChannels&&fe.byteArray.fill(1,0,Ce);break;case fn:fe.byteArray=new Uint16Array(Ce),fe.channels<fe.outputChannels&&fe.byteArray.fill(15360,0,Ce);break;default:console.error("THREE.EXRLoader: unsupported type: ",be)}return fe.bytesPerLine=fe.width*fe.inputSize*fe.channels,4==fe.outputChannels?(fe.format=En,fe.encoding=Ys):(fe.format=bl,fe.encoding=Ys),fe}(ge,xg,S2,j,this.type),pe={value:0},Te={R:0,G:1,B:2,A:3,Y:0};for(let S=0;S<me.height/me.scanlineBlockSize;S++){const D=rt(xg,j);me.size=rt(xg,j),me.lines=D+me.scanlineBlockSize>me.height?me.height-D:me.scanlineBlockSize;const ne=me.size<me.lines*me.bytesPerLine?me.uncompress(me):k(me);j.value+=me.size;for(let be=0;be<me.scanlineBlockSize;be++){const fe=be+S*me.scanlineBlockSize;if(fe>=me.height)break;for(let Ce=0;Ce<me.channels;Ce++){const Oe=Te[ge.channels[Ce].name];for(let qe=0;qe<me.width;qe++)pe.value=(be*(me.channels*me.width)+Ce*me.width+qe)*me.inputSize,me.byteArray[me.width*me.outputChannels*(me.height-1-fe)+qe*me.outputChannels+Oe]=me.getter(ne,pe)}}}return{header:ge,width:me.width,height:me.height,data:me.byteArray,format:me.format,encoding:me.encoding,type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,r){return super.load(e,function s(o,a){o.encoding=a.encoding,o.minFilter=Li,o.magFilter=Li,o.generateMipmaps=!1,o.flipY=!1,t&&t(o,a)},n,r)}}class $c extends Do{constructor(){super(...arguments),this.clazz=Mge}}$c.\u0275fac=function(){let i;return function(t){return(i||(i=ce($c)))(t||$c)}}(),$c.\u0275prov=Ne({token:$c,factory:$c.\u0275fac,providedIn:"root"});class oC extends la{constructor(e){super(),this.service=e}}oC.\u0275fac=function(e){return new(e||oC)(R($c,16))},oC.\u0275pipe=gi({name:"loadEXRTexture",type:oC,pure:!0});class aC extends Rs{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}aC.\u0275fac=function(e){return new(e||aC)(R(fa,1),R(at),R($c))},aC.\u0275dir=ke({type:aC,selectors:[["","loadEXRTexture",""]],features:[W]});class Ege extends cp{constructor(e){super(e),this.type=fn}parse(e){const a=function(b,y){switch(b){case 1:console.error("THREE.RGBELoader Read Error: "+(y||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(y||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(y||""));break;default:console.error("THREE.RGBELoader: Error: "+(y||""))}return-1},h=function(b,y,x){y=y||1024;let M=b.pos,w=-1,E=0,I="",F=String.fromCharCode.apply(null,new Uint16Array(b.subarray(M,M+128)));for(;0>(w=F.indexOf("\n"))&&E<y&&M<b.byteLength;)I+=F,E+=F.length,M+=128,F+=String.fromCharCode.apply(null,new Uint16Array(b.subarray(M,M+128)));return-1<w&&(!1!==x&&(b.pos+=E+w+1),I+F.slice(0,w))},p=function(b,y,x,C){const w=Math.pow(2,b[y+3]-128)/255;x[C+0]=b[y+0]*w,x[C+1]=b[y+1]*w,x[C+2]=b[y+2]*w,x[C+3]=1},g=function(b,y,x,C){const w=Math.pow(2,b[y+3]-128)/255;x[C+0]=cs.toHalfFloat(Math.min(b[y+0]*w,65504)),x[C+1]=cs.toHalfFloat(Math.min(b[y+1]*w,65504)),x[C+2]=cs.toHalfFloat(Math.min(b[y+2]*w,65504)),x[C+3]=cs.toHalfFloat(1)},_=new Uint8Array(e);_.pos=0;const v=function(b){const x=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,C=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,M=/^\s*FORMAT=(\S+)\s*$/,w=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,E={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let I,F;if(b.pos>=b.byteLength||!(I=h(b)))return a(1,"no header found");if(!(F=I.match(/^#\?(\S+)/)))return a(3,"bad initial token");for(E.valid|=1,E.programtype=F[1],E.string+=I+"\n";I=h(b),!1!==I;)if(E.string+=I+"\n","#"!==I.charAt(0)){if((F=I.match(x))&&(E.gamma=parseFloat(F[1])),(F=I.match(C))&&(E.exposure=parseFloat(F[1])),(F=I.match(M))&&(E.valid|=2,E.format=F[1]),(F=I.match(w))&&(E.valid|=4,E.height=parseInt(F[1],10),E.width=parseInt(F[2],10)),2&E.valid&&4&E.valid)break}else E.comments+=I+"\n";return 2&E.valid?4&E.valid?E:a(3,"missing image size specifier"):a(3,"missing format specifier")}(_);if(-1!==v){const b=v.width,y=v.height,x=function(b,y,x){const C=y;if(C<8||C>32767||2!==b[0]||2!==b[1]||128&b[2])return new Uint8Array(b);if(C!==(b[2]<<8|b[3]))return a(3,"wrong scanline width");const M=new Uint8Array(4*y*x);if(!M.length)return a(4,"unable to allocate buffer space");let w=0,E=0;const I=4*C,F=new Uint8Array(4),Q=new Uint8Array(I);let B=x;for(;B>0&&E<b.byteLength;){if(E+4>b.byteLength)return a(1);if(F[0]=b[E++],F[1]=b[E++],F[2]=b[E++],F[3]=b[E++],2!=F[0]||2!=F[1]||(F[2]<<8|F[3])!=C)return a(3,"bad rgbe scanline format");let X,L=0;for(;L<I&&E<b.byteLength;){X=b[E++];const V=X>128;if(V&&(X-=128),0===X||L+X>I)return a(3,"bad scanline data");if(V){const O=b[E++];for(let q=0;q<X;q++)Q[L++]=O}else Q.set(b.subarray(E,E+X),L),L+=X,E+=X}const P=C;for(let V=0;V<P;V++){let O=0;M[w]=Q[V+O],O+=C,M[w+1]=Q[V+O],O+=C,M[w+2]=Q[V+O],O+=C,M[w+3]=Q[V+O],w+=4}B--}return M}(_.subarray(_.pos),b,y);if(-1!==x){let C,M,w;switch(this.type){case Ln:w=x.length/4;const E=new Float32Array(4*w);for(let F=0;F<w;F++)p(x,4*F,E,4*F);C=E,M=Ln;break;case fn:w=x.length/4;const I=new Uint16Array(4*w);for(let F=0;F<w;F++)g(x,4*F,I,4*F);C=I,M=fn;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:b,height:y,data:C,header:v.string,gamma:v.gamma,exposure:v.exposure,type:M}}}return null}setDataType(e){return this.type=e,this}load(e,t,n,r){return super.load(e,function s(o,a){switch(o.type){case Ln:case fn:o.encoding=Ys,o.minFilter=Li,o.magFilter=Li,o.generateMipmaps=!1,o.flipY=!0}t&&t(o,a)},n,r)}}class Jc extends Do{constructor(){super(...arguments),this.clazz=Ege}}Jc.\u0275fac=function(){let i;return function(t){return(i||(i=ce(Jc)))(t||Jc)}}(),Jc.\u0275prov=Ne({token:Jc,factory:Jc.\u0275fac,providedIn:"root"});class lC extends la{constructor(e){super(),this.service=e}}lC.\u0275fac=function(e){return new(e||lC)(R(Jc,16))},lC.\u0275pipe=gi({name:"loadRGBETexture",type:lC,pure:!0});class cC extends Rs{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}cC.\u0275fac=function(e){return new(e||cC)(R(fa,1),R(at),R(Jc))},cC.\u0275dir=ke({type:cC,selectors:[["","loadRGBETexture",""]],features:[W]});class Sge extends cp{constructor(e){super(e),this.type=fn,this.maxRange=7}setDataType(e){return this.type=e,this}setMaxRange(e){return this.maxRange=e,this}loadCubemap(e,t,n,r){const s=new qd;let o=0;const a=this;function l(c){a.load(e[c],function(d){s.images[c]=d,o++,6===o&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s.type=this.type,s.format=En,s.minFilter=Li,s.generateMipmaps=!1,s}parse(e){const t=si.decode(e),n=si.toRGBA8(t)[0],r=new Uint8Array(n),s=t.width*t.height*4,o=this.type===fn?new Uint16Array(s):new Float32Array(s);for(let a=0;a<r.length;a+=4){const l=r[a+0]/255,c=r[a+1]/255,d=r[a+2]/255,u=r[a+3]/255;this.type===fn?(o[a+0]=cs.toHalfFloat(Math.min(l*u*this.maxRange,65504)),o[a+1]=cs.toHalfFloat(Math.min(c*u*this.maxRange,65504)),o[a+2]=cs.toHalfFloat(Math.min(d*u*this.maxRange,65504)),o[a+3]=cs.toHalfFloat(1)):(o[a+0]=l*u*this.maxRange,o[a+1]=c*u*this.maxRange,o[a+2]=d*u*this.maxRange,o[a+3]=1)}return{width:t.width,height:t.height,data:o,format:En,type:this.type,flipY:!0}}}var e,t,i,si={toRGBA8:function(i){var e=i.width,t=i.height;if(null==i.tabs.acTL)return[si.toRGBA8.decodeImage(i.data,e,t,i).buffer];var n=[];null==i.frames[0].data&&(i.frames[0].data=i.data);for(var r=e*t*4,s=new Uint8Array(r),o=new Uint8Array(r),a=new Uint8Array(r),l=0;l<i.frames.length;l++){var c=i.frames[l],d=c.rect.x,u=c.rect.y,h=c.rect.width,f=c.rect.height,m=si.toRGBA8.decodeImage(c.data,h,f,i);if(0!=l)for(var p=0;p<r;p++)a[p]=s[p];if(0==c.blend?si._copyTile(m,h,f,s,e,t,d,u,0):1==c.blend&&si._copyTile(m,h,f,s,e,t,d,u,1),n.push(s.buffer.slice(0)),1==c.dispose)si._copyTile(o,h,f,s,e,t,d,u,0);else if(2==c.dispose)for(p=0;p<r;p++)s[p]=a[p]}return n}};si.toRGBA8.decodeImage=function(i,e,t,n){var r=e*t,s=si.decode._getBPP(n),o=Math.ceil(e*s/8),a=new Uint8Array(4*r),l=new Uint32Array(a.buffer),c=n.ctype,d=n.depth,u=si._bin.readUshort;if(6==c){var h=r<<2;if(8==d)for(var f=0;f<h;f+=4)a[f]=i[f],a[f+1]=i[f+1],a[f+2]=i[f+2],a[f+3]=i[f+3];if(16==d)for(f=0;f<h;f++)a[f]=i[f<<1]}else if(2==c){var m=n.tabs.tRNS;if(null==m){if(8==d)for(f=0;f<r;f++)l[f]=255<<24|i[2+(p=3*f)]<<16|i[p+1]<<8|i[p];if(16==d)for(f=0;f<r;f++)l[f]=255<<24|i[4+(p=6*f)]<<16|i[p+2]<<8|i[p]}else{var g=m[0],_=m[1],v=m[2];if(8==d)for(f=0;f<r;f++){var b=f<<2;l[f]=255<<24|i[2+(p=3*f)]<<16|i[p+1]<<8|i[p],i[p]==g&&i[p+1]==_&&i[p+2]==v&&(a[b+3]=0)}if(16==d)for(f=0;f<r;f++){var p;b=f<<2,l[f]=255<<24|i[4+(p=6*f)]<<16|i[p+2]<<8|i[p],u(i,p)==g&&u(i,p+2)==_&&u(i,p+4)==v&&(a[b+3]=0)}}}else if(3==c){var y=n.tabs.PLTE,x=n.tabs.tRNS,C=x?x.length:0;if(1==d)for(var M=0;M<t;M++){var w=M*o,E=M*e;for(f=0;f<e;f++)a[b=E+f<<2]=y[F=3*(I=i[w+(f>>3)]>>7-((7&f)<<0)&1)],a[b+1]=y[F+1],a[b+2]=y[F+2],a[b+3]=I<C?x[I]:255}if(2==d)for(M=0;M<t;M++)for(w=M*o,E=M*e,f=0;f<e;f++)a[b=E+f<<2]=y[F=3*(I=i[w+(f>>2)]>>6-((3&f)<<1)&3)],a[b+1]=y[F+1],a[b+2]=y[F+2],a[b+3]=I<C?x[I]:255;if(4==d)for(M=0;M<t;M++)for(w=M*o,E=M*e,f=0;f<e;f++)a[b=E+f<<2]=y[F=3*(I=i[w+(f>>1)]>>4-((1&f)<<2)&15)],a[b+1]=y[F+1],a[b+2]=y[F+2],a[b+3]=I<C?x[I]:255;if(8==d)for(f=0;f<r;f++){var I,F;a[b=f<<2]=y[F=3*(I=i[f])],a[b+1]=y[F+1],a[b+2]=y[F+2],a[b+3]=I<C?x[I]:255}}else if(4==c){if(8==d)for(f=0;f<r;f++)a[b=f<<2]=B=i[Q=f<<1],a[b+1]=B,a[b+2]=B,a[b+3]=i[Q+1];if(16==d)for(f=0;f<r;f++){var Q;a[b=f<<2]=B=i[Q=f<<2],a[b+1]=B,a[b+2]=B,a[b+3]=i[Q+2]}}else if(0==c)for(g=n.tabs.tRNS?n.tabs.tRNS:-1,M=0;M<t;M++){var L=M*o,X=M*e;if(1==d)for(var P=0;P<e;P++)l[X+P]=(V=(B=255*(i[L+(P>>>3)]>>>7-(7&P)&1))==255*g?0:255)<<24|B<<16|B<<8|B;else if(2==d)for(P=0;P<e;P++)l[X+P]=(V=(B=85*(i[L+(P>>>2)]>>>6-((3&P)<<1)&3))==85*g?0:255)<<24|B<<16|B<<8|B;else if(4==d)for(P=0;P<e;P++)l[X+P]=(V=(B=17*(i[L+(P>>>1)]>>>4-((1&P)<<2)&15))==17*g?0:255)<<24|B<<16|B<<8|B;else if(8==d)for(P=0;P<e;P++)l[X+P]=(V=(B=i[L+P])==g?0:255)<<24|B<<16|B<<8|B;else if(16==d)for(P=0;P<e;P++){var B=i[L+(P<<1)],V=u(i,L+(P<<1))==g?0:255;l[X+P]=V<<24|B<<16|B<<8|B}}return a},si.decode=function(i){for(var c,u,h,f,e=new Uint8Array(i),t=8,n=si._bin,r=n.readUshort,s=n.readUint,o={tabs:{},frames:[]},a=new Uint8Array(e.length),l=0,d=0,m=[137,80,78,71,13,10,26,10],p=0;p<8;p++)if(e[p]!=m[p])throw new Error("The input is not a PNG file!");for(;t<e.length;){var g=n.readUint(e,t),_=n.readASCII(e,t+=4,4);if(t+=4,"IHDR"==_)si.decode._IHDR(e,t,o);else if("CgBI"==_)o.tabs[_]=e.slice(t,t+4);else if("IDAT"==_){for(p=0;p<g;p++)a[l+p]=e[t+p];l+=g}else if("acTL"==_)o.tabs[_]={num_frames:s(e,t),num_plays:s(e,t+4)},c=new Uint8Array(e.length);else if("fcTL"==_){0!=d&&((v=o.frames[o.frames.length-1]).data=si.decode._decompress(o,c.slice(0,d),v.rect.width,v.rect.height),d=0);var b={x:s(e,t+12),y:s(e,t+16),width:s(e,t+4),height:s(e,t+8)},y=r(e,t+22);y=r(e,t+20)/(0==y?100:y);var x={rect:b,delay:Math.round(1e3*y),dispose:e[t+24],blend:e[t+25]};o.frames.push(x)}else if("fdAT"==_){for(p=0;p<g-4;p++)c[d+p]=e[t+p+4];d+=g-4}else if("pHYs"==_)o.tabs[_]=[n.readUint(e,t),n.readUint(e,t+4),e[t+8]];else if("cHRM"==_)for(o.tabs[_]=[],p=0;p<8;p++)o.tabs[_].push(n.readUint(e,t+4*p));else if("tEXt"==_||"zTXt"==_){null==o.tabs[_]&&(o.tabs[_]={});var C=n.nextZero(e,t);h=n.readASCII(e,t,C-t);var M=t+g-C-1;"tEXt"==_?u=n.readASCII(e,C+1,M):(f=si.decode._inflate(e.slice(C+2,C+2+M)),u=n.readUTF8(f,0,f.length)),o.tabs[_][h]=u}else if("iTXt"==_){null==o.tabs[_]&&(o.tabs[_]={}),C=0;var w=t;C=n.nextZero(e,w),h=n.readASCII(e,w,C-w);var E=e[w=C+1];C=n.nextZero(e,w+=2),n.readASCII(e,w,C-w),C=n.nextZero(e,w=C+1),n.readUTF8(e,w,C-w),M=g-((w=C+1)-t),0==E?u=n.readUTF8(e,w,M):(f=si.decode._inflate(e.slice(w,w+M)),u=n.readUTF8(f,0,f.length)),o.tabs[_][h]=u}else if("PLTE"==_)o.tabs[_]=n.readBytes(e,t,g);else if("hIST"==_){var I=o.tabs.PLTE.length/3;for(o.tabs[_]=[],p=0;p<I;p++)o.tabs[_].push(r(e,t+2*p))}else if("tRNS"==_)3==o.ctype?o.tabs[_]=n.readBytes(e,t,g):0==o.ctype?o.tabs[_]=r(e,t):2==o.ctype&&(o.tabs[_]=[r(e,t),r(e,t+2),r(e,t+4)]);else if("gAMA"==_)o.tabs[_]=n.readUint(e,t)/1e5;else if("sRGB"==_)o.tabs[_]=e[t];else if("bKGD"==_)0==o.ctype||4==o.ctype?o.tabs[_]=[r(e,t)]:2==o.ctype||6==o.ctype?o.tabs[_]=[r(e,t),r(e,t+2),r(e,t+4)]:3==o.ctype&&(o.tabs[_]=e[t]);else if("IEND"==_)break;n.readUint(e,t+=g),t+=4}var v;return 0!=d&&((v=o.frames[o.frames.length-1]).data=si.decode._decompress(o,c.slice(0,d),v.rect.width,v.rect.height)),o.data=si.decode._decompress(o,a,o.width,o.height),delete o.compress,delete o.interlace,delete o.filter,o},si.decode._decompress=function(i,e,t,n){var r=si.decode._getBPP(i),s=Math.ceil(t*r/8),o=new Uint8Array((s+1+i.interlace)*n);return e=i.tabs.CgBI?si.inflateRaw(e,o):si.decode._inflate(e,o),0==i.interlace?e=si.decode._filterZero(e,i,0,t,n):1==i.interlace&&(e=si.decode._readInterlace(e,i)),e},si.decode._inflate=function(i,e){return si.inflateRaw(new Uint8Array(i.buffer,2,i.length-6),e)},si.inflateRaw=((i={H:{}}).H.N=function(e,t){var f,m,n=Uint8Array,r=0,s=0,o=0,a=0,l=0,c=0,d=0,u=0,h=0;if(3==e[0]&&0==e[1])return t||new n(0);var p=i.H,g=p.b,_=p.e,v=p.R,b=p.n,y=p.A,x=p.Z,C=p.m,M=null==t;for(M&&(t=new n(e.length>>>2<<5));0==r;)if(r=g(e,h,1),s=g(e,h+1,2),h+=3,0!=s){if(M&&(t=i.H.W(t,u+(1<<17))),1==s&&(f=C.J,m=C.h,c=511,d=31),2==s){o=_(e,h,5)+257,a=_(e,h+5,5)+1,l=_(e,h+10,4)+4,h+=14;for(var I=1,F=0;F<38;F+=2)C.Q[F]=0,C.Q[F+1]=0;for(F=0;F<l;F++){var Q=_(e,h+3*F,3);C.Q[1+(C.X[F]<<1)]=Q,Q>I&&(I=Q)}h+=3*l,b(C.Q,I),y(C.Q,I,C.u),f=C.w,m=C.d,h=v(C.u,(1<<I)-1,o+a,e,h,C.v);var B=p.V(C.v,0,o,C.C);c=(1<<B)-1;var L=p.V(C.v,o,a,C.D);d=(1<<L)-1,b(C.C,B),y(C.C,B,f),b(C.D,L),y(C.D,L,m)}for(;;){var X=f[x(e,h)&c];h+=15&X;var P=X>>>4;if(P>>>8){if(256==P)break;var V=u+P-254;if(P>264){var O=C.q[P-257];V=u+(O>>>3)+_(e,h,7&O),h+=7&O}var q=m[x(e,h)&d],Z=C.c[q>>>4],Y=(Z>>>4)+g(e,h+=15&q,15&Z);for(h+=15&Z;u<V;)t[u]=t[u++-Y],t[u]=t[u++-Y],t[u]=t[u++-Y],t[u]=t[u++-Y];u=V}else t[u++]=P}}else{7&h&&(h+=8-(7&h));var w=4+(h>>>3),E=e[w-4]|e[w-3]<<8;M&&(t=i.H.W(t,u+E)),t.set(new n(e.buffer,e.byteOffset+w,E),u),h=w+E<<3,u+=E}return t.length==u?t:t.slice(0,u)},i.H.W=function(e,t){var n=e.length;if(t<=n)return e;var r=new Uint8Array(n<<1);return r.set(e,0),r},i.H.R=function(e,t,n,r,s,o){for(var a=i.H.e,l=i.H.Z,c=0;c<n;){var d=e[l(r,s)&t];s+=15&d;var u=d>>>4;if(u<=15)o[c]=u,c++;else{var h=0,f=0;16==u?(f=3+a(r,s,2),s+=2,h=o[c-1]):17==u?(f=3+a(r,s,3),s+=3):18==u&&(f=11+a(r,s,7),s+=7);for(var m=c+f;c<m;)o[c]=h,c++}}return s},i.H.V=function(e,t,n,r){for(var s=0,o=0,a=r.length>>>1;o<n;){var l=e[o+t];r[o<<1]=0,r[1+(o<<1)]=l,l>s&&(s=l),o++}for(;o<a;)r[o<<1]=0,r[1+(o<<1)]=0,o++;return s},i.H.n=function(e,t){for(var s,o,a,c,n=i.H.m,r=e.length,d=n.j,l=0;l<=t;l++)d[l]=0;for(l=1;l<r;l+=2)d[e[l]]++;var u=n.K;for(s=0,d[0]=0,o=1;o<=t;o++)u[o]=s=s+d[o-1]<<1;for(a=0;a<r;a+=2)0!=(c=e[a+1])&&(e[a]=u[c],u[c]++)},i.H.A=function(e,t,n){for(var r=e.length,o=i.H.m.r,a=0;a<r;a+=2)if(0!=e[a+1])for(var c=e[a+1],d=a>>1<<4|c,u=t-c,h=e[a]<<u,f=h+(1<<u);h!=f;)n[o[h]>>>15-t]=d,h++},i.H.l=function(e,t){for(var n=i.H.m.r,r=15-t,s=0;s<e.length;s+=2)e[s]=n[e[s]<<t-e[s+1]]>>>r},i.H.M=function(e,t,n){var r=t>>>3;e[r]|=n<<=7&t,e[r+1]|=n>>>8},i.H.I=function(e,t,n){var r=t>>>3;e[r]|=n<<=7&t,e[r+1]|=n>>>8,e[r+2]|=n>>>16},i.H.e=function(e,t,n){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<n)-1},i.H.b=function(e,t,n){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<n)-1},i.H.Z=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},i.H.i=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},i.H.m=(e=Uint16Array,t=Uint32Array,{K:new e(16),j:new e(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new e(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new t(32),J:new e(512),_:[],h:new e(32),$:[],w:new e(32768),C:[],v:[],d:new e(32768),D:[],u:new e(512),Q:[],r:new e(32768),s:new t(286),Y:new t(30),a:new t(19),t:new t(15e3),k:new e(65536),g:new e(32768)}),function(){for(var e=i.H.m,n=0;n<32768;n++){var r=n;e.r[n]=((r=(4278255360&(r=(4042322160&(r=(3435973836&(r=(2863311530&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8)>>>16|r<<16)>>>17}function s(o,a,l){for(;0!=a--;)o.push(0,l)}for(n=0;n<32;n++)e.q[n]=e.S[n]<<3|e.T[n],e.c[n]=e.p[n]<<4|e.z[n];s(e._,144,8),s(e._,112,9),s(e._,24,7),s(e._,8,8),i.H.n(e._,9),i.H.A(e._,9,e.J),i.H.l(e._,9),s(e.$,32,5),i.H.n(e.$,5),i.H.A(e.$,5,e.h),i.H.l(e.$,5),s(e.Q,19,0),s(e.C,286,0),s(e.D,30,0),s(e.v,320,0)}(),i.H.N),si.decode._readInterlace=function(i,e){for(var t=e.width,n=e.height,r=si.decode._getBPP(e),s=r>>3,o=Math.ceil(t*r/8),a=new Uint8Array(n*o),l=0,c=[0,0,4,0,2,0,1],d=[0,4,0,2,0,1,0],u=[8,8,8,4,4,2,2],h=[8,8,4,4,2,2,1],f=0;f<7;){for(var m=u[f],p=h[f],g=0,_=0,v=c[f];v<n;)v+=m,_++;for(var b=d[f];b<t;)b+=p,g++;var y=Math.ceil(g*r/8);si.decode._filterZero(i,e,l,g,_);for(var x=0,C=c[f];C<n;){for(var w=d[f],E=l+x*y<<3;w<t;){if(1==r&&(a[C*o+(w>>3)]|=(i[E>>3]>>7-(7&E)&1)<<7-((7&w)<<0)),2==r&&(a[C*o+(w>>2)]|=(i[E>>3]>>6-(7&E)&3)<<6-((3&w)<<1)),4==r&&(a[C*o+(w>>1)]|=(i[E>>3]>>4-(7&E)&15)<<4-((1&w)<<2)),r>=8)for(var I=C*o+w*s,F=0;F<s;F++)a[I+F]=i[(E>>3)+F];E+=r,w+=p}x++,C+=m}g*_!=0&&(l+=_*(1+y)),f+=1}return a},si.decode._getBPP=function(i){return[1,null,3,1,2,null,4][i.ctype]*i.depth},si.decode._filterZero=function(i,e,t,n,r){var s=si.decode._getBPP(e),o=Math.ceil(n*s/8),a=si.decode._paeth;s=Math.ceil(s/8);var l,c,d=i[t],u=0;if(d>1&&(i[t]=[0,0,1][d-2]),3==d)for(u=s;u<o;u++)i[u+1]=i[u+1]+(i[u+1-s]>>>1)&255;for(var h=0;h<r;h++)if(u=0,0==(d=i[(c=(l=t+h*o)+h+1)-1]))for(;u<o;u++)i[l+u]=i[c+u];else if(1==d){for(;u<s;u++)i[l+u]=i[c+u];for(;u<o;u++)i[l+u]=i[c+u]+i[l+u-s]}else if(2==d)for(;u<o;u++)i[l+u]=i[c+u]+i[l+u-o];else if(3==d){for(;u<s;u++)i[l+u]=i[c+u]+(i[l+u-o]>>>1);for(;u<o;u++)i[l+u]=i[c+u]+(i[l+u-o]+i[l+u-s]>>>1)}else{for(;u<s;u++)i[l+u]=i[c+u]+a(0,i[l+u-o],0);for(;u<o;u++)i[l+u]=i[c+u]+a(i[l+u-s],i[l+u-o],i[l+u-s-o])}return i},si.decode._paeth=function(i,e,t){var n=i+e-t,r=n-i,s=n-e,o=n-t;return r*r<=s*s&&r*r<=o*o?i:s*s<=o*o?e:t},si.decode._IHDR=function(i,e,t){var n=si._bin;t.width=n.readUint(i,e),t.height=n.readUint(i,e+=4),t.depth=i[e+=4],e++,t.ctype=i[e],e++,t.compress=i[e],e++,t.filter=i[e],e++,t.interlace=i[e],e++},si._bin={nextZero:function(i,e){for(;0!=i[e];)e++;return e},readUshort:function(i,e){return i[e]<<8|i[e+1]},writeUshort:function(i,e,t){i[e]=t>>8&255,i[e+1]=255&t},readUint:function(i,e){return 16777216*i[e]+(i[e+1]<<16|i[e+2]<<8|i[e+3])},writeUint:function(i,e,t){i[e]=t>>24&255,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=255&t},readASCII:function(i,e,t){for(var n="",r=0;r<t;r++)n+=String.fromCharCode(i[e+r]);return n},writeASCII:function(i,e,t){for(var n=0;n<t.length;n++)i[e+n]=t.charCodeAt(n)},readBytes:function(i,e,t){for(var n=[],r=0;r<t;r++)n.push(i[e+r]);return n},pad:function(i){return i.length<2?"0"+i:i},readUTF8:function(i,e,t){for(var r,n="",s=0;s<t;s++)n+="%"+si._bin.pad(i[e+s].toString(16));try{r=decodeURIComponent(n)}catch{return si._bin.readASCII(i,e,t)}return r}},si._copyTile=function(i,e,t,n,r,s,o,a,l){for(var c=Math.min(e,r),d=Math.min(t,s),u=0,h=0,f=0;f<d;f++)for(var m=0;m<c;m++)if(o>=0&&a>=0?(u=f*e+m<<2,h=(a+f)*r+o+m<<2):(u=(-a+f)*e-o+m<<2,h=f*r+m<<2),0==l)n[h]=i[u],n[h+1]=i[u+1],n[h+2]=i[u+2],n[h+3]=i[u+3];else if(1==l){var g=i[u]*(p=.00392156862745098*i[u+3]),_=i[u+1]*p,v=i[u+2]*p,y=n[h]*(b=n[h+3]*(1/255)),x=n[h+1]*b,C=n[h+2]*b,M=1-p,w=p+b*M,E=0==w?0:1/w;n[h+3]=255*w,n[h+0]=(g+y*M)*E,n[h+1]=(_+x*M)*E,n[h+2]=(v+C*M)*E}else if(2==l)g=i[u],_=i[u+1],v=i[u+2],y=n[h],x=n[h+1],C=n[h+2],(p=i[u+3])==(b=n[h+3])&&g==y&&_==x&&v==C?(n[h]=0,n[h+1]=0,n[h+2]=0,n[h+3]=0):(n[h]=g,n[h+1]=_,n[h+2]=v,n[h+3]=p);else if(3==l){var p,b;if(g=i[u],_=i[u+1],v=i[u+2],y=n[h],x=n[h+1],C=n[h+2],(p=i[u+3])==(b=n[h+3])&&g==y&&_==x&&v==C)continue;if(p<220&&b>20)return!1}return!0};class ed extends Do{constructor(){super(...arguments),this.clazz=Sge}}ed.\u0275fac=function(){let i;return function(t){return(i||(i=ce(ed)))(t||ed)}}(),ed.\u0275prov=Ne({token:ed,factory:ed.\u0275fac,providedIn:"root"});class dC extends la{constructor(e){super(),this.service=e}}dC.\u0275fac=function(e){return new(e||dC)(R(ed,16))},dC.\u0275pipe=gi({name:"loadRGBMTexture",type:dC,pure:!0});class uC extends Rs{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}uC.\u0275fac=function(e){return new(e||uC)(R(fa,1),R(at),R(ed))},uC.\u0275dir=ke({type:uC,selectors:[["","loadRGBMTexture",""]],features:[W]});class Tge extends cp{constructor(e){super(e),this.type=fn}parse(e){const t=ut.decode(e);ut.decodeImage(e,t[0]);const n=ut.toRGBA(t[0],this.type);return{width:t[0].width,height:t[0].height,data:n,format:En,type:this.type,flipY:!0}}setDataType(e){return this.type=e,this}}const ut={decode:function(i,e){null==e&&(e={parseMN:!0,debug:!1});var t=new Uint8Array(i),n=0,s="II"==ut._binBE.readASCII(t,n,2)?ut._binLE:ut._binBE;s.readUshort(t,n+=2);for(var o=s.readUint(t,n+=2),a=[];;){var l=s.readUshort(t,o),c=s.readUshort(t,o+4);if(0!=l&&(c<1||13<c)){console.log("error in TIFF");break}if(ut._readIFD(s,t,o,a,0,e),0==(o=s.readUint(t,o+2+12*l)))break}return a},decodeImage:function(i,e,t){if(!e.data){var n=new Uint8Array(i),r=ut._binBE.readASCII(n,0,2);if(null!=e.t256){e.isLE="II"==r,e.width=e.t256[0],e.height=e.t257[0];var a,s=e.t259?e.t259[0]:1,o=e.t266?e.t266[0]:1;e.t284&&2==e.t284[0]&&console.log("PlanarConfiguration 2 should not be used!"),7==s&&e.t258&&e.t258.length>3&&(e.t258=e.t258.slice(0,3)),a=e.t258?Math.min(32,e.t258[0])*e.t258.length:e.t277?e.t277[0]:1,1==s&&null!=e.t279&&e.t278&&32803==e.t262[0]&&(a=Math.round(8*e.t279[0]/(e.width*e.t278[0])));var l=8*Math.ceil(e.width*a/8),c=e.t273;null==c&&(c=e.t324);var d=e.t279;1==s&&1==c.length&&(d=[e.height*(l>>>3)]),null==d&&(d=e.t325);var u=new Uint8Array(e.height*(l>>>3)),h=0;if(null!=e.t322){for(var f=e.t322[0],m=e.t323[0],p=Math.floor((e.width+f-1)/f),g=Math.floor((e.height+m-1)/m),_=new Uint8Array(0|Math.ceil(f*m*a/8)),v=0;v<g;v++)for(var b=0;b<p;b++){for(var y=v*p+b,x=0;x<_.length;x++)_[x]=0;ut.decode._decompress(e,t,n,c[y],d[y],s,_,0,o),6==s?u=_:ut._copyTile(_,0|Math.ceil(f*a/8),m,u,0|Math.ceil(e.width*a/8),e.height,0|Math.ceil(b*f*a/8),v*m)}h=8*u.length}else{var C=e.t278?e.t278[0]:e.height;for(C=Math.min(C,e.height),y=0;y<c.length;y++)ut.decode._decompress(e,t,n,c[y],d[y],s,u,0|Math.ceil(h/8),o),h+=l*C;h=Math.min(h,8*u.length)}e.data=new Uint8Array(u.buffer,0,0|Math.ceil(h/8))}}}};ut.decode._decompress=function(i,e,t,n,r,s,o,a){34676==s?ut.decode._decodeLogLuv32(i,t,n,r,o,a):console.log("Unsupported compression",s);var l=i.t258?Math.min(32,i.t258[0]):1,c=i.t277?i.t277[0]:1,d=l*c>>>3,u=i.t278?i.t278[0]:i.height,h=Math.ceil(l*c*i.width/8);if(16==l&&!i.isLE&&null==i.t33422)for(var f=0;f<u;f++)for(var m=a+f*h,p=1;p<h;p+=2){var g=o[m+p];o[m+p]=o[m+p-1],o[m+p-1]=g}if(i.t317&&2==i.t317[0])for(f=0;f<u;f++){var _=a+f*h;if(16==l)for(var v=d;v<h;v+=2){var b=(o[_+v+1]<<8|o[_+v])+(o[_+v-d+1]<<8|o[_+v-d]);o[_+v]=255&b,o[_+v+1]=b>>>8&255}else if(3==c)for(v=3;v<h;v+=3)o[_+v]=o[_+v]+o[_+v-3]&255,o[_+v+1]=o[_+v+1]+o[_+v-2]&255,o[_+v+2]=o[_+v+2]+o[_+v-1]&255;else for(v=d;v<h;v++)o[_+v]=o[_+v]+o[_+v-d]&255}},ut.decode._decodeLogLuv32=function(i,e,t,n,r,s){for(var o=i.width,a=4*o,l=0,c=new Uint8Array(a);l<n;){for(var d=0;d<a;){var u=e[t+l];if(l++,u<128){for(var h=0;h<u;h++)c[d+h]=e[t+l+h];d+=u,l+=u}else{for(u-=126,h=0;h<u;h++)c[d+h]=e[t+l];d+=u,l++}}for(var f=0;f<o;f++)r[s+0]=c[f],r[s+1]=c[f+o],r[s+2]=c[f+2*o],r[s+4]=c[f+3*o],s+=6}},ut.tags={},ut._types=function(){var i=new Array(250);return i.fill(0),{basic:{main:i=i.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rest:{33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7}},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}}(),ut._readIFD=function(i,e,t,n,r,s){var o=i.readUshort(e,t);t+=2;var a={};s.debug&&console.log("   ".repeat(r),n.length-1,">>>----------------");for(var l=0;l<o;l++){var c=i.readUshort(e,t),d=i.readUshort(e,t+=2),u=i.readUint(e,t+=2),h=i.readUint(e,t+=4);t+=4;var f=[];if((1==d||7==d)&&(f=new Uint8Array(e.buffer,u<5?t-4:h,u)),2==d){var m=u<5?t-4:h,p=e[m],g=Math.max(0,Math.min(u-1,e.length-m));p<128||0==g?f.push(i.readASCII(e,m,g)):f=new Uint8Array(e.buffer,m,g)}if(3==d)for(var _=0;_<u;_++)f.push(i.readUshort(e,(u<3?t-4:h)+2*_));if(4==d||13==d)for(_=0;_<u;_++)f.push(i.readUint(e,(u<2?t-4:h)+4*_));if(5==d||10==d){var v=5==d?i.readUint:i.readInt;for(_=0;_<u;_++)f.push([v(e,h+8*_),v(e,h+8*_+4)])}if(8==d)for(_=0;_<u;_++)f.push(i.readShort(e,(u<3?t-4:h)+2*_));if(9==d)for(_=0;_<u;_++)f.push(i.readInt(e,(u<2?t-4:h)+4*_));if(11==d)for(_=0;_<u;_++)f.push(i.readFloat(e,h+4*_));if(12==d)for(_=0;_<u;_++)f.push(i.readDouble(e,h+8*_));if(0==u||0!=f.length){if(s.debug&&console.log("   ".repeat(r),c,d,ut.tags[c],f),a["t"+c]=f,330==c||34665==c||34853==c||50740==c&&i.readUshort(e,i.readUint(f,0))<300||61440==c){var b=50740==c?[i.readUint(f,0)]:f,y=[];for(_=0;_<b.length;_++)ut._readIFD(i,e,b[_],y,r+1,s);330==c&&(a.subIFD=y),34665==c&&(a.exifIFD=y[0]),34853==c&&(a.gpsiIFD=y[0]),50740==c&&(a.dngPrvt=y[0]),61440==c&&(a.fujiIFD=y[0])}if(37500==c&&s.parseMN){var x=f;if("Nikon"==i.readASCII(x,0,5))a.makerNote=ut.decode(x.slice(10).buffer)[0];else if(i.readUshort(e,h)<300&&i.readUshort(e,h+4)<=12){var C=[];ut._readIFD(i,e,h,C,r+1,s),a.makerNote=C[0]}}}else if(console.log(c,"unknown TIFF tag type: ",d,"num:",u),0==l)return}return n.push(a),s.debug&&console.log("   ".repeat(r),"<<<---------------"),t},ut.toRGBA=function(i,e){const t=i.width,n=i.height,r=t*n,s=i.data;let o;switch(e){case fn:o=new Uint16Array(4*r);break;case Ln:o=new Float32Array(4*r);break;default:console.error("THREE.LogLuvLoader: Unsupported texture data type:",e)}let a=i.t262?i.t262[0]:2;const l=i.t258?Math.min(32,i.t258[0]):1;if(null==i.t262&&1==l&&(a=0),32845==a)for(let c=0;c<n;c++)for(let d=0;d<t;d++){const u=6*(c*t+d),h=4*(c*t+d);let f=s[u+1]<<8|s[u];f=Math.pow(2,(f+.5)/256-64);const m=(s[u+3]+.5)/410,p=(s[u+5]+.5)/410,g=9*m/(6*m-16*p+12),_=4*p/(6*m-16*p+12),b=g*f/_,x=(1-g-_)*f/_,C=2.69*b-1.276*f-.414*x,M=-1.022*b+1.978*f+.044*x,w=.061*b-.224*f+1.163*x;e===fn?(o[h]=cs.toHalfFloat(Math.min(C,65504)),o[h+1]=cs.toHalfFloat(Math.min(M,65504)),o[h+2]=cs.toHalfFloat(Math.min(w,65504)),o[h+3]=cs.toHalfFloat(1)):(o[h]=C,o[h+1]=M,o[h+2]=w,o[h+3]=1)}else console.log("Unsupported Photometric interpretation: "+a);return o},ut._binBE={nextZero:function(i,e){for(;0!=i[e];)e++;return e},readUshort:function(i,e){return i[e]<<8|i[e+1]},readShort:function(i,e){var t=ut._binBE.ui8;return t[0]=i[e+1],t[1]=i[e+0],ut._binBE.i16[0]},readInt:function(i,e){var t=ut._binBE.ui8;return t[0]=i[e+3],t[1]=i[e+2],t[2]=i[e+1],t[3]=i[e+0],ut._binBE.i32[0]},readUint:function(i,e){var t=ut._binBE.ui8;return t[0]=i[e+3],t[1]=i[e+2],t[2]=i[e+1],t[3]=i[e+0],ut._binBE.ui32[0]},readASCII:function(i,e,t){for(var n="",r=0;r<t;r++)n+=String.fromCharCode(i[e+r]);return n},readFloat:function(i,e){for(var t=ut._binBE.ui8,n=0;n<4;n++)t[n]=i[e+3-n];return ut._binBE.fl32[0]},readDouble:function(i,e){for(var t=ut._binBE.ui8,n=0;n<8;n++)t[n]=i[e+7-n];return ut._binBE.fl64[0]},writeUshort:function(i,e,t){i[e]=t>>8&255,i[e+1]=255&t},writeInt:function(i,e,t){var n=ut._binBE.ui8;ut._binBE.i32[0]=t,i[e+3]=n[0],i[e+2]=n[1],i[e+1]=n[2],i[e+0]=n[3]},writeUint:function(i,e,t){i[e]=t>>24&255,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=t>>0&255},writeASCII:function(i,e,t){for(var n=0;n<t.length;n++)i[e+n]=t.charCodeAt(n)},writeDouble:function(i,e,t){ut._binBE.fl64[0]=t;for(var n=0;n<8;n++)i[e+n]=ut._binBE.ui8[7-n]}},ut._binBE.ui8=new Uint8Array(8),ut._binBE.i16=new Int16Array(ut._binBE.ui8.buffer),ut._binBE.i32=new Int32Array(ut._binBE.ui8.buffer),ut._binBE.ui32=new Uint32Array(ut._binBE.ui8.buffer),ut._binBE.fl32=new Float32Array(ut._binBE.ui8.buffer),ut._binBE.fl64=new Float64Array(ut._binBE.ui8.buffer),ut._binLE={nextZero:ut._binBE.nextZero,readUshort:function(i,e){return i[e+1]<<8|i[e]},readShort:function(i,e){var t=ut._binBE.ui8;return t[0]=i[e+0],t[1]=i[e+1],ut._binBE.i16[0]},readInt:function(i,e){var t=ut._binBE.ui8;return t[0]=i[e+0],t[1]=i[e+1],t[2]=i[e+2],t[3]=i[e+3],ut._binBE.i32[0]},readUint:function(i,e){var t=ut._binBE.ui8;return t[0]=i[e+0],t[1]=i[e+1],t[2]=i[e+2],t[3]=i[e+3],ut._binBE.ui32[0]},readASCII:ut._binBE.readASCII,readFloat:function(i,e){for(var t=ut._binBE.ui8,n=0;n<4;n++)t[n]=i[e+n];return ut._binBE.fl32[0]},readDouble:function(i,e){for(var t=ut._binBE.ui8,n=0;n<8;n++)t[n]=i[e+n];return ut._binBE.fl64[0]},writeUshort:function(i,e,t){i[e]=255&t,i[e+1]=t>>8&255},writeInt:function(i,e,t){var n=ut._binBE.ui8;ut._binBE.i32[0]=t,i[e+0]=n[0],i[e+1]=n[1],i[e+2]=n[2],i[e+3]=n[3]},writeUint:function(i,e,t){i[e]=t>>>0&255,i[e+1]=t>>>8&255,i[e+2]=t>>>16&255,i[e+3]=t>>>24&255},writeASCII:ut._binBE.writeASCII},ut._copyTile=function(i,e,t,n,r,s,o,a){for(var l=Math.min(e,r-o),c=Math.min(t,s-a),d=0;d<c;d++)for(var u=(a+d)*r+o,h=d*e,f=0;f<l;f++)n[u+f]=i[h+f]};class td extends Do{constructor(){super(...arguments),this.clazz=Tge}}td.\u0275fac=function(){let i;return function(t){return(i||(i=ce(td)))(t||td)}}(),td.\u0275prov=Ne({token:td,factory:td.\u0275fac,providedIn:"root"});class hC extends la{constructor(e){super(),this.service=e}}hC.\u0275fac=function(e){return new(e||hC)(R(td,16))},hC.\u0275pipe=gi({name:"loadLogLuvTexture",type:hC,pure:!0});class fC extends Rs{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}fC.\u0275fac=function(e){return new(e||fC)(R(fa,1),R(at),R(td))},fC.\u0275dir=ke({type:fC,selectors:[["","loadLogLuvTexture",""]],features:[W]});const pC=new De;class Ige extends yr{constructor(e){super(e),this.propertyNameMapping={},this.customPropertyMapping={}}load(e,t,n,r){const s=this,o=new Ar(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(a))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}setPropertyNameMapping(e){this.propertyNameMapping=e}setCustomPropertyNameMapping(e){this.customPropertyMapping=e}parse(e){function t(m){let g="",_=0;const v=/^ply([\s\S]*)end_header(\r\n|\r|\n)/.exec(m);null!==v&&(g=v[1],_=new Blob([v[0]]).size);const b={comments:[],elements:[],headerLength:_,objInfo:""},y=g.split(/\r\n|\r|\n/);let x;function C(M,w){const E={type:M[0]};return"list"===E.type?(E.name=M[3],E.countType=M[1],E.itemType=M[2]):E.name=M[1],E.name in w&&(E.name=w[E.name]),E}for(let M=0;M<y.length;M++){let w=y[M];if(w=w.trim(),""===w)continue;const E=w.split(/\s+/),I=E.shift();switch(w=E.join(" "),I){case"format":b.format=E[0],b.version=E[1];break;case"comment":b.comments.push(w);break;case"element":void 0!==x&&b.elements.push(x),x={},x.name=E[0],x.count=parseInt(E[1]),x.properties=[];break;case"property":x.properties.push(C(E,f.propertyNameMapping));break;case"obj_info":b.objInfo=w;break;default:console.log("unhandled",I,E)}}return void 0!==x&&b.elements.push(x),b}function n(m,p){switch(p){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(m);case"float":case"double":case"float32":case"float64":return parseFloat(m)}}function r(m,p){const g=p.split(/\s+/),_={};for(let v=0;v<m.length;v++)if("list"===m[v].type){const b=[],y=n(g.shift(),m[v].countType);for(let x=0;x<y;x++)b.push(n(g.shift(),m[v].itemType));_[m[v].name]=b}else _[m[v].name]=n(g.shift(),m[v].type);return _}function s(){const m={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]};for(const p of Object.keys(f.customPropertyMapping))m[p]=[];return m}function o(m,p){const g=s();let _,b="";null!==(_=/end_header\s([\s\S]*)$/.exec(m))&&(b=_[1]);const y=b.split(/\r\n|\r|\n/);let x=0,C=0;for(let M=0;M<y.length;M++){let w=y[M];if(w=w.trim(),""===w)continue;C>=p.elements[x].count&&(x++,C=0);const E=r(p.elements[x].properties,w);l(g,p.elements[x].name,E),C++}return a(g)}function a(m){let p=new xt;m.indices.length>0&&p.setIndex(m.indices),p.setAttribute("position",new Ge(m.vertices,3)),m.normals.length>0&&p.setAttribute("normal",new Ge(m.normals,3)),m.uvs.length>0&&p.setAttribute("uv",new Ge(m.uvs,2)),m.colors.length>0&&p.setAttribute("color",new Ge(m.colors,3)),m.faceVertexUvs.length>0&&(p=p.toNonIndexed(),p.setAttribute("uv",new Ge(m.faceVertexUvs,2)));for(const g of Object.keys(f.customPropertyMapping))m[g].length>0&&p.setAttribute(g,new Ge(m[g],f.customPropertyMapping[g].length));return p.computeBoundingSphere(),p}function l(m,p,g){function _(B){for(let L=0,X=B.length;L<X;L++){const P=B[L];if(P in g)return P}return null}const v=_(["x","px","posx"])||"x",b=_(["y","py","posy"])||"y",y=_(["z","pz","posz"])||"z",x=_(["nx","normalx"]),C=_(["ny","normaly"]),M=_(["nz","normalz"]),w=_(["s","u","texture_u","tx"]),E=_(["t","v","texture_v","ty"]),I=_(["red","diffuse_red","r","diffuse_r"]),F=_(["green","diffuse_green","g","diffuse_g"]),Q=_(["blue","diffuse_blue","b","diffuse_b"]);if("vertex"===p){m.vertices.push(g[v],g[b],g[y]),null!==x&&null!==C&&null!==M&&m.normals.push(g[x],g[C],g[M]),null!==w&&null!==E&&m.uvs.push(g[w],g[E]),null!==I&&null!==F&&null!==Q&&(pC.setRGB(g[I]/255,g[F]/255,g[Q]/255).convertSRGBToLinear(),m.colors.push(pC.r,pC.g,pC.b));for(const B of Object.keys(f.customPropertyMapping))for(const L of f.customPropertyMapping[B])m[B].push(g[L])}else if("face"===p){const B=g.vertex_indices||g.vertex_index,L=g.texcoord;3===B.length?(m.indices.push(B[0],B[1],B[2]),L&&6===L.length&&(m.faceVertexUvs.push(L[0],L[1]),m.faceVertexUvs.push(L[2],L[3]),m.faceVertexUvs.push(L[4],L[5]))):4===B.length&&(m.indices.push(B[0],B[1],B[3]),m.indices.push(B[1],B[2],B[3]))}}function c(m,p,g,_){switch(g){case"int8":case"char":return[m.getInt8(p),1];case"uint8":case"uchar":return[m.getUint8(p),1];case"int16":case"short":return[m.getInt16(p,_),2];case"uint16":case"ushort":return[m.getUint16(p,_),2];case"int32":case"int":return[m.getInt32(p,_),4];case"uint32":case"uint":return[m.getUint32(p,_),4];case"float32":case"float":return[m.getFloat32(p,_),4];case"float64":case"double":return[m.getFloat64(p,_),8]}}function d(m,p,g,_){const v={};let b,y=0;for(let x=0;x<g.length;x++)if("list"===g[x].type){const C=[];b=c(m,p+y,g[x].countType,_);const M=b[0];y+=b[1];for(let w=0;w<M;w++)b=c(m,p+y,g[x].itemType,_),C.push(b[0]),y+=b[1];v[g[x].name]=C}else b=c(m,p+y,g[x].type,_),v[g[x].name]=b[0],y+=b[1];return[v,y]}let h;const f=this;if(e instanceof ArrayBuffer){const m=Cs.decodeText(new Uint8Array(e)),p=t(m);h="ascii"===p.format?o(m,p):function u(m,p){const g=s(),_="binary_little_endian"===p.format,v=new DataView(m,p.headerLength);let b,y=0;for(let x=0;x<p.elements.length;x++)for(let C=0;C<p.elements[x].count;C++)b=d(v,y,p.elements[x].properties,_),y+=b[1],l(g,p.elements[x].name,b[0]);return a(g)}(e,p)}else h=o(e,t(e));return h}}class id extends Na{constructor(){super(...arguments),this.clazz=Ige}}id.\u0275fac=function(){let i;return function(t){return(i||(i=ce(id)))(t||id)}}(),id.\u0275prov=Ne({token:id,factory:id.\u0275fac,providedIn:"root"});class mC extends Rx{constructor(e){super(),this.service=e}}mC.\u0275fac=function(e){return new(e||mC)(R(id,16))},mC.\u0275pipe=gi({name:"loadPLY",type:mC,pure:!0});class vb extends _u{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}getRefFromResponse(e){return e.computeVertexNormals(),e}load(){var e=this;return ss(function*(){if(!e.initialized)return;if(void 0===e._url)throw new Error("missing url");const t=e._url,n=S0(e.onProgress$)?s=>{e.onProgress$?.next(s)}:void 0,r=yield e.zone.runOutsideAngular(()=>e.service.load(t,n));e.host.objRef=e.getRefFromResponse(r),e.onLoaded$&&void 0!==r&&e.onLoaded$?.next(r)})()}}vb.\u0275fac=function(e){return new(e||vb)(R(Mt,1),R(at),R(id))},vb.\u0275dir=ke({type:vb,selectors:[["","loadPLY",""]],features:[W]});class pg{constructor(e,t){this.host=e,this.parent=t,this.host.autoAddToParent=!1,this.host.autoDispose=!1,this.host.objRef=r5()}set refById(e){this.id=e,this.subscription?.unsubscribe(),this.subscription=this.parent.objRef$.subscribe(t=>{this.parentObj=t,this.applyRef()})}applyRef(){if(!this.parentObj||void 0===this.id)return;const e=this.findById(this.parentObj,this.id);e&&this.setRef(this.host,e)}findById(e,t){if((e.name??e.uuid)===t)return e;for(const n of e.children){const r=this.findById(n,t);if(void 0!==r)return r}}setRef(e,t){const n=e.objRef;n&&LI(n)&&(n.applyToObject3D(t),e.objRef=n)}ngOnDestroy(){this.subscription?.unsubscribe()}}pg.\u0275fac=function(e){return new(e||pg)(R(Ye,2),R(Ye,4))},pg.\u0275dir=ke({type:pg,selectors:[["","refById",""]],inputs:{refById:"refById"}});const Rge=["outerRef"],Dge=["innerRef"];function Pge(i,e){1&i&&Jg(0)}function kge(i,e){if(1&i){const t=Gs();ve(0,"div",3,4),mt("onResize",function(){return cr(t),dr(bi().onResize())}),ve(2,"div",5,6)(4,"div",7),Vt(5,Pge,1,0,"ng-container",8),Ie()()()}if(2&i){const t=bi(),n=qt(4);K("ngStyle",t.styles),oe(2),K("ngStyle",t.transformInnerStyles),oe(2),go(t.style),K("className",t.className),oe(1),K("ngTemplateOutlet",n)}}function Fge(i,e){1&i&&Jg(0)}function Bge(i,e){if(1&i&&(ve(0,"div",9,4),Vt(2,Fge,1,0,"ng-container",8),Ie()),2&i){const t=bi(),n=qt(4);K("ngStyle",t.styles)("className",t.className),oe(2),K("ngTemplateOutlet",n)}}function Lge(i,e){1&i&&ti(0)}const yb=new T,pD=new T,Nge=new T;function jge(i,e,t){const n=yb.setFromMatrixPosition(i.matrixWorld);n.project(e);const r=t.width/2,s=t.height/2;return[n.x*r+r,-n.y*s+s]}const mD=i=>Math.abs(i)<1e-10?0:i;function IH(i,e,t=""){let n="matrix3d(";for(let r=0;16!==r;r++)n+=mD(e[r]*i.elements[r])+(15!==r?",":")");return t+n}const Gge=(i=>e=>IH(e,i))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]);class Ab extends Nl{constructor(e,t,n){super(n),this.view=e,this.canvas=t,this.prepend=!1,this.center=!1,this.fullscreen=!1,this.eps=.001,this.sprite=!1,this.transform=!1,this.zIndexRange=[16777271,0],this.onOcclude=new Ct,this.calculatePosition=jge,this.as="div",this.pointerEvents="auto",this.transformInnerStyles=this.computeInnerStyles(),this.styles=null,this.oldZoom=0,this.oldPosition=[0,0],this.notOccluded=!0,this.raycaster=Ut(Ix)}ngOnInit(){super.ngOnInit(),this.styles=this.computeStyles()}ngAfterViewInit(){this.el=document.createElement(this.as),this.frameSubscription=this.view.onRender.subscribe(()=>this.onFrame()),this.transformOuterRef&&this.el.appendChild(this.transformOuterRef.nativeElement),this.el&&!this.target&&this.appendElement(this.el)}onResize(){this.styles=this.computeStyles()}ngOnChanges(e){super.ngOnChanges(e)}appendElement(e){if(this.el&&this.objRef&&this.canvas.rendererCanvas&&this.view.camera){if(this.target=this.portal??this.canvas.rendererCanvas?.nativeElement.parentElement,this.view.scene?.objRef?.updateMatrixWorld(),this.transform)e.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const t=this.calculatePosition(this.objRef,this.view.camera.objRef,this.getSize());e.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${t[0]}px,${t[1]}px,0);transform-origin:0 0;`}this.target&&(this.prepend?this.target.prepend(e):this.target.appendChild(e))}}onFrame(){const e=this.view.camera?.objRef,t=this.view.scene?.objRef,n=this._objRef,r=this.getSize();if(!(e&&n&&t&&this.el))return;e.updateMatrixWorld(),n.updateWorldMatrix(!0,!1);const s=this.transform?this.oldPosition:this.calculatePosition(n,e,r);if(this.transform||Math.abs(this.oldZoom-e.zoom)>this.eps||Math.abs(this.oldPosition[0]-s[0])>this.eps||Math.abs(this.oldPosition[1]-s[1])>this.eps){const o=function Uge(i,e){const t=yb.setFromMatrixPosition(i.matrixWorld),n=pD.setFromMatrixPosition(e.matrixWorld),r=t.sub(n),s=e.getWorldDirection(Nge);return r.angleTo(s)>Math.PI/2}(n,e);let a=!1;"boolean"==typeof this.occlude?!0===this.occlude&&(a=[t]):Array.isArray(this.occlude)&&(a=this.occlude.map(c=>c.objRef??c));const l=this.notOccluded;if(this.notOccluded=a?!o&&function Vge(i,e,t,n){const r=yb.setFromMatrixPosition(i.matrixWorld),s=r.clone();s.project(e),t.setFromCamera(s,e);const o=t.intersectObjects(n,!0);if(o.length){const a=o[0].distance;return r.distanceTo(t.ray.origin)<a}return!0}(n,e,this.raycaster,a):!o,l!==this.notOccluded&&(this.onOcclude.length>0?this.onOcclude.next(!this.notOccluded):this.el.style.display=this.notOccluded?"block":"none"),this.el.style.zIndex=`${function Hge(i,e,t){if(e instanceof Sn||e instanceof Pa){const n=yb.setFromMatrixPosition(i.matrixWorld),r=pD.setFromMatrixPosition(e.matrixWorld),s=n.distanceTo(r),o=(t[1]-t[0])/(e.far-e.near);return Math.round(o*s+(t[1]-o*e.far))}}(n,e,this.zIndexRange)}`,this.transform){const[c,d]=[r.width/2,r.height/2],u=e.projectionMatrix.elements[5]*d,{isOrthographicCamera:h,top:f,left:m,bottom:p,right:g}=e,_=Gge(e.matrixWorldInverse),v=h?`scale(${u})translate(${mD(-(g+m)/2)}px,${mD((f+p)/2)}px)`:`translateZ(${u}px)`;let b=n.matrixWorld;this.sprite&&(b=e.matrixWorldInverse.clone().transpose().copyPosition(b).scale(n.scale),b.elements[3]=b.elements[7]=b.elements[11]=0,b.elements[15]=1),this.el.style.width=r.width+"px",this.el.style.height=r.height+"px",this.el.style.perspective=h?"":`${u}px`,this.transformOuterRef&&this.transformInnerRef&&(this.transformOuterRef.nativeElement.style.transform=`${v}${_}translate(${c}px,${d}px)`,this.transformInnerRef.nativeElement.style.transform=((e,t)=>IH(e,(i=>[1/i,1/i,1/i,1,-1/i,-1/i,-1/i,-1,1/i,1/i,1/i,1,1,1,1,1])(t),"translate(-50%,-50%)"))(b,1/((this.distanceFactor||10)/400)))}else{const c=void 0===this.distanceFactor?1:function zge(i,e){if(e instanceof Pa)return e.zoom;if(e instanceof Sn){const t=yb.setFromMatrixPosition(i.matrixWorld),n=pD.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,s=t.distanceTo(n);return 1/(2*Math.tan(r/2)*s)}return 1}(n,e)*this.distanceFactor;this.el.style.transform=`translate3d(${s[0]}px,${s[1]}px,0) scale(${c})`}this.oldPosition=s,this.oldZoom=e.zoom}}ngOnDestroy(){this.el?.remove(),this.frameSubscription?.unsubscribe()}computeStyles(){const e=this.getSize();return this.transform?{position:"absolute",top:0,left:0,width:e.width+"px",height:e.height+"px",transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:this.center?"translate3d(-50%,-50%,0)":"none",...this.fullscreen&&{top:-e.height/2+"px",left:-e.width/2+"px",width:e.width+"px",height:e.height+"px"},...this.style}}computeInnerStyles(){return{position:"absolute",pointerEvents:this.pointerEvents}}getSize(){return this.view.viewPort??this.canvas.rendererCanvas?.nativeElement.getBoundingClientRect()??{width:0,height:0}}}Ab.\u0275fac=function(e){return new(e||Ab)(R(Is),R(Vi),R(Ye,4))},Ab.\u0275cmp=$({type:Ab,selectors:[["th-html"]],viewQuery:function(e,t){if(1&e&&(Di(Rge,5),Di(Dge,5)),2&e){let n;Pt(n=kt())&&(t.transformOuterRef=n.first),Pt(n=kt())&&(t.transformInnerRef=n.first)}},inputs:{prepend:"prepend",center:"center",fullscreen:"fullscreen",portal:"portal",distanceFactor:"distanceFactor",sprite:"sprite",transform:"transform",zIndexRange:"zIndexRange",style:"style",className:"className",occlude:"occlude",calculatePosition:"calculatePosition",as:"as",wrapperClass:"wrapperClass",pointerEvents:"pointerEvents"},outputs:{onOcclude:"onOcclude"},features:[W,Pr],ngContentSelectors:["*"],decls:5,vars:2,consts:[[3,"ngStyle","onResize",4,"ngIf","ngIfElse"],["noTransform",""],["tempOutlet",""],[3,"ngStyle","onResize"],["outerRef",""],[3,"ngStyle"],["innerRef",""],[3,"className"],[4,"ngTemplateOutlet"],[3,"ngStyle","className"]],template:function(e,t){if(1&e&&(Pn(),Vt(0,kge,6,6,"div",0),Vt(1,Bge,3,3,"ng-template",null,1,Td),Vt(3,Lge,1,0,"ng-template",null,2,Td)),2&e){const n=qt(2);K("ngIf",t.transform)("ngIfElse",n)}},dependencies:[Dd,KE,t3,vu],encapsulation:2,changeDetection:0});const gD=function(i){return[0,i,0]},Wge=function(){return[0,1,0]},qge=function(){return{background:"lightblue",borderRadius:"1em",padding:"1em",display:"flex",flexDirection:"column"}},RH=function(i){return[i,0,0]},Xge=function(i){return[i,.05,0]},Yge=function(){return[.17,.17,.17]},Zge=function(){return[4,10,2]},Kge=function(){return[100,100]},$ge=function(){return[55,2,.1,100]},Jge=function(i,e){return[i,0,e]},e_e=function(){return[0,0,0]};class xb{constructor(e){this.Math=Math,this.sprite=!1,this.glbPath=`${aa}mac-draco.glb`,this.clock=new up(!0),this.plane=new to(new T(0,1,0),3),this.rotation=[0,0,0],this.position=[0,0,0],e.setDecoderPath("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/jsm/libs/draco/gltf/"),e.setCrossOrigin("no-cors"),this.calcPose()}onBeforeRender(){this.calcPose()}calcPose(){const e=this.clock.getElapsedTime();this.rotation=[gt.lerp(this.rotation[0],Math.cos(e/2)/20+.25,.1),gt.lerp(this.rotation[1],Math.sin(e/4)/20,.1),gt.lerp(this.rotation[2],Math.sin(e/8)/20,.1)],this.position=[0,gt.lerp(this.position[1],(-2+Math.sin(e/2))/2,.1),0]}}xb.\u0275fac=function(e){return new(e||xb)(R(Pl))},xb.\u0275cmp=$({type:xb,selectors:[["app-html-example"]],decls:17,vars:56,consts:[[3,"thStats","shadow","onRender"],[3,"rotation","position"],["loadGLTF","",3,"castShadow","url","position","rotation"],[3,"refById"],[3,"rotation","position","scale","sprite","transform","occlude"],["src","./multi-view-postprocessing-example",2,"width","1960px","height","1280px"],[3,"castShadow","position","lookAt","color","intensity"],["light",""],[3,"receiveShadow","rotation","position"],[3,"args"],[3,"color"],[3,"args","position","lookAt"]],template:function(e,t){1&e&&(ve(0,"th-canvas",0),mt("onRender",function(){return t.onBeforeRender()}),ve(1,"th-scene"),ze(2,"th-ambientLight"),ve(3,"th-group",1)(4,"th-object3D",2)(5,"th-mesh",3)(6,"th-html",4),ze(7,"iframe",5),Ie()()()(),ze(8,"th-directionalLight",6,7),fr(10,"color"),ve(11,"th-mesh",8),ze(12,"th-planeGeometry",9)(13,"th-meshBasicMaterial",10),fr(14,"color"),Ie(),ve(15,"th-perspectiveCamera",11),ze(16,"th-orbitControls"),Ie()()()),2&e&&(K("thStats",!0)("shadow",!0),oe(3),K("rotation",ui(34,gD,t.Math.PI))("position",Re(36,Wge)),oe(1),K("castShadow",!0)("url",t.glbPath)("position",t.position)("rotation",t.rotation),oe(1),K("refById","Cube008_2"),oe(1),go(Re(37,qge)),K("rotation",ui(38,RH,-1*t.Math.PI/2))("position",ui(40,Xge,-.04))("scale",Re(42,Yge))("sprite",t.sprite)("transform",!0)("occlude",!0),oe(2),K("castShadow",!0)("position",Re(43,Zge))("lookAt",ui(44,gD,-3))("color",Er(10,30,"#ffffff"))("intensity",.75),oe(3),K("receiveShadow",!0)("rotation",ui(46,RH,3*t.Math.PI/2))("position",ui(48,gD,-3)),oe(1),K("args",Re(50,Kge)),oe(1),K("color",Er(14,32,"#efefef")),oe(2),K("args",Re(51,$ge))("position",wa(52,Jge,-5,-15))("lookAt",Re(55,e_e)))},dependencies:[ds,rn,Ye,Ts,xr,Vn,Nl,mn,ja,sa,Vi,Po,Io,pg,Ab,Gc],encapsulation:2,changeDetection:0});const t_e=.5*(Math.sqrt(3)-1),wb=(3-Math.sqrt(3))/6,Za=1/6,n_e=(Math.sqrt(5)-1)/4,Nr=(5-Math.sqrt(5))/20,Rr=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),ar=new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]),c_e=["canvas"],d_e=["light"],u_e=["instancedMesh"],h_e=function(){return[0,0,30]},f_e=function(){return[0,0,0]},p_e=function(){return["#808080"]},m_e=function(i){return[void 0,void 0,i]},g_e=function(i,e,t){return[i,e,t]},DH=function(){return["#9C1E15"]},__e=function(i){return[0,0,i]},b_e=function(i,e){return[i,e]};class Cb{constructor(){this.SIZE=1.5,this.NX=20,this.NY=20,this.PADDING=1,this.SIZEP=this.SIZE+this.PADDING,this.W=this.NX*this.SIZEP-this.PADDING,this.H=this.NY*this.SIZEP-this.PADDING,this.NUM_INSTANCES=this.NX*this.NY,this.dummy=new wi,this.simplex=new class r_e{constructor(e=Math.random){const t="function"==typeof e?e:function a_e(i){let e=0,t=0,n=0,r=1;const s=function l_e(){let i=4022871197;return function(e){e=e.toString();for(let t=0;t<e.length;t++){i+=e.charCodeAt(t);let n=.02519603282416938*i;i=n>>>0,n-=i,n*=i,i=n>>>0,n-=i,i+=4294967296*n}return 2.3283064365386963e-10*(i>>>0)}}();return e=s(" "),t=s(" "),n=s(" "),e-=s(i),e<0&&(e+=1),t-=s(i),t<0&&(t+=1),n-=s(i),n<0&&(n+=1),function(){const o=2091639*e+2.3283064365386963e-10*r;return e=t,t=n,n=o-(r=0|o)}}(e);this.p=function o_e(i){const e=new Uint8Array(256);for(let t=0;t<256;t++)e[t]=t;for(let t=0;t<255;t++){const n=t+~~(i()*(256-t)),r=e[t];e[t]=e[n],e[n]=r}return e}(t),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(let n=0;n<512;n++)this.perm[n]=this.p[255&n],this.permMod12[n]=this.perm[n]%12}noise2D(e,t){const n=this.permMod12,r=this.perm;let s=0,o=0,a=0;const l=(e+t)*t_e,c=Math.floor(e+l),d=Math.floor(t+l),u=(c+d)*wb,m=e-(c-u),p=t-(d-u);let g,_;m>p?(g=1,_=0):(g=0,_=1);const v=m-g+wb,b=p-_+wb,y=m-1+2*wb,x=p-1+2*wb,C=255&c,M=255&d;let w=.5-m*m-p*p;if(w>=0){const F=3*n[C+r[M]];w*=w,s=w*w*(Rr[F]*m+Rr[F+1]*p)}let E=.5-v*v-b*b;if(E>=0){const F=3*n[C+g+r[M+_]];E*=E,o=E*E*(Rr[F]*v+Rr[F+1]*b)}let I=.5-y*y-x*x;if(I>=0){const F=3*n[C+1+r[M+1]];I*=I,a=I*I*(Rr[F]*y+Rr[F+1]*x)}return 70*(s+o+a)}noise3D(e,t,n){const r=this.permMod12,s=this.perm;let o,a,l,c;const d=.3333333333333333*(e+t+n),u=Math.floor(e+d),h=Math.floor(t+d),f=Math.floor(n+d),m=(u+h+f)*Za,v=e-(u-m),b=t-(h-m),y=n-(f-m);let x,C,M,w,E,I;v>=b?b>=y?(x=1,C=0,M=0,w=1,E=1,I=0):v>=y?(x=1,C=0,M=0,w=1,E=0,I=1):(x=0,C=0,M=1,w=1,E=0,I=1):b<y?(x=0,C=0,M=1,w=0,E=1,I=1):v<y?(x=0,C=1,M=0,w=0,E=1,I=1):(x=0,C=1,M=0,w=1,E=1,I=0);const F=v-x+Za,Q=b-C+Za,B=y-M+Za,L=v-w+2*Za,X=b-E+2*Za,P=y-I+2*Za,V=v-1+.5,O=b-1+.5,q=y-1+.5,ee=255&u,Z=255&h,Y=255&f;let he=.6-v*v-b*b-y*y;if(he<0)o=0;else{const U=3*r[ee+s[Z+s[Y]]];he*=he,o=he*he*(Rr[U]*v+Rr[U+1]*b+Rr[U+2]*y)}let J=.6-F*F-Q*Q-B*B;if(J<0)a=0;else{const U=3*r[ee+x+s[Z+C+s[Y+M]]];J*=J,a=J*J*(Rr[U]*F+Rr[U+1]*Q+Rr[U+2]*B)}let ae=.6-L*L-X*X-P*P;if(ae<0)l=0;else{const U=3*r[ee+w+s[Z+E+s[Y+I]]];ae*=ae,l=ae*ae*(Rr[U]*L+Rr[U+1]*X+Rr[U+2]*P)}let G=.6-V*V-O*O-q*q;if(G<0)c=0;else{const U=3*r[ee+1+s[Z+1+s[Y+1]]];G*=G,c=G*G*(Rr[U]*V+Rr[U+1]*O+Rr[U+2]*q)}return 32*(o+a+l+c)}noise4D(e,t,n,r){const s=this.perm;let o,a,l,c,d;const u=(e+t+n+r)*n_e,h=Math.floor(e+u),f=Math.floor(t+u),m=Math.floor(n+u),p=Math.floor(r+u),g=(h+f+m+p)*Nr,x=e-(h-g),C=t-(f-g),M=n-(m-g),w=r-(p-g);let E=0,I=0,F=0,Q=0;x>C?E++:I++,x>M?E++:F++,x>w?E++:Q++,C>M?I++:F++,C>w?I++:Q++,M>w?F++:Q++;const B=E>=3?1:0,L=I>=3?1:0,X=F>=3?1:0,P=Q>=3?1:0,V=E>=2?1:0,O=I>=2?1:0,q=F>=2?1:0,ee=Q>=2?1:0,Z=E>=1?1:0,Y=I>=1?1:0,he=F>=1?1:0,J=Q>=1?1:0,ae=x-B+Nr,G=C-L+Nr,U=M-X+Nr,de=w-P+Nr,Ee=x-V+2*Nr,we=C-O+2*Nr,et=M-q+2*Nr,Ae=w-ee+2*Nr,xe=x-Z+3*Nr,Pe=C-Y+3*Nr,$e=M-he+3*Nr,We=w-J+3*Nr,yt=x-1+4*Nr,ht=C-1+4*Nr,ot=M-1+4*Nr,St=w-1+4*Nr,ft=255&h,N=255&f,k=255&m,_e=255&p;let Se=.6-x*x-C*C-M*M-w*w;if(Se<0)o=0;else{const te=s[ft+s[N+s[k+s[_e]]]]%32*4;Se*=Se,o=Se*Se*(ar[te]*x+ar[te+1]*C+ar[te+2]*M+ar[te+3]*w)}let Ue=.6-ae*ae-G*G-U*U-de*de;if(Ue<0)a=0;else{const te=s[ft+B+s[N+L+s[k+X+s[_e+P]]]]%32*4;Ue*=Ue,a=Ue*Ue*(ar[te]*ae+ar[te+1]*G+ar[te+2]*U+ar[te+3]*de)}let Ze=.6-Ee*Ee-we*we-et*et-Ae*Ae;if(Ze<0)l=0;else{const te=s[ft+V+s[N+O+s[k+q+s[_e+ee]]]]%32*4;Ze*=Ze,l=Ze*Ze*(ar[te]*Ee+ar[te+1]*we+ar[te+2]*et+ar[te+3]*Ae)}let bt=.6-xe*xe-Pe*Pe-$e*$e-We*We;if(bt<0)c=0;else{const te=s[ft+Z+s[N+Y+s[k+he+s[_e+J]]]]%32*4;bt*=bt,c=bt*bt*(ar[te]*xe+ar[te+1]*Pe+ar[te+2]*$e+ar[te+3]*We)}let H=.6-yt*yt-ht*ht-ot*ot-St*St;if(H<0)d=0;else{const te=s[ft+1+s[N+1+s[k+1+s[_e+1]]]]%32*4;H*=H,d=H*H*(ar[te]*yt+ar[te+1]*ht+ar[te+2]*ot+ar[te+3]*St)}return 27*(o+a+l+c+d)}},this.pointerPN={x:0,y:0}}ngOnInit(){}onRender(){this.updateLightPosition(),this.updateInstanceMatrix()}updateLightPosition(){this.light&&this.light.objRef&&(this.light.objRef.position.x=this.pointerPN.x*this.W,this.light.objRef.position.y=this.pointerPN.y*this.H)}updateInstanceMatrix(){if(!this.instancedMesh||!this.instancedMesh.objRef)return;const e=-this.W/2+this.PADDING,t=-this.H/2+this.PADDING,n=1e-4*Date.now(),r=.1*this.pointerPN.x,s=.1*this.pointerPN.y;let a,l,c,d,u,h;for(let f=0;f<this.NX;f++)for(let m=0;m<this.NY;m++)a=e+f*this.SIZEP,l=t+m*this.SIZEP,c=.005*a+r,d=.005*l+s,u=this.simplex.noise3D(c,d,n)*Math.PI,h=this.simplex.noise3D(d,c,n)*Math.PI,this.dummy.position.set(a,l,-10),this.dummy.rotation.set(u,h,0),this.dummy.updateMatrix(),this.instancedMesh?.objRef?.setMatrixAt(f*this.NY+m,this.dummy.matrix);this.instancedMesh.objRef.instanceMatrix.needsUpdate=!0}onMouseMove(e){if(!this.canvas||!this.canvas.rendererCanvas)return;const t=this.canvas.rendererCanvas.nativeElement;this.pointerPN.x=(e.clientX-t.offsetLeft+window.scrollX)/t.width*2-1,this.pointerPN.y=-(e.clientY-t.offsetTop+window.scrollY)/t.height*2+1}}Cb.\u0275fac=function(e){return new(e||Cb)},Cb.\u0275cmp=$({type:Cb,selectors:[["app-instanced-mesh-example"]],viewQuery:function(e,t){if(1&e&&(Di(c_e,5),Di(d_e,5),Di(u_e,5)),2&e){let n;Pt(n=kt())&&(t.canvas=n.first),Pt(n=kt())&&(t.light=n.first),Pt(n=kt())&&(t.instancedMesh=n.first)}},hostBindings:function(e,t){1&e&&mt("mousemove",function(r){return t.onMouseMove(r)},0,jv)},decls:15,vars:33,consts:[[3,"shadow","onRender"],["canvas",""],[3,"position","lookAt"],[3,"color"],[3,"castShadow","shadowMapHeight","shadowMapWidth"],["light",""],[3,"args","count","castShadow","receiveShadow"],["instancedMesh",""],[3,"args"],[3,"position","receiveShadow"]],template:function(e,t){1&e&&(ve(0,"th-canvas",0,1),mt("onRender",function(){return t.onRender()}),ve(2,"th-scene")(3,"th-perspectiveCamera",2),ze(4,"th-orbitControls"),Ie(),ze(5,"th-ambientLight",3)(6,"th-pointLight",4,5),ve(8,"th-instancedMesh",6,7),ze(10,"th-boxGeometry",8)(11,"th-meshPhongMaterial",3),Ie(),ve(12,"th-mesh",9),ze(13,"th-planeGeometry",8)(14,"th-meshPhongMaterial",3),Ie()()()),2&e&&(K("shadow",!0),oe(3),K("position",Re(17,h_e))("lookAt",Re(18,f_e)),oe(2),K("color",Re(19,p_e)),oe(1),K("castShadow",!0)("shadowMapHeight",1024)("shadowMapWidth",1024),oe(2),K("args",ui(20,m_e,t.NUM_INSTANCES))("count",t.NUM_INSTANCES)("castShadow",!0)("receiveShadow",!0),oe(2),K("args",Ed(22,g_e,t.SIZE,t.SIZE,t.SIZE)),oe(1),K("color",Re(26,DH)),oe(1),K("position",ui(27,__e,-10-t.SIZE))("receiveShadow",!0),oe(1),K("args",wa(29,b_e,2*t.W,2*t.H)),oe(1),K("color",Re(32,DH)))},dependencies:[ds,rn,so,xr,Xu,Vn,mn,no,Ua,sa,Vi],encapsulation:2,changeDetection:0});const v_e=function(){return[2,2,2]},y_e=function(){return[1,1,1]},A_e=function(){return{color:"purple"}},x_e=function(i){return[i,0,0]},w_e=function(){return[2,0,0]},C_e=function(){return[75,2,.1,1e3]},M_e=function(){return[1,1,5]};class Mb{constructor(){this.selected=!1,this.rotation=[0,0,0],this.position=[0,0,0]}}Mb.\u0275fac=function(e){return new(e||Mb)},Mb.\u0275cmp=$({type:Mb,selectors:[["app-box"]],inputs:{rotation:"rotation",position:"position"},decls:3,vars:7,consts:[[3,"rotation","position","scale","onClick"],[3,"args"]],template:function(e,t){1&e&&(ve(0,"th-mesh",0),mt("onClick",function(){return t.selected=!t.selected}),ze(1,"th-boxGeometry")(2,"th-meshBasicMaterial",1),Ie()),2&e&&(K("rotation",t.rotation)("position",t.position)("scale",t.selected?Re(4,v_e):Re(5,y_e)),oe(2),K("args",Re(6,A_e)))},dependencies:[Vn,ja,Ua,Va],encapsulation:2,changeDetection:0});class Eb{constructor(){this.rotation=[0,0,0]}onBeforeRender(){this.rotation=[0,this.rotation[2]+.01,this.rotation[2]+.01]}}Eb.\u0275fac=function(e){return new(e||Eb)},Eb.\u0275cmp=$({type:Eb,selectors:[["app-introductory-example"]],decls:6,vars:11,consts:[[3,"onRender"],[3,"position","rotation"],[3,"args","position"]],template:function(e,t){1&e&&(ve(0,"th-canvas",0),mt("onRender",function(){return t.onBeforeRender()}),ve(1,"th-scene"),ze(2,"app-box",1)(3,"app-box",1)(4,"th-ambientLight")(5,"th-perspectiveCamera",2),Ie()()),2&e&&(oe(2),K("position",ui(6,x_e,-2))("rotation",t.rotation),oe(1),K("position",Re(8,w_e))("rotation",t.rotation),oe(2),K("args",Re(9,C_e))("position",Re(10,M_e)))},dependencies:[rn,xr,mn,Vi,Mb],encapsulation:2,changeDetection:0});const E_e=function(){return[0,1,0]},S_e=function(){return[100,100,100]},T_e=function(i){return[0,0,i]},I_e=function(){return[10,10]},PH=function(){return[10,10,10]},R_e=function(){return[45,2,.1,100]},D_e=function(){return[0,0,0]};class Sb{constructor(){this.assetPath1=`${aa}DamagedHelmet.glb`,this.assetPath2=`${aa}BoomBox.glb`,this.rotation=[0,0,0]}onBeforeRender(){this.rotation=[0,this.rotation[1]+.01,0]}}Sb.\u0275fac=function(e){return new(e||Sb)},Sb.\u0275cmp=$({type:Sb,selectors:[["app-loader-example"]],decls:8,vars:22,consts:[[3,"onRender"],[3,"thStats"],["loadGLTF","",3,"url","rotation","position"],["loadGLTF","",3,"url","scale","rotation","position"],[3,"args"],[3,"position"],[3,"args","position","lookAt"]],template:function(e,t){1&e&&(ve(0,"th-canvas",0),mt("onRender",function(){return t.onBeforeRender()}),ve(1,"th-scene",1),ze(2,"th-ambientLight"),ve(3,"th-object3D",2),ze(4,"th-object3D",3),Ie(),ze(5,"th-gridHelper",4)(6,"th-pointLight",5)(7,"th-perspectiveCamera",6),Ie()()),2&e&&(oe(1),K("thStats",!0),oe(2),K("url",t.assetPath1)("rotation",t.rotation)("position",Re(13,E_e)),oe(1),K("url",t.assetPath2)("scale",Re(14,S_e))("rotation",t.rotation)("position",ui(15,T_e,-3)),oe(1),K("args",Re(17,I_e)),oe(1),K("position",Re(18,PH)),oe(1),K("args",Re(19,R_e))("position",Re(20,PH))("lookAt",Re(21,D_e)))},dependencies:[rn,Ye,io,so,xr,mn,Vi,Po,Io],encapsulation:2,changeDetection:0});const P_e=["slider"],k_e=function(){return[35,2,.1,100]},F_e=function(){return[0,0,6]},B_e=function(i,e){return{x:0,y:0,width:i,height:e}},L_e=function(){return["#ffffff","#444444",1]},O_e=function(i){return[i,2,2]},N_e=function(){return[1,3]},j_e=function(i,e,t){return{x:i,y:0,width:e,height:t}};class Tb{constructor(){this.sliderPos=0,this.controlsEnabled=!0,this.colorLeft=new De(12375183),this.colorRight=new De(9419988)}ngOnInit(){!this.slider||!this.canvas||(this.slider.nativeElement.style.touchAction="none",this.sliderPos=(this.canvas.rendererCanvas?.nativeElement.clientWidth||0)/2)}onPointerMove(e){if(this.controlsEnabled||!this.canvas||!this.canvas.rendererCanvas||!this.slider||!1===e.isPrimary)return;const n=this.canvas.rendererCanvas.nativeElement.getBoundingClientRect();this.sliderPos=Math.max(n.left,Math.min(n.right,e.pageX))-n.left,this.slider.nativeElement.style.left=this.sliderPos-this.slider.nativeElement.offsetWidth/2+"px"}onPointerUp(){this.controlsEnabled=!0}onSliderPointerDown(e){!1!==e.isPrimary&&(this.controlsEnabled=!1)}}Tb.\u0275fac=function(e){return new(e||Tb)},Tb.\u0275cmp=$({type:Tb,selectors:[["app-multi-scene-example"]],viewQuery:function(e,t){if(1&e&&(Di(P_e,7),Di(Vi,7)),2&e){let n;Pt(n=kt())&&(t.slider=n.first),Pt(n=kt())&&(t.canvas=n.first)}},hostBindings:function(e,t){1&e&&mt("pointermove",function(r){return t.onPointerMove(r)},0,S1)("pointerup",function(){return t.onPointerUp()},!1,S1)},decls:20,vars:32,consts:[[1,"slider",3,"pointerdown"],["slider",""],[3,"disableDefaultView"],["thecanvas",""],[3,"args","position"],["cam",""],[3,"scissor","scissorTest","clearColor","camera"],[3,"background"],["light",""],[3,"args"],["geo",""],[3,"objRef"],[3,"geometry"],[3,"wireframe"]],template:function(e,t){if(1&e&&(ve(0,"div",0,1),mt("pointerdown",function(r){return t.onSliderPointerDown(r)}),Ie(),ve(2,"th-canvas",2,3)(4,"th-perspectiveCamera",4,5),ze(6,"th-orbitControls"),Ie(),ve(7,"th-view",6)(8,"th-scene",7),ze(9,"th-hemisphereLight",4,8),ve(11,"th-mesh"),ze(12,"th-meshStandardMaterial")(13,"th-icosahedronGeometry",9,10),Ie()()(),ve(15,"th-view",6)(16,"th-scene",7),ze(17,"th-light",11),ve(18,"th-mesh",12),ze(19,"th-meshStandardMaterial",13),Ie()()()()),2&e){const n=qt(3),r=qt(5),s=qt(10),o=qt(14);oe(2),K("disableDefaultView",!0),oe(2),K("args",Re(19,k_e))("position",Re(20,F_e)),oe(3),K("scissor",wa(21,B_e,t.sliderPos,(null==n.rendererCanvas||null==n.rendererCanvas.nativeElement?null:n.rendererCanvas.nativeElement.height)||0))("scissorTest",!0)("clearColor",t.colorLeft)("camera",r),oe(1),K("background",t.colorLeft),oe(1),K("args",Re(24,L_e))("position",ui(25,O_e,-2)),oe(4),K("args",Re(27,N_e)),oe(2),K("scissor",Ed(28,j_e,t.sliderPos,(null==n.rendererCanvas||null==n.rendererCanvas.nativeElement?null:n.rendererCanvas.nativeElement.width)||0,(null==n.rendererCanvas||null==n.rendererCanvas.nativeElement?null:n.rendererCanvas.nativeElement.height)||0))("scissorTest",!0)("clearColor",t.colorRight)("camera",r),oe(1),K("background",t.colorRight),oe(1),K("objRef",null==s.objRef?null:s.objRef.clone()),oe(1),K("geometry",o.objRef),oe(1),K("wireframe",!0)}},dependencies:[ds,rn,Dl,Ss,Vn,mn,Ul,qu,Vi,Is],styles:[".container[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.slider[_ngcontent-%COMP%]{position:absolute;cursor:ew-resize;width:40px;height:40px;background-color:#f32196;opacity:.7;border-radius:50%;top:calc(50% - 20px);left:calc(50% - 20px)}"],changeDetection:0});const kH={uniforms:{tDiffuse:{value:null},amount:{value:.005},angle:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float amount;\n\t\tuniform float angle;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec2 offset = amount * vec2( cos(angle), sin(angle));\n\t\t\tvec4 cr = texture2D(tDiffuse, vUv + offset);\n\t\t\tvec4 cga = texture2D(tDiffuse, vUv);\n\t\t\tvec4 cb = texture2D(tDiffuse, vUv - offset);\n\t\t\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);\n\n\t\t}"},U_e=["thecanvas"],V_e=function(i,e){return{x:0,y:0,width:i,height:e}},z_e=function(){return[0,0,1]},H_e=function(){return["#ffffff"]},G_e=function(){return[0,0,0]},gC=function(i){return[i,0,0]},Q_e=function(){return[200,32,16]},W_e=function(){return["#fac400"]},q_e=function(){return["#f83f0d"]},X_e=function(){return[400,0,0]},_D=function(i,e,t,n){return{x:i,y:e,width:t,height:n}},Y_e=function(i){return[i]},Z_e=function(){return{value:.055}},K_e=function(i){return{amount:i}},$_e=function(){return[.35,.5,2048,!0]};class Ib{constructor(){this.Math=Math,this.RGBShiftShader=kH,this.DotScreenShader=WR,this.canvasWidth=128,this.canvasHeight=128,this.mouseX=0,this.mouseY=0,this.view1={left:0,bottom:0,width:.5,height:1,background:new De(.5,.5,.7),eye:[0,300,1800],up:[0,1,0],fov:30,updateCamera:(e,t)=>{this.updateSize(),e.position.x+=.05*this.mouseX,e.position.x=Math.max(Math.min(e.position.x,2e3),-2e3),e.lookAt(t.position),e.updateProjectionMatrix()}},this.view2={left:.5,bottom:0,width:.5,height:.5,background:new De(.7,.5,.5),eye:[0,1800,0],up:[0,0,1],fov:45,updateCamera:(e,t)=>{this.updateSize(),e.position.x-=.05*this.mouseX,e.position.x=Math.max(Math.min(e.position.x,2e3),-2e3),e.lookAt(e.position.clone().setY(0)),e.updateProjectionMatrix()}},this.view3={left:.5,bottom:.5,width:.5,height:.5,background:new De(.5,.7,.7),eye:[1400,800,1400],up:[0,1,0],fov:60,updateCamera:(e,t)=>{this.updateSize(),e.position.y-=.05*this.mouseX,e.position.y=Math.max(Math.min(e.position.y,1600),-1600),e.lookAt(t.position),e.updateProjectionMatrix()}}}ngOnInit(){!this.canvas||!this.canvas.rendererCanvas||(this.shadowTexture=new ax(this.canvas.rendererCanvas.nativeElement))}updateSize(){!this.canvas||!this.canvas.rendererCanvas||(this.canvasWidth=this.canvas.rendererCanvas.nativeElement.width,this.canvasHeight=this.canvas.rendererCanvas.nativeElement.height)}onMouseMove(e){if(!this.canvas||!this.canvas.rendererCanvas)return;const t=this.canvas.rendererCanvas.nativeElement.getBoundingClientRect();this.mouseX=e.clientX-t.left-t.width/2,this.mouseY=e.clientY-t.right-t.height/2}}Ib.\u0275fac=function(e){return new(e||Ib)},Ib.\u0275cmp=$({type:Ib,selectors:[["app-multi-view-postprocessing-example"]],viewQuery:function(e,t){if(1&e&&Di(U_e,7),2&e){let n;Pt(n=kt())&&(t.canvas=n.first)}},hostBindings:function(e,t){1&e&&mt("mousemove",function(r){return t.onMouseMove(r)},0,jv)},decls:32,vars:95,consts:[[3,"disableDefaultView","viewPort"],["thecanvas",""],["scene",""],[3,"position","args"],[3,"position","rotation"],[3,"args"],["geo",""],[3,"flatShading","shininess","specular","color"],["mat",""],[3,"position","rotation","geometry","material"],[3,"scene","viewPort","scissor","scissorTest","onRender"],["thview1",""],[3,"position","up","fov","aspect","near","far"],["camera1",""],[3,"clearColor"],[3,"strength"],[3,"args","uniforms"],[3,"scene","viewPort","scissor","scissorTest","clearColor","onRender"],["thview2",""],["camera2",""],["thview3",""],["camera3",""]],template:function(e,t){if(1&e){const n=Gs();ve(0,"th-canvas",0,1)(2,"th-scene",null,2),ze(4,"th-directionalLight",3),ve(5,"th-mesh",4),ze(6,"th-sphereGeometry",5,6)(8,"th-meshPhongMaterial",7,8),Ie(),ze(10,"th-mesh",9)(11,"th-mesh",9),Ie(),ve(12,"th-view",10,11),mt("onRender",function(){cr(n);const s=qt(15),o=qt(3);return dr(t.view1.updateCamera(s.objRef,o.objRef))}),ze(14,"th-perspectiveCamera",12,13),ve(16,"th-effectComposer"),ze(17,"th-renderPass",14)(18,"th-unrealBloomPass",15)(19,"th-shaderPass",16)(20,"th-glitchPass"),Ie()(),ve(21,"th-view",17,18),mt("onRender",function(){cr(n);const s=qt(24),o=qt(3);return dr(t.view2.updateCamera(s.objRef,o.objRef))}),ze(23,"th-perspectiveCamera",12,19),ve(25,"th-effectComposer"),ze(26,"th-renderPass")(27,"th-filmPass",5),Ie()(),ve(28,"th-view",17,20),mt("onRender",function(){cr(n);const s=qt(31),o=qt(3);return dr(t.view3.updateCamera(s.objRef,o.objRef))}),ze(30,"th-perspectiveCamera",12,21),Ie()()}if(2&e){const n=qt(3),r=qt(7),s=qt(9),o=qt(13),a=qt(22),l=qt(29);K("disableDefaultView",!0)("viewPort",wa(56,V_e,.5*t.canvasWidth,t.canvasHeight)),oe(4),K("position",Re(59,z_e))("args",Re(60,H_e)),oe(1),K("position",Re(61,G_e))("rotation",ui(62,gC,-t.Math.PI/2)),oe(1),K("args",Re(64,Q_e)),oe(2),K("flatShading",!1)("shininess",30)("specular",Re(65,W_e))("color",Re(66,q_e)),oe(2),K("position",ui(67,gC,-400))("rotation",ui(69,gC,-t.Math.PI/2))("geometry",r.objRef)("material",s.objRef),oe(1),K("position",Re(71,X_e))("rotation",ui(72,gC,-t.Math.PI/2))("geometry",r.objRef)("material",s.objRef),oe(1),K("scene",n)("viewPort",a_(74,_D,t.view1.left*t.canvasWidth,t.view1.bottom*t.canvasHeight,t.view1.width*t.canvasWidth,t.view1.height*t.canvasHeight))("scissor",o.viewPort)("scissorTest",!0),oe(2),K("position",t.view1.eye)("up",t.view1.up)("fov",t.view1.fov)("aspect",t.view1.width*t.canvasWidth/(t.view1.height*t.canvasHeight))("near",1)("far",1e4),oe(3),K("clearColor",t.view1.background),oe(1),K("strength",.2),oe(1),K("args",ui(79,Y_e,t.RGBShiftShader))("uniforms",ui(82,K_e,Re(81,Z_e))),oe(2),K("scene",n)("viewPort",a_(84,_D,t.view2.left*t.canvasWidth,t.view2.bottom*t.canvasHeight,t.view2.width*t.canvasWidth,t.view2.height*t.canvasHeight))("scissor",a.viewPort)("scissorTest",!0)("clearColor",t.view2.background),oe(2),K("position",t.view2.eye)("up",t.view2.up)("fov",t.view2.fov)("aspect",t.view2.width*t.canvasWidth/(t.view2.height*t.canvasHeight))("near",1)("far",1e4),oe(4),K("args",Re(89,$_e)),oe(1),K("scene",n)("viewPort",a_(90,_D,t.view3.left*t.canvasWidth,t.view3.bottom*t.canvasHeight,t.view3.width*t.canvasWidth,t.view3.height*t.canvasHeight))("scissor",l.viewPort)("scissorTest",!0)("clearColor",t.view3.background),oe(2),K("position",t.view3.eye)("up",t.view3.up)("fov",t.view3.fov)("aspect",t.view3.width*t.canvasWidth/(t.view3.height*t.canvasHeight))("near",1)("far",1e4)}},dependencies:[rn,Ts,Vn,mn,no,Xa,Ol,Hu,Wu,Bc,jl,Hc,Vi,Is],encapsulation:2,changeDetection:0});let FH=(()=>{class i{constructor(t,n){this._renderer=t,this._elementRef=n,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,n){this._renderer.setProperty(this._elementRef.nativeElement,t,n)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return i.\u0275fac=function(t){return new(t||i)(R(ll),R(Ht))},i.\u0275dir=ke({type:i}),i})(),ih=(()=>{class i extends FH{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=ce(i)))(n||i)}}(),i.\u0275dir=ke({type:i,features:[W]}),i})();const ao=new Fe("NgValueAccessor"),J_e={provide:ao,useExisting:le(()=>bD),multi:!0};let bD=(()=>{class i extends ih{writeValue(t){this.setProperty("checked",t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=ce(i)))(n||i)}}(),i.\u0275dir=ke({type:i,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,n){1&t&&mt("change",function(s){return n.onChange(s.target.checked)})("blur",function(){return n.onTouched()})},features:[se([J_e]),W]}),i})();const e0e={provide:ao,useExisting:le(()=>_C),multi:!0},i0e=new Fe("CompositionEventMode");let _C=(()=>{class i extends FH{constructor(t,n,r){super(t,n),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function t0e(){const i=Ma()?Ma().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return i.\u0275fac=function(t){return new(t||i)(R(ll),R(Ht),R(i0e,8))},i.\u0275dir=ke({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,n){1&t&&mt("input",function(s){return n._handleInput(s.target.value)})("blur",function(){return n.onTouched()})("compositionstart",function(){return n._compositionStart()})("compositionend",function(s){return n._compositionEnd(s.target.value)})},features:[se([e0e]),W]}),i})();const Kr=new Fe("NgValidators"),rd=new Fe("NgAsyncValidators");function GH(i){return null!=i}function QH(i){return e_(i)?wn(i):i}function WH(i){let e={};return i.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function qH(i,e){return e.map(t=>t(i))}function XH(i){return i.map(e=>function s0e(i){return!i.validate}(e)?e:t=>e.validate(t))}function vD(i){return null!=i?function YH(i){if(!i)return null;const e=i.filter(GH);return 0==e.length?null:function(t){return WH(qH(t,e))}}(XH(i)):null}function yD(i){return null!=i?function ZH(i){if(!i)return null;const e=i.filter(GH);return 0==e.length?null:function(t){return dV(qH(t,e).map(QH)).pipe(vt(WH))}}(XH(i)):null}function KH(i,e){return null===i?[e]:Array.isArray(i)?[...i,e]:[i,e]}function AD(i){return i?Array.isArray(i)?i:[i]:[]}function vC(i,e){return Array.isArray(i)?i.includes(e):i===e}function eG(i,e){const t=AD(e);return AD(i).forEach(r=>{vC(t,r)||t.push(r)}),t}function tG(i,e){return AD(e).filter(t=>!vC(i,t))}class iG{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=vD(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=yD(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class hs extends iG{get formDirective(){return null}get path(){return null}}class sd extends iG{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class nG{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let xD=(()=>{class i extends nG{constructor(t){super(t)}}return i.\u0275fac=function(t){return new(t||i)(R(sd,2))},i.\u0275dir=ke({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,n){2&t&&Mi("ng-untouched",n.isUntouched)("ng-touched",n.isTouched)("ng-pristine",n.isPristine)("ng-dirty",n.isDirty)("ng-valid",n.isValid)("ng-invalid",n.isInvalid)("ng-pending",n.isPending)},features:[W]}),i})();const Rb="VALID",AC="INVALID",mg="PENDING",Db="DISABLED";function xC(i){return null!=i&&!Array.isArray(i)&&"object"==typeof i}class aG{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Rb}get invalid(){return this.status===AC}get pending(){return this.status==mg}get disabled(){return this.status===Db}get enabled(){return this.status!==Db}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(eG(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(eG(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(tG(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(tG(e,this._rawAsyncValidators))}hasValidator(e){return vC(this._rawValidators,e)}hasAsyncValidator(e){return vC(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=mg,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Db,this.errors=null,this._forEachChild(n=>{n.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Rb,this._forEachChild(n=>{n.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Rb||this.status===mg)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Db:Rb}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=mg,this._hasOwnPendingAsyncValidator=!0;const t=QH(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((n,r)=>n&&n._find(r),this)}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Ct,this.statusChanges=new Ct}_calculateStatus(){return this._allControlsDisabled()?Db:this.errors?AC:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(mg)?mg:this._anyControlsHaveStatus(AC)?AC:Rb}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){xC(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function f0e(i){return Array.isArray(i)?vD(i):i||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function p0e(i){return Array.isArray(i)?yD(i):i||null}(this._rawAsyncValidators)}}const Pb=new Fe("CallSetDisabledState",{providedIn:"root",factory:()=>ID}),ID="always";function kb(i,e,t=ID){(function RD(i,e){const t=function $H(i){return i._rawValidators}(i);null!==e.validator?i.setValidators(KH(t,e.validator)):"function"==typeof t&&i.setValidators([t]);const n=function JH(i){return i._rawAsyncValidators}(i);null!==e.asyncValidator?i.setAsyncValidators(KH(n,e.asyncValidator)):"function"==typeof n&&i.setAsyncValidators([n]);const r=()=>i.updateValueAndValidity();MC(e._rawValidators,r),MC(e._rawAsyncValidators,r)})(i,e),e.valueAccessor.writeValue(i.value),(i.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(i.disabled),function _0e(i,e){e.valueAccessor.registerOnChange(t=>{i._pendingValue=t,i._pendingChange=!0,i._pendingDirty=!0,"change"===i.updateOn&&lG(i,e)})}(i,e),function v0e(i,e){const t=(n,r)=>{e.valueAccessor.writeValue(n),r&&e.viewToModelUpdate(n)};i.registerOnChange(t),e._registerOnDestroy(()=>{i._unregisterOnChange(t)})}(i,e),function b0e(i,e){e.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,"blur"===i.updateOn&&i._pendingChange&&lG(i,e),"submit"!==i.updateOn&&i.markAsTouched()})}(i,e),function g0e(i,e){if(e.valueAccessor.setDisabledState){const t=n=>{e.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(t),e._registerOnDestroy(()=>{i._unregisterOnDisabledChange(t)})}}(i,e)}function MC(i,e){i.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function lG(i,e){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function uG(i,e){const t=i.indexOf(e);t>-1&&i.splice(t,1)}function hG(i){return"object"==typeof i&&null!==i&&2===Object.keys(i).length&&"value"in i&&"disabled"in i}const fG=class extends aG{constructor(e=null,t,n){super(function ED(i){return(xC(i)?i.validators:i)||null}(t),function SD(i,e){return(xC(e)?e.asyncValidators:i)||null}(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),xC(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=hG(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){uG(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){uG(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){hG(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},S0e={provide:sd,useExisting:le(()=>SC)},gG=(()=>Promise.resolve())();let SC=(()=>{class i extends sd{constructor(t,n,r,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new fG,this._registered=!1,this.update=new Ct,this._parent=t,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=function kD(i,e){if(!e)return null;let t,n,r;return Array.isArray(e),e.forEach(s=>{s.constructor===_C?t=s:function x0e(i){return Object.getPrototypeOf(i.constructor)===ih}(s)?n=s:r=s}),r||n||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const n=t.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function PD(i,e){if(!i.hasOwnProperty("model"))return!1;const t=i.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){kb(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){gG.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const n=t.isDisabled.currentValue,r=0!==n&&Zh(n);gG.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function wC(i,e){return[...e.path,i]}(t,this._parent):[t]}}return i.\u0275fac=function(t){return new(t||i)(R(hs,9),R(Kr,10),R(rd,10),R(ao,10),R(er,8),R(Pb,8))},i.\u0275dir=ke({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[se([S0e]),W,Pr]}),i})(),bG=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({}),i})();const P0e={provide:ao,useExisting:le(()=>BD),multi:!0};let BD=(()=>{class i extends ih{writeValue(t){this.setProperty("value",parseFloat(t))}registerOnChange(t){this.onChange=n=>{t(""==n?null:parseFloat(n))}}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=ce(i)))(n||i)}}(),i.\u0275dir=ke({type:i,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,n){1&t&&mt("change",function(s){return n.onChange(s.target.value)})("input",function(s){return n.onChange(s.target.value)})("blur",function(){return n.onTouched()})},features:[se([P0e]),W]}),i})();const N0e={provide:ao,useExisting:le(()=>TC),multi:!0};function CG(i,e){return null==i?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${i}: ${e}`.slice(0,50))}let TC=(()=>{class i extends ih{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const r=CG(this._getOptionId(t),t);this.setProperty("value",r)}registerOnChange(t){this.onChange=n=>{this.value=this._getOptionValue(n),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const n of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(n),t))return n;return null}_getOptionValue(t){const n=function j0e(i){return i.split(":")[0]}(t);return this._optionMap.has(n)?this._optionMap.get(n):t}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=ce(i)))(n||i)}}(),i.\u0275dir=ke({type:i,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,n){1&t&&mt("change",function(s){return n.onChange(s.target.value)})("blur",function(){return n.onTouched()})},inputs:{compareWith:"compareWith"},features:[se([N0e]),W]}),i})(),MG=(()=>{class i{constructor(t,n,r){this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(CG(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(ll),R(TC,9))},i.\u0275dir=ke({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),i})();const U0e={provide:ao,useExisting:le(()=>jD),multi:!0};function EG(i,e){return null==i?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${i}: ${e}`.slice(0,50))}let jD=(()=>{class i extends ih{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let n;if(this.value=t,Array.isArray(t)){const r=t.map(s=>this._getOptionId(s));n=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else n=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(n)}registerOnChange(t){this.onChange=n=>{const r=[],s=n.selectedOptions;if(void 0!==s){const o=s;for(let a=0;a<o.length;a++){const c=this._getOptionValue(o[a].value);r.push(c)}}else{const o=n.options;for(let a=0;a<o.length;a++){const l=o[a];if(l.selected){const c=this._getOptionValue(l.value);r.push(c)}}}this.value=r,t(r)}}_registerOption(t){const n=(this._idCounter++).toString();return this._optionMap.set(n,t),n}_getOptionId(t){for(const n of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(n)._value,t))return n;return null}_getOptionValue(t){const n=function V0e(i){return i.split(":")[0]}(t);return this._optionMap.has(n)?this._optionMap.get(n)._value:t}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=ce(i)))(n||i)}}(),i.\u0275dir=ke({type:i,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,n){1&t&&mt("change",function(s){return n.onChange(s.target)})("blur",function(){return n.onTouched()})},inputs:{compareWith:"compareWith"},features:[se([U0e]),W]}),i})(),SG=(()=>{class i{constructor(t,n,r){this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(EG(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(EG(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(ll),R(jD,9))},i.\u0275dir=ke({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),i})(),Z0e=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[bG]}),i})(),$0e=(()=>{class i{static withConfig(t){return{ngModule:i,providers:[{provide:Pb,useValue:t.callSetDisabledState??ID}]}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[Z0e]}),i})();function J0e(i,e){1&i&&ze(0,"th-orbitControls")}function ebe(i,e){1&i&&ze(0,"th-mapControls")}function tbe(i,e){1&i&&ze(0,"th-arcballControls")}function ibe(i,e){1&i&&ze(0,"th-transformControls",17),2&i&&(bi(),K("object",qt(26).objRef))}const nbe=function(i){return[i]},rbe=function(i,e,t){return[i,e,t]};function sbe(i,e){if(1&i&&ze(0,"th-dragControls",10),2&i){bi();const t=qt(26),n=qt(30),r=qt(22);K("args",Ed(3,rbe,ui(1,nbe,t.objRef),n.objRef,null==r.rendererCanvas?null:r.rendererCanvas.nativeElement))}}function obe(i,e){1&i&&ze(0,"th-flyControls")}function abe(i,e){1&i&&ze(0,"th-trackballControls")}function lbe(i,e){1&i&&ze(0,"th-firstPersonControls")}const cbe=function(){return[2,2,2]},dbe=function(){return[1,1,1]},ube=function(){return[10,10]},OG=function(){return[10,10,10]},hbe=function(){return[45,2,.1,100]},fbe=function(){return[0,0,0]};class Bb{constructor(){this.controlType="orbit",this.renderOnDemand=!0,this.selected=!1,this.glbPath=`${aa}DamagedHelmet.glb`}}Bb.\u0275fac=function(e){return new(e||Bb)},Bb.\u0275cmp=$({type:Bb,selectors:[["app-on-demand-example"]],decls:39,vars:27,consts:[[1,"control-panel"],["id","ondemand","type","checkbox",3,"ngModel","ngModelChange"],["for","ondemand"],[1,"form-control",3,"ngModel","ngModelChange"],[1,"works-on-demand"],[1,"needs-loop"],[3,"thStats","renderOnDemand"],["canvas",""],["loadGLTF","",3,"url","scale","onClick"],["model",""],[3,"args"],[3,"position"],[3,"ngSwitch","args","position","lookAt"],["camera",""],[4,"ngSwitchCase"],[3,"object",4,"ngSwitchCase"],[3,"args",4,"ngSwitchCase"],[3,"object"]],template:function(e,t){1&e&&(ve(0,"div",0)(1,"input",1),mt("ngModelChange",function(r){return t.renderOnDemand=r}),Ie(),ve(2,"label",2),qi(3,"Render On-Demand"),Ie(),ve(4,"select",3),mt("ngModelChange",function(r){return t.controlType=r}),ve(5,"option",4),qi(6,"orbit"),Ie(),ve(7,"option",4),qi(8,"map"),Ie(),ve(9,"option",4),qi(10,"arcball"),Ie(),ve(11,"option",4),qi(12,"transform"),Ie(),ve(13,"option",4),qi(14,"drag"),Ie(),ve(15,"option",5),qi(16,"fly"),Ie(),ve(17,"option",5),qi(18,"trackball"),Ie(),ve(19,"option",5),qi(20,"firstpersion"),Ie()()(),ve(21,"th-canvas",6,7)(23,"th-scene"),ze(24,"th-ambientLight"),ve(25,"th-object3D",8,9),mt("onClick",function(){return t.selected=!t.selected}),Ie(),ze(27,"th-gridHelper",10)(28,"th-pointLight",11),ve(29,"th-perspectiveCamera",12,13),Vt(31,J0e,1,0,"th-orbitControls",14),Vt(32,ebe,1,0,"th-mapControls",14),Vt(33,tbe,1,0,"th-arcballControls",14),Vt(34,ibe,1,1,"th-transformControls",15),Vt(35,sbe,1,7,"th-dragControls",16),Vt(36,obe,1,0,"th-flyControls",14),Vt(37,abe,1,0,"th-trackballControls",14),Vt(38,lbe,1,0,"th-firstPersonControls",14),Ie()()()),2&e&&(oe(1),K("ngModel",t.renderOnDemand),oe(3),K("ngModel",t.controlType),oe(17),K("thStats",!0)("renderOnDemand",t.renderOnDemand),oe(4),K("url",t.glbPath)("scale",t.selected?Re(20,cbe):Re(21,dbe)),oe(2),K("args",Re(22,ube)),oe(1),K("position",Re(23,OG)),oe(1),K("ngSwitch",t.controlType)("args",Re(24,hbe))("position",Re(25,OG))("lookAt",Re(26,fbe)),oe(2),K("ngSwitchCase","orbit"),oe(1),K("ngSwitchCase","map"),oe(1),K("ngSwitchCase","arcball"),oe(1),K("ngSwitchCase","transform"),oe(1),K("ngSwitchCase","drag"),oe(1),K("ngSwitchCase","fly"),oe(1),K("ngSwitchCase","trackball"),oe(1),K("ngSwitchCase","firstpersion"))},dependencies:[My,JO,Pu,ku,Vu,Gu,Qu,ds,Zu,th,rn,Ye,io,so,xr,mn,Vi,Po,Va,vu,Io,MG,SG,bD,TC,xD,SC],styles:[".needs-loop[_ngcontent-%COMP%]{color:red}.works-on-demand[_ngcontent-%COMP%]{color:green}.control-panel[_ngcontent-%COMP%]{display:flex;gap:1em;margin:1em}"],changeDetection:0});class Ka{constructor(e,t,n,r,s="div"){this.parent=e,this.object=t,this.property=n,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement("div"),this.domElement.classList.add("controller"),this.domElement.classList.add(r),this.$name=document.createElement("div"),this.$name.classList.add("name"),Ka.nextNameID=Ka.nextNameID||0,this.$name.id="lil-gui-name-"+ ++Ka.nextNameID,this.$widget=document.createElement(s),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(n)}name(e){return this._name=e,this.$name.innerHTML=e,this}onChange(e){return this._onChange=e,this}_callOnChange(){this.parent._callOnChange(this),void 0!==this._onChange&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),void 0!==this._onFinishChange&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(e=!0){return this.disable(!e)}disable(e=!0){return e===this._disabled||(this._disabled=e,this.domElement.classList.toggle("disabled",e),this.$disable.toggleAttribute("disabled",e)),this}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(e){const t=this.parent.add(this.object,this.property,e);return t.name(this._name),this.destroy(),t}min(e){return this}max(e){return this}step(e){return this}decimals(e){return this}listen(e=!0){return this._listening=e,void 0!==this._listenCallbackID&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const e=this.save();e!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=e}getValue(){return this.object[this.property]}setValue(e){return this.object[this.property]=e,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(e){return this.setValue(e),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class pbe extends Ka{constructor(e,t,n){super(e,t,n,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function VD(i){let e,t;return(e=i.match(/(#|0x)?([a-f0-9]{6})/i))?t=e[2]:(e=i.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?t=parseInt(e[1]).toString(16).padStart(2,0)+parseInt(e[2]).toString(16).padStart(2,0)+parseInt(e[3]).toString(16).padStart(2,0):(e=i.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(t=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),!!t&&"#"+t}const mbe={isPrimitive:!0,match:i=>"string"==typeof i,fromHexString:VD,toHexString:VD},Lb={isPrimitive:!0,match:i=>"number"==typeof i,fromHexString:i=>parseInt(i.substring(1),16),toHexString:i=>"#"+i.toString(16).padStart(6,0)},gbe={isPrimitive:!1,match:Array.isArray,fromHexString(i,e,t=1){const n=Lb.fromHexString(i);e[0]=(n>>16&255)/255*t,e[1]=(n>>8&255)/255*t,e[2]=(255&n)/255*t},toHexString:([i,e,t],n=1)=>Lb.toHexString(i*(n=255/n)<<16^e*n<<8^t*n<<0)},_be=[mbe,Lb,gbe,{isPrimitive:!1,match:i=>Object(i)===i,fromHexString(i,e,t=1){const n=Lb.fromHexString(i);e.r=(n>>16&255)/255*t,e.g=(n>>8&255)/255*t,e.b=(255&n)/255*t},toHexString:({r:i,g:e,b:t},n=1)=>Lb.toHexString(i*(n=255/n)<<16^e*n<<8^t*n<<0)}];class vbe extends Ka{constructor(e,t,n,r){super(e,t,n,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=function bbe(i){return _be.find(e=>e.match(i))}(this.initialValue),this._rgbScale=r,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const s=VD(this.$text.value);s&&this._setValueFromHexString(s)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(e){if(this._format.isPrimitive){const t=this._format.fromHexString(e);this.setValue(t)}else this._format.fromHexString(e,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(e){return this._setValueFromHexString(e),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class zD extends Ka{constructor(e,t,n){super(e,t,n,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",r=>{r.preventDefault(),this.getValue().call(this.object)}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class ybe extends Ka{constructor(e,t,n,r,s,o){super(e,t,n,"number"),this._initInput(),this.min(r),this.max(s);const a=void 0!==o;this.step(a?o:this._getImplicitStep(),a),this.updateDisplay()}decimals(e){return this._decimals=e,this.updateDisplay(),this}min(e){return this._min=e,this._onUpdateMinMax(),this}max(e){return this._max=e,this._onUpdateMinMax(),this}step(e,t=!0){return this._step=e,this._stepExplicit=t,this}updateDisplay(){const e=this.getValue();if(this._hasSlider){let t=(e-this._min)/(this._max-this._min);t=Math.max(0,Math.min(t,1)),this.$fill.style.width=100*t+"%"}return this._inputFocused||(this.$input.value=void 0===this._decimals?e:e.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$disable=this.$input;const t=_=>{const v=parseFloat(this.$input.value);isNaN(v)||(this._snapClampSetValue(v+_),this.$input.value=this.getValue())};let o,a,l,c,d,s=!1;const f=_=>{if(s){const v=_.clientX-o;Math.abs(_.clientY-a)>5?(_.preventDefault(),this.$input.blur(),s=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(v)>5&&m()}s||(d-=(_.clientY-l)*this._step*this._arrowKeyMultiplier(_),c+d>this._max?d=this._max-c:c+d<this._min&&(d=this._min-c),this._snapClampSetValue(c+d)),l=_.clientY},m=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",m)};this.$input.addEventListener("input",()=>{let _=parseFloat(this.$input.value);isNaN(_)||(this._stepExplicit&&(_=this._snap(_)),this.setValue(this._clamp(_)))}),this.$input.addEventListener("keydown",_=>{"Enter"===_.code&&this.$input.blur(),"ArrowUp"===_.code&&(_.preventDefault(),t(this._step*this._arrowKeyMultiplier(_))),"ArrowDown"===_.code&&(_.preventDefault(),t(this._step*this._arrowKeyMultiplier(_)*-1))}),this.$input.addEventListener("wheel",_=>{this._inputFocused&&(_.preventDefault(),t(this._step*this._normalizeMouseWheel(_)))},{passive:!1}),this.$input.addEventListener("mousedown",_=>{o=_.clientX,a=l=_.clientY,s=!0,c=this.getValue(),d=0,window.addEventListener("mousemove",f),window.addEventListener("mouseup",m)}),this.$input.addEventListener("focus",()=>{this._inputFocused=!0}),this.$input.addEventListener("blur",()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()})}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const t=_=>{const v=this.$slider.getBoundingClientRect();let b=((_,v,b,y,x)=>(_-v)/(b-v)*(this._max-y)+y)(_,v.left,v.right,this._min);this._snapClampSetValue(b)},r=_=>{t(_.clientX)},s=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",s)};let a,l,o=!1;const c=_=>{_.preventDefault(),this._setDraggingStyle(!0),t(_.touches[0].clientX),o=!1},u=_=>{if(o){const b=_.touches[0].clientY-l;Math.abs(_.touches[0].clientX-a)>Math.abs(b)?c(_):(window.removeEventListener("touchmove",u),window.removeEventListener("touchend",h))}else _.preventDefault(),t(_.touches[0].clientX)},h=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",u),window.removeEventListener("touchend",h)},f=this._callOnFinishChange.bind(this);let p;this.$slider.addEventListener("mousedown",_=>{this._setDraggingStyle(!0),t(_.clientX),window.addEventListener("mousemove",r),window.addEventListener("mouseup",s)}),this.$slider.addEventListener("touchstart",_=>{_.touches.length>1||(this._hasScrollBar?(a=_.touches[0].clientX,l=_.touches[0].clientY,o=!0):c(_),window.addEventListener("touchmove",u,{passive:!1}),window.addEventListener("touchend",h))},{passive:!1}),this.$slider.addEventListener("wheel",_=>{if(Math.abs(_.deltaX)<Math.abs(_.deltaY)&&this._hasScrollBar)return;_.preventDefault();const b=this._normalizeMouseWheel(_)*this._step;this._snapClampSetValue(this.getValue()+b),this.$input.value=this.getValue(),clearTimeout(p),p=setTimeout(f,400)},{passive:!1})}_setDraggingStyle(e,t="horizontal"){this.$slider&&this.$slider.classList.toggle("active",e),document.body.classList.toggle("lil-gui-dragging",e),document.body.classList.toggle(`lil-gui-${t}`,e)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(e){let{deltaX:t,deltaY:n}=e;return Math.floor(e.deltaY)!==e.deltaY&&e.wheelDelta&&(t=0,n=-e.wheelDelta/120,n*=this._stepExplicit?1:10),t+-n}_arrowKeyMultiplier(e){let t=this._stepExplicit?1:10;return e.shiftKey?t*=10:e.altKey&&(t/=10),t}_snap(e){const t=Math.round(e/this._step)*this._step;return parseFloat(t.toPrecision(15))}_clamp(e){return e<this._min&&(e=this._min),e>this._max&&(e=this._max),e}_snapClampSetValue(e){this.setValue(this._clamp(this._snap(e)))}get _hasScrollBar(){const e=this.parent.root.$children;return e.scrollHeight>e.clientHeight}get _hasMin(){return void 0!==this._min}get _hasMax(){return void 0!==this._max}}class Abe extends Ka{constructor(e,t,n,r){super(e,t,n,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this._values=Array.isArray(r)?r:Object.values(r),this._names=Array.isArray(r)?r:Object.keys(r),this._names.forEach(s=>{const o=document.createElement("option");o.innerHTML=s,this.$select.appendChild(o)}),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.updateDisplay()}updateDisplay(){const e=this.getValue(),t=this._values.indexOf(e);return this.$select.selectedIndex=t,this.$display.innerHTML=-1===t?e:this._names[t],this}}class xbe extends Ka{constructor(e,t,n){super(e,t,n,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",r=>{"Enter"===r.code&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}let NG=!1;class HD{constructor({parent:e,autoPlace:t=void 0===e,container:n,width:r,title:s="Controls",injectStyles:o=!0,touchStyles:a=!0}={}){if(this.parent=e,this.root=e?e.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",l=>{("Enter"===l.code||"Space"===l.code)&&(l.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(s),a&&this.domElement.classList.add("allow-touch-styles"),this.parent)return this.parent.children.push(this),this.parent.folders.push(this),void this.parent.$children.appendChild(this.domElement);this.domElement.classList.add("root"),!NG&&o&&(function Cbe(i){const e=document.createElement("style");e.innerHTML=i;const t=document.querySelector("head link[rel=stylesheet], head style");t?document.head.insertBefore(e,t):document.head.appendChild(e)}('.lil-gui {\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  line-height: 1;\n  font-weight: normal;\n  font-style: normal;\n  text-align: left;\n  background-color: var(--background-color);\n  color: var(--text-color);\n  user-select: none;\n  -webkit-user-select: none;\n  touch-action: manipulation;\n  --background-color: #1f1f1f;\n  --text-color: #ebebeb;\n  --title-background-color: #111111;\n  --title-text-color: #ebebeb;\n  --widget-color: #424242;\n  --hover-color: #4f4f4f;\n  --focus-color: #595959;\n  --number-color: #2cc9ff;\n  --string-color: #a2db3c;\n  --font-size: 11px;\n  --input-font-size: 11px;\n  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;\n  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;\n  --padding: 4px;\n  --spacing: 4px;\n  --widget-height: 20px;\n  --name-width: 45%;\n  --slider-knob-width: 2px;\n  --slider-input-width: 27%;\n  --color-input-width: 27%;\n  --slider-input-min-width: 45px;\n  --color-input-min-width: 45px;\n  --folder-indent: 7px;\n  --widget-padding: 0 0 0 3px;\n  --widget-border-radius: 2px;\n  --checkbox-size: calc(0.75 * var(--widget-height));\n  --scrollbar-width: 5px;\n}\n.lil-gui, .lil-gui * {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n.lil-gui.root {\n  width: var(--width, 245px);\n  display: flex;\n  flex-direction: column;\n}\n.lil-gui.root > .title {\n  background: var(--title-background-color);\n  color: var(--title-text-color);\n}\n.lil-gui.root > .children {\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.lil-gui.root > .children::-webkit-scrollbar {\n  width: var(--scrollbar-width);\n  height: var(--scrollbar-width);\n  background: var(--background-color);\n}\n.lil-gui.root > .children::-webkit-scrollbar-thumb {\n  border-radius: var(--scrollbar-width);\n  background: var(--focus-color);\n}\n@media (pointer: coarse) {\n  .lil-gui.allow-touch-styles {\n    --widget-height: 28px;\n    --padding: 6px;\n    --spacing: 6px;\n    --font-size: 13px;\n    --input-font-size: 16px;\n    --folder-indent: 10px;\n    --scrollbar-width: 7px;\n    --slider-input-min-width: 50px;\n    --color-input-min-width: 65px;\n  }\n}\n.lil-gui.force-touch-styles {\n  --widget-height: 28px;\n  --padding: 6px;\n  --spacing: 6px;\n  --font-size: 13px;\n  --input-font-size: 16px;\n  --folder-indent: 10px;\n  --scrollbar-width: 7px;\n  --slider-input-min-width: 50px;\n  --color-input-min-width: 65px;\n}\n.lil-gui.autoPlace {\n  max-height: 100%;\n  position: fixed;\n  top: 0;\n  right: 15px;\n  z-index: 1001;\n}\n\n.lil-gui .controller {\n  display: flex;\n  align-items: center;\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n}\n.lil-gui .controller.disabled {\n  opacity: 0.5;\n}\n.lil-gui .controller.disabled, .lil-gui .controller.disabled * {\n  pointer-events: none !important;\n}\n.lil-gui .controller > .name {\n  min-width: var(--name-width);\n  flex-shrink: 0;\n  white-space: pre;\n  padding-right: var(--spacing);\n  line-height: var(--widget-height);\n}\n.lil-gui .controller .widget {\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  min-height: var(--widget-height);\n}\n.lil-gui .controller.string input {\n  color: var(--string-color);\n}\n.lil-gui .controller.boolean .widget {\n  cursor: pointer;\n}\n.lil-gui .controller.color .display {\n  width: 100%;\n  height: var(--widget-height);\n  border-radius: var(--widget-border-radius);\n  position: relative;\n}\n@media (hover: hover) {\n  .lil-gui .controller.color .display:hover:before {\n    content: " ";\n    display: block;\n    position: absolute;\n    border-radius: var(--widget-border-radius);\n    border: 1px solid #fff9;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n  }\n}\n.lil-gui .controller.color input[type=color] {\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n}\n.lil-gui .controller.color input[type=text] {\n  margin-left: var(--spacing);\n  font-family: var(--font-family-mono);\n  min-width: var(--color-input-min-width);\n  width: var(--color-input-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.option select {\n  opacity: 0;\n  position: absolute;\n  width: 100%;\n  max-width: 100%;\n}\n.lil-gui .controller.option .display {\n  position: relative;\n  pointer-events: none;\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  line-height: var(--widget-height);\n  max-width: 100%;\n  overflow: hidden;\n  word-break: break-all;\n  padding-left: 0.55em;\n  padding-right: 1.75em;\n  background: var(--widget-color);\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .display.focus {\n    background: var(--focus-color);\n  }\n}\n.lil-gui .controller.option .display.active {\n  background: var(--focus-color);\n}\n.lil-gui .controller.option .display:after {\n  font-family: "lil-gui";\n  content: "\u2195";\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  padding-right: 0.375em;\n}\n.lil-gui .controller.option .widget,\n.lil-gui .controller.option select {\n  cursor: pointer;\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .widget:hover .display {\n    background: var(--hover-color);\n  }\n}\n.lil-gui .controller.number input {\n  color: var(--number-color);\n}\n.lil-gui .controller.number.hasSlider input {\n  margin-left: var(--spacing);\n  width: var(--slider-input-width);\n  min-width: var(--slider-input-min-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.number .slider {\n  width: 100%;\n  height: var(--widget-height);\n  background-color: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  padding-right: var(--slider-knob-width);\n  overflow: hidden;\n  cursor: ew-resize;\n  touch-action: pan-y;\n}\n@media (hover: hover) {\n  .lil-gui .controller.number .slider:hover {\n    background-color: var(--hover-color);\n  }\n}\n.lil-gui .controller.number .slider.active {\n  background-color: var(--focus-color);\n}\n.lil-gui .controller.number .slider.active .fill {\n  opacity: 0.95;\n}\n.lil-gui .controller.number .fill {\n  height: 100%;\n  border-right: var(--slider-knob-width) solid var(--number-color);\n  box-sizing: content-box;\n}\n\n.lil-gui-dragging .lil-gui {\n  --hover-color: var(--widget-color);\n}\n.lil-gui-dragging * {\n  cursor: ew-resize !important;\n}\n\n.lil-gui-dragging.lil-gui-vertical * {\n  cursor: ns-resize !important;\n}\n\n.lil-gui .title {\n  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);\n  height: var(--title-height);\n  line-height: calc(var(--title-height) - 4px);\n  font-weight: 600;\n  padding: 0 var(--padding);\n  -webkit-tap-highlight-color: transparent;\n  cursor: pointer;\n  outline: none;\n  text-decoration-skip: objects;\n}\n.lil-gui .title:before {\n  font-family: "lil-gui";\n  content: "\u25be";\n  padding-right: 2px;\n  display: inline-block;\n}\n.lil-gui .title:active {\n  background: var(--title-background-color);\n  opacity: 0.75;\n}\n@media (hover: hover) {\n  body:not(.lil-gui-dragging) .lil-gui .title:hover {\n    background: var(--title-background-color);\n    opacity: 0.85;\n  }\n  .lil-gui .title:focus {\n    text-decoration: underline var(--focus-color);\n  }\n}\n.lil-gui.root > .title:focus {\n  text-decoration: none !important;\n}\n.lil-gui.closed > .title:before {\n  content: "\u25b8";\n}\n.lil-gui.closed > .children {\n  transform: translateY(-7px);\n  opacity: 0;\n}\n.lil-gui.closed:not(.transition) > .children {\n  display: none;\n}\n.lil-gui.transition > .children {\n  transition-duration: 300ms;\n  transition-property: height, opacity, transform;\n  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);\n  overflow: hidden;\n  pointer-events: none;\n}\n.lil-gui .children:empty:before {\n  content: "Empty";\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n  display: block;\n  height: var(--widget-height);\n  font-style: italic;\n  line-height: var(--widget-height);\n  opacity: 0.5;\n}\n.lil-gui.root > .children > .lil-gui > .title {\n  border: 0 solid var(--widget-color);\n  border-width: 1px 0;\n  transition: border-color 300ms;\n}\n.lil-gui.root > .children > .lil-gui.closed > .title {\n  border-bottom-color: transparent;\n}\n.lil-gui + .controller {\n  border-top: 1px solid var(--widget-color);\n  margin-top: 0;\n  padding-top: var(--spacing);\n}\n.lil-gui .lil-gui .lil-gui > .title {\n  border: none;\n}\n.lil-gui .lil-gui .lil-gui > .children {\n  border: none;\n  margin-left: var(--folder-indent);\n  border-left: 2px solid var(--widget-color);\n}\n.lil-gui .lil-gui .controller {\n  border: none;\n}\n\n.lil-gui input {\n  -webkit-tap-highlight-color: transparent;\n  border: 0;\n  outline: none;\n  font-family: var(--font-family);\n  font-size: var(--input-font-size);\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  background: var(--widget-color);\n  color: var(--text-color);\n  width: 100%;\n}\n@media (hover: hover) {\n  .lil-gui input:hover {\n    background: var(--hover-color);\n  }\n  .lil-gui input:active {\n    background: var(--focus-color);\n  }\n}\n.lil-gui input:disabled {\n  opacity: 1;\n}\n.lil-gui input[type=text],\n.lil-gui input[type=number] {\n  padding: var(--widget-padding);\n}\n.lil-gui input[type=text]:focus,\n.lil-gui input[type=number]:focus {\n  background: var(--focus-color);\n}\n.lil-gui input::-webkit-outer-spin-button,\n.lil-gui input::-webkit-inner-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n.lil-gui input[type=number] {\n  -moz-appearance: textfield;\n}\n.lil-gui input[type=checkbox] {\n  appearance: none;\n  -webkit-appearance: none;\n  height: var(--checkbox-size);\n  width: var(--checkbox-size);\n  border-radius: var(--widget-border-radius);\n  text-align: center;\n  cursor: pointer;\n}\n.lil-gui input[type=checkbox]:checked:before {\n  font-family: "lil-gui";\n  content: "\u2713";\n  font-size: var(--checkbox-size);\n  line-height: var(--checkbox-size);\n}\n@media (hover: hover) {\n  .lil-gui input[type=checkbox]:focus {\n    box-shadow: inset 0 0 0 1px var(--focus-color);\n  }\n}\n.lil-gui button {\n  -webkit-tap-highlight-color: transparent;\n  outline: none;\n  cursor: pointer;\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  color: var(--text-color);\n  width: 100%;\n  height: var(--widget-height);\n  text-transform: none;\n  background: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  border: 1px solid var(--widget-color);\n  text-align: center;\n  line-height: calc(var(--widget-height) - 4px);\n}\n@media (hover: hover) {\n  .lil-gui button:hover {\n    background: var(--hover-color);\n    border-color: var(--hover-color);\n  }\n  .lil-gui button:focus {\n    border-color: var(--focus-color);\n  }\n}\n.lil-gui button:active {\n  background: var(--focus-color);\n}\n\n@font-face {\n  font-family: "lil-gui";\n  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");\n}'),NG=!0),n?n.appendChild(this.domElement):t&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),r&&this.domElement.style.setProperty("--width",r+"px"),this.domElement.addEventListener("keydown",l=>l.stopPropagation()),this.domElement.addEventListener("keyup",l=>l.stopPropagation())}add(e,t,n,r,s){if(Object(n)===n)return new Abe(this,e,t,n);const o=e[t];switch(typeof o){case"number":return new ybe(this,e,t,n,r,s);case"boolean":return new pbe(this,e,t);case"string":return new xbe(this,e,t);case"function":return new zD(this,e,t)}console.error("gui.add failed\n\tproperty:",t,"\n\tobject:",e,"\n\tvalue:",o)}addColor(e,t,n=1){return new vbe(this,e,t,n)}addFolder(e){return new HD({parent:this,title:e})}load(e,t=!0){return e.controllers&&this.controllers.forEach(n=>{n instanceof zD||n._name in e.controllers&&n.load(e.controllers[n._name])}),t&&e.folders&&this.folders.forEach(n=>{n._title in e.folders&&n.load(e.folders[n._title])}),this}save(e=!0){const t={controllers:{},folders:{}};return this.controllers.forEach(n=>{if(!(n instanceof zD)){if(n._name in t.controllers)throw new Error(`Cannot save GUI with duplicate property "${n._name}"`);t.controllers[n._name]=n.save()}}),e&&this.folders.forEach(n=>{if(n._title in t.folders)throw new Error(`Cannot save GUI with duplicate folder "${n._title}"`);t.folders[n._title]=n.save()}),t}open(e=!0){return this._closed=!e,this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(e=!0){return this._closed=!e,this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{this.$children.style.height=this.$children.clientHeight+"px",this.domElement.classList.add("transition");const n=s=>{s.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",n))};this.$children.addEventListener("transitionend",n);const r=e?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!e),requestAnimationFrame(()=>{this.$children.style.height=r+"px"})}),this}title(e){return this._title=e,this.$title.innerHTML=e,this}reset(e=!0){return(e?this.controllersRecursive():this.controllers).forEach(n=>n.reset()),this}onChange(e){return this._onChange=e,this}_callOnChange(e){this.parent&&this.parent._callOnChange(e),void 0!==this._onChange&&this._onChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(e){this.parent&&this.parent._callOnFinishChange(e),void 0!==this._onFinishChange&&this._onFinishChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(e=>e.destroy())}controllersRecursive(){let e=Array.from(this.controllers);return this.folders.forEach(t=>{e=e.concat(t.controllersRecursive())}),e}foldersRecursive(){let e=Array.from(this.folders);return this.folders.forEach(t=>{e=e.concat(t.foldersRecursive())}),e}}const Mbe=HD,Ebe=["outlinePass"],GD=function(i,e,t){return[i,e,t]};function Sbe(i,e){if(1&i){const t=Gs();ve(0,"th-mesh",14),mt("onMouseEnter",function(r){return cr(t),dr(bi().onHover(r))})("onMouseExit",function(){return cr(t),dr(bi().onBlur())})("onPointerDown",function(r){return cr(t),dr(bi().onPointerDown(r))}),ze(1,"th-meshPhongMaterial",15),Ie()}if(2&i){const t=e.$implicit;bi(),K("geometry",qt(11).objRef)("position",Ed(7,GD,t.x,t.y,t.z))("scale",Ed(11,GD,t.scale,t.scale,t.scale))("receiveShadow",!0)("castShadow",!0),oe(1),K("flatShading",!0)("color",t.color)}}const Tbe=function(){return["#ffffff"]},Ibe=function(){return[0,0,8]},Rbe=function(){return["#aaaaaa"]},Dbe=function(){return["#ddffdd"]},Pbe=function(){return[3,48,24]};class Ob{constructor(e){this.elem=e,this.outlinePassResolution=new ue(window.innerWidth,window.innerHeight),this.meshData=[],this.visibleEdgeColor="#ffffff",this.hiddenEdgeColor="#190a05",this.edgeStrength=3,this.edgeGlow=.5,this.edgeThickness=1,this.pulsePeriod=1,this.initGUI(),this.initMeshData()}initGUI(){const e=new Mbe({title:"Settings",injectStyles:!0,container:this.elem.nativeElement,autoPlace:!0});e.add(this,"edgeStrength",.01,10),e.add(this,"edgeGlow",0,2),e.add(this,"edgeThickness",1,4),e.add(this,"pulsePeriod",0,5),e.addColor(this,"visibleEdgeColor"),e.addColor(this,"hiddenEdgeColor")}ngOnInit(){this.outlinePassResolution=new ue(window.innerWidth,window.innerHeight),this.outlinePass&&(this.outlinePass.resolution=this.outlinePassResolution)}initMeshData(){for(let e=0;e<20;e++)this.meshData.push({color:(new De).setHSL(Math.random(),1,.3),x:4*Math.random()-2,y:4*Math.random()-2,z:4*Math.random()-2,scale:.3*Math.random()+.1})}onHover(e){e.component.objRef&&(this.outlinePass.selectedObjects=[e.component.objRef])}onBlur(){this.outlinePass.selectedObjects=[]}onPointerDown(e){e.component.objRef?.material.color.set("#ff0000")}}Ob.\u0275fac=function(e){return new(e||Ob)(R(Ht))},Ob.\u0275cmp=$({type:Ob,selectors:[["app-outline-pass-events-example"]],viewQuery:function(e,t){if(1&e&&Di(Ebe,7),2&e){let n;Pt(n=kt())&&(t.outlinePass=n.first)}},decls:19,vars:32,consts:[[3,"shadow","thStats"],["thecanvas",""],[3,"background"],["scene",""],[3,"position","fov","near","far"],["camera",""],[3,"color"],[3,"color","intensity"],["light",""],[3,"args"],["geometry",""],[3,"geometry","position","scale","receiveShadow","castShadow","onMouseEnter","onMouseExit","onPointerDown",4,"ngFor","ngForOf"],[3,"args","visibleEdgeColor","hiddenEdgeColor","edgeStrength","edgeGlow","edgeThickness","pulsePeriod"],["outlinePass",""],[3,"geometry","position","scale","receiveShadow","castShadow","onMouseEnter","onMouseExit","onPointerDown"],[3,"flatShading","color"]],template:function(e,t){if(1&e&&(ve(0,"th-canvas",0,1)(2,"th-scene",2,3)(4,"th-perspectiveCamera",4,5),ze(6,"th-orbitControls"),Ie(),ze(7,"th-ambientLight",6)(8,"th-directionalLight",7,8)(10,"th-sphereGeometry",9,10),Vt(12,Sbe,2,15,"th-mesh",11),Ie(),ve(13,"th-effectComposer"),ze(14,"th-renderPass")(15,"th-outlinePass",12,13),fr(17,"color"),fr(18,"color"),Ie()()),2&e){const n=qt(3),r=qt(5);K("shadow",!0)("thStats",!0),oe(2),K("background",Re(23,Tbe)),oe(2),K("position",Re(24,Ibe))("fov",45)("near",.1)("far",100),oe(3),K("color",Re(25,Rbe)),oe(1),K("color",Re(26,Dbe))("intensity",.6),oe(2),K("args",Re(27,Pbe)),oe(2),K("ngForOf",t.meshData),oe(3),K("args",Ed(28,GD,t.outlinePassResolution,n.objRef,r.objRef))("visibleEdgeColor",Er(17,19,t.visibleEdgeColor))("hiddenEdgeColor",Er(18,21,t.hiddenEdgeColor))("edgeStrength",t.edgeStrength)("edgeGlow",t.edgeGlow)("edgeThickness",t.edgeThickness)("pulsePeriod",t.pulsePeriod)}},dependencies:[$l,ds,rn,Ts,xr,Vn,mn,no,Xa,Ol,$u,Bc,Vi,Va,Io,Gc],styles:["[_nghost-%COMP%]     .lil-gui{position:fixed;right:0;z-index:9999}"]});const kbe=["camera"],Fbe=function(){return["#72645b",2,15]},Bbe=function(i){return[0,i,0]},jG=function(i){return[i,0,0]},Lbe=function(){return[40,40]},Obe=function(){return{color:"#999999",specular:"#101010"}},Nbe=function(i){return[0,i,.3]},jbe=function(){return[.001,.001,.001]},Ube=function(){return{color:"#0055ff",flatShading:!0}},Vbe=function(){return["#443333","#111122"]},zbe=function(){return[1,1,1]},Hbe=function(i){return[.5,1,i]},Gbe=function(){return[35,2,1,15]};class Nb{constructor(){this.Math=Math,this.cameraPosition=new T(3,.15,3),this.assetPath=`${aa}dolphins.ply`}onBeforeRender(){const e=5e-4*Date.now();this.camera&&(this.camera.position=new T(2.5*Math.sin(e),.15,2.5*Math.cos(e)),this.camera.lookAt=[0,.1,0])}}Nb.\u0275fac=function(e){return new(e||Nb)},Nb.\u0275cmp=$({type:Nb,selectors:[["app-plyloader-example"]],viewQuery:function(e,t){if(1&e&&Di(kbe,5),2&e){let n;Pt(n=kt())&&(t.camera=n.first)}},decls:17,vars:55,consts:[[3,"shadow","onRender"],[3,"background","fog"],[3,"position","rotation","receiveShadow"],[3,"args"],[3,"rotation","position","scale","castShadow","receiveShadow"],["loadPLY","",3,"url"],[3,"castShadow","position","color","intensity","shadowMapHeight","shadowMapWidth"],["camera",""]],template:function(e,t){1&e&&(ve(0,"th-canvas",0),mt("onRender",function(){return t.onBeforeRender()}),ve(1,"th-scene",1),fr(2,"color"),fr(3,"fog"),ve(4,"th-mesh",2),ze(5,"th-planeGeometry",3)(6,"th-meshPhongMaterial",3),Ie(),ve(7,"th-mesh",4),ze(8,"th-bufferGeometry",5)(9,"th-meshStandardMaterial",3),Ie(),ze(10,"th-hemisphereLight",3)(11,"th-directionalLight",6),fr(12,"color"),ze(13,"th-directionalLight",6),fr(14,"color"),ze(15,"th-perspectiveCamera",3,7),Ie()()),2&e&&(K("shadow",!0),oe(1),K("background",Er(2,29,"#72645b"))("fog",Er(3,31,Re(37,Fbe))),oe(3),K("position",ui(38,Bbe,-.5))("rotation",ui(40,jG,-t.Math.PI/2))("receiveShadow",!0),oe(1),K("args",Re(42,Lbe)),oe(1),K("args",Re(43,Obe)),oe(1),K("rotation",ui(44,jG,-t.Math.PI/2))("position",ui(46,Nbe,-.2))("scale",Re(48,jbe))("castShadow",!0)("receiveShadow",!0),oe(1),K("url",t.assetPath),oe(1),K("args",Re(49,Ube)),oe(1),K("args",Re(50,Vbe)),oe(1),K("castShadow",!0)("position",Re(51,zbe))("color",Er(12,33,"#ffffff"))("intensity",1.35)("shadowMapHeight",1024)("shadowMapWidth",1024),oe(2),K("castShadow",!0)("position",ui(52,Hbe,-1))("color",Er(14,35,"#ffaa00"))("intensity",1)("shadowMapHeight",1024)("shadowMapWidth",1024),oe(2),K("args",Re(54,Gbe)))},dependencies:[rn,Dl,Ts,Vn,mn,Ul,no,Mt,sa,Vi,vb,Gc,pp],encapsulation:2,changeDetection:0});const Qbe=["object"],Wbe=["light"];function qbe(i,e){if(1&i&&(ve(0,"th-mesh",14),ze(1,"th-meshPhongMaterial",15),Ie()),2&i){const t=e.$implicit;bi(),K("geometry",qt(15).objRef)("position",t.pos)("rotation",t.rotation)("scale",t.scale),oe(1),K("flatShading",!0)("color",t.color)}}const Xbe=function(i){return[i]},Ybe=function(i){return{value:i}},Zbe=function(i){return{amount:i}},Kbe=function(){return["#ffffff"]},$be=function(i){return[0,0,i]},Jbe=function(){return["0x222222"]},eve=function(){return["0xffffff"]},tve=function(){return[1,4,4]};class jb{constructor(){this.DotScreenShader=WR,this.RGBShiftShader=kH,this.shiftAmount=.0015,this.zDist=400,this.meshData=[],this.initMeshData()}ngOnInit(){this.light?.position?.set(1,1,1)}initMeshData(){for(let e=0;e<100;e++){const t=50*Math.random();this.meshData.push({pos:new T(Math.random()-.5,Math.random()-.5,Math.random()-.5).normalize().multiplyScalar(Math.random()*this.zDist),rotation:new $s(2*Math.random(),2*Math.random(),2*Math.random()),scale:new T(t,t,t),color:new De(16777215*Math.random())})}}animate(){this.object?.objRef?.rotation&&(this.object.objRef.rotation.x+=.005,this.object.objRef.rotation.y+=.01)}}jb.\u0275fac=function(e){return new(e||jb)},jb.\u0275cmp=$({type:jb,selectors:[["app-post-processing-example"]],viewQuery:function(e,t){if(1&e&&(Di(Qbe,7),Di(Wbe,7)),2&e){let n;Pt(n=kt())&&(t.object=n.first),Pt(n=kt())&&(t.light=n.first)}},decls:19,vars:30,consts:[["for","shift"],["id","shift","type","range",3,"ngModel","min","max","step","ngModelChange"],[3,"shadow","thStats","onRender"],["thecanvas",""],[3,"strength"],[3,"args","uniforms"],[3,"background"],[3,"position","fov","near","far"],[3,"color"],["light",""],[3,"args"],["geometry",""],["object",""],[3,"geometry","position","rotation","scale",4,"ngFor","ngForOf"],[3,"geometry","position","rotation","scale"],[3,"flatShading","color"]],template:function(e,t){1&e&&(ve(0,"label",0),qi(1,"Shift Amount"),Ie(),ve(2,"input",1),mt("ngModelChange",function(r){return t.shiftAmount=r}),Ie(),ve(3,"th-canvas",2,3),mt("onRender",function(){return t.animate()}),ve(5,"th-effectComposer"),ze(6,"th-renderPass")(7,"th-unrealBloomPass",4)(8,"th-shaderPass",5),Ie(),ve(9,"th-scene",6),ze(10,"th-perspectiveCamera",7)(11,"th-ambientLight",8)(12,"th-directionalLight",8,9)(14,"th-sphereGeometry",10,11),ve(16,"th-object3D",null,12),Vt(18,qbe,2,6,"th-mesh",13),Ie()()()),2&e&&(oe(2),K("ngModel",t.shiftAmount)("min",.0015)("max",.2)("step",.005),oe(1),K("shadow",!0)("thStats",!0),oe(4),K("strength",1),oe(1),K("args",ui(18,Xbe,t.RGBShiftShader))("uniforms",ui(22,Zbe,ui(20,Ybe,t.shiftAmount))),oe(1),K("background",Re(24,Kbe)),oe(1),K("position",ui(25,$be,t.zDist))("fov",70)("near",1)("far",1e3),oe(1),K("color",Re(27,Jbe)),oe(1),K("color",Re(28,eve)),oe(2),K("args",Re(29,tve)),oe(4),K("ngForOf",t.meshData))},dependencies:[$l,rn,Ye,Ts,xr,Vn,mn,no,Xa,Ol,Bc,jl,Hc,Vi,Io,_C,BD,xD,SC],styles:["label[_ngcontent-%COMP%]{margin-right:.5em}"],changeDetection:0});const QD=function(i){return[0,i,0]},ive=function(){return[0,1,0]},nve=function(){return[4,10,2]},rve=function(i){return[i,0,0]},sve=function(){return[100,100]},ove=function(){return[55,2,.1,100]},ave=function(i,e){return[i,0,e]},lve=function(){return[0,0,0]};class Ub{constructor(e){this.Math=Math,this.selected=!1,this.glbPath=`${aa}mac-draco.glb`,this.clock=new up(!0),this.plane=new to(new T(0,1,0),3),this.rotation=[0,0,0],this.position=[0,0,0],this.uniforms={time:{value:1}},this.fragmentShader1="\nuniform float time;\nvarying vec2 vUv;\n\nvoid main( void ) {\n  vec2 position = - 1.0 + 2.0 * vUv;\n\n  float red = abs( sin( position.x * position.y + time / 5.0 ) );\n  float green = abs( sin( position.x * position.y + time / 4.0 ) );\n  float blue = abs( sin( position.x * position.y + time / 3.0 ) );\n  gl_FragColor = vec4( red, green, blue, 1.0 );\n\n}\n",this.fragmentShader2="\n  uniform float time;\n  varying vec2 vUv;\n\n  void main( void ) {\n    vec2 position = vUv;\n    float color = 0.0;\n    color += sin( position.x * cos( time / 15.0 ) * 80.0 ) + cos( position.y * cos( time / 15.0 ) * 10.0 );\n    color += sin( position.y * sin( time / 10.0 ) * 40.0 ) + cos( position.x * sin( time / 25.0 ) * 40.0 );\n    color += sin( position.x * sin( time / 5.0 ) * 10.0 ) + sin( position.y * sin( time / 35.0 ) * 80.0 );\n    color *= sin( time / 10.0 ) * 0.5;\n    gl_FragColor = vec4( vec3( color, color * 0.5, sin( color + time / 3.0 ) * 0.75 ), 1.0 );\n  }\n  ",this.vertexShader="varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    gl_Position = projectionMatrix * mvPosition;\n  }\n  ",e.setDecoderPath("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/jsm/libs/draco/gltf/"),e.setCrossOrigin("no-cors"),this.calcPose()}onBeforeRender(){this.calcPose(),this.calcUniforms()}calcPose(){const e=this.clock.getElapsedTime();this.rotation=[gt.lerp(this.rotation[0],Math.cos(e/2)/20+.25,.1),gt.lerp(this.rotation[1],Math.sin(e/4)/20,.1),gt.lerp(this.rotation[2],Math.sin(e/8)/20,.1)],this.position=[0,gt.lerp(this.position[1],(-2+Math.sin(e/2))/2,.1),0]}calcUniforms(){this.uniforms.time.value=1+5*this.clock.getElapsedTime()}}Ub.\u0275fac=function(e){return new(e||Ub)(R(Pl))},Ub.\u0275cmp=$({type:Ub,selectors:[["app-ref-by-id-example"]],decls:17,vars:45,consts:[[3,"thStats","shadow","onRender"],[3,"rotation","position"],["loadGLTF","",3,"castShadow","url","position","rotation","onClick"],[3,"refById"],[3,"vertexShader","fragmentShader","uniforms"],["shader",""],[3,"castShadow","position","lookAt","color","intensity"],["light",""],[3,"receiveShadow","rotation","position"],[3,"args"],[3,"color"],[3,"args","position","lookAt"]],template:function(e,t){if(1&e){const n=Gs();ve(0,"th-canvas",0),mt("onRender",function(){return t.onBeforeRender()}),ve(1,"th-scene"),ze(2,"th-ambientLight"),ve(3,"th-group",1)(4,"th-object3D",2),mt("onClick",function(){cr(n);const s=qt(7);return t.selected=!t.selected,dr(s.needsUpdate=!0)}),ve(5,"th-mesh",3),ze(6,"th-shaderMaterial",4,5),Ie()()(),ze(8,"th-directionalLight",6,7),fr(10,"color"),ve(11,"th-mesh",8),ze(12,"th-planeGeometry",9)(13,"th-meshBasicMaterial",10),fr(14,"color"),Ie(),ve(15,"th-perspectiveCamera",11),ze(16,"th-orbitControls"),Ie()()()}2&e&&(K("thStats",!0)("shadow",!0),oe(3),K("rotation",ui(29,QD,t.Math.PI))("position",Re(31,ive)),oe(1),K("castShadow",!0)("url",t.glbPath)("position",t.position)("rotation",t.rotation),oe(1),K("refById","Cube008_2"),oe(1),K("vertexShader",t.vertexShader)("fragmentShader",t.selected?t.fragmentShader1:t.fragmentShader2)("uniforms",t.uniforms),oe(2),K("castShadow",!0)("position",Re(32,nve))("lookAt",ui(33,QD,-3))("color",Er(10,25,"#ffffff"))("intensity",.75),oe(3),K("receiveShadow",!0)("rotation",ui(35,rve,3*t.Math.PI/2))("position",ui(37,QD,-3)),oe(1),K("args",Re(39,sve)),oe(1),K("color",Er(14,27,"#efefef")),oe(2),K("args",Re(40,ove))("position",wa(41,ave,-5,-15))("lookAt",Re(44,lve)))},dependencies:[ds,rn,Ye,Ts,xr,Vn,Nl,mn,Uc,ja,sa,Vi,Po,Va,Io,pg,Gc],encapsulation:2,changeDetection:0});const WD=function(){return[0,0,0]},cve=function(){return[2,2,2]},dve=function(){return[1,1,1]},uve=function(i,e){return[i,e]},hve=function(){return[10,10]},UG=function(){return[10,10,10]},fve=function(){return[45,2,.1,100]};class gg extends Vn{constructor(e){super(e)}ngOnInit(){super.ngOnInit(),this.objRef&&(this.objRef.material=new La({color:"green"}),this.objRef.geometry=new Ki(1,1,1))}}gg.\u0275fac=function(e){return new(e||gg)(R(Ye,4))},gg.\u0275cmp=$({type:gg,selectors:[["th-box"]],features:[se(function ige(i){return[{provide:Ye,useExisting:le(()=>i)}]}(gg)),W],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class Vb{constructor(){this.THREE=wg,this.box=new Da(new T(0,0,0),new T(1.5,1.5,1.5)),this.color=new De(1,0,0),this.rotation=[0,0,0],this.material=new La,this.selected=!1,this.material.color.set("green"),setInterval(()=>{0!==this.material.color.r?(this.material=new La,this.material.color.set("green")):(this.material=new La,this.material.color.set("red"))},200)}onBeforeRender(){this.rotation=[0,this.rotation[2]+.01,this.rotation[2]+.01]}ngOnInit(){}}Vb.\u0275fac=function(e){return new(e||Vb)},Vb.\u0275cmp=$({type:Vb,selectors:[["app-simple-example"]],decls:8,vars:24,consts:[[3,"onRender"],[3,"position","material","rotation","scale","onClick"],[3,"args","material","position"],[3,"args"],[3,"position"],[3,"args","position","lookAt"]],template:function(e,t){1&e&&(ve(0,"th-canvas",0),mt("onRender",function(){return t.onBeforeRender()}),ve(1,"th-scene"),ze(2,"th-ambientLight"),ve(3,"th-box",1),mt("onClick",function(){return t.selected=!t.selected}),Ie(),ze(4,"th-box3Helper",2)(5,"th-gridHelper",3)(6,"th-pointLight",4)(7,"th-perspectiveCamera",5),Ie()()),2&e&&(oe(3),K("position",Re(12,WD))("material",t.material)("rotation",t.rotation)("scale",t.selected?Re(13,cve):Re(14,dve)),oe(1),K("args",wa(15,uve,t.box,t.color))("material",t.material)("position",Re(18,WD)),oe(1),K("args",Re(19,hve)),oe(1),K("position",Re(20,UG)),oe(1),K("args",Re(21,fve))("position",Re(22,UG))("lookAt",Re(23,WD)))},dependencies:[rn,io,Ou,so,xr,mn,Vi,Va,gg],encapsulation:2,changeDetection:0});const pve=["thecanvas"],mve=function(i,e,t,n){return{x:i,y:e,width:t,height:n}};function gve(i,e){if(1&i){const t=Gs();ve(0,"th-view",11,12),mt("onRender",function(){const s=cr(t).$implicit,o=qt(3);bi();const a=qt(3);return dr(s.updateCamera(o.objRef,a.objRef))}),ze(2,"th-perspectiveCamera",13,14),Ie()}if(2&i){const t=e.$implicit,n=qt(1),r=bi();K("scene",qt(3))("viewPort",a_(11,mve,t.left*r.canvasWidth,t.bottom*r.canvasHeight,t.width*r.canvasWidth,t.height*r.canvasHeight))("scissor",n.viewPort)("scissorTest",!0)("clearColor",t.background),oe(2),K("position",t.eye)("up",t.up)("fov",t.fov)("aspect",t.width*r.canvasWidth/(t.height*r.canvasHeight))("near",1)("far",1e4)}}const _ve=function(i,e){return{x:0,y:0,width:i,height:e}},bve=function(){return[0,0,1]},vve=function(){return["#ffffff"]},yve=function(){return[0,0,0]},IC=function(i){return[i,0,0]},Ave=function(){return[200,32,16]},xve=function(){return["#fac400"]},wve=function(){return["#f83f0d"]},Cve=function(){return[400,0,0]};class zb{constructor(){this.Math=Math,this.canvasWidth=128,this.canvasHeight=128,this.mouseX=0,this.mouseY=0,this.views=[{left:0,bottom:0,width:.5,height:1,background:new De(.5,.5,.7),eye:[0,300,1800],up:[0,1,0],fov:30,updateCamera:(e,t)=>{this.updateSize(),e.position.x+=.05*this.mouseX,e.position.x=Math.max(Math.min(e.position.x,2e3),-2e3),e.lookAt(t.position),e.updateProjectionMatrix()}},{left:.5,bottom:0,width:.5,height:.5,background:new De(.7,.5,.5),eye:[0,1800,0],up:[0,0,1],fov:45,updateCamera:(e,t)=>{this.updateSize(),e.position.x-=.05*this.mouseX,e.position.x=Math.max(Math.min(e.position.x,2e3),-2e3),e.lookAt(e.position.clone().setY(0)),e.updateProjectionMatrix()}},{left:.5,bottom:.5,width:.5,height:.5,background:new De(.5,.7,.7),eye:[1400,800,1400],up:[0,1,0],fov:60,updateCamera:(e,t)=>{this.updateSize(),e.position.y-=.05*this.mouseX,e.position.y=Math.max(Math.min(e.position.y,1600),-1600),e.lookAt(t.position),e.updateProjectionMatrix()}}]}ngOnInit(){!this.canvas||!this.canvas.rendererCanvas||(this.shadowTexture=new ax(this.canvas.rendererCanvas.nativeElement))}animate(e){}updateSize(){!this.canvas||!this.canvas.rendererCanvas||(this.canvasWidth=this.canvas.rendererCanvas.nativeElement.width,this.canvasHeight=this.canvas.rendererCanvas.nativeElement.height)}onMouseMove(e){if(!this.canvas||!this.canvas.rendererCanvas)return;const t=this.canvas.rendererCanvas.nativeElement.getBoundingClientRect();this.mouseX=e.clientX-t.left-t.width/2,this.mouseY=e.clientY-t.right-t.height/2}}zb.\u0275fac=function(e){return new(e||zb)},zb.\u0275cmp=$({type:zb,selectors:[["app-views-example"]],viewQuery:function(e,t){if(1&e&&Di(pve,7),2&e){let n;Pt(n=kt())&&(t.canvas=n.first)}},hostBindings:function(e,t){1&e&&mt("mousemove",function(r){return t.onMouseMove(r)},0,jv)},decls:13,vars:38,consts:[[3,"disableDefaultView","viewPort"],["thecanvas",""],["scene",""],[3,"position","args"],[3,"position","rotation"],[3,"args"],["geo",""],[3,"flatShading","shininess","specular","color"],["mat",""],[3,"position","rotation","geometry","material"],[3,"scene","viewPort","scissor","scissorTest","clearColor","onRender",4,"ngFor","ngForOf"],[3,"scene","viewPort","scissor","scissorTest","clearColor","onRender"],["thview",""],[3,"position","up","fov","aspect","near","far"],["camera",""]],template:function(e,t){if(1&e&&(ve(0,"th-canvas",0,1)(2,"th-scene",null,2),ze(4,"th-directionalLight",3),ve(5,"th-mesh",4),ze(6,"th-sphereGeometry",5,6)(8,"th-meshPhongMaterial",7,8),Ie(),ze(10,"th-mesh",9)(11,"th-mesh",9),Ie(),Vt(12,gve,4,16,"th-view",10),Ie()),2&e){const n=qt(7),r=qt(9);K("disableDefaultView",!0)("viewPort",wa(20,_ve,.5*t.canvasWidth,t.canvasHeight)),oe(4),K("position",Re(23,bve))("args",Re(24,vve)),oe(1),K("position",Re(25,yve))("rotation",ui(26,IC,-t.Math.PI/2)),oe(1),K("args",Re(28,Ave)),oe(2),K("flatShading",!1)("shininess",30)("specular",Re(29,xve))("color",Re(30,wve)),oe(2),K("position",ui(31,IC,-400))("rotation",ui(33,IC,-t.Math.PI/2))("geometry",n.objRef)("material",r.objRef),oe(1),K("position",Re(35,Cve))("rotation",ui(36,IC,-t.Math.PI/2))("geometry",n.objRef)("material",r.objRef),oe(1),K("ngForOf",t.views)}},dependencies:[$l,rn,Ts,Vn,mn,no,Xa,Vi,Is],changeDetection:0});const RC=[{path:"basic-example",data:{title:"Basic Example",exampleComponent:B0,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/basic-example/basic-example.component.ts"]}},{path:"simple-example",data:{title:"Simple Example",exampleComponent:Vb,declarations:["SimpleExampleComponent","Box"],codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/simple-example/simple-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/simple-example/simple-example.component.ts"]}},{path:"introductory-example",data:{title:"Introductory Example",exampleComponent:Eb,declarations:["IntroductoryExampleComponent","Box"],codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/introductory-example/introductory-example.component.ts"]}},{path:"controls-example",data:{title:"Controls Example",exampleComponent:L0,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/controls-example/controls-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/controls-example/controls-example.component.ts"]}},{path:"loader-example",data:{title:"Loader Example",exampleComponent:Sb,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/loader-example/loader-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/loader-example/loader-example.component.ts"]}},{path:"dynamic loader-example",data:{title:"Dynamic Loader Example",exampleComponent:O0,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/dynamic-loader-example/dynamic-loader-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/dynamic-loader-example/dynamic-loader-example.component.ts"]}},{path:"events-example",data:{title:"Events Example",exampleComponent:j0,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/events-example/events-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/events-example/events-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/events-example/events-example.component.scss"]}},{path:"instanced-mesh-example",data:{title:"Instanced Mesh Example",exampleComponent:Cb,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/instanced-mesh-example/instanced-mesh-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/instanced-mesh-example/instanced-mesh-example.component.ts"]}},{path:"post-processing-example",data:{title:"Post Processing Example",exampleComponent:jb,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/post-processing-example/post-processing-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/post-processing-example/post-processing-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/post-processing-example/post-processing-example.component.scss"]}},{path:"views-example",data:{title:"Multiple Views Example",exampleComponent:zb,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/views-example/views-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/views-example/views-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/views-example/views-example.component.scss"]}},{path:"multi-scene-example",data:{title:"Multiple Scenes Example",codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-scene-example/multi-scene-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-scene-example/multi-scene-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-scene-example/multi-scene-example.component.scss"],exampleComponent:Tb}},{path:"multi-view-postprocessing-example",data:{title:"Multiple View Post Processing Example",exampleComponent:Ib,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-view-postprocessing-example/multi-view-postprocessing-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-view-postprocessing-example/multi-view-postprocessing-example.component.ts"]}},{path:"animation-example",data:{title:"Animation Example",exampleComponent:F0,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/animation-example/animation-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/animation-example/animation-example.component.ts"]}},{path:"plyloader-example",data:{title:"PLY Loader Example",exampleComponent:Nb,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/plyloader-example/plyloader-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/plyloader-example/plyloader-example.component.ts"]}},{path:"on-demand-example",data:{title:"On-Demand Rendering Example",exampleComponent:Bb,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/on-demand-example/on-demand-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/on-demand-example/on-demand-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/on-demand-example/on-demand-example.component.scss"]}},{path:"ref-by-id-example",data:{title:"Ref By Id Example",exampleComponent:Ub,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/ref-by-id-example/ref-by-id-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/ref-by-id-example/ref-by-id-example.component.ts"]}},{path:"html-example",data:{title:"Html Content Example",exampleComponent:xb,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/html-example/html-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/html-example/html-example.component.ts"]}},{path:"outline-pass-events-example",data:{title:"Render Pass + Events Example",exampleComponent:Ob,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/outline-pass-events-example/outline-pass-events-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/outline-pass-events-example/outline-pass-events-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/outline-pass-events-example/outline-pass-events-example.component.scss"]}}];RC.forEach(i=>i.component=nb);const Mve=[];RC.forEach(i=>{Mve.push(i.component)});class _g{}_g.\u0275fac=function(e){return new(e||_g)},_g.\u0275mod=ci({type:_g}),_g.\u0275inj=oi({imports:[GN.forRoot(RC),GN]});let Sve=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[bn,bn]}),i})();const zG=["*"],GG=["unscopedContent"],Tve=["text"],Ive=[[["","matListItemAvatar",""],["","matListItemIcon",""]],[["","matListItemTitle",""]],[["","matListItemLine",""]],"*",[["","matListItemMeta",""]],[["mat-divider"]]],Rve=["[matListItemAvatar],[matListItemIcon]","[matListItemTitle]","[matListItemLine]","*","[matListItemMeta]","mat-divider"],QG=new Fe("ListOption");let WG=(()=>{class i{constructor(t){this._elementRef=t}}return i.\u0275fac=function(t){return new(t||i)(R(Ht))},i.\u0275dir=ke({type:i,selectors:[["","matListItemTitle",""]],hostAttrs:[1,"mat-mdc-list-item-title","mdc-list-item__primary-text"]}),i})(),qG=(()=>{class i{constructor(t){this._elementRef=t}}return i.\u0275fac=function(t){return new(t||i)(R(Ht))},i.\u0275dir=ke({type:i,selectors:[["","matListItemLine",""]],hostAttrs:[1,"mat-mdc-list-item-line","mdc-list-item__secondary-text"]}),i})(),Xve=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=ke({type:i,selectors:[["","matListItemMeta",""]],hostAttrs:[1,"mat-mdc-list-item-meta","mdc-list-item__end"]}),i})(),XG=(()=>{class i{constructor(t){this._listOption=t}_isAlignedAtStart(){return!this._listOption||"after"===this._listOption?._getTogglePosition()}}return i.\u0275fac=function(t){return new(t||i)(R(QG,8))},i.\u0275dir=ke({type:i,hostVars:4,hostBindings:function(t,n){2&t&&Mi("mdc-list-item__start",n._isAlignedAtStart())("mdc-list-item__end",!n._isAlignedAtStart())}}),i})(),Yve=(()=>{class i extends XG{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=ce(i)))(n||i)}}(),i.\u0275dir=ke({type:i,selectors:[["","matListItemAvatar",""]],hostAttrs:[1,"mat-mdc-list-item-avatar"],features:[W]}),i})(),Zve=(()=>{class i extends XG{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=ce(i)))(n||i)}}(),i.\u0275dir=ke({type:i,selectors:[["","matListItemIcon",""]],hostAttrs:[1,"mat-mdc-list-item-icon"],features:[W]}),i})();const Kve=new Fe("MAT_LIST_CONFIG");let bg=(()=>{class i{constructor(){this._isNonInteractive=!0,this._disableRipple=!1,this._disabled=!1,this._defaultOptions=Ut(Kve,{optional:!0})}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=zi(t)}get disabled(){return this._disabled}set disabled(t){this._disabled=zi(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=ke({type:i,hostVars:1,hostBindings:function(t,n){2&t&&hn("aria-disabled",n.disabled)},inputs:{disableRipple:"disableRipple",disabled:"disabled"}}),i})(),qD=(()=>{class i{set lines(t){this._explicitLines=us(t,null),this._updateItemLines(!1)}get disableRipple(){return this.disabled||this._disableRipple||this._noopAnimations||!!this._listBase?.disableRipple}set disableRipple(t){this._disableRipple=zi(t)}get disabled(){return this._disabled||!!this._listBase?.disabled}set disabled(t){this._disabled=zi(t)}get rippleDisabled(){return this.disableRipple||!!this.rippleConfig.disabled}constructor(t,n,r,s,o,a){this._elementRef=t,this._ngZone=n,this._listBase=r,this._platform=s,this._explicitLines=null,this._disableRipple=!1,this._disabled=!1,this._subscriptions=new cn,this._rippleRenderer=null,this._hasUnscopedTextContent=!1,this.rippleConfig=o||{},this._hostElement=this._elementRef.nativeElement,this._noopAnimations="NoopAnimations"===a,r&&!r._isNonInteractive&&this._initInteractiveListItem(),"button"===this._hostElement.nodeName.toLowerCase()&&!this._hostElement.hasAttribute("type")&&this._hostElement.setAttribute("type","button")}ngAfterViewInit(){this._monitorProjectedLinesAndTitle(),this._updateItemLines(!0)}ngOnDestroy(){this._subscriptions.unsubscribe(),null!==this._rippleRenderer&&this._rippleRenderer._removeTriggerEvents()}_hasIconOrAvatar(){return!(!this._avatars.length&&!this._icons.length)}_initInteractiveListItem(){this._hostElement.classList.add("mat-mdc-list-item-interactive"),this._rippleRenderer=new Ap(this,this._ngZone,this._hostElement,this._platform),this._rippleRenderer.setupTriggerEvents(this._hostElement)}_monitorProjectedLinesAndTitle(){this._ngZone.runOutsideAngular(()=>{this._subscriptions.add(ud(this._lines.changes,this._titles.changes).subscribe(()=>this._updateItemLines(!1)))})}_updateItemLines(t){if(!this._lines||!this._titles||!this._unscopedContent)return;t&&this._checkDomForUnscopedTextContent();const n=this._explicitLines??this._inferLinesFromContent(),r=this._unscopedContent.nativeElement;if(this._hostElement.classList.toggle("mat-mdc-list-item-single-line",n<=1),this._hostElement.classList.toggle("mdc-list-item--with-one-line",n<=1),this._hostElement.classList.toggle("mdc-list-item--with-two-lines",2===n),this._hostElement.classList.toggle("mdc-list-item--with-three-lines",3===n),this._hasUnscopedTextContent){const s=0===this._titles.length&&1===n;r.classList.toggle("mdc-list-item__primary-text",s),r.classList.toggle("mdc-list-item__secondary-text",!s)}else r.classList.remove("mdc-list-item__primary-text"),r.classList.remove("mdc-list-item__secondary-text")}_inferLinesFromContent(){let t=this._titles.length+this._lines.length;return this._hasUnscopedTextContent&&(t+=1),t}_checkDomForUnscopedTextContent(){this._hasUnscopedTextContent=Array.from(this._unscopedContent.nativeElement.childNodes).filter(t=>t.nodeType!==t.COMMENT_NODE).some(t=>!(!t.textContent||!t.textContent.trim()))}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(at),R(bg,8),R(Hn),R(Gx,8),R(rs,8))},i.\u0275dir=ke({type:i,contentQueries:function(t,n,r){if(1&t&&(Fn(r,Yve,4),Fn(r,Zve,4)),2&t){let s;Pt(s=kt())&&(n._avatars=s),Pt(s=kt())&&(n._icons=s)}},hostVars:3,hostBindings:function(t,n){2&t&&(hn("aria-disabled",n.disabled),Mi("mdc-list-item--disabled",n.disabled))},inputs:{lines:"lines",disableRipple:"disableRipple",disabled:"disabled"}}),i})(),$ve=(()=>{class i extends qD{get activated(){return this._activated}set activated(t){this._activated=zi(t)}constructor(t,n,r,s,o,a){super(t,n,r,s,o,a),this._activated=!1}_getAriaCurrent(){return"A"===this._hostElement.nodeName&&this._activated?"page":null}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(at),R(bg,8),R(Hn),R(Gx,8),R(rs,8))},i.\u0275cmp=$({type:i,selectors:[["mat-list-item"],["a","mat-list-item",""],["button","mat-list-item",""]],contentQueries:function(t,n,r){if(1&t&&(Fn(r,qG,5),Fn(r,WG,5),Fn(r,Xve,5)),2&t){let s;Pt(s=kt())&&(n._lines=s),Pt(s=kt())&&(n._titles=s),Pt(s=kt())&&(n._meta=s)}},viewQuery:function(t,n){if(1&t&&(Di(GG,5),Di(Tve,5)),2&t){let r;Pt(r=kt())&&(n._unscopedContent=r.first),Pt(r=kt())&&(n._itemText=r.first)}},hostAttrs:[1,"mat-mdc-list-item","mdc-list-item"],hostVars:11,hostBindings:function(t,n){2&t&&(hn("aria-current",n._getAriaCurrent()),Mi("mdc-list-item--activated",n.activated)("mdc-list-item--with-leading-avatar",0!==n._avatars.length)("mdc-list-item--with-leading-icon",0!==n._icons.length)("mdc-list-item--with-trailing-meta",0!==n._meta.length)("_mat-animation-noopable",n._noopAnimations))},inputs:{activated:"activated"},exportAs:["matListItem"],features:[W],ngContentSelectors:Rve,decls:10,vars:0,consts:[[1,"mdc-list-item__content"],[1,"mat-mdc-list-item-unscoped-content",3,"cdkObserveContent"],["unscopedContent",""],[1,"mat-mdc-focus-indicator"]],template:function(t,n){1&t&&(Pn(Ive),ti(0),ve(1,"span",0),ti(2,1),ti(3,2),ve(4,"span",1,2),mt("cdkObserveContent",function(){return n._updateItemLines(!0)}),ti(6,3),Ie()(),ti(7,4),ti(8,5),ze(9,"div",3))},dependencies:[iR],encapsulation:2,changeDetection:0}),i})(),eye=(()=>{class i extends bg{constructor(){super(...arguments),this._isNonInteractive=!1}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=ce(i)))(n||i)}}(),i.\u0275cmp=$({type:i,selectors:[["mat-nav-list"]],hostAttrs:["role","navigation",1,"mat-mdc-nav-list","mat-mdc-list-base","mdc-list"],exportAs:["matNavList"],features:[se([{provide:bg,useExisting:i}]),W],ngContentSelectors:zG,decls:1,vars:0,template:function(t,n){1&t&&(Pn(),ti(0))},styles:['.mdc-list-item--with-leading-avatar .mdc-list-item__start{width:40px;height:40px}.mdc-list-item--with-leading-icon .mdc-list-item__start{width:24px;height:24px}.mdc-list-item--with-leading-thumbnail .mdc-list-item__start{width:40px;height:40px}.mdc-list-item--with-leading-image .mdc-list-item__start{width:56px;height:56px}.mdc-list-item--with-leading-video .mdc-list-item__start{width:100px;height:56px}.mdc-list-item--with-leading-checkbox .mdc-list-item__start{width:40px;height:40px}.mdc-list-item--with-leading-radio .mdc-list-item__start{width:40px;height:40px}.mdc-list-item--with-leading-switch .mdc-list-item__start{width:36px;height:20px}.mdc-list-item--with-trailing-icon .mdc-list-item__end{width:24px;height:24px}.mdc-list-item--with-trailing-checkbox .mdc-list-item__end{width:40px;height:40px}.mdc-list-item--with-trailing-radio .mdc-list-item__end{width:40px;height:40px}.mdc-list-item--with-trailing-switch .mdc-list-item__end{width:36px;height:20px}.mdc-list-divider{height:1px}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-list-divider::after{content:"";display:block;border-bottom-width:1px;border-bottom-style:solid}}.mdc-list{margin:0;padding:8px 0;list-style-type:none}.mdc-list:focus{outline:none}.mdc-list-item__wrapper{display:block}.mdc-list-item{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;align-items:stretch;cursor:pointer}.mdc-list-item:focus{outline:none}.mdc-list-item.mdc-list-item--with-one-line{height:48px}.mdc-list-item.mdc-list-item--with-two-lines{height:64px}.mdc-list-item.mdc-list-item--with-three-lines{height:88px}.mdc-list-item.mdc-list-item--with-one-line .mdc-list-item__start{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--with-three-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--with-one-line .mdc-list-item__end{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-two-lines .mdc-list-item__end{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--disabled,.mdc-list-item.mdc-list-item--non-interactive{cursor:auto}.mdc-list-item:not(.mdc-list-item--selected):focus::before,.mdc-list-item.mdc-ripple-upgraded--background-focused::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-list-item:not(.mdc-list-item--selected):focus::before,.mdc-list-item.mdc-ripple-upgraded--background-focused::before{border-color:CanvasText}}.mdc-list-item.mdc-list-item--selected::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:3px double rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-list-item.mdc-list-item--selected::before{border-color:CanvasText}}.mdc-list-item.mdc-list-item--selected:focus::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:3px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-list-item.mdc-list-item--selected:focus::before{border-color:CanvasText}}a.mdc-list-item{color:inherit;text-decoration:none}.mdc-list-item__start{fill:currentColor;flex-shrink:0;pointer-events:none}.mdc-list-item__end{flex-shrink:0;pointer-events:none}.mdc-list-item__content{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;align-self:center;flex:1;pointer-events:none}.mdc-list-item--with-two-lines .mdc-list-item__content,.mdc-list-item--with-three-lines .mdc-list-item__content{align-self:stretch}.mdc-list-item__content[for]{pointer-events:none}.mdc-list-item__primary-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.mdc-list-item--with-two-lines .mdc-list-item__primary-text,.mdc-list-item--with-three-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before,.mdc-list-item--with-three-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after,.mdc-list-item--with-three-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item__secondary-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;margin-top:0;line-height:normal}.mdc-list-item__secondary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list-item--with-three-lines .mdc-list-item__secondary-text{white-space:normal;line-height:20px}.mdc-list-item--with-overline .mdc-list-item__secondary-text{white-space:nowrap;line-height:auto}.mdc-list-item__overline-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:24px;content:"";vertical-align:0}.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-three-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-three-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-three-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-avatar.mdc-list-item,.mdc-list-item--with-leading-avatar.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-avatar .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-avatar .mdc-list-item__start,.mdc-list-item--with-leading-avatar .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-avatar.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-avatar .mdc-list-item__start{border-radius:50%}.mdc-list-item--with-leading-icon.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-icon.mdc-list-item,.mdc-list-item--with-leading-icon.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-icon .mdc-list-item__start{margin-left:16px;margin-right:32px}[dir=rtl] .mdc-list-item--with-leading-icon .mdc-list-item__start,.mdc-list-item--with-leading-icon .mdc-list-item__start[dir=rtl]{margin-left:32px;margin-right:16px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-icon.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-thumbnail.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-thumbnail.mdc-list-item,.mdc-list-item--with-leading-thumbnail.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-thumbnail .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-thumbnail .mdc-list-item__start,.mdc-list-item--with-leading-thumbnail .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-image.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-image.mdc-list-item,.mdc-list-item--with-leading-image.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-image .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-image .mdc-list-item__start,.mdc-list-item--with-leading-image .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-image.mdc-list-item--with-one-line{height:72px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:8px}.mdc-list-item--with-leading-video.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-video.mdc-list-item,.mdc-list-item--with-leading-video.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-video .mdc-list-item__start{margin-left:0;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-video .mdc-list-item__start,.mdc-list-item--with-leading-video .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:0}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-video.mdc-list-item--with-one-line{height:72px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-checkbox.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-checkbox.mdc-list-item,.mdc-list-item--with-leading-checkbox.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-checkbox .mdc-list-item__start{margin-left:8px;margin-right:24px}[dir=rtl] .mdc-list-item--with-leading-checkbox .mdc-list-item__start,.mdc-list-item--with-leading-checkbox .mdc-list-item__start[dir=rtl]{margin-left:24px;margin-right:8px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:8px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-radio.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-radio.mdc-list-item,.mdc-list-item--with-leading-radio.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-radio .mdc-list-item__start{margin-left:8px;margin-right:24px}[dir=rtl] .mdc-list-item--with-leading-radio .mdc-list-item__start,.mdc-list-item--with-leading-radio .mdc-list-item__start[dir=rtl]{margin-left:24px;margin-right:8px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:8px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-switch.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-switch.mdc-list-item,.mdc-list-item--with-leading-switch.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-switch .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-switch .mdc-list-item__start,.mdc-list-item--with-leading-switch .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-switch.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-trailing-icon.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-icon.mdc-list-item,.mdc-list-item--with-trailing-icon.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-icon .mdc-list-item__end{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-trailing-icon .mdc-list-item__end,.mdc-list-item--with-trailing-icon .mdc-list-item__end[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end{align-self:flex-start;margin-top:0}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:0}.mdc-list-item--with-trailing-meta.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-meta.mdc-list-item,.mdc-list-item--with-trailing-meta.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-meta .mdc-list-item__end{margin-left:28px;margin-right:16px}[dir=rtl] .mdc-list-item--with-trailing-meta .mdc-list-item__end,.mdc-list-item--with-trailing-meta .mdc-list-item__end[dir=rtl]{margin-left:16px;margin-right:28px}.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-trailing-checkbox.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-checkbox.mdc-list-item,.mdc-list-item--with-trailing-checkbox.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-checkbox .mdc-list-item__end{margin-left:24px;margin-right:8px}[dir=rtl] .mdc-list-item--with-trailing-checkbox .mdc-list-item__end,.mdc-list-item--with-trailing-checkbox .mdc-list-item__end[dir=rtl]{margin-left:8px;margin-right:24px}.mdc-list-item--with-trailing-checkbox.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:8px}.mdc-list-item--with-trailing-radio.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-radio.mdc-list-item,.mdc-list-item--with-trailing-radio.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-radio .mdc-list-item__end{margin-left:24px;margin-right:8px}[dir=rtl] .mdc-list-item--with-trailing-radio .mdc-list-item__end,.mdc-list-item--with-trailing-radio .mdc-list-item__end[dir=rtl]{margin-left:8px;margin-right:24px}.mdc-list-item--with-trailing-radio.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:8px}.mdc-list-item--with-trailing-switch.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-switch.mdc-list-item,.mdc-list-item--with-trailing-switch.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-switch .mdc-list-item__end{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-trailing-switch .mdc-list-item__end,.mdc-list-item--with-trailing-switch .mdc-list-item__end[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-trailing-switch.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:16px}.mdc-list-item--with-overline.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-overline.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list-item--with-overline.mdc-list-item--with-three-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-overline.mdc-list-item--with-three-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list-item{padding-left:16px;padding-right:16px}[dir=rtl] .mdc-list-item,.mdc-list-item[dir=rtl]{padding-left:16px;padding-right:16px}.mdc-list-group .mdc-deprecated-list{padding:0}.mdc-list-group__subheader{margin:calc((3rem - 1.5rem)/2) 16px}.mdc-list-divider{padding:0;background-clip:content-box}.mdc-list-divider.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-text.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-icon.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-image.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-switch.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-radio.mdc-list-divider--with-leading-inset{padding-left:16px;padding-right:auto}[dir=rtl] .mdc-list-divider.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-text.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-icon.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-image.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-avatar.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-switch.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-radio.mdc-list-divider--with-leading-inset,.mdc-list-divider.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-text.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-icon.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-image.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-switch.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-radio.mdc-list-divider--with-leading-inset[dir=rtl]{padding-left:auto;padding-right:16px}.mdc-list-divider.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-text.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-icon.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-image.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-switch.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-radio.mdc-list-divider--with-trailing-inset{padding-left:auto;padding-right:16px}[dir=rtl] .mdc-list-divider.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-text.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-icon.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-image.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-avatar.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-switch.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-radio.mdc-list-divider--with-trailing-inset,.mdc-list-divider.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-text.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-icon.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-image.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-switch.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-radio.mdc-list-divider--with-trailing-inset[dir=rtl]{padding-left:16px;padding-right:auto}.mdc-list-divider--with-leading-video.mdc-list-divider--with-leading-inset{padding-left:0px;padding-right:auto}[dir=rtl] .mdc-list-divider--with-leading-video.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-video.mdc-list-divider--with-leading-inset[dir=rtl]{padding-left:auto;padding-right:0px}[dir=rtl] .mdc-list-divider,.mdc-list-divider[dir=rtl]{padding:0}.cdk-high-contrast-active a.mdc-list-item--activated::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active a.mdc-list-item--activated [dir=rtl]::after{right:auto;left:16px}.mat-mdc-list-base{display:block}.mat-mdc-list-base .mdc-list-item__start,.mat-mdc-list-base .mdc-list-item__end,.mat-mdc-list-base .mdc-list-item__content{pointer-events:auto}.mat-mdc-list-item,.mat-mdc-list-option{width:100%;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-list-item:not(.mat-mdc-list-item-interactive),.mat-mdc-list-option:not(.mat-mdc-list-item-interactive){cursor:default}.mat-mdc-list-item .mat-divider-inset,.mat-mdc-list-option .mat-divider-inset{position:absolute;left:0;right:0;bottom:0}.mat-mdc-list-item .mat-mdc-list-item-avatar~.mat-divider-inset,.mat-mdc-list-option .mat-mdc-list-item-avatar~.mat-divider-inset{margin-left:72px}[dir=rtl] .mat-mdc-list-item .mat-mdc-list-item-avatar~.mat-divider-inset,[dir=rtl] .mat-mdc-list-option .mat-mdc-list-item-avatar~.mat-divider-inset{margin-right:72px}.mat-mdc-list-item-interactive::before{top:0;left:0;right:0;bottom:0;position:absolute;content:"";opacity:0;pointer-events:none}.mat-mdc-list-item>.mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-list-item:focus>.mat-mdc-focus-indicator::before{content:""}.mat-mdc-list-item.mdc-list-item--with-three-lines .mat-mdc-list-item-line.mdc-list-item__secondary-text{white-space:nowrap;line-height:normal}.mat-mdc-list-item.mdc-list-item--with-three-lines .mat-mdc-list-item-unscoped-content.mdc-list-item__secondary-text{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}mat-action-list button{background:none;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:rgba(0,0,0,0);text-align:left}[dir=rtl] mat-action-list button{text-align:right}mat-action-list button::-moz-focus-inner{border:0}'],encapsulation:2,changeDetection:0}),i})(),XD=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[Vx,Ea,bn,X0,oV,Sve]}),i})();const rye=["*",[["mat-toolbar-row"]]],sye=["*","mat-toolbar-row"],oye=Hx(class{constructor(i){this._elementRef=i}});let aye=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=ke({type:i,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),i})(),lye=(()=>{class i extends oye{constructor(t,n,r){super(t),this._platform=n,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(Hn),R(ii))},i.\u0275cmp=$({type:i,selectors:[["mat-toolbar"]],contentQueries:function(t,n,r){if(1&t&&Fn(r,aye,5),2&t){let s;Pt(s=kt())&&(n._toolbarRows=s)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(t,n){2&t&&Mi("mat-toolbar-multiple-rows",n._toolbarRows.length>0)("mat-toolbar-single-row",0===n._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[W],ngContentSelectors:sye,decls:2,vars:0,template:function(t,n){1&t&&(Pn(rye),ti(0),ti(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color: inherit;--mdc-outlined-button-label-text-color: inherit}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}"],encapsulation:2,changeDetection:0}),i})(),YD=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[bn,bn]}),i})();const DC=["*"],cye=["content"];function dye(i,e){if(1&i){const t=Gs();ve(0,"div",2),mt("click",function(){return cr(t),dr(bi()._onBackdropClicked())}),Ie()}2&i&&Mi("mat-drawer-shown",bi()._isShowingBackdrop())}function uye(i,e){1&i&&(ve(0,"mat-drawer-content"),ti(1,2),Ie())}const hye=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],fye=["mat-drawer","mat-drawer-content","*"];function pye(i,e){if(1&i){const t=Gs();ve(0,"div",2),mt("click",function(){return cr(t),dr(bi()._onBackdropClicked())}),Ie()}2&i&&Mi("mat-drawer-shown",bi()._isShowingBackdrop())}function mye(i,e){1&i&&(ve(0,"mat-sidenav-content"),ti(1,2),Ie())}const gye=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],_ye=["mat-sidenav","mat-sidenav-content","*"],ZG={transformDrawer:$0("transform",[Cu("open, open-instant",Ds({transform:"none",visibility:"visible"})),Cu("void",Ds({"box-shadow":"none",visibility:"hidden"})),Ll("void => open-instant",Ec("0ms")),Ll("void <=> open, open-instant => void",Ec("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},vye=new Fe("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function yye(){return!1}}),ZD=new Fe("MAT_DRAWER_CONTAINER");let PC=(()=>{class i extends Mu{constructor(t,n,r,s,o){super(r,s,o),this._changeDetectorRef=t,this._container=n}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return i.\u0275fac=function(t){return new(t||i)(R(er),R(le(()=>$G)),R(Ht),R(wp),R(at))},i.\u0275cmp=$({type:i,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(t,n){2&t&&Hh("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[se([{provide:Mu,useExisting:i}]),W],ngContentSelectors:DC,decls:1,vars:0,template:function(t,n){1&t&&(Pn(),ti(0))},encapsulation:2,changeDetection:0}),i})(),KG=(()=>{class i{get position(){return this._position}set position(t){(t="end"===t?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(t),this._position=t,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(t){this._disableClose=zi(t)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(t){("true"===t||"false"===t||null==t)&&(t=zi(t)),this._autoFocus=t}get opened(){return this._opened}set opened(t){this.toggle(zi(t))}constructor(t,n,r,s,o,a,l,c){this._elementRef=t,this._focusTrapFactory=n,this._focusMonitor=r,this._platform=s,this._ngZone=o,this._interactivityChecker=a,this._doc=l,this._container=c,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new Wt,this._animationEnd=new Wt,this._animationState="void",this.openedChange=new Ct(!0),this._openedStream=this.openedChange.pipe(Bn(d=>d),vt(()=>{})),this.openedStart=this._animationStarted.pipe(Bn(d=>d.fromState!==d.toState&&0===d.toState.indexOf("open")),pS(void 0)),this._closedStream=this.openedChange.pipe(Bn(d=>!d),vt(()=>{})),this.closedStart=this._animationStarted.pipe(Bn(d=>d.fromState!==d.toState&&"void"===d.toState),pS(void 0)),this._destroyed=new Wt,this.onPositionChanged=new Ct,this._modeChanged=new Wt,this.openedChange.subscribe(d=>{d?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{Mc(this._elementRef.nativeElement,"keydown").pipe(Bn(d=>27===d.keyCode&&!this.disableClose&&!Ox(d)),_n(this._destroyed)).subscribe(d=>this._ngZone.run(()=>{this.close(),d.stopPropagation(),d.preventDefault()}))}),this._animationEnd.pipe(tR((d,u)=>d.fromState===u.fromState&&d.toState===u.toState)).subscribe(d=>{const{fromState:u,toState:h}=d;(0===h.indexOf("open")&&"void"===u||"void"===h&&0===u.indexOf("open"))&&this.openedChange.emit(this._opened)})}_forceFocus(t,n){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{t.removeEventListener("blur",r),t.removeEventListener("mousedown",r),t.removeAttribute("tabindex")};t.addEventListener("blur",r),t.addEventListener("mousedown",r)})),t.focus(n)}_focusByCssSelector(t,n){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,n)}_takeFocus(){if(!this._focusTrap)return;const t=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(n=>{!n&&"function"==typeof this._elementRef.nativeElement.focus&&t.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(t){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,t):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const t=this._doc.activeElement;return!!t&&this._elementRef.nativeElement.contains(t)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(t){return this.toggle(!0,t)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(t=!this.opened,n){t&&n&&(this._openedVia=n);const r=this._setOpen(t,!t&&this._isFocusWithinDrawer(),this._openedVia||"program");return t||(this._openedVia=null),r}_setOpen(t,n,r){return this._opened=t,t?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",n&&this._restoreFocus(r)),this._updateFocusTrapState(),new Promise(s=>{this.openedChange.pipe(ps(1)).subscribe(o=>s(o?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_updatePositionInParent(t){const n=this._elementRef.nativeElement,r=n.parentNode;"end"===t?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),r.insertBefore(this._anchor,n)),r.appendChild(n)):this._anchor&&this._anchor.parentNode.insertBefore(n,this._anchor)}}return i.\u0275fac=function(t){return new(t||i)(R(Ht),R(iue),R(nR),R(Hn),R(at),R(H5),R(ii,8),R(ZD,8))},i.\u0275cmp=$({type:i,selectors:[["mat-drawer"]],viewQuery:function(t,n){if(1&t&&Di(cye,5),2&t){let r;Pt(r=kt())&&(n._content=r.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(t,n){1&t&&K1("@transform.start",function(s){return n._animationStarted.next(s)})("@transform.done",function(s){return n._animationEnd.next(s)}),2&t&&(hn("align",null),nE("@transform",n._animationState),Mi("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:DC,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,n){1&t&&(Pn(),ve(0,"div",0,1),ti(2),Ie())},dependencies:[Mu],encapsulation:2,data:{animation:[ZG.transformDrawer]},changeDetection:0}),i})(),$G=(()=>{class i{get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(t){this._autosize=zi(t)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(t){this._backdropOverride=null==t?null:zi(t)}get scrollable(){return this._userContent||this._content}constructor(t,n,r,s,o,a=!1,l){this._dir=t,this._element=n,this._ngZone=r,this._changeDetectorRef=s,this._animationMode=l,this._drawers=new Sd,this.backdropClick=new Ct,this._destroyed=new Wt,this._doCheckSubject=new Wt,this._contentMargins={left:null,right:null},this._contentMarginChanges=new Wt,t&&t.change.pipe(_n(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),o.change().pipe(_n(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=a}ngAfterContentInit(){this._allDrawers.changes.pipe(ec(this._allDrawers),_n(this._destroyed)).subscribe(t=>{this._drawers.reset(t.filter(n=>!n._container||n._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(ec(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(t=>{this._watchDrawerToggle(t),this._watchDrawerPosition(t),this._watchDrawerMode(t)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(jx(10),_n(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(t=>t.open())}close(){this._drawers.forEach(t=>t.close())}updateContentMargins(){let t=0,n=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._getWidth();else if("push"==this._left.mode){const r=this._left._getWidth();t+=r,n-=r}if(this._right&&this._right.opened)if("side"==this._right.mode)n+=this._right._getWidth();else if("push"==this._right.mode){const r=this._right._getWidth();n+=r,t-=r}t=t||null,n=n||null,(t!==this._contentMargins.left||n!==this._contentMargins.right)&&(this._contentMargins={left:t,right:n},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(t){t._animationStarted.pipe(Bn(n=>n.fromState!==n.toState),_n(this._drawers.changes)).subscribe(n=>{"open-instant"!==n.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==t.mode&&t.openedChange.pipe(_n(this._drawers.changes)).subscribe(()=>this._setContainerClass(t.opened))}_watchDrawerPosition(t){t&&t.onPositionChanged.pipe(_n(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(ps(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(t){t&&t._modeChanged.pipe(_n(ud(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(t){const n=this._element.nativeElement.classList,r="mat-drawer-container-has-open";t?n.add(r):n.remove(r)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(t=>{"end"==t.position?this._end=t:this._start=t}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(t=>t&&!t.disableClose&&this._canHaveBackdrop(t)).forEach(t=>t._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(t){return"side"!==t.mode||!!this._backdropOverride}_isDrawerOpen(t){return null!=t&&t.opened}}return i.\u0275fac=function(t){return new(t||i)(R(za,8),R(Ht),R(at),R(er),R(Eu),R(vye),R(rs,8))},i.\u0275cmp=$({type:i,selectors:[["mat-drawer-container"]],contentQueries:function(t,n,r){if(1&t&&(Fn(r,PC,5),Fn(r,KG,5)),2&t){let s;Pt(s=kt())&&(n._content=s.first),Pt(s=kt())&&(n._allDrawers=s)}},viewQuery:function(t,n){if(1&t&&Di(PC,5),2&t){let r;Pt(r=kt())&&(n._userContent=r.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,n){2&t&&Mi("mat-drawer-container-explicit-backdrop",n._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[se([{provide:ZD,useExisting:i}])],ngContentSelectors:fye,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,n){1&t&&(Pn(hye),Vt(0,dye,1,2,"div",0),ti(1),ti(2,1),Vt(3,uye,2,0,"mat-drawer-content",1)),2&t&&(K("ngIf",n.hasBackdrop),oe(3),K("ngIf",!n._content))},dependencies:[Dd,PC],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),i})(),KD=(()=>{class i extends PC{constructor(t,n,r,s,o){super(t,n,r,s,o)}}return i.\u0275fac=function(t){return new(t||i)(R(er),R(le(()=>e8)),R(Ht),R(wp),R(at))},i.\u0275cmp=$({type:i,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(t,n){2&t&&Hh("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[se([{provide:Mu,useExisting:i}]),W],ngContentSelectors:DC,decls:1,vars:0,template:function(t,n){1&t&&(Pn(),ti(0))},encapsulation:2,changeDetection:0}),i})(),JG=(()=>{class i extends KG{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(t){this._fixedInViewport=zi(t)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(t){this._fixedTopGap=us(t)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(t){this._fixedBottomGap=us(t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=ce(i)))(n||i)}}(),i.\u0275cmp=$({type:i,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(t,n){2&t&&(hn("align",null),Hh("top",n.fixedInViewport?n.fixedTopGap:null,"px")("bottom",n.fixedInViewport?n.fixedBottomGap:null,"px"),Mi("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened)("mat-sidenav-fixed",n.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[W],ngContentSelectors:DC,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,n){1&t&&(Pn(),ve(0,"div",0,1),ti(2),Ie())},dependencies:[Mu],encapsulation:2,data:{animation:[ZG.transformDrawer]},changeDetection:0}),i})(),e8=(()=>{class i extends $G{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=ce(i)))(n||i)}}(),i.\u0275cmp=$({type:i,selectors:[["mat-sidenav-container"]],contentQueries:function(t,n,r){if(1&t&&(Fn(r,KD,5),Fn(r,JG,5)),2&t){let s;Pt(s=kt())&&(n._content=s.first),Pt(s=kt())&&(n._allDrawers=s)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(t,n){2&t&&Mi("mat-drawer-container-explicit-backdrop",n._backdropOverride)},exportAs:["matSidenavContainer"],features:[se([{provide:ZD,useExisting:i}]),W],ngContentSelectors:_ye,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,n){1&t&&(Pn(gye),Vt(0,pye,1,2,"div",0),ti(1),ti(2,1),Vt(3,mye,2,0,"mat-sidenav-content",1)),2&t&&(K("ngIf",n.hasBackdrop),oe(3),K("ngIf",!n._content))},dependencies:[Dd,KD],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),i})(),Aye=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[Ea,bn,tb,tb,bn]}),i})();function xye(i,e){if(1&i&&(ve(0,"a",10),qi(1),Ie()),2&i){const t=e.$implicit;K("routerLink",t.path),oe(1),$v(t.data.title)}}function wye(i,e){if(1&i){const t=Gs();ve(0,"button",11),mt("click",function(){return cr(t),bi(),dr(qt(2).toggle())}),ve(1,"mat-icon",12),qi(2,"menu"),Ie()()}}function Cye(i,e){if(1&i){const t=Gs();ve(0,"button",13),mt("click",function(r){return cr(t),dr(bi().editorService.toCodeSandbox(r))}),ve(1,"mat-icon"),qi(2,"crop_din"),Ie(),qi(3," CodeSandbox "),Ie()}}function Mye(i,e){if(1&i){const t=Gs();ve(0,"button",13),mt("click",function(r){return cr(t),dr(bi().editorService.toStackblitz(r))}),ve(1,"mat-icon"),qi(2,"bolt"),Ie(),qi(3," Stackblitz "),Ie()}}class Hb{constructor(e,t){this.breakpointObserver=e,this.editorService=t,this.routes=RC,this.isHandset$=this.breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)").pipe(vt(n=>n.matches),function Eve(i,e,t){let n,r=!1;return i&&"object"==typeof i?({bufferSize:n=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=i):n=i??1/0,dM({connector:()=>new BI(n,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}())}}Hb.\u0275fac=function(e){return new(e||Hb)(R(N5),R(Bx))},Hb.\u0275cmp=$({type:Hb,selectors:[["app-navigation-shell"]],decls:21,vars:15,consts:[[1,"sidenav-container"],["fixedInViewport","",1,"sidenav",3,"mode","opened"],["drawer",""],["mat-list-item","",3,"routerLink",4,"ngFor","ngForOf"],[1,"content"],["color","primary"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click",4,"ngIf"],[1,"toolbar-spacer"],["mat-button","","href","#",3,"click",4,"ngIf"],[1,"main-route-content"],["mat-list-item","",3,"routerLink"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click"],["aria-label","Side nav toggle icon"],["mat-button","","href","#",3,"click"]],template:function(e,t){1&e&&(ve(0,"mat-sidenav-container",0)(1,"mat-sidenav",1,2),fr(3,"async"),fr(4,"async"),fr(5,"async"),ve(6,"mat-toolbar"),qi(7,"ngx-three"),Ie(),ve(8,"mat-nav-list"),Vt(9,xye,2,2,"a",3),Ie()(),ve(10,"mat-sidenav-content",4)(11,"mat-toolbar",5),Vt(12,wye,3,0,"button",6),fr(13,"async"),ve(14,"span"),qi(15,"ngx-three-demo"),Ie(),ze(16,"span",7),Vt(17,Cye,4,0,"button",8),Vt(18,Mye,4,0,"button",8),Ie(),ve(19,"div",9),ze(20,"router-outlet"),Ie()()()),2&e&&(oe(1),K("mode",Er(4,9,t.isHandset$)?"over":"side")("opened",!1===Er(5,11,t.isHandset$)),hn("role",Er(3,7,t.isHandset$)?"dialog":"navigation"),oe(8),K("ngForOf",t.routes),oe(3),K("ngIf",Er(13,13,t.isHandset$)),oe(5),K("ngIf",t.editorService.urls.length),oe(1),K("ngIf",t.editorService.urls.length))},dependencies:[$l,Dd,TS,iA,cV,Due,eye,$ve,DV,lye,JG,e8,KD,$E],styles:[".sidenav-container[_ngcontent-%COMP%]{height:100%}.sidenav[_ngcontent-%COMP%]{width:200px}.sidenav[_ngcontent-%COMP%]   .mat-toolbar[_ngcontent-%COMP%]{background:inherit}.mat-toolbar.mat-primary[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1}.content[_ngcontent-%COMP%]{height:100vh}.main-route-content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:last-child{display:block;height:100%}.toolbar-spacer[_ngcontent-%COMP%]{flex:1 1 auto}"],changeDetection:0});class Gb{constructor(){this.title="ngx-three-demo"}}Gb.\u0275fac=function(e){return new(e||Gb)},Gb.\u0275cmp=$({type:Gb,selectors:[["app-root"]],decls:1,vars:0,template:function(e,t){1&e&&ze(0,"app-navigation-shell")},dependencies:[Hb]});const t8=P5();class Eye{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=rr(-this._previousScrollPosition.left),e.style.top=rr(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,n=e.style,r=this._document.body.style,s=n.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,n.left=this._previousHTMLStyles.left,n.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),t8&&(n.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),t8&&(n.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,n=this._viewportRuler.getViewportSize();return t.scrollHeight>n.height||t.scrollWidth>n.width}}class Sye{constructor(e,t,n,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=n,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class n8{enable(){}disable(){}attach(){}}function $D(i,e){return e.some(t=>i.bottom<t.top||i.top>t.bottom||i.right<t.left||i.left>t.right)}function r8(i,e){return e.some(t=>i.top<t.top||i.bottom>t.bottom||i.left<t.left||i.right>t.right)}class Tye{constructor(e,t,n,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=n,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:n,height:r}=this._viewportRuler.getViewportSize();$D(t,[{width:n,height:r,bottom:r,right:n,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let Iye=(()=>{class i{constructor(t,n,r,s){this._scrollDispatcher=t,this._viewportRuler=n,this._ngZone=r,this.noop=()=>new n8,this.close=o=>new Sye(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new Eye(this._viewportRuler,this._document),this.reposition=o=>new Tye(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}}return i.\u0275fac=function(t){return new(t||i)(ye(wp),ye(Eu),ye(at),ye(ii))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class Rye{constructor(e){if(this.scrollStrategy=new n8,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const n of t)void 0!==e[n]&&(this[n]=e[n])}}}class Dye{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let s8=(()=>{class i{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const n=this._attachedOverlays.indexOf(t);n>-1&&this._attachedOverlays.splice(n,1),0===this._attachedOverlays.length&&this.detach()}}return i.\u0275fac=function(t){return new(t||i)(ye(ii))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Pye=(()=>{class i extends s8{constructor(t,n){super(t),this._ngZone=n,this._keydownListener=r=>{const s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){const a=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>a.next(r)):a.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return i.\u0275fac=function(t){return new(t||i)(ye(ii),ye(at,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),kye=(()=>{class i extends s8{constructor(t,n,r){super(t),this._platform=n,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=Cc(s)},this._clickListener=s=>{const o=Cc(s),a="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;const l=this._attachedOverlays.slice();for(let c=l.length-1;c>-1;c--){const d=l[c];if(d._outsidePointerEvents.observers.length<1||!d.hasAttached())continue;if(d.overlayElement.contains(o)||d.overlayElement.contains(a))break;const u=d._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>u.next(s)):u.next(s)}}}add(t){if(super.add(t),!this._isAttached){const n=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(n)):this._addEventListeners(n),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=n.style.cursor,n.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}}return i.\u0275fac=function(t){return new(t||i)(ye(ii),ye(Hn),ye(at,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),o8=(()=>{class i{constructor(t,n){this._platform=n,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||ZI()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const n=this._document.createElement("div");n.classList.add(t),ZI()?n.setAttribute("platform","test"):this._platform.isBrowser||n.setAttribute("platform","server"),this._document.body.appendChild(n),this._containerElement=n}}return i.\u0275fac=function(t){return new(t||i)(ye(ii),ye(Hn))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class Fye{constructor(e,t,n,r,s,o,a,l,c,d=!1){this._portalOutlet=e,this._host=t,this._pane=n,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=l,this._outsideClickDispatcher=c,this._animationsDisabled=d,this._backdropElement=null,this._backdropClick=new Wt,this._attachments=new Wt,this._detachments=new Wt,this._locationChanges=cn.EMPTY,this._backdropClickHandler=u=>this._backdropClick.next(u),this._backdropTransitionendHandler=u=>{this._disposeBackdrop(u.target)},this._keydownEvents=new Wt,this._outsidePointerEvents=new Wt,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(ps(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=rr(this._config.width),e.height=rr(this._config.height),e.minWidth=rr(this._config.minWidth),e.minHeight=rr(this._config.minHeight),e.maxWidth=rr(this._config.maxWidth),e.maxHeight=rr(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,n){const r=Ux(t||[]).filter(s=>!!s);r.length&&(n?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(_n(ud(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const a8="cdk-overlay-connected-position-bounding-box",Bye=/([A-Za-z%]+)$/;class Lye{get positions(){return this._preferredPositions}constructor(e,t,n,r,s){this._viewportRuler=t,this._document=n,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Wt,this._resizeSubscription=cn.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._validatePositions(),e.hostElement.classList.add(a8),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,n=this._viewportRect,r=this._containerRect,s=[];let o;for(let a of this._preferredPositions){let l=this._getOriginPoint(e,r,a),c=this._getOverlayPoint(l,t,a),d=this._getOverlayFit(c,t,n,a);if(d.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(a,l);this._canFitWithFlexibleDimensions(d,c,n)?s.push({position:a,origin:l,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(l,a)}):(!o||o.overlayFit.visibleArea<d.visibleArea)&&(o={overlayFit:d,overlayPoint:c,originPoint:l,position:a,overlayRect:t})}if(s.length){let a=null,l=-1;for(const c of s){const d=c.boundingBoxRect.width*c.boundingBoxRect.height*(c.position.weight||1);d>l&&(l=d,a=c)}return this._isPushed=!1,void this._applyPosition(a.position,a.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&rh(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(a8),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,n){let r,s;if("center"==n.originX)r=e.left+e.width/2;else{const o=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;r="start"==n.originX?o:a}return t.left<0&&(r-=t.left),s="center"==n.originY?e.top+e.height/2:"top"==n.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,n){let r,s;return r="center"==n.overlayX?-t.width/2:"start"===n.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==n.overlayY?-t.height/2:"top"==n.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,n,r){const s=c8(t);let{x:o,y:a}=e,l=this._getOffset(r,"x"),c=this._getOffset(r,"y");l&&(o+=l),c&&(a+=c);let h=0-a,f=a+s.height-n.height,m=this._subtractOverflows(s.width,0-o,o+s.width-n.width),p=this._subtractOverflows(s.height,h,f),g=m*p;return{visibleArea:g,isCompletelyWithinViewport:s.width*s.height===g,fitsInViewportVertically:p===s.height,fitsInViewportHorizontally:m==s.width}}_canFitWithFlexibleDimensions(e,t,n){if(this._hasFlexibleDimensions){const r=n.bottom-t.y,s=n.right-t.x,o=l8(this._overlayRef.getConfig().minHeight),a=l8(this._overlayRef.getConfig().minWidth);return(e.fitsInViewportVertically||null!=o&&o<=r)&&(e.fitsInViewportHorizontally||null!=a&&a<=s)}return!1}_pushOverlayOnScreen(e,t,n){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=c8(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),a=Math.max(e.y+r.height-s.height,0),l=Math.max(s.top-n.top-e.y,0),c=Math.max(s.left-n.left-e.x,0);let d=0,u=0;return d=r.width<=s.width?c||-o:e.x<this._viewportMargin?s.left-n.left-e.x:0,u=r.height<=s.height?l||-a:e.y<this._viewportMargin?s.top-n.top-e.y:0,this._previousPushAmount={x:d,y:u},{x:e.x+d,y:e.y+u}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const n=this._getScrollVisibility(),r=new Dye(e,n);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let n,r=e.overlayY;n="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${n} ${r}`}_calculateBoundingBoxRect(e,t){const n=this._viewportRect,r=this._isRtl();let s,o,a,d,u,h;if("top"===t.overlayY)o=e.y,s=n.height-o+this._viewportMargin;else if("bottom"===t.overlayY)a=n.height-e.y+2*this._viewportMargin,s=n.height-a+this._viewportMargin;else{const f=Math.min(n.bottom-e.y+n.top,e.y),m=this._lastBoundingBoxSize.height;s=2*f,o=e.y-f,s>m&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-m/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)h=n.width-e.x+this._viewportMargin,d=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)u=e.x,d=n.right-e.x;else{const f=Math.min(n.right-e.x+n.left,e.x),m=this._lastBoundingBoxSize.width;d=2*f,u=e.x-f,d>m&&!this._isInitialRender&&!this._growAfterOpen&&(u=e.x-m/2)}return{top:o,left:u,bottom:a,right:h,width:d,height:s}}_setBoundingBoxStyles(e,t){const n=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=rr(n.height),r.top=rr(n.top),r.bottom=rr(n.bottom),r.width=rr(n.width),r.left=rr(n.left),r.right=rr(n.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=rr(s)),o&&(r.maxWidth=rr(o))}this._lastBoundingBoxSize=n,rh(this._boundingBox.style,r)}_resetBoundingBoxStyles(){rh(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){rh(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const n={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const d=this._viewportRuler.getViewportScrollPosition();rh(n,this._getExactOverlayY(t,e,d)),rh(n,this._getExactOverlayX(t,e,d))}else n.position="static";let a="",l=this._getOffset(t,"x"),c=this._getOffset(t,"y");l&&(a+=`translateX(${l}px) `),c&&(a+=`translateY(${c}px)`),n.transform=a.trim(),o.maxHeight&&(r?n.maxHeight=rr(o.maxHeight):s&&(n.maxHeight="")),o.maxWidth&&(r?n.maxWidth=rr(o.maxWidth):s&&(n.maxWidth="")),rh(this._pane.style,n)}_getExactOverlayY(e,t,n){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,n)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=rr(s.y),r}_getExactOverlayX(e,t,n){let o,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,n)),o=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===o?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=rr(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),n=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:r8(e,n),isOriginOutsideView:$D(e,n),isOverlayClipped:r8(t,n),isOverlayOutsideView:$D(t,n)}}_subtractOverflows(e,...t){return t.reduce((n,r)=>n-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+e-this._viewportMargin,bottom:n.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&Ux(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof Ht)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,n=e.height||0;return{top:e.y,bottom:e.y+n,left:e.x,right:e.x+t,height:n,width:t}}}function rh(i,e){for(let t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}function l8(i){if("number"!=typeof i&&null!=i){const[e,t]=i.split(Bye);return t&&"px"!==t?null:parseFloat(e)}return i||null}function c8(i){return{top:Math.floor(i.top),right:Math.floor(i.right),bottom:Math.floor(i.bottom),left:Math.floor(i.left),width:Math.floor(i.width),height:Math.floor(i.height)}}const d8="cdk-global-overlay-wrapper";class Oye{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(d8),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:a}=n,l=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),c=!("100%"!==s&&"100vh"!==s||a&&"100%"!==a&&"100vh"!==a),d=this._xPosition,u=this._xOffset,h="rtl"===this._overlayRef.getConfig().direction;let f="",m="",p="";l?p="flex-start":"center"===d?(p="center",h?m=u:f=u):h?"left"===d||"end"===d?(p="flex-end",f=u):("right"===d||"start"===d)&&(p="flex-start",m=u):"left"===d||"start"===d?(p="flex-start",f=u):("right"===d||"end"===d)&&(p="flex-end",m=u),e.position=this._cssPosition,e.marginLeft=l?"0":f,e.marginTop=c?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=l?"0":m,t.justifyContent=p,t.alignItems=c?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,n=t.style;t.classList.remove(d8),n.justifyContent=n.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let Nye=(()=>{class i{constructor(t,n,r,s){this._viewportRuler=t,this._document=n,this._platform=r,this._overlayContainer=s}global(){return new Oye}flexibleConnectedTo(t){return new Lye(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return i.\u0275fac=function(t){return new(t||i)(ye(Eu),ye(ii),ye(Hn),ye(o8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),jye=0,JD=(()=>{class i{constructor(t,n,r,s,o,a,l,c,d,u,h,f){this.scrollStrategies=t,this._overlayContainer=n,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=a,this._ngZone=l,this._document=c,this._directionality=d,this._location=u,this._outsideClickDispatcher=h,this._animationsModuleType=f}create(t){const n=this._createHostElement(),r=this._createPaneElement(n),s=this._createPortalOutlet(r),o=new Rye(t);return o.direction=o.direction||this._directionality.value,new Fye(s,n,r,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const n=this._document.createElement("div");return n.id="cdk-overlay-"+jye++,n.classList.add("cdk-overlay-pane"),t.appendChild(n),n}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(Yh)),new Rhe(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return i.\u0275fac=function(t){return new(t||i)(ye(Iye),ye(o8),ye(Yl),ye(Nye),ye(Pye),ye(_s),ye(at),ye(ii),ye(za),ye(my),ye(kye),ye(rs,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const zye={provide:new Fe("cdk-connected-overlay-scroll-strategy"),deps:[JD],useFactory:function Vye(i){return()=>i.scrollStrategies.reposition()}};let Hye=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({providers:[JD,zye],imports:[Q0,OV,WV,WV]}),i})(),Zye=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[bn,Ea,Vx,bn]}),i})();const tAe={provide:new Fe("mat-select-scroll-strategy"),deps:[JD],useFactory:function eAe(i){return()=>i.scrollStrategies.reposition()}};let u8=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({providers:[tAe],imports:[Ea,Hye,aV,bn,tb,Zye,aV,bn]}),i})(),p8=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({imports:[bn,Ea,X0]}),i})();const dAe=[oR,XD,hR,BV,YD,u8,nz,p8];class vg{}function m8(i){return new Me(3e3,!1)}function QAe(){return typeof window<"u"&&typeof window.document<"u"}function e2(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function od(i){switch(i.length){case 0:return new J0;case 1:return i[0];default:return new HV(i)}}function g8(i,e,t,n,r=new Map,s=new Map){const o=[],a=[];let l=-1,c=null;if(n.forEach(d=>{const u=d.get("offset"),h=u==l,f=h&&c||new Map;d.forEach((m,p)=>{let g=p,_=m;if("offset"!==p)switch(g=e.normalizePropertyName(g,o),_){case"!":_=r.get(p);break;case Bl:_=s.get(p);break;default:_=e.normalizeStyleValue(p,g,_,o)}f.set(g,_)}),h||a.push(f),c=f,l=u}),o.length)throw function kAe(i){return new Me(3502,!1)}();return a}function t2(i,e,t,n){switch(e){case"start":i.onStart(()=>n(t&&n2(t,"start",i)));break;case"done":i.onDone(()=>n(t&&n2(t,"done",i)));break;case"destroy":i.onDestroy(()=>n(t&&n2(t,"destroy",i)))}}function n2(i,e,t){const s=r2(i.element,i.triggerName,i.fromState,i.toState,e||i.phaseName,t.totalTime??i.totalTime,!!t.disabled),o=i._data;return null!=o&&(s._data=o),s}function r2(i,e,t,n,r="",s=0,o){return{element:i,triggerName:e,fromState:t,toState:n,phaseName:r,totalTime:s,disabled:!!o}}function lo(i,e,t){let n=i.get(e);return n||i.set(e,n=t),n}function _8(i){const e=i.indexOf(":");return[i.substring(1,e),i.slice(e+1)]}vg.\u0275fac=function(e){return new(e||vg)},vg.\u0275mod=ci({type:vg}),vg.\u0275inj=oi({imports:[dAe,oR,XD,hR,BV,YD,u8,nz,p8]});let s2=(i,e)=>!1,b8=(i,e,t)=>[],v8=null;function o2(i){const e=i.parentNode||i.host;return e===v8?null:e}(e2()||typeof Element<"u")&&(QAe()?(v8=(()=>document.documentElement)(),s2=(i,e)=>{for(;e;){if(e===i)return!0;e=o2(e)}return!1}):s2=(i,e)=>i.contains(e),b8=(i,e,t)=>{if(t)return Array.from(i.querySelectorAll(e));const n=i.querySelector(e);return n?[n]:[]});let sh=null,y8=!1;const A8=s2,x8=b8;let w8=(()=>{class i{validateStyleProperty(t){return function qAe(i){sh||(sh=function XAe(){return typeof document<"u"?document.body:null}()||{},y8=!!sh.style&&"WebkitAppearance"in sh.style);let e=!0;return sh.style&&!function WAe(i){return"ebkit"==i.substring(1,6)}(i)&&(e=i in sh.style,!e&&y8&&(e="Webkit"+i.charAt(0).toUpperCase()+i.slice(1)in sh.style)),e}(t)}matchesElement(t,n){return!1}containsElement(t,n){return A8(t,n)}getParentElement(t){return o2(t)}query(t,n,r){return x8(t,n,r)}computeStyle(t,n,r){return r||""}animate(t,n,r,s,o,a=[],l){return new J0(r,s)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})(),a2=(()=>{class i{}return i.NOOP=new w8,i})();const l2="ng-enter",kC="ng-leave",FC="ng-trigger",BC=".ng-trigger",M8="ng-animating",c2=".ng-animating";function zl(i){if("number"==typeof i)return i;const e=i.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:d2(parseFloat(e[1]),e[2])}function d2(i,e){return"s"===e?1e3*i:i}function LC(i,e,t){return i.hasOwnProperty("duration")?i:function KAe(i,e,t){let r,s=0,o="";if("string"==typeof i){const a=i.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(m8()),{duration:0,delay:0,easing:""};r=d2(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=d2(parseFloat(l),a[4]));const c=a[5];c&&(o=c)}else r=i;if(!t){let a=!1,l=e.length;r<0&&(e.push(function uAe(){return new Me(3100,!1)}()),a=!0),s<0&&(e.push(function hAe(){return new Me(3101,!1)}()),a=!0),a&&e.splice(l,0,m8())}return{duration:r,delay:s,easing:o}}(i,e,t)}function Qb(i,e={}){return Object.keys(i).forEach(t=>{e[t]=i[t]}),e}function E8(i){const e=new Map;return Object.keys(i).forEach(t=>{e.set(t,i[t])}),e}function ad(i,e=new Map,t){if(t)for(let[n,r]of t)e.set(n,r);for(let[n,r]of i)e.set(n,r);return e}function T8(i,e,t){return t?e+":"+t+";":""}function I8(i){let e="";for(let t=0;t<i.style.length;t++){const n=i.style.item(t);e+=T8(0,n,i.style.getPropertyValue(n))}for(const t in i.style)i.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=T8(0,txe(t),i.style[t]));i.setAttribute("style",e)}function $a(i,e,t){i.style&&(e.forEach((n,r)=>{const s=h2(r);t&&!t.has(r)&&t.set(r,i.style[s]),i.style[s]=n}),e2()&&I8(i))}function oh(i,e){i.style&&(e.forEach((t,n)=>{const r=h2(n);i.style[r]=""}),e2()&&I8(i))}function Wb(i){return Array.isArray(i)?1==i.length?i[0]:VV(i):i}const u2=new RegExp("{{\\s*(.+?)\\s*}}","g");function R8(i){let e=[];if("string"==typeof i){let t;for(;t=u2.exec(i);)e.push(t[1]);u2.lastIndex=0}return e}function qb(i,e,t){const n=i.toString(),r=n.replace(u2,(s,o)=>{let a=e[o];return null==a&&(t.push(function pAe(i){return new Me(3003,!1)}()),a=""),a.toString()});return r==n?i:r}function OC(i){const e=[];let t=i.next();for(;!t.done;)e.push(t.value),t=i.next();return e}const exe=/-+([a-z0-9])/g;function h2(i){return i.replace(exe,(...e)=>e[1].toUpperCase())}function txe(i){return i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function co(i,e,t){switch(e.type){case 7:return i.visitTrigger(e,t);case 0:return i.visitState(e,t);case 1:return i.visitTransition(e,t);case 2:return i.visitSequence(e,t);case 3:return i.visitGroup(e,t);case 4:return i.visitAnimate(e,t);case 5:return i.visitKeyframes(e,t);case 6:return i.visitStyle(e,t);case 8:return i.visitReference(e,t);case 9:return i.visitAnimateChild(e,t);case 10:return i.visitAnimateRef(e,t);case 11:return i.visitQuery(e,t);case 12:return i.visitStagger(e,t);default:throw function mAe(i){return new Me(3004,!1)}()}}function D8(i,e){return window.getComputedStyle(i)[e]}function axe(i,e){const t=[];return"string"==typeof i?i.split(/\s*,\s*/).forEach(n=>function lxe(i,e,t){if(":"==i[0]){const l=function cxe(i,e){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function IAe(i){return new Me(3016,!1)}()),"* => *"}}(i,t);if("function"==typeof l)return void e.push(l);i=l}const n=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function TAe(i){return new Me(3015,!1)}()),e;const r=n[1],s=n[2],o=n[3];e.push(P8(r,o));"<"==s[0]&&!("*"==r&&"*"==o)&&e.push(P8(o,r))}(n,t,e)):t.push(i),t}const VC=new Set(["true","1"]),zC=new Set(["false","0"]);function P8(i,e){const t=VC.has(i)||zC.has(i),n=VC.has(e)||zC.has(e);return(r,s)=>{let o="*"==i||i==r,a="*"==e||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?VC.has(i):zC.has(i)),!a&&n&&"boolean"==typeof s&&(a=s?VC.has(e):zC.has(e)),o&&a}}const dxe=new RegExp("s*:selfs*,?","g");function f2(i,e,t,n){return new uxe(i).build(e,t,n)}class uxe{constructor(e){this._driver=e}build(e,t,n){const r=new pxe(t);return this._resetContextStyleTimingState(r),co(this,Wb(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function _Ae(){return new Me(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(d=>{l.name=d,s.push(this.visitState(l,t))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,t);n+=l.queryCount,r+=l.depCount,o.push(l)}else t.errors.push(function bAe(){return new Me(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:n,depCount:r,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){const s=new Set,o=r||{};n.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{R8(l).forEach(c=>{o.hasOwnProperty(c)||s.add(c)})})}),s.size&&(OC(s.values()),t.errors.push(function vAe(i,e){return new Me(3008,!1)}()))}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=co(this,Wb(e.animation),t);return{type:1,matchers:axe(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:ah(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>co(this,n,t)),options:ah(e.options)}}visitGroup(e,t){const n=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=n;const a=co(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:3,steps:s,options:ah(e.options)}}visitAnimate(e,t){const n=function gxe(i,e){if(i.hasOwnProperty("duration"))return i;if("number"==typeof i)return p2(LC(i,e).duration,0,"");const t=i;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=p2(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=LC(t,e);return p2(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let r,s=e.styles?e.styles:Ds({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const c={};n.easing&&(c.easing=n.easing),o=Ds(c)}t.currentTime+=n.duration+n.delay;const l=this.visitStyle(o,t);l.isEmptyStep=a,r=l}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of r)"string"==typeof a?a===Bl?n.push(a):t.errors.push(new Me(3002,!1)):n.push(E8(a));let s=!1,o=null;return n.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let l of a.values())if(l.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:n,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;n&&s>0&&(s-=n.duration+n.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,l)=>{const c=t.collectedStyles.get(t.currentQuerySelector),d=c.get(l);let u=!0;d&&(s!=r&&s>=d.startTime&&r<=d.endTime&&(t.errors.push(function AAe(i,e,t,n,r){return new Me(3010,!1)}()),u=!1),s=d.startTime),u&&c.set(l,{startTime:s,endTime:r}),t.options&&function JAe(i,e,t){const n=e.params||{},r=R8(i);r.length&&r.forEach(s=>{n.hasOwnProperty(s)||t.push(function fAe(i){return new Me(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function xAe(){return new Me(3011,!1)}()),n;let s=0;const o=[];let a=!1,l=!1,c=0;const d=e.steps.map(_=>{const v=this._makeStyleAst(_,t);let b=null!=v.offset?v.offset:function mxe(i){if("string"==typeof i)return null;let e=null;if(Array.isArray(i))i.forEach(t=>{if(t instanceof Map&&t.has("offset")){const n=t;e=parseFloat(n.get("offset")),n.delete("offset")}});else if(i instanceof Map&&i.has("offset")){const t=i;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(v.styles),y=0;return null!=b&&(s++,y=v.offset=b),l=l||y<0||y>1,a=a||y<c,c=y,o.push(y),v});l&&t.errors.push(function wAe(){return new Me(3012,!1)}()),a&&t.errors.push(function CAe(){return new Me(3200,!1)}());const u=e.steps.length;let h=0;s>0&&s<u?t.errors.push(function MAe(){return new Me(3202,!1)}()):0==s&&(h=1/(u-1));const f=u-1,m=t.currentTime,p=t.currentAnimateTimings,g=p.duration;return d.forEach((_,v)=>{const b=h>0?v==f?1:h*v:o[v],y=b*g;t.currentTime=m+p.delay+y,p.duration=y,this._validateStyleAst(_,t),_.offset=b,n.styles.push(_)}),n}visitReference(e,t){return{type:8,animation:co(this,Wb(e.animation),t),options:ah(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:ah(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:ah(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function hxe(i){const e=!!i.split(/\s*,\s*/).find(t=>":self"==t);return e&&(i=i.replace(dxe,"")),i=i.replace(/@\*/g,BC).replace(/@\w+/g,t=>BC+"-"+t.slice(1)).replace(/:animating/g,c2),[i,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+s:s,lo(t.collectedStyles,t.currentQuerySelector,new Map);const a=co(this,Wb(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:ah(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function EAe(){return new Me(3013,!1)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:LC(e.timings,t.errors,!0);return{type:12,animation:co(this,Wb(e.animation),t),timings:n,options:null}}}class pxe{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function ah(i){return i?(i=Qb(i)).params&&(i.params=function fxe(i){return i?Qb(i):null}(i.params)):i={},i}function p2(i,e,t){return{duration:i,delay:e,easing:t}}function m2(i,e,t,n,r,s,o=null,a=!1){return{type:1,element:i,keyframes:e,preStyleProps:t,postStyleProps:n,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class HC{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const vxe=new RegExp(":enter","g"),Axe=new RegExp(":leave","g");function g2(i,e,t,n,r,s=new Map,o=new Map,a,l,c=[]){return(new xxe).buildKeyframes(i,e,t,n,r,s,o,a,l,c)}class xxe{buildKeyframes(e,t,n,r,s,o,a,l,c,d=[]){c=c||new HC;const u=new _2(e,t,c,r,s,d,[]);u.options=l;const h=l.delay?zl(l.delay):0;u.currentTimeline.delayNextStep(h),u.currentTimeline.setStyles([o],null,u.errors,l),co(this,n,u);const f=u.timelines.filter(m=>m.containsAnimation());if(f.length&&a.size){let m;for(let p=f.length-1;p>=0;p--){const g=f[p];if(g.element===t){m=g;break}}m&&!m.allowOnlyTimelineStyles()&&m.setStyles([a],null,u.errors,l)}return f.length?f.map(m=>m.buildKeyframes()):[m2(t,[],[],[],0,h,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(n,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,n),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,n){for(const r of e){const s=r?.delay;if(s){const o="number"==typeof s?s:zl(qb(s,r?.params??{},t.errors));n.delayNextStep(o)}}}_visitSubInstructions(e,t,n){let s=t.currentTimeline.currentTime;const o=null!=n.duration?zl(n.duration):null,a=null!=n.delay?zl(n.delay):null;return 0!==o&&e.forEach(l=>{const c=t.appendInstructionToTimeline(l,o,a);s=Math.max(s,c.duration+c.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),co(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=GC);const o=zl(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>co(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?zl(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),co(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return LC(t.params?qb(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(n.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.hasCurrentStyleProperties()&&n.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(s):n.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,r=t.currentTimeline.duration,s=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?zl(r.delay):0;s&&(6===t.previousNode.type||0==n&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=GC);let o=n;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((c,d)=>{t.currentQueryIndex=d;const u=t.createSubContext(e.options,c);s&&u.delayNextStep(s),c===t.element&&(l=u.currentTimeline),co(this,e.animation,u),u.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,u.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let l=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=n.currentStaggerTime}const d=t.currentTimeline;l&&d.delayNextStep(l);const u=d.currentTime;co(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-u+(r.startTime-n.currentTimeline.startTime)}}const GC={};class _2{constructor(e,t,n,r,s,o,a,l){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=GC,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new QC(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let r=this.options;null!=n.duration&&(r.duration=zl(n.duration)),null!=n.delay&&(r.delay=zl(n.delay));const s=n.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=qb(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(r=>{n[r]=t[r]})}}return e}createSubContext(e=null,t,n){const r=t||this.element,s=new _2(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=GC,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},s=new wxe(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(vxe,"."+this._enterClassName)).replace(Axe,"."+this._leaveClassName);let c=this._driver.query(this.element,e,1!=n);0!==n&&(c=n<0?c.slice(c.length+n,c.length):c.slice(0,n)),a.push(...c)}return!s&&0==a.length&&o.push(function SAe(i){return new Me(3014,!1)}()),a}}class QC{constructor(e,t,n,r){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new QC(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,n]of this._globalTimelineStyles)this._backFill.set(t,n||Bl),this._currentKeyframe.set(t,Bl);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function Cxe(i,e){const t=new Map;let n;return i.forEach(r=>{if("*"===r){n=n||e.keys();for(let s of n)t.set(s,Bl)}else ad(r,t)}),t}(e,this._globalTimelineStyles);for(let[a,l]of o){const c=qb(l,s,n);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??Bl),this._updateStyle(a,c)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,n)=>{const r=this._styleSummary.get(n);(!r||t.time>r.time)&&this._updateStyle(n,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const c=ad(a,new Map,this._backFill);c.forEach((d,u)=>{"!"===d?e.add(u):d===Bl&&t.add(u)}),n||c.set("offset",l/this.duration),r.push(c)});const s=e.size?OC(e.values()):[],o=t.size?OC(t.values()):[];if(n){const a=r[0],l=new Map(a);a.set("offset",0),l.set("offset",1),r=[a,l]}return m2(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class wxe extends QC{constructor(e,t,n,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=n,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=n+t,a=t/o,l=ad(e[0]);l.set("offset",0),s.push(l);const c=ad(e[0]);c.set("offset",B8(a)),s.push(c);const d=e.length-1;for(let u=1;u<=d;u++){let h=ad(e[u]);const f=h.get("offset");h.set("offset",B8((t+f*n)/o)),s.push(h)}n=o,t=0,r="",e=s}return m2(this.element,e,this.preStyleProps,this.postStyleProps,n,t,r,!0)}}function B8(i,e=3){const t=Math.pow(10,e-1);return Math.round(i*t)/t}class b2{}const Mxe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Exe extends b2{normalizePropertyName(e,t){return h2(e)}normalizeStyleValue(e,t,n,r){let s="";const o=n.toString().trim();if(Mxe.has(t)&&0!==n&&"0"!==n)if("number"==typeof n)s="px";else{const a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function gAe(i,e){return new Me(3005,!1)}())}return o+s}}function L8(i,e,t,n,r,s,o,a,l,c,d,u,h){return{type:0,element:i,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:n,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:d,totalTime:u,errors:h}}const v2={};class O8{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,r){return function Sxe(i,e,t,n,r){return i.some(s=>s(e,t,n,r))}(this.ast.matchers,e,t,n,r)}buildStyles(e,t,n){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,n):new Map}build(e,t,n,r,s,o,a,l,c,d){const u=[],h=this.ast.options&&this.ast.options.params||v2,m=this.buildStyles(n,a&&a.params||v2,u),p=l&&l.params||v2,g=this.buildStyles(r,p,u),_=new Set,v=new Map,b=new Map,y="void"===r,x={params:Txe(p,h),delay:this.ast.options?.delay},C=d?[]:g2(e,t,this.ast.animation,s,o,m,g,x,c,u);let M=0;if(C.forEach(E=>{M=Math.max(E.duration+E.delay,M)}),u.length)return L8(t,this._triggerName,n,r,y,m,g,[],[],v,b,M,u);C.forEach(E=>{const I=E.element,F=lo(v,I,new Set);E.preStyleProps.forEach(B=>F.add(B));const Q=lo(b,I,new Set);E.postStyleProps.forEach(B=>Q.add(B)),I!==t&&_.add(I)});const w=OC(_.values());return L8(t,this._triggerName,n,r,y,m,g,C,w,v,b,M)}}function Txe(i,e){const t=Qb(e);for(const n in i)i.hasOwnProperty(n)&&null!=i[n]&&(t[n]=i[n]);return t}class Ixe{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n=new Map,r=Qb(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(r[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=qb(o,r,t));const l=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,l,o,t),n.set(a,o)})}),n}}class Dxe{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new Ixe(r.style,r.options&&r.options.params||{},n))}),N8(this.states,"true","1"),N8(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new O8(e,r,this.states))}),this.fallbackTransition=function Pxe(i,e,t){return new O8(i,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,r){return this.transitionFactories.find(o=>o.match(e,t,n,r))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function N8(i,e,t){i.has(e)?i.has(t)||i.set(t,i.get(e)):i.has(t)&&i.set(e,i.get(t))}const kxe=new HC;class Fxe{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const n=[],s=f2(this._driver,t,n,[]);if(n.length)throw function FAe(i){return new Me(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,n){const r=e.element,s=g8(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const r=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=g2(this._driver,t,s,l2,kC,new Map,new Map,n,kxe,r),o.forEach(d=>{const u=lo(a,d.element,new Map);d.postStyleProps.forEach(h=>u.set(h,null))})):(r.push(function BAe(){return new Me(3300,!1)}()),o=[]),r.length)throw function LAe(i){return new Me(3504,!1)}();a.forEach((d,u)=>{d.forEach((h,f)=>{d.set(f,this._driver.computeStyle(u,f,Bl))})});const c=od(o.map(d=>{const u=a.get(d.element);return this._buildPlayer(d,new Map,u)}));return this._playersById.set(e,c),c.onDestroy(()=>this.destroy(e)),this.players.push(c),c}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function OAe(i){return new Me(3301,!1)}();return t}listen(e,t,n,r){const s=r2(t,"","","");return t2(this._getPlayer(e),n,s,r),()=>{}}command(e,t,n,r){if("register"==n)return void this.register(e,r[0]);if("create"==n)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(n){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const j8="ng-animate-queued",y2="ng-animate-disabled",jxe=[],U8={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Uxe={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Oo="__ng_removed";class A2{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function Gxe(i){return i??null}(n?e.value:e),n){const s=Qb(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(r=>{null==n[r]&&(n[r]=t[r])})}}}const Xb="void",x2=new A2(Xb);class Vxe{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,No(t,this._hostClassName)}listen(e,t,n,r){if(!this._triggers.has(t))throw function NAe(i,e){return new Me(3302,!1)}();if(null==n||0==n.length)throw function jAe(i){return new Me(3303,!1)}();if(!function Qxe(i){return"start"==i||"done"==i}(n))throw function UAe(i,e){return new Me(3400,!1)}();const s=lo(this._elementListeners,e,[]),o={name:t,phase:n,callback:r};s.push(o);const a=lo(this._engine.statesByElement,e,new Map);return a.has(t)||(No(e,FC),No(e,FC+"-"+t),a.set(t,x2)),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function VAe(i){return new Me(3401,!1)}();return t}trigger(e,t,n,r=!0){const s=this._getTrigger(t),o=new w2(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(No(e,FC),No(e,FC+"-"+t),this._engine.statesByElement.set(e,a=new Map));let l=a.get(t);const c=new A2(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(t,c),l||(l=x2),c.value!==Xb&&l.value===c.value){if(!function Xxe(i,e){const t=Object.keys(i),n=Object.keys(e);if(t.length!=n.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||i[s]!==e[s])return!1}return!0}(l.params,c.params)){const p=[],g=s.matchStyles(l.value,l.params,p),_=s.matchStyles(c.value,c.params,p);p.length?this._engine.reportError(p):this._engine.afterFlush(()=>{oh(e,g),$a(e,_)})}return}const h=lo(this._engine.playersByElement,e,[]);h.forEach(p=>{p.namespaceId==this.id&&p.triggerName==t&&p.queued&&p.destroy()});let f=s.matchTransition(l.value,c.value,e,c.params),m=!1;if(!f){if(!r)return;f=s.fallbackTransition,m=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:l,toState:c,player:o,isFallbackTransition:m}),m||(No(e,j8),o.onStart(()=>{yg(e,j8)})),o.onDone(()=>{let p=this.players.indexOf(o);p>=0&&this.players.splice(p,1);const g=this._engine.playersByElement.get(e);if(g){let _=g.indexOf(o);_>=0&&g.splice(_,1)}}),this.players.push(o),h.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,BC,!0);n.forEach(r=>{if(r[Oo])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,n,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((l,c)=>{if(o.set(c,l.value),this._triggers.has(c)){const d=this.trigger(e,c,Xb,r);d&&a.push(d)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),n&&od(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const l=this._triggers.get(o).fallbackTransition,c=n.get(o)||x2,d=new A2(Xb),u=new w2(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:l,fromState:c,toState:d,player:u,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(n.totalAnimations){const s=n.players.length?n.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(n.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)n.markElementAsRemoved(this.id,e,!1,t);else{const s=e[Oo];(!s||s===U8)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){No(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const s=n.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==n.triggerName){const l=r2(s,n.triggerName,n.fromState.value,n.toState.value);l._data=e,t2(n.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(n)}),this._queue=[],t.sort((n,r)=>{const s=n.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(n.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(n=>n.element===e)||t,t}}class zxe{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new Vxe(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,r=this.namespacesByHostElement;if(n.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const l=r.get(a);if(l){const c=n.indexOf(l);n.splice(c+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||n.unshift(e)}else n.push(e);return r.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}destroy(e,t){if(!e)return;const n=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(n);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>n.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n)for(let r of n.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,n,r){if(WC(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,n,r),!0}return!1}insertNode(e,t,n,r){if(!WC(t))return;const s=t[Oo];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),No(e,y2)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),yg(e,y2))}removeNode(e,t,n,r){if(WC(t)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,n,r,s){this.collectedLeaveElements.push(t),t[Oo]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,n,r,s){return WC(t)?this._fetchNamespace(e).listen(t,n,r,s):()=>{}}_buildInstruction(e,t,n,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,BC,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,c2,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return od(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[Oo];if(t&&t.setForRemoval){if(e[Oo]=U8,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(y2)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,r)=>this._balanceNamespaceList(n,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)No(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let r=0;r<n.length;r++)n[r]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?od(t).onDone(()=>{n.forEach(r=>r())}):n.forEach(r=>r())}}reportError(e){throw function zAe(i){return new Me(3402,!1)}()}_flushAnimations(e,t){const n=new HC,r=[],s=new Map,o=[],a=new Map,l=new Map,c=new Map,d=new Set;this.disabledNodes.forEach(P=>{d.add(P);const V=this.driver.query(P,".ng-animate-queued",!0);for(let O=0;O<V.length;O++)d.add(V[O])});const u=this.bodyNode,h=Array.from(this.statesByElement.keys()),f=H8(h,this.collectedEnterElements),m=new Map;let p=0;f.forEach((P,V)=>{const O=l2+p++;m.set(V,O),P.forEach(q=>No(q,O))});const g=[],_=new Set,v=new Set;for(let P=0;P<this.collectedLeaveElements.length;P++){const V=this.collectedLeaveElements[P],O=V[Oo];O&&O.setForRemoval&&(g.push(V),_.add(V),O.hasAnimation?this.driver.query(V,".ng-star-inserted",!0).forEach(q=>_.add(q)):v.add(V))}const b=new Map,y=H8(h,Array.from(_));y.forEach((P,V)=>{const O=kC+p++;b.set(V,O),P.forEach(q=>No(q,O))}),e.push(()=>{f.forEach((P,V)=>{const O=m.get(V);P.forEach(q=>yg(q,O))}),y.forEach((P,V)=>{const O=b.get(V);P.forEach(q=>yg(q,O))}),g.forEach(P=>{this.processLeaveNode(P)})});const x=[],C=[];for(let P=this._namespaceList.length-1;P>=0;P--)this._namespaceList[P].drainQueuedTransitions(t).forEach(O=>{const q=O.player,ee=O.element;if(x.push(q),this.collectedEnterElements.length){const U=ee[Oo];if(U&&U.setForMove){if(U.previousTriggersValues&&U.previousTriggersValues.has(O.triggerName)){const de=U.previousTriggersValues.get(O.triggerName),Ee=this.statesByElement.get(O.element);if(Ee&&Ee.has(O.triggerName)){const we=Ee.get(O.triggerName);we.value=de,Ee.set(O.triggerName,we)}}return void q.destroy()}}const Z=!u||!this.driver.containsElement(u,ee),Y=b.get(ee),he=m.get(ee),J=this._buildInstruction(O,n,he,Y,Z);if(J.errors&&J.errors.length)return void C.push(J);if(Z)return q.onStart(()=>oh(ee,J.fromStyles)),q.onDestroy(()=>$a(ee,J.toStyles)),void r.push(q);if(O.isFallbackTransition)return q.onStart(()=>oh(ee,J.fromStyles)),q.onDestroy(()=>$a(ee,J.toStyles)),void r.push(q);const ae=[];J.timelines.forEach(U=>{U.stretchStartingKeyframe=!0,this.disabledNodes.has(U.element)||ae.push(U)}),J.timelines=ae,n.append(ee,J.timelines),o.push({instruction:J,player:q,element:ee}),J.queriedElements.forEach(U=>lo(a,U,[]).push(q)),J.preStyleProps.forEach((U,de)=>{if(U.size){let Ee=l.get(de);Ee||l.set(de,Ee=new Set),U.forEach((we,et)=>Ee.add(et))}}),J.postStyleProps.forEach((U,de)=>{let Ee=c.get(de);Ee||c.set(de,Ee=new Set),U.forEach((we,et)=>Ee.add(et))})});if(C.length){const P=[];C.forEach(V=>{P.push(function HAe(i,e){return new Me(3505,!1)}())}),x.forEach(V=>V.destroy()),this.reportError(P)}const M=new Map,w=new Map;o.forEach(P=>{const V=P.element;n.has(V)&&(w.set(V,V),this._beforeAnimationBuild(P.player.namespaceId,P.instruction,M))}),r.forEach(P=>{const V=P.element;this._getPreviousPlayers(V,!1,P.namespaceId,P.triggerName,null).forEach(q=>{lo(M,V,[]).push(q),q.destroy()})});const E=g.filter(P=>Q8(P,l,c)),I=new Map;z8(I,this.driver,v,c,Bl).forEach(P=>{Q8(P,l,c)&&E.push(P)});const Q=new Map;f.forEach((P,V)=>{z8(Q,this.driver,new Set(P),l,"!")}),E.forEach(P=>{const V=I.get(P),O=Q.get(P);I.set(P,new Map([...Array.from(V?.entries()??[]),...Array.from(O?.entries()??[])]))});const B=[],L=[],X={};o.forEach(P=>{const{element:V,player:O,instruction:q}=P;if(n.has(V)){if(d.has(V))return O.onDestroy(()=>$a(V,q.toStyles)),O.disabled=!0,O.overrideTotalTime(q.totalTime),void r.push(O);let ee=X;if(w.size>1){let Y=V;const he=[];for(;Y=Y.parentNode;){const J=w.get(Y);if(J){ee=J;break}he.push(Y)}he.forEach(J=>w.set(J,ee))}const Z=this._buildAnimation(O.namespaceId,q,M,s,Q,I);if(O.setRealPlayer(Z),ee===X)B.push(O);else{const Y=this.playersByElement.get(ee);Y&&Y.length&&(O.parentPlayer=od(Y)),r.push(O)}}else oh(V,q.fromStyles),O.onDestroy(()=>$a(V,q.toStyles)),L.push(O),d.has(V)&&r.push(O)}),L.forEach(P=>{const V=s.get(P.element);if(V&&V.length){const O=od(V);P.setRealPlayer(O)}}),r.forEach(P=>{P.parentPlayer?P.syncPlayerEvents(P.parentPlayer):P.destroy()});for(let P=0;P<g.length;P++){const V=g[P],O=V[Oo];if(yg(V,kC),O&&O.hasAnimation)continue;let q=[];if(a.size){let Z=a.get(V);Z&&Z.length&&q.push(...Z);let Y=this.driver.query(V,c2,!0);for(let he=0;he<Y.length;he++){let J=a.get(Y[he]);J&&J.length&&q.push(...J)}}const ee=q.filter(Z=>!Z.destroyed);ee.length?Wxe(this,V,ee):this.processLeaveNode(V)}return g.length=0,B.forEach(P=>{this.players.push(P),P.onDone(()=>{P.destroy();const V=this.players.indexOf(P);this.players.splice(V,1)}),P.play()}),B}elementContainsData(e,t){let n=!1;const r=t[Oo];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,r,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const l=!s||s==Xb;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||o.push(c)})}}return(n||r)&&(o=o.filter(a=>!(n&&n!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,n){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const l of t.timelines){const c=l.element,d=c!==s,u=lo(n,c,[]);this._getPreviousPlayers(c,d,o,a,t.toState).forEach(f=>{const m=f.getRealPlayer();m.beforeDestroy&&m.beforeDestroy(),f.destroy(),u.push(f)})}oh(s,t.fromStyles)}_buildAnimation(e,t,n,r,s,o){const a=t.triggerName,l=t.element,c=[],d=new Set,u=new Set,h=t.timelines.map(m=>{const p=m.element;d.add(p);const g=p[Oo];if(g&&g.removedBeforeQueried)return new J0(m.duration,m.delay);const _=p!==l,v=function qxe(i){const e=[];return G8(i,e),e}((n.get(p)||jxe).map(M=>M.getRealPlayer())).filter(M=>!!M.element&&M.element===p),b=s.get(p),y=o.get(p),x=g8(0,this._normalizer,0,m.keyframes,b,y),C=this._buildPlayer(m,x,v);if(m.subTimeline&&r&&u.add(p),_){const M=new w2(e,a,p);M.setRealPlayer(C),c.push(M)}return C});c.forEach(m=>{lo(this.playersByQueriedElement,m.element,[]).push(m),m.onDone(()=>function Hxe(i,e,t){let n=i.get(e);if(n){if(n.length){const r=n.indexOf(t);n.splice(r,1)}0==n.length&&i.delete(e)}return n}(this.playersByQueriedElement,m.element,m))}),d.forEach(m=>No(m,M8));const f=od(h);return f.onDestroy(()=>{d.forEach(m=>yg(m,M8)),$a(l,t.toStyles)}),u.forEach(m=>{lo(r,m,[]).push(f)}),f}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new J0(e.duration,e.delay)}}class w2{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new J0,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,n)=>{t.forEach(r=>t2(e,n,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){lo(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function WC(i){return i&&1===i.nodeType}function V8(i,e){const t=i.style.display;return i.style.display=e??"none",t}function z8(i,e,t,n,r){const s=[];t.forEach(l=>s.push(V8(l)));const o=[];n.forEach((l,c)=>{const d=new Map;l.forEach(u=>{const h=e.computeStyle(c,u,r);d.set(u,h),(!h||0==h.length)&&(c[Oo]=Uxe,o.push(c))}),i.set(c,d)});let a=0;return t.forEach(l=>V8(l,s[a++])),o}function H8(i,e){const t=new Map;if(i.forEach(a=>t.set(a,[])),0==e.length)return t;const r=new Set(e),s=new Map;function o(a){if(!a)return 1;let l=s.get(a);if(l)return l;const c=a.parentNode;return l=t.has(c)?c:r.has(c)?1:o(c),s.set(a,l),l}return e.forEach(a=>{const l=o(a);1!==l&&t.get(l).push(a)}),t}function No(i,e){i.classList?.add(e)}function yg(i,e){i.classList?.remove(e)}function Wxe(i,e,t){od(t).onDone(()=>i.processLeaveNode(e))}function G8(i,e){for(let t=0;t<i.length;t++){const n=i[t];n instanceof HV?G8(n.players,e):e.push(n)}}function Q8(i,e,t){const n=t.get(i);if(!n)return!1;let r=e.get(i);return r?n.forEach(s=>r.add(s)):e.set(i,n),t.delete(i),!0}class qC{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new zxe(e,t,n),this._timelineEngine=new Fxe(e,t,n),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,n,r,s){const o=e+"-"+r;let a=this._triggerCache[o];if(!a){const l=[],d=f2(this._driver,s,l,[]);if(l.length)throw function PAe(i,e){return new Me(3404,!1)}();a=function Rxe(i,e,t){return new Dxe(i,e,t)}(r,d,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}onRemove(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,r){if("@"==n.charAt(0)){const[s,o]=_8(n);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}listen(e,t,n,r,s){if("@"==n.charAt(0)){const[o,a]=_8(n);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,n,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let Zxe=(()=>{class i{constructor(t,n,r){this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;let s=i.initialStylesByElement.get(t);s||i.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&$a(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&($a(this._element,this._initialStyles),this._endStyles&&($a(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(i.initialStylesByElement.delete(this._element),this._startStyles&&(oh(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(oh(this._element,this._endStyles),this._endStyles=null),$a(this._element,this._initialStyles),this._state=3)}}return i.initialStylesByElement=new WeakMap,i})();function C2(i){let e=null;return i.forEach((t,n)=>{(function Kxe(i){return"display"===i||"position"===i})(n)&&(e=e||new Map,e.set(n,t))}),e}class W8{constructor(e,t,n,r){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(n=>{t.push(Object.fromEntries(n))}),t}_triggerWebAnimation(e,t,n){return e.animate(this._convertKeyframesToObject(t),n)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,r)=>{"offset"!==r&&e.set(r,this._finished?n:D8(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class $xe{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return A8(e,t)}getParentElement(e){return o2(e)}query(e,t,n){return x8(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,r,s,o=[]){const l={duration:n,delay:r,fill:0==r?"both":"forwards"};s&&(l.easing=s);const c=new Map,d=o.filter(f=>f instanceof W8);(function ixe(i,e){return 0===i||0===e})(n,r)&&d.forEach(f=>{f.currentSnapshot.forEach((m,p)=>c.set(p,m))});let u=function $Ae(i){return i.length?i[0]instanceof Map?i:i.map(e=>E8(e)):[]}(t).map(f=>ad(f));u=function nxe(i,e,t){if(t.size&&e.length){let n=e[0],r=[];if(t.forEach((s,o)=>{n.has(o)||r.push(o),n.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(a=>o.set(a,D8(i,a)))}}return e}(e,u,c);const h=function Yxe(i,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=C2(e[0]),e.length>1&&(n=C2(e[e.length-1]))):e instanceof Map&&(t=C2(e)),t||n?new Zxe(i,t,n):null}(e,u);return new W8(e,u,l,h)}}let Jxe=(()=>{class i extends UV{constructor(t,n){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(n.body,{id:"0",encapsulation:Uo.None,styles:[],data:{animation:[]}})}build(t){const n=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?VV(t):t;return q8(this._renderer,null,n,"register",[r]),new ewe(n,this._renderer)}}return i.\u0275fac=function(t){return new(t||i)(ye(qg),ye(ii))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();class ewe extends jhe{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new twe(this._id,e,t||{},this._renderer)}}class twe{constructor(e,t,n,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return q8(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function q8(i,e,t,n,r){return i.setProperty(e,`@@${t}:${n}`,r)}const X8="@.disabled";let iwe=(()=>{class i{constructor(t,n,r){this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=(s,o)=>{const a=o?.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,n){const s=this.delegate.createRenderer(t,n);if(!(t&&n&&n.data&&n.data.animation)){let d=this._rendererCache.get(s);return d||(d=new Y8("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,d)),d}const o=n.id,a=n.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const l=d=>{Array.isArray(d)?d.forEach(l):this.engine.registerTrigger(o,a,t,d.name,d)};return n.data.animation.forEach(l),new nwe(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,n,r){t>=0&&t<this._microtaskId?this._zone.run(()=>n(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return i.\u0275fac=function(t){return new(t||i)(ye(qg),ye(qC),ye(at))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();class Y8{constructor(e,t,n,r){this.namespaceId=e,this.delegate=t,this.engine=n,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?s=>t.destroyNode(s):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,r=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,r){this.delegate.setStyle(e,t,n,r)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==X8?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class nwe extends Y8{constructor(e,t,n,r,s){super(t,n,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==X8?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.slice(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const r=function rwe(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function swe(i){const e=i.indexOf(".");return[i.substring(0,e),i.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,n,a)})}return this.delegate.listen(e,t,n)}}let owe=(()=>{class i extends qC{constructor(t,n,r,s){super(t.body,n,r)}ngOnDestroy(){this.flush()}}return i.\u0275fac=function(t){return new(t||i)(ye(ii),ye(a2),ye(b2),ye(Yh))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();const Z8=[{provide:UV,useClass:Jxe},{provide:b2,useFactory:function awe(){return new Exe}},{provide:qC,useClass:owe},{provide:qg,useFactory:function lwe(i,e,t){return new iwe(i,e,t)},deps:[Ry,qC,at]}],M2=[{provide:a2,useFactory:()=>new $xe},{provide:rs,useValue:"BrowserAnimations"},...Z8],K8=[{provide:a2,useClass:w8},{provide:rs,useValue:"NoopAnimations"},...Z8];let cwe=(()=>{class i{static withConfig(t){return{ngModule:i,providers:t.disableAnimations?K8:M2}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=oi({providers:M2,imports:[T3]}),i})();class Ag{}Ag.\u0275fac=function(e){return new(e||Ag)},Ag.\u0275mod=ci({type:Ag,bootstrap:[Gb]}),Ag.\u0275inj=oi({providers:[{provide:tw,useValue:{fullLibraryLoader:()=>lh.e(225).then(lh.bind(lh,7225))}},Bx],imports:[T3,_g,Cp,vg,$0e,lpe,cwe,Ode,YD,oR,Aye,hR,XD]}),J$().bootstrapModule(Ag).catch(i=>console.error(i))}},KC=>{KC(KC.s=1778)}]);