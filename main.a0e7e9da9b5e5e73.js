"use strict";(self.webpackChunkngx_three_demo=self.webpackChunkngx_three_demo||[]).push([[179],{7650:(my,K1,Va)=>{var Td={};Va.r(Td),Va.d(Td,{ACESFilmicToneMapping:()=>LL,AddEquation:()=>pc,AddOperation:()=>DL,AdditiveAnimationBlendMode:()=>WM,AdditiveBlending:()=>ih,AlphaFormat:()=>jL,AlwaysDepth:()=>ML,AlwaysStencilFunc:()=>JL,AmbientLight:()=>oT,AmbientLightProbe:()=>Zte,AnimationClip:()=>Xh,AnimationLoader:()=>Bte,AnimationMixer:()=>aN,AnimationObjectGroup:()=>hne,AnimationUtils:()=>Yn,ArcCurve:()=>mk,ArrayCamera:()=>WO,ArrowHelper:()=>Rne,Audio:()=>rN,AudioAnalyser:()=>tne,AudioContext:()=>aT,AudioListener:()=>$te,AudioLoader:()=>Kte,AxesHelper:()=>Ane,BackSide:()=>as,BasicDepthPacking:()=>QL,BasicShadowMap:()=>YZ,Bone:()=>av,BooleanKeyframeTrack:()=>Lc,Box2:()=>_ne,Box3:()=>Ho,Box3Helper:()=>vN,BoxBufferGeometry:()=>Xn,BoxGeometry:()=>Xn,BoxHelper:()=>Cne,BufferAttribute:()=>En,BufferGeometry:()=>wt,BufferGeometryLoader:()=>Yk,ByteType:()=>kL,Cache:()=>kc,Camera:()=>Qf,CameraHelper:()=>Tne,CanvasTexture:()=>US,CapsuleBufferGeometry:()=>Ih,CapsuleGeometry:()=>Ih,CatmullRomCurve3:()=>gk,CineonToneMapping:()=>FL,CircleBufferGeometry:()=>Fh,CircleGeometry:()=>Fh,ClampToEdgeWrapping:()=>dr,Clock:()=>Cv,Color:()=>Ce,ColorKeyframeTrack:()=>eT,ColorManagement:()=>Es,CompressedTexture:()=>pk,CompressedTextureLoader:()=>Ute,ConeBufferGeometry:()=>Lh,ConeGeometry:()=>Lh,CubeCamera:()=>mO,CubeReflectionMapping:()=>tl,CubeRefractionMapping:()=>nl,CubeTexture:()=>$f,CubeTextureLoader:()=>Vte,CubeUVReflectionMapping:()=>rh,CubicBezierCurve:()=>GS,CubicBezierCurve3:()=>vk,CubicInterpolant:()=>Bk,CullFaceBack:()=>fM,CullFaceFront:()=>aL,CullFaceFrontBack:()=>ZZ,CullFaceNone:()=>oL,Curve:()=>po,CurvePath:()=>bk,CustomBlending:()=>uL,CustomToneMapping:()=>OL,CylinderBufferGeometry:()=>mi,CylinderGeometry:()=>mi,Cylindrical:()=>gne,Data3DTexture:()=>P_,DataArrayTexture:()=>Xf,DataTexture:()=>Dc,DataTexture2DArray:()=>Wne,DataTexture3D:()=>Xne,DataTextureLoader:()=>jte,DataUtils:()=>gp,DecrementStencilOp:()=>aY,DecrementWrapStencilOp:()=>cY,DefaultLoadingManager:()=>jk,DepthFormat:()=>sl,DepthStencilFormat:()=>gc,DepthTexture:()=>XO,DirectionalLight:()=>wv,DirectionalLightHelper:()=>Sne,DiscreteInterpolant:()=>Uk,DodecahedronBufferGeometry:()=>Oh,DodecahedronGeometry:()=>Oh,DoubleSide:()=>oo,DstAlphaFactor:()=>_L,DstColorFactor:()=>yL,DynamicCopyUsage:()=>MY,DynamicDrawUsage:()=>T_,DynamicReadUsage:()=>bY,EdgesGeometry:()=>xk,EllipseCurve:()=>_l,EqualDepth:()=>TL,EqualStencilFunc:()=>fY,EquirectangularReflectionMapping:()=>Bf,EquirectangularRefractionMapping:()=>Uf,Euler:()=>ph,EventDispatcher:()=>ls,ExtrudeBufferGeometry:()=>Nh,ExtrudeGeometry:()=>Nh,FileLoader:()=>Ds,FlatShading:()=>cL,Float16BufferAttribute:()=>sQ,Float32BufferAttribute:()=>$e,Float64BufferAttribute:()=>oQ,FloatType:()=>Wr,Fog:()=>ep,FogExp2:()=>nv,Font:()=>zne,FontLoader:()=>jne,FramebufferTexture:()=>lte,FrontSide:()=>el,Frustum:()=>Q_,GLBufferAttribute:()=>mne,GLSL1:()=>TY,GLSL3:()=>qM,GreaterDepth:()=>EL,GreaterEqualDepth:()=>CL,GreaterEqualStencilFunc:()=>_Y,GreaterStencilFunc:()=>mY,GridHelper:()=>fT,Group:()=>Xo,HalfFloatType:()=>lo,HemisphereLight:()=>nT,HemisphereLightHelper:()=>wne,HemisphereLightProbe:()=>qte,IcosahedronBufferGeometry:()=>Fc,IcosahedronGeometry:()=>Fc,ImageBitmapLoader:()=>Jk,ImageLoader:()=>fp,ImageUtils:()=>JM,ImmediateRenderObject:()=>Hne,IncrementStencilOp:()=>oY,IncrementWrapStencilOp:()=>lY,InstancedBufferAttribute:()=>Ph,InstancedBufferGeometry:()=>Zk,InstancedInterleavedBuffer:()=>pne,InstancedMesh:()=>LS,Int16BufferAttribute:()=>iQ,Int32BufferAttribute:()=>rQ,Int8BufferAttribute:()=>eQ,IntType:()=>BL,InterleavedBuffer:()=>tp,InterleavedBufferAttribute:()=>gl,Interpolant:()=>Hh,InterpolateDiscrete:()=>ah,InterpolateLinear:()=>vc,InterpolateSmooth:()=>x_,InvertStencilOp:()=>uY,KeepStencilOp:()=>M_,KeyframeTrack:()=>yo,LOD:()=>JO,LatheBufferGeometry:()=>Pc,LatheGeometry:()=>Pc,Layers:()=>B_,LessDepth:()=>SL,LessEqualDepth:()=>p_,LessEqualStencilFunc:()=>pY,LessStencilFunc:()=>dY,Light:()=>Da,LightProbe:()=>Mv,Line:()=>wi,Line3:()=>hN,LineBasicMaterial:()=>Pi,LineCurve:()=>pv,LineCurve3:()=>yk,LineDashedMaterial:()=>Nk,LineLoop:()=>kS,LineSegments:()=>As,LinearEncoding:()=>ol,LinearFilter:()=>si,LinearInterpolant:()=>JS,LinearMipMapLinearFilter:()=>tY,LinearMipMapNearestFilter:()=>eY,LinearMipmapLinearFilter:()=>ya,LinearMipmapNearestFilter:()=>g_,LinearSRGBColorSpace:()=>ll,LinearToneMapping:()=>PL,Loader:()=>Fr,LoaderUtils:()=>bo,LoadingManager:()=>tT,LoopOnce:()=>GM,LoopPingPong:()=>ZL,LoopRepeat:()=>qL,LuminanceAlphaFormat:()=>HL,LuminanceFormat:()=>wM,MOUSE:()=>Cs,Material:()=>Ai,MaterialLoader:()=>Sv,MathUtils:()=>kt,Matrix3:()=>Xr,Matrix4:()=>st,MaxEquation:()=>vM,Mesh:()=>Ke,MeshBasicMaterial:()=>tr,MeshDepthMaterial:()=>tv,MeshDistanceMaterial:()=>ES,MeshLambertMaterial:()=>Ok,MeshMatcapMaterial:()=>kk,MeshNormalMaterial:()=>Lk,MeshPhongMaterial:()=>$S,MeshPhysicalMaterial:()=>Ra,MeshStandardMaterial:()=>vo,MeshToonMaterial:()=>Fk,MinEquation:()=>_M,MirroredRepeatWrapping:()=>sh,MixOperation:()=>AL,MultiplyBlending:()=>gM,MultiplyOperation:()=>Nf,NearestFilter:()=>bi,NearestMipMapLinearFilter:()=>JZ,NearestMipMapNearestFilter:()=>$Z,NearestMipmapLinearFilter:()=>jf,NearestMipmapNearestFilter:()=>Vf,NeverDepth:()=>wL,NeverStencilFunc:()=>hY,NoBlending:()=>ao,NoColorSpace:()=>iY,NoToneMapping:()=>jo,NormalAnimationBlendMode:()=>w_,NormalBlending:()=>fc,NotEqualDepth:()=>RL,NotEqualStencilFunc:()=>gY,NumberKeyframeTrack:()=>Gh,Object3D:()=>gn,ObjectLoader:()=>Wte,ObjectSpaceNormalMap:()=>$L,OctahedronBufferGeometry:()=>go,OctahedronGeometry:()=>go,OneFactor:()=>pL,OneMinusDstAlphaFactor:()=>vL,OneMinusDstColorFactor:()=>bL,OneMinusSrcAlphaFactor:()=>bM,OneMinusSrcColorFactor:()=>gL,OrthographicCamera:()=>Ec,PCFShadowMap:()=>pM,PCFSoftShadowMap:()=>lL,PMREMGenerator:()=>wS,ParametricGeometry:()=>Une,Path:()=>cp,PerspectiveCamera:()=>zi,Plane:()=>Wo,PlaneBufferGeometry:()=>Ca,PlaneGeometry:()=>Ca,PlaneHelper:()=>Ene,PointLight:()=>xv,PointLightHelper:()=>bne,Points:()=>BS,PointsMaterial:()=>uv,PolarGridHelper:()=>Mne,PolyhedronBufferGeometry:()=>mo,PolyhedronGeometry:()=>mo,PositionalAudio:()=>ene,PropertyBinding:()=>Nn,PropertyMixer:()=>oN,QuadraticBezierCurve:()=>WS,QuadraticBezierCurve3:()=>XS,Quaternion:()=>bn,QuaternionKeyframeTrack:()=>yl,QuaternionLinearInterpolant:()=>Vk,REVISION:()=>f_,RGBADepthPacking:()=>KM,RGBAFormat:()=>fr,RGBAIntegerFormat:()=>XL,RGBA_ASTC_10x10_Format:()=>VM,RGBA_ASTC_10x5_Format:()=>NM,RGBA_ASTC_10x6_Format:()=>BM,RGBA_ASTC_10x8_Format:()=>UM,RGBA_ASTC_12x10_Format:()=>jM,RGBA_ASTC_12x12_Format:()=>zM,RGBA_ASTC_4x4_Format:()=>AM,RGBA_ASTC_5x4_Format:()=>DM,RGBA_ASTC_5x5_Format:()=>PM,RGBA_ASTC_6x5_Format:()=>IM,RGBA_ASTC_6x6_Format:()=>FM,RGBA_ASTC_8x5_Format:()=>LM,RGBA_ASTC_8x6_Format:()=>OM,RGBA_ASTC_8x8_Format:()=>kM,RGBA_BPTC_Format:()=>HM,RGBA_ETC2_EAC_Format:()=>RM,RGBA_PVRTC_2BPPV1_Format:()=>CM,RGBA_PVRTC_4BPPV1_Format:()=>TM,RGBA_S3TC_DXT1_Format:()=>v_,RGBA_S3TC_DXT3_Format:()=>y_,RGBA_S3TC_DXT5_Format:()=>b_,RGBFormat:()=>zL,RGB_ETC1_Format:()=>KL,RGB_ETC2_Format:()=>EM,RGB_PVRTC_2BPPV1_Format:()=>SM,RGB_PVRTC_4BPPV1_Format:()=>MM,RGB_S3TC_DXT1_Format:()=>__,RGFormat:()=>oh,RGIntegerFormat:()=>WL,RawShaderMaterial:()=>Ik,Ray:()=>qf,Raycaster:()=>mp,RectAreaLight:()=>Kk,RedFormat:()=>_c,RedIntegerFormat:()=>GL,ReinhardToneMapping:()=>IL,RepeatWrapping:()=>il,ReplaceStencilOp:()=>sY,ReverseSubtractEquation:()=>dL,RingBufferGeometry:()=>Bh,RingGeometry:()=>Bh,SRGBColorSpace:()=>zo,Scene:()=>DS,ShaderChunk:()=>$t,ShaderLib:()=>fo,ShaderMaterial:()=>Zn,ShadowMaterial:()=>Pk,Shape:()=>Ic,ShapeBufferGeometry:()=>Uh,ShapeGeometry:()=>Uh,ShapePath:()=>Dne,ShapeUtils:()=>Ko,ShortType:()=>NL,Skeleton:()=>sp,SkeletonHelper:()=>yne,SkinnedMesh:()=>FS,SmoothShading:()=>QZ,Source:()=>Mc,Sphere:()=>xa,SphereBufferGeometry:()=>Ea,SphereGeometry:()=>Ea,Spherical:()=>Ev,SphericalHarmonics3:()=>qk,SplineCurve:()=>KS,SpotLight:()=>rT,SpotLightHelper:()=>vne,Sprite:()=>QO,SpriteMaterial:()=>PS,SrcAlphaFactor:()=>yM,SrcAlphaSaturateFactor:()=>xL,SrcColorFactor:()=>mL,StaticCopyUsage:()=>wY,StaticDrawUsage:()=>S_,StaticReadUsage:()=>yY,StereoCamera:()=>Yte,StreamCopyUsage:()=>SY,StreamDrawUsage:()=>vY,StreamReadUsage:()=>xY,StringKeyframeTrack:()=>Oc,SubtractEquation:()=>hL,SubtractiveBlending:()=>mM,TOUCH:()=>va,TangentSpaceNormalMap:()=>al,TetrahedronBufferGeometry:()=>Vh,TetrahedronGeometry:()=>Vh,TextGeometry:()=>Vne,Texture:()=>mr,TextureLoader:()=>zk,TorusBufferGeometry:()=>_o,TorusGeometry:()=>_o,TorusKnotBufferGeometry:()=>jh,TorusKnotGeometry:()=>jh,Triangle:()=>hs,TriangleFanDrawMode:()=>XM,TriangleStripDrawMode:()=>YL,TrianglesDrawMode:()=>nY,TubeBufferGeometry:()=>zh,TubeGeometry:()=>zh,UVMapping:()=>m_,Uint16BufferAttribute:()=>dS,Uint32BufferAttribute:()=>j_,Uint8BufferAttribute:()=>tQ,Uint8ClampedBufferAttribute:()=>nQ,Uniform:()=>uT,UniformsLib:()=>Qe,UniformsUtils:()=>Go,UnsignedByteType:()=>Gr,UnsignedInt248Type:()=>mc,UnsignedIntType:()=>rl,UnsignedShort4444Type:()=>UL,UnsignedShort5551Type:()=>VL,UnsignedShortType:()=>xM,VSMShadowMap:()=>nh,Vector2:()=>te,Vector3:()=>C,Vector4:()=>dn,VectorKeyframeTrack:()=>Wh,VideoTexture:()=>ate,WebGL1Renderer:()=>KO,WebGL3DRenderTarget:()=>GY,WebGLArrayRenderTarget:()=>HY,WebGLCubeRenderTarget:()=>gO,WebGLMultipleRenderTargets:()=>WY,WebGLMultisampleRenderTarget:()=>Gne,WebGLRenderTarget:()=>Wn,WebGLRenderer:()=>AS,WebGLUtils:()=>GO,WireframeGeometry:()=>Rk,WrapAroundEnding:()=>zf,ZeroCurvatureEnding:()=>yc,ZeroFactor:()=>fL,ZeroSlopeEnding:()=>bc,ZeroStencilOp:()=>rY,_SRGBAFormat:()=>C_,sRGBEncoding:()=>hn});var gy={};function cn(i){return"function"==typeof i}function _y(i){const t=i(n=>{Error.call(n),n.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}Va.r(gy),Va.d(gy,{KHR_DF_CHANNEL_RGBSDA_ALPHA:()=>Gue,KHR_DF_CHANNEL_RGBSDA_BLUE:()=>jue,KHR_DF_CHANNEL_RGBSDA_DEPTH:()=>Hue,KHR_DF_CHANNEL_RGBSDA_GREEN:()=>Vue,KHR_DF_CHANNEL_RGBSDA_RED:()=>Uue,KHR_DF_CHANNEL_RGBSDA_STENCIL:()=>zue,KHR_DF_FLAG_ALPHA_PREMULTIPLIED:()=>aue,KHR_DF_FLAG_ALPHA_STRAIGHT:()=>oue,KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT:()=>Qce,KHR_DF_MODEL_ASTC:()=>rue,KHR_DF_MODEL_ETC1:()=>nue,KHR_DF_MODEL_ETC1S:()=>sue,KHR_DF_MODEL_ETC2:()=>iue,KHR_DF_MODEL_RGBSDA:()=>tue,KHR_DF_MODEL_UNSPECIFIED:()=>eue,KHR_DF_PRIMARIES_ACES:()=>Fue,KHR_DF_PRIMARIES_ACESCC:()=>Lue,KHR_DF_PRIMARIES_ADOBERGB:()=>Bue,KHR_DF_PRIMARIES_BT2020:()=>Pue,KHR_DF_PRIMARIES_BT601_EBU:()=>Aue,KHR_DF_PRIMARIES_BT601_SMPTE:()=>Due,KHR_DF_PRIMARIES_BT709:()=>Rue,KHR_DF_PRIMARIES_CIEXYZ:()=>Iue,KHR_DF_PRIMARIES_DISPLAYP3:()=>Nue,KHR_DF_PRIMARIES_NTSC1953:()=>Oue,KHR_DF_PRIMARIES_PAL525:()=>kue,KHR_DF_PRIMARIES_UNSPECIFIED:()=>Eue,KHR_DF_SAMPLE_DATATYPE_EXPONENT:()=>Kue,KHR_DF_SAMPLE_DATATYPE_FLOAT:()=>Wue,KHR_DF_SAMPLE_DATATYPE_LINEAR:()=>que,KHR_DF_SAMPLE_DATATYPE_SIGNED:()=>Xue,KHR_DF_TRANSFER_ACESCC:()=>Sue,KHR_DF_TRANSFER_ACESCCT:()=>Tue,KHR_DF_TRANSFER_ADOBERGB:()=>Cue,KHR_DF_TRANSFER_BT1886:()=>mue,KHR_DF_TRANSFER_DCIP3:()=>bue,KHR_DF_TRANSFER_HLG_EOTF:()=>_ue,KHR_DF_TRANSFER_HLG_OETF:()=>gue,KHR_DF_TRANSFER_ITU:()=>hue,KHR_DF_TRANSFER_LINEAR:()=>cue,KHR_DF_TRANSFER_NTSC:()=>due,KHR_DF_TRANSFER_PAL625_EOTF:()=>wue,KHR_DF_TRANSFER_PAL_OETF:()=>xue,KHR_DF_TRANSFER_PQ_EOTF:()=>vue,KHR_DF_TRANSFER_PQ_OETF:()=>yue,KHR_DF_TRANSFER_SLOG:()=>fue,KHR_DF_TRANSFER_SLOG2:()=>pue,KHR_DF_TRANSFER_SRGB:()=>uue,KHR_DF_TRANSFER_ST240:()=>Mue,KHR_DF_TRANSFER_UNSPECIFIED:()=>lue,KHR_DF_VENDORID_KHRONOS:()=>$ce,KHR_DF_VERSION:()=>Jce,KHR_SUPERCOMPRESSION_BASISLZ:()=>qce,KHR_SUPERCOMPRESSION_NONE:()=>Kce,KHR_SUPERCOMPRESSION_ZLIB:()=>Yce,KHR_SUPERCOMPRESSION_ZSTD:()=>Zce,KTX2Container:()=>HU,VK_FORMAT_A1R5G5B5_UNORM_PACK16:()=>ihe,VK_FORMAT_A2B10G10R10_SINT_PACK32:()=>jhe,VK_FORMAT_A2B10G10R10_SNORM_PACK32:()=>Uhe,VK_FORMAT_A2B10G10R10_UINT_PACK32:()=>Vhe,VK_FORMAT_A2B10G10R10_UNORM_PACK32:()=>Bhe,VK_FORMAT_A2R10G10B10_SINT_PACK32:()=>Nhe,VK_FORMAT_A2R10G10B10_SNORM_PACK32:()=>Ohe,VK_FORMAT_A2R10G10B10_UINT_PACK32:()=>khe,VK_FORMAT_A2R10G10B10_UNORM_PACK32:()=>Lhe,VK_FORMAT_A4B4G4R4_UNORM_PACK16_EXT:()=>bpe,VK_FORMAT_A4R4G4B4_UNORM_PACK16_EXT:()=>ype,VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT:()=>gpe,VK_FORMAT_ASTC_10x10_SRGB_BLOCK:()=>kfe,VK_FORMAT_ASTC_10x10_UNORM_BLOCK:()=>Ofe,VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT:()=>fpe,VK_FORMAT_ASTC_10x5_SRGB_BLOCK:()=>Dfe,VK_FORMAT_ASTC_10x5_UNORM_BLOCK:()=>Afe,VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT:()=>ppe,VK_FORMAT_ASTC_10x6_SRGB_BLOCK:()=>Ife,VK_FORMAT_ASTC_10x6_UNORM_BLOCK:()=>Pfe,VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT:()=>mpe,VK_FORMAT_ASTC_10x8_SRGB_BLOCK:()=>Lfe,VK_FORMAT_ASTC_10x8_UNORM_BLOCK:()=>Ffe,VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT:()=>_pe,VK_FORMAT_ASTC_12x10_SRGB_BLOCK:()=>Bfe,VK_FORMAT_ASTC_12x10_UNORM_BLOCK:()=>Nfe,VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT:()=>vpe,VK_FORMAT_ASTC_12x12_SRGB_BLOCK:()=>Vfe,VK_FORMAT_ASTC_12x12_UNORM_BLOCK:()=>Ufe,VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT:()=>spe,VK_FORMAT_ASTC_4x4_SRGB_BLOCK:()=>pfe,VK_FORMAT_ASTC_4x4_UNORM_BLOCK:()=>ffe,VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT:()=>ope,VK_FORMAT_ASTC_5x4_SRGB_BLOCK:()=>gfe,VK_FORMAT_ASTC_5x4_UNORM_BLOCK:()=>mfe,VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT:()=>ape,VK_FORMAT_ASTC_5x5_SRGB_BLOCK:()=>vfe,VK_FORMAT_ASTC_5x5_UNORM_BLOCK:()=>_fe,VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT:()=>lpe,VK_FORMAT_ASTC_6x5_SRGB_BLOCK:()=>bfe,VK_FORMAT_ASTC_6x5_UNORM_BLOCK:()=>yfe,VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT:()=>cpe,VK_FORMAT_ASTC_6x6_SRGB_BLOCK:()=>wfe,VK_FORMAT_ASTC_6x6_UNORM_BLOCK:()=>xfe,VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT:()=>upe,VK_FORMAT_ASTC_8x5_SRGB_BLOCK:()=>Sfe,VK_FORMAT_ASTC_8x5_UNORM_BLOCK:()=>Mfe,VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT:()=>hpe,VK_FORMAT_ASTC_8x6_SRGB_BLOCK:()=>Cfe,VK_FORMAT_ASTC_8x6_UNORM_BLOCK:()=>Tfe,VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT:()=>dpe,VK_FORMAT_ASTC_8x8_SRGB_BLOCK:()=>Rfe,VK_FORMAT_ASTC_8x8_UNORM_BLOCK:()=>Efe,VK_FORMAT_B10G11R11_UFLOAT_PACK32:()=>Ide,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16:()=>Wfe,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16:()=>Yfe,VK_FORMAT_B4G4R4A4_UNORM_PACK16:()=>$ue,VK_FORMAT_B5G5R5A1_UNORM_PACK16:()=>nhe,VK_FORMAT_B5G6R5_UNORM_PACK16:()=>ehe,VK_FORMAT_B8G8R8A8_SINT:()=>Ihe,VK_FORMAT_B8G8R8A8_SNORM:()=>Dhe,VK_FORMAT_B8G8R8A8_SRGB:()=>Fhe,VK_FORMAT_B8G8R8A8_UINT:()=>Phe,VK_FORMAT_B8G8R8A8_UNORM:()=>Ahe,VK_FORMAT_B8G8R8_SINT:()=>whe,VK_FORMAT_B8G8R8_SNORM:()=>bhe,VK_FORMAT_B8G8R8_SRGB:()=>Mhe,VK_FORMAT_B8G8R8_UINT:()=>xhe,VK_FORMAT_B8G8R8_UNORM:()=>yhe,VK_FORMAT_BC1_RGBA_SRGB_BLOCK:()=>Gde,VK_FORMAT_BC1_RGBA_UNORM_BLOCK:()=>Hde,VK_FORMAT_BC1_RGB_SRGB_BLOCK:()=>zde,VK_FORMAT_BC1_RGB_UNORM_BLOCK:()=>jde,VK_FORMAT_BC2_SRGB_BLOCK:()=>Xde,VK_FORMAT_BC2_UNORM_BLOCK:()=>Wde,VK_FORMAT_BC3_SRGB_BLOCK:()=>qde,VK_FORMAT_BC3_UNORM_BLOCK:()=>Kde,VK_FORMAT_BC4_SNORM_BLOCK:()=>Yde,VK_FORMAT_BC4_UNORM_BLOCK:()=>Zde,VK_FORMAT_BC5_SNORM_BLOCK:()=>$de,VK_FORMAT_BC5_UNORM_BLOCK:()=>Qde,VK_FORMAT_BC6H_SFLOAT_BLOCK:()=>efe,VK_FORMAT_BC6H_UFLOAT_BLOCK:()=>Jde,VK_FORMAT_BC7_SRGB_BLOCK:()=>nfe,VK_FORMAT_BC7_UNORM_BLOCK:()=>tfe,VK_FORMAT_D16_UNORM:()=>Lde,VK_FORMAT_D16_UNORM_S8_UINT:()=>Bde,VK_FORMAT_D24_UNORM_S8_UINT:()=>Ude,VK_FORMAT_D32_SFLOAT:()=>kde,VK_FORMAT_D32_SFLOAT_S8_UINT:()=>Vde,VK_FORMAT_E5B9G9R9_UFLOAT_PACK32:()=>Fde,VK_FORMAT_EAC_R11G11_SNORM_BLOCK:()=>dfe,VK_FORMAT_EAC_R11G11_UNORM_BLOCK:()=>hfe,VK_FORMAT_EAC_R11_SNORM_BLOCK:()=>ufe,VK_FORMAT_EAC_R11_UNORM_BLOCK:()=>cfe,VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK:()=>ofe,VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK:()=>sfe,VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK:()=>lfe,VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK:()=>afe,VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK:()=>rfe,VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK:()=>ife,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16:()=>Gfe,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16:()=>Zfe,VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG:()=>tpe,VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG:()=>Qfe,VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG:()=>npe,VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG:()=>$fe,VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG:()=>ipe,VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG:()=>Jfe,VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG:()=>rpe,VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG:()=>epe,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16:()=>Hfe,VK_FORMAT_R10X6G10X6_UNORM_2PACK16:()=>zfe,VK_FORMAT_R10X6_UNORM_PACK16:()=>jfe,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16:()=>qfe,VK_FORMAT_R12X4G12X4_UNORM_2PACK16:()=>Kfe,VK_FORMAT_R12X4_UNORM_PACK16:()=>Xfe,VK_FORMAT_R16G16B16A16_SFLOAT:()=>ade,VK_FORMAT_R16G16B16A16_SINT:()=>ode,VK_FORMAT_R16G16B16A16_SNORM:()=>rde,VK_FORMAT_R16G16B16A16_UINT:()=>sde,VK_FORMAT_R16G16B16A16_UNORM:()=>ide,VK_FORMAT_R16G16B16_SFLOAT:()=>nde,VK_FORMAT_R16G16B16_SINT:()=>tde,VK_FORMAT_R16G16B16_SNORM:()=>Jhe,VK_FORMAT_R16G16B16_UINT:()=>ede,VK_FORMAT_R16G16B16_UNORM:()=>$he,VK_FORMAT_R16G16_SFLOAT:()=>Qhe,VK_FORMAT_R16G16_SINT:()=>Yhe,VK_FORMAT_R16G16_SNORM:()=>qhe,VK_FORMAT_R16G16_UINT:()=>Zhe,VK_FORMAT_R16G16_UNORM:()=>Khe,VK_FORMAT_R16_SFLOAT:()=>Xhe,VK_FORMAT_R16_SINT:()=>Whe,VK_FORMAT_R16_SNORM:()=>Hhe,VK_FORMAT_R16_UINT:()=>Ghe,VK_FORMAT_R16_UNORM:()=>zhe,VK_FORMAT_R32G32B32A32_SFLOAT:()=>yde,VK_FORMAT_R32G32B32A32_SINT:()=>vde,VK_FORMAT_R32G32B32A32_UINT:()=>_de,VK_FORMAT_R32G32B32_SFLOAT:()=>gde,VK_FORMAT_R32G32B32_SINT:()=>mde,VK_FORMAT_R32G32B32_UINT:()=>pde,VK_FORMAT_R32G32_SFLOAT:()=>fde,VK_FORMAT_R32G32_SINT:()=>dde,VK_FORMAT_R32G32_UINT:()=>hde,VK_FORMAT_R32_SFLOAT:()=>ude,VK_FORMAT_R32_SINT:()=>cde,VK_FORMAT_R32_UINT:()=>lde,VK_FORMAT_R4G4B4A4_UNORM_PACK16:()=>Que,VK_FORMAT_R4G4_UNORM_PACK8:()=>Yue,VK_FORMAT_R5G5B5A1_UNORM_PACK16:()=>the,VK_FORMAT_R5G6B5_UNORM_PACK16:()=>Jue,VK_FORMAT_R64G64B64A64_SFLOAT:()=>Pde,VK_FORMAT_R64G64B64A64_SINT:()=>Dde,VK_FORMAT_R64G64B64A64_UINT:()=>Ade,VK_FORMAT_R64G64B64_SFLOAT:()=>Rde,VK_FORMAT_R64G64B64_SINT:()=>Ede,VK_FORMAT_R64G64B64_UINT:()=>Cde,VK_FORMAT_R64G64_SFLOAT:()=>Tde,VK_FORMAT_R64G64_SINT:()=>Sde,VK_FORMAT_R64G64_UINT:()=>Mde,VK_FORMAT_R64_SFLOAT:()=>wde,VK_FORMAT_R64_SINT:()=>xde,VK_FORMAT_R64_UINT:()=>bde,VK_FORMAT_R8G8B8A8_SINT:()=>Ehe,VK_FORMAT_R8G8B8A8_SNORM:()=>The,VK_FORMAT_R8G8B8A8_SRGB:()=>Rhe,VK_FORMAT_R8G8B8A8_UINT:()=>Che,VK_FORMAT_R8G8B8A8_UNORM:()=>She,VK_FORMAT_R8G8B8_SINT:()=>_he,VK_FORMAT_R8G8B8_SNORM:()=>mhe,VK_FORMAT_R8G8B8_SRGB:()=>vhe,VK_FORMAT_R8G8B8_UINT:()=>ghe,VK_FORMAT_R8G8B8_UNORM:()=>phe,VK_FORMAT_R8G8_SINT:()=>dhe,VK_FORMAT_R8G8_SNORM:()=>uhe,VK_FORMAT_R8G8_SRGB:()=>fhe,VK_FORMAT_R8G8_UINT:()=>hhe,VK_FORMAT_R8G8_UNORM:()=>che,VK_FORMAT_R8_SINT:()=>ahe,VK_FORMAT_R8_SNORM:()=>she,VK_FORMAT_R8_SRGB:()=>lhe,VK_FORMAT_R8_UINT:()=>ohe,VK_FORMAT_R8_UNORM:()=>rhe,VK_FORMAT_S8_UINT:()=>Nde,VK_FORMAT_UNDEFINED:()=>Zue,VK_FORMAT_X8_D24_UNORM_PACK32:()=>Ode,read:()=>xpe,write:()=>Mpe});const vy=_y(i=>function(t){i(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((n,r)=>`${r+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function mm(i,e){if(i){const t=i.indexOf(e);0<=t&&i.splice(t,1)}}class $n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:n}=this;if(cn(n))try{n()}catch(s){e=s instanceof vy?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{Y1(s)}catch(o){e=e??[],o instanceof vy?e=[...e,...o.errors]:e.push(o)}}if(e)throw new vy(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Y1(e);else{if(e instanceof $n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&mm(t,e)}remove(e){const{_finalizers:t}=this;t&&mm(t,e),e instanceof $n&&e._removeParent(this)}}$n.EMPTY=(()=>{const i=new $n;return i.closed=!0,i})();const q1=$n.EMPTY;function Z1(i){return i instanceof $n||i&&"closed"in i&&cn(i.remove)&&cn(i.add)&&cn(i.unsubscribe)}function Y1(i){cn(i)?i():i.unsubscribe()}const Ul={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},gm={setTimeout(i,e,...t){const{delegate:n}=gm;return n?.setTimeout?n.setTimeout(i,e,...t):setTimeout(i,e,...t)},clearTimeout(i){const{delegate:e}=gm;return(e?.clearTimeout||clearTimeout)(i)},delegate:void 0};function Q1(i){gm.setTimeout(()=>{const{onUnhandledError:e}=Ul;if(!e)throw i;e(i)})}function yy(){}const M4=by("C",void 0,void 0);function by(i,e,t){return{kind:i,value:e,error:t}}let Vl=null;function _m(i){if(Ul.useDeprecatedSynchronousErrorHandling){const e=!Vl;if(e&&(Vl={errorThrown:!1,error:null}),i(),e){const{errorThrown:t,error:n}=Vl;if(Vl=null,t)throw n}}else i()}class xy extends $n{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Z1(e)&&e.add(this)):this.destination=D4}static create(e,t,n){return new vm(e,t,n)}next(e){this.isStopped?My(function T4(i){return by("N",i,void 0)}(e),this):this._next(e)}error(e){this.isStopped?My(function S4(i){return by("E",void 0,i)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?My(M4,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const E4=Function.prototype.bind;function wy(i,e){return E4.call(i,e)}class R4{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){ym(n)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){ym(n)}else ym(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){ym(t)}}}class vm extends xy{constructor(e,t,n){let r;if(super(),cn(e)||!e)r={next:e??void 0,error:t??void 0,complete:n??void 0};else{let s;this&&Ul.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&wy(e.next,s),error:e.error&&wy(e.error,s),complete:e.complete&&wy(e.complete,s)}):r=e}this.destination=new R4(r)}}function ym(i){Ul.useDeprecatedSynchronousErrorHandling?function C4(i){Ul.useDeprecatedSynchronousErrorHandling&&Vl&&(Vl.errorThrown=!0,Vl.error=i)}(i):Q1(i)}function My(i,e){const{onStoppedNotification:t}=Ul;t&&gm.setTimeout(()=>t(i,e))}const D4={closed:!0,next:yy,error:function A4(i){throw i},complete:yy},Sy="function"==typeof Symbol&&Symbol.observable||"@@observable";function ja(i){return i}let wn=(()=>{class i{constructor(t){t&&(this._subscribe=t)}lift(t){const n=new i;return n.source=this,n.operator=t,n}subscribe(t,n,r){const s=function I4(i){return i&&i instanceof xy||function P4(i){return i&&cn(i.next)&&cn(i.error)&&cn(i.complete)}(i)&&Z1(i)}(t)?t:new vm(t,n,r);return _m(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return new(n=J1(n))((r,s)=>{const o=new vm({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(t)}[Sy](){return this}pipe(...t){return function $1(i){return 0===i.length?ja:1===i.length?i[0]:function(t){return i.reduce((n,r)=>r(n),t)}}(t)(this)}toPromise(t){return new(t=J1(t))((n,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>n(s))})}}return i.create=e=>new i(e),i})();function J1(i){var e;return null!==(e=i??Ul.Promise)&&void 0!==e?e:Promise}const F4=_y(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Lt=(()=>{class i extends wn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const n=new eE(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new F4}next(t){_m(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(t)}})}error(t){_m(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){_m(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:n,isStopped:r,observers:s}=this;return n||r?q1:(this.currentObservers=null,s.push(t),new $n(()=>{this.currentObservers=null,mm(s,t)}))}_checkFinalizedStatuses(t){const{hasError:n,thrownError:r,isStopped:s}=this;n?t.error(r):s&&t.complete()}asObservable(){const t=new wn;return t.source=this,t}}return i.create=(e,t)=>new eE(e,t),i})();class eE extends Lt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:q1}}function tE(i){return cn(i?.lift)}function ui(i){return e=>{if(tE(e))return e.lift(function(t){try{return i(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function Jn(i,e,t,n,r){return new L4(i,e,t,n,r)}class L4 extends xy{constructor(e,t,n,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function xt(i,e){return ui((t,n)=>{let r=0;t.subscribe(Jn(n,s=>{n.next(i.call(e,s,r++))}))})}function jl(i){return this instanceof jl?(this.v=i,this):new jl(i)}function N4(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,n=t.apply(i,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(d){n[d]&&(r[d]=function(f){return new Promise(function(p,m){s.push([d,f,p,m])>1||a(d,f)})})}function a(d,f){try{!function l(d){d.value instanceof jl?Promise.resolve(d.value.v).then(c,u):h(s[0][2],d)}(n[d](f))}catch(p){h(s[0][3],p)}}function c(d){a("next",d)}function u(d){a("throw",d)}function h(d,f){d(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}function B4(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=i[Symbol.asyncIterator];return e?e.call(i):(i=function rE(i){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=i[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=i[s](o)).done,o.value)})}}}const Cy=i=>i&&"number"==typeof i.length&&"function"!=typeof i;function sE(i){return cn(i?.then)}function oE(i){return cn(i[Sy])}function aE(i){return Symbol.asyncIterator&&cn(i?.[Symbol.asyncIterator])}function lE(i){return new TypeError(`You provided ${null!==i&&"object"==typeof i?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const cE=function V4(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function uE(i){return cn(i?.[cE])}function hE(i){return N4(this,arguments,function*(){const t=i.getReader();try{for(;;){const{value:n,done:r}=yield jl(t.read());if(r)return yield jl(void 0);yield yield jl(n)}}finally{t.releaseLock()}})}function dE(i){return cn(i?.getReader)}function Nr(i){if(i instanceof wn)return i;if(null!=i){if(oE(i))return function j4(i){return new wn(e=>{const t=i[Sy]();if(cn(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(i);if(Cy(i))return function z4(i){return new wn(e=>{for(let t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}(i);if(sE(i))return function H4(i){return new wn(e=>{i.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Q1)})}(i);if(aE(i))return fE(i);if(uE(i))return function G4(i){return new wn(e=>{for(const t of i)if(e.next(t),e.closed)return;e.complete()})}(i);if(dE(i))return function W4(i){return fE(hE(i))}(i)}throw lE(i)}function fE(i){return new wn(e=>{(function X4(i,e){var t,n,r,s;return function O4(i,e,t,n){return new(t||(t=Promise))(function(s,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((n=n.apply(i,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=B4(i);!(n=yield t.next()).done;)if(e.next(n.value),e.closed)return}catch(o){r={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(i,e).catch(t=>e.error(t))})}function ta(i,e,t,n=0,r=!1){const s=e.schedule(function(){t(),r?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(s),!r)return s}function Gi(i,e,t=1/0){return cn(e)?Gi((n,r)=>xt((s,o)=>e(n,s,r,o))(Nr(i(n,r))),t):("number"==typeof e&&(t=e),ui((n,r)=>function K4(i,e,t,n,r,s,o,a){const l=[];let c=0,u=0,h=!1;const d=()=>{h&&!l.length&&!c&&e.complete()},f=m=>c<n?p(m):l.push(m),p=m=>{s&&e.next(m),c++;let g=!1;Nr(t(m,u++)).subscribe(Jn(e,_=>{r?.(_),s?f(_):e.next(_)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;l.length&&c<n;){const _=l.shift();o?ta(e,o,()=>p(_)):p(_)}d()}catch(_){e.error(_)}}))};return i.subscribe(Jn(e,f,()=>{h=!0,d()})),()=>{a?.()}}(n,r,i,t)))}function au(i=1/0){return Gi(ja,i)}const xr=new wn(i=>i.complete());function pE(i){return i&&cn(i.schedule)}function Ey(i){return i[i.length-1]}function Ry(i){return cn(Ey(i))?i.pop():void 0}function Cd(i){return pE(Ey(i))?i.pop():void 0}function mE(i,e=0){return ui((t,n)=>{t.subscribe(Jn(n,r=>ta(n,i,()=>n.next(r),e),()=>ta(n,i,()=>n.complete(),e),r=>ta(n,i,()=>n.error(r),e)))})}function gE(i,e=0){return ui((t,n)=>{n.add(i.schedule(()=>t.subscribe(n),e))})}function _E(i,e){if(!i)throw new Error("Iterable cannot be null");return new wn(t=>{ta(t,e,()=>{const n=i[Symbol.asyncIterator]();ta(t,e,()=>{n.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function _i(i,e){return e?function tz(i,e){if(null!=i){if(oE(i))return function Y4(i,e){return Nr(i).pipe(gE(e),mE(e))}(i,e);if(Cy(i))return function $4(i,e){return new wn(t=>{let n=0;return e.schedule(function(){n===i.length?t.complete():(t.next(i[n++]),t.closed||this.schedule())})})}(i,e);if(sE(i))return function Q4(i,e){return Nr(i).pipe(gE(e),mE(e))}(i,e);if(aE(i))return _E(i,e);if(uE(i))return function J4(i,e){return new wn(t=>{let n;return ta(t,e,()=>{n=i[cE](),ta(t,e,()=>{let r,s;try{({value:r,done:s}=n.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>cn(n?.return)&&n.return()})}(i,e);if(dE(i))return function ez(i,e){return _E(hE(i),e)}(i,e)}throw lE(i)}(i,e):Nr(i)}function lu(...i){const e=Cd(i),t=function Z4(i,e){return"number"==typeof Ey(i)?i.pop():e}(i,1/0),n=i;return n.length?1===n.length?Nr(n[0]):au(t)(_i(n,e)):xr}function Br(i){return i<=0?()=>xr:ui((e,t)=>{let n=0;e.subscribe(Jn(t,r=>{++n<=i&&(t.next(r),i<=n&&t.complete())}))})}function Ay(i={}){const{connector:e=(()=>new Lt),resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:r=!0}=i;return s=>{let o=null,a=null,l=null,c=0,u=!1,h=!1;const d=()=>{a?.unsubscribe(),a=null},f=()=>{d(),o=l=null,u=h=!1},p=()=>{const m=o;f(),m?.unsubscribe()};return ui((m,g)=>{c++,!h&&!u&&d();const _=l=l??e();g.add(()=>{c--,0===c&&!h&&!u&&(a=Dy(p,r))}),_.subscribe(g),o||(o=new vm({next:v=>_.next(v),error:v=>{h=!0,d(),a=Dy(f,t,v),_.error(v)},complete:()=>{u=!0,d(),a=Dy(f,n),_.complete()}}),_i(m).subscribe(o))})(s)}}function Dy(i,e,...t){return!0===e?(i(),null):!1===e?null:e(...t).pipe(Br(1)).subscribe(()=>i())}function Ln(i){for(let e in i)if(i[e]===Ln)return e;throw Error("Could not find renamed property on target object.")}function Py(i,e){for(const t in e)e.hasOwnProperty(t)&&!i.hasOwnProperty(t)&&(i[t]=e[t])}function On(i){if("string"==typeof i)return i;if(Array.isArray(i))return"["+i.map(On).join(", ")+"]";if(null==i)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;const e=i.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Iy(i,e){return null==i||""===i?null===e?"":e:null==e||""===e?i:i+" "+e}const nz=Ln({__forward_ref__:Ln});function qe(i){return i.__forward_ref__=qe,i.toString=function(){return On(this())},i}function Dt(i){return Fy(i)?i():i}function Fy(i){return"function"==typeof i&&i.hasOwnProperty(nz)&&i.__forward_ref__===qe}class et extends Error{constructor(e,t){super(function bm(i,e){return`NG0${Math.abs(i)}${e?": "+e.trim():""}`}(e,t)),this.code=e}}function Nt(i){return"string"==typeof i?i:null==i?"":String(i)}function xm(i,e){throw new et(-201,!1)}function Yr(i,e){null==i&&function Mn(i,e,t,n){throw new Error(`ASSERTION ERROR: ${i}`+(null==n?"":` [Expected=> ${t} ${n} ${e} <=Actual]`))}(e,i,null,"!=")}function We(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function Ut(i){return{providers:i.providers||[],imports:i.imports||[]}}function Ly(i){return vE(i,wm)||vE(i,bE)}function vE(i,e){return i.hasOwnProperty(e)?i[e]:null}function yE(i){return i&&(i.hasOwnProperty(Oy)||i.hasOwnProperty(uz))?i[Oy]:null}const wm=Ln({\u0275prov:Ln}),Oy=Ln({\u0275inj:Ln}),bE=Ln({ngInjectableDef:Ln}),uz=Ln({ngInjectorDef:Ln});var Ct=(()=>((Ct=Ct||{})[Ct.Default=0]="Default",Ct[Ct.Host=1]="Host",Ct[Ct.Self=2]="Self",Ct[Ct.SkipSelf=4]="SkipSelf",Ct[Ct.Optional=8]="Optional",Ct))();let ky;function Co(i){const e=ky;return ky=i,e}function xE(i,e,t){const n=Ly(i);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:t&Ct.Optional?null:void 0!==e?e:void xm(On(i))}function za(i){return{toString:i}.toString()}var Hs=(()=>((Hs=Hs||{})[Hs.OnPush=0]="OnPush",Hs[Hs.Default=1]="Default",Hs))(),Gs=(()=>{return(i=Gs||(Gs={}))[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",Gs;var i})();const Dn=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),cu={},vn=[],Mm=Ln({\u0275cmp:Ln}),Ny=Ln({\u0275dir:Ln}),By=Ln({\u0275pipe:Ln}),wE=Ln({\u0275mod:Ln}),ia=Ln({\u0275fac:Ln}),Ed=Ln({__NG_ELEMENT_ID__:Ln});let dz=0;function De(i){return za(()=>{const t=!0===i.standalone,n={},r={type:i.type,providersResolver:null,decls:i.decls,vars:i.vars,factory:null,template:i.template||null,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:i.exportAs||null,onPush:i.changeDetection===Hs.OnPush,directiveDefs:null,pipeDefs:null,standalone:t,dependencies:t&&i.dependencies||null,getStandaloneInjector:null,selectors:i.selectors||vn,viewQuery:i.viewQuery||null,features:i.features||null,data:i.data||{},encapsulation:i.encapsulation||Gs.Emulated,id:"c"+dz++,styles:i.styles||vn,_:null,setInput:null,schemas:i.schemas||null,tView:null},s=i.dependencies,o=i.features;return r.inputs=TE(i.inputs,n),r.outputs=TE(i.outputs),o&&o.forEach(a=>a(r)),r.directiveDefs=s?()=>("function"==typeof s?s():s).map(ME).filter(SE):null,r.pipeDefs=s?()=>("function"==typeof s?s():s).map(Mr).filter(SE):null,r})}function ME(i){return kn(i)||wr(i)}function SE(i){return null!==i}const pz={};function jt(i){return za(()=>{const e={type:i.type,bootstrap:i.bootstrap||vn,declarations:i.declarations||vn,imports:i.imports||vn,exports:i.exports||vn,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null};return null!=i.id&&(pz[i.id]=i.type),e})}function TE(i,e){if(null==i)return cu;const t={};for(const n in i)if(i.hasOwnProperty(n)){let r=i[n],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=n,e&&(e[r]=s)}return t}const tt=De;function Qi(i){return{type:i.type,name:i.name,factory:null,pure:!1!==i.pure,standalone:!0===i.standalone,onDestroy:i.type.prototype.ngOnDestroy||null}}function kn(i){return i[Mm]||null}function wr(i){return i[Ny]||null}function Mr(i){return i[By]||null}function Qr(i,e){const t=i[wE]||null;if(!t&&!0===e)throw new Error(`Type ${On(i)} does not have '\u0275mod' property.`);return t}function Ur(i){return Array.isArray(i)&&"object"==typeof i[1]}function Xs(i){return Array.isArray(i)&&!0===i[1]}function jy(i){return 0!=(8&i.flags)}function Em(i){return 2==(2&i.flags)}function Rm(i){return 1==(1&i.flags)}function Ks(i){return null!==i.template}function yz(i){return 0!=(256&i[2])}function Xl(i,e){return i.hasOwnProperty(ia)?i[ia]:null}class wz{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function $i(){return RE}function RE(i){return i.type.prototype.ngOnChanges&&(i.setInput=Sz),Mz}function Mz(){const i=DE(this),e=i?.current;if(e){const t=i.previous;if(t===cu)i.previous=e;else for(let n in e)t[n]=e[n];i.current=null,this.ngOnChanges(e)}}function Sz(i,e,t,n){const r=DE(i)||function Tz(i,e){return i[AE]=e}(i,{previous:cu,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[t],l=o[a];s[a]=new wz(l&&l.currentValue,e,o===cu),i[n]=e}$i.ngInherit=!0;const AE="__ngSimpleChanges__";function DE(i){return i[AE]||null}let Xy;function hi(i){return!!i.listen}const PE={createRenderer:(i,e)=>function Ky(){return void 0!==Xy?Xy:typeof document<"u"?document:void 0}()};function Ti(i){for(;Array.isArray(i);)i=i[0];return i}function Am(i,e){return Ti(e[i])}function vs(i,e){return Ti(e[i.index])}function qy(i,e){return i.data[e]}function pu(i,e){return i[e]}function Jr(i,e){const t=e[i];return Ur(t)?t:t[0]}function IE(i){return 4==(4&i[2])}function Zy(i){return 64==(64&i[2])}function Ha(i,e){return null==e?null:i[e]}function FE(i){i[18]=0}function Yy(i,e){i[5]+=e;let t=i,n=i[3];for(;null!==n&&(1===e&&1===t[5]||-1===e&&0===t[5]);)n[5]+=e,t=n,n=n[3]}const Ot={lFrame:zE(null),bindingsEnabled:!0};function OE(){return Ot.bindingsEnabled}function be(){return Ot.lFrame.lView}function un(){return Ot.lFrame.tView}function Vr(i){return Ot.lFrame.contextLView=i,i[8]}function jr(i){return Ot.lFrame.contextLView=null,i}function ki(){let i=kE();for(;null!==i&&64===i.type;)i=i.parent;return i}function kE(){return Ot.lFrame.currentTNode}function Eo(i,e){const t=Ot.lFrame;t.currentTNode=i,t.isParent=e}function Qy(){return Ot.lFrame.isParent}function $y(){Ot.lFrame.isParent=!1}function Sr(){const i=Ot.lFrame;let e=i.bindingRootIndex;return-1===e&&(e=i.bindingRootIndex=i.tView.bindingStartIndex),e}function mu(){return Ot.lFrame.bindingIndex++}function zz(i,e){const t=Ot.lFrame;t.bindingIndex=t.bindingRootIndex=i,Jy(e)}function Jy(i){Ot.lFrame.currentDirectiveIndex=i}function eb(i){const e=Ot.lFrame.currentDirectiveIndex;return-1===e?null:i[e]}function UE(){return Ot.lFrame.currentQueryIndex}function tb(i){Ot.lFrame.currentQueryIndex=i}function Gz(i){const e=i[1];return 2===e.type?e.declTNode:1===e.type?i[6]:null}function VE(i,e,t){if(t&Ct.SkipSelf){let r=e,s=i;for(;!(r=r.parent,null!==r||t&Ct.Host||(r=Gz(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,i=s}const n=Ot.lFrame=jE();return n.currentTNode=e,n.lView=i,!0}function Pm(i){const e=jE(),t=i[1];Ot.lFrame=e,e.currentTNode=t.firstChild,e.lView=i,e.tView=t,e.contextLView=i,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function jE(){const i=Ot.lFrame,e=null===i?null:i.child;return null===e?zE(i):e}function zE(i){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return null!==i&&(i.child=e),e}function HE(){const i=Ot.lFrame;return Ot.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}const GE=HE;function Im(){const i=HE();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function Tr(){return Ot.lFrame.selectedIndex}function Ga(i){Ot.lFrame.selectedIndex=i}function di(){const i=Ot.lFrame;return qy(i.tView,i.selectedIndex)}function Fm(i,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){const s=i.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(i.contentHooks||(i.contentHooks=[])).push(-t,o),a&&((i.contentHooks||(i.contentHooks=[])).push(t,a),(i.contentCheckHooks||(i.contentCheckHooks=[])).push(t,a)),l&&(i.viewHooks||(i.viewHooks=[])).push(-t,l),c&&((i.viewHooks||(i.viewHooks=[])).push(t,c),(i.viewCheckHooks||(i.viewCheckHooks=[])).push(t,c)),null!=u&&(i.destroyHooks||(i.destroyHooks=[])).push(t,u)}}function Lm(i,e,t){WE(i,e,3,t)}function Om(i,e,t,n){(3&i[2])===t&&WE(i,e,t,n)}function nb(i,e){let t=i[2];(3&t)===e&&(t&=2047,t+=1,i[2]=t)}function WE(i,e,t,n){const s=n??-1,o=e.length-1;let a=0;for(let l=void 0!==n?65535&i[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=n&&a>=n)break}else e[l]<0&&(i[18]+=65536),(a<s||-1==s)&&(Jz(i,t,e,l),i[18]=(4294901760&i[18])+l+2),l++}function Jz(i,e,t,n){const r=t[n]<0,s=t[n+1],a=i[r?-t[n]:t[n]];if(r){if(i[2]>>11<i[18]>>16&&(3&i[2])===e){i[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class Id{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function km(i,e,t){const n=hi(i);let r=0;for(;r<t.length;){const s=t[r];if("number"==typeof s){if(0!==s)break;r++;const o=t[r++],a=t[r++],l=t[r++];n?i.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++r];rb(o)?n&&i.setProperty(e,o,a):n?i.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function XE(i){return 3===i||4===i||6===i}function rb(i){return 64===i.charCodeAt(0)}function Nm(i,e){if(null!==e&&0!==e.length)if(null===i||0===i.length)i=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){const r=e[n];"number"==typeof r?t=r:0===t||KE(i,t,r,null,-1===t||2===t?e[++n]:null)}}return i}function KE(i,e,t,n,r){let s=0,o=i.length;if(-1===e)o=-1;else for(;s<i.length;){const a=i[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<i.length;){const a=i[s];if("number"==typeof a)break;if(a===t){if(null===n)return void(null!==r&&(i[s+1]=r));if(n===i[s+1])return void(i[s+2]=r)}s++,null!==n&&s++,null!==r&&s++}-1!==o&&(i.splice(o,0,e),s=o+1),i.splice(s++,0,t),null!==n&&i.splice(s++,0,n),null!==r&&i.splice(s++,0,r)}function qE(i){return-1!==i}function gu(i){return 32767&i}function _u(i,e){let t=function s5(i){return i>>16}(i),n=e;for(;t>0;)n=n[15],t--;return n}let sb=!0;function Bm(i){const e=sb;return sb=i,e}let o5=0;const Ro={};function Ld(i,e){const t=ab(i,e);if(-1!==t)return t;const n=e[1];n.firstCreatePass&&(i.injectorIndex=e.length,ob(n.data,i),ob(e,null),ob(n.blueprint,null));const r=Um(i,e),s=i.injectorIndex;if(qE(r)){const o=gu(r),a=_u(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function ob(i,e){i.push(0,0,0,0,0,0,0,0,e)}function ab(i,e){return-1===i.injectorIndex||i.parent&&i.parent.injectorIndex===i.injectorIndex||null===e[i.injectorIndex+8]?-1:i.injectorIndex}function Um(i,e){if(i.parent&&-1!==i.parent.injectorIndex)return i.parent.injectorIndex;let t=0,n=null,r=e;for(;null!==r;){if(n=iR(r),null===n)return-1;if(t++,r=r[15],-1!==n.injectorIndex)return n.injectorIndex|t<<16}return-1}function Vm(i,e,t){!function a5(i,e,t){let n;"string"==typeof t?n=t.charCodeAt(0)||0:t.hasOwnProperty(Ed)&&(n=t[Ed]),null==n&&(n=t[Ed]=o5++);const r=255&n;e.data[i+(r>>5)]|=1<<r}(i,e,t)}function QE(i,e,t){if(t&Ct.Optional)return i;xm()}function $E(i,e,t,n){if(t&Ct.Optional&&void 0===n&&(n=null),0==(t&(Ct.Self|Ct.Host))){const r=i[9],s=Co(void 0);try{return r?r.get(e,n,t&Ct.Optional):xE(e,n,t&Ct.Optional)}finally{Co(s)}}return QE(n,0,t)}function JE(i,e,t,n=Ct.Default,r){if(null!==i){if(1024&e[2]){const o=function d5(i,e,t,n,r){let s=i,o=e;for(;null!==s&&null!==o&&1024&o[2]&&!(256&o[2]);){const a=eR(s,o,t,n|Ct.Self,Ro);if(a!==Ro)return a;let l=s.parent;if(!l){const c=o[21];if(c){const u=c.get(t,Ro,n);if(u!==Ro)return u}l=iR(o),o=o[15]}s=l}return r}(i,e,t,n,Ro);if(o!==Ro)return o}const s=eR(i,e,t,n,Ro);if(s!==Ro)return s}return $E(e,t,n,r)}function eR(i,e,t,n,r){const s=function u5(i){if("string"==typeof i)return i.charCodeAt(0)||0;const e=i.hasOwnProperty(Ed)?i[Ed]:void 0;return"number"==typeof e?e>=0?255&e:h5:e}(t);if("function"==typeof s){if(!VE(e,i,n))return n&Ct.Host?QE(r,0,n):$E(e,t,n,r);try{const o=s(n);if(null!=o||n&Ct.Optional)return o;xm()}finally{GE()}}else if("number"==typeof s){let o=null,a=ab(i,e),l=-1,c=n&Ct.Host?e[16][6]:null;for((-1===a||n&Ct.SkipSelf)&&(l=-1===a?Um(i,e):e[a+8],-1!==l&&nR(n,!1)?(o=e[1],a=gu(l),e=_u(l,e)):a=-1);-1!==a;){const u=e[1];if(tR(s,a,u.data)){const h=c5(a,e,t,o,n,c);if(h!==Ro)return h}l=e[a+8],-1!==l&&nR(n,e[1].data[a+8]===c)&&tR(s,a,e)?(o=u,a=gu(l),e=_u(l,e)):a=-1}}return r}function c5(i,e,t,n,r,s){const o=e[1],a=o.data[i+8],u=jm(a,o,t,null==n?Em(a)&&sb:n!=o&&0!=(3&a.type),r&Ct.Host&&s===a);return null!==u?Od(e,o,u,a):Ro}function jm(i,e,t,n,r){const s=i.providerIndexes,o=e.data,a=1048575&s,l=i.directiveStart,u=s>>20,d=r?a+u:i.directiveEnd;for(let f=n?a:a+u;f<d;f++){const p=o[f];if(f<l&&t===p||f>=l&&p.type===t)return f}if(r){const f=o[l];if(f&&Ks(f)&&f.type===t)return l}return null}function Od(i,e,t,n){let r=i[t];const s=e.data;if(function e5(i){return i instanceof Id}(r)){const o=r;o.resolving&&function iz(i,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${i}`:"";throw new et(-200,`Circular dependency in DI detected for ${i}${t}`)}(function _n(i){return"function"==typeof i?i.name||i.toString():"object"==typeof i&&null!=i&&"function"==typeof i.type?i.type.name||i.type.toString():Nt(i)}(s[t]));const a=Bm(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Co(o.injectImpl):null;VE(i,n,Ct.Default);try{r=i[t]=o.factory(void 0,s,i,n),e.firstCreatePass&&t>=n.directiveStart&&function $z(i,e,t){const{ngOnChanges:n,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(n){const o=RE(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(i,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(i,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-i,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(i,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(i,s))}(t,s[t],e)}finally{null!==l&&Co(l),Bm(a),o.resolving=!1,GE()}}return r}function tR(i,e,t){return!!(t[e+(i>>5)]&1<<i)}function nR(i,e){return!(i&Ct.Self||i&Ct.Host&&e)}class vu{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return JE(this._tNode,this._lView,e,n,t)}}function h5(){return new vu(ki(),be())}function pt(i){return za(()=>{const e=i.prototype.constructor,t=e[ia]||lb(e),n=Object.prototype;let r=Object.getPrototypeOf(i.prototype).constructor;for(;r&&r!==n;){const s=r[ia]||lb(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function lb(i){return Fy(i)?()=>{const e=lb(Dt(i));return e&&e()}:Xl(i)}function iR(i){const e=i[1],t=e.type;return 2===t?e.declTNode:1===t?i[6]:null}function Kl(i){return function l5(i,e){if("class"===e)return i.classes;if("style"===e)return i.styles;const t=i.attrs;if(t){const n=t.length;let r=0;for(;r<n;){const s=t[r];if(XE(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<n&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(ki(),i)}const bu="__parameters__";function wu(i,e,t){return za(()=>{const n=function cb(i){return function(...t){if(i){const n=i(...t);for(const r in n)this[r]=n[r]}}}(e);function r(...s){if(this instanceof r)return n.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const h=l.hasOwnProperty(bu)?l[bu]:Object.defineProperty(l,bu,{value:[]})[bu];for(;h.length<=u;)h.push(null);return(h[u]=h[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=i,r.annotationCls=r,r})}class He{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=We({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const p5=new He("AnalyzeForEntryComponents");function es(i,e){void 0===e&&(e=i);for(let t=0;t<i.length;t++){let n=i[t];Array.isArray(n)?(e===i&&(e=i.slice(0,t)),es(n,e)):e!==i&&e.push(n)}return e}function oa(i,e){i.forEach(t=>Array.isArray(t)?oa(t,e):e(t))}function sR(i,e,t){e>=i.length?i.push(t):i.splice(e,0,t)}function zm(i,e){return e>=i.length-1?i.pop():i.splice(e,1)[0]}function Bd(i,e){const t=[];for(let n=0;n<i;n++)t.push(e);return t}function ts(i,e,t){let n=Mu(i,e);return n>=0?i[1|n]=t:(n=~n,function _5(i,e,t,n){let r=i.length;if(r==e)i.push(t,n);else if(1===r)i.push(n,i[0]),i[0]=t;else{for(r--,i.push(i[r-1],i[r]);r>e;)i[r]=i[r-2],r--;i[e]=t,i[e+1]=n}}(i,n,e,t)),n}function hb(i,e){const t=Mu(i,e);if(t>=0)return i[1|t]}function Mu(i,e){return function lR(i,e,t){let n=0,r=i.length>>t;for(;r!==n;){const s=n+(r-n>>1),o=i[s<<t];if(e===o)return s<<t;o>e?r=s:n=s+1}return~(r<<t)}(i,e,1)}const Ud={},fb="__NG_DI_FLAG__",Gm="ngTempTokenPath",T5=/\n/gm,cR="__source";let Vd;function Wm(i){const e=Vd;return Vd=i,e}function E5(i,e=Ct.Default){if(void 0===Vd)throw new et(-203,"");return null===Vd?xE(i,void 0,e):Vd.get(i,e&Ct.Optional?null:void 0,e)}function re(i,e=Ct.Default){return(function hz(){return ky}()||E5)(Dt(i),e)}function ql(i,e=Ct.Default){return re(i,e)}function pb(i){const e=[];for(let t=0;t<i.length;t++){const n=Dt(i[t]);if(Array.isArray(n)){if(0===n.length)throw new et(900,"");let r,s=Ct.Default;for(let o=0;o<n.length;o++){const a=n[o],l=R5(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(re(r,s))}else e.push(re(n))}return e}function jd(i,e){return i[fb]=e,i.prototype[fb]=e,i}function R5(i){return i[fb]}const Xm=jd(wu("Inject",i=>({token:i})),-1),ys=jd(wu("Optional"),8),Su=jd(wu("SkipSelf"),4);let Zm;function Cu(i){return function mb(){if(void 0===Zm&&(Zm=null,Dn.trustedTypes))try{Zm=Dn.trustedTypes.createPolicy("angular",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch{}return Zm}()?.createHTML(i)||i}class Zl{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class z5 extends Zl{getTypeName(){return"HTML"}}class H5 extends Zl{getTypeName(){return"Style"}}class G5 extends Zl{getTypeName(){return"Script"}}class W5 extends Zl{getTypeName(){return"URL"}}class X5 extends Zl{getTypeName(){return"ResourceURL"}}function ns(i){return i instanceof Zl?i.changingThisBreaksApplicationSecurity:i}function Ao(i,e){const t=xR(i);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see https://g.co/ng/security#xss)`)}return t===e}function xR(i){return i instanceof Zl&&i.getTypeName()||null}class $5{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(Cu(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class J5{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const n=this.inertDocument.createElement("body");t.appendChild(n)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=Cu(e),t;const n=this.inertDocument.createElement("body");return n.innerHTML=Cu(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(e){const t=e.attributes;for(let r=t.length-1;0<r;r--){const o=t.item(r).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&e.removeAttribute(o)}let n=e.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const tH=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,nH=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Gd(i){return(i=String(i)).match(tH)||i.match(nH)?i:"unsafe:"+i}function MR(i){return(i=String(i)).split(",").map(e=>Gd(e.trim())).join(", ")}function Do(i){const e={};for(const t of i.split(","))e[t]=!0;return e}function Wd(...i){const e={};for(const t of i)for(const n in t)t.hasOwnProperty(n)&&(e[n]=!0);return e}const SR=Do("area,br,col,hr,img,wbr"),TR=Do("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),CR=Do("rp,rt"),_b=Wd(SR,Wd(TR,Do("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Wd(CR,Do("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Wd(CR,TR)),vb=Do("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),yb=Do("srcset"),ER=Wd(vb,yb,Do("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Do("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),iH=Do("script,style,template");class rH{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!_b.hasOwnProperty(t))return this.sanitizedSomething=!0,!iH.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let r=0;r<n.length;r++){const s=n.item(r),o=s.name,a=o.toLowerCase();if(!ER.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;vb[a]&&(l=Gd(l)),yb[a]&&(l=MR(l)),this.buf.push(" ",o,'="',RR(l),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();_b.hasOwnProperty(t)&&!SR.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(RR(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const sH=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,oH=/([^\#-~ |!])/g;function RR(i){return i.replace(/&/g,"&amp;").replace(sH,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(oH,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Qm;function AR(i,e){let t=null;try{Qm=Qm||function wR(i){const e=new J5(i);return function eH(){try{return!!(new window.DOMParser).parseFromString(Cu(""),"text/html")}catch{return!1}}()?new $5(e):e}(i);let n=e?String(e):"";t=Qm.getInertBodyElement(n);let r=5,s=n;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,n=s,s=t.innerHTML,t=Qm.getInertBodyElement(n)}while(n!==s);return Cu((new rH).sanitizeChildren(bb(t)||t))}finally{if(t){const n=bb(t)||t;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function bb(i){return"content"in i&&function aH(i){return i.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===i.nodeName}(i)?i.content:null}var pn=(()=>((pn=pn||{})[pn.NONE=0]="NONE",pn[pn.HTML=1]="HTML",pn[pn.STYLE=2]="STYLE",pn[pn.SCRIPT=3]="SCRIPT",pn[pn.URL=4]="URL",pn[pn.RESOURCE_URL=5]="RESOURCE_URL",pn))();function xb(i){const e=function Xd(){const i=be();return i&&i[12]}();return e?e.sanitize(pn.URL,i)||"":Ao(i,"URL")?ns(i):Gd(Nt(i))}function Mb(i){return i.ngOriginalError}class aa{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Mb(e);for(;t&&Mb(t);)t=Mb(t);return t||null}}const Sb=new Map;let MH=0;const Cb="__ngContext__";function ur(i,e){Ur(e)?(i[Cb]=e[20],function TH(i){Sb.set(i[20],i)}(e)):i[Cb]=e}function Kd(i){const e=i[Cb];return"number"==typeof e?function IR(i){return Sb.get(i)||null}(e):e||null}function Eb(i){const e=Kd(i);return e?Ur(e)?e:e.lView:null}const LH=(()=>(typeof requestAnimationFrame<"u"&&requestAnimationFrame||setTimeout).bind(Dn))();function Rb(i){return i.ownerDocument.defaultView}function $m(i){return i.ownerDocument}function la(i){return i instanceof Function?i():i}var is=(()=>((is=is||{})[is.Important=1]="Important",is[is.DashCase=2]="DashCase",is))();function Db(i,e){return undefined(i,e)}function qd(i){const e=i[3];return Xs(e)?e[3]:e}function Pb(i){return jR(i[13])}function Ib(i){return jR(i[4])}function jR(i){for(;null!==i&&!Xs(i);)i=i[4];return i}function Ru(i,e,t,n,r){if(null!=n){let s,o=!1;Xs(n)?s=n:Ur(n)&&(o=!0,n=n[0]);const a=Ti(n);0===i&&null!==t?null==r?KR(e,t,a):Yl(e,t,a,r||null,!0):1===i&&null!==t?Yl(e,t,a,r||null,!0):2===i?function tA(i,e,t){const n=Jm(i,e);n&&function KH(i,e,t,n){hi(i)?i.removeChild(e,t,n):e.removeChild(t)}(i,n,e,t)}(e,a,o):3===i&&e.destroyNode(a),null!=s&&function YH(i,e,t,n,r){const s=t[7];s!==Ti(t)&&Ru(e,i,n,s,r);for(let a=10;a<t.length;a++){const l=t[a];Zd(l[1],l,i,e,n,s)}}(e,i,s,t,r)}}function Lb(i,e,t){if(hi(i))return i.createElement(e,t);{const n=null!==t?function Az(i){const e=i.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(t):null;return null===n?i.createElement(e):i.createElementNS(n,e)}}function HR(i,e){const t=i[9],n=t.indexOf(e),r=e[3];512&e[2]&&(e[2]&=-513,Yy(r,-1)),t.splice(n,1)}function Ob(i,e){if(i.length<=10)return;const t=10+e,n=i[t];if(n){const r=n[17];null!==r&&r!==i&&HR(r,n),e>0&&(i[t-1][4]=n[4]);const s=zm(i,10+e);!function UH(i,e){Zd(i,e,e[11],2,null,null),e[0]=null,e[6]=null}(n[1],n);const o=s[19];null!==o&&o.detachView(s[1]),n[3]=null,n[4]=null,n[2]&=-65}return n}function GR(i,e){if(!(128&e[2])){const t=e[11];hi(t)&&t.destroyNode&&Zd(i,e,t,3,null,null),function zH(i){let e=i[13];if(!e)return kb(i[1],i);for(;e;){let t=null;if(Ur(e))t=e[13];else{const n=e[10];n&&(t=n)}if(!t){for(;e&&!e[4]&&e!==i;)Ur(e)&&kb(e[1],e),e=e[3];null===e&&(e=i),Ur(e)&&kb(e[1],e),t=e&&e[4]}e=t}}(e)}}function kb(i,e){if(!(128&e[2])){e[2]&=-65,e[2]|=128,function XH(i,e){let t;if(null!=i&&null!=(t=i.destroyHooks))for(let n=0;n<t.length;n+=2){const r=e[t[n]];if(!(r instanceof Id)){const s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(i,e),function WH(i,e){const t=i.cleanup,n=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):Ti(e[o]),l=n[r=t[s+2]],c=t[s+3];"boolean"==typeof c?a.removeEventListener(t[s],l,c):c>=0?n[r=c]():n[r=-c].unsubscribe(),s+=2}else{const o=n[r=t[s+1]];t[s].call(o)}if(null!==n){for(let s=r+1;s<n.length;s++)n[s]();e[7]=null}}(i,e),1===e[1].type&&hi(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&Xs(e[3])){t!==e[3]&&HR(t,e);const n=e[19];null!==n&&n.detachView(i)}!function CH(i){Sb.delete(i[20])}(e)}}function WR(i,e,t){return function XR(i,e,t){let n=e;for(;null!==n&&40&n.type;)n=(e=n).parent;if(null===n)return t[0];if(2&n.flags){const r=i.data[n.directiveStart].encapsulation;if(r===Gs.None||r===Gs.Emulated)return null}return vs(n,t)}(i,e.parent,t)}function Yl(i,e,t,n,r){hi(i)?i.insertBefore(e,t,n,r):(ZR(e)?e.content:e).insertBefore(t,n,r)}function KR(i,e,t){hi(i)?i.appendChild(e,t):(ZR(e)?e.content:e).appendChild(t)}function qR(i,e,t,n,r){null!==n?Yl(i,e,t,n,r):KR(i,e,t)}function ZR(i){return"TEMPLATE"===i.tagName&&void 0!==i.content}function Jm(i,e){return hi(i)?i.parentNode(e):e.parentNode}function YR(i,e,t){return $R(i,e,t)}let $R=function QR(i,e,t){return 40&i.type?vs(i,t):null};function eg(i,e,t,n){const r=WR(i,n,e),s=e[11],a=YR(n.parent||e[6],n,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)qR(s,r,t[l],a,!1);else qR(s,r,t,a,!1)}function tg(i,e){if(null!==e){const t=e.type;if(3&t)return vs(e,i);if(4&t)return Bb(-1,i[e.index]);if(8&t){const n=e.child;if(null!==n)return tg(i,n);{const r=i[e.index];return Xs(r)?Bb(-1,r):Ti(r)}}if(32&t)return Db(e,i)()||Ti(i[e.index]);{const n=eA(i,e);return null!==n?Array.isArray(n)?n[0]:tg(qd(i[16]),n):tg(i,e.next)}}return null}function eA(i,e){return null!==e?i[16][6].projection[e.projection]:null}function Bb(i,e){const t=10+i+1;if(t<e.length){const n=e[t],r=n[1].firstChild;if(null!==r)return tg(n,r)}return e[7]}function Ub(i,e,t,n,r,s,o){for(;null!=t;){const a=n[t.index],l=t.type;if(o&&0===e&&(a&&ur(Ti(a),n),t.flags|=4),64!=(64&t.flags))if(8&l)Ub(i,e,t.child,n,r,s,!1),Ru(e,i,r,a,s);else if(32&l){const c=Db(t,n);let u;for(;u=c();)Ru(e,i,r,u,s);Ru(e,i,r,a,s)}else 16&l?nA(i,e,n,t,r,s):Ru(e,i,r,a,s);t=o?t.projectionNext:t.next}}function Zd(i,e,t,n,r,s){Ub(t,n,i.firstChild,e,r,s,!1)}function nA(i,e,t,n,r,s){const o=t[16],l=o[6].projection[n.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Ru(e,i,r,l[c],s);else Ub(i,e,l,o[3],r,s,!0)}function iA(i,e,t){hi(i)?i.setAttribute(e,"style",t):e.style.cssText=t}function Vb(i,e,t){hi(i)?""===t?i.removeAttribute(e,"class"):i.setAttribute(e,"class",t):e.className=t}function rA(i,e,t){let n=i.length;for(;;){const r=i.indexOf(e,t);if(-1===r)return r;if(0===r||i.charCodeAt(r-1)<=32){const s=e.length;if(r+s===n||i.charCodeAt(r+s)<=32)return r}t=r+1}}const sA="ng-template";function $H(i,e,t){let n=0;for(;n<i.length;){let r=i[n++];if(t&&"class"===r){if(r=i[n],-1!==rA(r.toLowerCase(),e,0))return!0}else if(1===r){for(;n<i.length&&"string"==typeof(r=i[n++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function oA(i){return 4===i.type&&i.value!==sA}function JH(i,e,t){return e===(4!==i.type||t?i.value:sA)}function eG(i,e,t){let n=4;const r=i.attrs||[],s=function iG(i){for(let e=0;e<i.length;e++)if(XE(i[e]))return e;return i.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&n){if(n=2|1&n,""!==l&&!JH(i,l,t)||""===l&&1===e.length){if(qs(n))return!1;o=!0}}else{const c=8&n?l:e[++a];if(8&n&&null!==i.attrs){if(!$H(i.attrs,c,t)){if(qs(n))return!1;o=!0}continue}const h=tG(8&n?"class":l,r,oA(i),t);if(-1===h){if(qs(n))return!1;o=!0;continue}if(""!==c){let d;d=h>s?"":r[h+1].toLowerCase();const f=8&n?d:null;if(f&&-1!==rA(f,c,0)||2&n&&c!==d){if(qs(n))return!1;o=!0}}}}else{if(!o&&!qs(n)&&!qs(l))return!1;if(o&&qs(l))continue;o=!1,n=l|1&n}}return qs(n)||o}function qs(i){return 0==(1&i)}function tG(i,e,t,n){if(null===e)return-1;let r=0;if(n||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===i)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function rG(i,e){let t=i.indexOf(4);if(t>-1)for(t++;t<i.length;){const n=i[t];if("number"==typeof n)return-1;if(n===e)return t;t++}return-1}(e,i)}function aA(i,e,t=!1){for(let n=0;n<e.length;n++)if(eG(i,e[n],t))return!0;return!1}function sG(i,e){e:for(let t=0;t<e.length;t++){const n=e[t];if(i.length===n.length){for(let r=0;r<i.length;r++)if(i[r]!==n[r])continue e;return!0}}return!1}function lA(i,e){return i?":not("+e.trim()+")":e}function oG(i){let e=i[0],t=1,n=2,r="",s=!1;for(;t<i.length;){let o=i[t];if("string"==typeof o)if(2&n){const a=i[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&n?r+="."+o:4&n&&(r+=" "+o);else""!==r&&!qs(o)&&(e+=lA(s,r),r=""),n=o,s=s||!qs(n);t++}return""!==r&&(e+=lA(s,r)),e}const Bt={};function se(i){cA(un(),be(),Tr()+i,!1)}function cA(i,e,t,n){if(!n)if(3==(3&e[2])){const s=i.preOrderCheckHooks;null!==s&&Lm(e,s,t)}else{const s=i.preOrderHooks;null!==s&&Om(e,s,0,t)}Ga(t)}const fA=new He("ENVIRONMENT_INITIALIZER"),pA=new He("INJECTOR_DEF_TYPES");function pG(...i){return{\u0275providers:mA(0,i)}}function mA(i,...e){const t=[],n=new Set;let r;return oa(e,s=>{const o=s;jb(o,t,[],n)&&(r||(r=[]),r.push(o))}),void 0!==r&&gA(r,t),t}function gA(i,e){for(let t=0;t<i.length;t++){const{providers:r}=i[t];oa(r,s=>{e.push(s)})}}function jb(i,e,t,n){if(!(i=Dt(i)))return!1;let r=null,s=yE(i);const o=!s&&kn(i);if(s||o){if(o&&!o.standalone)return!1;r=i}else{const l=i.ngModule;if(s=yE(l),!s)return!1;r=l}const a=n.has(r);if(o){if(a)return!1;if(n.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)jb(c,e,t,n)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;n.add(r);try{oa(s.imports,u=>{jb(u,e,t,n)&&(c||(c=[]),c.push(u))})}finally{}void 0!==c&&gA(c,e)}if(!a){const c=Xl(r)||(()=>new r);e.push({provide:r,useFactory:c,deps:vn},{provide:pA,useValue:r,multi:!0},{provide:fA,useValue:()=>re(r),multi:!0})}const l=s.providers;null==l||a||oa(l,u=>{e.push(u)})}}return r!==i&&void 0!==i.providers}const mG=Ln({provide:String,useValue:Ln});function zb(i){return null!==i&&"object"==typeof i&&mG in i}function Ql(i){return"function"==typeof i}const Hb=new He("INJECTOR",-1);class yA{get(e,t=Ud){if(t===Ud){const n=new Error(`NullInjectorError: No provider for ${On(e)}!`);throw n.name="NullInjectorError",n}return t}}const Gb=new He("Set Injector scope."),ng={},_G={};let Wb;function Xb(){return void 0===Wb&&(Wb=new yA),Wb}class $l{}class bA extends $l{constructor(e,t,n,r){super(),this.parent=t,this.source=n,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,qb(e,o=>this.processProvider(o)),this.records.set(Hb,Au(void 0,this)),r.has("environment")&&this.records.set($l,Au(void 0,this));const s=this.records.get(Gb);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(pA.multi,vn,Ct.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}get(e,t=Ud,n=Ct.Default){this.assertNotDestroyed();const r=Wm(this),s=Co(void 0);try{if(!(n&Ct.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function wG(i){return"function"==typeof i||"object"==typeof i&&i instanceof He}(e)&&Ly(e);a=l&&this.injectableDefInScope(l)?Au(Kb(e),ng):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(n&Ct.Self?Xb():this.parent).get(e,t=n&Ct.Optional&&t===Ud?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Gm]=o[Gm]||[]).unshift(On(e)),r)throw o;return function A5(i,e,t,n){const r=i[Gm];throw e[cR]&&r.unshift(e[cR]),i.message=function D5(i,e,t,n=null){i=i&&"\n"===i.charAt(0)&&"\u0275"==i.charAt(1)?i.slice(2):i;let r=On(e);if(Array.isArray(e))r=e.map(On).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):On(a)))}r=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${r}]: ${i.replace(T5,"\n  ")}`}("\n"+i.message,r,t,n),i.ngTokenPath=r,i[Gm]=null,i}(o,e,"R3InjectorError",this.source)}throw o}finally{Co(s),Wm(r)}}resolveInjectorInitializers(){const e=Wm(this),t=Co(void 0);try{const n=this.get(fA.multi,vn,Ct.Self);for(const r of n)r()}finally{Wm(e),Co(t)}}toString(){const e=[],t=this.records;for(const n of t.keys())e.push(On(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new et(205,!1)}processProvider(e){let t=Ql(e=Dt(e))?e:Dt(e&&e.provide);const n=function yG(i){return zb(i)?Au(void 0,i.useValue):Au(xA(i),ng)}(e);if(Ql(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=Au(void 0,ng,!0),r.factory=()=>pb(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,n)}hydrate(e,t){return t.value===ng&&(t.value=_G,t.value=t.factory()),"object"==typeof t.value&&t.value&&function xG(i){return null!==i&&"object"==typeof i&&"function"==typeof i.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Dt(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}}function Kb(i){const e=Ly(i),t=null!==e?e.factory:Xl(i);if(null!==t)return t;if(i instanceof He)throw new et(204,!1);if(i instanceof Function)return function vG(i){const e=i.length;if(e>0)throw Bd(e,"?"),new et(204,!1);const t=function lz(i){const e=i&&(i[wm]||i[bE]);if(e){const t=function cz(i){if(i.hasOwnProperty("name"))return i.name;const e=(""+i).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(i);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(i);return null!==t?()=>t.factory(i):()=>new i}(i);throw new et(204,!1)}function xA(i,e,t){let n;if(Ql(i)){const r=Dt(i);return Xl(r)||Kb(r)}if(zb(i))n=()=>Dt(i.useValue);else if(function vA(i){return!(!i||!i.useFactory)}(i))n=()=>i.useFactory(...pb(i.deps||[]));else if(function _A(i){return!(!i||!i.useExisting)}(i))n=()=>re(Dt(i.useExisting));else{const r=Dt(i&&(i.useClass||i.provide));if(!function bG(i){return!!i.deps}(i))return Xl(r)||Kb(r);n=()=>new r(...pb(i.deps))}return n}function Au(i,e,t=!1){return{factory:i,value:e,multi:t?[]:void 0}}function MG(i){return!!i.\u0275providers}function qb(i,e){for(const t of i)Array.isArray(t)?qb(t,e):MG(t)?qb(t.\u0275providers,e):e(t)}function wA(i,e=null,t=null,n){const r=MA(i,e,t,n);return r.resolveInjectorInitializers(),r}function MA(i,e=null,t=null,n,r=new Set){const s=[t||vn,pG(i)];return n=n||("object"==typeof i?void 0:On(i)),new bA(s,e||Xb(),n||null,r)}let Xi=(()=>{class i{static create(t,n){if(Array.isArray(t))return wA({name:""},n,t,"");{const r=t.name??"";return wA({name:r},t.parent,t.providers,r)}}}return i.THROW_IF_NOT_FOUND=Ud,i.NULL=new yA,i.\u0275prov=We({token:i,providedIn:"any",factory:()=>re(Hb)}),i.__NG_ELEMENT_ID__=-1,i})();function N(i,e=Ct.Default){const t=be();return null===t?re(i,e):JE(ki(),t,Dt(i),e)}function rg(){throw new Error("invalid")}function sg(i,e){return i<<17|e<<2}function Zs(i){return i>>17&32767}function nx(i){return 2|i}function ca(i){return(131068&i)>>2}function ix(i,e){return-131069&i|e<<2}function rx(i){return 1|i}function HA(i,e){const t=i.contentQueries;if(null!==t)for(let n=0;n<t.length;n+=2){const r=t[n],s=t[n+1];if(-1!==s){const o=i.data[s];tb(r),o.contentQueries(2,e[s],s)}}}function Yd(i,e,t,n,r,s,o,a,l,c,u){const h=e.blueprint.slice();return h[0]=r,h[2]=76|n,(null!==u||i&&1024&i[2])&&(h[2]|=1024),FE(h),h[3]=h[15]=i,h[8]=t,h[10]=o||i&&i[10],h[11]=a||i&&i[11],h[12]=l||i&&i[12]||null,h[9]=c||i&&i[9]||null,h[6]=s,h[20]=function SH(){return MH++}(),h[21]=u,h[16]=2==e.type?i[16]:h,h}function Pu(i,e,t,n,r){let s=i.data[e];if(null===s)s=function fx(i,e,t,n,r){const s=kE(),o=Qy(),l=i.data[e]=function t8(i,e,t,n,r,s){return{type:t,index:n,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,n,r);return null===i.firstChild&&(i.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(i,e,t,n,r),function jz(){return Ot.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=n,s.attrs=r;const o=function Pd(){const i=Ot.lFrame,e=i.currentTNode;return i.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Eo(s,!0),s}function Iu(i,e,t,n){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(n),i.blueprint.push(n),i.data.push(null);return r}function Qd(i,e,t){Pm(e);try{const n=i.viewQuery;null!==n&&wx(1,n,t);const r=i.template;null!==r&&GA(i,e,r,1,t),i.firstCreatePass&&(i.firstCreatePass=!1),i.staticContentQueries&&HA(i,e),i.staticViewQueries&&wx(2,i.viewQuery,t);const s=i.components;null!==s&&function $G(i,e){for(let t=0;t<e.length;t++)b8(i,e[t])}(e,s)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{e[2]&=-5,Im()}}function Fu(i,e,t,n){const r=e[2];if(128!=(128&r)){Pm(e);try{FE(e),function NE(i){return Ot.lFrame.bindingIndex=i}(i.bindingStartIndex),null!==t&&GA(i,e,t,2,n);const o=3==(3&r);if(o){const c=i.preOrderCheckHooks;null!==c&&Lm(e,c,null)}else{const c=i.preOrderHooks;null!==c&&Om(e,c,0,null),nb(e,0)}if(function v8(i){for(let e=Pb(i);null!==e;e=Ib(e)){if(!e[2])continue;const t=e[9];for(let n=0;n<t.length;n++){const r=t[n],s=r[3];0==(512&r[2])&&Yy(s,1),r[2]|=512}}}(e),function _8(i){for(let e=Pb(i);null!==e;e=Ib(e))for(let t=10;t<e.length;t++){const n=e[t],r=n[1];Zy(n)&&Fu(r,n,r.template,n[8])}}(e),null!==i.contentQueries&&HA(i,e),o){const c=i.contentCheckHooks;null!==c&&Lm(e,c)}else{const c=i.contentHooks;null!==c&&Om(e,c,1),nb(e,1)}!function YG(i,e){const t=i.hostBindingOpCodes;if(null!==t)try{for(let n=0;n<t.length;n++){const r=t[n];if(r<0)Ga(~r);else{const s=r,o=t[++n],a=t[++n];zz(o,s),a(2,e[s])}}}finally{Ga(-1)}}(i,e);const a=i.components;null!==a&&function QG(i,e){for(let t=0;t<e.length;t++)y8(i,e[t])}(e,a);const l=i.viewQuery;if(null!==l&&wx(2,l,n),o){const c=i.viewCheckHooks;null!==c&&Lm(e,c)}else{const c=i.viewHooks;null!==c&&Om(e,c,2),nb(e,2)}!0===i.firstUpdatePass&&(i.firstUpdatePass=!1),e[2]&=-41,512&e[2]&&(e[2]&=-513,Yy(e[3],-1))}finally{Im()}}}function JG(i,e,t,n){const r=e[10],o=IE(e);try{!o&&r.begin&&r.begin(),o&&Qd(i,e,n),Fu(i,e,t,n)}finally{!o&&r.end&&r.end()}}function GA(i,e,t,n,r){const s=Tr(),o=2&n;try{Ga(-1),o&&e.length>22&&cA(i,e,22,!1),t(n,r)}finally{Ga(s)}}function WA(i,e,t){if(jy(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=i.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}function px(i,e,t){!OE()||(function c8(i,e,t,n){const r=t.directiveStart,s=t.directiveEnd;i.firstCreatePass||Ld(t,e),ur(n,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=i.data[a],c=Ks(l);c&&p8(e,t,l);const u=Od(e,i,a,t);ur(u,e),null!==o&&m8(0,a-r,u,l,0,o),c&&(Jr(t.index,e)[8]=u)}}(i,e,t,vs(t,e)),128==(128&t.flags)&&function u8(i,e,t){const n=t.directiveStart,r=t.directiveEnd,s=t.index,o=function Hz(){return Ot.lFrame.currentDirectiveIndex}();try{Ga(s);for(let a=n;a<r;a++){const l=i.data[a],c=e[a];Jy(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&$A(l,c)}}finally{Ga(-1),Jy(o)}}(i,e,t))}function mx(i,e,t=vs){const n=e.localNames;if(null!==n){let r=e.index+1;for(let s=0;s<n.length;s+=2){const o=n[s+1],a=-1===o?t(e,i):i[o];i[r++]=a}}}function XA(i){const e=i.tView;return null===e||e.incompleteFirstPass?i.tView=lg(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts):e}function lg(i,e,t,n,r,s,o,a,l,c){const u=22+n,h=u+r,d=function e8(i,e){const t=[];for(let n=0;n<e;n++)t.push(n<i?null:Bt);return t}(u,h),f="function"==typeof c?c():c;return d[1]={type:i,blueprint:d,template:t,queries:null,viewQuery:a,declTNode:e,data:d.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function ZA(i,e,t,n){const r=rD(e);null===t?r.push(n):(r.push(t),i.firstCreatePass&&sD(i).push(n,r.length-1))}function YA(i,e,t){for(let n in i)if(i.hasOwnProperty(n)){const r=i[n];(t=null===t?{}:t).hasOwnProperty(n)?t[n].push(e,r):t[n]=[e,r]}return t}function rs(i,e,t,n,r,s,o,a){const l=vs(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[n])?(lD(i,t,u,n,r),Em(e)&&function s8(i,e){const t=Jr(e,i);16&t[2]||(t[2]|=32)}(t,e.index)):3&e.type&&(n=function r8(i){return"class"===i?"className":"for"===i?"htmlFor":"formaction"===i?"formAction":"innerHtml"===i?"innerHTML":"readonly"===i?"readOnly":"tabindex"===i?"tabIndex":i}(n),r=null!=o?o(r,e.value||"",n):r,hi(s)?s.setProperty(l,n,r):rb(n)||(l.setProperty?l.setProperty(n,r):l[n]=r))}function gx(i,e,t,n){let r=!1;if(OE()){const s=function h8(i,e,t){const n=i.directiveRegistry;let r=null;if(n)for(let s=0;s<n.length;s++){const o=n[s];aA(t,o.selectors,!1)&&(r||(r=[]),Vm(Ld(t,e),i,o.type),Ks(o)?(JA(i,t),r.unshift(o)):r.push(o))}return r}(i,e,t),o=null===n?null:{"":-1};if(null!==s){r=!0,eD(t,i.data.length,s.length);for(let u=0;u<s.length;u++){const h=s[u];h.providersResolver&&h.providersResolver(h)}let a=!1,l=!1,c=Iu(i,e,s.length,null);for(let u=0;u<s.length;u++){const h=s[u];t.mergedAttrs=Nm(t.mergedAttrs,h.hostAttrs),tD(i,t,e,c,h),f8(c,h,o),null!==h.contentQueries&&(t.flags|=8),(null!==h.hostBindings||null!==h.hostAttrs||0!==h.hostVars)&&(t.flags|=128);const d=h.type.prototype;!a&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((i.preOrderHooks||(i.preOrderHooks=[])).push(t.index),a=!0),!l&&(d.ngOnChanges||d.ngDoCheck)&&((i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function n8(i,e){const n=e.directiveEnd,r=i.data,s=e.attrs,o=[];let a=null,l=null;for(let c=e.directiveStart;c<n;c++){const u=r[c],h=u.inputs,d=null===s||oA(e)?null:g8(h,s);o.push(d),a=YA(h,c,a),l=YA(u.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(i,t)}o&&function d8(i,e,t){if(e){const n=i.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new et(-301,!1);n.push(e[r],s)}}}(t,n,o)}return t.mergedAttrs=Nm(t.mergedAttrs,t.attrs),r}function QA(i,e,t,n,r,s){const o=s.hostBindings;if(o){let a=i.hostBindingOpCodes;null===a&&(a=i.hostBindingOpCodes=[]);const l=~e.index;(function l8(i){let e=i.length;for(;e>0;){const t=i[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(n,r,o)}}function $A(i,e){null!==i.hostBindings&&i.hostBindings(1,e)}function JA(i,e){e.flags|=2,(i.components||(i.components=[])).push(e.index)}function f8(i,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=i;Ks(e)&&(t[""]=i)}}function eD(i,e,t){i.flags|=1,i.directiveStart=e,i.directiveEnd=e+t,i.providerIndexes=e}function tD(i,e,t,n,r){i.data[n]=r;const s=r.factory||(r.factory=Xl(r.type)),o=new Id(s,Ks(r),N);i.blueprint[n]=o,t[n]=o,QA(i,e,0,n,Iu(i,t,r.hostVars,Bt),r)}function p8(i,e,t){const n=vs(e,i),r=XA(t),s=i[10],o=cg(i,Yd(i,r,null,t.onPush?32:16,n,e,s,s.createRenderer(n,t),null,null,null));i[e.index]=o}function Po(i,e,t,n,r,s){const o=vs(i,e);!function _x(i,e,t,n,r,s,o){if(null==s)hi(i)?i.removeAttribute(e,r,t):e.removeAttribute(r);else{const a=null==o?Nt(s):o(s,n||"",r);hi(i)?i.setAttribute(e,r,a,t):t?e.setAttributeNS(t,r,a):e.setAttribute(r,a)}}(e[11],o,s,i.value,t,n,r)}function m8(i,e,t,n,r,s){const o=s[e];if(null!==o){const a=n.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],h=o[l++];null!==a?n.setInput(t,h,c,u):t[u]=h}}}function g8(i,e){let t=null,n=0;for(;n<e.length;){const r=e[n];if(0!==r)if(5!==r){if("number"==typeof r)break;i.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,i[r],e[n+1])),n+=2}else n+=2;else n+=4}return t}function nD(i,e,t,n){return new Array(i,!0,!1,e,null,0,n,t,null,null)}function y8(i,e){const t=Jr(e,i);if(Zy(t)){const n=t[1];48&t[2]?Fu(n,t,n.template,t[8]):t[5]>0&&vx(t)}}function vx(i){for(let n=Pb(i);null!==n;n=Ib(n))for(let r=10;r<n.length;r++){const s=n[r];if(512&s[2]){const o=s[1];Fu(o,s,o.template,s[8])}else s[5]>0&&vx(s)}const t=i[1].components;if(null!==t)for(let n=0;n<t.length;n++){const r=Jr(t[n],i);Zy(r)&&r[5]>0&&vx(r)}}function b8(i,e){const t=Jr(e,i),n=t[1];(function x8(i,e){for(let t=e.length;t<i.blueprint.length;t++)e.push(i.blueprint[t])})(n,t),Qd(n,t,t[8])}function cg(i,e){return i[13]?i[14][4]=e:i[13]=e,i[14]=e,e}function yx(i){for(;i;){i[2]|=32;const e=qd(i);if(yz(i)&&!e)return i;i=e}return null}function iD(i){!function bx(i){for(let e=0;e<i.components.length;e++){const t=i.components[e],n=Eb(t);if(null!==n){const r=n[1];JG(r,n,r.template,t)}}}(i[8])}function wx(i,e,t){tb(0),e(i,t)}const M8=(()=>Promise.resolve(null))();function rD(i){return i[7]||(i[7]=[])}function sD(i){return i.cleanup||(i.cleanup=[])}function oD(i,e,t){return(null===i||Ks(i))&&(t=function Iz(i){for(;Array.isArray(i);){if("object"==typeof i[1])return i;i=i[0]}return null}(t[e.index])),t[11]}function aD(i,e){const t=i[9],n=t?t.get(aa,null):null;n&&n.handleError(e)}function lD(i,e,t,n,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=i.data[o];null!==c.setInput?c.setInput(l,r,n,a):l[a]=r}}function ua(i,e,t){const n=Am(e,i);!function zR(i,e,t){hi(i)?i.setValue(e,t):e.textContent=t}(i[11],n,t)}function ug(i,e,t){let n=t?i.styles:null,r=t?i.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=Iy(r,a):2==s&&(n=Iy(n,a+": "+e[++o]+";"))}t?i.styles=n:i.stylesWithoutHost=n,t?i.classes=r:i.classesWithoutHost=r}function L8(){const i=ki();Fm(be()[1],i)}function Se(i){let e=function bD(i){return Object.getPrototypeOf(i.prototype).constructor}(i.type),t=!0;const n=[i];for(;e;){let r;if(Ks(i))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new et(903,"");r=e.\u0275dir}if(r){if(t){n.push(r);const o=i;o.inputs=Sx(i.inputs),o.declaredInputs=Sx(i.declaredInputs),o.outputs=Sx(i.outputs);const a=r.hostBindings;a&&B8(i,a);const l=r.viewQuery,c=r.contentQueries;if(l&&k8(i,l),c&&N8(i,c),Py(i.inputs,r.inputs),Py(i.declaredInputs,r.declaredInputs),Py(i.outputs,r.outputs),Ks(r)&&r.data.animation){const u=i.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(i),a===Se&&(t=!1)}}e=Object.getPrototypeOf(e)}!function O8(i){let e=0,t=null;for(let n=i.length-1;n>=0;n--){const r=i[n];r.hostVars=e+=r.hostVars,r.hostAttrs=Nm(r.hostAttrs,t=Nm(t,r.hostAttrs))}}(n)}function Sx(i){return i===cu?{}:i===vn?[]:i}function k8(i,e){const t=i.viewQuery;i.viewQuery=t?(n,r)=>{e(n,r),t(n,r)}:e}function N8(i,e){const t=i.contentQueries;i.contentQueries=t?(n,r,s)=>{e(n,r,s),t(n,r,s)}:e}function B8(i,e){const t=i.hostBindings;i.hostBindings=t?(n,r)=>{e(n,r),t(n,r)}:e}let hg=null;function Jl(){if(!hg){const i=Dn.Symbol;if(i&&i.iterator)hg=i.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const n=e[t];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(hg=n)}}}return hg}function $d(i){return!!Tx(i)&&(Array.isArray(i)||!(i instanceof Map)&&Jl()in i)}function Tx(i){return null!==i&&("function"==typeof i||"object"==typeof i)}function Io(i,e,t){return i[e]=t}function hr(i,e,t){return!Object.is(i[e],t)&&(i[e]=t,!0)}function ec(i,e,t,n){const r=hr(i,e,t);return hr(i,e+1,n)||r}function vi(i,e,t,n){const r=be();return hr(r,mu(),e)&&(un(),Po(di(),r,i,e,t,n)),vi}function Sn(i,e,t,n,r,s,o,a){const l=be(),c=un(),u=i+22,h=c.firstCreatePass?function W8(i,e,t,n,r,s,o,a,l){const c=e.consts,u=Pu(e,i,4,o||null,Ha(c,a));gx(e,t,u,Ha(c,l)),Fm(e,u);const h=u.tViews=lg(2,u,n,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,n,r,s,o):c.data[u];Eo(h,!1);const d=l[11].createComment("");eg(c,l,d,h),ur(d,l),cg(l,l[u]=nD(d,l,d,h)),Rm(h)&&px(c,l,h),null!=o&&mx(l,h,a)}function yn(i){return pu(function Vz(){return Ot.lFrame.contextLView}(),22+i)}function Q(i,e,t){const n=be();return hr(n,mu(),e)&&rs(un(),di(),n,i,e,n[11],t,!1),Q}function Cx(i,e,t,n,r){const o=r?"class":"style";lD(i,t,e.inputs[o],o,n)}function me(i,e,t,n){const r=be(),s=un(),o=22+i,a=r[11],l=r[o]=Lb(a,e,function Qz(){return Ot.lFrame.currentNamespace}()),c=s.firstCreatePass?function K8(i,e,t,n,r,s,o){const a=e.consts,c=Pu(e,i,2,r,Ha(a,s));return gx(e,t,c,Ha(a,o)),null!==c.attrs&&ug(c,c.attrs,!1),null!==c.mergedAttrs&&ug(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,n):s.data[o];Eo(c,!0);const u=c.mergedAttrs;null!==u&&km(a,l,u);const h=c.classes;null!==h&&Vb(a,l,h);const d=c.styles;return null!==d&&iA(a,l,d),64!=(64&c.flags)&&eg(s,r,l,c),0===function Oz(){return Ot.lFrame.elementDepthCount}()&&ur(l,r),function kz(){Ot.lFrame.elementDepthCount++}(),Rm(c)&&(px(s,r,c),WA(s,c,r)),null!==n&&mx(r,c),me}function Te(){let i=ki();Qy()?$y():(i=i.parent,Eo(i,!1));const e=i;!function Nz(){Ot.lFrame.elementDepthCount--}();const t=un();return t.firstCreatePass&&(Fm(t,i),jy(i)&&t.queries.elementEnd(i)),null!=e.classesWithoutHost&&function n5(i){return 0!=(16&i.flags)}(e)&&Cx(t,e,be(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function r5(i){return 0!=(32&i.flags)}(e)&&Cx(t,e,be(),e.stylesWithoutHost,!1),Te}function Ze(i,e,t,n){return me(i,e,t,n),Te(),Ze}function Ex(i,e,t){const n=be(),r=un(),s=i+22,o=r.firstCreatePass?function q8(i,e,t,n,r){const s=e.consts,o=Ha(s,n),a=Pu(e,i,8,"ng-container",o);return null!==o&&ug(a,o,!0),gx(e,t,a,Ha(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,n,e,t):r.data[s];Eo(o,!0);const a=n[s]=n[11].createComment("");return eg(r,n,a,o),ur(a,n),Rm(o)&&(px(r,n,o),WA(r,o,n)),null!=t&&mx(n,o),Ex}function Rx(){let i=ki();const e=un();return Qy()?$y():(i=i.parent,Eo(i,!1)),e.firstCreatePass&&(Fm(e,i),jy(i)&&e.queries.elementEnd(i)),Rx}function Ax(i,e,t){return Ex(i,e,t),Rx(),Ax}function Fo(){return be()}function ef(i){return!!i&&"function"==typeof i.then}function DD(i){return!!i&&"function"==typeof i.subscribe}const Dx=DD;function gt(i,e,t,n){const r=be(),s=un(),o=ki();return PD(s,r,r[11],o,i,e,!!t,n),gt}function Px(i,e){const t=ki(),n=be(),r=un();return PD(r,n,oD(eb(r.data),t,n),t,i,e,!1),Px}function PD(i,e,t,n,r,s,o,a){const l=Rm(n),u=i.firstCreatePass&&sD(i),h=e[8],d=rD(e);let f=!0;if(3&n.type||a){const g=vs(n,e),_=a?a(g):g,v=d.length,y=a?b=>a(Ti(b[n.index])):n.index;if(hi(t)){let b=null;if(!a&&l&&(b=function Z8(i,e,t,n){const r=i.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===n){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(i,e,r,n.index)),null!==b)(b.__ngLastListenerFn__||b).__ngNextListenerFn__=s,b.__ngLastListenerFn__=s,f=!1;else{s=Ix(n,e,h,s,!1);const w=t.listen(_,r,s);d.push(s,w),u&&u.push(r,y,v,v+1)}}else s=Ix(n,e,h,s,!0),_.addEventListener(r,s,o),d.push(s),u&&u.push(r,y,v,o)}else s=Ix(n,e,h,s,!1);const p=n.outputs;let m;if(f&&null!==p&&(m=p[r])){const g=m.length;if(g)for(let _=0;_<g;_+=2){const M=e[m[_]][m[_+1]].subscribe(s),T=d.length;d.push(s,M),u&&u.push(r,n.index,T,-(T+1))}}}function ID(i,e,t,n){try{return!1!==t(n)}catch(r){return aD(i,r),!1}}function Ix(i,e,t,n,r){return function s(o){if(o===Function)return n;yx(2&i.flags?Jr(i.index,e):e);let l=ID(e,0,n,o),c=s.__ngNextListenerFn__;for(;c;)l=ID(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function ii(i=1){return function Wz(i){return(Ot.lFrame.contextLView=function Xz(i,e){for(;i>0;)e=e[15],i--;return e}(i,Ot.lFrame.contextLView))[8]}(i)}function Y8(i,e){let t=null;const n=function nG(i){const e=i.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(i);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===n?aA(i,s,!0):sG(n,s))return r}else t=r}return t}function Ji(i){const e=be()[16][6];if(!e.projection){const n=e.projection=Bd(i?i.length:1,null),r=n.slice();let s=e.child;for(;null!==s;){const o=i?Y8(s,i):0;null!==o&&(r[o]?r[o].projectionNext=s:n[o]=s,r[o]=s),s=s.next}}}function zn(i,e=0,t){const n=be(),r=un(),s=Pu(r,22+i,16,null,t||null);null===s.projection&&(s.projection=e),$y(),64!=(64&s.flags)&&function ZH(i,e,t){nA(e[11],0,e,t,WR(i,t,e),YR(t.parent||e[6],t,e))}(r,n,s)}function zD(i,e,t,n,r){const s=i[t+1],o=null===e;let a=n?Zs(s):ca(s),l=!1;for(;0!==a&&(!1===l||o);){const u=i[a+1];J8(i[a],e)&&(l=!0,i[a+1]=n?rx(u):nx(u)),a=n?Zs(u):ca(u)}l&&(i[t+1]=n?nx(s):rx(s))}function J8(i,e){return null===i||null==e||(Array.isArray(i)?i[1]:i)===e||!(!Array.isArray(i)||"string"!=typeof e)&&Mu(i,e)>=0}function tf(i,e,t){return Qs(i,e,t,!1),tf}function mn(i,e){return Qs(i,e,null,!0),mn}function Qs(i,e,t,n){const r=be(),s=un(),o=function sa(i){const e=Ot.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+i,t}(2);s.firstUpdatePass&&function YD(i,e,t,n){const r=i.data;if(null===r[t+1]){const s=r[Tr()],o=function ZD(i,e){return e>=i.expandoStartIndex}(i,t);(function eP(i,e){return 0!=(i.flags&(e?16:32))})(s,n)&&null===e&&!o&&(e=!1),e=function l6(i,e,t,n){const r=eb(i);let s=n?e.residualClasses:e.residualStyles;if(null===r)0===(n?e.classBindings:e.styleBindings)&&(t=nf(t=Lx(null,i,e,t,n),e.attrs,n),s=null);else{const o=e.directiveStylingLast;if(-1===o||i[o]!==r)if(t=Lx(r,i,e,t,n),null===s){let l=function c6(i,e,t){const n=t?e.classBindings:e.styleBindings;if(0!==ca(n))return i[Zs(n)]}(i,e,n);void 0!==l&&Array.isArray(l)&&(l=Lx(null,i,e,l[1],n),l=nf(l,e.attrs,n),function u6(i,e,t,n){i[Zs(t?e.classBindings:e.styleBindings)]=n}(i,e,n,l))}else s=function h6(i,e,t){let n;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)n=nf(n,i[s].hostAttrs,t);return nf(n,e.attrs,t)}(i,e,n)}return void 0!==s&&(n?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,n),function Q8(i,e,t,n,r,s){let o=s?e.classBindings:e.styleBindings,a=Zs(o),l=ca(o);i[n]=t;let u,c=!1;if(Array.isArray(t)){const h=t;u=h[1],(null===u||Mu(h,u)>0)&&(c=!0)}else u=t;if(r)if(0!==l){const d=Zs(i[a+1]);i[n+1]=sg(d,a),0!==d&&(i[d+1]=ix(i[d+1],n)),i[a+1]=function VG(i,e){return 131071&i|e<<17}(i[a+1],n)}else i[n+1]=sg(a,0),0!==a&&(i[a+1]=ix(i[a+1],n)),a=n;else i[n+1]=sg(l,0),0===a?a=n:i[l+1]=ix(i[l+1],n),l=n;c&&(i[n+1]=nx(i[n+1])),zD(i,u,n,!0),zD(i,u,n,!1),function $8(i,e,t,n,r){const s=r?i.residualClasses:i.residualStyles;null!=s&&"string"==typeof e&&Mu(s,e)>=0&&(t[n+1]=rx(t[n+1]))}(e,u,i,n,s),o=sg(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,n)}}(s,i,o,n),e!==Bt&&hr(r,o,e)&&function $D(i,e,t,n,r,s,o,a){if(!(3&e.type))return;const l=i.data,c=l[a+1];fg(function OA(i){return 1==(1&i)}(c)?JD(l,e,t,r,ca(c),o):void 0)||(fg(s)||function LA(i){return 2==(2&i)}(c)&&(s=JD(l,null,t,r,a,o)),function QH(i,e,t,n,r){const s=hi(i);if(e)r?s?i.addClass(t,n):t.classList.add(n):s?i.removeClass(t,n):t.classList.remove(n);else{let o=-1===n.indexOf("-")?void 0:is.DashCase;if(null==r)s?i.removeStyle(t,n,o):t.style.removeProperty(n);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=is.Important),s?i.setStyle(t,n,r,o):t.style.setProperty(n,r,a?"important":"")}}}(n,o,Am(Tr(),t),r,s))}(s,s.data[Tr()],r,r[11],i,r[o+1]=function p6(i,e){return null==i||("string"==typeof e?i+=e:"object"==typeof i&&(i=On(ns(i)))),i}(e,t),n,o)}function Lx(i,e,t,n,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],n=nf(n,s.hostAttrs,r),s!==i);)a++;return null!==i&&(t.directiveStylingLast=a),n}function nf(i,e,t){const n=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===n&&(Array.isArray(i)||(i=void 0===i?[]:["",i]),ts(i,o,!!t||e[++s]))}return void 0===i?null:i}function JD(i,e,t,n,r,s){const o=null===e;let a;for(;r>0;){const l=i[r],c=Array.isArray(l),u=c?l[1]:l,h=null===u;let d=t[r+1];d===Bt&&(d=h?vn:void 0);let f=h?hb(d,n):u===n?d:void 0;if(c&&!fg(f)&&(f=hb(l,n)),fg(f)&&(a=f,o))return a;const p=i[r+1];r=o?Zs(p):ca(p)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=hb(l,n))}return a}function fg(i){return void 0!==i}function Cn(i,e=""){const t=be(),n=un(),r=i+22,s=n.firstCreatePass?Pu(n,r,1,e,null):n.data[r],o=t[r]=function Fb(i,e){return hi(i)?i.createText(e):i.createTextNode(e)}(t[11],e);eg(n,t,o,s),Eo(s,!1)}function rf(i){return pg("",i,""),rf}function pg(i,e,t){const n=be(),r=function Ou(i,e,t,n){return hr(i,mu(),t)?e+Nt(t)+n:Bt}(n,i,e,t);return r!==Bt&&ua(n,Tr(),r),pg}function kx(i,e,t){const n=be();if(hr(n,mu(),e)){const s=un(),o=di();rs(s,o,n,i,e,oD(eb(s.data),o,n),t,!0)}return kx}const Wu="en-US";let bP=Wu;function Ux(i,e,t,n,r){if(i=Dt(i),Array.isArray(i))for(let s=0;s<i.length;s++)Ux(i[s],e,t,n,r);else{const s=un(),o=be();let a=Ql(i)?i:Dt(i.provide),l=xA(i);const c=ki(),u=1048575&c.providerIndexes,h=c.directiveStart,d=c.providerIndexes>>20;if(Ql(i)||!i.multi){const f=new Id(l,r,N),p=jx(a,e,r?u:u+d,h);-1===p?(Vm(Ld(c,o),s,a),Vx(s,i,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(f),o.push(f)):(t[p]=f,o[p]=f)}else{const f=jx(a,e,u+d,h),p=jx(a,e,u,u+d),m=f>=0&&t[f],g=p>=0&&t[p];if(r&&!g||!r&&!m){Vm(Ld(c,o),s,a);const _=function IW(i,e,t,n,r){const s=new Id(i,t,N);return s.multi=[],s.index=e,s.componentProviders=0,WP(s,r,n&&!t),s}(r?PW:DW,t.length,r,n,l);!r&&g&&(t[p].providerFactory=_),Vx(s,i,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(_),o.push(_)}else Vx(s,i,f>-1?f:p,WP(t[r?p:f],l,!r&&n));!r&&n&&g&&t[p].componentProviders++}}}function Vx(i,e,t,n){const r=Ql(e),s=function gG(i){return!!i.useClass}(e);if(r||s){const l=(s?Dt(e.useClass):e).prototype.ngOnDestroy;if(l){const c=i.destroyHooks||(i.destroyHooks=[]);if(!r&&e.multi){const u=c.indexOf(t);-1===u?c.push(t,[n,l]):c[u+1].push(n,l)}else c.push(t,l)}}}function WP(i,e,t){return t&&i.componentProviders++,i.multi.push(e)-1}function jx(i,e,t,n){for(let r=t;r<n;r++)if(e[r]===i)return r;return-1}function DW(i,e,t,n){return zx(this.multi,[])}function PW(i,e,t,n){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Od(t,t[1],this.providerFactory.index,n);s=a.slice(0,o),zx(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],zx(r,s);return s}function zx(i,e){for(let t=0;t<i.length;t++)e.push((0,i[t])());return e}function Xe(i,e=[]){return t=>{t.providersResolver=(n,r)=>function AW(i,e,t){const n=un();if(n.firstCreatePass){const r=Ks(i);Ux(t,n.data,n.blueprint,r,!0),Ux(e,n.data,n.blueprint,r,!1)}}(n,r?r(i):i,e)}}class LW{resolveComponentFactory(e){throw function FW(i){const e=Error(`No component factory found for ${On(i)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=i,e}(e)}}let qa=(()=>{class i{}return i.NULL=new LW,i})();class Za{}class KP{}class qP{}function kW(){return Ku(ki(),be())}function Ku(i,e){return new Kt(vs(i,e))}let Kt=(()=>{class i{constructor(t){this.nativeElement=t}}return i.__NG_ELEMENT_ID__=kW,i})();function NW(i){return i instanceof Kt?i.nativeElement:i}class uf{}let ha=(()=>{class i{}return i.__NG_ELEMENT_ID__=()=>function UW(){const i=be(),t=Jr(ki().index,i);return function BW(i){return i[11]}(Ur(t)?t:i)}(),i})(),VW=(()=>{class i{}return i.\u0275prov=We({token:i,providedIn:"root",factory:()=>null}),i})();class nc{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const jW=new nc("14.0.2"),Hx={};function yg(i,e,t,n,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&n.push(Ti(s)),Xs(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&yg(l[1],l,c,n)}const o=t.type;if(8&o)yg(i,e,t.child,n);else if(32&o){const a=Db(t,e);let l;for(;l=a();)n.push(l)}else if(16&o){const a=eA(e,t);if(Array.isArray(a))n.push(...a);else{const l=qd(e[16]);yg(l[1],l,a,n,!0)}}t=r?t.projectionNext:t.next}return n}class hf{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return yg(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(Xs(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(Ob(e,n),zm(t,n))}this._attachedToViewContainer=!1}GR(this._lView[1],this._lView)}onDestroy(e){ZA(this._lView[1],this._lView,null,e)}markForCheck(){yx(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){!function xx(i,e,t){const n=e[10];n.begin&&n.begin();try{Fu(i,e,i.template,t)}catch(r){throw aD(e,r),r}finally{n.end&&n.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new et(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function jH(i,e){Zd(i,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new et(902,"");this._appRef=e}}class zW extends hf{constructor(e){super(e),this._view=e}detectChanges(){iD(this._view)}checkNoChanges(){}get context(){return null}}class Gx extends qa{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=kn(e);return new Wx(t,this.ngModule)}}function ZP(i){const e=[];for(let t in i)i.hasOwnProperty(t)&&e.push({propName:i[t],templateName:t});return e}class GW{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){const r=this.injector.get(e,Hx,n);return r!==Hx||t===Hx?r:this.parentInjector.get(e,t,n)}}class Wx extends qP{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function aG(i){return i.map(oG).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return ZP(this.componentDef.inputs)}get outputs(){return ZP(this.componentDef.outputs)}create(e,t,n,r){let s=(r=r||this.ngModule)instanceof $l?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new GW(e,s):e,a=o.get(uf,PE),l=o.get(VW,null),c=a.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",h=n?function qA(i,e,t){if(hi(i))return i.selectRootElement(e,t===Gs.ShadowDom);let n="string"==typeof e?i.querySelector(e):e;return n.textContent="",n}(c,n,this.componentDef.encapsulation):Lb(a.createRenderer(null,this.componentDef),u,function HW(i){const e=i.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(u)),d=this.componentDef.onPush?288:272,f=function yD(i,e){return{components:[],scheduler:i||LH,clean:M8,playerHandler:e||null,flags:0}}(),p=lg(0,null,null,1,0,null,null,null,null,null),m=Yd(null,p,f,d,null,null,a,c,l,o,null);let g,_;Pm(m);try{const v=function _D(i,e,t,n,r,s){const o=t[1];t[22]=i;const l=Pu(o,22,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(ug(l,c,!0),null!==i&&(km(r,i,c),null!==l.classes&&Vb(r,i,l.classes),null!==l.styles&&iA(r,i,l.styles)));const u=n.createRenderer(i,e),h=Yd(t,XA(e),null,e.onPush?32:16,t[22],l,n,u,s||null,null,null);return o.firstCreatePass&&(Vm(Ld(l,t),o,e.type),JA(o,l),eD(l,t.length,1)),cg(t,h),t[22]=h}(h,this.componentDef,m,a,c);if(h)if(n)km(c,h,["ng-version",jW.full]);else{const{attrs:y,classes:b}=function lG(i){const e=[],t=[];let n=1,r=2;for(;n<i.length;){let s=i[n];if("string"==typeof s)2===r?""!==s&&e.push(s,i[++n]):8===r&&t.push(s);else{if(!qs(r))break;r=s}n++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);y&&km(c,h,y),b&&b.length>0&&Vb(c,h,b.join(" "))}if(_=qy(p,22),void 0!==t){const y=_.projection=[];for(let b=0;b<this.ngContentSelectors.length;b++){const w=t[b];y.push(null!=w?Array.from(w):null)}}g=function vD(i,e,t,n,r){const s=t[1],o=function a8(i,e,t){const n=ki();i.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),tD(i,n,e,Iu(i,e,1,null),t));const r=Od(e,i,n.directiveStart,n);ur(r,e);const s=vs(n,e);return s&&ur(s,e),r}(s,t,e);if(n.components.push(o),i[8]=o,null!==r)for(const l of r)l(o,e);if(e.contentQueries){const l=ki();e.contentQueries(1,o,l.directiveStart)}const a=ki();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(Ga(a.index),QA(t[1],a,0,a.directiveStart,a.directiveEnd,e),$A(e,o)),o}(v,this.componentDef,m,f,[L8]),Qd(p,m,null)}finally{Im()}return new XW(this.componentType,g,Ku(_,m),m,_)}}class XW extends class OW{}{constructor(e,t,n,r,s){super(),this.location=n,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new zW(r),this.componentType=e}get injector(){return new vu(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}class YP extends Za{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Gx(this);const n=Qr(e);this._bootstrapComponents=la(n.bootstrap),this._r3Injector=MA(e,t,[{provide:Za,useValue:this},{provide:qa,useValue:this.componentFactoryResolver}],On(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this.get(e)}get(e,t=Xi.THROW_IF_NOT_FOUND,n=Ct.Default){return e===Xi||e===Za||e===Hb?this:this._r3Injector.get(e,t,n)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Xx extends KP{constructor(e){super(),this.moduleType=e}create(e){return new YP(this.moduleType,e)}}class qW extends Za{constructor(e,t,n){super(),this.componentFactoryResolver=new Gx(this),this.instance=null;const r=new bA([...e,{provide:Za,useValue:this},{provide:qa,useValue:this.componentFactoryResolver}],t||Xb(),n,new Set(["environment"]));this.injector=r,r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function bg(i,e=null,t=null){return new qW(i,e,t).injector}function Ee(i,e,t){const n=Sr()+i,r=be();return r[n]===Bt?Io(r,n,t?e.call(t):e()):function Jd(i,e){return i[e]}(r,n)}function Tn(i,e,t,n){return QP(be(),Sr(),i,e,t,n)}function ic(i,e,t,n,r){return function $P(i,e,t,n,r,s,o){const a=e+t;return ec(i,a,r,s)?Io(i,a+2,o?n.call(o,r,s):n(r,s)):ff(i,a+2)}(be(),Sr(),i,e,t,n,r)}function xg(i,e,t,n,r,s){return function JP(i,e,t,n,r,s,o,a){const l=e+t;return function dg(i,e,t,n,r){const s=ec(i,e,t,n);return hr(i,e+2,r)||s}(i,l,r,s,o)?Io(i,l+3,a?n.call(a,r,s,o):n(r,s,o)):ff(i,l+3)}(be(),Sr(),i,e,t,n,r,s)}function df(i,e,t,n,r,s,o){return function eI(i,e,t,n,r,s,o,a,l){const c=e+t;return function bs(i,e,t,n,r,s){const o=ec(i,e,t,n);return ec(i,e+2,r,s)||o}(i,c,r,s,o,a)?Io(i,c+4,l?n.call(l,r,s,o,a):n(r,s,o,a)):ff(i,c+4)}(be(),Sr(),i,e,t,n,r,s,o)}function ff(i,e){const t=i[e];return t===Bt?void 0:t}function QP(i,e,t,n,r,s){const o=e+t;return hr(i,o,r)?Io(i,o+1,s?n.call(s,r):n(r)):ff(i,o+1)}function xs(i,e){const t=un();let n;const r=i+22;t.firstCreatePass?(n=function r7(i,e){if(e)for(let t=e.length-1;t>=0;t--){const n=e[t];if(i===n.name)return n}}(e,t.pipeRegistry),t.data[r]=n,n.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(r,n.onDestroy)):n=t.data[r];const s=n.factory||(n.factory=Xl(n.type)),o=Co(N);try{const a=Bm(!1),l=s();return Bm(a),function X8(i,e,t,n){t>=i.data.length&&(i.data[t]=null,i.blueprint[t]=null),e[t]=n}(t,be(),r,l),l}finally{Co(o)}}function ws(i,e,t){const n=i+22,r=be(),s=pu(r,n);return function pf(i,e){return i[1].data[e].pure}(r,n)?QP(r,Sr(),e,s.transform,t,s):s.transform(t)}function Kx(i){return e=>{setTimeout(i,void 0,e)}}const yt=class c7 extends Lt{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){let r=e,s=t||(()=>null),o=n;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=Kx(s),r&&(r=Kx(r)),o&&(o=Kx(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof $n&&e.add(a),a}};function u7(){return this._results[Jl()]()}class rc{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Jl(),n=rc.prototype;n[t]||(n[t]=u7)}get changes(){return this._changes||(this._changes=new yt)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const n=this;n.dirty=!1;const r=es(e);(this._changesDetected=!function m5(i,e,t){if(i.length!==e.length)return!1;for(let n=0;n<i.length;n++){let r=i[n],s=e[n];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Js=(()=>{class i{}return i.__NG_ELEMENT_ID__=f7,i})();const h7=Js,d7=class extends h7{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}createEmbeddedView(e,t){const n=this._declarationTContainer.tViews,r=Yd(this._declarationLView,n,e,16,null,n.declTNode,null,null,null,null,t||null);r[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(r[19]=o.createEmbeddedView(n)),Qd(n,r,e),new hf(r)}};function f7(){return wg(ki(),be())}function wg(i,e){return 4&i.type?new d7(e,i,Ku(i,e)):null}let zr=(()=>{class i{}return i.__NG_ELEMENT_ID__=p7,i})();function p7(){return rI(ki(),be())}const m7=zr,nI=class extends m7{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return Ku(this._hostTNode,this._hostLView)}get injector(){return new vu(this._hostTNode,this._hostLView)}get parentInjector(){const e=Um(this._hostTNode,this._hostLView);if(qE(e)){const t=_u(e,this._hostLView),n=gu(e);return new vu(t[1].data[n+8],t)}return new vu(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=iI(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,n){let r,s;"number"==typeof n?r=n:null!=n&&(r=n.index,s=n.injector);const o=e.createEmbeddedView(t||{},s);return this.insert(o,r),o}createComponent(e,t,n,r,s){const o=e&&!function Nd(i){return"function"==typeof i}(e);let a;if(o)a=t;else{const h=t||{};a=h.index,n=h.injector,r=h.projectableNodes,s=h.environmentInjector||h.ngModuleRef}const l=o?e:new Wx(kn(e)),c=n||this.parentInjector;if(!s&&null==l.ngModule){const d=(o?c:this.parentInjector).get($l,null);d&&(s=d)}const u=l.create(c,r,void 0,s);return this.insert(u.hostView,a),u}insert(e,t){const n=e._lView,r=n[1];if(function Lz(i){return Xs(i[3])}(n)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const h=n[3],d=new nI(h,h[6],h[3]);d.detach(d.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function HH(i,e,t,n){const r=10+n,s=t.length;n>0&&(t[r-1][4]=e),n<s-10?(e[4]=t[r],sR(t,10+n,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function GH(i,e){const t=i[9];e[16]!==e[3][3][16]&&(i[2]=!0),null===t?i[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(i),e[2]|=64}(r,n,o,s);const a=Bb(s,o),l=n[11],c=Jm(l,o[7]);return null!==c&&function VH(i,e,t,n,r,s){n[0]=r,n[6]=e,Zd(i,n,t,1,r,s)}(r,o[6],l,n,c,a),e.attachToViewContainerRef(),sR(qx(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=iI(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=Ob(this._lContainer,t);n&&(zm(qx(this._lContainer),t),GR(n[1],n))}detach(e){const t=this._adjustIndex(e,-1),n=Ob(this._lContainer,t);return n&&null!=zm(qx(this._lContainer),t)?new hf(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function iI(i){return i[8]}function qx(i){return i[8]||(i[8]=[])}function rI(i,e){let t;const n=e[i.index];if(Xs(n))t=n;else{let r;if(8&i.type)r=Ti(n);else{const s=e[11];r=s.createComment("");const o=vs(i,e);Yl(s,Jm(s,o),r,function qH(i,e){return hi(i)?i.nextSibling(e):e.nextSibling}(s,o),!1)}e[i.index]=t=nD(n,e,r,i),cg(e,t)}return new nI(t,i,e)}class Zx{constructor(e){this.queryList=e,this.matches=null}clone(){return new Zx(this.queryList)}setDirty(){this.queryList.setDirty()}}class Yx{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<n;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new Yx(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==cI(e,t).matches&&this.queries[t].setDirty()}}class sI{constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class Qx{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const r=null!==t?t.length:0,s=this.getByIndex(n).embeddedTView(e,r);s&&(s.indexInDeclarationView=n,null!==t?t.push(s):t=[s])}return null!==t?new Qx(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class $x{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new $x(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){const s=n[r];this.matchTNodeWithReadOption(e,t,v7(t,s)),this.matchTNodeWithReadOption(e,t,jm(t,e,s,!1,!1))}else n===Js?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,jm(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===Kt||r===zr||r===Js&&4&t.type)this.addMatch(t.index,-2);else{const s=jm(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function v7(i,e){const t=i.localNames;if(null!==t)for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1];return null}function b7(i,e,t,n){return-1===t?function y7(i,e){return 11&i.type?Ku(i,e):4&i.type?wg(i,e):null}(e,i):-2===t?function x7(i,e,t){return t===Kt?Ku(e,i):t===Js?wg(e,i):t===zr?rI(e,i):void 0}(i,e,n):Od(i,i[1],t,e)}function oI(i,e,t,n){const r=e[19].queries[n];if(null===r.matches){const s=i.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:b7(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function Jx(i,e,t,n){const r=i.queries.getByIndex(t),s=r.matches;if(null!==s){const o=oI(i,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)n.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let h=10;h<u.length;h++){const d=u[h];d[17]===d[3]&&Jx(d[1],d,c,n)}if(null!==u[9]){const h=u[9];for(let d=0;d<h.length;d++){const f=h[d];Jx(f[1],f,c,n)}}}}}return n}function Et(i){const e=be(),t=un(),n=UE();tb(n+1);const r=cI(t,n);if(i.dirty&&IE(e)===(2==(2&r.metadata.flags))){if(null===r.matches)i.reset([]);else{const s=r.crossesNgTemplate?Jx(t,e,n,[]):oI(t,e,r,n);i.reset(s,NW),i.notifyOnChanges()}return!0}return!1}function Pn(i,e,t){const n=un();n.firstCreatePass&&(lI(n,new sI(i,e,t),-1),2==(2&e)&&(n.staticViewQueries=!0)),aI(n,be(),e)}function pi(i,e,t,n){const r=un();if(r.firstCreatePass){const s=ki();lI(r,new sI(e,t,n),s.index),function M7(i,e){const t=i.contentQueries||(i.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(i.queries.length-1,e)}(r,i),2==(2&t)&&(r.staticContentQueries=!0)}aI(r,be(),t)}function Rt(){return function w7(i,e){return i[19].queries[e].queryList}(be(),UE())}function aI(i,e,t){const n=new rc(4==(4&t));ZA(i,e,n,n.destroy),null===e[19]&&(e[19]=new Yx),e[19].queries.push(new Zx(n))}function lI(i,e,t){null===i.queries&&(i.queries=new Qx),i.queries.track(new $x(e,t))}function cI(i,e){return i.queries.getByIndex(e)}function uI(i,e){return wg(i,e)}function Sg(...i){}const rw=new He("Application Initializer");let Tg=(()=>{class i{constructor(t){this.appInits=t,this.resolve=Sg,this.reject=Sg,this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],n=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(ef(s))t.push(s);else if(Dx(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{n()}).catch(r=>{this.reject(r)}),0===t.length&&n(),this.initialized=!0}}return i.\u0275fac=function(t){return new(t||i)(re(rw,8))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const gf=new He("AppId",{providedIn:"root",factory:function AI(){return`${sw()}${sw()}${sw()}`}});function sw(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const DI=new He("Platform Initializer"),_f=new He("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),PI=new He("appBootstrapListener"),Ar=new He("AnimationModuleType");let H7=(()=>{class i{log(t){console.log(t)}warn(t){console.warn(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();const ko=new He("LocaleId",{providedIn:"root",factory:()=>ql(ko,Ct.Optional|Ct.SkipSelf)||function G7(){return typeof $localize<"u"&&$localize.locale||Wu}()});class X7{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let ow=(()=>{class i{compileModuleSync(t){return new Xx(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const n=this.compileModuleSync(t),s=la(Qr(t).declarations).reduce((o,a)=>{const l=kn(a);return l&&o.push(new Wx(l)),o},[]);return new X7(n,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const q7=(()=>Promise.resolve(0))();function aw(i){typeof Zone>"u"?q7.then(()=>{i&&i.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",i)}class Pt{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new yt(!1),this.onMicrotaskEmpty=new yt(!1),this.onStable=new yt(!1),this.onError=new yt(!1),typeof Zone>"u")throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&t,r.shouldCoalesceRunChangeDetection=n,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function Z7(){let i=Dn.requestAnimationFrame,e=Dn.cancelAnimationFrame;if(typeof Zone<"u"&&i&&e){const t=i[Zone.__symbol__("OriginalDelegate")];t&&(i=t);const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function $7(i){const e=()=>{!function Q7(i){i.isCheckStableRunning||-1!==i.lastRequestAnimationFrameId||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(Dn,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,cw(i),i.isCheckStableRunning=!0,lw(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),cw(i))}(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,r,s,o,a)=>{try{return II(i),t.invokeTask(r,s,o,a)}finally{(i.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||i.shouldCoalesceRunChangeDetection)&&e(),FI(i)}},onInvoke:(t,n,r,s,o,a,l)=>{try{return II(i),t.invoke(r,s,o,a,l)}finally{i.shouldCoalesceRunChangeDetection&&e(),FI(i)}},onHasTask:(t,n,r,s)=>{t.hasTask(r,s),n===r&&("microTask"==s.change?(i._hasPendingMicrotasks=s.microTask,cw(i),lw(i)):"macroTask"==s.change&&(i.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,n,r,s)=>(t.handleError(r,s),i.runOutsideAngular(()=>i.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Pt.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Pt.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,Y7,Sg,Sg);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const Y7={};function lw(i){if(0==i._nesting&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function cw(i){i.hasPendingMicrotasks=!!(i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&-1!==i.lastRequestAnimationFrameId)}function II(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function FI(i){i._nesting--,lw(i)}class J7{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new yt,this.onMicrotaskEmpty=new yt,this.onStable=new yt,this.onError=new yt}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,r){return e.apply(t,n)}}const LI=new He(""),Cg=new He("");let dw,uw=(()=>{class i{constructor(t,n,r){this._ngZone=t,this.registry=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,dw||(function e9(i){dw=i}(r),r.addToWindow(n)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Pt.assertNotInAngularZone(),aw(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())aw(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(n=>!n.updateCb||!n.updateCb(t)||(clearTimeout(n.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,n,r){let s=-1;n&&n>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},n)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,n,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,n,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,n,r){return[]}}return i.\u0275fac=function(t){return new(t||i)(re(Pt),re(hw),re(Cg))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})(),hw=(()=>{class i{constructor(){this._applications=new Map}registerApplication(t,n){this._applications.set(t,n)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,n=!0){return dw?.findTestabilityInTree(this,t,n)??null}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})(),Ya=null;const OI=new He("AllowMultipleToken"),kI=new He("PlatformOnDestroy");class NI{constructor(e,t){this.name=e,this.token=t}}function UI(i,e,t=[]){const n=`Platform: ${e}`,r=new He(n);return(s=[])=>{let o=fw();if(!o||o.injector.get(OI,!1)){const a=[...t,...s,{provide:r,useValue:!0}];i?i(a):function i9(i){if(Ya&&!Ya.get(OI,!1))throw new et(400,"");Ya=i;const e=i.get(jI);(function BI(i){const e=i.get(DI,null);e&&e.forEach(t=>t())})(i)}(function VI(i=[],e){return Xi.create({name:e,providers:[{provide:Gb,useValue:"platform"},{provide:kI,useValue:()=>Ya=null},...i]})}(a,n))}return function s9(i){const e=fw();if(!e)throw new et(401,"");return e}()}}function fw(){return Ya?.get(jI)??null}let jI=(()=>{class i{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,n){const r=function o9(i,e){let t;return t="noop"===i?new J7:("zone.js"===i?void 0:i)||new Pt(e),t}(n?.ngZone,function zI(i){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!i||!i.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!i||!i.ngZoneRunCoalescing)||!1}}(n)),s=[{provide:Pt,useValue:r}];return r.run(()=>{const o=Xi.create({providers:s,parent:this.injector,name:t.moduleType.name}),a=t.create(o),l=a.injector.get(aa,null);if(!l)throw new et(402,"");return r.runOutsideAngular(()=>{const c=r.onError.subscribe({next:u=>{l.handleError(u)}});a.onDestroy(()=>{Eg(this._modules,a),c.unsubscribe()})}),function HI(i,e,t){try{const n=t();return ef(n)?n.catch(r=>{throw e.runOutsideAngular(()=>i.handleError(r)),r}):n}catch(n){throw e.runOutsideAngular(()=>i.handleError(n)),n}}(l,r,()=>{const c=a.injector.get(Tg);return c.runInitializers(),c.donePromise.then(()=>(function xP(i){Yr(i,"Expected localeId to be defined"),"string"==typeof i&&(bP=i.toLowerCase().replace(/_/g,"-"))}(a.injector.get(ko,Wu)||Wu),this._moduleDoBootstrap(a),a))})})}bootstrapModule(t,n=[]){const r=GI({},n);return function t9(i,e,t){const n=new Xx(t);return Promise.resolve(n)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const n=t.injector.get(vf);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>n.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new et(403,"");t.instance.ngDoBootstrap(n)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new et(404,"");this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n()),this._injector.get(kI,null)?.(),this._destroyed=!0}get destroyed(){return this._destroyed}}return i.\u0275fac=function(t){return new(t||i)(re(Xi))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();function GI(i,e){return Array.isArray(e)?e.reduce(GI,i):{...i,...e}}let vf=(()=>{class i{constructor(t,n,r,s){this._zone=t,this._injector=n,this._exceptionHandler=r,this._initStatus=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new wn(l=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{l.next(this._stable),l.complete()})}),a=new wn(l=>{let c;this._zone.runOutsideAngular(()=>{c=this._zone.onStable.subscribe(()=>{Pt.assertNotInAngularZone(),aw(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,l.next(!0))})})});const u=this._zone.onUnstable.subscribe(()=>{Pt.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{l.next(!1)}))});return()=>{c.unsubscribe(),u.unsubscribe()}});this.isStable=lu(o,a.pipe(Ay()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,n){const r=t instanceof qP;if(!this._initStatus.done)throw!r&&function Zu(i){const e=kn(i)||wr(i)||Mr(i);return null!==e&&e.standalone}(t),new et(405,false);let s;s=r?t:this._injector.get(qa).resolveComponentFactory(t),this.componentTypes.push(s.componentType);const o=function n9(i){return i.isBoundToModule}(s)?void 0:this._injector.get(Za),l=s.create(Xi.NULL,[],n||s.selector,o),c=l.location.nativeElement,u=l.injector.get(LI,null);return u?.registerApplication(c),l.onDestroy(()=>{this.detachView(l.hostView),Eg(this.components,l),u?.unregisterApplication(c)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new et(101,"");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const n=t;this._views.push(n),n.attachToAppRef(this)}detachView(t){const n=t;Eg(this._views,n),n.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(PI,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Eg(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new et(406,false);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return i.\u0275fac=function(t){return new(t||i)(re(Pt),re(Xi),re(aa),re(Tg))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function Eg(i,e){const t=i.indexOf(e);t>-1&&i.splice(t,1)}let XI=!0,Ci=(()=>{class i{}return i.__NG_ELEMENT_ID__=c9,i})();function c9(i){return function u9(i,e,t){if(Em(i)&&!t){const n=Jr(i.index,e);return new hf(n,n)}return 47&i.type?new hf(e[16],e):null}(ki(),be(),16==(16&i))}class QI{constructor(){}supports(e){return $d(e)}create(e){return new g9(e)}}const m9=(i,e)=>e;class g9{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||m9}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,r=0,s=null;for(;t||n;){const o=!n||t&&t.currentIndex<JI(n,r,s)?t:n,a=JI(o,r,s),l=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let d=0;d<c;d++){const f=d<s.length?s[d]:s[d]=0,p=f+d;u<=p&&p<c&&(s[d]=f+1)}s[o.previousIndex]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!$d(e))throw new et(900,"");return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,n=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),n=!0),t=t._next}else r=0,function H8(i,e){if(Array.isArray(i))for(let t=0;t<i.length;t++)e(i[t]);else{const t=i[Jl()]();let n;for(;!(n=t.next()).done;)e(n.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),n=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new _9(t,n),s,r),e}_verifyReinsertion(e,t,n,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new $I),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new $I),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class _9{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class v9{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class $I{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new v9,this.map.set(t,n)),n.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function JI(i,e,t){const n=i.previousIndex;if(null===n)return n;let r=0;return t&&n<t.length&&(r=t[n]),n+e+r}class e2{constructor(){}supports(e){return e instanceof Map||Tx(e)}create(){return new y9}}class y9{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||Tx(e)))throw new et(900,"")}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(n,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,n),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,n);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let n=t;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const n=new b9(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}}class b9{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function t2(){return new Dg([new QI])}let Dg=(()=>{class i{constructor(t){this.factories=t}static create(t,n){if(null!=n){const r=n.factories.slice();t=t.concat(r)}return new i(t)}static extend(t){return{provide:i,useFactory:n=>i.create(t,n||t2()),deps:[[i,new Su,new ys]]}}find(t){const n=this.factories.find(r=>r.supports(t));if(null!=n)return n;throw new et(901,"")}}return i.\u0275prov=We({token:i,providedIn:"root",factory:t2}),i})();function n2(){return new yf([new e2])}let yf=(()=>{class i{constructor(t){this.factories=t}static create(t,n){if(n){const r=n.factories.slice();t=t.concat(r)}return new i(t)}static extend(t){return{provide:i,useFactory:n=>i.create(t,n||n2()),deps:[[i,new Su,new ys]]}}find(t){const n=this.factories.find(s=>s.supports(t));if(n)return n;throw new et(901,"")}}return i.\u0275prov=We({token:i,providedIn:"root",factory:n2}),i})();const M9=UI(null,"core",[]);let S9=(()=>{class i{constructor(t){}}return i.\u0275fac=function(t){return new(t||i)(re(vf))},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({}),i})();function da(i){return"boolean"==typeof i?i:null!=i&&"false"!==i}let Pg=null;function Bo(){return Pg}const Vt=new He("DocumentToken");let bf=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=We({token:i,factory:function(){return function R9(){return re(r2)}()},providedIn:"platform"}),i})();const A9=new He("Location Initialized");let r2=(()=>{class i extends bf{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Bo().getBaseHref(this._doc)}onPopState(t){const n=Bo().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",t,!1),()=>n.removeEventListener("popstate",t)}onHashChange(t){const n=Bo().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",t,!1),()=>n.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,n,r){s2()?this._history.pushState(t,n,r):this.location.hash=r}replaceState(t,n,r){s2()?this._history.replaceState(t,n,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return i.\u0275fac=function(t){return new(t||i)(re(Vt))},i.\u0275prov=We({token:i,factory:function(){return function D9(){return new r2(re(Vt))}()},providedIn:"platform"}),i})();function s2(){return!!window.history.pushState}function vw(i,e){if(0==i.length)return e;if(0==e.length)return i;let t=0;return i.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?i+e.substring(1):1==t?i+e:i+"/"+e}function o2(i){const e=i.match(/#|\?|$/),t=e&&e.index||i.length;return i.slice(0,t-("/"===i[t-1]?1:0))+i.slice(t)}function fa(i){return i&&"?"!==i[0]?"?"+i:i}let Qu=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=We({token:i,factory:function(){return function P9(){const i=re(Vt).location;return new a2(re(bf),i&&i.origin||"")}()},providedIn:"root"}),i})();const yw=new He("appBaseHref");let a2=(()=>{class i extends Qu{constructor(t,n){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==n&&(n=this._platformLocation.getBaseHrefFromDOM()),null==n)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=n}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return vw(this._baseHref,t)}path(t=!1){const n=this._platformLocation.pathname+fa(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${n}${r}`:n}pushState(t,n,r,s){const o=this.prepareExternalUrl(r+fa(s));this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){const o=this.prepareExternalUrl(r+fa(s));this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return i.\u0275fac=function(t){return new(t||i)(re(bf),re(yw,8))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})(),I9=(()=>{class i extends Qu{constructor(t,n){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let n=this._platformLocation.hash;return null==n&&(n="#"),n.length>0?n.substring(1):n}prepareExternalUrl(t){const n=vw(this._baseHref,t);return n.length>0?"#"+n:n}pushState(t,n,r,s){let o=this.prepareExternalUrl(r+fa(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){let o=this.prepareExternalUrl(r+fa(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return i.\u0275fac=function(t){return new(t||i)(re(bf),re(yw,8))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})(),Ig=(()=>{class i{constructor(t){this._subject=new yt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const n=this._locationStrategy.getBaseHref();this._baseHref=o2(l2(n)),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,n=""){return this.path()==this.normalize(t+fa(n))}normalize(t){return i.stripTrailingSlash(function L9(i,e){return i&&e.startsWith(i)?e.substring(i.length):e}(this._baseHref,l2(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,n="",r=null){this._locationStrategy.pushState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+fa(n)),r)}replaceState(t,n="",r=null){this._locationStrategy.replaceState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+fa(n)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)})),()=>{const n=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(n,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",n){this._urlChangeListeners.forEach(r=>r(t,n))}subscribe(t,n,r){return this._subject.subscribe({next:t,error:n,complete:r})}}return i.normalizeQueryParams=fa,i.joinWithSlash=vw,i.stripTrailingSlash=o2,i.\u0275fac=function(t){return new(t||i)(re(Qu))},i.\u0275prov=We({token:i,factory:function(){return function F9(){return new Ig(re(Qu))}()},providedIn:"root"}),i})();function l2(i){return i.replace(/\/index.html$/,"")}function _2(i,e){e=encodeURIComponent(e);for(const t of i.split(";")){const n=t.indexOf("="),[r,s]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}let v2=(()=>{class i{constructor(t,n,r,s){this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&($d(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(n=>this._toggleClass(n.key,n.currentValue)),t.forEachChangedItem(n=>this._toggleClass(n.key,n.currentValue)),t.forEachRemovedItem(n=>{n.previousValue&&this._toggleClass(n.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(n=>{if("string"!=typeof n.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${On(n.item)}`);this._toggleClass(n.item,!0)}),t.forEachRemovedItem(n=>this._toggleClass(n.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(n=>this._toggleClass(n,!0)):Object.keys(t).forEach(n=>this._toggleClass(n,!!t[n])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(n=>this._toggleClass(n,!1)):Object.keys(t).forEach(n=>this._toggleClass(n,!1)))}_toggleClass(t,n){(t=t.trim())&&t.split(/\s+/g).forEach(r=>{n?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return i.\u0275fac=function(t){return new(t||i)(N(Dg),N(yf),N(Kt),N(ha))},i.\u0275dir=tt({type:i,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),i})(),y2=(()=>{class i{constructor(t){this._viewContainerRef=t,this.ngComponentOutlet=null}ngOnChanges(t){const{_viewContainerRef:n,ngComponentOutletNgModule:r,ngComponentOutletNgModuleFactory:s}=this;if(n.clear(),this._componentRef=void 0,this.ngComponentOutlet){const o=this.ngComponentOutletInjector||n.parentInjector;(t.ngComponentOutletNgModule||t.ngComponentOutletNgModuleFactory)&&(this._moduleRef&&this._moduleRef.destroy(),this._moduleRef=r?function KW(i,e){return new YP(i,e??null)}(r,b2(o)):s?s.create(b2(o)):void 0),this._componentRef=n.createComponent(this.ngComponentOutlet,{index:n.length,injector:o,ngModuleRef:this._moduleRef,projectableNodes:this.ngComponentOutletContent})}}ngOnDestroy(){this._moduleRef&&this._moduleRef.destroy()}}return i.\u0275fac=function(t){return new(t||i)(N(zr))},i.\u0275dir=tt({type:i,selectors:[["","ngComponentOutlet",""]],inputs:{ngComponentOutlet:"ngComponentOutlet",ngComponentOutletInjector:"ngComponentOutletInjector",ngComponentOutletContent:"ngComponentOutletContent",ngComponentOutletNgModule:"ngComponentOutletNgModule",ngComponentOutletNgModuleFactory:"ngComponentOutletNgModuleFactory"},features:[$i]}),i})();function b2(i){return i.get(Za).injector}class _X{constructor(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let oc=(()=>{class i{constructor(t,n,r){this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const n=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)n.createEmbeddedView(this._template,new _X(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)n.remove(null===s?void 0:s);else if(null!==s){const a=n.get(s);n.move(a,o),x2(a,r)}});for(let r=0,s=n.length;r<s;r++){const a=n.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{x2(n.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(N(zr),N(Js),N(Dg))},i.\u0275dir=tt({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),i})();function x2(i,e){i.context.$implicit=e.item}let $u=(()=>{class i{constructor(t,n){this._viewContainer=t,this._context=new vX,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){w2("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){w2("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(N(zr),N(Js))},i.\u0275dir=tt({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),i})();class vX{constructor(){this.$implicit=null,this.ngIf=null}}function w2(i,e){if(e&&!e.createEmbeddedView)throw new Error(`${i} must be a TemplateRef, but received '${On(e)}'.`)}class Aw{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let zg=(()=>{class i{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(t)}_matchCase(t){const n=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||n,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),n}_updateDefaultCases(t){if(this._defaultViews&&t!==this._defaultUsed){this._defaultUsed=t;for(let n=0;n<this._defaultViews.length;n++)this._defaultViews[n].enforceState(t)}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=tt({type:i,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),i})(),M2=(()=>{class i{constructor(t,n,r){this.ngSwitch=r,r._addCase(),this._view=new Aw(t,n)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return i.\u0275fac=function(t){return new(t||i)(N(zr),N(Js),N(zg,9))},i.\u0275dir=tt({type:i,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),i})();class wX{createSubscription(e,t){return e.subscribe({next:t,error:n=>{throw n}})}dispose(e){e.unsubscribe()}}class MX{createSubscription(e,t){return e.then(t,n=>{throw n})}dispose(e){}}const SX=new MX,TX=new wX;let Dw=(()=>{class i{constructor(t){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,n=>this._updateLatestValue(t,n))}_selectStrategy(t){if(ef(t))return SX;if(DD(t))return TX;throw function to(i,e){return new et(2100,"")}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,n){t===this._obj&&(this._latestValue=n,this._ref.markForCheck())}}return i.\u0275fac=function(t){return new(t||i)(N(Ci,16))},i.\u0275pipe=Qi({name:"async",type:i,pure:!1}),i})(),Qa=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({}),i})();const E2="browser";function R2(i){return i===E2}let WX=(()=>{class i{}return i.\u0275prov=We({token:i,providedIn:"root",factory:()=>new XX(re(Vt),window)}),i})();class XX{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function KX(i,e){const t=i.getElementById(e)||i.getElementsByName(e)[0];if(t)return t;if("function"==typeof i.createTreeWalker&&i.body&&(i.body.createShadowRoot||i.body.attachShadow)){const n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT);let r=n.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=A2(this.window.history)||A2(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function A2(i){return Object.getOwnPropertyDescriptor(i,"scrollRestoration")}class D2{}class Fw extends class qX extends class E9{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function C9(i){Pg||(Pg=i)}(new Fw)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function ZX(){return Mf=Mf||document.querySelector("base"),Mf?Mf.getAttribute("href"):null}();return null==t?null:function YX(i){Hg=Hg||document.createElement("a"),Hg.setAttribute("href",i);const e=Hg.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Mf=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return _2(document.cookie,e)}}let Hg,Mf=null;const P2=new He("TRANSITION_ID"),$X=[{provide:rw,useFactory:function QX(i,e,t){return()=>{t.get(Tg).donePromise.then(()=>{const n=Bo(),r=e.querySelectorAll(`style[ng-transition="${i}"]`);for(let s=0;s<r.length;s++)n.remove(r[s])})}},deps:[P2,Vt,Xi],multi:!0}];let eK=(()=>{class i{build(){return new XMLHttpRequest}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();const Gg=new He("EventManagerPlugins");let Wg=(()=>{class i{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,n,r){return this._findPluginFor(n).addEventListener(t,n,r)}addGlobalEventListener(t,n,r){return this._findPluginFor(n).addGlobalEventListener(t,n,r)}getZone(){return this._zone}_findPluginFor(t){const n=this._eventNameToPlugin.get(t);if(n)return n;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return i.\u0275fac=function(t){return new(t||i)(re(Gg),re(Pt))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();class I2{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const r=Bo().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,n)}}let F2=(()=>{class i{constructor(){this._stylesSet=new Set}addStyles(t){const n=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),n.add(r))}),this.onStylesAdded(n)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})(),Sf=(()=>{class i extends F2{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,n,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(n.appendChild(o))})}addHost(t){const n=[];this._addStylesToHost(this._stylesSet,t,n),this._hostNodes.set(t,n)}removeHost(t){const n=this._hostNodes.get(t);n&&n.forEach(L2),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((n,r)=>{this._addStylesToHost(t,r,n)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(L2))}}return i.\u0275fac=function(t){return new(t||i)(re(Vt))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();function L2(i){Bo().remove(i)}const Lw={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Ow=/%COMP%/g;function Xg(i,e,t){for(let n=0;n<e.length;n++){let r=e[n];Array.isArray(r)?Xg(i,r,t):(r=r.replace(Ow,i),t.push(r))}return t}function N2(i){return e=>{if("__ngUnwrap__"===e)return i;!1===i(e)&&(e.preventDefault(),e.returnValue=!1)}}let Kg=(()=>{class i{constructor(t,n,r){this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new kw(t)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;switch(n.encapsulation){case Gs.Emulated:{let r=this.rendererByCompId.get(n.id);return r||(r=new oK(this.eventManager,this.sharedStylesHost,n,this.appId),this.rendererByCompId.set(n.id,r)),r.applyToHost(t),r}case 1:case Gs.ShadowDom:return new aK(this.eventManager,this.sharedStylesHost,t,n);default:if(!this.rendererByCompId.has(n.id)){const r=Xg(n.id,n.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(n.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return i.\u0275fac=function(t){return new(t||i)(re(Wg),re(Sf),re(gf))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();class kw{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(Lw[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(U2(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(U2(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;const s=Lw[r];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const r=Lw[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(is.DashCase|is.Important)?e.style.setProperty(t,n,r&is.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&is.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,N2(n)):this.eventManager.addEventListener(e,t,N2(n))}}function U2(i){return"TEMPLATE"===i.tagName&&void 0!==i.content}class oK extends kw{constructor(e,t,n,r){super(e),this.component=n;const s=Xg(r+"-"+n.id,n.styles,[]);t.addStyles(s),this.contentAttr=function iK(i){return"_ngcontent-%COMP%".replace(Ow,i)}(r+"-"+n.id),this.hostAttr=function rK(i){return"_nghost-%COMP%".replace(Ow,i)}(r+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class aK extends kw{constructor(e,t,n,r){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=Xg(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let lK=(()=>{class i extends I2{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,r){return t.addEventListener(n,r,!1),()=>this.removeEventListener(t,n,r)}removeEventListener(t,n,r){return t.removeEventListener(n,r)}}return i.\u0275fac=function(t){return new(t||i)(re(Vt))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();const V2=["alt","control","meta","shift"],uK={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},j2={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},hK={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let dK=(()=>{class i extends I2{constructor(t){super(t)}supports(t){return null!=i.parseEventName(t)}addEventListener(t,n,r){const s=i.parseEventName(n),o=i.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Bo().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const n=t.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const s=i._normalizeKey(n.pop());let o="";if(V2.forEach(l=>{const c=n.indexOf(l);c>-1&&(n.splice(c,1),o+=l+".")}),o+=s,0!=n.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let n="",r=function fK(i){let e=i.key;if(null==e){if(e=i.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===i.location&&j2.hasOwnProperty(e)&&(e=j2[e]))}return uK[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),V2.forEach(s=>{s!=r&&hK[s](t)&&(n+=s+".")}),n+=r,n}static eventCallback(t,n,r){return s=>{i.getEventFullKey(s)===t&&r.runGuarded(()=>n(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return i.\u0275fac=function(t){return new(t||i)(re(Vt))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();const z2=[{provide:_f,useValue:E2},{provide:DI,useValue:function pK(){Fw.makeCurrent()},multi:!0},{provide:Vt,useFactory:function gK(){return function Dz(i){Xy=i}(document),document},deps:[]}],_K=UI(M9,"browser",z2),H2=new He(""),G2=[{provide:Cg,useClass:class JX{addToWindow(e){Dn.getAngularTestability=(n,r=!0)=>{const s=e.findTestabilityInTree(n,r);if(null==s)throw new Error("Could not find testability for element.");return s},Dn.getAllAngularTestabilities=()=>e.getAllTestabilities(),Dn.getAllAngularRootElements=()=>e.getAllRootElements(),Dn.frameworkStabilizers||(Dn.frameworkStabilizers=[]),Dn.frameworkStabilizers.push(n=>{const r=Dn.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&n(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,n){return null==t?null:e.getTestability(t)??(n?Bo().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:LI,useClass:uw,deps:[Pt,hw,Cg]},{provide:uw,useClass:uw,deps:[Pt,hw,Cg]}],W2=[{provide:Gb,useValue:"root"},{provide:aa,useFactory:function mK(){return new aa},deps:[]},{provide:Gg,useClass:lK,multi:!0,deps:[Vt,Pt,_f]},{provide:Gg,useClass:dK,multi:!0,deps:[Vt]},{provide:Kg,useClass:Kg,deps:[Wg,Sf,gf]},{provide:uf,useExisting:Kg},{provide:F2,useExisting:Sf},{provide:Sf,useClass:Sf,deps:[Vt]},{provide:Wg,useClass:Wg,deps:[Gg,Pt]},{provide:D2,useClass:eK,deps:[]},[]];let X2=(()=>{class i{constructor(t){}static withServerTransition(t){return{ngModule:i,providers:[{provide:gf,useValue:t.appId},{provide:P2,useExisting:gf},$X]}}}return i.\u0275fac=function(t){return new(t||i)(re(H2,12))},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({providers:[...W2,...G2],imports:[Qa,S9]}),i})(),K2=(()=>{class i{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return i.\u0275fac=function(t){return new(t||i)(re(Vt))},i.\u0275prov=We({token:i,factory:function(t){let n=null;return n=t?new t:function yK(){return new K2(re(Vt))}(),n},providedIn:"root"}),i})();typeof window<"u"&&window;let qg=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=We({token:i,factory:function(t){let n=null;return n=t?new(t||i):re(Y2),n},providedIn:"root"}),i})(),Y2=(()=>{class i extends qg{constructor(t){super(),this._doc=t}sanitize(t,n){if(null==n)return null;switch(t){case pn.NONE:return n;case pn.HTML:return Ao(n,"HTML")?ns(n):AR(this._doc,String(n)).toString();case pn.STYLE:return Ao(n,"Style")?ns(n):n;case pn.SCRIPT:if(Ao(n,"Script"))return ns(n);throw new Error("unsafe value used in a script context");case pn.URL:return xR(n),Ao(n,"URL")?ns(n):Gd(String(n));case pn.RESOURCE_URL:if(Ao(n,"ResourceURL"))return ns(n);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(t){return function K5(i){return new z5(i)}(t)}bypassSecurityTrustStyle(t){return function q5(i){return new H5(i)}(t)}bypassSecurityTrustScript(t){return function Z5(i){return new G5(i)}(t)}bypassSecurityTrustUrl(t){return function Y5(i){return new W5(i)}(t)}bypassSecurityTrustResourceUrl(t){return function Q5(i){return new X5(i)}(t)}}return i.\u0275fac=function(t){return new(t||i)(re(Vt))},i.\u0275prov=We({token:i,factory:function(t){let n=null;return n=t?new t:function EK(i){return new Y2(i.get(Vt))}(re(Xi)),n},providedIn:"root"}),i})();function Mt(...i){return _i(i,Cd(i))}class ss extends Lt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}const{isArray:RK}=Array,{getPrototypeOf:AK,prototype:DK,keys:PK}=Object;function Q2(i){if(1===i.length){const e=i[0];if(RK(e))return{args:e,keys:null};if(function IK(i){return i&&"object"==typeof i&&AK(i)===DK}(e)){const t=PK(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}const{isArray:FK}=Array;function Uw(i){return xt(e=>function LK(i,e){return FK(e)?i(...e):i(e)}(i,e))}function $2(i,e){return i.reduce((t,n,r)=>(t[n]=e[r],t),{})}function Vw(...i){const e=Cd(i),t=Ry(i),{args:n,keys:r}=Q2(i);if(0===n.length)return _i([],e);const s=new wn(function OK(i,e,t=ja){return n=>{J2(e,()=>{const{length:r}=i,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)J2(e,()=>{const c=_i(i[l],e);let u=!1;c.subscribe(Jn(n,h=>{s[l]=h,u||(u=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}(n,e,r?o=>$2(r,o):ja));return t?s.pipe(Uw(t)):s}function J2(i,e,t){i?ta(t,i,e):e()}function no(i,e){const t=cn(i)?i:()=>i,n=r=>r.error(t());return new wn(e?r=>e.schedule(n,0,r):n)}const Tf=_y(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});function Zg(...i){return function kK(){return au(1)}()(_i(i,Cd(i)))}function eF(i){return new wn(e=>{Nr(i()).subscribe(e)})}function Yg(){return ui((i,e)=>{let t=null;i._refCount++;const n=Jn(e,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(t=null);const r=i._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});i.subscribe(n),n.closed||(t=i.connect())})}class jw extends wn{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,tE(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new $n;const t=this.getSubject();e.add(this.source.subscribe(Jn(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=$n.EMPTY)}return e}refCount(){return Yg()(this)}}function Uo(i,e){return ui((t,n)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&n.complete();t.subscribe(Jn(n,l=>{r?.unsubscribe();let c=0;const u=s++;Nr(i(l,u)).subscribe(r=Jn(n,h=>n.next(e?e(l,h,u,c++):h),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function ma(...i){const e=Cd(i);return ui((t,n)=>{(e?Zg(i,t,e):Zg(i,t)).subscribe(n)})}function NK(i,e,t,n,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(Jn(o,u=>{const h=c++;l=a?i(l,u,h):(a=!0,u),n&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function tF(i,e){return ui(NK(i,e,arguments.length>=2,!0))}function Vi(i,e){return ui((t,n)=>{let r=0;t.subscribe(Jn(n,s=>i.call(e,s,r++)&&n.next(s)))})}function io(i){return ui((e,t)=>{let s,n=null,r=!1;n=e.subscribe(Jn(t,void 0,void 0,o=>{s=Nr(i(o,io(i)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):r=!0})),r&&(n.unsubscribe(),n=null,s.subscribe(t))})}function Ju(i,e){return cn(e)?Gi(i,e,1):Gi(i,1)}function zw(i){return i<=0?()=>xr:ui((e,t)=>{let n=[];e.subscribe(Jn(t,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(const r of n)t.next(r);t.complete()},void 0,()=>{n=null}))})}function nF(i=BK){return ui((e,t)=>{let n=!1;e.subscribe(Jn(t,r=>{n=!0,t.next(r)},()=>n?t.complete():t.error(i())))})}function BK(){return new Tf}function Hw(i){return ui((e,t)=>{let n=!1;e.subscribe(Jn(t,r=>{n=!0,t.next(r)},()=>{n||t.next(i),t.complete()}))})}function ac(i,e){const t=arguments.length>=2;return n=>n.pipe(i?Vi((r,s)=>i(r,s,n)):ja,Br(1),t?Hw(e):nF(()=>new Tf))}function Gn(i,e,t){const n=cn(i)||e||t?{next:i,error:e,complete:t}:i;return n?ui((r,s)=>{var o;null===(o=n.subscribe)||void 0===o||o.call(n);let a=!0;r.subscribe(Jn(s,l=>{var c;null===(c=n.next)||void 0===c||c.call(n,l),s.next(l)},()=>{var l;a=!1,null===(l=n.complete)||void 0===l||l.call(n),s.complete()},l=>{var c;a=!1,null===(c=n.error)||void 0===c||c.call(n,l),s.error(l)},()=>{var l,c;a&&(null===(l=n.unsubscribe)||void 0===l||l.call(n)),null===(c=n.finalize)||void 0===c||c.call(n)}))}):ja}function Gw(i){return xt(()=>i)}function Qg(i){return ui((e,t)=>{try{e.subscribe(t)}finally{t.add(i)}})}class ga{constructor(e,t){this.id=e,this.url=t}}class Ww extends ga{constructor(e,t,n="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Cf extends ga{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class iF extends ga{constructor(e,t,n){super(e,t),this.reason=n,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class VK extends ga{constructor(e,t,n){super(e,t),this.error=n,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class jK extends ga{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class zK extends ga{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class HK extends ga{constructor(e,t,n,r,s){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class GK extends ga{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class WK extends ga{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class XK{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class KK{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class qK{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ZK{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class YK{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class QK{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class rF{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Qt="primary";class $K{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function eh(i){return new $K(i)}const sF="ngNavigationCancelingError";function Xw(i){const e=Error("NavigationCancelingError: "+i);return e[sF]=!0,e}function eq(i,e,t){const n=t.path.split("/");if(n.length>i.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<i.length))return null;const r={};for(let s=0;s<n.length;s++){const o=n[s],a=i[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function Vo(i,e){const t=i?Object.keys(i):void 0,n=e?Object.keys(e):void 0;if(!t||!n||t.length!=n.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!oF(i[r],e[r]))return!1;return!0}function oF(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;const t=[...i].sort(),n=[...e].sort();return t.every((r,s)=>n[s]===r)}return i===e}function aF(i){return Array.prototype.concat.apply([],i)}function lF(i){return i.length>0?i[i.length-1]:null}function er(i,e){for(const t in i)i.hasOwnProperty(t)&&e(i[t],t)}function ro(i){return Dx(i)?i:ef(i)?_i(Promise.resolve(i)):Mt(i)}const iq={exact:function hF(i,e,t){if(!cc(i.segments,e.segments)||!$g(i.segments,e.segments,t)||i.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!i.children[n]||!hF(i.children[n],e.children[n],t))return!1;return!0},subset:dF},cF={exact:function rq(i,e){return Vo(i,e)},subset:function sq(i,e){return Object.keys(e).length<=Object.keys(i).length&&Object.keys(e).every(t=>oF(i[t],e[t]))},ignored:()=>!0};function uF(i,e,t){return iq[t.paths](i.root,e.root,t.matrixParams)&&cF[t.queryParams](i.queryParams,e.queryParams)&&!("exact"===t.fragment&&i.fragment!==e.fragment)}function dF(i,e,t){return fF(i,e,e.segments,t)}function fF(i,e,t,n){if(i.segments.length>t.length){const r=i.segments.slice(0,t.length);return!(!cc(r,t)||e.hasChildren()||!$g(r,t,n))}if(i.segments.length===t.length){if(!cc(i.segments,t)||!$g(i.segments,t,n))return!1;for(const r in e.children)if(!i.children[r]||!dF(i.children[r],e.children[r],n))return!1;return!0}{const r=t.slice(0,i.segments.length),s=t.slice(i.segments.length);return!!(cc(i.segments,r)&&$g(i.segments,r,n)&&i.children[Qt])&&fF(i.children[Qt],e,s,n)}}function $g(i,e,t){return e.every((n,r)=>cF[t](i[r].parameters,n.parameters))}class lc{constructor(e,t,n){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=eh(this.queryParams)),this._queryParamMap}toString(){return lq.serialize(this)}}class sn{constructor(e,t){this.segments=e,this.children=t,this.parent=null,er(t,(n,r)=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Jg(this)}}class Ef{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=eh(this.parameters)),this._parameterMap}toString(){return vF(this)}}function cc(i,e){return i.length===e.length&&i.every((t,n)=>t.path===e[n].path)}class pF{}class mF{parse(e){const t=new _q(e);return new lc(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Rf(e.root,!0)}`,n=function hq(i){const e=Object.keys(i).map(t=>{const n=i[t];return Array.isArray(n)?n.map(r=>`${e_(t)}=${e_(r)}`).join("&"):`${e_(t)}=${e_(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${n}${"string"==typeof e.fragment?`#${function cq(i){return encodeURI(i)}(e.fragment)}`:""}`}}const lq=new mF;function Jg(i){return i.segments.map(e=>vF(e)).join("/")}function Rf(i,e){if(!i.hasChildren())return Jg(i);if(e){const t=i.children[Qt]?Rf(i.children[Qt],!1):"",n=[];return er(i.children,(r,s)=>{s!==Qt&&n.push(`${s}:${Rf(r,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function aq(i,e){let t=[];return er(i.children,(n,r)=>{r===Qt&&(t=t.concat(e(n,r)))}),er(i.children,(n,r)=>{r!==Qt&&(t=t.concat(e(n,r)))}),t}(i,(n,r)=>r===Qt?[Rf(i.children[Qt],!1)]:[`${r}:${Rf(n,!1)}`]);return 1===Object.keys(i.children).length&&null!=i.children[Qt]?`${Jg(i)}/${t[0]}`:`${Jg(i)}/(${t.join("//")})`}}function gF(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function e_(i){return gF(i).replace(/%3B/gi,";")}function Kw(i){return gF(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function t_(i){return decodeURIComponent(i)}function _F(i){return t_(i.replace(/\+/g,"%20"))}function vF(i){return`${Kw(i.path)}${function uq(i){return Object.keys(i).map(e=>`;${Kw(e)}=${Kw(i[e])}`).join("")}(i.parameters)}`}const dq=/^[^\/()?;=#]+/;function n_(i){const e=i.match(dq);return e?e[0]:""}const fq=/^[^=?&#]+/,mq=/^[^&#]+/;class _q{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new sn([],{}):new sn([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[Qt]=new sn(e,t)),n}parseSegment(){const e=n_(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new Ef(t_(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=n_(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const r=n_(this.remaining);r&&(n=r,this.capture(n))}e[t_(t)]=t_(n)}parseQueryParam(e){const t=function pq(i){const e=i.match(fq);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const o=function gq(i){const e=i.match(mq);return e?e[0]:""}(this.remaining);o&&(n=o,this.capture(n))}const r=_F(t),s=_F(n);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=n_(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Qt);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[Qt]:new sn([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class yF{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=qw(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=qw(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Zw(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Zw(e,this._root).map(t=>t.value)}}function qw(i,e){if(i===e.value)return e;for(const t of e.children){const n=qw(i,t);if(n)return n}return null}function Zw(i,e){if(i===e.value)return[e];for(const t of e.children){const n=Zw(i,t);if(n.length)return n.unshift(e),n}return[]}class _a{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function th(i){const e={};return i&&i.children.forEach(t=>e[t.value.outlet]=t),e}class bF extends yF{constructor(e,t){super(e),this.snapshot=t,Yw(this,e)}toString(){return this.snapshot.toString()}}function xF(i,e){const t=function vq(i,e){const o=new i_([],{},{},"",{},Qt,e,null,i.root,-1,{});return new MF("",new _a(o,[]))}(i,e),n=new ss([new Ef("",{})]),r=new ss({}),s=new ss({}),o=new ss({}),a=new ss(""),l=new uc(n,r,o,a,s,Qt,e,t.root);return l.snapshot=t.root,new bF(new _a(l,[]),t)}class uc{constructor(e,t,n,r,s,o,a,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(xt(e=>eh(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(xt(e=>eh(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function wF(i,e="emptyOnly"){const t=i.pathFromRoot;let n=0;if("always"!==e)for(n=t.length-1;n>=1;){const r=t[n],s=t[n-1];if(r.routeConfig&&""===r.routeConfig.path)n--;else{if(s.component)break;n--}}return function yq(i){return i.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(n))}class i_{constructor(e,t,n,r,s,o,a,l,c,u,h,d){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=u,this._correctedLastPathIndex=d??u,this._resolve=h}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=eh(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=eh(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class MF extends yF{constructor(e,t){super(t),this.url=e,Yw(this,t)}toString(){return SF(this._root)}}function Yw(i,e){e.value._routerState=i,e.children.forEach(t=>Yw(i,t))}function SF(i){const e=i.children.length>0?` { ${i.children.map(SF).join(", ")} } `:"";return`${i.value}${e}`}function Qw(i){if(i.snapshot){const e=i.snapshot,t=i._futureSnapshot;i.snapshot=t,Vo(e.queryParams,t.queryParams)||i.queryParams.next(t.queryParams),e.fragment!==t.fragment&&i.fragment.next(t.fragment),Vo(e.params,t.params)||i.params.next(t.params),function tq(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;++t)if(!Vo(i[t],e[t]))return!1;return!0}(e.url,t.url)||i.url.next(t.url),Vo(e.data,t.data)||i.data.next(t.data)}else i.snapshot=i._futureSnapshot,i.data.next(i._futureSnapshot.data)}function $w(i,e){const t=Vo(i.params,e.params)&&function oq(i,e){return cc(i,e)&&i.every((t,n)=>Vo(t.parameters,e[n].parameters))}(i.url,e.url);return t&&!(!i.parent!=!e.parent)&&(!i.parent||$w(i.parent,e.parent))}function Af(i,e,t){if(t&&i.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const r=function xq(i,e,t){return e.children.map(n=>{for(const r of t.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return Af(i,n,r);return Af(i,n)})}(i,e,t);return new _a(n,r)}{if(i.shouldAttach(e.value)){const s=i.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Af(i,a)),o}}const n=function wq(i){return new uc(new ss(i.url),new ss(i.params),new ss(i.queryParams),new ss(i.fragment),new ss(i.data),i.outlet,i.component,i)}(e.value),r=e.children.map(s=>Af(i,s));return new _a(n,r)}}function r_(i){return"object"==typeof i&&null!=i&&!i.outlets&&!i.segmentPath}function Df(i){return"object"==typeof i&&null!=i&&i.outlets}function Jw(i,e,t,n,r){let s={};if(n&&er(n,(a,l)=>{s[l]=Array.isArray(a)?a.map(c=>`${c}`):`${a}`}),i===e)return new lc(t,s,r);const o=TF(i,e,t);return new lc(o,s,r)}function TF(i,e,t){const n={};return er(i.children,(r,s)=>{n[s]=r===e?t:TF(r,e,t)}),new sn(i.segments,n)}class CF{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&r_(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(Df);if(r&&r!==lF(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class eM{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function EF(i,e,t){if(i||(i=new sn([],{})),0===i.segments.length&&i.hasChildren())return s_(i,e,t);const n=function Rq(i,e,t){let n=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=t.length)return s;const o=i.segments[r],a=t[n];if(Df(a))break;const l=`${a}`,c=n<t.length-1?t[n+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!AF(l,c,o))return s;n+=2}else{if(!AF(l,{},o))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}(i,e,t),r=t.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){const s=new sn(i.segments.slice(0,n.pathIndex),{});return s.children[Qt]=new sn(i.segments.slice(n.pathIndex),i.children),s_(s,0,r)}return n.match&&0===r.length?new sn(i.segments,{}):n.match&&!i.hasChildren()?tM(i,e,t):n.match?s_(i,0,r):tM(i,e,t)}function s_(i,e,t){if(0===t.length)return new sn(i.segments,{});{const n=function Eq(i){return Df(i[0])?i[0].outlets:{[Qt]:i}}(t),r={};return er(n,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=EF(i.children[o],e,s))}),er(i.children,(s,o)=>{void 0===n[o]&&(r[o]=s)}),new sn(i.segments,r)}}function tM(i,e,t){const n=i.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(Df(s)){const l=Aq(s.outlets);return new sn(n,l)}if(0===r&&r_(t[0])){n.push(new Ef(i.segments[e].path,RF(t[0]))),r++;continue}const o=Df(s)?s.outlets[Qt]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&r_(a)?(n.push(new Ef(o,RF(a))),r+=2):(n.push(new Ef(o,{})),r++)}return new sn(n,{})}function Aq(i){const e={};return er(i,(t,n)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[n]=tM(new sn([],{}),0,t))}),e}function RF(i){const e={};return er(i,(t,n)=>e[n]=`${t}`),e}function AF(i,e,t){return i==t.path&&Vo(e,t.parameters)}class Dq{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Pf,this.attachRef=null}}class Pf{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new Dq,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}let nM=(()=>{class i{constructor(t,n,r,s,o){this.parentContexts=t,this.location=n,this.changeDetector=s,this.environmentInjector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new yt,this.deactivateEvents=new yt,this.attachEvents=new yt,this.detachEvents=new yt,this.name=r||Qt,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const r=this.location,o=t._futureSnapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new Pq(t,a,r.injector);if(n&&function Iq(i){return!!i.resolveComponentFactory}(n)){const c=n.resolveComponentFactory(o);this.activated=r.createComponent(c,r.length,l)}else this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:n??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return i.\u0275fac=function(t){return new(t||i)(N(Pf),N(zr),Kl("name"),N(Ci),N($l))},i.\u0275dir=tt({type:i,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),i})();class Pq{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===uc?this.route:e===Pf?this.childContexts:this.parent.get(e,t)}}let DF=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,n){1&t&&Ze(0,"router-outlet")},dependencies:[nM],encapsulation:2}),i})();function PF(i,e){return i.providers&&!i._injector&&(i._injector=bg(i.providers,e,`Route: ${i.path}`)),i._injector??e}function rM(i){const e=i.children&&i.children.map(rM),t=e?{...i,children:e}:{...i};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Qt&&(t.component=DF),t}function Ts(i){return i.outlet||Qt}function IF(i,e){const t=i.filter(n=>Ts(n)===e);return t.push(...i.filter(n=>Ts(n)!==e)),t}function FF(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let e=i.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class Nq{constructor(e,t,n,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),Qw(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const r=th(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],n),delete r[o]}),er(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=th(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(n&&n.outlet){const o=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=th(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(e,t,n){const r=th(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],n),this.forwardEvent(new QK(s.value.snapshot))}),e.children.length&&this.forwardEvent(new ZK(e.value.snapshot))}activateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(Qw(r),r===s)if(r.component){const o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(r.component){const o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Qw(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=FF(r.snapshot),l=a?.get(qa)??null;o.attachRef=null,o.route=r,o.resolver=l,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}function Ja(i){return"function"==typeof i}function hc(i){return i instanceof lc}const If=Symbol("INITIAL_VALUE");function Ff(){return Uo(i=>Vw(i.map(e=>e.pipe(Br(1),ma(If)))).pipe(tF((e,t)=>{let n=!1;return t.reduce((r,s,o)=>r!==If?r:(s===If&&(n=!0),n||!1!==s&&o!==t.length-1&&!hc(s)?r:s),e)},If),Vi(e=>e!==If),xt(e=>hc(e)?e:!0===e),Br(1)))}const LF={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function o_(i,e,t){if(""===e.path)return"full"===e.pathMatch&&(i.hasChildren()||t.length>0)?{...LF}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||eq)(t,i,e);if(!r)return{...LF};const s={};er(r.posParams,(a,l)=>{s[l]=a.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function a_(i,e,t,n,r="corrected"){if(t.length>0&&function Wq(i,e,t){return t.some(n=>l_(i,e,n)&&Ts(n)!==Qt)}(i,t,n)){const o=new sn(e,function Gq(i,e,t,n){const r={};r[Qt]=n,n._sourceSegment=i,n._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&Ts(s)!==Qt){const o=new sn([],{});o._sourceSegment=i,o._segmentIndexShift=e.length,r[Ts(s)]=o}return r}(i,e,n,new sn(t,i.children)));return o._sourceSegment=i,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:[]}}if(0===t.length&&function Xq(i,e,t){return t.some(n=>l_(i,e,n))}(i,t,n)){const o=new sn(i.segments,function Hq(i,e,t,n,r,s){const o={};for(const a of n)if(l_(i,t,a)&&!r[Ts(a)]){const l=new sn([],{});l._sourceSegment=i,l._segmentIndexShift="legacy"===s?i.segments.length:e.length,o[Ts(a)]=l}return{...r,...o}}(i,e,t,n,i.children,r));return o._sourceSegment=i,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:t}}const s=new sn(i.segments,i.children);return s._sourceSegment=i,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}function l_(i,e,t){return(!(i.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function OF(i,e,t,n){return!!(Ts(i)===n||n!==Qt&&l_(e,t,i))&&("**"===i.path||o_(e,i,t).matched)}function kF(i,e,t){return 0===e.length&&!i.children[t]}class c_{constructor(e){this.segmentGroup=e||null}}class NF{constructor(e){this.urlTree=e}}function Lf(i){return no(new c_(i))}function BF(i){return no(new NF(i))}class Yq{constructor(e,t,n,r,s){this.injector=e,this.configLoader=t,this.urlSerializer=n,this.urlTree=r,this.config=s,this.allowRedirects=!0}apply(){const e=a_(this.urlTree.root,[],[],this.config).segmentGroup,t=new sn(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,Qt).pipe(xt(s=>this.createUrlTree(sM(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(io(s=>{if(s instanceof NF)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof c_?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,Qt).pipe(xt(r=>this.createUrlTree(sM(r),e.queryParams,e.fragment))).pipe(io(r=>{throw r instanceof c_?this.noMatchError(r):r}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,n){const r=e.segments.length>0?new sn([],{[Qt]:e}):e;return new lc(r,t,n)}expandSegmentGroup(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(xt(s=>new sn([],s))):this.expandSegment(e,n,t,n.segments,r,!0)}expandChildren(e,t,n){const r=[];for(const s of Object.keys(n.children))"primary"===s?r.unshift(s):r.push(s);return _i(r).pipe(Ju(s=>{const o=n.children[s],a=IF(t,s);return this.expandSegmentGroup(e,a,o,s).pipe(xt(l=>({segment:l,outlet:s})))}),tF((s,o)=>(s[o.outlet]=o.segment,s),{}),function UK(i,e){const t=arguments.length>=2;return n=>n.pipe(i?Vi((r,s)=>i(r,s,n)):ja,zw(1),t?Hw(e):nF(()=>new Tf))}())}expandSegment(e,t,n,r,s,o){return _i(n).pipe(Ju(a=>this.expandSegmentAgainstRoute(e,t,n,a,r,s,o).pipe(io(c=>{if(c instanceof c_)return Mt(null);throw c}))),ac(a=>!!a),io((a,l)=>{if(a instanceof Tf||"EmptyError"===a.name)return kF(t,r,s)?Mt(new sn([],{})):Lf(t);throw a}))}expandSegmentAgainstRoute(e,t,n,r,s,o,a){return OF(r,t,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o):Lf(t):Lf(t)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,r){const s=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?BF(s):this.lineralizeSegments(n,s).pipe(Gi(o=>{const a=new sn(o,{});return this.expandSegment(e,a,t,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:u}=o_(t,r,s);if(!a)return Lf(t);const h=this.applyRedirectCommands(l,r.redirectTo,u);return r.redirectTo.startsWith("/")?BF(h):this.lineralizeSegments(r,h).pipe(Gi(d=>this.expandSegment(e,t,n,d.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,n,r,s){if("**"===n.path)return e=PF(n,e),n.loadChildren?(n._loadedRoutes?Mt({routes:n._loadedRoutes,injector:n._loadedInjector}):this.configLoader.loadChildren(e,n)).pipe(xt(h=>(n._loadedRoutes=h.routes,n._loadedInjector=h.injector,new sn(r,{})))):Mt(new sn(r,{}));const{matched:o,consumedSegments:a,remainingSegments:l}=o_(t,n,r);return o?(e=PF(n,e),this.getChildConfig(e,n,r).pipe(Gi(u=>{const h=u.injector??e,d=u.routes,{segmentGroup:f,slicedSegments:p}=a_(t,a,l,d),m=new sn(f.segments,f.children);if(0===p.length&&m.hasChildren())return this.expandChildren(h,d,m).pipe(xt(y=>new sn(a,y)));if(0===d.length&&0===p.length)return Mt(new sn(a,{}));const g=Ts(n)===s;return this.expandSegment(h,m,d,p,g?Qt:s,!0).pipe(xt(v=>new sn(a.concat(v.segments),v.children)))}))):Lf(t)}getChildConfig(e,t,n){return t.children?Mt({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Mt({routes:t._loadedRoutes,injector:t._loadedInjector}):this.runCanLoadGuards(e,t,n).pipe(Gi(r=>r?this.configLoader.loadChildren(e,t).pipe(Gn(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function qq(i){return no(Xw(`Cannot load children because the guard of the route "path: '${i.path}'" returned false`))}(t))):Mt({routes:[],injector:e})}runCanLoadGuards(e,t,n){const r=t.canLoad;return r&&0!==r.length?Mt(r.map(o=>{const a=e.get(o);let l;if(function Uq(i){return i&&Ja(i.canLoad)}(a))l=a.canLoad(t,n);else{if(!Ja(a))throw new Error("Invalid CanLoad guard");l=a(t,n)}return ro(l)})).pipe(Ff(),Gn(o=>{if(!hc(o))return;const a=Xw(`Redirecting to "${this.urlSerializer.serialize(o)}"`);throw a.url=o,a}),xt(o=>!0===o)):Mt(!0)}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Mt(n);if(r.numberOfChildren>1||!r.children[Qt])return no(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e.redirectTo}'`));r=r.children[Qt]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreatreUrlTree(e,t,n,r){const s=this.createSegmentGroup(e,t.root,n,r);return new lc(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return er(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);n[s]=t[a]}else n[s]=r}),n}createSegmentGroup(e,t,n,r){const s=this.createSegments(e,t.segments,n,r);let o={};return er(t.children,(a,l)=>{o[l]=this.createSegmentGroup(e,a,n,r)}),new sn(s,o)}createSegments(e,t,n,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,n))}findPosParam(e,t,n){const r=n[t.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return r}findOrReturn(e,t){let n=0;for(const r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}}function sM(i){const e={};for(const n of Object.keys(i.children)){const s=sM(i.children[n]);(s.segments.length>0||s.hasChildren())&&(e[n]=s)}return function Qq(i){if(1===i.numberOfChildren&&i.children[Qt]){const e=i.children[Qt];return new sn(i.segments.concat(e.segments),e.children)}return i}(new sn(i.segments,e))}class UF{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class u_{constructor(e,t){this.component=e,this.route=t}}function Jq(i,e,t){const n=i._root;return Of(n,e?e._root:null,t,[n.value])}function h_(i,e,t){return(FF(e)??t).get(i)}function Of(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=th(e);return i.children.forEach(o=>{(function tZ(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=i.value,o=e?e.value:null,a=t?t.getContext(i.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function nZ(i,e,t){if("function"==typeof t)return t(i,e);switch(t){case"pathParamsChange":return!cc(i.url,e.url);case"pathParamsOrQueryParamsChange":return!cc(i.url,e.url)||!Vo(i.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!$w(i,e)||!Vo(i.queryParams,e.queryParams);default:return!$w(i,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new UF(n)):(s.data=o.data,s._resolvedData=o._resolvedData),Of(i,e,s.component?a?a.children:null:t,n,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new u_(a.outlet.component,o))}else o&&kf(e,a,r),r.canActivateChecks.push(new UF(n)),Of(i,null,s.component?a?a.children:null:t,n,r)})(o,s[o.value.outlet],t,n.concat([o.value]),r),delete s[o.value.outlet]}),er(s,(o,a)=>kf(o,t.getContext(a),r)),r}function kf(i,e,t){const n=th(i),r=i.value;er(n,(s,o)=>{kf(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new u_(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}class hZ{}function jF(i){return new wn(e=>e.error(i))}class fZ{constructor(e,t,n,r,s,o){this.rootComponentType=e,this.config=t,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=o}recognize(){const e=a_(this.urlTree.root,[],[],this.config.filter(o=>void 0===o.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,Qt);if(null===t)return null;const n=new i_([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Qt,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new _a(n,t),s=new MF(this.url,r);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(e){const t=e.value,n=wF(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}processChildren(e,t){const n=[];for(const s of Object.keys(t.children)){const o=t.children[s],a=IF(e,s),l=this.processSegmentGroup(a,o,s);if(null===l)return null;n.push(...l)}const r=zF(n);return function pZ(i){i.sort((e,t)=>e.value.outlet===Qt?-1:t.value.outlet===Qt?1:e.value.outlet.localeCompare(t.value.outlet))}(r),r}processSegment(e,t,n,r){for(const s of e){const o=this.processSegmentAgainstRoute(s,t,n,r);if(null!==o)return o}return kF(t,n,r)?[]:null}processSegmentAgainstRoute(e,t,n,r){if(e.redirectTo||!OF(e,t,n,r))return null;let s,o=[],a=[];if("**"===e.path){const f=n.length>0?lF(n).parameters:{},p=GF(t)+n.length;s=new i_(n,f,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,XF(e),Ts(e),e.component??e._loadedComponent??null,e,HF(t),p,KF(e),p)}else{const f=o_(t,e,n);if(!f.matched)return null;o=f.consumedSegments,a=f.remainingSegments;const p=GF(t)+o.length;s=new i_(o,f.parameters,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,XF(e),Ts(e),e.component??e._loadedComponent??null,e,HF(t),p,KF(e),p)}const l=function mZ(i){return i.children?i.children:i.loadChildren?i._loadedRoutes:[]}(e),{segmentGroup:c,slicedSegments:u}=a_(t,o,a,l.filter(f=>void 0===f.redirectTo),this.relativeLinkResolution);if(0===u.length&&c.hasChildren()){const f=this.processChildren(l,c);return null===f?null:[new _a(s,f)]}if(0===l.length&&0===u.length)return[new _a(s,[])];const h=Ts(e)===r,d=this.processSegment(l,c,u,h?Qt:r);return null===d?null:[new _a(s,d)]}}function gZ(i){const e=i.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function zF(i){const e=[],t=new Set;for(const n of i){if(!gZ(n)){e.push(n);continue}const r=e.find(s=>n.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...n.children),t.add(r)):e.push(n)}for(const n of t){const r=zF(n.children);e.push(new _a(n.value,r))}return e.filter(n=>!t.has(n))}function HF(i){let e=i;for(;e._sourceSegment;)e=e._sourceSegment;return e}function GF(i){let e=i,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function XF(i){return i.data||{}}function KF(i){return i.resolve||{}}const oM=Symbol("RouteTitle");function qF(i){return"string"==typeof i.title||null===i.title}function aM(i){return Uo(e=>{const t=i(e);return t?_i(t).pipe(xt(()=>e)):Mt(e)})}class TZ extends class SZ{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const lM=new He("ROUTES");let cM=(()=>{class i{constructor(t,n){this.injector=t,this.compiler=n,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Mt(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const n=ro(t.loadComponent()).pipe(Gn(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Qg(()=>{this.componentLoaders.delete(t)})),r=new jw(n,()=>new Lt).pipe(Yg());return this.componentLoaders.set(t,r),r}loadChildren(t,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return Mt({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);const s=this.loadModuleFactoryOrRoutes(n.loadChildren).pipe(xt(a=>{this.onLoadEndListener&&this.onLoadEndListener(n);let l,c,u=!1;Array.isArray(a)?c=a:(l=a.create(t).injector,c=aF(l.get(lM,[],Ct.Self|Ct.Optional)));return{routes:c.map(rM),injector:l}}),Qg(()=>{this.childrenLoaders.delete(n)})),o=new jw(s,()=>new Lt).pipe(Yg());return this.childrenLoaders.set(n,o),o}loadModuleFactoryOrRoutes(t){return ro(t()).pipe(Gi(n=>n instanceof KP||Array.isArray(n)?Mt(n):_i(this.compiler.compileModuleAsync(n))))}}return i.\u0275fac=function(t){return new(t||i)(re(Xi),re(ow))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();class EZ{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function AZ(i){throw i}function DZ(i,e,t){return e.parse("/")}const PZ={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},IZ={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let os=(()=>{class i{constructor(t,n,r,s,o,a,l){this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=s,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Lt,this.errorHandler=AZ,this.malformedUriErrorHandler=DZ,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>Mt(void 0),this.urlHandlingStrategy=new EZ,this.routeReuseStrategy=new TZ,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=o.get(cM),this.configLoader.onLoadEndListener=d=>this.triggerEvent(new KK(d)),this.configLoader.onLoadStartListener=d=>this.triggerEvent(new XK(d)),this.ngModule=o.get(Za),this.console=o.get(H7);const h=o.get(Pt);this.isNgZoneEnabled=h instanceof Pt&&Pt.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=function nq(){return new lc(new sn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=xF(this.currentUrlTree,this.rootComponentType),this.transitions=new ss({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(t){const n=this.events;return t.pipe(Vi(r=>0!==r.id),xt(r=>({...r,extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),Uo(r=>{let s=!1,o=!1;return Mt(r).pipe(Gn(a=>{this.currentNavigation={id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Uo(a=>{const l=this.browserUrlTree.toString(),c=!this.navigated||a.extractedUrl.toString()!==l||l!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||c)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return YF(a.source)&&(this.browserUrlTree=a.extractedUrl),Mt(a).pipe(Uo(h=>{const d=this.transitions.getValue();return n.next(new Ww(h.id,this.serializeUrl(h.extractedUrl),h.source,h.restoredState)),d!==this.transitions.getValue()?xr:Promise.resolve(h)}),function $q(i,e,t,n){return Uo(r=>function Zq(i,e,t,n,r){return new Yq(i,e,t,n,r).apply()}(i,e,t,r.extractedUrl,n).pipe(xt(s=>({...r,urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Gn(h=>{this.currentNavigation={...this.currentNavigation,finalUrl:h.urlAfterRedirects}}),function _Z(i,e,t,n,r){return Gi(s=>function dZ(i,e,t,n,r="emptyOnly",s="legacy"){try{const o=new fZ(i,e,t,n,r,s).recognize();return null===o?jF(new hZ):Mt(o)}catch(o){return jF(o)}}(i,e,s.urlAfterRedirects,t(s.urlAfterRedirects),n,r).pipe(xt(o=>({...s,targetSnapshot:o}))))}(this.rootComponentType,this.config,h=>this.serializeUrl(h),this.paramsInheritanceStrategy,this.relativeLinkResolution),Gn(h=>{if("eager"===this.urlUpdateStrategy){if(!h.extras.skipLocationChange){const f=this.urlHandlingStrategy.merge(h.urlAfterRedirects,h.rawUrl);this.setBrowserUrl(f,h)}this.browserUrlTree=h.urlAfterRedirects}const d=new jK(h.id,this.serializeUrl(h.extractedUrl),this.serializeUrl(h.urlAfterRedirects),h.targetSnapshot);n.next(d)}));if(c&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:d,extractedUrl:f,source:p,restoredState:m,extras:g}=a,_=new Ww(d,this.serializeUrl(f),p,m);n.next(_);const v=xF(f,this.rootComponentType).snapshot;return Mt({...a,targetSnapshot:v,urlAfterRedirects:f,extras:{...g,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=a.rawUrl,a.resolve(null),xr}),Gn(a=>{const l=new zK(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(l)}),xt(a=>({...a,guards:Jq(a.targetSnapshot,a.currentSnapshot,this.rootContexts)})),function iZ(i,e){return Gi(t=>{const{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Mt({...t,guardsResult:!0}):function rZ(i,e,t,n){return _i(i).pipe(Gi(r=>function uZ(i,e,t,n,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Mt(s.map(a=>{const l=h_(a,e,r);let c;if(function zq(i){return i&&Ja(i.canDeactivate)}(l))c=ro(l.canDeactivate(i,e,t,n));else{if(!Ja(l))throw new Error("Invalid CanDeactivate guard");c=ro(l(i,e,t,n))}return c.pipe(ac())})).pipe(Ff()):Mt(!0)}(r.component,r.route,t,e,n)),ac(r=>!0!==r,!0))}(o,n,r,i).pipe(Gi(a=>a&&function Bq(i){return"boolean"==typeof i}(a)?function sZ(i,e,t,n){return _i(e).pipe(Ju(r=>Zg(function aZ(i,e){return null!==i&&e&&e(new qK(i)),Mt(!0)}(r.route.parent,n),function oZ(i,e){return null!==i&&e&&e(new YK(i)),Mt(!0)}(r.route,n),function cZ(i,e,t){const n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function eZ(i){const e=i.routeConfig?i.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:i,guards:e}:null}(o)).filter(o=>null!==o).map(o=>eF(()=>Mt(o.guards.map(l=>{const c=h_(l,o.node,t);let u;if(function jq(i){return i&&Ja(i.canActivateChild)}(c))u=ro(c.canActivateChild(n,i));else{if(!Ja(c))throw new Error("Invalid CanActivateChild guard");u=ro(c(n,i))}return u.pipe(ac())})).pipe(Ff())));return Mt(s).pipe(Ff())}(i,r.path,t),function lZ(i,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return Mt(!0);const r=n.map(s=>eF(()=>{const o=h_(s,e,t);let a;if(function Vq(i){return i&&Ja(i.canActivate)}(o))a=ro(o.canActivate(e,i));else{if(!Ja(o))throw new Error("Invalid CanActivate guard");a=ro(o(e,i))}return a.pipe(ac())}));return Mt(r).pipe(Ff())}(i,r.route,t))),ac(r=>!0!==r,!0))}(n,s,i,e):Mt(a)),xt(a=>({...t,guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),Gn(a=>{if(hc(a.guardsResult)){const c=Xw(`Redirecting to "${this.serializeUrl(a.guardsResult)}"`);throw c.url=a.guardsResult,c}const l=new HK(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(l)}),Vi(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,""),!1)),aM(a=>{if(a.guards.canActivateChecks.length)return Mt(a).pipe(Gn(l=>{const c=new GK(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}),Uo(l=>{let c=!1;return Mt(l).pipe(function vZ(i,e){return Gi(t=>{const{targetSnapshot:n,guards:{canActivateChecks:r}}=t;if(!r.length)return Mt(t);let s=0;return _i(r).pipe(Ju(o=>function yZ(i,e,t,n){const r=i.routeConfig,s=i._resolve;return void 0!==r?.title&&!qF(r)&&(s[oM]=r.title),function bZ(i,e,t,n){const r=function xZ(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}(i);if(0===r.length)return Mt({});const s={};return _i(r).pipe(Gi(o=>function wZ(i,e,t,n){const r=h_(i,e,n);return ro(r.resolve?r.resolve(e,t):r(e,t))}(i[o],e,t,n).pipe(ac(),Gn(a=>{s[o]=a}))),zw(1),Gw(s),io(o=>o instanceof Tf?xr:no(o)))}(s,i,e,n).pipe(xt(o=>(i._resolvedData=o,i.data=wF(i,t).resolve,r&&qF(r)&&(i.data[oM]=r.title),null)))}(o.route,n,i,e)),Gn(()=>s++),zw(1),Gi(o=>s===r.length?Mt(t):xr))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Gn({next:()=>c=!0,complete:()=>{c||(this.restoreHistory(l),this.cancelNavigationTransition(l,"At least one route resolver didn't emit any value."))}}))}),Gn(l=>{const c=new WK(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}))}),aM(()=>this.afterPreactivation()),aM(a=>{const l=c=>{const u=[];c.routeConfig?.loadComponent&&!c.routeConfig._loadedComponent&&u.push(this.configLoader.loadComponent(c.routeConfig).pipe(Gn(h=>{c.component=h}),xt(()=>{})));for(const h of c.children)u.push(...l(h));return u};return Vw(l(a.targetSnapshot.root)).pipe(Hw(),Br(1))}),xt(a=>{const l=function bq(i,e,t){const n=Af(i,e._root,t?t._root:void 0);return new bF(n,e)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return{...a,targetRouterState:l}}),Gn(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((i,e,t)=>xt(n=>(new Nq(e,n.targetRouterState,n.currentRouterState,t).activate(i),n)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),Gn({next(){s=!0},complete(){s=!0}}),Qg(()=>{s||o||this.cancelNavigationTransition(r,`Navigation ID ${r.id} is not equal to the current navigation id ${this.navigationId}`),this.currentNavigation?.id===r.id&&(this.currentNavigation=null)}),io(a=>{if(o=!0,function JK(i){return i&&i[sF]}(a)){const l=hc(a.url);l||(this.navigated=!0,this.restoreHistory(r,!0));const c=new iF(r.id,this.serializeUrl(r.extractedUrl),a.message);if(n.next(c),l){const u=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),h={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||YF(r.source)};this.scheduleNavigation(u,"imperative",null,h,{resolve:r.resolve,reject:r.reject,promise:r.promise})}else r.resolve(!1)}else{this.restoreHistory(r,!0);const l=new VK(r.id,this.serializeUrl(r.extractedUrl),a);n.next(l);try{r.resolve(this.errorHandler(a))}catch(c){r.reject(c)}}return xr}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next({...this.transitions.value,...t})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const n="popstate"===t.type?"popstate":"hashchange";"popstate"===n&&setTimeout(()=>{const r={replaceUrl:!0},s=t.state?.navigationId?t.state:null;if(s){const a={...s};delete a.navigationId,delete a.\u0275routerPageId,0!==Object.keys(a).length&&(r.state=a)}const o=this.parseUrl(t.url);this.scheduleNavigation(o,n,s,r)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){this.config=t.map(rM),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,n={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=n,c=r||this.routerState.root,u=l?this.currentUrlTree.fragment:o;let h=null;switch(a){case"merge":h={...this.currentUrlTree.queryParams,...s};break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=s||null}return null!==h&&(h=this.removeEmptyProps(h)),function Mq(i,e,t,n,r){if(0===t.length)return Jw(e.root,e.root,e.root,n,r);const s=function Sq(i){if("string"==typeof i[0]&&1===i.length&&"/"===i[0])return new CF(!0,0,i);let e=0,t=!1;const n=i.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return er(s.outlets,(l,c)=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new CF(t,e,n)}(t);return s.toRoot()?Jw(e.root,e.root,new sn([],{}),n,r):function o(l){const c=function Tq(i,e,t,n){return i.isAbsolute?new eM(e.root,!0,0):-1===n?new eM(t,t===e.root,0):function Cq(i,e,t){let n=i,r=e,s=t;for(;s>r;){if(s-=r,n=n.parent,!n)throw new Error("Invalid number of '../'");r=n.segments.length}return new eM(n,!1,r-s)}(t,n+(r_(i.commands[0])?0:1),i.numberOfDoubleDots)}(s,e,i.snapshot?._urlSegment,l),u=c.processChildren?s_(c.segmentGroup,c.index,s.commands):EF(c.segmentGroup,c.index,s.commands);return Jw(e.root,c.segmentGroup,u,n,r)}(i.snapshot?._lastPathIndex)}(c,this.currentUrlTree,t,h,u??null)}navigateByUrl(t,n={skipLocationChange:!1}){const r=hc(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,n)}navigate(t,n={skipLocationChange:!1}){return function FZ(i){for(let e=0;e<i.length;e++){const t=i[e];if(null==t)throw new Error(`The requested path contains ${t} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let n;try{n=this.urlSerializer.parse(t)}catch(r){n=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return n}isActive(t,n){let r;if(r=!0===n?{...PZ}:!1===n?{...IZ}:n,hc(t))return uF(this.currentUrlTree,t,r);const s=this.parseUrl(t);return uF(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((n,r)=>{const s=t[r];return null!=s&&(n[r]=s),n},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new Cf(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,n,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c;o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((d,f)=>{a=d,l=f});const u=++this.navigationId;let h;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),h=r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):h=0,this.setTransition({id:u,targetPageId:h,source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(d=>Promise.reject(d))}setBrowserUrl(t,n){const r=this.urlSerializer.serialize(t),s={...n.extras.state,...this.generateNgRouterState(n.id,n.targetPageId)};this.location.isCurrentPathEqualTo(r)||n.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,n=!1){if("computed"===this.canceledNavigationResolution){const r=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===r?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===r&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(r)}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,n){const r=new iF(t.id,this.serializeUrl(t.extractedUrl),n);this.triggerEvent(r),t.resolve(!1)}generateNgRouterState(t,n){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}}return i.\u0275fac=function(t){rg()},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();function YF(i){return"imperative"!==i}let d_=(()=>{class i{constructor(t,n,r){this.router=t,this.route=n,this.locationStrategy=r,this.commands=null,this.href=null,this.onChanges=new Lt,this.subscription=t.events.subscribe(s=>{s instanceof Cf&&this.updateTargetUrlAndHref()})}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:null}ngOnChanges(t){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(t,n,r,s,o){if(0!==t||n||r||s||o||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const a={skipLocationChange:da(this.skipLocationChange),replaceUrl:da(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:da(this.preserveFragment)})}}return i.\u0275fac=function(t){return new(t||i)(N(os),N(uc),N(Qu))},i.\u0275dir=tt({type:i,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(t,n){1&t&&gt("click",function(s){return n.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&t&&vi("target",n.target)("href",n.href,xb)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[$i]}),i})();class QF{buildTitle(e){let t,n=e.root;for(;void 0!==n;)t=this.getResolvedTitleForRoute(n)??t,n=n.children.find(r=>r.outlet===Qt);return t}getResolvedTitleForRoute(e){return e.data[oM]}}let kZ=(()=>{class i extends QF{constructor(t){super(),this.title=t}updateTitle(t){const n=this.buildTitle(t);void 0!==n&&this.title.setTitle(n)}}return i.\u0275fac=function(t){return new(t||i)(re(K2))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class $F{}class JF{preload(e,t){return Mt(null)}}let eL=(()=>{class i{constructor(t,n,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Vi(t=>t instanceof Cf),Ju(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,n){const r=[];for(const s of n){s.providers&&!s._injector&&(s._injector=bg(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;s.loadChildren&&!s._loadedRoutes||s.loadComponent&&!s._loadedComponent?r.push(this.preloadConfig(o,s)):(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return _i(r).pipe(au())}preloadConfig(t,n){return this.preloadingStrategy.preload(n,()=>{let r;r=n.loadChildren&&void 0===n.canLoad?this.loader.loadChildren(t,n):Mt(null);const s=r.pipe(Gi(o=>null===o?Mt(void 0):(n._loadedRoutes=o.routes,n._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return n.loadComponent&&!n._loadedComponent?_i([s,this.loader.loadComponent(n)]).pipe(au()):s})}}return i.\u0275fac=function(t){return new(t||i)(re(os),re(ow),re($l),re($F),re(cM))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})(),hM=(()=>{class i{constructor(t,n,r={}){this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Ww?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Cf&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof rF&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,n){this.router.triggerEvent(new rF(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return i.\u0275fac=function(t){rg()},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();const dc=new He("ROUTER_CONFIGURATION"),tL=new He("ROUTER_FORROOT_GUARD"),BZ=[Ig,{provide:pF,useClass:mF},{provide:os,useFactory:function HZ(i,e,t,n,r,s,o={},a,l,c,u){const h=new os(null,i,e,t,n,r,aF(s));return c&&(h.urlHandlingStrategy=c),u&&(h.routeReuseStrategy=u),h.titleStrategy=l??a,function GZ(i,e){i.errorHandler&&(e.errorHandler=i.errorHandler),i.malformedUriErrorHandler&&(e.malformedUriErrorHandler=i.malformedUriErrorHandler),i.onSameUrlNavigation&&(e.onSameUrlNavigation=i.onSameUrlNavigation),i.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=i.paramsInheritanceStrategy),i.relativeLinkResolution&&(e.relativeLinkResolution=i.relativeLinkResolution),i.urlUpdateStrategy&&(e.urlUpdateStrategy=i.urlUpdateStrategy),i.canceledNavigationResolution&&(e.canceledNavigationResolution=i.canceledNavigationResolution)}(o,h),h},deps:[pF,Pf,Ig,Xi,ow,lM,dc,kZ,[QF,new ys],[class CZ{},new ys],[class MZ{},new ys]]},Pf,{provide:uc,useFactory:function WZ(i){return i.routerState.root},deps:[os]},eL,JF,class NZ{preload(e,t){return t().pipe(io(()=>Mt(null)))}},{provide:dc,useValue:{enableTracing:!1}},cM];function UZ(){return new NI("Router",os)}let nL=(()=>{class i{constructor(t,n){}static forRoot(t,n){return{ngModule:i,providers:[BZ,iL(t),{provide:tL,useFactory:zZ,deps:[[os,new ys,new Su]]},{provide:dc,useValue:n||{}},{provide:Qu,useFactory:jZ,deps:[bf,[new Xm(yw),new ys],dc]},{provide:hM,useFactory:VZ,deps:[os,WX,dc]},{provide:$F,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:JF},{provide:NI,multi:!0,useFactory:UZ},[dM,{provide:rw,multi:!0,useFactory:XZ,deps:[dM]},{provide:rL,useFactory:KZ,deps:[dM]},{provide:PI,multi:!0,useExisting:rL}]]}}static forChild(t){return{ngModule:i,providers:[iL(t)]}}}return i.\u0275fac=function(t){return new(t||i)(re(tL,8),re(os,8))},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({}),i})();function VZ(i,e,t){return t.scrollOffset&&e.setOffset(t.scrollOffset),new hM(i,e,t)}function jZ(i,e,t={}){return t.useHash?new I9(i,e):new a2(i,e)}function zZ(i){return"guarded"}function iL(i){return[{provide:p5,multi:!0,useValue:i},{provide:lM,multi:!0,useValue:i}]}let dM=(()=>{class i{constructor(t){this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Lt}appInitializer(){return this.injector.get(A9,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let n=null;const r=new Promise(a=>n=a),s=this.injector.get(os),o=this.injector.get(dc);return"disabled"===o.initialNavigation?(s.setUpLocationChangeListener(),n(!0)):"enabledBlocking"===o.initialNavigation?(s.afterPreactivation=()=>this.initNavigation?Mt(void 0):(this.initNavigation=!0,n(!0),this.resultOfPreactivationDone),s.initialNavigation()):n(!0),r})}bootstrapListener(t){const n=this.injector.get(dc),r=this.injector.get(eL),s=this.injector.get(hM),o=this.injector.get(os),a=this.injector.get(vf);t===a.components[0]&&(("enabledNonBlocking"===n.initialNavigation||void 0===n.initialNavigation)&&o.initialNavigation(),r.setUpPreloading(),s.init(),o.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(void 0),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return i.\u0275fac=function(t){return new(t||i)(re(Xi))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();function XZ(i){return i.appInitializer.bind(i)}function KZ(i){return i.bootstrapListener.bind(i)}const rL=new He("Router Initializer");function sL(i,e,t,n,r,s,o){try{var a=i[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(n,r)}function so(i){return function(){var e=this,t=arguments;return new Promise(function(n,r){var s=i.apply(e,t);function o(l){sL(s,n,r,o,a,"next",l)}function a(l){sL(s,n,r,o,a,"throw",l)}o(void 0)})}}const f_="142",Cs={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},va={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},oL=0,fM=1,aL=2,ZZ=3,YZ=0,pM=1,lL=2,nh=3,el=0,as=1,oo=2,cL=1,QZ=2,ao=0,fc=1,ih=2,mM=3,gM=4,uL=5,pc=100,hL=101,dL=102,_M=103,vM=104,fL=200,pL=201,mL=202,gL=203,yM=204,bM=205,_L=206,vL=207,yL=208,bL=209,xL=210,wL=0,ML=1,SL=2,p_=3,TL=4,CL=5,EL=6,RL=7,Nf=0,AL=1,DL=2,jo=0,PL=1,IL=2,FL=3,LL=4,OL=5,m_=300,tl=301,nl=302,Bf=303,Uf=304,rh=306,il=1e3,dr=1001,sh=1002,bi=1003,Vf=1004,$Z=1004,jf=1005,JZ=1005,si=1006,g_=1007,eY=1007,ya=1008,tY=1008,Gr=1009,kL=1010,NL=1011,xM=1012,BL=1013,rl=1014,Wr=1015,lo=1016,UL=1017,VL=1018,mc=1020,jL=1021,zL=1022,fr=1023,wM=1024,HL=1025,sl=1026,gc=1027,_c=1028,GL=1029,oh=1030,WL=1031,XL=1033,__=33776,v_=33777,y_=33778,b_=33779,MM=35840,SM=35841,TM=35842,CM=35843,KL=36196,EM=37492,RM=37496,AM=37808,DM=37809,PM=37810,IM=37811,FM=37812,LM=37813,OM=37814,kM=37815,NM=37816,BM=37817,UM=37818,VM=37819,jM=37820,zM=37821,HM=36492,GM=2200,qL=2201,ZL=2202,ah=2300,vc=2301,x_=2302,yc=2400,bc=2401,zf=2402,w_=2500,WM=2501,nY=0,YL=1,XM=2,ol=3e3,hn=3001,QL=3200,KM=3201,al=0,$L=1,iY="",zo="srgb",ll="srgb-linear",rY=0,M_=7680,sY=7681,oY=7682,aY=7683,lY=34055,cY=34056,uY=5386,hY=512,dY=513,fY=514,pY=515,mY=516,gY=517,_Y=518,JL=519,S_=35044,T_=35048,vY=35040,yY=35045,bY=35049,xY=35041,wY=35046,MY=35050,SY=35042,TY="100",qM="300 es",C_=1035;class ls{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const n=this._listeners[e.type];if(void 0!==n){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const pr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let eO=1234567;const xc=Math.PI/180,Hf=180/Math.PI;function cs(){const i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(pr[255&i]+pr[i>>8&255]+pr[i>>16&255]+pr[i>>24&255]+"-"+pr[255&e]+pr[e>>8&255]+"-"+pr[e>>16&15|64]+pr[e>>24&255]+"-"+pr[63&t|128]+pr[t>>8&255]+"-"+pr[t>>16&255]+pr[t>>24&255]+pr[255&n]+pr[n>>8&255]+pr[n>>16&255]+pr[n>>24&255]).toLowerCase()}function xi(i,e,t){return Math.max(e,Math.min(t,i))}function ZM(i,e){return(i%e+e)%e}function Gf(i,e,t){return(1-t)*i+t*e}function YM(i){return 0==(i&i-1)&&0!==i}function tO(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function E_(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}var kt=Object.freeze({__proto__:null,DEG2RAD:xc,RAD2DEG:Hf,generateUUID:cs,clamp:xi,euclideanModulo:ZM,mapLinear:function CY(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)},inverseLerp:function EY(i,e,t){return i!==e?(t-i)/(e-i):0},lerp:Gf,damp:function RY(i,e,t,n){return Gf(i,e,1-Math.exp(-t*n))},pingpong:function AY(i,e=1){return e-Math.abs(ZM(i,2*e)-e)},smoothstep:function DY(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e))*i*(3-2*i)},smootherstep:function PY(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e))*i*i*(i*(6*i-15)+10)},randInt:function IY(i,e){return i+Math.floor(Math.random()*(e-i+1))},randFloat:function FY(i,e){return i+Math.random()*(e-i)},randFloatSpread:function LY(i){return i*(.5-Math.random())},seededRandom:function OY(i){void 0!==i&&(eO=i);let e=eO+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function kY(i){return i*xc},radToDeg:function NY(i){return i*Hf},isPowerOfTwo:YM,ceilPowerOfTwo:tO,floorPowerOfTwo:E_,setQuaternionFromProperEuler:function BY(i,e,t,n,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+n)/2),u=o((e+n)/2),h=s((e-n)/2),d=o((e-n)/2),f=s((n-e)/2),p=o((n-e)/2);switch(r){case"XYX":i.set(a*u,l*h,l*d,a*c);break;case"YZY":i.set(l*d,a*u,l*h,a*c);break;case"ZXZ":i.set(l*h,l*d,a*u,a*c);break;case"XZX":i.set(a*u,l*p,l*f,a*c);break;case"YXY":i.set(l*f,a*u,l*p,a*c);break;case"ZYZ":i.set(l*p,l*f,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:function VY(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return Math.round(65535*i);case Uint8Array:return Math.round(255*i);case Int16Array:return Math.round(32767*i);case Int8Array:return Math.round(127*i);default:throw new Error("Invalid component type.")}},denormalize:function UY(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}});class te{constructor(e=0,t=0){te.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Xr{constructor(){Xr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=n,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[3],l=n[6],c=n[1],u=n[4],h=n[7],d=n[2],f=n[5],p=n[8],m=r[0],g=r[3],_=r[6],v=r[1],y=r[4],b=r[7],w=r[2],M=r[5],T=r[8];return s[0]=o*m+a*v+l*w,s[3]=o*g+a*y+l*M,s[6]=o*_+a*b+l*T,s[1]=c*m+u*v+h*w,s[4]=c*g+u*y+h*M,s[7]=c*_+u*b+h*T,s[2]=d*m+f*v+p*w,s[5]=d*g+f*y+p*M,s[8]=d*_+f*b+p*T,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-n*s*u+n*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,d=a*l-u*s,f=c*s-o*l,p=t*h+n*d+r*f;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=h*m,e[1]=(r*c-u*n)*m,e[2]=(a*n-r*o)*m,e[3]=d*m,e[4]=(u*t-r*l)*m,e[5]=(r*s-a*t)*m,e[6]=f*m,e[7]=(n*l-c*t)*m,e[8]=(o*t-n*s)*m,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=this.elements,s=r[0],o=r[3],a=r[6],l=r[1],c=r[4],u=r[7];return r[0]=t*s+n*l,r[3]=t*o+n*c,r[6]=t*a+n*u,r[1]=-n*s+t*l,r[4]=-n*o+t*c,r[7]=-n*a+t*u,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function nO(i){for(let e=i.length-1;e>=0;--e)if(i[e]>65535)return!0;return!1}const jY={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function lh(i,e){return new jY[i](e)}function Wf(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function wc(i){return i<.04045?.0773993808*i:Math.pow(.9478672986*i+.0521327014,2.4)}function R_(i){return i<.0031308?12.92*i:1.055*Math.pow(i,.41666)-.055}const QM={[zo]:{[ll]:wc},[ll]:{[zo]:R_}},Es={legacyMode:!0,get workingColorSpace(){return ll},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,e,t){if(this.legacyMode||e===t||!e||!t)return i;if(QM[e]&&void 0!==QM[e][t]){const n=QM[e][t];return i.r=n(i.r),i.g=n(i.g),i.b=n(i.b),i}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)}},iO={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ji={r:0,g:0,b:0},co={h:0,s:0,l:0},A_={h:0,s:0,l:0};function $M(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+6*(e-i)*t:t<.5?e:t<2/3?i+6*(e-i)*(2/3-t):i}function D_(i,e){return e.r=i.r,e.g=i.g,e.b=i.b,e}let ch,Ce=(()=>{class i{constructor(t,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===n&&void 0===r?this.set(t):this.setRGB(t,n,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,n=zo){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,Es.toWorkingColorSpace(this,n),this}setRGB(t,n,r,s=ll){return this.r=t,this.g=n,this.b=r,Es.toWorkingColorSpace(this,s),this}setHSL(t,n,r,s=ll){if(t=ZM(t,1),n=xi(n,0,1),r=xi(r,0,1),0===n)this.r=this.g=this.b=r;else{const o=r<=.5?r*(1+n):r+n-r*n,a=2*r-o;this.r=$M(a,o,t+1/3),this.g=$M(a,o,t),this.b=$M(a,o,t-1/3)}return Es.toWorkingColorSpace(this,s),this}setStyle(t,n=zo){function r(o){void 0!==o&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let s;if(s=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let o;const l=s[2];switch(s[1]){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(255,parseInt(o[1],10))/255,this.g=Math.min(255,parseInt(o[2],10))/255,this.b=Math.min(255,parseInt(o[3],10))/255,Es.toWorkingColorSpace(this,n),r(o[4]),this;if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(100,parseInt(o[1],10))/100,this.g=Math.min(100,parseInt(o[2],10))/100,this.b=Math.min(100,parseInt(o[3],10))/100,Es.toWorkingColorSpace(this,n),r(o[4]),this;break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l)){const c=parseFloat(o[1])/360,u=parseInt(o[2],10)/100,h=parseInt(o[3],10)/100;return r(o[4]),this.setHSL(c,u,h,n)}}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(t)){const o=s[1],a=o.length;if(3===a)return this.r=parseInt(o.charAt(0)+o.charAt(0),16)/255,this.g=parseInt(o.charAt(1)+o.charAt(1),16)/255,this.b=parseInt(o.charAt(2)+o.charAt(2),16)/255,Es.toWorkingColorSpace(this,n),this;if(6===a)return this.r=parseInt(o.charAt(0)+o.charAt(1),16)/255,this.g=parseInt(o.charAt(2)+o.charAt(3),16)/255,this.b=parseInt(o.charAt(4)+o.charAt(5),16)/255,Es.toWorkingColorSpace(this,n),this}return t&&t.length>0?this.setColorName(t,n):this}setColorName(t,n=zo){const r=iO[t.toLowerCase()];return void 0!==r?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=wc(t.r),this.g=wc(t.g),this.b=wc(t.b),this}copyLinearToSRGB(t){return this.r=R_(t.r),this.g=R_(t.g),this.b=R_(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=zo){return Es.fromWorkingColorSpace(D_(this,ji),t),xi(255*ji.r,0,255)<<16^xi(255*ji.g,0,255)<<8^xi(255*ji.b,0,255)<<0}getHexString(t=zo){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,n=ll){Es.fromWorkingColorSpace(D_(this,ji),n);const r=ji.r,s=ji.g,o=ji.b,a=Math.max(r,s,o),l=Math.min(r,s,o);let c,u;const h=(l+a)/2;if(l===a)c=0,u=0;else{const d=a-l;switch(u=h<=.5?d/(a+l):d/(2-a-l),a){case r:c=(s-o)/d+(s<o?6:0);break;case s:c=(o-r)/d+2;break;case o:c=(r-s)/d+4}c/=6}return t.h=c,t.s=u,t.l=h,t}getRGB(t,n=ll){return Es.fromWorkingColorSpace(D_(this,ji),n),t.r=ji.r,t.g=ji.g,t.b=ji.b,t}getStyle(t=zo){return Es.fromWorkingColorSpace(D_(this,ji),t),t!==zo?`color(${t} ${ji.r} ${ji.g} ${ji.b})`:`rgb(${255*ji.r|0},${255*ji.g|0},${255*ji.b|0})`}offsetHSL(t,n,r){return this.getHSL(co),co.h+=t,co.s+=n,co.l+=r,this.setHSL(co.h,co.s,co.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this}lerpColors(t,n,r){return this.r=t.r+(n.r-t.r)*r,this.g=t.g+(n.g-t.g)*r,this.b=t.b+(n.b-t.b)*r,this}lerpHSL(t,n){this.getHSL(co),t.getHSL(A_);const r=Gf(co.h,A_.h,n),s=Gf(co.s,A_.s,n),o=Gf(co.l,A_.l,n);return this.setHSL(r,s,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,n=0){return this.r=t[n],this.g=t[n+1],this.b=t[n+2],this}toArray(t=[],n=0){return t[n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t}fromBufferAttribute(t,n){return this.r=t.getX(n),this.g=t.getY(n),this.b=t.getZ(n),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}return i.NAMES=iO,i})();class JM{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===ch&&(ch=Wf("canvas")),ch.width=e.width,ch.height=e.height;const n=ch.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=ch}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Wf("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*wc(s[o]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t[n]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*wc(t[n]/255)):wc(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Mc{constructor(e=null){this.isSource=!0,this.uuid=cs(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(eS(r[o].isDataTexture?r[o].image:r[o]))}else s=eS(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function eS(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?JM.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let zY=0,mr=(()=>{class i extends ls{constructor(t=i.DEFAULT_IMAGE,n=i.DEFAULT_MAPPING,r=dr,s=dr,o=si,a=ya,l=fr,c=Gr,u=1,h=ol){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:zY++}),this.uuid=cs(),this.name="",this.source=new Mc(t),this.mipmaps=[],this.mapping=n,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new te(0,0),this.repeat=new te(1,1),this.center=new te(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Xr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const n=void 0===t||"string"==typeof t;if(!n&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==m_)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case il:t.x=t.x-Math.floor(t.x);break;case dr:t.x=t.x<0?0:1;break;case sh:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case il:t.y=t.y-Math.floor(t.y);break;case dr:t.y=t.y<0?0:1;break;case sh:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return i.DEFAULT_IMAGE=null,i.DEFAULT_MAPPING=m_,i})();class dn{constructor(e=0,t=0,n=0,r=1){dn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const l=e.elements,c=l[0],u=l[4],h=l[8],d=l[1],f=l[5],p=l[9],m=l[2],g=l[6],_=l[10];if(Math.abs(u-d)<.01&&Math.abs(h-m)<.01&&Math.abs(p-g)<.01){if(Math.abs(u+d)<.1&&Math.abs(h+m)<.1&&Math.abs(p+g)<.1&&Math.abs(c+f+_-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const y=(c+1)/2,b=(f+1)/2,w=(_+1)/2,M=(u+d)/4,T=(h+m)/4,x=(p+g)/4;return y>b&&y>w?y<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(y),r=M/n,s=T/n):b>w?b<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(b),n=M/r,s=x/r):w<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(w),n=T/s,r=x/s),this.set(n,r,s,t),this}let v=Math.sqrt((g-p)*(g-p)+(h-m)*(h-m)+(d-u)*(d-u));return Math.abs(v)<.001&&(v=1),this.x=(g-p)/v,this.y=(h-m)/v,this.z=(d-u)/v,this.w=Math.acos((c+f+_-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Wn extends ls{constructor(e,t,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new dn(0,0,e,t),this.scissorTest=!1,this.viewport=new dn(0,0,e,t),this.texture=new mr({width:e,height:t,depth:1},n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:si,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Mc(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Xf extends mr{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=bi,this.minFilter=bi,this.wrapR=dr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class HY extends Wn{constructor(e,t,n){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Xf(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class P_ extends mr{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=bi,this.minFilter=bi,this.wrapR=dr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class GY extends Wn{constructor(e,t,n){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new P_(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class WY extends Wn{constructor(e,t,n,r={}){super(e,t,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<n;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class bn{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerp(e,t,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,r)}static slerpFlat(e,t,n,r,s,o,a){let l=n[r+0],c=n[r+1],u=n[r+2],h=n[r+3];const d=s[o+0],f=s[o+1],p=s[o+2],m=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=u,void(e[t+3]=h);if(1===a)return e[t+0]=d,e[t+1]=f,e[t+2]=p,void(e[t+3]=m);if(h!==m||l!==d||c!==f||u!==p){let g=1-a;const _=l*d+c*f+u*p+h*m,v=_>=0?1:-1,y=1-_*_;if(y>Number.EPSILON){const w=Math.sqrt(y),M=Math.atan2(w,_*v);g=Math.sin(g*M)/w,a=Math.sin(a*M)/w}const b=a*v;if(l=l*g+d*b,c=c*g+f*b,u=u*g+p*b,h=h*g+m*b,g===1-a){const w=1/Math.sqrt(l*l+c*c+u*u+h*h);l*=w,c*=w,u*=w,h*=w}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=h}static multiplyQuaternionsFlat(e,t,n,r,s,o){const a=n[r],l=n[r+1],c=n[r+2],u=n[r+3],h=s[o],d=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*h+l*f-c*d,e[t+1]=l*p+u*d+c*h-a*f,e[t+2]=c*p+u*f+a*d-l*h,e[t+3]=u*p-a*h-l*d-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(n/2),u=a(r/2),h=a(s/2),d=l(n/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=d*u*h+c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h-d*f*p;break;case"YXZ":this._x=d*u*h+c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h+d*f*p;break;case"ZXY":this._x=d*u*h-c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h-d*f*p;break;case"ZYX":this._x=d*u*h-c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h+d*f*p;break;case"YZX":this._x=d*u*h+c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h-d*f*p;break;case"XZY":this._x=d*u*h-c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],h=t[10],d=n+a+h;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(n>a&&n>h){const f=2*Math.sqrt(1+n-a-h);this._w=(u-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>h){const f=2*Math.sqrt(1+a-n-h);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+h-n-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(xi(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=n*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-n*c,this._z=s*u+o*c+n*l-r*a,this._w=o*u-n*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*n+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),h=Math.sin((1-t)*u)/c,d=Math.sin(t*u)/c;return this._w=o*h+this._w*d,this._x=n*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(s),n*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class C{constructor(e=0,t=0,n=0){C.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(rO.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(rO.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*n,u=l*n+a*t-s*r,h=l*r+s*n-o*t,d=-s*t-o*n-a*r;return this.x=c*l+d*-s+u*-a-h*-o,this.y=u*l+d*-o+h*-s-c*-a,this.z=h*l+d*-a+c*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return tS.copy(this).projectOnVector(e),this.sub(tS)}reflect(e){return this.sub(tS.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(xi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const tS=new C,rO=new bn;class Ho{constructor(e=new C(1/0,1/0,1/0),t=new C(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.length;l<c;l+=3){const u=e[l],h=e[l+1],d=e[l+2];u<t&&(t=u),h<n&&(n=h),d<r&&(r=d),u>s&&(s=u),h>o&&(o=h),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.count;l<c;l++){const u=e.getX(l),h=e.getY(l),d=e.getZ(l);u<t&&(t=u),h<n&&(n=h),d<r&&(r=d),u>s&&(s=u),h>o&&(o=h),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Sc.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){const s=n.attributes.position;for(let o=0,a=s.count;o<a;o++)Sc.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(Sc)}else null===n.boundingBox&&n.computeBoundingBox(),nS.copy(n.boundingBox),nS.applyMatrix4(e.matrixWorld),this.union(nS);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Sc),Sc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Kf),I_.subVectors(this.max,Kf),uh.subVectors(e.a,Kf),hh.subVectors(e.b,Kf),dh.subVectors(e.c,Kf),cl.subVectors(hh,uh),ul.subVectors(dh,hh),Tc.subVectors(uh,dh);let t=[0,-cl.z,cl.y,0,-ul.z,ul.y,0,-Tc.z,Tc.y,cl.z,0,-cl.x,ul.z,0,-ul.x,Tc.z,0,-Tc.x,-cl.y,cl.x,0,-ul.y,ul.x,0,-Tc.y,Tc.x,0];return!(!iS(t,uh,hh,dh,I_)||(t=[1,0,0,0,1,0,0,0,1],!iS(t,uh,hh,dh,I_)))&&(F_.crossVectors(cl,ul),t=[F_.x,F_.y,F_.z],iS(t,uh,hh,dh,I_))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Sc.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(Sc).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(ba[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ba[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ba[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ba[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ba[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ba[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ba[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ba[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ba)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const ba=[new C,new C,new C,new C,new C,new C,new C,new C],Sc=new C,nS=new Ho,uh=new C,hh=new C,dh=new C,cl=new C,ul=new C,Tc=new C,Kf=new C,I_=new C,F_=new C,Cc=new C;function iS(i,e,t,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){Cc.fromArray(i,s);const a=r.x*Math.abs(Cc.x)+r.y*Math.abs(Cc.y)+r.z*Math.abs(Cc.z),l=e.dot(Cc),c=t.dot(Cc),u=n.dot(Cc);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const XY=new Ho,sO=new C,L_=new C,rS=new C;class xa{constructor(e=new C,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):XY.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){rS.subVectors(e,this.center);const t=rS.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=.5*(n-this.radius);this.center.add(rS.multiplyScalar(r/n)),this.radius+=r}return this}union(e){return!0===this.center.equals(e.center)?L_.set(0,0,1).multiplyScalar(e.radius):L_.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(sO.copy(e.center).add(L_)),this.expandByPoint(sO.copy(e.center).sub(L_)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const wa=new C,sS=new C,O_=new C,hl=new C,oS=new C,k_=new C,aS=new C;class qf{constructor(e=new C,t=new C(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,wa)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=wa.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(wa.copy(this.direction).multiplyScalar(t).add(this.origin),wa.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){sS.copy(e).add(t).multiplyScalar(.5),O_.copy(t).sub(e).normalize(),hl.copy(this.origin).sub(sS);const s=.5*e.distanceTo(t),o=-this.direction.dot(O_),a=hl.dot(this.direction),l=-hl.dot(O_),c=hl.lengthSq(),u=Math.abs(1-o*o);let h,d,f,p;if(u>0)if(h=o*l-a,d=o*a-l,p=s*u,h>=0)if(d>=-p)if(d<=p){const m=1/u;h*=m,d*=m,f=h*(h+o*d+2*a)+d*(o*h+d+2*l)+c}else d=s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;else d=-s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;else d<=-p?(h=Math.max(0,-(-o*s+a)),d=h>0?-s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+c):d<=p?(h=0,d=Math.min(Math.max(-s,-l),s),f=d*(d+2*l)+c):(h=Math.max(0,-(o*s+a)),d=h>0?s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+c);else d=o>0?-s:s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;return n&&n.copy(this.direction).multiplyScalar(h).add(this.origin),r&&r.copy(O_).multiplyScalar(d).add(sS),f}intersectSphere(e,t){wa.subVectors(e.center,this.origin);const n=wa.dot(this.direction),r=wa.dot(wa)-n*n,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,l=n+o;return a<0&&l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return c>=0?(n=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(n=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),u>=0?(s=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),n>o||s>r||((s>n||n!=n)&&(n=s),(o<r||r!=r)&&(r=o),h>=0?(a=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),n>l||a>r)||((a>n||n!=n)&&(n=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return null!==this.intersectBox(e,wa)}intersectTriangle(e,t,n,r,s){oS.subVectors(t,e),k_.subVectors(n,e),aS.crossVectors(oS,k_);let a,o=this.direction.dot(aS);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}hl.subVectors(this.origin,e);const l=a*this.direction.dot(k_.crossVectors(hl,k_));if(l<0)return null;const c=a*this.direction.dot(oS.cross(hl));if(c<0||l+c>o)return null;const u=-a*hl.dot(aS);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class st{constructor(){st.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,r,s,o,a,l,c,u,h,d,f,p,m,g){const _=this.elements;return _[0]=e,_[4]=t,_[8]=n,_[12]=r,_[1]=s,_[5]=o,_[9]=a,_[13]=l,_[2]=c,_[6]=u,_[10]=h,_[14]=d,_[3]=f,_[7]=p,_[11]=m,_[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new st).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/fh.setFromMatrixColumn(e,0).length(),s=1/fh.setFromMatrixColumn(e,1).length(),o=1/fh.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if("XYZ"===e.order){const d=o*u,f=o*h,p=a*u,m=a*h;t[0]=l*u,t[4]=-l*h,t[8]=c,t[1]=f+p*c,t[5]=d-m*c,t[9]=-a*l,t[2]=m-d*c,t[6]=p+f*c,t[10]=o*l}else if("YXZ"===e.order){const d=l*u,f=l*h,p=c*u,m=c*h;t[0]=d+m*a,t[4]=p*a-f,t[8]=o*c,t[1]=o*h,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=m+d*a,t[10]=o*l}else if("ZXY"===e.order){const d=l*u,f=l*h,p=c*u,m=c*h;t[0]=d-m*a,t[4]=-o*h,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=m-d*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const d=o*u,f=o*h,p=a*u,m=a*h;t[0]=l*u,t[4]=p*c-f,t[8]=d*c+m,t[1]=l*h,t[5]=m*c+d,t[9]=f*c-p,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const d=o*l,f=o*c,p=a*l,m=a*c;t[0]=l*u,t[4]=m-d*h,t[8]=p*h+f,t[1]=h,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*h+p,t[10]=d-m*h}else if("XZY"===e.order){const d=o*l,f=o*c,p=a*l,m=a*c;t[0]=l*u,t[4]=-h,t[8]=c*u,t[1]=d*h+m,t[5]=o*u,t[9]=f*h-p,t[2]=p*h-f,t[6]=a*u,t[10]=m*h+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(KY,e,qY)}lookAt(e,t,n){const r=this.elements;return us.subVectors(e,t),0===us.lengthSq()&&(us.z=1),us.normalize(),dl.crossVectors(n,us),0===dl.lengthSq()&&(1===Math.abs(n.z)?us.x+=1e-4:us.z+=1e-4,us.normalize(),dl.crossVectors(n,us)),dl.normalize(),N_.crossVectors(us,dl),r[0]=dl.x,r[4]=N_.x,r[8]=us.x,r[1]=dl.y,r[5]=N_.y,r[9]=us.y,r[2]=dl.z,r[6]=N_.z,r[10]=us.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[4],l=n[8],c=n[12],u=n[1],h=n[5],d=n[9],f=n[13],p=n[2],m=n[6],g=n[10],_=n[14],v=n[3],y=n[7],b=n[11],w=n[15],M=r[0],T=r[4],x=r[8],E=r[12],D=r[1],L=r[5],z=r[9],H=r[13],U=r[2],X=r[6],I=r[10],V=r[14],W=r[3],j=r[7],q=r[11],oe=r[15];return s[0]=o*M+a*D+l*U+c*W,s[4]=o*T+a*L+l*X+c*j,s[8]=o*x+a*z+l*I+c*q,s[12]=o*E+a*H+l*V+c*oe,s[1]=u*M+h*D+d*U+f*W,s[5]=u*T+h*L+d*X+f*j,s[9]=u*x+h*z+d*I+f*q,s[13]=u*E+h*H+d*V+f*oe,s[2]=p*M+m*D+g*U+_*W,s[6]=p*T+m*L+g*X+_*j,s[10]=p*x+m*z+g*I+_*q,s[14]=p*E+m*H+g*V+_*oe,s[3]=v*M+y*D+b*U+w*W,s[7]=v*T+y*L+b*X+w*j,s[11]=v*x+y*z+b*I+w*q,s[15]=v*E+y*H+b*V+w*oe,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],h=e[6],d=e[10],f=e[14];return e[3]*(+s*l*h-r*c*h-s*a*d+n*c*d+r*a*f-n*l*f)+e[7]*(+t*l*f-t*c*d+s*o*d-r*o*f+r*c*u-s*l*u)+e[11]*(+t*c*h-t*a*f-s*o*h+n*o*f+s*a*u-n*c*u)+e[15]*(-r*a*u-t*l*h+t*a*d+r*o*h-n*o*d+n*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],g=e[14],_=e[15],v=h*g*c-m*d*c+m*l*f-a*g*f-h*l*_+a*d*_,y=p*d*c-u*g*c-p*l*f+o*g*f+u*l*_-o*d*_,b=u*m*c-p*h*c+p*a*f-o*m*f-u*a*_+o*h*_,w=p*h*l-u*m*l-p*a*d+o*m*d+u*a*g-o*h*g,M=t*v+n*y+r*b+s*w;if(0===M)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/M;return e[0]=v*T,e[1]=(m*d*s-h*g*s-m*r*f+n*g*f+h*r*_-n*d*_)*T,e[2]=(a*g*s-m*l*s+m*r*c-n*g*c-a*r*_+n*l*_)*T,e[3]=(h*l*s-a*d*s-h*r*c+n*d*c+a*r*f-n*l*f)*T,e[4]=y*T,e[5]=(u*g*s-p*d*s+p*r*f-t*g*f-u*r*_+t*d*_)*T,e[6]=(p*l*s-o*g*s-p*r*c+t*g*c+o*r*_-t*l*_)*T,e[7]=(o*d*s-u*l*s+u*r*c-t*d*c-o*r*f+t*l*f)*T,e[8]=b*T,e[9]=(p*h*s-u*m*s-p*n*f+t*m*f+u*n*_-t*h*_)*T,e[10]=(o*m*s-p*a*s+p*n*c-t*m*c-o*n*_+t*a*_)*T,e[11]=(u*a*s-o*h*s-u*n*c+t*h*c+o*n*f-t*a*f)*T,e[12]=w*T,e[13]=(u*m*r-p*h*r+p*n*d-t*m*d-u*n*g+t*h*g)*T,e[14]=(p*a*r-o*m*r-p*n*l+t*m*l+o*n*g-t*a*g)*T,e[15]=(o*h*r-u*a*r+u*n*l-t*h*l-o*n*d+t*a*d)*T,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+n,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+n,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,h=a+a,d=s*c,f=s*u,p=s*h,m=o*u,g=o*h,_=a*h,v=l*c,y=l*u,b=l*h,w=n.x,M=n.y,T=n.z;return r[0]=(1-(m+_))*w,r[1]=(f+b)*w,r[2]=(p-y)*w,r[3]=0,r[4]=(f-b)*M,r[5]=(1-(d+_))*M,r[6]=(g+v)*M,r[7]=0,r[8]=(p+y)*T,r[9]=(g-v)*T,r[10]=(1-(d+m))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let s=fh.set(r[0],r[1],r[2]).length();const o=fh.set(r[4],r[5],r[6]).length(),a=fh.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],uo.copy(this);const c=1/s,u=1/o,h=1/a;return uo.elements[0]*=c,uo.elements[1]*=c,uo.elements[2]*=c,uo.elements[4]*=u,uo.elements[5]*=u,uo.elements[6]*=u,uo.elements[8]*=h,uo.elements[9]*=h,uo.elements[10]*=h,t.setFromRotationMatrix(uo),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,r,s,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,c=2*s/(n-r),u=(t+e)/(t-e),h=(n+r)/(n-r),d=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=2*s/(t-e),a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,r,s,o){const a=this.elements,l=1/(t-e),c=1/(n-r),u=1/(o-s),h=(t+e)*l,d=(n+r)*c,f=(o+s)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const fh=new C,uo=new st,KY=new C(0,0,0),qY=new C(1,1,1),dl=new C,N_=new C,us=new C,oO=new st,aO=new bn;let ph=(()=>{class i{constructor(t=0,n=0,r=0,s=i.DefaultOrder){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,s=this._order){return this._x=t,this._y=n,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],u=s[5],h=s[9],d=s[2],f=s[6],p=s[10];switch(n){case"XYZ":this._y=Math.asin(xi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-xi(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-d,o),this._z=0);break;case"ZXY":this._x=Math.asin(xi(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-d,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-xi(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(xi(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(l,p));break;case"XZY":this._z=Math.asin(-xi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-h,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return oO.makeRotationFromQuaternion(t),this.setFromRotationMatrix(oO,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return aO.setFromEuler(this),this.setFromQuaternion(aO,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}return i.DefaultOrder="XYZ",i.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],i})();class B_{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let ZY=0;const lO=new C,mh=new bn,Ma=new st,U_=new C,Zf=new C,YY=new C,QY=new bn,cO=new C(1,0,0),uO=new C(0,1,0),hO=new C(0,0,1),$Y={type:"added"},dO={type:"removed"};let gn=(()=>{class i extends ls{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ZY++}),this.uuid=cs(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=i.DefaultUp.clone();const t=new C,n=new ph,r=new bn,s=new C(1,1,1);n._onChange(function o(){r.setFromEuler(n,!1)}),r._onChange(function a(){n.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new st},normalMatrix:{value:new Xr}}),this.matrix=new st,this.matrixWorld=new st,this.matrixAutoUpdate=i.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new B_,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return mh.setFromAxisAngle(t,n),this.quaternion.multiply(mh),this}rotateOnWorldAxis(t,n){return mh.setFromAxisAngle(t,n),this.quaternion.premultiply(mh),this}rotateX(t){return this.rotateOnAxis(cO,t)}rotateY(t){return this.rotateOnAxis(uO,t)}rotateZ(t){return this.rotateOnAxis(hO,t)}translateOnAxis(t,n){return lO.copy(t).applyQuaternion(this.quaternion),this.position.add(lO.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis(cO,t)}translateY(t){return this.translateOnAxis(uO,t)}translateZ(t){return this.translateOnAxis(hO,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(Ma.copy(this.matrixWorld).invert())}lookAt(t,n,r){t.isVector3?U_.copy(t):U_.set(t,n,r);const s=this.parent;this.updateWorldMatrix(!0,!1),Zf.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ma.lookAt(Zf,U_,this.up):Ma.lookAt(U_,Zf,this.up),this.quaternion.setFromRotationMatrix(Ma),s&&(Ma.extractRotation(s.matrixWorld),mh.setFromRotationMatrix(Ma),this.quaternion.premultiply(mh.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent($Y)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(dO)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const n=this.children[t];n.parent=null,n.dispatchEvent(dO)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Ma.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Ma.multiply(t.parent.matrixWorld)),t.applyMatrix4(Ma),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,n);if(void 0!==a)return a}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Zf,t,YY),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Zf,QY,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverseVisible(t)}traverseAncestors(t){const n=this.parent;null!==n&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].updateMatrixWorld(t)}updateWorldMatrix(t,n){const r=this.parent;if(!0===t&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===n){const s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].updateWorldMatrix(!1,!0)}}toJSON(t){const n=void 0===t||"string"==typeof t,r={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const s={};function o(l,c){return void 0===l[c.uuid]&&(l[c.uuid]=c.toJSON(t)),c.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const c=l.shapes;if(Array.isArray(c))for(let u=0,h=c.length;u<h;u++)o(t.shapes,c[u]);else o(t.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let c=0,u=this.material.length;c<u;c++)l.push(o(t.materials,this.material[c]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++)s.animations.push(o(t.animations,this.animations[l]))}if(n){const l=a(t.geometries),c=a(t.materials),u=a(t.textures),h=a(t.images),d=a(t.shapes),f=a(t.skeletons),p=a(t.animations),m=a(t.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),u.length>0&&(r.textures=u),h.length>0&&(r.images=h),d.length>0&&(r.shapes=d),f.length>0&&(r.skeletons=f),p.length>0&&(r.animations=p),m.length>0&&(r.nodes=m)}return r.object=s,r;function a(l){const c=[];for(const u in l){const h=l[u];delete h.metadata,c.push(h)}return c}}clone(t){return(new this.constructor).copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===n)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return i.DefaultUp=new C(0,1,0),i.DefaultMatrixAutoUpdate=!0,i})();const ho=new C,Sa=new C,lS=new C,Ta=new C,gh=new C,_h=new C,fO=new C,cS=new C,uS=new C,hS=new C;class hs{constructor(e=new C,t=new C,n=new C){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),ho.subVectors(e,t),r.cross(ho);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){ho.subVectors(r,t),Sa.subVectors(n,t),lS.subVectors(e,t);const o=ho.dot(ho),a=ho.dot(Sa),l=ho.dot(lS),c=Sa.dot(Sa),u=Sa.dot(lS),h=o*c-a*a;if(0===h)return s.set(-2,-1,-1);const d=1/h,f=(c*l-a*u)*d,p=(o*u-a*l)*d;return s.set(1-f-p,p,f)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Ta),Ta.x>=0&&Ta.y>=0&&Ta.x+Ta.y<=1}static getUV(e,t,n,r,s,o,a,l){return this.getBarycoord(e,t,n,r,Ta),l.set(0,0),l.addScaledVector(s,Ta.x),l.addScaledVector(o,Ta.y),l.addScaledVector(a,Ta.z),l}static isFrontFacing(e,t,n,r){return ho.subVectors(n,t),Sa.subVectors(e,t),ho.cross(Sa).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ho.subVectors(this.c,this.b),Sa.subVectors(this.a,this.b),.5*ho.cross(Sa).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return hs.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return hs.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,s){return hs.getUV(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return hs.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return hs.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let o,a;gh.subVectors(r,n),_h.subVectors(s,n),cS.subVectors(e,n);const l=gh.dot(cS),c=_h.dot(cS);if(l<=0&&c<=0)return t.copy(n);uS.subVectors(e,r);const u=gh.dot(uS),h=_h.dot(uS);if(u>=0&&h<=u)return t.copy(r);const d=l*h-u*c;if(d<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(n).addScaledVector(gh,o);hS.subVectors(e,s);const f=gh.dot(hS),p=_h.dot(hS);if(p>=0&&f<=p)return t.copy(s);const m=f*c-l*p;if(m<=0&&c>=0&&p<=0)return a=c/(c-p),t.copy(n).addScaledVector(_h,a);const g=u*p-f*h;if(g<=0&&h-u>=0&&f-p>=0)return fO.subVectors(s,r),a=(h-u)/(h-u+(f-p)),t.copy(r).addScaledVector(fO,a);const _=1/(g+m+d);return o=m*_,a=d*_,t.copy(n).addScaledVector(gh,o).addScaledVector(_h,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let JY=0;class Ai extends ls{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:JY++}),this.uuid=cs(),this.name="",this.type="Material",this.blending=fc,this.side=el,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=yM,this.blendDst=bM,this.blendEquation=pc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=p_,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=JL,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=M_,this.stencilZFail=M_,this.stencilZPass=M_,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===cL;continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==fc&&(n.blending=this.blending),this.side!==el&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class tr extends Ai{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ce(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Nf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Di=new C,V_=new te;class En{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=S_,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new Ce),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this}copyVector2sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new te),t[n++]=o.x,t[n++]=o.y}return this}copyVector3sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new C),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this}copyVector4sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new dn),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)V_.fromBufferAttribute(this,t),V_.applyMatrix3(e),this.setXY(t,V_.x,V_.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)Di.fromBufferAttribute(this,t),Di.applyMatrix3(e),this.setXYZ(t,Di.x,Di.y,Di.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Di.fromBufferAttribute(this,t),Di.applyMatrix4(e),this.setXYZ(t,Di.x,Di.y,Di.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Di.fromBufferAttribute(this,t),Di.applyNormalMatrix(e),this.setXYZ(t,Di.x,Di.y,Di.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Di.fromBufferAttribute(this,t),Di.transformDirection(e),this.setXYZ(t,Di.x,Di.y,Di.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==S_&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class eQ extends En{constructor(e,t,n){super(new Int8Array(e),t,n)}}class tQ extends En{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class nQ extends En{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class iQ extends En{constructor(e,t,n){super(new Int16Array(e),t,n)}}class dS extends En{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class rQ extends En{constructor(e,t,n){super(new Int32Array(e),t,n)}}class j_ extends En{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class sQ extends En{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}}class $e extends En{constructor(e,t,n){super(new Float32Array(e),t,n)}}class oQ extends En{constructor(e,t,n){super(new Float64Array(e),t,n)}}let aQ=0;const Rs=new st,fS=new gn,vh=new C,ds=new Ho,Yf=new Ho,Ki=new C;class wt extends ls{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:aQ++}),this.uuid=cs(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(nO(e)?j_:dS)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const s=(new Xr).getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Rs.makeRotationFromQuaternion(e),this.applyMatrix4(Rs),this}rotateX(e){return Rs.makeRotationX(e),this.applyMatrix4(Rs),this}rotateY(e){return Rs.makeRotationY(e),this.applyMatrix4(Rs),this}rotateZ(e){return Rs.makeRotationZ(e),this.applyMatrix4(Rs),this}translate(e,t,n){return Rs.makeTranslation(e,t,n),this.applyMatrix4(Rs),this}scale(e,t,n){return Rs.makeScale(e,t,n),this.applyMatrix4(Rs),this}lookAt(e){return fS.lookAt(e),fS.updateMatrix(),this.applyMatrix4(fS.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(vh).negate(),this.translate(vh.x,vh.y,vh.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new $e(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Ho);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new C(-1/0,-1/0,-1/0),new C(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++)ds.setFromBufferAttribute(t[n]),this.morphTargetsRelative?(Ki.addVectors(this.boundingBox.min,ds.min),this.boundingBox.expandByPoint(Ki),Ki.addVectors(this.boundingBox.max,ds.max),this.boundingBox.expandByPoint(Ki)):(this.boundingBox.expandByPoint(ds.min),this.boundingBox.expandByPoint(ds.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new xa);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new C,1/0);if(e){const n=this.boundingSphere.center;if(ds.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)Yf.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(Ki.addVectors(ds.min,Yf.min),ds.expandByPoint(Ki),Ki.addVectors(ds.max,Yf.max),ds.expandByPoint(Ki)):(ds.expandByPoint(Yf.min),ds.expandByPoint(Yf.max));ds.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)Ki.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(Ki));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)Ki.fromBufferAttribute(a,c),l&&(vh.fromBufferAttribute(e,c),Ki.add(vh)),r=Math.max(r,n.distanceToSquared(Ki))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new En(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let D=0;D<a;D++)c[D]=new C,u[D]=new C;const h=new C,d=new C,f=new C,p=new te,m=new te,g=new te,_=new C,v=new C;function y(D,L,z){h.fromArray(r,3*D),d.fromArray(r,3*L),f.fromArray(r,3*z),p.fromArray(o,2*D),m.fromArray(o,2*L),g.fromArray(o,2*z),d.sub(h),f.sub(h),m.sub(p),g.sub(p);const H=1/(m.x*g.y-g.x*m.y);!isFinite(H)||(_.copy(d).multiplyScalar(g.y).addScaledVector(f,-m.y).multiplyScalar(H),v.copy(f).multiplyScalar(m.x).addScaledVector(d,-g.x).multiplyScalar(H),c[D].add(_),c[L].add(_),c[z].add(_),u[D].add(v),u[L].add(v),u[z].add(v))}let b=this.groups;0===b.length&&(b=[{start:0,count:n.length}]);for(let D=0,L=b.length;D<L;++D){const z=b[D],H=z.start;for(let X=H,I=H+z.count;X<I;X+=3)y(n[X+0],n[X+1],n[X+2])}const w=new C,M=new C,T=new C,x=new C;function E(D){T.fromArray(s,3*D),x.copy(T);const L=c[D];w.copy(L),w.sub(T.multiplyScalar(T.dot(L))).normalize(),M.crossVectors(x,L);const H=M.dot(u[D])<0?-1:1;l[4*D]=w.x,l[4*D+1]=w.y,l[4*D+2]=w.z,l[4*D+3]=H}for(let D=0,L=b.length;D<L;++D){const z=b[D],H=z.start;for(let X=H,I=H+z.count;X<I;X+=3)E(n[X+0]),E(n[X+1]),E(n[X+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new En(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let d=0,f=n.count;d<f;d++)n.setXYZ(d,0,0,0);const r=new C,s=new C,o=new C,a=new C,l=new C,c=new C,u=new C,h=new C;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),m=e.getX(d+1),g=e.getX(d+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,m),o.fromBufferAttribute(t,g),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,m),c.fromBufferAttribute(n,g),a.add(u),l.add(u),c.add(u),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(m,l.x,l.y,l.z),n.setXYZ(g,c.x,c.y,c.z)}else for(let d=0,f=t.count;d<f;d+=3)r.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),n.setXYZ(d+0,u.x,u.y,u.z),n.setXYZ(d+1,u.x,u.y,u.z),n.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(void 0===e.attributes[r])continue;const o=n[r].array,a=e.attributes[r],l=a.array,c=a.itemSize*t,u=Math.min(l.length,o.length-c);for(let h=0,d=c;h<u;h++,d++)o[d]=l[h]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Ki.fromBufferAttribute(e,t),Ki.normalize(),e.setXYZ(t,Ki.x,Ki.y,Ki.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,h=a.normalized,d=new c.constructor(l.length*u);let f=0,p=0;for(let m=0,g=l.length;m<g;m++){f=a.isInterleavedBufferAttribute?l[m]*a.data.stride+a.offset:l[m]*u;for(let _=0;_<u;_++)d[p++]=c[f++]}return new En(d,u,h)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new wt,n=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],n);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,h=c.length;u<h;u++){const f=e(c[u],n);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n)e.data.attributes[l]=n[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let h=0,d=c.length;h<d;h++)u.push(c[h].toJSON(e.data));u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const u=[],h=s[c];for(let d=0,f=h.length;d<f;d++)u.push(h[d].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const h=o[c];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const pO=new st,yh=new qf,pS=new xa,fl=new C,pl=new C,ml=new C,mS=new C,gS=new C,_S=new C,z_=new C,H_=new C,G_=new C,W_=new te,X_=new te,K_=new te,vS=new C,q_=new C;class Ke extends gn{constructor(e=new wt,t=new tr){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===n.boundingSphere&&n.computeBoundingSphere(),pS.copy(n.boundingSphere),pS.applyMatrix4(s),!1===e.ray.intersectsSphere(pS))||(pO.copy(s).invert(),yh.copy(e.ray).applyMatrix4(pO),null!==n.boundingBox&&!1===yh.intersectsBox(n.boundingBox)))return;let o;const a=n.index,l=n.attributes.position,c=n.morphAttributes.position,u=n.morphTargetsRelative,h=n.attributes.uv,d=n.attributes.uv2,f=n.groups,p=n.drawRange;if(null!==a)if(Array.isArray(r))for(let m=0,g=f.length;m<g;m++){const _=f[m],v=r[_.materialIndex];for(let w=Math.max(_.start,p.start),M=Math.min(a.count,Math.min(_.start+_.count,p.start+p.count));w<M;w+=3){const T=a.getX(w),x=a.getX(w+1),E=a.getX(w+2);o=Z_(this,v,e,yh,l,c,u,h,d,T,x,E),o&&(o.faceIndex=Math.floor(w/3),o.face.materialIndex=_.materialIndex,t.push(o))}}else for(let _=Math.max(0,p.start),v=Math.min(a.count,p.start+p.count);_<v;_+=3){const y=a.getX(_),b=a.getX(_+1),w=a.getX(_+2);o=Z_(this,r,e,yh,l,c,u,h,d,y,b,w),o&&(o.faceIndex=Math.floor(_/3),t.push(o))}else if(void 0!==l)if(Array.isArray(r))for(let m=0,g=f.length;m<g;m++){const _=f[m],v=r[_.materialIndex];for(let w=Math.max(_.start,p.start),M=Math.min(l.count,Math.min(_.start+_.count,p.start+p.count));w<M;w+=3)o=Z_(this,v,e,yh,l,c,u,h,d,w,w+1,w+2),o&&(o.faceIndex=Math.floor(w/3),o.face.materialIndex=_.materialIndex,t.push(o))}else for(let _=Math.max(0,p.start),v=Math.min(l.count,p.start+p.count);_<v;_+=3)o=Z_(this,r,e,yh,l,c,u,h,d,_,_+1,_+2),o&&(o.faceIndex=Math.floor(_/3),t.push(o))}}function Z_(i,e,t,n,r,s,o,a,l,c,u,h){fl.fromBufferAttribute(r,c),pl.fromBufferAttribute(r,u),ml.fromBufferAttribute(r,h);const d=i.morphTargetInfluences;if(s&&d){z_.set(0,0,0),H_.set(0,0,0),G_.set(0,0,0);for(let p=0,m=s.length;p<m;p++){const g=d[p],_=s[p];0!==g&&(mS.fromBufferAttribute(_,c),gS.fromBufferAttribute(_,u),_S.fromBufferAttribute(_,h),o?(z_.addScaledVector(mS,g),H_.addScaledVector(gS,g),G_.addScaledVector(_S,g)):(z_.addScaledVector(mS.sub(fl),g),H_.addScaledVector(gS.sub(pl),g),G_.addScaledVector(_S.sub(ml),g)))}fl.add(z_),pl.add(H_),ml.add(G_)}i.isSkinnedMesh&&(i.boneTransform(c,fl),i.boneTransform(u,pl),i.boneTransform(h,ml));const f=function lQ(i,e,t,n,r,s,o,a){let l;if(l=e.side===as?n.intersectTriangle(o,s,r,!0,a):n.intersectTriangle(r,s,o,e.side!==oo,a),null===l)return null;q_.copy(a),q_.applyMatrix4(i.matrixWorld);const c=t.ray.origin.distanceTo(q_);return c<t.near||c>t.far?null:{distance:c,point:q_.clone(),object:i}}(i,e,t,n,fl,pl,ml,vS);if(f){a&&(W_.fromBufferAttribute(a,c),X_.fromBufferAttribute(a,u),K_.fromBufferAttribute(a,h),f.uv=hs.getUV(vS,fl,pl,ml,W_,X_,K_,new te)),l&&(W_.fromBufferAttribute(l,c),X_.fromBufferAttribute(l,u),K_.fromBufferAttribute(l,h),f.uv2=hs.getUV(vS,fl,pl,ml,W_,X_,K_,new te));const p={a:c,b:u,c:h,normal:new C,materialIndex:0};hs.getNormal(fl,pl,ml,p.normal),f.face=p}return f}class Xn extends wt{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],h=[];let d=0,f=0;function p(m,g,_,v,y,b,w,M,T,x,E){const D=b/T,L=w/x,z=b/2,H=w/2,U=M/2,X=T+1,I=x+1;let V=0,W=0;const j=new C;for(let q=0;q<I;q++){const oe=q*L-H;for(let J=0;J<X;J++)j[m]=(J*D-z)*v,j[g]=oe*y,j[_]=U,c.push(j.x,j.y,j.z),j[m]=0,j[g]=0,j[_]=M>0?1:-1,u.push(j.x,j.y,j.z),h.push(J/T),h.push(1-q/x),V+=1}for(let q=0;q<x;q++)for(let oe=0;oe<T;oe++){const fe=d+oe+X*(q+1),he=d+(oe+1)+X*(q+1),Re=d+(oe+1)+X*q;l.push(d+oe+X*q,fe,Re),l.push(fe,he,Re),W+=6}a.addGroup(f,W,E),f+=W,d+=V}p("z","y","x",-1,-1,n,t,e,o,s,0),p("z","y","x",1,-1,n,t,-e,o,s,1),p("x","z","y",1,1,e,n,t,r,o,2),p("x","z","y",1,-1,e,n,-t,r,o,3),p("x","y","z",1,-1,e,t,n,r,s,4),p("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new $e(c,3)),this.setAttribute("normal",new $e(u,3)),this.setAttribute("uv",new $e(h,2))}static fromJSON(e){return new Xn(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function bh(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];e[t][n]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function gr(i){const e={};for(let t=0;t<i.length;t++){const n=bh(i[t]);for(const r in n)e[r]=n[r]}return e}const Go={clone:bh,merge:gr};class Zn extends Ai{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=bh(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Qf extends gn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new st,this.projectionMatrix=new st,this.projectionMatrixInverse=new st}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class zi extends Qf{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Hf*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*xc*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Hf*Math.atan(Math.tan(.5*xc*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*xc*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*n/c,r*=o.width/l,n*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class mO extends gn{constructor(e,t,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const r=new zi(90,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new C(1,0,0)),this.add(r);const s=new zi(90,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new C(-1,0,0)),this.add(s);const o=new zi(90,1,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new C(0,1,0)),this.add(o);const a=new zi(90,1,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new C(0,-1,0)),this.add(a);const l=new zi(90,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new C(0,0,1)),this.add(l);const c=new zi(90,1,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new C(0,0,-1)),this.add(c)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[r,s,o,a,l,c]=this.children,u=e.getRenderTarget(),h=e.toneMapping,d=e.xr.enabled;e.toneMapping=jo,e.xr.enabled=!1;const f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,s),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,a),e.setRenderTarget(n,4),e.render(t,l),n.texture.generateMipmaps=f,e.setRenderTarget(n,5),e.render(t,c),e.setRenderTarget(u),e.toneMapping=h,e.xr.enabled=d,n.texture.needsPMREMUpdate=!0}}class $f extends mr{constructor(e,t,n,r,s,o,a,l,c,u){super(e=void 0!==e?e:[],t=void 0!==t?t:tl,n,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class gO extends Wn{constructor(e,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1};this.texture=new $f([n,n,n,n,n,n],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:si}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n_uniforms={tEquirect:{value:null}},n_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",n_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new Xn(5,5,5),s=new Zn({name:"CubemapFromEquirect",uniforms:bh(n_uniforms),vertexShader:n_vertexShader,fragmentShader:n_fragmentShader,side:as,blending:ao});s.uniforms.tEquirect.value=t;const o=new Ke(r,s),a=t.minFilter;return t.minFilter===ya&&(t.minFilter=si),new mO(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(s)}}const yS=new C,hQ=new C,dQ=new Xr;class Wo{constructor(e=new C(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=yS.subVectors(n,t).cross(hQ.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(yS),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(n).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||dQ.getNormalMatrix(e),r=this.coplanarPoint(yS).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Mh=new xa,Y_=new C;class Q_{constructor(e=new Wo,t=new Wo,n=new Wo,r=new Wo,s=new Wo,o=new Wo){this.planes=[e,t,n,r,s,o]}set(e,t,n,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,r=n[0],s=n[1],o=n[2],a=n[3],l=n[4],c=n[5],u=n[6],h=n[7],d=n[8],f=n[9],p=n[10],m=n[11],g=n[12],_=n[13],v=n[14],y=n[15];return t[0].setComponents(a-r,h-l,m-d,y-g).normalize(),t[1].setComponents(a+r,h+l,m+d,y+g).normalize(),t[2].setComponents(a+s,h+c,m+f,y+_).normalize(),t[3].setComponents(a-s,h-c,m-f,y-_).normalize(),t[4].setComponents(a-o,h-u,m-p,y-v).normalize(),t[5].setComponents(a+o,h+u,m+p,y+v).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Mh.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Mh)}intersectsSprite(e){return Mh.center.set(0,0,0),Mh.radius=.7071067811865476,Mh.applyMatrix4(e.matrixWorld),this.intersectsSphere(Mh)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(Y_.x=r.normal.x>0?e.max.x:e.min.x,Y_.y=r.normal.y>0?e.max.y:e.min.y,Y_.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Y_)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function _O(){let i=null,e=!1,t=null,n=null;function r(s,o){t(s,o),n=i.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function fQ(i,e){const t=e.isWebGL2,n=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),n.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=n.get(c);u&&(i.deleteBuffer(u.buffer),n.delete(c))},update:function l(c,u){if(c.isGLBufferAttribute){const d=n.get(c);return void((!d||d.version<c.version)&&n.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const h=n.get(c);void 0===h?n.set(c,function r(c,u){const h=c.array,d=c.usage,f=i.createBuffer();let p;if(i.bindBuffer(u,f),i.bufferData(u,h,d),c.onUploadCallback(),h instanceof Float32Array)p=5126;else if(h instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");p=5131}else p=5123;else if(h instanceof Int16Array)p=5122;else if(h instanceof Uint32Array)p=5125;else if(h instanceof Int32Array)p=5124;else if(h instanceof Int8Array)p=5120;else if(h instanceof Uint8Array)p=5121;else{if(!(h instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);p=5121}return{buffer:f,type:p,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version}}(c,u)):h.version<c.version&&(function s(c,u,h){const d=u.array,f=u.updateRange;i.bindBuffer(h,c),-1===f.count?i.bufferSubData(h,0,d):(t?i.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):i.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1)}(h.buffer,c,u),h.version=c.version)}}}class Ca extends wt{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(n),l=Math.floor(r),c=a+1,u=l+1,h=e/a,d=t/l,f=[],p=[],m=[],g=[];for(let _=0;_<u;_++){const v=_*d-o;for(let y=0;y<c;y++)p.push(y*h-s,-v,0),m.push(0,0,1),g.push(y/a),g.push(1-_/l)}for(let _=0;_<l;_++)for(let v=0;v<a;v++){const b=v+c*(_+1),w=v+1+c*(_+1),M=v+1+c*_;f.push(v+c*_,b,M),f.push(b,w,M)}this.setIndex(f),this.setAttribute("position",new $e(p,3)),this.setAttribute("normal",new $e(m,3)),this.setAttribute("uv",new $e(g,2))}static fromJSON(e){return new Ca(e.width,e.height,e.widthSegments,e.heightSegments)}}const $t={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\nvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = mix(F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence);\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\nconst mat3 XYZ_TO_REC709 = mat3(\n    3.2404542, -0.9692660,  0.0556434,\n   -1.5371385,  1.8760108, -0.2040259,\n   -0.4985314,  0.0415560,  1.0572252\n);\nvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n   vec3 sqrtF0 = sqrt( fresnel0 );\n   return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n}\nvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n   return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n}\nfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n   return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n}\nvec3 evalSensitivity( float OPD, vec3 shift ) {\n   float phase = 2.0 * PI * OPD * 1.0e-9;\n   vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n   vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n   vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n   vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( -pow2( phase ) * var );\n   xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[0] ) * exp( -4.5282e+09 * pow2( phase ) );\n   xyz /= 1.0685e-7;\n   vec3 srgb = XYZ_TO_REC709 * xyz;\n   return srgb;\n}\nvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n   vec3 I;\n   float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n   float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n   float cosTheta2Sq = 1.0 - sinTheta2Sq;\n   if ( cosTheta2Sq < 0.0 ) {\n       return vec3( 1.0 );\n   }\n   float cosTheta2 = sqrt( cosTheta2Sq );\n   float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n   float R12 = F_Schlick( R0, 1.0, cosTheta1 );\n   float R21 = R12;\n   float T121 = 1.0 - R12;\n   float phi12 = 0.0;\n   if ( iridescenceIOR < outsideIOR ) phi12 = PI;\n   float phi21 = PI - phi12;\n   vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );   vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n   vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n   vec3 phi23 = vec3( 0.0 );\n   if ( baseIOR[0] < iridescenceIOR ) phi23[0] = PI;\n   if ( baseIOR[1] < iridescenceIOR ) phi23[1] = PI;\n   if ( baseIOR[2] < iridescenceIOR ) phi23[2] = PI;\n   float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n   vec3 phi = vec3( phi21 ) + phi23;\n   vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n   vec3 r123 = sqrt( R123 );\n   vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n   vec3 C0 = R12 + Rs;\n   I = C0;\n   vec3 Cm = Rs - T121;\n   for ( int m = 1; m <= 2; ++m ) {\n       Cm *= r123;\n       vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n       I += Cm * Sm;\n   }\n   return max( I, vec3( 0.0 ) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\nfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\nif ( material.iridescenceThickness == 0.0 ) {\n\tmaterial.iridescence = 0.0;\n} else {\n\tmaterial.iridescence = saturate( material.iridescence );\n}\nif ( material.iridescence > 0.0 ) {\n\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Qe={common:{diffuse:{value:new Ce(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Xr},uv2Transform:{value:new Xr},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new te(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ce(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ce(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Xr}},sprite:{diffuse:{value:new Ce(16777215)},opacity:{value:1},center:{value:new te(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Xr}}},fo={basic:{uniforms:gr([Qe.common,Qe.specularmap,Qe.envmap,Qe.aomap,Qe.lightmap,Qe.fog]),vertexShader:$t.meshbasic_vert,fragmentShader:$t.meshbasic_frag},lambert:{uniforms:gr([Qe.common,Qe.specularmap,Qe.envmap,Qe.aomap,Qe.lightmap,Qe.emissivemap,Qe.fog,Qe.lights,{emissive:{value:new Ce(0)}}]),vertexShader:$t.meshlambert_vert,fragmentShader:$t.meshlambert_frag},phong:{uniforms:gr([Qe.common,Qe.specularmap,Qe.envmap,Qe.aomap,Qe.lightmap,Qe.emissivemap,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,Qe.fog,Qe.lights,{emissive:{value:new Ce(0)},specular:{value:new Ce(1118481)},shininess:{value:30}}]),vertexShader:$t.meshphong_vert,fragmentShader:$t.meshphong_frag},standard:{uniforms:gr([Qe.common,Qe.envmap,Qe.aomap,Qe.lightmap,Qe.emissivemap,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,Qe.roughnessmap,Qe.metalnessmap,Qe.fog,Qe.lights,{emissive:{value:new Ce(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:$t.meshphysical_vert,fragmentShader:$t.meshphysical_frag},toon:{uniforms:gr([Qe.common,Qe.aomap,Qe.lightmap,Qe.emissivemap,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,Qe.gradientmap,Qe.fog,Qe.lights,{emissive:{value:new Ce(0)}}]),vertexShader:$t.meshtoon_vert,fragmentShader:$t.meshtoon_frag},matcap:{uniforms:gr([Qe.common,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,Qe.fog,{matcap:{value:null}}]),vertexShader:$t.meshmatcap_vert,fragmentShader:$t.meshmatcap_frag},points:{uniforms:gr([Qe.points,Qe.fog]),vertexShader:$t.points_vert,fragmentShader:$t.points_frag},dashed:{uniforms:gr([Qe.common,Qe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:$t.linedashed_vert,fragmentShader:$t.linedashed_frag},depth:{uniforms:gr([Qe.common,Qe.displacementmap]),vertexShader:$t.depth_vert,fragmentShader:$t.depth_frag},normal:{uniforms:gr([Qe.common,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,{opacity:{value:1}}]),vertexShader:$t.meshnormal_vert,fragmentShader:$t.meshnormal_frag},sprite:{uniforms:gr([Qe.sprite,Qe.fog]),vertexShader:$t.sprite_vert,fragmentShader:$t.sprite_frag},background:{uniforms:{uvTransform:{value:new Xr},t2D:{value:null}},vertexShader:$t.background_vert,fragmentShader:$t.background_frag},cube:{uniforms:gr([Qe.envmap,{opacity:{value:1}}]),vertexShader:$t.cube_vert,fragmentShader:$t.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:$t.equirect_vert,fragmentShader:$t.equirect_frag},distanceRGBA:{uniforms:gr([Qe.common,Qe.displacementmap,{referencePosition:{value:new C},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:$t.distanceRGBA_vert,fragmentShader:$t.distanceRGBA_frag},shadow:{uniforms:gr([Qe.lights,Qe.fog,{color:{value:new Ce(0)},opacity:{value:1}}]),vertexShader:$t.shadow_vert,fragmentShader:$t.shadow_frag}};function hJ(i,e,t,n,r,s){const o=new Ce(0);let l,c,a=!0===r?0:1,u=null,h=0,d=null;function p(m,g){t.buffers.color.setClear(m.r,m.g,m.b,g,s)}return{getClearColor:function(){return o},setClearColor:function(m,g=1){o.set(m),a=g,p(o,a)},getClearAlpha:function(){return a},setClearAlpha:function(m){a=m,p(o,a)},render:function f(m,g){let _=!1,v=!0===g.isScene?g.background:null;v&&v.isTexture&&(v=e.get(v));const y=i.xr,b=y.getSession&&y.getSession();b&&"additive"===b.environmentBlendMode&&(v=null),null===v?p(o,a):v&&v.isColor&&(p(v,1),_=!0),(i.autoClear||_)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),v&&(v.isCubeTexture||v.mapping===rh)?(void 0===c&&(c=new Ke(new Xn(1,1,1),new Zn({name:"BackgroundCubeMaterial",uniforms:bh(fo.cube.uniforms),vertexShader:fo.cube.vertexShader,fragmentShader:fo.cube.fragmentShader,side:as,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(w,M,T){this.matrixWorld.copyPosition(T.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(c)),c.material.uniforms.envMap.value=v,c.material.uniforms.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,(u!==v||h!==v.version||d!==i.toneMapping)&&(c.material.needsUpdate=!0,u=v,h=v.version,d=i.toneMapping),c.layers.enableAll(),m.unshift(c,c.geometry,c.material,0,0,null)):v&&v.isTexture&&(void 0===l&&(l=new Ke(new Ca(2,2),new Zn({name:"BackgroundMaterial",uniforms:bh(fo.background.uniforms),vertexShader:fo.background.vertexShader,fragmentShader:fo.background.fragmentShader,side:el,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(l)),l.material.uniforms.t2D.value=v,!0===v.matrixAutoUpdate&&v.updateMatrix(),l.material.uniforms.uvTransform.value.copy(v.matrix),(u!==v||h!==v.version||d!==i.toneMapping)&&(l.material.needsUpdate=!0,u=v,h=v.version,d=i.toneMapping),l.layers.enableAll(),m.unshift(l,l.geometry,l.material,0,0,null))}}}function dJ(i,e,t,n){const r=i.getParameter(34921),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),o=n.isWebGL2||null!==s,a={},l=g(null);let c=l,u=!1;function f(U){return n.isWebGL2?i.bindVertexArray(U):s.bindVertexArrayOES(U)}function p(U){return n.isWebGL2?i.deleteVertexArray(U):s.deleteVertexArrayOES(U)}function g(U){const X=[],I=[],V=[];for(let W=0;W<r;W++)X[W]=0,I[W]=0,V[W]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:X,enabledAttributes:I,attributeDivisors:V,object:U,attributes:{},index:null}}function y(){const U=c.newAttributes;for(let X=0,I=U.length;X<I;X++)U[X]=0}function b(U){w(U,0)}function w(U,X){const V=c.enabledAttributes,W=c.attributeDivisors;c.newAttributes[U]=1,0===V[U]&&(i.enableVertexAttribArray(U),V[U]=1),W[U]!==X&&((n.isWebGL2?i:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](U,X),W[U]=X)}function M(){const U=c.newAttributes,X=c.enabledAttributes;for(let I=0,V=X.length;I<V;I++)X[I]!==U[I]&&(i.disableVertexAttribArray(I),X[I]=0)}function T(U,X,I,V,W,j){!0!==n.isWebGL2||5124!==I&&5125!==I?i.vertexAttribPointer(U,X,I,V,W,j):i.vertexAttribIPointer(U,X,I,W,j)}function z(){H(),u=!0,c!==l&&(c=l,f(c.object))}function H(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function h(U,X,I,V,W){let j=!1;if(o){const q=function m(U,X,I){const V=!0===I.wireframe;let W=a[U.id];void 0===W&&(W={},a[U.id]=W);let j=W[X.id];void 0===j&&(j={},W[X.id]=j);let q=j[V];return void 0===q&&(q=g(function d(){return n.isWebGL2?i.createVertexArray():s.createVertexArrayOES()}()),j[V]=q),q}(V,I,X);c!==q&&(c=q,f(c.object)),j=function _(U,X,I,V){const W=c.attributes,j=X.attributes;let q=0;const oe=I.getAttributes();for(const J in oe)if(oe[J].location>=0){const he=W[J];let Re=j[J];if(void 0===Re&&("instanceMatrix"===J&&U.instanceMatrix&&(Re=U.instanceMatrix),"instanceColor"===J&&U.instanceColor&&(Re=U.instanceColor)),void 0===he||he.attribute!==Re||Re&&he.data!==Re.data)return!0;q++}return c.attributesNum!==q||c.index!==V}(U,V,I,W),j&&function v(U,X,I,V){const W={},j=X.attributes;let q=0;const oe=I.getAttributes();for(const J in oe)if(oe[J].location>=0){let he=j[J];void 0===he&&("instanceMatrix"===J&&U.instanceMatrix&&(he=U.instanceMatrix),"instanceColor"===J&&U.instanceColor&&(he=U.instanceColor));const Re={};Re.attribute=he,he&&he.data&&(Re.data=he.data),W[J]=Re,q++}c.attributes=W,c.attributesNum=q,c.index=V}(U,V,I,W)}else{const q=!0===X.wireframe;(c.geometry!==V.id||c.program!==I.id||c.wireframe!==q)&&(c.geometry=V.id,c.program=I.id,c.wireframe=q,j=!0)}null!==W&&t.update(W,34963),(j||u)&&(u=!1,function x(U,X,I,V){if(!1===n.isWebGL2&&(U.isInstancedMesh||V.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;y();const W=V.attributes,j=I.getAttributes(),q=X.defaultAttributeValues;for(const oe in j){const J=j[oe];if(J.location>=0){let fe=W[oe];if(void 0===fe&&("instanceMatrix"===oe&&U.instanceMatrix&&(fe=U.instanceMatrix),"instanceColor"===oe&&U.instanceColor&&(fe=U.instanceColor)),void 0!==fe){const he=fe.normalized,Re=fe.itemSize,$=t.get(fe);if(void 0===$)continue;const K=$.buffer,pe=$.type,Fe=$.bytesPerElement;if(fe.isInterleavedBufferAttribute){const _e=fe.data,ot=_e.stride,ue=fe.offset;if(_e.isInstancedInterleavedBuffer){for(let de=0;de<J.locationSize;de++)w(J.location+de,_e.meshPerAttribute);!0!==U.isInstancedMesh&&void 0===V._maxInstanceCount&&(V._maxInstanceCount=_e.meshPerAttribute*_e.count)}else for(let de=0;de<J.locationSize;de++)b(J.location+de);i.bindBuffer(34962,K);for(let de=0;de<J.locationSize;de++)T(J.location+de,Re/J.locationSize,pe,he,ot*Fe,(ue+Re/J.locationSize*de)*Fe)}else{if(fe.isInstancedBufferAttribute){for(let _e=0;_e<J.locationSize;_e++)w(J.location+_e,fe.meshPerAttribute);!0!==U.isInstancedMesh&&void 0===V._maxInstanceCount&&(V._maxInstanceCount=fe.meshPerAttribute*fe.count)}else for(let _e=0;_e<J.locationSize;_e++)b(J.location+_e);i.bindBuffer(34962,K);for(let _e=0;_e<J.locationSize;_e++)T(J.location+_e,Re/J.locationSize,pe,he,Re*Fe,Re/J.locationSize*_e*Fe)}}else if(void 0!==q){const he=q[oe];if(void 0!==he)switch(he.length){case 2:i.vertexAttrib2fv(J.location,he);break;case 3:i.vertexAttrib3fv(J.location,he);break;case 4:i.vertexAttrib4fv(J.location,he);break;default:i.vertexAttrib1fv(J.location,he)}}}}M()}(U,X,I,V),null!==W&&i.bindBuffer(34963,t.get(W).buffer))},reset:z,resetDefaultState:H,dispose:function E(){z();for(const U in a){const X=a[U];for(const I in X){const V=X[I];for(const W in V)p(V[W].object),delete V[W];delete X[I]}delete a[U]}},releaseStatesOfGeometry:function D(U){if(void 0===a[U.id])return;const X=a[U.id];for(const I in X){const V=X[I];for(const W in V)p(V[W].object),delete V[W];delete X[I]}delete a[U.id]},releaseStatesOfProgram:function L(U){for(const X in a){const I=a[X];if(void 0===I[U.id])continue;const V=I[U.id];for(const W in V)p(V[W].object),delete V[W];delete I[U.id]}},initAttributes:y,enableAttribute:b,disableUnusedAttributes:M}}function fJ(i,e,t,n){const r=n.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,u){i.drawArrays(s,c,u),t.update(u,s,1)},this.renderInstances=function l(c,u,h){if(0===h)return;let d,f;if(r)d=i,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===d)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[f](s,c,u,h),t.update(u,s,h)}}function pJ(i,e,t){let n;function s(T){if("highp"===T){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";T="mediump"}return"mediump"===T&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&i instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&i instanceof WebGL2ComputeRenderingContext;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,h=i.getParameter(34930),d=i.getParameter(35660),f=i.getParameter(3379),p=i.getParameter(34076),m=i.getParameter(34921),g=i.getParameter(36347),_=i.getParameter(36348),v=i.getParameter(36349),y=d>0,b=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==n)return n;if(!0===e.has("EXT_texture_filter_anisotropic")){const T=e.get("EXT_texture_filter_anisotropic");n=i.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:m,maxVertexUniforms:g,maxVaryings:_,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:y&&b,maxSamples:o?i.getParameter(36183):0}}function mJ(i){const e=this;let t=null,n=0,r=!1,s=!1;const o=new Wo,a=new Xr,l={value:null,needsUpdate:!1};function c(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function u(h,d,f,p){const m=null!==h?h.length:0;let g=null;if(0!==m){if(g=l.value,!0!==p||null===g){const _=f+4*m,v=d.matrixWorldInverse;a.getNormalMatrix(v),(null===g||g.length<_)&&(g=new Float32Array(_));for(let y=0,b=f;y!==m;++y,b+=4)o.copy(h[y]).applyMatrix4(v,a),o.normal.toArray(g,b),g[b+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=m,e.numIntersection=0,g}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d,f){const p=0!==h.length||d||0!==n||r;return r=d,t=u(h,f,0),n=h.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,c()},this.setState=function(h,d,f){const p=h.clippingPlanes,m=h.clipIntersection,g=h.clipShadows,_=i.get(h);if(!r||null===p||0===p.length||s&&!g)s?u(null):c();else{const v=s?0:n,y=4*v;let b=_.clippingState||null;l.value=b,b=u(p,d,y,f);for(let w=0;w!==y;++w)b[w]=t[w];_.clippingState=b,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=v}}}function gJ(i){let e=new WeakMap;function t(o,a){return a===Bf?o.mapping=tl:a===Uf&&(o.mapping=nl),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function n(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(a===Bf||a===Uf){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new gO(l.height/2);return c.fromEquirectangularTexture(i,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}fo.physical={uniforms:gr([fo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new te(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Ce(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new te},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ce(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Ce(1,1,1)},specularColorMap:{value:null}}]),vertexShader:$t.meshphysical_vert,fragmentShader:$t.meshphysical_frag};class Ec extends Qf{constructor(e=-1,t=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,o=n+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const vO=[.125,.215,.35,.446,.526,.582],bS=new Ec,yO=new Ce;let xS=null;const Ac=(1+Math.sqrt(5))/2,Th=1/Ac,bO=[new C(1,1,1),new C(-1,1,1),new C(1,1,-1),new C(-1,1,-1),new C(0,Ac,Th),new C(0,Ac,-Th),new C(Th,0,Ac),new C(-Th,0,Ac),new C(Ac,Th,0),new C(-Ac,Th,0)];class wS{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){xS=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=MO(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=wO(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(xS),e.scissorTest=!1,$_(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===tl||e.mapping===nl?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),xS=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:si,minFilter:si,generateMipmaps:!1,type:lo,format:fr,encoding:ol,depthBuffer:!1},r=xO(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=xO(e,t,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function _J(i){const e=[],t=[],n=[];let r=i;const s=i-4+1+vO.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>i-4?l=vO[o-i+4-1]:0===o&&(l=0),n.push(l);const c=1/(a-2),u=-c,h=1+c,d=[u,u,h,u,h,h,u,u,h,h,u,h],f=6,p=6,m=3,g=2,_=1,v=new Float32Array(m*p*f),y=new Float32Array(g*p*f),b=new Float32Array(_*p*f);for(let M=0;M<f;M++){const T=M%3*2/3-1,x=M>2?0:-1;v.set([T,x,0,T+2/3,x,0,T+2/3,x+1,0,T,x,0,T+2/3,x+1,0,T,x+1,0],m*p*M),y.set(d,g*p*M),b.set([M,M,M,M,M,M],_*p*M)}const w=new wt;w.setAttribute("position",new En(v,m)),w.setAttribute("uv",new En(y,g)),w.setAttribute("faceIndex",new En(b,_)),e.push(w),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}(s)),this._blurMaterial=function vJ(i,e,t){const n=new Float32Array(20),r=new C(0,1,0);return new Zn({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:ao,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new Ke(this._lodPlanes[0],e);this._renderer.compile(t,bS)}_sceneToCubeUV(e,t,n,r){const a=new zi(90,1,t,n),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,d=u.toneMapping;u.getClearColor(yO),u.toneMapping=jo,u.autoClear=!1;const f=new tr({name:"PMREM.Background",side:as,depthWrite:!1,depthTest:!1}),p=new Ke(new Xn,f);let m=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,m=!0):(f.color.copy(yO),m=!0);for(let _=0;_<6;_++){const v=_%3;0===v?(a.up.set(0,l[_],0),a.lookAt(c[_],0,0)):1===v?(a.up.set(0,0,l[_]),a.lookAt(0,c[_],0)):(a.up.set(0,l[_],0),a.lookAt(0,0,c[_]));const y=this._cubeSize;$_(r,v*y,_>2?y:0,y,y),u.setRenderTarget(r),m&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=d,u.autoClear=h,e.background=g}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===tl||e.mapping===nl;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=MO()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=wO());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Ke(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;$_(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(o,bS)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,bO[(r-1)%bO.length])}t.autoClear=n}_blur(e,t,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const h=new Ke(this._lodPlanes[r],c),d=c.uniforms,f=this._sizeLods[n]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,m=s/p,g=isFinite(s)?1+Math.floor(3*m):20;g>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const _=[];let v=0;for(let T=0;T<20;++T){const x=T/m,E=Math.exp(-x*x/2);_.push(E),0===T?v+=E:T<g&&(v+=2*E)}for(let T=0;T<_.length;T++)_[T]=_[T]/v;d.envMap.value=e.texture,d.samples.value=g,d.weights.value=_,d.latitudinal.value="latitudinal"===o,a&&(d.poleAxis.value=a);const{_lodMax:y}=this;d.dTheta.value=p,d.mipInt.value=y-n;const b=this._sizeLods[r];$_(t,3*b*(r>y-4?r-y+4:0),4*(this._cubeSize-b),3*b,2*b),l.setRenderTarget(t),l.render(h,bS)}}function xO(i,e,t){const n=new Wn(i,e,t);return n.texture.mapping=rh,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function $_(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function wO(){return new Zn({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:ao,depthTest:!1,depthWrite:!1})}function MO(){return new Zn({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:ao,depthTest:!1,depthWrite:!1})}function yJ(i){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function n(a){if(a&&a.isTexture){const l=a.mapping,c=l===Bf||l===Uf,u=l===tl||l===nl;if(c||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let h=e.get(a);return null===t&&(t=new wS(i)),h=c?t.fromEquirectangular(a,h):t.fromCubemap(a,h),e.set(a,h),h.texture}if(e.has(a))return e.get(a).texture;{const h=a.image;if(c&&h&&h.height>0||u&&h&&function r(a){let l=0;for(let u=0;u<6;u++)void 0!==a[u]&&l++;return 6===l}(h)){null===t&&(t=new wS(i));const d=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function bJ(i){const e={};function t(n){if(void 0!==e[n])return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return{has:function(n){return null!==t(n)},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const r=t(n);return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function xJ(i,e,t,n){const r={},s=new WeakMap;function o(h){const d=h.target;null!==d.index&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",o),delete r[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),n.releaseStatesOfGeometry(d),!0===d.isInstancedBufferGeometry&&delete d._maxInstanceCount,t.memory.geometries--}function c(h){const d=[],f=h.index,p=h.attributes.position;let m=0;if(null!==f){const v=f.array;m=f.version;for(let y=0,b=v.length;y<b;y+=3){const w=v[y+0],M=v[y+1],T=v[y+2];d.push(w,M,M,T,T,w)}}else{m=p.version;for(let y=0,b=p.array.length/3-1;y<b;y+=3){const w=y+0,M=y+1,T=y+2;d.push(w,M,M,T,T,w)}}const g=new(nO(d)?j_:dS)(d,1);g.version=m;const _=s.get(h);_&&e.remove(_),s.set(h,g)}return{get:function a(h,d){return!0===r[d.id]||(d.addEventListener("dispose",o),r[d.id]=!0,t.memory.geometries++),d},update:function l(h){const d=h.attributes;for(const p in d)e.update(d[p],34962);const f=h.morphAttributes;for(const p in f){const m=f[p];for(let g=0,_=m.length;g<_;g++)e.update(m[g],34962)}},getWireframeAttribute:function u(h){const d=s.get(h);if(d){const f=h.index;null!==f&&d.version<f.version&&c(h)}else c(h);return s.get(h)}}}function wJ(i,e,t,n){const r=n.isWebGL2;let s,a,l;this.setMode=function o(d){s=d},this.setIndex=function c(d){a=d.type,l=d.bytesPerElement},this.render=function u(d,f){i.drawElements(s,f,a,d*l),t.update(f,s,1)},this.renderInstances=function h(d,f,p){if(0===p)return;let m,g;if(r)m=i,g="drawElementsInstanced";else if(m=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",null===m)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");m[g](s,f,a,d*l,p),t.update(f,s,p)}}function MJ(i){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function n(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function SJ(i,e){return i[0]-e[0]}function TJ(i,e){return Math.abs(e[1])-Math.abs(i[1])}function SS(i,e){let t=1;const n=e.isInterleavedBufferAttribute?e.data.array:e.array;n instanceof Int8Array?t=127:n instanceof Uint8Array?t=255:n instanceof Uint16Array?t=65535:n instanceof Int16Array?t=32767:n instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",n),i.divideScalar(t)}function CJ(i,e,t){const n={},r=new Float32Array(8),s=new WeakMap,o=new dn,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,u,h,d){const f=c.morphTargetInfluences;if(!0===e.isWebGL2){const p=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,m=void 0!==p?p.length:0;let g=s.get(u);if(void 0===g||g.count!==m){let X=function(){H.dispose(),s.delete(u),u.removeEventListener("dispose",X)};void 0!==g&&g.texture.dispose();const y=void 0!==u.morphAttributes.position,b=void 0!==u.morphAttributes.normal,w=void 0!==u.morphAttributes.color,M=u.morphAttributes.position||[],T=u.morphAttributes.normal||[],x=u.morphAttributes.color||[];let E=0;!0===y&&(E=1),!0===b&&(E=2),!0===w&&(E=3);let D=u.attributes.position.count*E,L=1;D>e.maxTextureSize&&(L=Math.ceil(D/e.maxTextureSize),D=e.maxTextureSize);const z=new Float32Array(D*L*4*m),H=new Xf(z,D,L,m);H.type=Wr,H.needsUpdate=!0;const U=4*E;for(let I=0;I<m;I++){const V=M[I],W=T[I],j=x[I],q=D*L*4*I;for(let oe=0;oe<V.count;oe++){const J=oe*U;!0===y&&(o.fromBufferAttribute(V,oe),!0===V.normalized&&SS(o,V),z[q+J+0]=o.x,z[q+J+1]=o.y,z[q+J+2]=o.z,z[q+J+3]=0),!0===b&&(o.fromBufferAttribute(W,oe),!0===W.normalized&&SS(o,W),z[q+J+4]=o.x,z[q+J+5]=o.y,z[q+J+6]=o.z,z[q+J+7]=0),!0===w&&(o.fromBufferAttribute(j,oe),!0===j.normalized&&SS(o,j),z[q+J+8]=o.x,z[q+J+9]=o.y,z[q+J+10]=o.z,z[q+J+11]=4===j.itemSize?o.w:1)}}g={count:m,texture:H,size:new te(D,L)},s.set(u,g),u.addEventListener("dispose",X)}let _=0;for(let y=0;y<f.length;y++)_+=f[y];const v=u.morphTargetsRelative?1:1-_;d.getUniforms().setValue(i,"morphTargetBaseInfluence",v),d.getUniforms().setValue(i,"morphTargetInfluences",f),d.getUniforms().setValue(i,"morphTargetsTexture",g.texture,t),d.getUniforms().setValue(i,"morphTargetsTextureSize",g.size)}else{const p=void 0===f?0:f.length;let m=n[u.id];if(void 0===m||m.length!==p){m=[];for(let b=0;b<p;b++)m[b]=[b,0];n[u.id]=m}for(let b=0;b<p;b++){const w=m[b];w[0]=b,w[1]=f[b]}m.sort(TJ);for(let b=0;b<8;b++)b<p&&m[b][1]?(a[b][0]=m[b][0],a[b][1]=m[b][1]):(a[b][0]=Number.MAX_SAFE_INTEGER,a[b][1]=0);a.sort(SJ);const g=u.morphAttributes.position,_=u.morphAttributes.normal;let v=0;for(let b=0;b<8;b++){const w=a[b],M=w[0],T=w[1];M!==Number.MAX_SAFE_INTEGER&&T?(g&&u.getAttribute("morphTarget"+b)!==g[M]&&u.setAttribute("morphTarget"+b,g[M]),_&&u.getAttribute("morphNormal"+b)!==_[M]&&u.setAttribute("morphNormal"+b,_[M]),r[b]=T,v+=T):(g&&!0===u.hasAttribute("morphTarget"+b)&&u.deleteAttribute("morphTarget"+b),_&&!0===u.hasAttribute("morphNormal"+b)&&u.deleteAttribute("morphNormal"+b),r[b]=0)}const y=u.morphTargetsRelative?1:1-v;d.getUniforms().setValue(i,"morphTargetBaseInfluence",y),d.getUniforms().setValue(i,"morphTargetInfluences",r)}}}}function EJ(i,e,t,n){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=n.render.frame,h=e.get(l,l.geometry);return r.get(h)!==c&&(e.update(h),r.set(h,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),null!==l.instanceColor&&t.update(l.instanceColor,34962)),h},dispose:function o(){r=new WeakMap}}}const SO=new mr,TO=new Xf,CO=new P_,EO=new $f,RO=[],AO=[],DO=new Float32Array(16),PO=new Float32Array(9),IO=new Float32Array(4);function Ch(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=RO[r];if(void 0===s&&(s=new Float32Array(r),RO[r]=s),0!==e){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,i[o].toArray(s,a)}return s}function Dr(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function Pr(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function J_(i,e){let t=AO[e];void 0===t&&(t=new Int32Array(e),AO[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function RJ(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function AJ(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Dr(t,e))return;i.uniform2fv(this.addr,e),Pr(t,e)}}function DJ(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Dr(t,e))return;i.uniform3fv(this.addr,e),Pr(t,e)}}function PJ(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Dr(t,e))return;i.uniform4fv(this.addr,e),Pr(t,e)}}function IJ(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(Dr(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),Pr(t,e)}else{if(Dr(t,n))return;IO.set(n),i.uniformMatrix2fv(this.addr,!1,IO),Pr(t,n)}}function FJ(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(Dr(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),Pr(t,e)}else{if(Dr(t,n))return;PO.set(n),i.uniformMatrix3fv(this.addr,!1,PO),Pr(t,n)}}function LJ(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(Dr(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),Pr(t,e)}else{if(Dr(t,n))return;DO.set(n),i.uniformMatrix4fv(this.addr,!1,DO),Pr(t,n)}}function OJ(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function kJ(i,e){const t=this.cache;Dr(t,e)||(i.uniform2iv(this.addr,e),Pr(t,e))}function NJ(i,e){const t=this.cache;Dr(t,e)||(i.uniform3iv(this.addr,e),Pr(t,e))}function BJ(i,e){const t=this.cache;Dr(t,e)||(i.uniform4iv(this.addr,e),Pr(t,e))}function UJ(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function VJ(i,e){const t=this.cache;Dr(t,e)||(i.uniform2uiv(this.addr,e),Pr(t,e))}function jJ(i,e){const t=this.cache;Dr(t,e)||(i.uniform3uiv(this.addr,e),Pr(t,e))}function zJ(i,e){const t=this.cache;Dr(t,e)||(i.uniform4uiv(this.addr,e),Pr(t,e))}function HJ(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2D(e||SO,r)}function GJ(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||CO,r)}function WJ(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||EO,r)}function XJ(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||TO,r)}function qJ(i,e){i.uniform1fv(this.addr,e)}function ZJ(i,e){const t=Ch(e,this.size,2);i.uniform2fv(this.addr,t)}function YJ(i,e){const t=Ch(e,this.size,3);i.uniform3fv(this.addr,t)}function QJ(i,e){const t=Ch(e,this.size,4);i.uniform4fv(this.addr,t)}function $J(i,e){const t=Ch(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function JJ(i,e){const t=Ch(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function eee(i,e){const t=Ch(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function tee(i,e){i.uniform1iv(this.addr,e)}function nee(i,e){i.uniform2iv(this.addr,e)}function iee(i,e){i.uniform3iv(this.addr,e)}function ree(i,e){i.uniform4iv(this.addr,e)}function see(i,e){i.uniform1uiv(this.addr,e)}function oee(i,e){i.uniform2uiv(this.addr,e)}function aee(i,e){i.uniform3uiv(this.addr,e)}function lee(i,e){i.uniform4uiv(this.addr,e)}function cee(i,e,t){const n=e.length,r=J_(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTexture2D(e[s]||SO,r[s])}function uee(i,e,t){const n=e.length,r=J_(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTexture3D(e[s]||CO,r[s])}function hee(i,e,t){const n=e.length,r=J_(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTextureCube(e[s]||EO,r[s])}function dee(i,e,t){const n=e.length,r=J_(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTexture2DArray(e[s]||TO,r[s])}class pee{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function KJ(i){switch(i){case 5126:return RJ;case 35664:return AJ;case 35665:return DJ;case 35666:return PJ;case 35674:return IJ;case 35675:return FJ;case 35676:return LJ;case 5124:case 35670:return OJ;case 35667:case 35671:return kJ;case 35668:case 35672:return NJ;case 35669:case 35673:return BJ;case 5125:return UJ;case 36294:return VJ;case 36295:return jJ;case 36296:return zJ;case 35678:case 36198:case 36298:case 36306:case 35682:return HJ;case 35679:case 36299:case 36307:return GJ;case 35680:case 36300:case 36308:case 36293:return WJ;case 36289:case 36303:case 36311:case 36292:return XJ}}(t.type)}}class mee{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function fee(i){switch(i){case 5126:return qJ;case 35664:return ZJ;case 35665:return YJ;case 35666:return QJ;case 35674:return $J;case 35675:return JJ;case 35676:return eee;case 5124:case 35670:return tee;case 35667:case 35671:return nee;case 35668:case 35672:return iee;case 35669:case 35673:return ree;case 5125:return see;case 36294:return oee;case 36295:return aee;case 36296:return lee;case 35678:case 36198:case 36298:case 36306:case 35682:return cee;case 35679:case 36299:case 36307:return uee;case 35680:case 36300:case 36308:case 36293:return hee;case 36289:case 36303:case 36311:case 36292:return dee}}(t.type)}}class gee{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],n)}}}const TS=/(\w+)(\])?(\[|\.)?/g;function FO(i,e){i.seq.push(e),i.map[e.id]=e}function _ee(i,e,t){const n=i.name,r=n.length;for(TS.lastIndex=0;;){const s=TS.exec(n),o=TS.lastIndex;let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&o+2===r){FO(t,void 0===c?new pee(a,i,e):new mee(a,i,e));break}{let h=t.map[a];void 0===h&&(h=new gee(a),FO(t,h)),t=h}}}class ev{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,35718);for(let r=0;r<n;++r){const s=e.getActiveUniform(t,r);_ee(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,n,r){const s=this.map[t];void 0!==s&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=n[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&n.push(o)}return n}}function LO(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}let vee=0;function OO(i,e,t){const n=i.getShaderParameter(e,35713),r=i.getShaderInfoLog(e).trim();if(n&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function yee(i,e){const t=i.split("\n"),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;n.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return n.join("\n")}(i.getShaderSource(e),o)}return r}function xee(i,e){const t=function bee(i){switch(i){case ol:return["Linear","( value )"];case hn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}(e);return"vec4 "+i+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function wee(i,e){let t;switch(e){case PL:t="Linear";break;case IL:t="Reinhard";break;case FL:t="OptimizedCineon";break;case LL:t="ACESFilmic";break;case OL:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Jf(i){return""!==i}function kO(i,e){return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function NO(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Cee=/^[ \t]*#include +<([\w\d./]+)>/gm;function CS(i){return i.replace(Cee,Eee)}function Eee(i,e){const t=$t[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return CS(t)}const Ree=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Aee=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function BO(i){return i.replace(Aee,UO).replace(Ree,Dee)}function Dee(i,e,t,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),UO(0,e,t,n)}function UO(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function VO(i){let e="precision "+i.precision+" float;\nprecision "+i.precision+" int;";return"highp"===i.precision?e+="\n#define HIGH_PRECISION":"mediump"===i.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===i.precision&&(e+="\n#define LOW_PRECISION"),e}function kee(i,e,t,n){const r=i.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function Pee(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===pM?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===lL?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===nh&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function Iee(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case tl:case nl:e="ENVMAP_TYPE_CUBE";break;case rh:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function Fee(i){let e="ENVMAP_MODE_REFLECTION";return i.envMap&&i.envMapMode===nl&&(e="ENVMAP_MODE_REFRACTION"),e}(t),h=function Lee(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case Nf:e="ENVMAP_BLENDING_MULTIPLY";break;case AL:e="ENVMAP_BLENDING_MIX";break;case DL:e="ENVMAP_BLENDING_ADD"}return e}(t),d=function Oee(i){const e=i.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}(t),f=t.isWebGL2?"":function Mee(i){return[i.extensionDerivatives||i.envMapCubeUVHeight||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||"physical"===i.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Jf).join("\n")}(t),p=function See(i){const e=[];for(const t in i){const n=i[t];!1!==n&&e.push("#define "+t+" "+n)}return e.join("\n")}(s),m=r.createProgram();let g,_,v=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(g=[p].filter(Jf).join("\n"),g.length>0&&(g+="\n"),_=[f,p].filter(Jf).join("\n"),_.length>0&&(_+="\n")):(g=[VO(t),"#define SHADER_NAME "+t.shaderName,p,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Jf).join("\n"),_=[f,VO(t),"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==jo?"#define TONE_MAPPING":"",t.toneMapping!==jo?$t.tonemapping_pars_fragment:"",t.toneMapping!==jo?wee("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",$t.encodings_pars_fragment,xee("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Jf).join("\n")),o=CS(o),o=kO(o,t),o=NO(o,t),a=CS(a),a=kO(a,t),a=NO(a,t),o=BO(o),a=BO(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(v="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,_=["#define varying in",t.glslVersion===qM?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===qM?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+_);const b=v+_+a,w=LO(r,35633,v+g+o),M=LO(r,35632,b);if(r.attachShader(m,w),r.attachShader(m,M),void 0!==t.index0AttributeName?r.bindAttribLocation(m,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),i.debug.checkShaderErrors){const E=r.getProgramInfoLog(m).trim(),D=r.getShaderInfoLog(w).trim(),L=r.getShaderInfoLog(M).trim();let z=!0,H=!0;if(!1===r.getProgramParameter(m,35714)){z=!1;const U=OO(r,w,"vertex"),X=OO(r,M,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,35715)+"\n\nProgram Info Log: "+E+"\n"+U+"\n"+X)}else""!==E?console.warn("THREE.WebGLProgram: Program Info Log:",E):(""===D||""===L)&&(H=!1);H&&(this.diagnostics={runnable:z,programLog:E,vertexShader:{log:D,prefix:g},fragmentShader:{log:L,prefix:_}})}let T,x;return r.deleteShader(w),r.deleteShader(M),this.getUniforms=function(){return void 0===T&&(T=new ev(r,m)),T},this.getAttributes=function(){return void 0===x&&(x=function Tee(i,e){const t={},n=i.getProgramParameter(e,35721);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),o=s.name;let a=1;35674===s.type&&(a=2),35675===s.type&&(a=3),35676===s.type&&(a=4),t[o]={type:s.type,location:i.getAttribLocation(e,o),locationSize:a}}return t}(r,m)),x},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.name=t.shaderName,this.id=vee++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=w,this.fragmentShader=M,this}let Nee=0;class Bee{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const n=new Uee(e);t.set(e,n)}return t.get(e)}}class Uee{constructor(e){this.id=Nee++,this.code=e,this.usedTimes=0}}function Vee(i,e,t,n,r,s,o){const a=new B_,l=new Bee,c=[],u=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function m(x,E,D,L,z){const H=L.fog,U=z.geometry,I=(x.isMeshStandardMaterial?t:e).get(x.envMap||(x.isMeshStandardMaterial?L.environment:null)),V=I&&I.mapping===rh?I.image.height:null,W=p[x.type];null!==x.precision&&(f=r.getMaxPrecision(x.precision),f!==x.precision&&console.warn("THREE.WebGLProgram.getParameters:",x.precision,"not supported, using",f,"instead."));const j=U.morphAttributes.position||U.morphAttributes.normal||U.morphAttributes.color,q=void 0!==j?j.length:0;let J,fe,he,Re,oe=0;if(void 0!==U.morphAttributes.position&&(oe=1),void 0!==U.morphAttributes.normal&&(oe=2),void 0!==U.morphAttributes.color&&(oe=3),W){const ot=fo[W];J=ot.vertexShader,fe=ot.fragmentShader}else J=x.vertexShader,fe=x.fragmentShader,l.update(x),he=l.getVertexShaderID(x),Re=l.getFragmentShaderID(x);const $=i.getRenderTarget(),pe=x.clearcoat>0,Fe=x.iridescence>0;return{isWebGL2:u,shaderID:W,shaderName:x.type,vertexShader:J,fragmentShader:fe,defines:x.defines,customVertexShaderID:he,customFragmentShaderID:Re,isRawShaderMaterial:!0===x.isRawShaderMaterial,glslVersion:x.glslVersion,precision:f,instancing:!0===z.isInstancedMesh,instancingColor:!0===z.isInstancedMesh&&null!==z.instanceColor,supportsVertexTextures:d,outputEncoding:null===$?i.outputEncoding:!0===$.isXRRenderTarget?$.texture.encoding:ol,map:!!x.map,matcap:!!x.matcap,envMap:!!I,envMapMode:I&&I.mapping,envMapCubeUVHeight:V,lightMap:!!x.lightMap,aoMap:!!x.aoMap,emissiveMap:!!x.emissiveMap,bumpMap:!!x.bumpMap,normalMap:!!x.normalMap,objectSpaceNormalMap:x.normalMapType===$L,tangentSpaceNormalMap:x.normalMapType===al,decodeVideoTexture:!!x.map&&!0===x.map.isVideoTexture&&x.map.encoding===hn,clearcoat:pe,clearcoatMap:pe&&!!x.clearcoatMap,clearcoatRoughnessMap:pe&&!!x.clearcoatRoughnessMap,clearcoatNormalMap:pe&&!!x.clearcoatNormalMap,iridescence:Fe,iridescenceMap:Fe&&!!x.iridescenceMap,iridescenceThicknessMap:Fe&&!!x.iridescenceThicknessMap,displacementMap:!!x.displacementMap,roughnessMap:!!x.roughnessMap,metalnessMap:!!x.metalnessMap,specularMap:!!x.specularMap,specularIntensityMap:!!x.specularIntensityMap,specularColorMap:!!x.specularColorMap,opaque:!1===x.transparent&&x.blending===fc,alphaMap:!!x.alphaMap,alphaTest:x.alphaTest>0,gradientMap:!!x.gradientMap,sheen:x.sheen>0,sheenColorMap:!!x.sheenColorMap,sheenRoughnessMap:!!x.sheenRoughnessMap,transmission:x.transmission>0,transmissionMap:!!x.transmissionMap,thicknessMap:!!x.thicknessMap,combine:x.combine,vertexTangents:!!x.normalMap&&!!U.attributes.tangent,vertexColors:x.vertexColors,vertexAlphas:!0===x.vertexColors&&!!U.attributes.color&&4===U.attributes.color.itemSize,vertexUvs:!!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatMap||x.clearcoatRoughnessMap||x.clearcoatNormalMap||x.iridescenceMap||x.iridescenceThicknessMap||x.displacementMap||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheenColorMap||x.sheenRoughnessMap),uvsVertexOnly:!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatNormalMap||x.iridescenceMap||x.iridescenceThicknessMap||x.transmission>0||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheen>0||x.sheenColorMap||x.sheenRoughnessMap||!x.displacementMap),fog:!!H,useFog:!0===x.fog,fogExp2:H&&H.isFogExp2,flatShading:!!x.flatShading,sizeAttenuation:x.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===z.isSkinnedMesh,morphTargets:void 0!==U.morphAttributes.position,morphNormals:void 0!==U.morphAttributes.normal,morphColors:void 0!==U.morphAttributes.color,morphTargetsCount:q,morphTextureStride:oe,numDirLights:E.directional.length,numPointLights:E.point.length,numSpotLights:E.spot.length,numRectAreaLights:E.rectArea.length,numHemiLights:E.hemi.length,numDirLightShadows:E.directionalShadowMap.length,numPointLightShadows:E.pointShadowMap.length,numSpotLightShadows:E.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:x.dithering,shadowMapEnabled:i.shadowMap.enabled&&D.length>0,shadowMapType:i.shadowMap.type,toneMapping:x.toneMapped?i.toneMapping:jo,physicallyCorrectLights:i.physicallyCorrectLights,premultipliedAlpha:x.premultipliedAlpha,doubleSided:x.side===oo,flipSided:x.side===as,useDepthPacking:!!x.depthPacking,depthPacking:x.depthPacking||0,index0AttributeName:x.index0AttributeName,extensionDerivatives:x.extensions&&x.extensions.derivatives,extensionFragDepth:x.extensions&&x.extensions.fragDepth,extensionDrawBuffers:x.extensions&&x.extensions.drawBuffers,extensionShaderTextureLOD:x.extensions&&x.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||n.has("EXT_shader_texture_lod"),customProgramCacheKey:x.customProgramCacheKey()}},getProgramCacheKey:function g(x){const E=[];if(x.shaderID?E.push(x.shaderID):(E.push(x.customVertexShaderID),E.push(x.customFragmentShaderID)),void 0!==x.defines)for(const D in x.defines)E.push(D),E.push(x.defines[D]);return!1===x.isRawShaderMaterial&&(function _(x,E){x.push(E.precision),x.push(E.outputEncoding),x.push(E.envMapMode),x.push(E.envMapCubeUVHeight),x.push(E.combine),x.push(E.vertexUvs),x.push(E.fogExp2),x.push(E.sizeAttenuation),x.push(E.morphTargetsCount),x.push(E.morphAttributeCount),x.push(E.numDirLights),x.push(E.numPointLights),x.push(E.numSpotLights),x.push(E.numHemiLights),x.push(E.numRectAreaLights),x.push(E.numDirLightShadows),x.push(E.numPointLightShadows),x.push(E.numSpotLightShadows),x.push(E.shadowMapType),x.push(E.toneMapping),x.push(E.numClippingPlanes),x.push(E.numClipIntersection),x.push(E.depthPacking)}(E,x),function v(x,E){a.disableAll(),E.isWebGL2&&a.enable(0),E.supportsVertexTextures&&a.enable(1),E.instancing&&a.enable(2),E.instancingColor&&a.enable(3),E.map&&a.enable(4),E.matcap&&a.enable(5),E.envMap&&a.enable(6),E.lightMap&&a.enable(7),E.aoMap&&a.enable(8),E.emissiveMap&&a.enable(9),E.bumpMap&&a.enable(10),E.normalMap&&a.enable(11),E.objectSpaceNormalMap&&a.enable(12),E.tangentSpaceNormalMap&&a.enable(13),E.clearcoat&&a.enable(14),E.clearcoatMap&&a.enable(15),E.clearcoatRoughnessMap&&a.enable(16),E.clearcoatNormalMap&&a.enable(17),E.iridescence&&a.enable(18),E.iridescenceMap&&a.enable(19),E.iridescenceThicknessMap&&a.enable(20),E.displacementMap&&a.enable(21),E.specularMap&&a.enable(22),E.roughnessMap&&a.enable(23),E.metalnessMap&&a.enable(24),E.gradientMap&&a.enable(25),E.alphaMap&&a.enable(26),E.alphaTest&&a.enable(27),E.vertexColors&&a.enable(28),E.vertexAlphas&&a.enable(29),E.vertexUvs&&a.enable(30),E.vertexTangents&&a.enable(31),E.uvsVertexOnly&&a.enable(32),E.fog&&a.enable(33),x.push(a.mask),a.disableAll(),E.useFog&&a.enable(0),E.flatShading&&a.enable(1),E.logarithmicDepthBuffer&&a.enable(2),E.skinning&&a.enable(3),E.morphTargets&&a.enable(4),E.morphNormals&&a.enable(5),E.morphColors&&a.enable(6),E.premultipliedAlpha&&a.enable(7),E.shadowMapEnabled&&a.enable(8),E.physicallyCorrectLights&&a.enable(9),E.doubleSided&&a.enable(10),E.flipSided&&a.enable(11),E.useDepthPacking&&a.enable(12),E.dithering&&a.enable(13),E.specularIntensityMap&&a.enable(14),E.specularColorMap&&a.enable(15),E.transmission&&a.enable(16),E.transmissionMap&&a.enable(17),E.thicknessMap&&a.enable(18),E.sheen&&a.enable(19),E.sheenColorMap&&a.enable(20),E.sheenRoughnessMap&&a.enable(21),E.decodeVideoTexture&&a.enable(22),E.opaque&&a.enable(23),x.push(a.mask)}(E,x),E.push(i.outputEncoding)),E.push(x.customProgramCacheKey),E.join()},getUniforms:function y(x){const E=p[x.type];let D;return D=E?Go.clone(fo[E].uniforms):x.uniforms,D},acquireProgram:function b(x,E){let D;for(let L=0,z=c.length;L<z;L++){const H=c[L];if(H.cacheKey===E){D=H,++D.usedTimes;break}}return void 0===D&&(D=new kee(i,E,x,s),c.push(D)),D},releaseProgram:function w(x){if(0==--x.usedTimes){const E=c.indexOf(x);c[E]=c[c.length-1],c.pop(),x.destroy()}},releaseShaderCache:function M(x){l.remove(x)},programs:c,dispose:function T(){l.dispose()}}}function jee(){let i=new WeakMap;return{get:function e(s){let o=i.get(s);return void 0===o&&(o={},i.set(s,o)),o},remove:function t(s){i.delete(s)},update:function n(s,o,a){i.get(s)[o]=a},dispose:function r(){i=new WeakMap}}}function zee(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function jO(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function zO(){const i=[];let e=0;const t=[],n=[],r=[];function o(h,d,f,p,m,g){let _=i[e];return void 0===_?(_={id:h.id,object:h,geometry:d,material:f,groupOrder:p,renderOrder:h.renderOrder,z:m,group:g},i[e]=_):(_.id=h.id,_.object=h,_.geometry=d,_.material=f,_.groupOrder=p,_.renderOrder=h.renderOrder,_.z=m,_.group=g),e++,_}return{opaque:t,transmissive:n,transparent:r,init:function s(){e=0,t.length=0,n.length=0,r.length=0},push:function a(h,d,f,p,m,g){const _=o(h,d,f,p,m,g);f.transmission>0?n.push(_):!0===f.transparent?r.push(_):t.push(_)},unshift:function l(h,d,f,p,m,g){const _=o(h,d,f,p,m,g);f.transmission>0?n.unshift(_):!0===f.transparent?r.unshift(_):t.unshift(_)},finish:function u(){for(let h=e,d=i.length;h<d;h++){const f=i[h];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function c(h,d){t.length>1&&t.sort(h||zee),n.length>1&&n.sort(d||jO),r.length>1&&r.sort(d||jO)}}}function Hee(){let i=new WeakMap;return{get:function e(n,r){let s;return!1===i.has(n)?(s=new zO,i.set(n,[s])):r>=i.get(n).length?(s=new zO,i.get(n).push(s)):s=i.get(n)[r],s},dispose:function t(){i=new WeakMap}}}function Gee(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new C,color:new Ce};break;case"SpotLight":t={position:new C,direction:new C,color:new Ce,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new C,color:new Ce,distance:0,decay:0};break;case"HemisphereLight":t={direction:new C,skyColor:new Ce,groundColor:new Ce};break;case"RectAreaLight":t={color:new Ce,position:new C,halfWidth:new C,halfHeight:new C}}return i[e.id]=t,t}}}let Xee=0;function Kee(i,e){return(e.castShadow?1:0)-(i.castShadow?1:0)}function qee(i,e){const t=new Gee,n=function Wee(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new te};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new te,shadowCameraNear:1,shadowCameraFar:1e3}}return i[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let u=0;u<9;u++)r.probe.push(new C);const s=new C,o=new st,a=new st;return{setup:function l(u,h){let d=0,f=0,p=0;for(let E=0;E<9;E++)r.probe[E].set(0,0,0);let m=0,g=0,_=0,v=0,y=0,b=0,w=0,M=0;u.sort(Kee);const T=!0!==h?Math.PI:1;for(let E=0,D=u.length;E<D;E++){const L=u[E],z=L.color,H=L.intensity,U=L.distance,X=L.shadow&&L.shadow.map?L.shadow.map.texture:null;if(L.isAmbientLight)d+=z.r*H*T,f+=z.g*H*T,p+=z.b*H*T;else if(L.isLightProbe)for(let I=0;I<9;I++)r.probe[I].addScaledVector(L.sh.coefficients[I],H);else if(L.isDirectionalLight){const I=t.get(L);if(I.color.copy(L.color).multiplyScalar(L.intensity*T),L.castShadow){const V=L.shadow,W=n.get(L);W.shadowBias=V.bias,W.shadowNormalBias=V.normalBias,W.shadowRadius=V.radius,W.shadowMapSize=V.mapSize,r.directionalShadow[m]=W,r.directionalShadowMap[m]=X,r.directionalShadowMatrix[m]=L.shadow.matrix,b++}r.directional[m]=I,m++}else if(L.isSpotLight){const I=t.get(L);if(I.position.setFromMatrixPosition(L.matrixWorld),I.color.copy(z).multiplyScalar(H*T),I.distance=U,I.coneCos=Math.cos(L.angle),I.penumbraCos=Math.cos(L.angle*(1-L.penumbra)),I.decay=L.decay,L.castShadow){const V=L.shadow,W=n.get(L);W.shadowBias=V.bias,W.shadowNormalBias=V.normalBias,W.shadowRadius=V.radius,W.shadowMapSize=V.mapSize,r.spotShadow[_]=W,r.spotShadowMap[_]=X,r.spotShadowMatrix[_]=L.shadow.matrix,M++}r.spot[_]=I,_++}else if(L.isRectAreaLight){const I=t.get(L);I.color.copy(z).multiplyScalar(H),I.halfWidth.set(.5*L.width,0,0),I.halfHeight.set(0,.5*L.height,0),r.rectArea[v]=I,v++}else if(L.isPointLight){const I=t.get(L);if(I.color.copy(L.color).multiplyScalar(L.intensity*T),I.distance=L.distance,I.decay=L.decay,L.castShadow){const V=L.shadow,W=n.get(L);W.shadowBias=V.bias,W.shadowNormalBias=V.normalBias,W.shadowRadius=V.radius,W.shadowMapSize=V.mapSize,W.shadowCameraNear=V.camera.near,W.shadowCameraFar=V.camera.far,r.pointShadow[g]=W,r.pointShadowMap[g]=X,r.pointShadowMatrix[g]=L.shadow.matrix,w++}r.point[g]=I,g++}else if(L.isHemisphereLight){const I=t.get(L);I.skyColor.copy(L.color).multiplyScalar(H*T),I.groundColor.copy(L.groundColor).multiplyScalar(H*T),r.hemi[y]=I,y++}}v>0&&(e.isWebGL2||!0===i.has("OES_texture_float_linear")?(r.rectAreaLTC1=Qe.LTC_FLOAT_1,r.rectAreaLTC2=Qe.LTC_FLOAT_2):!0===i.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Qe.LTC_HALF_1,r.rectAreaLTC2=Qe.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;const x=r.hash;(x.directionalLength!==m||x.pointLength!==g||x.spotLength!==_||x.rectAreaLength!==v||x.hemiLength!==y||x.numDirectionalShadows!==b||x.numPointShadows!==w||x.numSpotShadows!==M)&&(r.directional.length=m,r.spot.length=_,r.rectArea.length=v,r.point.length=g,r.hemi.length=y,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=w,r.pointShadowMap.length=w,r.spotShadow.length=M,r.spotShadowMap.length=M,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=w,r.spotShadowMatrix.length=M,x.directionalLength=m,x.pointLength=g,x.spotLength=_,x.rectAreaLength=v,x.hemiLength=y,x.numDirectionalShadows=b,x.numPointShadows=w,x.numSpotShadows=M,r.version=Xee++)},setupView:function c(u,h){let d=0,f=0,p=0,m=0,g=0;const _=h.matrixWorldInverse;for(let v=0,y=u.length;v<y;v++){const b=u[v];if(b.isDirectionalLight){const w=r.directional[d];w.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(_),d++}else if(b.isSpotLight){const w=r.spot[p];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(_),w.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(_),p++}else if(b.isRectAreaLight){const w=r.rectArea[m];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(_),a.identity(),o.copy(b.matrixWorld),o.premultiply(_),a.extractRotation(o),w.halfWidth.set(.5*b.width,0,0),w.halfHeight.set(0,.5*b.height,0),w.halfWidth.applyMatrix4(a),w.halfHeight.applyMatrix4(a),m++}else if(b.isPointLight){const w=r.point[f];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(_),f++}else if(b.isHemisphereLight){const w=r.hemi[g];w.direction.setFromMatrixPosition(b.matrixWorld),w.direction.transformDirection(_),g++}}},state:r}}function HO(i,e){const t=new qee(i,e),n=[],r=[];return{init:function s(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:t},setupLights:function l(h){t.setup(n,h)},setupLightsView:function c(h){t.setupView(n,h)},pushLight:function o(h){n.push(h)},pushShadow:function a(h){r.push(h)}}}function Zee(i,e){let t=new WeakMap;return{get:function n(s,o=0){let a;return!1===t.has(s)?(a=new HO(i,e),t.set(s,[a])):o>=t.get(s).length?(a=new HO(i,e),t.get(s).push(a)):a=t.get(s)[o],a},dispose:function r(){t=new WeakMap}}}class tv extends Ai{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=QL,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class ES extends Ai{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new C,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function $ee(i,e,t){let n=new Q_;const r=new te,s=new te,o=new dn,a=new tv({depthPacking:KM}),l=new ES,c={},u=t.maxTextureSize,h={0:as,1:el,2:oo},d=new Zn({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new te},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new wt;p.setAttribute("position",new En(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new Ke(p,d),g=this;function _(b,w){const M=e.update(m);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,f.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),null===b.mapPass&&(b.mapPass=new Wn(r.x,r.y)),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,i.setRenderTarget(b.mapPass),i.clear(),i.renderBufferDirect(w,null,M,d,m,null),f.uniforms.shadow_pass.value=b.mapPass.texture,f.uniforms.resolution.value=b.mapSize,f.uniforms.radius.value=b.radius,i.setRenderTarget(b.map),i.clear(),i.renderBufferDirect(w,null,M,f,m,null)}function v(b,w,M,T,x,E){let D=null;const L=!0===M.isPointLight?b.customDistanceMaterial:b.customDepthMaterial;if(D=void 0!==L?L:!0===M.isPointLight?l:a,i.localClippingEnabled&&!0===w.clipShadows&&Array.isArray(w.clippingPlanes)&&0!==w.clippingPlanes.length||w.displacementMap&&0!==w.displacementScale||w.alphaMap&&w.alphaTest>0){const z=D.uuid,H=w.uuid;let U=c[z];void 0===U&&(U={},c[z]=U);let X=U[H];void 0===X&&(X=D.clone(),U[H]=X),D=X}return D.visible=w.visible,D.wireframe=w.wireframe,D.side=E===nh?null!==w.shadowSide?w.shadowSide:w.side:null!==w.shadowSide?w.shadowSide:h[w.side],D.alphaMap=w.alphaMap,D.alphaTest=w.alphaTest,D.clipShadows=w.clipShadows,D.clippingPlanes=w.clippingPlanes,D.clipIntersection=w.clipIntersection,D.displacementMap=w.displacementMap,D.displacementScale=w.displacementScale,D.displacementBias=w.displacementBias,D.wireframeLinewidth=w.wireframeLinewidth,D.linewidth=w.linewidth,!0===M.isPointLight&&!0===D.isMeshDistanceMaterial&&(D.referencePosition.setFromMatrixPosition(M.matrixWorld),D.nearDistance=T,D.farDistance=x),D}function y(b,w,M,T,x){if(!1===b.visible)return;if(b.layers.test(w.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&x===nh)&&(!b.frustumCulled||n.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(M.matrixWorldInverse,b.matrixWorld);const L=e.update(b),z=b.material;if(Array.isArray(z)){const H=L.groups;for(let U=0,X=H.length;U<X;U++){const I=H[U],V=z[I.materialIndex];if(V&&V.visible){const W=v(b,V,T,M.near,M.far,x);i.renderBufferDirect(M,null,L,W,b,I)}}}else if(z.visible){const H=v(b,z,T,M.near,M.far,x);i.renderBufferDirect(M,null,L,H,b,null)}}const D=b.children;for(let L=0,z=D.length;L<z;L++)y(D[L],w,M,T,x)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=pM,this.render=function(b,w,M){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===b.length)return;const T=i.getRenderTarget(),x=i.getActiveCubeFace(),E=i.getActiveMipmapLevel(),D=i.state;D.setBlending(ao),D.buffers.color.setClear(1,1,1,1),D.buffers.depth.setTest(!0),D.setScissorTest(!1);for(let L=0,z=b.length;L<z;L++){const H=b[L],U=H.shadow;if(void 0===U){console.warn("THREE.WebGLShadowMap:",H,"has no shadow.");continue}if(!1===U.autoUpdate&&!1===U.needsUpdate)continue;r.copy(U.mapSize);const X=U.getFrameExtents();r.multiply(X),s.copy(U.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/X.x),r.x=s.x*X.x,U.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/X.y),r.y=s.y*X.y,U.mapSize.y=s.y)),null===U.map&&(U.map=new Wn(r.x,r.y,this.type!==nh?{minFilter:bi,magFilter:bi}:{}),U.map.texture.name=H.name+".shadowMap",U.camera.updateProjectionMatrix()),i.setRenderTarget(U.map),i.clear();const I=U.getViewportCount();for(let V=0;V<I;V++){const W=U.getViewport(V);o.set(s.x*W.x,s.y*W.y,s.x*W.z,s.y*W.w),D.viewport(o),U.updateMatrices(H,V),n=U.getFrustum(),y(w,M,U.camera,H,this.type)}!0!==U.isPointLightShadow&&this.type===nh&&_(U,M),U.needsUpdate=!1}g.needsUpdate=!1,i.setRenderTarget(T,x,E)}}function Jee(i,e,t){const n=t.isWebGL2,a=new function r(){let G=!1;const Ae=new dn;let Ue=null;const _t=new dn(0,0,0,0);return{setMask:function(Le){Ue!==Le&&!G&&(i.colorMask(Le,Le,Le,Le),Ue=Le)},setLocked:function(Le){G=Le},setClear:function(Le,Ye,Be,ge,Zt){!0===Zt&&(Le*=ge,Ye*=ge,Be*=ge),Ae.set(Le,Ye,Be,ge),!1===_t.equals(Ae)&&(i.clearColor(Le,Ye,Be,ge),_t.copy(Ae))},reset:function(){G=!1,Ue=null,_t.set(-1,0,0,0)}}},l=new function s(){let G=!1,Ae=null,Ue=null,_t=null;return{setTest:function(Le){Le?Re(2929):$(2929)},setMask:function(Le){Ae!==Le&&!G&&(i.depthMask(Le),Ae=Le)},setFunc:function(Le){if(Ue!==Le){if(Le)switch(Le){case wL:i.depthFunc(512);break;case ML:i.depthFunc(519);break;case SL:i.depthFunc(513);break;case p_:i.depthFunc(515);break;case TL:i.depthFunc(514);break;case CL:i.depthFunc(518);break;case EL:i.depthFunc(516);break;case RL:i.depthFunc(517);break;default:i.depthFunc(515)}else i.depthFunc(515);Ue=Le}},setLocked:function(Le){G=Le},setClear:function(Le){_t!==Le&&(i.clearDepth(Le),_t=Le)},reset:function(){G=!1,Ae=null,Ue=null,_t=null}}},c=new function o(){let G=!1,Ae=null,Ue=null,_t=null,Le=null,Ye=null,Be=null,ge=null,Zt=null;return{setTest:function(xn){G||(xn?Re(2960):$(2960))},setMask:function(xn){Ae!==xn&&!G&&(i.stencilMask(xn),Ae=xn)},setFunc:function(xn,or,js){(Ue!==xn||_t!==or||Le!==js)&&(i.stencilFunc(xn,or,js),Ue=xn,_t=or,Le=js)},setOp:function(xn,or,js){(Ye!==xn||Be!==or||ge!==js)&&(i.stencilOp(xn,or,js),Ye=xn,Be=or,ge=js)},setLocked:function(xn){G=xn},setClear:function(xn){Zt!==xn&&(i.clearStencil(xn),Zt=xn)},reset:function(){G=!1,Ae=null,Ue=null,_t=null,Le=null,Ye=null,Be=null,ge=null,Zt=null}}};let u={},h={},d=new WeakMap,f=[],p=null,m=!1,g=null,_=null,v=null,y=null,b=null,w=null,M=null,T=!1,x=null,E=null,D=null,L=null,z=null;const H=i.getParameter(35661);let U=!1,X=0;const I=i.getParameter(7938);-1!==I.indexOf("WebGL")?(X=parseFloat(/^WebGL (\d)/.exec(I)[1]),U=X>=1):-1!==I.indexOf("OpenGL ES")&&(X=parseFloat(/^OpenGL ES (\d)/.exec(I)[1]),U=X>=2);let V=null,W={};const j=i.getParameter(3088),q=i.getParameter(2978),oe=(new dn).fromArray(j),J=(new dn).fromArray(q);function fe(G,Ae,Ue){const _t=new Uint8Array(4),Le=i.createTexture();i.bindTexture(G,Le),i.texParameteri(G,10241,9728),i.texParameteri(G,10240,9728);for(let Ye=0;Ye<Ue;Ye++)i.texImage2D(Ae+Ye,0,6408,1,1,0,6408,5121,_t);return Le}const he={};function Re(G){!0!==u[G]&&(i.enable(G),u[G]=!0)}function $(G){!1!==u[G]&&(i.disable(G),u[G]=!1)}he[3553]=fe(3553,3553,1),he[34067]=fe(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Re(2929),l.setFunc(p_),Me(!1),Je(fM),Re(2884),ue(ao);const _e={[pc]:32774,[hL]:32778,[dL]:32779};if(n)_e[_M]=32775,_e[vM]=32776;else{const G=e.get("EXT_blend_minmax");null!==G&&(_e[_M]=G.MIN_EXT,_e[vM]=G.MAX_EXT)}const ot={[fL]:0,[pL]:1,[mL]:768,[yM]:770,[xL]:776,[yL]:774,[_L]:772,[gL]:769,[bM]:771,[bL]:775,[vL]:773};function ue(G,Ae,Ue,_t,Le,Ye,Be,ge){if(G!==ao){if(!1===m&&(Re(3042),m=!0),G===uL)Le=Le||Ae,Ye=Ye||Ue,Be=Be||_t,(Ae!==_||Le!==b)&&(i.blendEquationSeparate(_e[Ae],_e[Le]),_=Ae,b=Le),(Ue!==v||_t!==y||Ye!==w||Be!==M)&&(i.blendFuncSeparate(ot[Ue],ot[_t],ot[Ye],ot[Be]),v=Ue,y=_t,w=Ye,M=Be),g=G,T=null;else if(G!==g||ge!==T){if((_!==pc||b!==pc)&&(i.blendEquation(32774),_=pc,b=pc),ge)switch(G){case fc:i.blendFuncSeparate(1,771,1,771);break;case ih:i.blendFunc(1,1);break;case mM:i.blendFuncSeparate(0,769,0,1);break;case gM:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",G)}else switch(G){case fc:i.blendFuncSeparate(770,771,1,771);break;case ih:i.blendFunc(770,1);break;case mM:i.blendFuncSeparate(0,769,0,1);break;case gM:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",G)}v=null,y=null,w=null,M=null,g=G,T=ge}}else!0===m&&($(3042),m=!1)}function Me(G){x!==G&&(i.frontFace(G?2304:2305),x=G)}function Je(G){G!==oL?(Re(2884),G!==E&&i.cullFace(G===fM?1029:G===aL?1028:1032)):$(2884),E=G}function bt(G,Ae,Ue){G?(Re(32823),(L!==Ae||z!==Ue)&&(i.polygonOffset(Ae,Ue),L=Ae,z=Ue)):$(32823)}function dt(G){void 0===G&&(G=33984+H-1),V!==G&&(i.activeTexture(G),V=G)}return{buffers:{color:a,depth:l,stencil:c},enable:Re,disable:$,bindFramebuffer:function K(G,Ae){return h[G]!==Ae&&(i.bindFramebuffer(G,Ae),h[G]=Ae,n&&(36009===G&&(h[36160]=Ae),36160===G&&(h[36009]=Ae)),!0)},drawBuffers:function pe(G,Ae){let Ue=f,_t=!1;if(G)if(Ue=d.get(Ae),void 0===Ue&&(Ue=[],d.set(Ae,Ue)),G.isWebGLMultipleRenderTargets){const Le=G.texture;if(Ue.length!==Le.length||36064!==Ue[0]){for(let Ye=0,Be=Le.length;Ye<Be;Ye++)Ue[Ye]=36064+Ye;Ue.length=Le.length,_t=!0}}else 36064!==Ue[0]&&(Ue[0]=36064,_t=!0);else 1029!==Ue[0]&&(Ue[0]=1029,_t=!0);_t&&(t.isWebGL2?i.drawBuffers(Ue):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ue))},useProgram:function Fe(G){return p!==G&&(i.useProgram(G),p=G,!0)},setBlending:ue,setMaterial:function de(G,Ae){G.side===oo?$(2884):Re(2884);let Ue=G.side===as;Ae&&(Ue=!Ue),Me(Ue),G.blending===fc&&!1===G.transparent?ue(ao):ue(G.blending,G.blendEquation,G.blendSrc,G.blendDst,G.blendEquationAlpha,G.blendSrcAlpha,G.blendDstAlpha,G.premultipliedAlpha),l.setFunc(G.depthFunc),l.setTest(G.depthTest),l.setMask(G.depthWrite),a.setMask(G.colorWrite);const _t=G.stencilWrite;c.setTest(_t),_t&&(c.setMask(G.stencilWriteMask),c.setFunc(G.stencilFunc,G.stencilRef,G.stencilFuncMask),c.setOp(G.stencilFail,G.stencilZFail,G.stencilZPass)),bt(G.polygonOffset,G.polygonOffsetFactor,G.polygonOffsetUnits),!0===G.alphaToCoverage?Re(32926):$(32926)},setFlipSided:Me,setCullFace:Je,setLineWidth:function Ge(G){G!==D&&(U&&i.lineWidth(G),D=G)},setPolygonOffset:bt,setScissorTest:function mt(G){G?Re(3089):$(3089)},activeTexture:dt,bindTexture:function Jt(G,Ae){null===V&&dt();let Ue=W[V];void 0===Ue&&(Ue={type:void 0,texture:void 0},W[V]=Ue),(Ue.type!==G||Ue.texture!==Ae)&&(i.bindTexture(G,Ae||he[G]),Ue.type=G,Ue.texture=Ae)},unbindTexture:function Wt(){const G=W[V];void 0!==G&&void 0!==G.type&&(i.bindTexture(G.type,null),G.type=void 0,G.texture=void 0)},compressedTexImage2D:function B(){try{i.compressedTexImage2D.apply(i,arguments)}catch(G){console.error("THREE.WebGLState:",G)}},texImage2D:function ht(){try{i.texImage2D.apply(i,arguments)}catch(G){console.error("THREE.WebGLState:",G)}},texImage3D:function F(){try{i.texImage3D.apply(i,arguments)}catch(G){console.error("THREE.WebGLState:",G)}},texStorage2D:function Pe(){try{i.texStorage2D.apply(i,arguments)}catch(G){console.error("THREE.WebGLState:",G)}},texStorage3D:function Ve(){try{i.texStorage3D.apply(i,arguments)}catch(G){console.error("THREE.WebGLState:",G)}},texSubImage2D:function P(){try{i.texSubImage2D.apply(i,arguments)}catch(G){console.error("THREE.WebGLState:",G)}},texSubImage3D:function ae(){try{i.texSubImage3D.apply(i,arguments)}catch(G){console.error("THREE.WebGLState:",G)}},compressedTexSubImage2D:function xe(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(G){console.error("THREE.WebGLState:",G)}},scissor:function le(G){!1===oe.equals(G)&&(i.scissor(G.x,G.y,G.z,G.w),oe.copy(G))},viewport:function Ne(G){!1===J.equals(G)&&(i.viewport(G.x,G.y,G.z,G.w),J.copy(G))},reset:function je(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),!0===n&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),u={},V=null,W={},h={},d=new WeakMap,f=[],p=null,m=!1,g=null,_=null,v=null,y=null,b=null,w=null,M=null,T=!1,x=null,E=null,D=null,L=null,z=null,oe.set(0,0,i.canvas.width,i.canvas.height),J.set(0,0,i.canvas.width,i.canvas.height),a.reset(),l.reset(),c.reset()}}}function ete(i,e,t,n,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let m;const g=new WeakMap;let _=!1;try{_=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function v(B,P){return _?new OffscreenCanvas(B,P):Wf("canvas")}function y(B,P,ae,xe){let Pe=1;if((B.width>xe||B.height>xe)&&(Pe=xe/Math.max(B.width,B.height)),Pe<1||!0===P){if(typeof HTMLImageElement<"u"&&B instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&B instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&B instanceof ImageBitmap){const Ve=P?E_:Math.floor,ht=Ve(Pe*B.width),F=Ve(Pe*B.height);void 0===m&&(m=v(ht,F));const le=ae?v(ht,F):m;return le.width=ht,le.height=F,le.getContext("2d").drawImage(B,0,0,ht,F),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+B.width+"x"+B.height+") to ("+ht+"x"+F+")."),le}return"data"in B&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+B.width+"x"+B.height+")."),B}return B}function b(B){return YM(B.width)&&YM(B.height)}function M(B,P){return B.generateMipmaps&&P&&B.minFilter!==bi&&B.minFilter!==si}function T(B){i.generateMipmap(B)}function x(B,P,ae,xe,Pe=!1){if(!1===a)return P;if(null!==B){if(void 0!==i[B])return i[B];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+B+"'")}let Ve=P;return 6403===P&&(5126===ae&&(Ve=33326),5131===ae&&(Ve=33325),5121===ae&&(Ve=33321)),33319===P&&(5126===ae&&(Ve=33328),5131===ae&&(Ve=33327),5121===ae&&(Ve=33323)),6408===P&&(5126===ae&&(Ve=34836),5131===ae&&(Ve=34842),5121===ae&&(Ve=xe===hn&&!1===Pe?35907:32856),32819===ae&&(Ve=32854),32820===ae&&(Ve=32855)),(33325===Ve||33326===Ve||33327===Ve||33328===Ve||34842===Ve||34836===Ve)&&e.get("EXT_color_buffer_float"),Ve}function E(B,P,ae){return!0===M(B,ae)||B.isFramebufferTexture&&B.minFilter!==bi&&B.minFilter!==si?Math.log2(Math.max(P.width,P.height))+1:void 0!==B.mipmaps&&B.mipmaps.length>0?B.mipmaps.length:B.isCompressedTexture&&Array.isArray(B.image)?P.mipmaps.length:1}function D(B){return B===bi||B===Vf||B===jf?9728:9729}function L(B){const P=B.target;P.removeEventListener("dispose",L),function H(B){const P=n.get(B);if(void 0===P.__webglInit)return;const ae=B.source,xe=g.get(ae);if(xe){const Pe=xe[P.__cacheKey];Pe.usedTimes--,0===Pe.usedTimes&&U(B),0===Object.keys(xe).length&&g.delete(ae)}n.remove(B)}(P),P.isVideoTexture&&p.delete(P)}function z(B){const P=B.target;P.removeEventListener("dispose",z),function X(B){const P=B.texture,ae=n.get(B),xe=n.get(P);if(void 0!==xe.__webglTexture&&(i.deleteTexture(xe.__webglTexture),o.memory.textures--),B.depthTexture&&B.depthTexture.dispose(),B.isWebGLCubeRenderTarget)for(let Pe=0;Pe<6;Pe++)i.deleteFramebuffer(ae.__webglFramebuffer[Pe]),ae.__webglDepthbuffer&&i.deleteRenderbuffer(ae.__webglDepthbuffer[Pe]);else{if(i.deleteFramebuffer(ae.__webglFramebuffer),ae.__webglDepthbuffer&&i.deleteRenderbuffer(ae.__webglDepthbuffer),ae.__webglMultisampledFramebuffer&&i.deleteFramebuffer(ae.__webglMultisampledFramebuffer),ae.__webglColorRenderbuffer)for(let Pe=0;Pe<ae.__webglColorRenderbuffer.length;Pe++)ae.__webglColorRenderbuffer[Pe]&&i.deleteRenderbuffer(ae.__webglColorRenderbuffer[Pe]);ae.__webglDepthRenderbuffer&&i.deleteRenderbuffer(ae.__webglDepthRenderbuffer)}if(B.isWebGLMultipleRenderTargets)for(let Pe=0,Ve=P.length;Pe<Ve;Pe++){const ht=n.get(P[Pe]);ht.__webglTexture&&(i.deleteTexture(ht.__webglTexture),o.memory.textures--),n.remove(P[Pe])}n.remove(P),n.remove(B)}(P)}function U(B){const P=n.get(B);i.deleteTexture(P.__webglTexture),delete g.get(B.source)[P.__cacheKey],o.memory.textures--}let I=0;function q(B,P){const ae=n.get(B);if(B.isVideoTexture&&function Jt(B){const P=o.render.frame;p.get(B)!==P&&(p.set(B,P),B.update())}(B),!1===B.isRenderTargetTexture&&B.version>0&&ae.__version!==B.version){const xe=B.image;if(null===xe)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==xe.complete)return void pe(ae,B,P);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.activeTexture(33984+P),t.bindTexture(3553,ae.__webglTexture)}const he={[il]:10497,[dr]:33071,[sh]:33648},Re={[bi]:9728,[Vf]:9984,[jf]:9986,[si]:9729,[g_]:9985,[ya]:9987};function $(B,P,ae){if(ae?(i.texParameteri(B,10242,he[P.wrapS]),i.texParameteri(B,10243,he[P.wrapT]),(32879===B||35866===B)&&i.texParameteri(B,32882,he[P.wrapR]),i.texParameteri(B,10240,Re[P.magFilter]),i.texParameteri(B,10241,Re[P.minFilter])):(i.texParameteri(B,10242,33071),i.texParameteri(B,10243,33071),(32879===B||35866===B)&&i.texParameteri(B,32882,33071),(P.wrapS!==dr||P.wrapT!==dr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(B,10240,D(P.magFilter)),i.texParameteri(B,10241,D(P.minFilter)),P.minFilter!==bi&&P.minFilter!==si&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const xe=e.get("EXT_texture_filter_anisotropic");if(P.type===Wr&&!1===e.has("OES_texture_float_linear")||!1===a&&P.type===lo&&!1===e.has("OES_texture_half_float_linear"))return;(P.anisotropy>1||n.get(P).__currentAnisotropy)&&(i.texParameterf(B,xe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(P.anisotropy,r.getMaxAnisotropy())),n.get(P).__currentAnisotropy=P.anisotropy)}}function K(B,P){let ae=!1;void 0===B.__webglInit&&(B.__webglInit=!0,P.addEventListener("dispose",L));const xe=P.source;let Pe=g.get(xe);void 0===Pe&&(Pe={},g.set(xe,Pe));const Ve=function j(B){const P=[];return P.push(B.wrapS),P.push(B.wrapT),P.push(B.magFilter),P.push(B.minFilter),P.push(B.anisotropy),P.push(B.internalFormat),P.push(B.format),P.push(B.type),P.push(B.generateMipmaps),P.push(B.premultiplyAlpha),P.push(B.flipY),P.push(B.unpackAlignment),P.push(B.encoding),P.join()}(P);if(Ve!==B.__cacheKey){void 0===Pe[Ve]&&(Pe[Ve]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,ae=!0),Pe[Ve].usedTimes++;const ht=Pe[B.__cacheKey];void 0!==ht&&(Pe[B.__cacheKey].usedTimes--,0===ht.usedTimes&&U(P)),B.__cacheKey=Ve,B.__webglTexture=Pe[Ve].texture}return ae}function pe(B,P,ae){let xe=3553;P.isDataArrayTexture&&(xe=35866),P.isData3DTexture&&(xe=32879);const Pe=K(B,P),Ve=P.source;if(t.activeTexture(33984+ae),t.bindTexture(xe,B.__webglTexture),Ve.version!==Ve.__currentVersion||!0===Pe){i.pixelStorei(37440,P.flipY),i.pixelStorei(37441,P.premultiplyAlpha),i.pixelStorei(3317,P.unpackAlignment),i.pixelStorei(37443,0);const ht=function w(B){return!a&&(B.wrapS!==dr||B.wrapT!==dr||B.minFilter!==bi&&B.minFilter!==si)}(P)&&!1===b(P.image);let F=y(P.image,ht,!1,u);F=Wt(P,F);const le=b(F)||a,Ne=s.convert(P.format,P.encoding);let Ae,je=s.convert(P.type),G=x(P.internalFormat,Ne,je,P.encoding,P.isVideoTexture);$(xe,P,le);const Ue=P.mipmaps,_t=a&&!0!==P.isVideoTexture,Le=void 0===Ve.__currentVersion||!0===Pe,Ye=E(P,F,le);if(P.isDepthTexture)G=6402,a?G=P.type===Wr?36012:P.type===rl?33190:P.type===mc?35056:33189:P.type===Wr&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),P.format===sl&&6402===G&&P.type!==xM&&P.type!==rl&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),P.type=rl,je=s.convert(P.type)),P.format===gc&&6402===G&&(G=34041,P.type!==mc&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),P.type=mc,je=s.convert(P.type))),Le&&(_t?t.texStorage2D(3553,1,G,F.width,F.height):t.texImage2D(3553,0,G,F.width,F.height,0,Ne,je,null));else if(P.isDataTexture)if(Ue.length>0&&le){_t&&Le&&t.texStorage2D(3553,Ye,G,Ue[0].width,Ue[0].height);for(let Be=0,ge=Ue.length;Be<ge;Be++)Ae=Ue[Be],_t?t.texSubImage2D(3553,Be,0,0,Ae.width,Ae.height,Ne,je,Ae.data):t.texImage2D(3553,Be,G,Ae.width,Ae.height,0,Ne,je,Ae.data);P.generateMipmaps=!1}else _t?(Le&&t.texStorage2D(3553,Ye,G,F.width,F.height),t.texSubImage2D(3553,0,0,0,F.width,F.height,Ne,je,F.data)):t.texImage2D(3553,0,G,F.width,F.height,0,Ne,je,F.data);else if(P.isCompressedTexture){_t&&Le&&t.texStorage2D(3553,Ye,G,Ue[0].width,Ue[0].height);for(let Be=0,ge=Ue.length;Be<ge;Be++)Ae=Ue[Be],P.format!==fr?null!==Ne?_t?t.compressedTexSubImage2D(3553,Be,0,0,Ae.width,Ae.height,Ne,Ae.data):t.compressedTexImage2D(3553,Be,G,Ae.width,Ae.height,0,Ae.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):_t?t.texSubImage2D(3553,Be,0,0,Ae.width,Ae.height,Ne,je,Ae.data):t.texImage2D(3553,Be,G,Ae.width,Ae.height,0,Ne,je,Ae.data)}else if(P.isDataArrayTexture)_t?(Le&&t.texStorage3D(35866,Ye,G,F.width,F.height,F.depth),t.texSubImage3D(35866,0,0,0,0,F.width,F.height,F.depth,Ne,je,F.data)):t.texImage3D(35866,0,G,F.width,F.height,F.depth,0,Ne,je,F.data);else if(P.isData3DTexture)_t?(Le&&t.texStorage3D(32879,Ye,G,F.width,F.height,F.depth),t.texSubImage3D(32879,0,0,0,0,F.width,F.height,F.depth,Ne,je,F.data)):t.texImage3D(32879,0,G,F.width,F.height,F.depth,0,Ne,je,F.data);else if(P.isFramebufferTexture){if(Le)if(_t)t.texStorage2D(3553,Ye,G,F.width,F.height);else{let Be=F.width,ge=F.height;for(let Zt=0;Zt<Ye;Zt++)t.texImage2D(3553,Zt,G,Be,ge,0,Ne,je,null),Be>>=1,ge>>=1}}else if(Ue.length>0&&le){_t&&Le&&t.texStorage2D(3553,Ye,G,Ue[0].width,Ue[0].height);for(let Be=0,ge=Ue.length;Be<ge;Be++)Ae=Ue[Be],_t?t.texSubImage2D(3553,Be,0,0,Ne,je,Ae):t.texImage2D(3553,Be,G,Ne,je,Ae);P.generateMipmaps=!1}else _t?(Le&&t.texStorage2D(3553,Ye,G,F.width,F.height),t.texSubImage2D(3553,0,0,0,Ne,je,F)):t.texImage2D(3553,0,G,Ne,je,F);M(P,le)&&T(xe),Ve.__currentVersion=Ve.version,P.onUpdate&&P.onUpdate(P)}B.__version=P.version}function _e(B,P,ae,xe,Pe){const Ve=s.convert(ae.format,ae.encoding),ht=s.convert(ae.type),F=x(ae.internalFormat,Ve,ht,ae.encoding);n.get(P).__hasExternalTextures||(32879===Pe||35866===Pe?t.texImage3D(Pe,0,F,P.width,P.height,P.depth,0,Ve,ht,null):t.texImage2D(Pe,0,F,P.width,P.height,0,Ve,ht,null)),t.bindFramebuffer(36160,B),dt(P)?d.framebufferTexture2DMultisampleEXT(36160,xe,Pe,n.get(ae).__webglTexture,0,mt(P)):i.framebufferTexture2D(36160,xe,Pe,n.get(ae).__webglTexture,0),t.bindFramebuffer(36160,null)}function ot(B,P,ae){if(i.bindRenderbuffer(36161,B),P.depthBuffer&&!P.stencilBuffer){let xe=33189;if(ae||dt(P)){const Pe=P.depthTexture;Pe&&Pe.isDepthTexture&&(Pe.type===Wr?xe=36012:Pe.type===rl&&(xe=33190));const Ve=mt(P);dt(P)?d.renderbufferStorageMultisampleEXT(36161,Ve,xe,P.width,P.height):i.renderbufferStorageMultisample(36161,Ve,xe,P.width,P.height)}else i.renderbufferStorage(36161,xe,P.width,P.height);i.framebufferRenderbuffer(36160,36096,36161,B)}else if(P.depthBuffer&&P.stencilBuffer){const xe=mt(P);ae&&!1===dt(P)?i.renderbufferStorageMultisample(36161,xe,35056,P.width,P.height):dt(P)?d.renderbufferStorageMultisampleEXT(36161,xe,35056,P.width,P.height):i.renderbufferStorage(36161,34041,P.width,P.height),i.framebufferRenderbuffer(36160,33306,36161,B)}else{const xe=!0===P.isWebGLMultipleRenderTargets?P.texture:[P.texture];for(let Pe=0;Pe<xe.length;Pe++){const Ve=xe[Pe],ht=s.convert(Ve.format,Ve.encoding),F=s.convert(Ve.type),le=x(Ve.internalFormat,ht,F,Ve.encoding),Ne=mt(P);ae&&!1===dt(P)?i.renderbufferStorageMultisample(36161,Ne,le,P.width,P.height):dt(P)?d.renderbufferStorageMultisampleEXT(36161,Ne,le,P.width,P.height):i.renderbufferStorage(36161,le,P.width,P.height)}}i.bindRenderbuffer(36161,null)}function de(B){const P=n.get(B),ae=!0===B.isWebGLCubeRenderTarget;if(B.depthTexture&&!P.__autoAllocateDepthBuffer){if(ae)throw new Error("target.depthTexture not supported in Cube render targets");!function ue(B,P){if(P&&P.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,B),!P.depthTexture||!P.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(P.depthTexture).__webglTexture||P.depthTexture.image.width!==P.width||P.depthTexture.image.height!==P.height)&&(P.depthTexture.image.width=P.width,P.depthTexture.image.height=P.height,P.depthTexture.needsUpdate=!0),q(P.depthTexture,0);const xe=n.get(P.depthTexture).__webglTexture,Pe=mt(P);if(P.depthTexture.format===sl)dt(P)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,xe,0,Pe):i.framebufferTexture2D(36160,36096,3553,xe,0);else{if(P.depthTexture.format!==gc)throw new Error("Unknown depthTexture format");dt(P)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,xe,0,Pe):i.framebufferTexture2D(36160,33306,3553,xe,0)}}(P.__webglFramebuffer,B)}else if(ae){P.__webglDepthbuffer=[];for(let xe=0;xe<6;xe++)t.bindFramebuffer(36160,P.__webglFramebuffer[xe]),P.__webglDepthbuffer[xe]=i.createRenderbuffer(),ot(P.__webglDepthbuffer[xe],B,!1)}else t.bindFramebuffer(36160,P.__webglFramebuffer),P.__webglDepthbuffer=i.createRenderbuffer(),ot(P.__webglDepthbuffer,B,!1);t.bindFramebuffer(36160,null)}function mt(B){return Math.min(h,B.samples)}function dt(B){const P=n.get(B);return a&&B.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==P.__useRenderToTexture}function Wt(B,P){const ae=B.encoding,xe=B.format,Pe=B.type;return!0===B.isCompressedTexture||!0===B.isVideoTexture||B.format===C_||ae!==ol&&(ae===hn?!1===a?!0===e.has("EXT_sRGB")&&xe===fr?(B.format=C_,B.minFilter=si,B.generateMipmaps=!1):P=JM.sRGBToLinear(P):(xe!==fr||Pe!==Gr)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ae)),P}this.allocateTextureUnit=function W(){const B=I;return B>=l&&console.warn("THREE.WebGLTextures: Trying to use "+B+" texture units while this GPU supports only "+l),I+=1,B},this.resetTextureUnits=function V(){I=0},this.setTexture2D=q,this.setTexture2DArray=function oe(B,P){const ae=n.get(B);B.version>0&&ae.__version!==B.version?pe(ae,B,P):(t.activeTexture(33984+P),t.bindTexture(35866,ae.__webglTexture))},this.setTexture3D=function J(B,P){const ae=n.get(B);B.version>0&&ae.__version!==B.version?pe(ae,B,P):(t.activeTexture(33984+P),t.bindTexture(32879,ae.__webglTexture))},this.setTextureCube=function fe(B,P){const ae=n.get(B);B.version>0&&ae.__version!==B.version?function Fe(B,P,ae){if(6!==P.image.length)return;const xe=K(B,P),Pe=P.source;if(t.activeTexture(33984+ae),t.bindTexture(34067,B.__webglTexture),Pe.version!==Pe.__currentVersion||!0===xe){i.pixelStorei(37440,P.flipY),i.pixelStorei(37441,P.premultiplyAlpha),i.pixelStorei(3317,P.unpackAlignment),i.pixelStorei(37443,0);const Ve=P.isCompressedTexture||P.image[0].isCompressedTexture,ht=P.image[0]&&P.image[0].isDataTexture,F=[];for(let Be=0;Be<6;Be++)F[Be]=Ve||ht?ht?P.image[Be].image:P.image[Be]:y(P.image[Be],!1,!0,c),F[Be]=Wt(P,F[Be]);const le=F[0],Ne=b(le)||a,je=s.convert(P.format,P.encoding),G=s.convert(P.type),Ae=x(P.internalFormat,je,G,P.encoding),Ue=a&&!0!==P.isVideoTexture,_t=void 0===Pe.__currentVersion||!0===xe;let Ye,Le=E(P,le,Ne);if($(34067,P,Ne),Ve){Ue&&_t&&t.texStorage2D(34067,Le,Ae,le.width,le.height);for(let Be=0;Be<6;Be++){Ye=F[Be].mipmaps;for(let ge=0;ge<Ye.length;ge++){const Zt=Ye[ge];P.format!==fr?null!==je?Ue?t.compressedTexSubImage2D(34069+Be,ge,0,0,Zt.width,Zt.height,je,Zt.data):t.compressedTexImage2D(34069+Be,ge,Ae,Zt.width,Zt.height,0,Zt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ue?t.texSubImage2D(34069+Be,ge,0,0,Zt.width,Zt.height,je,G,Zt.data):t.texImage2D(34069+Be,ge,Ae,Zt.width,Zt.height,0,je,G,Zt.data)}}}else{Ye=P.mipmaps,Ue&&_t&&(Ye.length>0&&Le++,t.texStorage2D(34067,Le,Ae,F[0].width,F[0].height));for(let Be=0;Be<6;Be++)if(ht){Ue?t.texSubImage2D(34069+Be,0,0,0,F[Be].width,F[Be].height,je,G,F[Be].data):t.texImage2D(34069+Be,0,Ae,F[Be].width,F[Be].height,0,je,G,F[Be].data);for(let ge=0;ge<Ye.length;ge++){const xn=Ye[ge].image[Be].image;Ue?t.texSubImage2D(34069+Be,ge+1,0,0,xn.width,xn.height,je,G,xn.data):t.texImage2D(34069+Be,ge+1,Ae,xn.width,xn.height,0,je,G,xn.data)}}else{Ue?t.texSubImage2D(34069+Be,0,0,0,je,G,F[Be]):t.texImage2D(34069+Be,0,Ae,je,G,F[Be]);for(let ge=0;ge<Ye.length;ge++){const Zt=Ye[ge];Ue?t.texSubImage2D(34069+Be,ge+1,0,0,je,G,Zt.image[Be]):t.texImage2D(34069+Be,ge+1,Ae,je,G,Zt.image[Be])}}}M(P,Ne)&&T(34067),Pe.__currentVersion=Pe.version,P.onUpdate&&P.onUpdate(P)}B.__version=P.version}(ae,B,P):(t.activeTexture(33984+P),t.bindTexture(34067,ae.__webglTexture))},this.rebindTextures=function Me(B,P,ae){const xe=n.get(B);void 0!==P&&_e(xe.__webglFramebuffer,B,B.texture,36064,3553),void 0!==ae&&de(B)},this.setupRenderTarget=function Je(B){const P=B.texture,ae=n.get(B),xe=n.get(P);B.addEventListener("dispose",z),!0!==B.isWebGLMultipleRenderTargets&&(void 0===xe.__webglTexture&&(xe.__webglTexture=i.createTexture()),xe.__version=P.version,o.memory.textures++);const Pe=!0===B.isWebGLCubeRenderTarget,Ve=!0===B.isWebGLMultipleRenderTargets,ht=b(B)||a;if(Pe){ae.__webglFramebuffer=[];for(let F=0;F<6;F++)ae.__webglFramebuffer[F]=i.createFramebuffer()}else{if(ae.__webglFramebuffer=i.createFramebuffer(),Ve)if(r.drawBuffers){const F=B.texture;for(let le=0,Ne=F.length;le<Ne;le++){const je=n.get(F[le]);void 0===je.__webglTexture&&(je.__webglTexture=i.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&B.samples>0&&!1===dt(B)){const F=Ve?P:[P];ae.__webglMultisampledFramebuffer=i.createFramebuffer(),ae.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,ae.__webglMultisampledFramebuffer);for(let le=0;le<F.length;le++){const Ne=F[le];ae.__webglColorRenderbuffer[le]=i.createRenderbuffer(),i.bindRenderbuffer(36161,ae.__webglColorRenderbuffer[le]);const je=s.convert(Ne.format,Ne.encoding),G=s.convert(Ne.type),Ae=x(Ne.internalFormat,je,G,Ne.encoding),Ue=mt(B);i.renderbufferStorageMultisample(36161,Ue,Ae,B.width,B.height),i.framebufferRenderbuffer(36160,36064+le,36161,ae.__webglColorRenderbuffer[le])}i.bindRenderbuffer(36161,null),B.depthBuffer&&(ae.__webglDepthRenderbuffer=i.createRenderbuffer(),ot(ae.__webglDepthRenderbuffer,B,!0)),t.bindFramebuffer(36160,null)}}if(Pe){t.bindTexture(34067,xe.__webglTexture),$(34067,P,ht);for(let F=0;F<6;F++)_e(ae.__webglFramebuffer[F],B,P,36064,34069+F);M(P,ht)&&T(34067),t.unbindTexture()}else if(Ve){const F=B.texture;for(let le=0,Ne=F.length;le<Ne;le++){const je=F[le],G=n.get(je);t.bindTexture(3553,G.__webglTexture),$(3553,je,ht),_e(ae.__webglFramebuffer,B,je,36064+le,3553),M(je,ht)&&T(3553)}t.unbindTexture()}else{let F=3553;(B.isWebGL3DRenderTarget||B.isWebGLArrayRenderTarget)&&(a?F=B.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(F,xe.__webglTexture),$(F,P,ht),_e(ae.__webglFramebuffer,B,P,36064,F),M(P,ht)&&T(F),t.unbindTexture()}B.depthBuffer&&de(B)},this.updateRenderTargetMipmap=function Ge(B){const P=b(B)||a,ae=!0===B.isWebGLMultipleRenderTargets?B.texture:[B.texture];for(let xe=0,Pe=ae.length;xe<Pe;xe++){const Ve=ae[xe];if(M(Ve,P)){const ht=B.isWebGLCubeRenderTarget?34067:3553,F=n.get(Ve).__webglTexture;t.bindTexture(ht,F),T(ht),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function bt(B){if(a&&B.samples>0&&!1===dt(B)){const P=B.isWebGLMultipleRenderTargets?B.texture:[B.texture],ae=B.width,xe=B.height;let Pe=16384;const Ve=[],ht=B.stencilBuffer?33306:36096,F=n.get(B),le=!0===B.isWebGLMultipleRenderTargets;if(le)for(let Ne=0;Ne<P.length;Ne++)t.bindFramebuffer(36160,F.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+Ne,36161,null),t.bindFramebuffer(36160,F.__webglFramebuffer),i.framebufferTexture2D(36009,36064+Ne,3553,null,0);t.bindFramebuffer(36008,F.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,F.__webglFramebuffer);for(let Ne=0;Ne<P.length;Ne++){Ve.push(36064+Ne),B.depthBuffer&&Ve.push(ht);const je=void 0!==F.__ignoreDepthValues&&F.__ignoreDepthValues;if(!1===je&&(B.depthBuffer&&(Pe|=256),B.stencilBuffer&&(Pe|=1024)),le&&i.framebufferRenderbuffer(36008,36064,36161,F.__webglColorRenderbuffer[Ne]),!0===je&&(i.invalidateFramebuffer(36008,[ht]),i.invalidateFramebuffer(36009,[ht])),le){const G=n.get(P[Ne]).__webglTexture;i.framebufferTexture2D(36009,36064,3553,G,0)}i.blitFramebuffer(0,0,ae,xe,0,0,ae,xe,Pe,9728),f&&i.invalidateFramebuffer(36008,Ve)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),le)for(let Ne=0;Ne<P.length;Ne++){t.bindFramebuffer(36160,F.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+Ne,36161,F.__webglColorRenderbuffer[Ne]);const je=n.get(P[Ne]).__webglTexture;t.bindFramebuffer(36160,F.__webglFramebuffer),i.framebufferTexture2D(36009,36064+Ne,3553,je,0)}t.bindFramebuffer(36009,F.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=de,this.setupFrameBufferTexture=_e,this.useMultisampledRTT=dt}function GO(i,e,t){const n=t.isWebGL2;return{convert:function r(s,o=null){let a;if(s===Gr)return 5121;if(s===UL)return 32819;if(s===VL)return 32820;if(s===kL)return 5120;if(s===NL)return 5122;if(s===xM)return 5123;if(s===BL)return 5124;if(s===rl)return 5125;if(s===Wr)return 5126;if(s===lo)return n?5131:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(s===jL)return 6406;if(s===fr)return 6408;if(s===wM)return 6409;if(s===HL)return 6410;if(s===sl)return 6402;if(s===gc)return 34041;if(s===_c)return 6403;if(s===zL)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(s===C_)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(s===GL)return 36244;if(s===oh)return 33319;if(s===WL)return 33320;if(s===XL)return 36249;if(s===__||s===v_||s===y_||s===b_)if(o===hn){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(s===__)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===v_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===y_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===b_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(s===__)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===v_)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===y_)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===b_)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(s===MM||s===SM||s===TM||s===CM){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(s===MM)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===SM)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===TM)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===CM)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(s===KL)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===EM||s===RM){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(s===EM)return o===hn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===RM)return o===hn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(s===AM||s===DM||s===PM||s===IM||s===FM||s===LM||s===OM||s===kM||s===NM||s===BM||s===UM||s===VM||s===jM||s===zM){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(s===AM)return o===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===DM)return o===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===PM)return o===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===IM)return o===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===FM)return o===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===LM)return o===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===OM)return o===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===kM)return o===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===NM)return o===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===BM)return o===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===UM)return o===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===VM)return o===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===jM)return o===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===zM)return o===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(s===HM){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(s===HM)return o===hn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}return s===mc?n?34042:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==i[s]?i[s]:null}}}class WO extends zi{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Xo extends gn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const tte={type:"move"};class RS{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Xo,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Xo,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new C,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new C),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Xo,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new C,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new C),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(c&&e.hand){o=!0;for(const m of e.hand.values()){const g=t.getJointPose(m,n);if(void 0===c.joints[m.jointName]){const v=new Xo;v.matrixAutoUpdate=!1,v.visible=!1,c.joints[m.jointName]=v,c.add(v)}const _=c.joints[m.jointName];null!==g&&(_.matrix.fromArray(g.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale),_.jointRadius=g.radius),_.visible=null!==g}const d=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),f=.02,p=.005;c.inputState.pinching&&d>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&d<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(tte)))}return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}}class XO extends mr{constructor(e,t,n,r,s,o,a,l,c,u){if((u=void 0!==u?u:sl)!==sl&&u!==gc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&u===sl&&(n=rl),void 0===n&&u===gc&&(n=mc),super(null,r,s,o,a,l,u,n,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:bi,this.minFilter=void 0!==l?l:bi,this.flipY=!1,this.generateMipmaps=!1}}class nte extends ls{constructor(e,t){super();const n=this;let r=null,s=1,o=null,a="local-floor",l=null,c=null,u=null,h=null,d=null,f=null;const p=t.getContextAttributes();let m=null,g=null;const _=[],v=[],y=new zi;y.layers.enable(1),y.viewport=new dn;const b=new zi;b.layers.enable(2),b.viewport=new dn;const w=[y,b],M=new WO;M.layers.enable(1),M.layers.enable(2);let T=null,x=null;function E(j){const q=v.indexOf(j.inputSource);if(-1===q)return;const oe=_[q];void 0!==oe&&oe.dispatchEvent({type:j.type,data:j.inputSource})}function D(){r.removeEventListener("select",E),r.removeEventListener("selectstart",E),r.removeEventListener("selectend",E),r.removeEventListener("squeeze",E),r.removeEventListener("squeezestart",E),r.removeEventListener("squeezeend",E),r.removeEventListener("end",D),r.removeEventListener("inputsourceschange",L);for(let j=0;j<_.length;j++){const q=v[j];null!==q&&(v[j]=null,_[j].disconnect(q))}T=null,x=null,e.setRenderTarget(m),d=null,h=null,u=null,r=null,g=null,W.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function L(j){for(let q=0;q<j.removed.length;q++){const oe=j.removed[q],J=v.indexOf(oe);J>=0&&(v[J]=null,_[J].dispatchEvent({type:"disconnected",data:oe}))}for(let q=0;q<j.added.length;q++){const oe=j.added[q];let J=v.indexOf(oe);if(-1===J){for(let he=0;he<_.length;he++){if(he>=v.length){v.push(oe),J=he;break}if(null===v[he]){v[he]=oe,J=he;break}}if(-1===J)break}const fe=_[J];fe&&fe.dispatchEvent({type:"connected",data:oe})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(j){let q=_[j];return void 0===q&&(q=new RS,_[j]=q),q.getTargetRaySpace()},this.getControllerGrip=function(j){let q=_[j];return void 0===q&&(q=new RS,_[j]=q),q.getGripSpace()},this.getHand=function(j){let q=_[j];return void 0===q&&(q=new RS,_[j]=q),q.getHandSpace()},this.setFramebufferScaleFactor=function(j){s=j,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(j){a=j,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||o},this.setReferenceSpace=function(j){l=j},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return u},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=function(){var j=so(function*(q){if(r=q,null!==r){if(m=e.getRenderTarget(),r.addEventListener("select",E),r.addEventListener("selectstart",E),r.addEventListener("selectend",E),r.addEventListener("squeeze",E),r.addEventListener("squeezestart",E),r.addEventListener("squeezeend",E),r.addEventListener("end",D),r.addEventListener("inputsourceschange",L),!0!==p.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)d=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||p.antialias,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:d}),g=new Wn(d.framebufferWidth,d.framebufferHeight,{format:fr,type:Gr,encoding:e.outputEncoding});else{let oe=null,J=null,fe=null;p.depth&&(fe=p.stencil?35056:33190,oe=p.stencil?gc:sl,J=p.stencil?mc:rl);const he={colorFormat:32856,depthFormat:fe,scaleFactor:s};u=new XRWebGLBinding(r,t),h=u.createProjectionLayer(he),r.updateRenderState({layers:[h]}),g=new Wn(h.textureWidth,h.textureHeight,{format:fr,type:Gr,depthTexture:new XO(h.textureWidth,h.textureHeight,J,void 0,void 0,void 0,void 0,void 0,void 0,oe),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0}),e.properties.get(g).__ignoreDepthValues=h.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(1),l=null,o=yield r.requestReferenceSpace(a),W.setContext(r),W.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(q){return j.apply(this,arguments)}}();const z=new C,H=new C;function X(j,q){null===q?j.matrixWorld.copy(j.matrix):j.matrixWorld.multiplyMatrices(q.matrixWorld,j.matrix),j.matrixWorldInverse.copy(j.matrixWorld).invert()}this.updateCamera=function(j){if(null===r)return;M.near=b.near=y.near=j.near,M.far=b.far=y.far=j.far,(T!==M.near||x!==M.far)&&(r.updateRenderState({depthNear:M.near,depthFar:M.far}),T=M.near,x=M.far);const q=j.parent,oe=M.cameras;X(M,q);for(let fe=0;fe<oe.length;fe++)X(oe[fe],q);M.matrixWorld.decompose(M.position,M.quaternion,M.scale),j.position.copy(M.position),j.quaternion.copy(M.quaternion),j.scale.copy(M.scale),j.matrix.copy(M.matrix),j.matrixWorld.copy(M.matrixWorld);const J=j.children;for(let fe=0,he=J.length;fe<he;fe++)J[fe].updateMatrixWorld(!0);2===oe.length?function U(j,q,oe){z.setFromMatrixPosition(q.matrixWorld),H.setFromMatrixPosition(oe.matrixWorld);const J=z.distanceTo(H),fe=q.projectionMatrix.elements,he=oe.projectionMatrix.elements,Re=fe[14]/(fe[10]-1),$=fe[14]/(fe[10]+1),K=(fe[9]+1)/fe[5],pe=(fe[9]-1)/fe[5],Fe=(fe[8]-1)/fe[0],_e=(he[8]+1)/he[0],ot=Re*Fe,ue=Re*_e,de=J/(-Fe+_e),Me=de*-Fe;q.matrixWorld.decompose(j.position,j.quaternion,j.scale),j.translateX(Me),j.translateZ(de),j.matrixWorld.compose(j.position,j.quaternion,j.scale),j.matrixWorldInverse.copy(j.matrixWorld).invert();const Je=Re+de,Ge=$+de;j.projectionMatrix.makePerspective(ot-Me,ue+(J-Me),K*$/Ge*Je,pe*$/Ge*Je,Je,Ge)}(M,y,b):M.projectionMatrix.copy(y.projectionMatrix)},this.getCamera=function(){return M},this.getFoveation=function(){return null!==h?h.fixedFoveation:null!==d?d.fixedFoveation:void 0},this.setFoveation=function(j){null!==h&&(h.fixedFoveation=j),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=j)};let I=null;const W=new _O;W.setAnimationLoop(function V(j,q){if(c=q.getViewerPose(l||o),f=q,null!==c){const oe=c.views;null!==d&&(e.setRenderTargetFramebuffer(g,d.framebuffer),e.setRenderTarget(g));let J=!1;oe.length!==M.cameras.length&&(M.cameras.length=0,J=!0);for(let fe=0;fe<oe.length;fe++){const he=oe[fe];let Re=null;if(null!==d)Re=d.getViewport(he);else{const K=u.getViewSubImage(h,he);Re=K.viewport,0===fe&&(e.setRenderTargetTextures(g,K.colorTexture,h.ignoreDepthValues?void 0:K.depthStencilTexture),e.setRenderTarget(g))}let $=w[fe];void 0===$&&($=new zi,$.layers.enable(fe),$.viewport=new dn,w[fe]=$),$.matrix.fromArray(he.transform.matrix),$.projectionMatrix.fromArray(he.projectionMatrix),$.viewport.set(Re.x,Re.y,Re.width,Re.height),0===fe&&M.matrix.copy($.matrix),!0===J&&M.cameras.push($)}}for(let oe=0;oe<_.length;oe++){const J=v[oe],fe=_[oe];null!==J&&void 0!==fe&&fe.update(J,q,l||o)}I&&I(j,q),f=null}),this.setAnimationLoop=function(j){I=j},this.dispose=function(){}}}function ite(i,e){function r(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.bumpMap&&(m.bumpMap.value=g.bumpMap,m.bumpScale.value=g.bumpScale,g.side===as&&(m.bumpScale.value*=-1)),g.displacementMap&&(m.displacementMap.value=g.displacementMap,m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap),g.normalMap&&(m.normalMap.value=g.normalMap,m.normalScale.value.copy(g.normalScale),g.side===as&&m.normalScale.value.negate()),g.specularMap&&(m.specularMap.value=g.specularMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);const _=e.get(g).envMap;if(_&&(m.envMap.value=_,m.flipEnvMap.value=_.isCubeTexture&&!1===_.isRenderTargetTexture?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap){m.lightMap.value=g.lightMap;const b=!0!==i.physicallyCorrectLights?Math.PI:1;m.lightMapIntensity.value=g.lightMapIntensity*b}let v,y;g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity),g.map?v=g.map:g.specularMap?v=g.specularMap:g.displacementMap?v=g.displacementMap:g.normalMap?v=g.normalMap:g.bumpMap?v=g.bumpMap:g.roughnessMap?v=g.roughnessMap:g.metalnessMap?v=g.metalnessMap:g.alphaMap?v=g.alphaMap:g.emissiveMap?v=g.emissiveMap:g.clearcoatMap?v=g.clearcoatMap:g.clearcoatNormalMap?v=g.clearcoatNormalMap:g.clearcoatRoughnessMap?v=g.clearcoatRoughnessMap:g.iridescenceMap?v=g.iridescenceMap:g.iridescenceThicknessMap?v=g.iridescenceThicknessMap:g.specularIntensityMap?v=g.specularIntensityMap:g.specularColorMap?v=g.specularColorMap:g.transmissionMap?v=g.transmissionMap:g.thicknessMap?v=g.thicknessMap:g.sheenColorMap?v=g.sheenColorMap:g.sheenRoughnessMap&&(v=g.sheenRoughnessMap),void 0!==v&&(v.isWebGLRenderTarget&&(v=v.texture),!0===v.matrixAutoUpdate&&v.updateMatrix(),m.uvTransform.value.copy(v.matrix)),g.aoMap?y=g.aoMap:g.lightMap&&(y=g.lightMap),void 0!==y&&(y.isWebGLRenderTarget&&(y=y.texture),!0===y.matrixAutoUpdate&&y.updateMatrix(),m.uv2Transform.value.copy(y.matrix))}return{refreshFogUniforms:function t(m,g){m.fogColor.value.copy(g.color),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)},refreshMaterialUniforms:function n(m,g,_,v,y){g.isMeshBasicMaterial||g.isMeshLambertMaterial?r(m,g):g.isMeshToonMaterial?(r(m,g),function u(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}(m,g)):g.isMeshPhongMaterial?(r(m,g),function c(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}(m,g)):g.isMeshStandardMaterial?(r(m,g),function h(m,g){m.roughness.value=g.roughness,m.metalness.value=g.metalness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(m.envMapIntensity.value=g.envMapIntensity)}(m,g),g.isMeshPhysicalMaterial&&function d(m,g,_){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),m.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===as&&m.clearcoatNormalScale.value.negate())),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=_.texture,m.transmissionSamplerSize.value.set(_.width,_.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap)}(m,g,y)):g.isMeshMatcapMaterial?(r(m,g),function f(m,g){g.matcap&&(m.matcap.value=g.matcap)}(m,g)):g.isMeshDepthMaterial?r(m,g):g.isMeshDistanceMaterial?(r(m,g),function p(m,g){m.referencePosition.value.copy(g.referencePosition),m.nearDistance.value=g.nearDistance,m.farDistance.value=g.farDistance}(m,g)):g.isMeshNormalMaterial?r(m,g):g.isLineBasicMaterial?(function s(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity}(m,g),g.isLineDashedMaterial&&function o(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}(m,g)):g.isPointsMaterial?function a(m,g,_,v){let y;m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*_,m.scale.value=.5*v,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest),g.map?y=g.map:g.alphaMap&&(y=g.alphaMap),void 0!==y&&(!0===y.matrixAutoUpdate&&y.updateMatrix(),m.uvTransform.value.copy(y.matrix))}(m,g,_,v):g.isSpriteMaterial?function l(m,g){let _;m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest),g.map?_=g.map:g.alphaMap&&(_=g.alphaMap),void 0!==_&&(!0===_.matrixAutoUpdate&&_.updateMatrix(),m.uvTransform.value.copy(_.matrix))}(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}}}function AS(i={}){this.isWebGLRenderer=!0;const e=void 0!==i.canvas?i.canvas:function rte(){const i=Wf("canvas");return i.style.display="block",i}(),t=void 0!==i.context?i.context:null,n=void 0===i.depth||i.depth,r=void 0===i.stencil||i.stencil,s=void 0!==i.antialias&&i.antialias,o=void 0===i.premultipliedAlpha||i.premultipliedAlpha,a=void 0!==i.preserveDrawingBuffer&&i.preserveDrawingBuffer,l=void 0!==i.powerPreference?i.powerPreference:"default",c=void 0!==i.failIfMajorPerformanceCaveat&&i.failIfMajorPerformanceCaveat;let u;u=null!==t?t.getContextAttributes().alpha:void 0!==i.alpha&&i.alpha;let h=null,d=null;const f=[],p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=ol,this.physicallyCorrectLights=!1,this.toneMapping=jo,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const m=this;let g=!1,_=0,v=0,y=null,b=-1,w=null;const M=new dn,T=new dn;let x=null,E=e.width,D=e.height,L=1,z=null,H=null;const U=new dn(0,0,E,D),X=new dn(0,0,E,D);let I=!1;const V=new Q_;let W=!1,j=!1,q=null;const oe=new st,J=new te,fe=new C,he={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Re(){return null===y?L:1}let pe,Fe,_e,ot,ue,de,Me,Je,Ge,bt,mt,dt,Jt,Wt,B,P,ae,xe,Pe,Ve,ht,F,le,$=t;function K(O,ne){for(let ce=0;ce<O.length;ce++){const ye=e.getContext(O[ce],ne);if(null!==ye)return ye}return null}try{const O={alpha:!0,depth:n,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${f_}`),e.addEventListener("webglcontextlost",G,!1),e.addEventListener("webglcontextrestored",Ae,!1),e.addEventListener("webglcontextcreationerror",Ue,!1),null===$){const ne=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&ne.shift(),$=K(ne,O),null===$)throw K(ne)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===$.getShaderPrecisionFormat&&($.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(O){throw console.error("THREE.WebGLRenderer: "+O.message),O}function Ne(){pe=new bJ($),Fe=new pJ($,pe,i),pe.init(Fe),F=new GO($,pe,Fe),_e=new Jee($,pe,Fe),ot=new MJ,ue=new jee,de=new ete($,pe,_e,ue,Fe,F,ot),Me=new gJ(m),Je=new yJ(m),Ge=new fQ($,Fe),le=new dJ($,pe,Ge,Fe),bt=new xJ($,Ge,ot,le),mt=new EJ($,bt,Ge,ot),Pe=new CJ($,Fe,de),P=new mJ(ue),dt=new Vee(m,Me,Je,pe,Fe,le,P),Jt=new ite(m,ue),Wt=new Hee,B=new Zee(pe,Fe),xe=new hJ(m,Me,_e,mt,u,o),ae=new $ee(m,mt,Fe),Ve=new fJ($,pe,ot,Fe),ht=new wJ($,pe,ot,Fe),ot.programs=dt.programs,m.capabilities=Fe,m.extensions=pe,m.properties=ue,m.renderLists=Wt,m.shadowMap=ae,m.state=_e,m.info=ot}Ne();const je=new nte(m,$);function G(O){O.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function Ae(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const O=ot.autoReset,ne=ae.enabled,ce=ae.autoUpdate,Y=ae.needsUpdate,ye=ae.type;Ne(),ot.autoReset=O,ae.enabled=ne,ae.autoUpdate=ce,ae.needsUpdate=Y,ae.type=ye}function Ue(O){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",O.statusMessage)}function _t(O){const ne=O.target;ne.removeEventListener("dispose",_t),function Le(O){(function Ye(O){const ne=ue.get(O).programs;void 0!==ne&&(ne.forEach(function(ce){dt.releaseProgram(ce)}),O.isShaderMaterial&&dt.releaseShaderCache(O))})(O),ue.remove(O)}(ne)}this.xr=je,this.getContext=function(){return $},this.getContextAttributes=function(){return $.getContextAttributes()},this.forceContextLoss=function(){const O=pe.get("WEBGL_lose_context");O&&O.loseContext()},this.forceContextRestore=function(){const O=pe.get("WEBGL_lose_context");O&&O.restoreContext()},this.getPixelRatio=function(){return L},this.setPixelRatio=function(O){void 0!==O&&(L=O,this.setSize(E,D,!1))},this.getSize=function(O){return O.set(E,D)},this.setSize=function(O,ne,ce){je.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(E=O,D=ne,e.width=Math.floor(O*L),e.height=Math.floor(ne*L),!1!==ce&&(e.style.width=O+"px",e.style.height=ne+"px"),this.setViewport(0,0,O,ne))},this.getDrawingBufferSize=function(O){return O.set(E*L,D*L).floor()},this.setDrawingBufferSize=function(O,ne,ce){E=O,D=ne,L=ce,e.width=Math.floor(O*ce),e.height=Math.floor(ne*ce),this.setViewport(0,0,O,ne)},this.getCurrentViewport=function(O){return O.copy(M)},this.getViewport=function(O){return O.copy(U)},this.setViewport=function(O,ne,ce,Y){O.isVector4?U.set(O.x,O.y,O.z,O.w):U.set(O,ne,ce,Y),_e.viewport(M.copy(U).multiplyScalar(L).floor())},this.getScissor=function(O){return O.copy(X)},this.setScissor=function(O,ne,ce,Y){O.isVector4?X.set(O.x,O.y,O.z,O.w):X.set(O,ne,ce,Y),_e.scissor(T.copy(X).multiplyScalar(L).floor())},this.getScissorTest=function(){return I},this.setScissorTest=function(O){_e.setScissorTest(I=O)},this.setOpaqueSort=function(O){z=O},this.setTransparentSort=function(O){H=O},this.getClearColor=function(O){return O.copy(xe.getClearColor())},this.setClearColor=function(){xe.setClearColor.apply(xe,arguments)},this.getClearAlpha=function(){return xe.getClearAlpha()},this.setClearAlpha=function(){xe.setClearAlpha.apply(xe,arguments)},this.clear=function(O=!0,ne=!0,ce=!0){let Y=0;O&&(Y|=16384),ne&&(Y|=256),ce&&(Y|=1024),$.clear(Y)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",G,!1),e.removeEventListener("webglcontextrestored",Ae,!1),e.removeEventListener("webglcontextcreationerror",Ue,!1),Wt.dispose(),B.dispose(),ue.dispose(),Me.dispose(),Je.dispose(),mt.dispose(),le.dispose(),dt.dispose(),je.dispose(),je.removeEventListener("sessionstart",Zt),je.removeEventListener("sessionend",xn),q&&(q.dispose(),q=null),or.stop()},this.renderBufferDirect=function(O,ne,ce,Y,ye,It){null===ne&&(ne=he);const S=ye.isMesh&&ye.matrixWorld.determinant()<0,R=function W1(O,ne,ce,Y,ye){!0!==ne.isScene&&(ne=he),de.resetTextureUnits();const It=ne.fog,R=null===y?m.outputEncoding:!0===y.isXRRenderTarget?y.texture.encoding:ol,k=(Y.isMeshStandardMaterial?Je:Me).get(Y.envMap||(Y.isMeshStandardMaterial?ne.environment:null)),Z=!0===Y.vertexColors&&!!ce.attributes.color&&4===ce.attributes.color.itemSize,ie=!!Y.normalMap&&!!ce.attributes.tangent,ee=!!ce.morphAttributes.position,ve=!!ce.morphAttributes.normal,Oe=!!ce.morphAttributes.color,ze=Y.toneMapped?m.toneMapping:jo,we=ce.morphAttributes.position||ce.morphAttributes.normal||ce.morphAttributes.color,Ie=void 0!==we?we.length:0,ke=ue.get(Y),lt=d.state.lights;!0!==W||!0!==j&&O===w||P.setState(Y,O,O===w&&Y.id===b);let rt=!1;Y.version===ke.__version?(ke.needsLights&&ke.lightsStateVersion!==lt.state.version||ke.outputEncoding!==R||ye.isInstancedMesh&&!1===ke.instancing||!ye.isInstancedMesh&&!0===ke.instancing||ye.isSkinnedMesh&&!1===ke.skinning||!ye.isSkinnedMesh&&!0===ke.skinning||ke.envMap!==k||!0===Y.fog&&ke.fog!==It||void 0!==ke.numClippingPlanes&&(ke.numClippingPlanes!==P.numPlanes||ke.numIntersection!==P.numIntersection)||ke.vertexAlphas!==Z||ke.vertexTangents!==ie||ke.morphTargets!==ee||ke.morphNormals!==ve||ke.morphColors!==Oe||ke.toneMapping!==ze||!0===Fe.isWebGL2&&ke.morphTargetsCount!==Ie)&&(rt=!0):(rt=!0,ke.__version=Y.version);let Tt=ke.currentProgram;!0===rt&&(Tt=fm(Y,ne,ye));let ct=!1,ft=!1,Yt=!1;const en=Tt.getUniforms(),Vn=ke.uniforms;if(_e.useProgram(Tt.program)&&(ct=!0,ft=!0,Yt=!0),Y.id!==b&&(b=Y.id,ft=!0),ct||w!==O){if(en.setValue($,"projectionMatrix",O.projectionMatrix),Fe.logarithmicDepthBuffer&&en.setValue($,"logDepthBufFC",2/(Math.log(O.far+1)/Math.LN2)),w!==O&&(w=O,ft=!0,Yt=!0),Y.isShaderMaterial||Y.isMeshPhongMaterial||Y.isMeshToonMaterial||Y.isMeshStandardMaterial||Y.envMap){const ln=en.map.cameraPosition;void 0!==ln&&ln.setValue($,fe.setFromMatrixPosition(O.matrixWorld))}(Y.isMeshPhongMaterial||Y.isMeshToonMaterial||Y.isMeshLambertMaterial||Y.isMeshBasicMaterial||Y.isMeshStandardMaterial||Y.isShaderMaterial)&&en.setValue($,"isOrthographic",!0===O.isOrthographicCamera),(Y.isMeshPhongMaterial||Y.isMeshToonMaterial||Y.isMeshLambertMaterial||Y.isMeshBasicMaterial||Y.isMeshStandardMaterial||Y.isShaderMaterial||Y.isShadowMaterial||ye.isSkinnedMesh)&&en.setValue($,"viewMatrix",O.matrixWorldInverse)}if(ye.isSkinnedMesh){en.setOptional($,ye,"bindMatrix"),en.setOptional($,ye,"bindMatrixInverse");const ln=ye.skeleton;ln&&(Fe.floatVertexTextures?(null===ln.boneTexture&&ln.computeBoneTexture(),en.setValue($,"boneTexture",ln.boneTexture,de),en.setValue($,"boneTextureSize",ln.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const ar=ce.morphAttributes;return(void 0!==ar.position||void 0!==ar.normal||void 0!==ar.color&&!0===Fe.isWebGL2)&&Pe.update(ye,ce,Y,Tt),(ft||ke.receiveShadow!==ye.receiveShadow)&&(ke.receiveShadow=ye.receiveShadow,en.setValue($,"receiveShadow",ye.receiveShadow)),ft&&(en.setValue($,"toneMappingExposure",m.toneMappingExposure),ke.needsLights&&function X1(O,ne){O.ambientLightColor.needsUpdate=ne,O.lightProbe.needsUpdate=ne,O.directionalLights.needsUpdate=ne,O.directionalLightShadows.needsUpdate=ne,O.pointLights.needsUpdate=ne,O.pointLightShadows.needsUpdate=ne,O.spotLights.needsUpdate=ne,O.spotLightShadows.needsUpdate=ne,O.rectAreaLights.needsUpdate=ne,O.hemisphereLights.needsUpdate=ne}(Vn,Yt),It&&!0===Y.fog&&Jt.refreshFogUniforms(Vn,It),Jt.refreshMaterialUniforms(Vn,Y,L,D,q),ev.upload($,ke.uniformsList,Vn,de)),Y.isShaderMaterial&&!0===Y.uniformsNeedUpdate&&(ev.upload($,ke.uniformsList,Vn,de),Y.uniformsNeedUpdate=!1),Y.isSpriteMaterial&&en.setValue($,"center",ye.center),en.setValue($,"modelViewMatrix",ye.modelViewMatrix),en.setValue($,"normalMatrix",ye.normalMatrix),en.setValue($,"modelMatrix",ye.matrixWorld),Tt}(O,ne,ce,Y,ye);_e.setMaterial(Y,S);let k=ce.index;const Z=ce.attributes.position;if(null===k){if(void 0===Z||0===Z.count)return}else if(0===k.count)return;let ie=1;!0===Y.wireframe&&(k=bt.getWireframeAttribute(ce),ie=2),le.setup(ye,Y,R,ce,k);let ee,ve=Ve;null!==k&&(ee=Ge.get(k),ve=ht,ve.setIndex(ee));const Oe=null!==k?k.count:Z.count,ze=ce.drawRange.start*ie,we=ce.drawRange.count*ie,Ie=null!==It?It.start*ie:0,ke=null!==It?It.count*ie:1/0,lt=Math.max(ze,Ie),rt=Math.min(Oe,ze+we,Ie+ke)-1,Tt=Math.max(0,rt-lt+1);if(0!==Tt){if(ye.isMesh)!0===Y.wireframe?(_e.setLineWidth(Y.wireframeLinewidth*Re()),ve.setMode(1)):ve.setMode(4);else if(ye.isLine){let ct=Y.linewidth;void 0===ct&&(ct=1),_e.setLineWidth(ct*Re()),ve.setMode(ye.isLineSegments?1:ye.isLineLoop?2:3)}else ye.isPoints?ve.setMode(0):ye.isSprite&&ve.setMode(4);if(ye.isInstancedMesh)ve.renderInstances(lt,Tt,ye.count);else if(ce.isInstancedBufferGeometry){const ct=Math.min(ce.instanceCount,ce._maxInstanceCount);ve.renderInstances(lt,Tt,ct)}else ve.render(lt,Tt)}},this.compile=function(O,ne){d=B.get(O),d.init(),p.push(d),O.traverseVisible(function(ce){ce.isLight&&ce.layers.test(ne.layers)&&(d.pushLight(ce),ce.castShadow&&d.pushShadow(ce))}),d.setupLights(m.physicallyCorrectLights),O.traverse(function(ce){const Y=ce.material;if(Y)if(Array.isArray(Y))for(let ye=0;ye<Y.length;ye++)fm(Y[ye],O,ce);else fm(Y,O,ce)}),p.pop(),d=null};let Be=null;function Zt(){or.stop()}function xn(){or.start()}const or=new _O;function js(O,ne,ce,Y){if(!1===O.visible)return;if(O.layers.test(ne.layers))if(O.isGroup)ce=O.renderOrder;else if(O.isLOD)!0===O.autoUpdate&&O.update(ne);else if(O.isLight)d.pushLight(O),O.castShadow&&d.pushShadow(O);else if(O.isSprite){if(!O.frustumCulled||V.intersectsSprite(O)){Y&&fe.setFromMatrixPosition(O.matrixWorld).applyMatrix4(oe);const S=mt.update(O),R=O.material;R.visible&&h.push(O,S,R,ce,fe.z,null)}}else if((O.isMesh||O.isLine||O.isPoints)&&(O.isSkinnedMesh&&O.skeleton.frame!==ot.render.frame&&(O.skeleton.update(),O.skeleton.frame=ot.render.frame),!O.frustumCulled||V.intersectsObject(O))){Y&&fe.setFromMatrixPosition(O.matrixWorld).applyMatrix4(oe);const S=mt.update(O),R=O.material;if(Array.isArray(R)){const k=S.groups;for(let Z=0,ie=k.length;Z<ie;Z++){const ee=k[Z],ve=R[ee.materialIndex];ve&&ve.visible&&h.push(O,S,ve,ce,fe.z,ee)}}else R.visible&&h.push(O,S,R,ce,fe.z,null)}const It=O.children;for(let S=0,R=It.length;S<R;S++)js(It[S],ne,ce,Y)}function dy(O,ne,ce,Y){const ye=O.opaque,It=O.transmissive,S=O.transparent;d.setupLightsView(ce),It.length>0&&function H1(O,ne,ce){const Y=Fe.isWebGL2;null===q&&(q=new Wn(1,1,{generateMipmaps:!0,type:pe.has("EXT_color_buffer_half_float")?lo:Gr,minFilter:ya,samples:Y&&!0===s?4:0})),m.getDrawingBufferSize(J),Y?q.setSize(J.x,J.y):q.setSize(E_(J.x),E_(J.y));const ye=m.getRenderTarget();m.setRenderTarget(q),m.clear();const It=m.toneMapping;m.toneMapping=jo,Md(O,ne,ce),m.toneMapping=It,de.updateMultisampleRenderTarget(q),de.updateRenderTargetMipmap(q),m.setRenderTarget(ye)}(ye,ne,ce),Y&&_e.viewport(M.copy(Y)),ye.length>0&&Md(ye,ne,ce),It.length>0&&Md(It,ne,ce),S.length>0&&Md(S,ne,ce),_e.buffers.depth.setTest(!0),_e.buffers.depth.setMask(!0),_e.buffers.color.setMask(!0),_e.setPolygonOffset(!1)}function Md(O,ne,ce){const Y=!0===ne.isScene?ne.overrideMaterial:null;for(let ye=0,It=O.length;ye<It;ye++){const S=O[ye],R=S.object,k=S.geometry,Z=null===Y?S.material:Y,ie=S.group;R.layers.test(ce.layers)&&G1(R,ne,ce,k,Z,ie)}}function G1(O,ne,ce,Y,ye,It){O.onBeforeRender(m,ne,ce,Y,ye,It),O.modelViewMatrix.multiplyMatrices(ce.matrixWorldInverse,O.matrixWorld),O.normalMatrix.getNormalMatrix(O.modelViewMatrix),ye.onBeforeRender(m,ne,ce,Y,O,It),!0===ye.transparent&&ye.side===oo?(ye.side=as,ye.needsUpdate=!0,m.renderBufferDirect(ce,ne,Y,ye,O,It),ye.side=el,ye.needsUpdate=!0,m.renderBufferDirect(ce,ne,Y,ye,O,It),ye.side=oo):m.renderBufferDirect(ce,ne,Y,ye,O,It),O.onAfterRender(m,ne,ce,Y,ye,It)}function fm(O,ne,ce){!0!==ne.isScene&&(ne=he);const Y=ue.get(O),ye=d.state.lights,S=ye.state.version,R=dt.getParameters(O,ye.state,d.state.shadowsArray,ne,ce),k=dt.getProgramCacheKey(R);let Z=Y.programs;Y.environment=O.isMeshStandardMaterial?ne.environment:null,Y.fog=ne.fog,Y.envMap=(O.isMeshStandardMaterial?Je:Me).get(O.envMap||Y.environment),void 0===Z&&(O.addEventListener("dispose",_t),Z=new Map,Y.programs=Z);let ie=Z.get(k);if(void 0!==ie){if(Y.currentProgram===ie&&Y.lightsStateVersion===S)return fy(O,R),ie}else R.uniforms=dt.getUniforms(O),O.onBuild(ce,R,m),O.onBeforeCompile(R,m),ie=dt.acquireProgram(R,k),Z.set(k,ie),Y.uniforms=R.uniforms;const ee=Y.uniforms;(!O.isShaderMaterial&&!O.isRawShaderMaterial||!0===O.clipping)&&(ee.clippingPlanes=P.uniform),fy(O,R),Y.needsLights=function Sd(O){return O.isMeshLambertMaterial||O.isMeshToonMaterial||O.isMeshPhongMaterial||O.isMeshStandardMaterial||O.isShadowMaterial||O.isShaderMaterial&&!0===O.lights}(O),Y.lightsStateVersion=S,Y.needsLights&&(ee.ambientLightColor.value=ye.state.ambient,ee.lightProbe.value=ye.state.probe,ee.directionalLights.value=ye.state.directional,ee.directionalLightShadows.value=ye.state.directionalShadow,ee.spotLights.value=ye.state.spot,ee.spotLightShadows.value=ye.state.spotShadow,ee.rectAreaLights.value=ye.state.rectArea,ee.ltc_1.value=ye.state.rectAreaLTC1,ee.ltc_2.value=ye.state.rectAreaLTC2,ee.pointLights.value=ye.state.point,ee.pointLightShadows.value=ye.state.pointShadow,ee.hemisphereLights.value=ye.state.hemi,ee.directionalShadowMap.value=ye.state.directionalShadowMap,ee.directionalShadowMatrix.value=ye.state.directionalShadowMatrix,ee.spotShadowMap.value=ye.state.spotShadowMap,ee.spotShadowMatrix.value=ye.state.spotShadowMatrix,ee.pointShadowMap.value=ye.state.pointShadowMap,ee.pointShadowMatrix.value=ye.state.pointShadowMatrix);const ve=ie.getUniforms(),Oe=ev.seqWithValue(ve.seq,ee);return Y.currentProgram=ie,Y.uniformsList=Oe,ie}function fy(O,ne){const ce=ue.get(O);ce.outputEncoding=ne.outputEncoding,ce.instancing=ne.instancing,ce.skinning=ne.skinning,ce.morphTargets=ne.morphTargets,ce.morphNormals=ne.morphNormals,ce.morphColors=ne.morphColors,ce.morphTargetsCount=ne.morphTargetsCount,ce.numClippingPlanes=ne.numClippingPlanes,ce.numIntersection=ne.numClipIntersection,ce.vertexAlphas=ne.vertexAlphas,ce.vertexTangents=ne.vertexTangents,ce.toneMapping=ne.toneMapping}or.setAnimationLoop(function ge(O){Be&&Be(O)}),typeof self<"u"&&or.setContext(self),this.setAnimationLoop=function(O){Be=O,je.setAnimationLoop(O),null===O?or.stop():or.start()},je.addEventListener("sessionstart",Zt),je.addEventListener("sessionend",xn),this.render=function(O,ne){if(void 0===ne||!0===ne.isCamera){if(!0!==g){if(!0===O.autoUpdate&&O.updateMatrixWorld(),null===ne.parent&&ne.updateMatrixWorld(),!0===je.enabled&&!0===je.isPresenting&&(!0===je.cameraAutoUpdate&&je.updateCamera(ne),ne=je.getCamera()),!0===O.isScene&&O.onBeforeRender(m,O,ne,y),d=B.get(O,p.length),d.init(),p.push(d),oe.multiplyMatrices(ne.projectionMatrix,ne.matrixWorldInverse),V.setFromProjectionMatrix(oe),j=this.localClippingEnabled,W=P.init(this.clippingPlanes,j,ne),h=Wt.get(O,f.length),h.init(),f.push(h),js(O,ne,0,m.sortObjects),h.finish(),!0===m.sortObjects&&h.sort(z,H),!0===W&&P.beginShadows(),ae.render(d.state.shadowsArray,O,ne),!0===W&&P.endShadows(),!0===this.info.autoReset&&this.info.reset(),xe.render(h,O),d.setupLights(m.physicallyCorrectLights),ne.isArrayCamera){const Y=ne.cameras;for(let ye=0,It=Y.length;ye<It;ye++){const S=Y[ye];dy(h,O,S,S.viewport)}}else dy(h,O,ne);null!==y&&(de.updateMultisampleRenderTarget(y),de.updateRenderTargetMipmap(y)),!0===O.isScene&&O.onAfterRender(m,O,ne),le.resetDefaultState(),b=-1,w=null,p.pop(),d=p.length>0?p[p.length-1]:null,f.pop(),h=f.length>0?f[f.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return _},this.getActiveMipmapLevel=function(){return v},this.getRenderTarget=function(){return y},this.setRenderTargetTextures=function(O,ne,ce){ue.get(O.texture).__webglTexture=ne,ue.get(O.depthTexture).__webglTexture=ce;const Y=ue.get(O);Y.__hasExternalTextures=!0,Y.__hasExternalTextures&&(Y.__autoAllocateDepthBuffer=void 0===ce,Y.__autoAllocateDepthBuffer||!0===pe.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Y.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(O,ne){const ce=ue.get(O);ce.__webglFramebuffer=ne,ce.__useDefaultFramebuffer=void 0===ne},this.setRenderTarget=function(O,ne=0,ce=0){y=O,_=ne,v=ce;let Y=!0;if(O){const k=ue.get(O);void 0!==k.__useDefaultFramebuffer?(_e.bindFramebuffer(36160,null),Y=!1):void 0===k.__webglFramebuffer?de.setupRenderTarget(O):k.__hasExternalTextures&&de.rebindTextures(O,ue.get(O.texture).__webglTexture,ue.get(O.depthTexture).__webglTexture)}let ye=null,It=!1,S=!1;if(O){const k=O.texture;(k.isData3DTexture||k.isDataArrayTexture)&&(S=!0);const Z=ue.get(O).__webglFramebuffer;O.isWebGLCubeRenderTarget?(ye=Z[ne],It=!0):ye=Fe.isWebGL2&&O.samples>0&&!1===de.useMultisampledRTT(O)?ue.get(O).__webglMultisampledFramebuffer:Z,M.copy(O.viewport),T.copy(O.scissor),x=O.scissorTest}else M.copy(U).multiplyScalar(L).floor(),T.copy(X).multiplyScalar(L).floor(),x=I;if(_e.bindFramebuffer(36160,ye)&&Fe.drawBuffers&&Y&&_e.drawBuffers(O,ye),_e.viewport(M),_e.scissor(T),_e.setScissorTest(x),It){const k=ue.get(O.texture);$.framebufferTexture2D(36160,36064,34069+ne,k.__webglTexture,ce)}else if(S){const k=ue.get(O.texture);$.framebufferTextureLayer(36160,36064,k.__webglTexture,ce||0,ne||0)}b=-1},this.readRenderTargetPixels=function(O,ne,ce,Y,ye,It,S){if(!O||!O.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let R=ue.get(O).__webglFramebuffer;if(O.isWebGLCubeRenderTarget&&void 0!==S&&(R=R[S]),R){_e.bindFramebuffer(36160,R);try{const k=O.texture,Z=k.format,ie=k.type;if(Z!==fr&&F.convert(Z)!==$.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ee=ie===lo&&(pe.has("EXT_color_buffer_half_float")||Fe.isWebGL2&&pe.has("EXT_color_buffer_float"));if(!(ie===Gr||F.convert(ie)===$.getParameter(35738)||ie===Wr&&(Fe.isWebGL2||pe.has("OES_texture_float")||pe.has("WEBGL_color_buffer_float"))||ee))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");ne>=0&&ne<=O.width-Y&&ce>=0&&ce<=O.height-ye&&$.readPixels(ne,ce,Y,ye,F.convert(Z),F.convert(ie),It)}finally{const k=null!==y?ue.get(y).__webglFramebuffer:null;_e.bindFramebuffer(36160,k)}}},this.copyFramebufferToTexture=function(O,ne,ce=0){const Y=Math.pow(2,-ce),ye=Math.floor(ne.image.width*Y),It=Math.floor(ne.image.height*Y);de.setTexture2D(ne,0),$.copyTexSubImage2D(3553,ce,0,0,O.x,O.y,ye,It),_e.unbindTexture()},this.copyTextureToTexture=function(O,ne,ce,Y=0){const ye=ne.image.width,It=ne.image.height,S=F.convert(ce.format),R=F.convert(ce.type);de.setTexture2D(ce,0),$.pixelStorei(37440,ce.flipY),$.pixelStorei(37441,ce.premultiplyAlpha),$.pixelStorei(3317,ce.unpackAlignment),ne.isDataTexture?$.texSubImage2D(3553,Y,O.x,O.y,ye,It,S,R,ne.image.data):ne.isCompressedTexture?$.compressedTexSubImage2D(3553,Y,O.x,O.y,ne.mipmaps[0].width,ne.mipmaps[0].height,S,ne.mipmaps[0].data):$.texSubImage2D(3553,Y,O.x,O.y,S,R,ne.image),0===Y&&ce.generateMipmaps&&$.generateMipmap(3553),_e.unbindTexture()},this.copyTextureToTexture3D=function(O,ne,ce,Y,ye=0){if(m.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const It=O.max.x-O.min.x+1,S=O.max.y-O.min.y+1,R=O.max.z-O.min.z+1,k=F.convert(Y.format),Z=F.convert(Y.type);let ie;if(Y.isData3DTexture)de.setTexture3D(Y,0),ie=32879;else{if(!Y.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");de.setTexture2DArray(Y,0),ie=35866}$.pixelStorei(37440,Y.flipY),$.pixelStorei(37441,Y.premultiplyAlpha),$.pixelStorei(3317,Y.unpackAlignment);const ee=$.getParameter(3314),ve=$.getParameter(32878),Oe=$.getParameter(3316),ze=$.getParameter(3315),we=$.getParameter(32877),Ie=ce.isCompressedTexture?ce.mipmaps[0]:ce.image;$.pixelStorei(3314,Ie.width),$.pixelStorei(32878,Ie.height),$.pixelStorei(3316,O.min.x),$.pixelStorei(3315,O.min.y),$.pixelStorei(32877,O.min.z),ce.isDataTexture||ce.isData3DTexture?$.texSubImage3D(ie,ye,ne.x,ne.y,ne.z,It,S,R,k,Z,Ie.data):ce.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),$.compressedTexSubImage3D(ie,ye,ne.x,ne.y,ne.z,It,S,R,k,Ie.data)):$.texSubImage3D(ie,ye,ne.x,ne.y,ne.z,It,S,R,k,Z,Ie),$.pixelStorei(3314,ee),$.pixelStorei(32878,ve),$.pixelStorei(3316,Oe),$.pixelStorei(3315,ze),$.pixelStorei(32877,we),0===ye&&Y.generateMipmaps&&$.generateMipmap(ie),_e.unbindTexture()},this.initTexture=function(O){O.isCubeTexture?de.setTextureCube(O,0):O.isData3DTexture?de.setTexture3D(O,0):O.isDataArrayTexture?de.setTexture2DArray(O,0):de.setTexture2D(O,0),_e.unbindTexture()},this.resetState=function(){_=0,v=0,y=null,_e.reset(),le.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class KO extends AS{}KO.prototype.isWebGL1Renderer=!0;class nv{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Ce(e),this.density=t}clone(){return new nv(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class ep{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Ce(e),this.near=t,this.far=n}clone(){return new ep(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class DS extends gn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}class tp{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=S_,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=cs()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=cs()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=cs()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ir=new C;class gl{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Ir.fromBufferAttribute(this,t),Ir.applyMatrix4(e),this.setXYZ(t,Ir.x,Ir.y,Ir.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Ir.fromBufferAttribute(this,t),Ir.applyNormalMatrix(e),this.setXYZ(t,Ir.x,Ir.y,Ir.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Ir.fromBufferAttribute(this,t),Ir.transformDirection(e),this.setXYZ(t,Ir.x,Ir.y,Ir.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,n){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new En(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new gl(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class PS extends Ai{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ce(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Eh;const np=new C,Rh=new C,Ah=new C,Dh=new te,ip=new te,qO=new st,iv=new C,rp=new C,rv=new C,ZO=new te,IS=new te,YO=new te;class QO extends gn{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",void 0===Eh){Eh=new wt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new tp(t,5);Eh.setIndex([0,1,2,0,2,3]),Eh.setAttribute("position",new gl(n,3,0,!1)),Eh.setAttribute("uv",new gl(n,2,3,!1))}this.geometry=Eh,this.material=void 0!==e?e:new PS,this.center=new te(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Rh.setFromMatrixScale(this.matrixWorld),qO.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Ah.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Rh.multiplyScalar(-Ah.z);const n=this.material.rotation;let r,s;0!==n&&(s=Math.cos(n),r=Math.sin(n));const o=this.center;sv(iv.set(-.5,-.5,0),Ah,o,Rh,r,s),sv(rp.set(.5,-.5,0),Ah,o,Rh,r,s),sv(rv.set(.5,.5,0),Ah,o,Rh,r,s),ZO.set(0,0),IS.set(1,0),YO.set(1,1);let a=e.ray.intersectTriangle(iv,rp,rv,!1,np);if(null===a&&(sv(rp.set(-.5,.5,0),Ah,o,Rh,r,s),IS.set(0,1),a=e.ray.intersectTriangle(iv,rv,rp,!1,np),null===a))return;const l=e.ray.origin.distanceTo(np);l<e.near||l>e.far||t.push({distance:l,point:np.clone(),uv:hs.getUV(np,iv,rp,rv,ZO,IS,YO,new te),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function sv(i,e,t,n,r,s){Dh.subVectors(i,t).addScalar(.5).multiply(n),void 0!==r?(ip.x=s*Dh.x-r*Dh.y,ip.y=r*Dh.x+s*Dh.y):ip.copy(Dh),i.copy(e),i.x+=ip.x,i.y+=ip.y,i.applyMatrix4(qO)}const ov=new C,$O=new C;class JO extends gn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const s=t[n];this.addLevel(s.object.clone(),s.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);const n=this.levels;let r;for(r=0;r<n.length&&!(t<n[r].distance);r++);return n.splice(r,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){ov.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(ov);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){ov.setFromMatrixPosition(e.matrixWorld),$O.setFromMatrixPosition(this.matrixWorld);const n=ov.distanceTo($O)/e.zoom;let r,s;for(t[0].object.visible=!0,r=1,s=t.length;r<s&&n>=t[r].distance;r++)t[r-1].object.visible=!1,t[r].object.visible=!0;for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,s=n.length;r<s;r++){const o=n[r];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}const ek=new C,tk=new dn,nk=new dn,ste=new C,ik=new st;class FS extends Ke{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new st,this.bindMatrixInverse=new st}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new dn,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,r=this.geometry;tk.fromBufferAttribute(r.attributes.skinIndex,e),nk.fromBufferAttribute(r.attributes.skinWeight,e),ek.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=nk.getComponent(s);if(0!==o){const a=tk.getComponent(s);ik.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(ste.copy(ek).applyMatrix4(ik),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class av extends gn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Dc extends mr{constructor(e=null,t=1,n=1,r,s,o,a,l,c=bi,u=bi,h,d){super(null,o,a,l,c,u,r,s,h,d),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const rk=new st,ote=new st;class sp{constructor(e=[],t=[]){this.uuid=cs(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new st)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new st;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)rk.multiplyMatrices(e[s]?e[s].matrixWorld:ote,t[s]),rk.toArray(n,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new sp(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=tO(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Dc(t,e,e,fr,Wr);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const s=e.bones[n];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new av),this.bones.push(o),this.boneInverses.push((new st).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(n[r].toArray());return e}}class Ph extends En{constructor(e,t,n,r=1){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const sk=new st,ok=new st,lv=[],op=new Ke;class LS extends Ke{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Ph(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,r=this.count;if(op.geometry=this.geometry,op.material=this.material,void 0!==op.material)for(let s=0;s<r;s++){this.getMatrixAt(s,sk),ok.multiplyMatrices(n,sk),op.matrixWorld=ok,op.raycast(e,lv);for(let o=0,a=lv.length;o<a;o++){const l=lv[o];l.instanceId=s,l.object=this,t.push(l)}lv.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Ph(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Pi extends Ai{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ce(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const ak=new C,lk=new C,ck=new st,OS=new qf,cv=new xa;class wi extends gn{constructor(e=new wt,t=new Pi){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)ak.fromBufferAttribute(t,r-1),lk.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=ak.distanceTo(lk);e.setAttribute("lineDistance",new $e(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),cv.copy(n.boundingSphere),cv.applyMatrix4(r),cv.radius+=s,!1===e.ray.intersectsSphere(cv))return;ck.copy(r).invert(),OS.copy(e.ray).applyMatrix4(ck);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new C,u=new C,h=new C,d=new C,f=this.isLineSegments?2:1,p=n.index,g=n.attributes.position;if(null!==p)for(let y=Math.max(0,o.start),b=Math.min(p.count,o.start+o.count)-1;y<b;y+=f){const w=p.getX(y),M=p.getX(y+1);if(c.fromBufferAttribute(g,w),u.fromBufferAttribute(g,M),OS.distanceSqToSegment(c,u,d,h)>l)continue;d.applyMatrix4(this.matrixWorld);const x=e.ray.origin.distanceTo(d);x<e.near||x>e.far||t.push({distance:x,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(let y=Math.max(0,o.start),b=Math.min(g.count,o.start+o.count)-1;y<b;y+=f){if(c.fromBufferAttribute(g,y),u.fromBufferAttribute(g,y+1),OS.distanceSqToSegment(c,u,d,h)>l)continue;d.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(d);M<e.near||M>e.far||t.push({distance:M,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const uk=new C,hk=new C;class As extends wi{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)uk.fromBufferAttribute(t,r),hk.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+uk.distanceTo(hk);e.setAttribute("lineDistance",new $e(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class kS extends wi{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class uv extends Ai{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ce(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const dk=new st,NS=new qf,hv=new xa,dv=new C;class BS extends gn{constructor(e=new wt,t=new uv){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),hv.copy(n.boundingSphere),hv.applyMatrix4(r),hv.radius+=s,!1===e.ray.intersectsSphere(hv))return;dk.copy(r).invert(),NS.copy(e.ray).applyMatrix4(dk);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=n.index,h=n.attributes.position;if(null!==c)for(let p=Math.max(0,o.start),m=Math.min(c.count,o.start+o.count);p<m;p++){const g=c.getX(p);dv.fromBufferAttribute(h,g),fk(dv,g,l,r,e,t,this)}else for(let p=Math.max(0,o.start),m=Math.min(h.count,o.start+o.count);p<m;p++)dv.fromBufferAttribute(h,p),fk(dv,p,l,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function fk(i,e,t,n,r,s,o){const a=NS.distanceSqToPoint(i);if(a<t){const l=new C;NS.closestPointToPoint(i,l),l.applyMatrix4(n);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class ate extends mr{constructor(e,t,n,r,s,o,a,l,c){super(e,t,n,r,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=void 0!==o?o:si,this.magFilter=void 0!==s?s:si,this.generateMipmaps=!1;const u=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function h(){u.needsUpdate=!0,e.requestVideoFrameCallback(h)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e==0&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class lte extends mr{constructor(e,t,n){super({width:e,height:t}),this.isFramebufferTexture=!0,this.format=n,this.magFilter=bi,this.minFilter=bi,this.generateMipmaps=!1,this.needsUpdate=!0}}class pk extends mr{constructor(e,t,n,r,s,o,a,l,c,u,h,d){super(null,o,a,l,c,u,r,s,h,d),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class US extends mr{constructor(e,t,n,r,s,o,a,l,c){super(e,t,n,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class po{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let r=0;const s=n.length;let o;o=t||e*n[s-1];let c,a=0,l=s-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=n[r]-o,c<0)a=r+1;else{if(!(c>0)){l=r;break}l=r-1}if(r=l,n[r]===o)return r/(s-1);const u=n[r];return(r+(o-u)/(n[r+1]-u))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new te:new C);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new C,r=[],s=[],o=[],a=new C,l=new st;for(let f=0;f<=e;f++)r[f]=this.getTangentAt(f/e,new C);s[0]=new C,o[0]=new C;let c=Number.MAX_VALUE;const u=Math.abs(r[0].x),h=Math.abs(r[0].y),d=Math.abs(r[0].z);u<=c&&(c=u,n.set(1,0,0)),h<=c&&(c=h,n.set(0,1,0)),d<=c&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(xi(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(a,p))}o[f].crossVectors(r[f],s[f])}if(!0===t){let f=Math.acos(xi(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(r[p],f*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class _l extends po{constructor(e=0,t=0,n=1,r=1,s=0,o=2*Math.PI,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const n=t||new te,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=o?0:r),!0===this.aClockwise&&!o&&(s===r?s=-r:s-=r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const u=Math.cos(this.aRotation),h=Math.sin(this.aRotation),d=l-this.aX,f=c-this.aY;l=d*u-f*h+this.aX,c=d*h+f*u+this.aY}return n.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class mk extends _l{constructor(e,t,n,r,s,o){super(e,t,n,n,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function VS(){let i=0,e=0,t=0,n=0;function r(s,o,a,l){i=s,e=a,t=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,h){let d=(o-s)/c-(a-s)/(c+u)+(a-o)/u,f=(a-o)/u-(l-o)/(u+h)+(l-a)/h;d*=u,f*=u,r(o,a,d,f)},calc:function(s){const o=s*s;return i+e*s+t*o+n*(o*s)}}}const fv=new C,jS=new VS,zS=new VS,HS=new VS;class gk extends po{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new C){const n=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let c,u,a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:0===l&&a===s-1&&(a=s-2,l=1),this.closed||a>0?c=r[(a-1)%s]:(fv.subVectors(r[0],r[1]).add(r[0]),c=fv);const h=r[a%s],d=r[(a+1)%s];if(this.closed||a+2<s?u=r[(a+2)%s]:(fv.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=fv),"centripetal"===this.curveType||"chordal"===this.curveType){const f="chordal"===this.curveType?.5:.25;let p=Math.pow(c.distanceToSquared(h),f),m=Math.pow(h.distanceToSquared(d),f),g=Math.pow(d.distanceToSquared(u),f);m<1e-4&&(m=1),p<1e-4&&(p=m),g<1e-4&&(g=m),jS.initNonuniformCatmullRom(c.x,h.x,d.x,u.x,p,m,g),zS.initNonuniformCatmullRom(c.y,h.y,d.y,u.y,p,m,g),HS.initNonuniformCatmullRom(c.z,h.z,d.z,u.z,p,m,g)}else"catmullrom"===this.curveType&&(jS.initCatmullRom(c.x,h.x,d.x,u.x,this.tension),zS.initCatmullRom(c.y,h.y,d.y,u.y,this.tension),HS.initCatmullRom(c.z,h.z,d.z,u.z,this.tension));return n.set(jS.calc(l),zS.calc(l),HS.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push((new C).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function _k(i,e,t,n,r){const s=.5*(n-e),o=.5*(r-t),a=i*i;return(2*t-2*n+s+o)*(i*a)+(-3*t+3*n-2*s-o)*a+s*i+t}function ap(i,e,t,n){return function cte(i,e){const t=1-i;return t*t*e}(i,e)+function ute(i,e){return 2*(1-i)*i*e}(i,t)+function hte(i,e){return i*i*e}(i,n)}function lp(i,e,t,n,r){return function dte(i,e){const t=1-i;return t*t*t*e}(i,e)+function fte(i,e){const t=1-i;return 3*t*t*i*e}(i,t)+function pte(i,e){return 3*(1-i)*i*i*e}(i,n)+function mte(i,e){return i*i*i*e}(i,r)}class GS extends po{constructor(e=new te,t=new te,n=new te,r=new te){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new te){const n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(lp(e,r.x,s.x,o.x,a.x),lp(e,r.y,s.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class vk extends po{constructor(e=new C,t=new C,n=new C,r=new C){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new C){const n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(lp(e,r.x,s.x,o.x,a.x),lp(e,r.y,s.y,o.y,a.y),lp(e,r.z,s.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class pv extends po{constructor(e=new te,t=new te){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new te){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const n=t||new te;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class yk extends po{constructor(e=new C,t=new C){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new C){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class WS extends po{constructor(e=new te,t=new te,n=new te){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new te){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(ap(e,r.x,s.x,o.x),ap(e,r.y,s.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class XS extends po{constructor(e=new C,t=new C,n=new C){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new C){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(ap(e,r.x,s.x,o.x),ap(e,r.y,s.y,o.y),ap(e,r.z,s.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class KS extends po{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new te){const n=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[0===o?o:o-1],c=r[o],u=r[o>r.length-2?r.length-1:o+1],h=r[o>r.length-3?r.length-1:o+2];return n.set(_k(a,l.x,c.x,u.x,h.x),_k(a,l.y,c.y,u.y,h.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push((new te).fromArray(r))}return this}}var qS=Object.freeze({__proto__:null,ArcCurve:mk,CatmullRomCurve3:gk,CubicBezierCurve:GS,CubicBezierCurve3:vk,EllipseCurve:_l,LineCurve:pv,LineCurve3:yk,QuadraticBezierCurve:WS,QuadraticBezierCurve3:XS,SplineCurve:KS});class bk extends po{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new pv(t,e))}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const o=r[s]-n,a=this.curves[s],l=a.getLength();return a.getPointAt(0===l?0:1-o/l,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],l=o.getPoints(o.isEllipseCurve?2*e:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e);for(let c=0;c<l.length;c++){const u=l[c];n&&n.equals(u)||(t.push(u),n=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push((new qS[r.type]).fromJSON(r))}return this}}class cp extends bk{constructor(e){super(),this.type="Path",this.currentPoint=new te,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new pv(this.currentPoint.clone(),new te(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const s=new WS(this.currentPoint.clone(),new te(e,t),new te(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,s,o){const a=new GS(this.currentPoint.clone(),new te(e,t),new te(n,r),new te(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new KS(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,s,o){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,n,r,s,o),this}absarc(e,t,n,r,s,o){return this.absellipse(e,t,n,n,r,s,o),this}ellipse(e,t,n,r,s,o,a,l){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,n,r,s,o,a,l),this}absellipse(e,t,n,r,s,o,a,l){const c=new _l(e,t,n,r,s,o,a,l);if(this.curves.length>0){const h=c.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Pc extends wt{constructor(e=[new te(0,.5),new te(.5,0),new te(0,-.5)],t=12,n=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=xi(r,0,2*Math.PI);const s=[],o=[],a=[],l=[],c=[],u=1/t,h=new C,d=new te,f=new C,p=new C,m=new C;let g=0,_=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:g=e[v+1].x-e[v].x,_=e[v+1].y-e[v].y,f.x=1*_,f.y=-g,f.z=0*_,m.copy(f),f.normalize(),l.push(f.x,f.y,f.z);break;case e.length-1:l.push(m.x,m.y,m.z);break;default:g=e[v+1].x-e[v].x,_=e[v+1].y-e[v].y,f.x=1*_,f.y=-g,f.z=0*_,p.copy(f),f.x+=m.x,f.y+=m.y,f.z+=m.z,f.normalize(),l.push(f.x,f.y,f.z),m.copy(p)}for(let v=0;v<=t;v++){const y=n+v*u*r,b=Math.sin(y),w=Math.cos(y);for(let M=0;M<=e.length-1;M++)h.x=e[M].x*b,h.y=e[M].y,h.z=e[M].x*w,o.push(h.x,h.y,h.z),d.x=v/t,d.y=M/(e.length-1),a.push(d.x,d.y),c.push(l[3*M+0]*b,l[3*M+1],l[3*M+0]*w)}for(let v=0;v<t;v++)for(let y=0;y<e.length-1;y++){const b=y+v*e.length,M=b+e.length,T=b+e.length+1,x=b+1;s.push(b,M,x),s.push(T,x,M)}this.setIndex(s),this.setAttribute("position",new $e(o,3)),this.setAttribute("uv",new $e(a,2)),this.setAttribute("normal",new $e(c,3))}static fromJSON(e){return new Pc(e.points,e.segments,e.phiStart,e.phiLength)}}class Ih extends Pc{constructor(e=1,t=1,n=4,r=8){const s=new cp;s.absarc(0,-t/2,e,1.5*Math.PI,0),s.absarc(0,t/2,e,0,.5*Math.PI),super(s.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r}}static fromJSON(e){return new Ih(e.radius,e.length,e.capSegments,e.radialSegments)}}class Fh extends wt{constructor(e=1,t=8,n=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],l=[],c=new C,u=new te;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let h=0,d=3;h<=t;h++,d+=3){const f=n+h/t*r;c.x=e*Math.cos(f),c.y=e*Math.sin(f),o.push(c.x,c.y,c.z),a.push(0,0,1),u.x=(o[d]/e+1)/2,u.y=(o[d+1]/e+1)/2,l.push(u.x,u.y)}for(let h=1;h<=t;h++)s.push(h,h+1,0);this.setIndex(s),this.setAttribute("position",new $e(o,3)),this.setAttribute("normal",new $e(a,3)),this.setAttribute("uv",new $e(l,2))}static fromJSON(e){return new Fh(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class mi extends wt{constructor(e=1,t=1,n=1,r=8,s=1,o=!1,a=0,l=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const u=[],h=[],d=[],f=[];let p=0;const m=[],g=n/2;let _=0;function y(b){const w=p,M=new te,T=new C;let x=0;const E=!0===b?e:t,D=!0===b?1:-1;for(let z=1;z<=r;z++)h.push(0,g*D,0),d.push(0,D,0),f.push(.5,.5),p++;const L=p;for(let z=0;z<=r;z++){const U=z/r*l+a,X=Math.cos(U),I=Math.sin(U);T.x=E*I,T.y=g*D,T.z=E*X,h.push(T.x,T.y,T.z),d.push(0,D,0),M.x=.5*X+.5,M.y=.5*I*D+.5,f.push(M.x,M.y),p++}for(let z=0;z<r;z++){const H=w+z,U=L+z;!0===b?u.push(U,U+1,H):u.push(U+1,U,H),x+=3}c.addGroup(_,x,!0===b?1:2),_+=x}(function v(){const b=new C,w=new C;let M=0;const T=(t-e)/n;for(let x=0;x<=s;x++){const E=[],D=x/s,L=D*(t-e)+e;for(let z=0;z<=r;z++){const H=z/r,U=H*l+a,X=Math.sin(U),I=Math.cos(U);w.x=L*X,w.y=-D*n+g,w.z=L*I,h.push(w.x,w.y,w.z),b.set(X,T,I).normalize(),d.push(b.x,b.y,b.z),f.push(H,1-D),E.push(p++)}m.push(E)}for(let x=0;x<r;x++)for(let E=0;E<s;E++){const L=m[E+1][x],z=m[E+1][x+1],H=m[E][x+1];u.push(m[E][x],L,H),u.push(L,z,H),M+=6}c.addGroup(_,M,0),_+=M})(),!1===o&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(u),this.setAttribute("position",new $e(h,3)),this.setAttribute("normal",new $e(d,3)),this.setAttribute("uv",new $e(f,2))}static fromJSON(e){return new mi(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Lh extends mi{constructor(e=1,t=1,n=8,r=1,s=!1,o=0,a=2*Math.PI){super(0,e,t,n,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new Lh(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class mo extends wt{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const s=[],o=[];function l(v,y,b,w){const M=w+1,T=[];for(let x=0;x<=M;x++){T[x]=[];const E=v.clone().lerp(b,x/M),D=y.clone().lerp(b,x/M),L=M-x;for(let z=0;z<=L;z++)T[x][z]=0===z&&x===M?E:E.clone().lerp(D,z/L)}for(let x=0;x<M;x++)for(let E=0;E<2*(M-x)-1;E++){const D=Math.floor(E/2);E%2==0?(d(T[x][D+1]),d(T[x+1][D]),d(T[x][D])):(d(T[x][D+1]),d(T[x+1][D+1]),d(T[x+1][D]))}}function d(v){s.push(v.x,v.y,v.z)}function f(v,y){const b=3*v;y.x=e[b+0],y.y=e[b+1],y.z=e[b+2]}function m(v,y,b,w){w<0&&1===v.x&&(o[y]=v.x-1),0===b.x&&0===b.z&&(o[y]=w/2/Math.PI+.5)}function g(v){return Math.atan2(v.z,-v.x)}function _(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}(function a(v){const y=new C,b=new C,w=new C;for(let M=0;M<t.length;M+=3)f(t[M+0],y),f(t[M+1],b),f(t[M+2],w),l(y,b,w,v)})(r),function c(v){const y=new C;for(let b=0;b<s.length;b+=3)y.x=s[b+0],y.y=s[b+1],y.z=s[b+2],y.normalize().multiplyScalar(v),s[b+0]=y.x,s[b+1]=y.y,s[b+2]=y.z}(n),function u(){const v=new C;for(let y=0;y<s.length;y+=3){v.x=s[y+0],v.y=s[y+1],v.z=s[y+2];const b=g(v)/2/Math.PI+.5,w=_(v)/Math.PI+.5;o.push(b,1-w)}(function p(){const v=new C,y=new C,b=new C,w=new C,M=new te,T=new te,x=new te;for(let E=0,D=0;E<s.length;E+=9,D+=6){v.set(s[E+0],s[E+1],s[E+2]),y.set(s[E+3],s[E+4],s[E+5]),b.set(s[E+6],s[E+7],s[E+8]),M.set(o[D+0],o[D+1]),T.set(o[D+2],o[D+3]),x.set(o[D+4],o[D+5]),w.copy(v).add(y).add(b).divideScalar(3);const L=g(w);m(M,D+0,v,L),m(T,D+2,y,L),m(x,D+4,b,L)}})(),function h(){for(let v=0;v<o.length;v+=6){const y=o[v+0],b=o[v+2],w=o[v+4],M=Math.max(y,b,w),T=Math.min(y,b,w);M>.9&&T<.1&&(y<.2&&(o[v+0]+=1),b<.2&&(o[v+2]+=1),w<.2&&(o[v+4]+=1))}}()}(),this.setAttribute("position",new $e(s,3)),this.setAttribute("normal",new $e(s.slice(),3)),this.setAttribute("uv",new $e(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new mo(e.vertices,e.indices,e.radius,e.details)}}class Oh extends mo{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Oh(e.radius,e.detail)}}const mv=new C,gv=new C,ZS=new C,_v=new hs;class xk extends wt{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const r=Math.pow(10,4),s=Math.cos(xc*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],u=["a","b","c"],h=new Array(3),d={},f=[];for(let p=0;p<l;p+=3){o?(c[0]=o.getX(p),c[1]=o.getX(p+1),c[2]=o.getX(p+2)):(c[0]=p,c[1]=p+1,c[2]=p+2);const{a:m,b:g,c:_}=_v;if(m.fromBufferAttribute(a,c[0]),g.fromBufferAttribute(a,c[1]),_.fromBufferAttribute(a,c[2]),_v.getNormal(ZS),h[0]=`${Math.round(m.x*r)},${Math.round(m.y*r)},${Math.round(m.z*r)}`,h[1]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,h[2]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,h[0]!==h[1]&&h[1]!==h[2]&&h[2]!==h[0])for(let v=0;v<3;v++){const y=(v+1)%3,b=h[v],w=h[y],M=_v[u[v]],T=_v[u[y]],x=`${b}_${w}`,E=`${w}_${b}`;E in d&&d[E]?(ZS.dot(d[E].normal)<=s&&(f.push(M.x,M.y,M.z),f.push(T.x,T.y,T.z)),d[E]=null):x in d||(d[x]={index0:c[v],index1:c[y],normal:ZS.clone()})}}for(const p in d)if(d[p]){const{index0:m,index1:g}=d[p];mv.fromBufferAttribute(a,m),gv.fromBufferAttribute(a,g),f.push(mv.x,mv.y,mv.z),f.push(gv.x,gv.y,gv.z)}this.setAttribute("position",new $e(f,3))}}}class Ic extends cp{constructor(e){super(e),this.uuid=cs(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push((new cp).fromJSON(r))}return this}}function wk(i,e,t,n,r){let s,o;if(r===function Ite(i,e,t,n){let r=0;for(let s=e,o=t-n;s<t;s+=n)r+=(i[o]-i[s])*(i[s+1]+i[o+1]),o=s;return r}(i,e,t,n)>0)for(s=e;s<t;s+=n)o=Tk(s,i[s],i[s+1],o);else for(s=t-n;s>=e;s-=n)o=Tk(s,i[s],i[s+1],o);return o&&vv(o,o.next)&&(dp(o),o=o.next),o}function vl(i,e){if(!i)return i;e||(e=i);let n,t=i;do{if(n=!1,t.steiner||!vv(t,t.next)&&0!==oi(t.prev,t,t.next))t=t.next;else{if(dp(t),t=e=t.prev,t===t.next)break;n=!0}}while(n||t!==e);return e}function up(i,e,t,n,r,s,o){if(!i)return;!o&&s&&function Cte(i,e,t,n){let r=i;do{null===r.z&&(r.z=YS(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,function Ete(i){let e,t,n,r,s,o,a,l,c=1;do{for(t=i,i=null,s=null,o=0;t;){for(o++,n=t,a=0,e=0;e<c&&(a++,n=n.nextZ,n);e++);for(l=c;a>0||l>0&&n;)0!==a&&(0===l||!n||t.z<=n.z)?(r=t,t=t.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;t=n}s.nextZ=null,c*=2}while(o>1)}(r)}(i,n,r,s);let l,c,a=i;for(;i.prev!==i.next;)if(l=i.prev,c=i.next,s?vte(i,n,r,s):_te(i))e.push(l.i/t),e.push(i.i/t),e.push(c.i/t),dp(i),i=c.next,a=c.next;else if((i=c)===a){o?1===o?up(i=yte(vl(i),e,t),e,t,n,r,s,2):2===o&&bte(i,e,t,n,r,s):up(vl(i),e,t,n,r,s,1);break}}function _te(i){const e=i.prev,t=i,n=i.next;if(oi(e,t,n)>=0)return!1;let r=i.next.next;for(;r!==i.prev;){if(kh(e.x,e.y,t.x,t.y,n.x,n.y,r.x,r.y)&&oi(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function vte(i,e,t,n){const r=i.prev,s=i,o=i.next;if(oi(r,s,o)>=0)return!1;const c=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,u=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,h=YS(r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,e,t,n),d=YS(c,u,e,t,n);let f=i.prevZ,p=i.nextZ;for(;f&&f.z>=h&&p&&p.z<=d;){if(f!==i.prev&&f!==i.next&&kh(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&oi(f.prev,f,f.next)>=0||(f=f.prevZ,p!==i.prev&&p!==i.next&&kh(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&oi(p.prev,p,p.next)>=0))return!1;p=p.nextZ}for(;f&&f.z>=h;){if(f!==i.prev&&f!==i.next&&kh(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&oi(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==i.prev&&p!==i.next&&kh(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&oi(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function yte(i,e,t){let n=i;do{const r=n.prev,s=n.next.next;!vv(r,s)&&Mk(r,n,n.next,s)&&hp(r,s)&&hp(s,r)&&(e.push(r.i/t),e.push(n.i/t),e.push(s.i/t),dp(n),dp(n.next),n=i=s),n=n.next}while(n!==i);return vl(n)}function bte(i,e,t,n,r,s){let o=i;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Ate(o,a)){let l=Sk(o,a);return o=vl(o,o.next),l=vl(l,l.next),up(o,e,t,n,r,s),void up(l,e,t,n,r,s)}a=a.next}o=o.next}while(o!==i)}function wte(i,e){return i.x-e.x}function Mte(i,e){if(e=function Ste(i,e){let t=e;const n=i.x,r=i.y;let o,s=-1/0;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const d=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=n&&d>s){if(s=d,d===n){if(r===t.y)return t;if(r===t.next.y)return t.next}o=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!o)return null;if(n===s)return o;const a=o,l=o.x,c=o.y;let h,u=1/0;t=o;do{n>=t.x&&t.x>=l&&n!==t.x&&kh(r<c?n:s,r,l,c,r<c?s:n,r,t.x,t.y)&&(h=Math.abs(r-t.y)/(n-t.x),hp(t,i)&&(h<u||h===u&&(t.x>o.x||t.x===o.x&&Tte(o,t)))&&(o=t,u=h)),t=t.next}while(t!==a);return o}(i,e),e){const t=Sk(e,i);vl(e,e.next),vl(t,t.next)}}function Tte(i,e){return oi(i.prev,i,e.prev)<0&&oi(e.next,i,i.next)<0}function YS(i,e,t,n,r){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-t)*r)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Rte(i){let e=i,t=i;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==i);return t}function kh(i,e,t,n,r,s,o,a){return(r-o)*(e-a)-(i-o)*(s-a)>=0&&(i-o)*(n-a)-(t-o)*(e-a)>=0&&(t-o)*(s-a)-(r-o)*(n-a)>=0}function Ate(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function Dte(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&Mk(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}(i,e)&&(hp(i,e)&&hp(e,i)&&function Pte(i,e){let t=i,n=!1;const r=(i.x+e.x)/2,s=(i.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next}while(t!==i);return n}(i,e)&&(oi(i.prev,i,e.prev)||oi(i,e.prev,e))||vv(i,e)&&oi(i.prev,i,i.next)>0&&oi(e.prev,e,e.next)>0)}function oi(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function vv(i,e){return i.x===e.x&&i.y===e.y}function Mk(i,e,t,n){const r=bv(oi(i,e,t)),s=bv(oi(i,e,n)),o=bv(oi(t,n,i)),a=bv(oi(t,n,e));return!!(r!==s&&o!==a||0===r&&yv(i,t,e)||0===s&&yv(i,n,e)||0===o&&yv(t,i,n)||0===a&&yv(t,e,n))}function yv(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function bv(i){return i>0?1:i<0?-1:0}function hp(i,e){return oi(i.prev,i,i.next)<0?oi(i,e,i.next)>=0&&oi(i,i.prev,e)>=0:oi(i,e,i.prev)<0||oi(i,i.next,e)<0}function Sk(i,e){const t=new QS(i.i,i.x,i.y),n=new QS(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function Tk(i,e,t,n){const r=new QS(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function dp(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function QS(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Ko{static area(e){const t=e.length;let n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*n}static isClockWise(e){return Ko.area(e)<0}static triangulateShape(e,t){const n=[],r=[],s=[];Ck(e),Ek(n,e);let o=e.length;t.forEach(Ck);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,Ek(n,t[l]);const a=function(i,e,t=2){const n=e&&e.length,r=n?e[0]*t:i.length;let s=wk(i,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,h,d,f;if(n&&(s=function xte(i,e,t,n){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:i.length,c=wk(i,a,l,n,!1),c===c.next&&(c.steiner=!0),r.push(Rte(c));for(r.sort(wte),s=0;s<r.length;s++)Mte(r[s],t),t=vl(t,t.next);return t}(i,e,s,t)),i.length>80*t){a=c=i[0],l=u=i[1];for(let p=t;p<r;p+=t)h=i[p],d=i[p+1],h<a&&(a=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);f=Math.max(c-a,u-l),f=0!==f?1/f:0}return up(s,o,t,a,l,f),o}(n,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function Ck(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function Ek(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class Nh extends wt{constructor(e=new Ic([new te(.5,.5),new te(-.5,.5),new te(-.5,-.5),new te(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++)o(e[a]);function o(a){const l=[],c=void 0!==t.curveSegments?t.curveSegments:12,u=void 0!==t.steps?t.steps:1;let h=void 0!==t.depth?t.depth:1,d=void 0===t.bevelEnabled||t.bevelEnabled,f=void 0!==t.bevelThickness?t.bevelThickness:.2,p=void 0!==t.bevelSize?t.bevelSize:f-.1,m=void 0!==t.bevelOffset?t.bevelOffset:0,g=void 0!==t.bevelSegments?t.bevelSegments:3;const _=t.extrudePath,v=void 0!==t.UVGenerator?t.UVGenerator:Fte;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),h=t.amount);let y,w,M,T,x,b=!1;_&&(y=_.getSpacedPoints(u),b=!0,d=!1,w=_.computeFrenetFrames(u,!1),M=new C,T=new C,x=new C),d||(g=0,f=0,p=0,m=0);const E=a.extractPoints(c);let D=E.shape;const L=E.holes;if(!Ko.isClockWise(D)){D=D.reverse();for(let ue=0,de=L.length;ue<de;ue++){const Me=L[ue];Ko.isClockWise(Me)&&(L[ue]=Me.reverse())}}const H=Ko.triangulateShape(D,L),U=D;for(let ue=0,de=L.length;ue<de;ue++)D=D.concat(L[ue]);function X(ue,de,Me){return de||console.error("THREE.ExtrudeGeometry: vec does not exist"),de.clone().multiplyScalar(Me).add(ue)}const I=D.length,V=H.length;function W(ue,de,Me){let Je,Ge,bt;const mt=ue.x-de.x,dt=ue.y-de.y,Jt=Me.x-ue.x,Wt=Me.y-ue.y,B=mt*mt+dt*dt;if(Math.abs(mt*Wt-dt*Jt)>Number.EPSILON){const ae=Math.sqrt(B),xe=Math.sqrt(Jt*Jt+Wt*Wt),Pe=de.x-dt/ae,Ve=de.y+mt/ae,le=((Me.x-Wt/xe-Pe)*Wt-(Me.y+Jt/xe-Ve)*Jt)/(mt*Wt-dt*Jt);Je=Pe+mt*le-ue.x,Ge=Ve+dt*le-ue.y;const Ne=Je*Je+Ge*Ge;if(Ne<=2)return new te(Je,Ge);bt=Math.sqrt(Ne/2)}else{let ae=!1;mt>Number.EPSILON?Jt>Number.EPSILON&&(ae=!0):mt<-Number.EPSILON?Jt<-Number.EPSILON&&(ae=!0):Math.sign(dt)===Math.sign(Wt)&&(ae=!0),ae?(Je=-dt,Ge=mt,bt=Math.sqrt(B)):(Je=mt,Ge=dt,bt=Math.sqrt(B/2))}return new te(Je/bt,Ge/bt)}const j=[];for(let ue=0,de=U.length,Me=de-1,Je=ue+1;ue<de;ue++,Me++,Je++)Me===de&&(Me=0),Je===de&&(Je=0),j[ue]=W(U[ue],U[Me],U[Je]);const q=[];let oe,J=j.concat();for(let ue=0,de=L.length;ue<de;ue++){const Me=L[ue];oe=[];for(let Je=0,Ge=Me.length,bt=Ge-1,mt=Je+1;Je<Ge;Je++,bt++,mt++)bt===Ge&&(bt=0),mt===Ge&&(mt=0),oe[Je]=W(Me[Je],Me[bt],Me[mt]);q.push(oe),J=J.concat(oe)}for(let ue=0;ue<g;ue++){const de=ue/g,Me=f*Math.cos(de*Math.PI/2),Je=p*Math.sin(de*Math.PI/2)+m;for(let Ge=0,bt=U.length;Ge<bt;Ge++){const mt=X(U[Ge],j[Ge],Je);K(mt.x,mt.y,-Me)}for(let Ge=0,bt=L.length;Ge<bt;Ge++){const mt=L[Ge];oe=q[Ge];for(let dt=0,Jt=mt.length;dt<Jt;dt++){const Wt=X(mt[dt],oe[dt],Je);K(Wt.x,Wt.y,-Me)}}}const fe=p+m;for(let ue=0;ue<I;ue++){const de=d?X(D[ue],J[ue],fe):D[ue];b?(T.copy(w.normals[0]).multiplyScalar(de.x),M.copy(w.binormals[0]).multiplyScalar(de.y),x.copy(y[0]).add(T).add(M),K(x.x,x.y,x.z)):K(de.x,de.y,0)}for(let ue=1;ue<=u;ue++)for(let de=0;de<I;de++){const Me=d?X(D[de],J[de],fe):D[de];b?(T.copy(w.normals[ue]).multiplyScalar(Me.x),M.copy(w.binormals[ue]).multiplyScalar(Me.y),x.copy(y[ue]).add(T).add(M),K(x.x,x.y,x.z)):K(Me.x,Me.y,h/u*ue)}for(let ue=g-1;ue>=0;ue--){const de=ue/g,Me=f*Math.cos(de*Math.PI/2),Je=p*Math.sin(de*Math.PI/2)+m;for(let Ge=0,bt=U.length;Ge<bt;Ge++){const mt=X(U[Ge],j[Ge],Je);K(mt.x,mt.y,h+Me)}for(let Ge=0,bt=L.length;Ge<bt;Ge++){const mt=L[Ge];oe=q[Ge];for(let dt=0,Jt=mt.length;dt<Jt;dt++){const Wt=X(mt[dt],oe[dt],Je);b?K(Wt.x,Wt.y+y[u-1].y,y[u-1].x+Me):K(Wt.x,Wt.y,h+Me)}}}function $(ue,de){let Me=ue.length;for(;--Me>=0;){const Je=Me;let Ge=Me-1;Ge<0&&(Ge=ue.length-1);for(let bt=0,mt=u+2*g;bt<mt;bt++){const dt=I*bt,Jt=I*(bt+1);Fe(de+Je+dt,de+Ge+dt,de+Ge+Jt,de+Je+Jt)}}}function K(ue,de,Me){l.push(ue),l.push(de),l.push(Me)}function pe(ue,de,Me){_e(ue),_e(de),_e(Me);const Je=r.length/3,Ge=v.generateTopUV(n,r,Je-3,Je-2,Je-1);ot(Ge[0]),ot(Ge[1]),ot(Ge[2])}function Fe(ue,de,Me,Je){_e(ue),_e(de),_e(Je),_e(de),_e(Me),_e(Je);const Ge=r.length/3,bt=v.generateSideWallUV(n,r,Ge-6,Ge-3,Ge-2,Ge-1);ot(bt[0]),ot(bt[1]),ot(bt[3]),ot(bt[1]),ot(bt[2]),ot(bt[3])}function _e(ue){r.push(l[3*ue+0]),r.push(l[3*ue+1]),r.push(l[3*ue+2])}function ot(ue){s.push(ue.x),s.push(ue.y)}(function he(){const ue=r.length/3;if(d){let de=0,Me=I*de;for(let Je=0;Je<V;Je++){const Ge=H[Je];pe(Ge[2]+Me,Ge[1]+Me,Ge[0]+Me)}de=u+2*g,Me=I*de;for(let Je=0;Je<V;Je++){const Ge=H[Je];pe(Ge[0]+Me,Ge[1]+Me,Ge[2]+Me)}}else{for(let de=0;de<V;de++){const Me=H[de];pe(Me[2],Me[1],Me[0])}for(let de=0;de<V;de++){const Me=H[de];pe(Me[0]+I*u,Me[1]+I*u,Me[2]+I*u)}}n.addGroup(ue,r.length/3-ue,0)})(),function Re(){const ue=r.length/3;let de=0;$(U,de),de+=U.length;for(let Me=0,Je=L.length;Me<Je;Me++){const Ge=L[Me];$(Ge,de),de+=Ge.length}n.addGroup(ue,r.length/3-ue,1)}()}this.setAttribute("position",new $e(r,3)),this.setAttribute("uv",new $e(s,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function Lte(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++)t.shapes.push(i[n].uuid);else t.shapes.push(i.uuid);return t.options=Object.assign({},e),void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let s=0,o=e.shapes.length;s<o;s++)n.push(t[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new qS[r.type]).fromJSON(r)),new Nh(n,e.options)}}const Fte={generateTopUV:function(i,e,t,n,r){const a=e[3*n],l=e[3*n+1],c=e[3*r],u=e[3*r+1];return[new te(e[3*t],e[3*t+1]),new te(a,l),new te(c,u)]},generateSideWallUV:function(i,e,t,n,r,s){const o=e[3*t],a=e[3*t+1],l=e[3*t+2],c=e[3*n],u=e[3*n+1],h=e[3*n+2],d=e[3*r],f=e[3*r+1],p=e[3*r+2],m=e[3*s],g=e[3*s+1],_=e[3*s+2];return Math.abs(a-u)<Math.abs(o-c)?[new te(o,1-l),new te(c,1-h),new te(d,1-p),new te(m,1-_)]:[new te(a,1-l),new te(u,1-h),new te(f,1-p),new te(g,1-_)]}};class Fc extends mo{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Fc(e.radius,e.detail)}}class go extends mo{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new go(e.radius,e.detail)}}class Bh extends wt{constructor(e=.5,t=1,n=8,r=1,s=0,o=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:o},n=Math.max(3,n);const a=[],l=[],c=[],u=[];let h=e;const d=(t-e)/(r=Math.max(1,r)),f=new C,p=new te;for(let m=0;m<=r;m++){for(let g=0;g<=n;g++){const _=s+g/n*o;f.x=h*Math.cos(_),f.y=h*Math.sin(_),l.push(f.x,f.y,f.z),c.push(0,0,1),p.x=(f.x/t+1)/2,p.y=(f.y/t+1)/2,u.push(p.x,p.y)}h+=d}for(let m=0;m<r;m++){const g=m*(n+1);for(let _=0;_<n;_++){const v=_+g,b=v+n+1,w=v+n+2,M=v+1;a.push(v,b,M),a.push(b,w,M)}}this.setIndex(a),this.setAttribute("position",new $e(l,3)),this.setAttribute("normal",new $e(c,3)),this.setAttribute("uv",new $e(u,2))}static fromJSON(e){return new Bh(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Uh extends wt{constructor(e=new Ic([new te(0,.5),new te(-.5,-.5),new te(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],s=[],o=[];let a=0,l=0;if(!1===Array.isArray(e))c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(a,l,u),a+=l,l=0;function c(u){const h=r.length/3,d=u.extractPoints(t);let f=d.shape;const p=d.holes;!1===Ko.isClockWise(f)&&(f=f.reverse());for(let g=0,_=p.length;g<_;g++){const v=p[g];!0===Ko.isClockWise(v)&&(p[g]=v.reverse())}const m=Ko.triangulateShape(f,p);for(let g=0,_=p.length;g<_;g++)f=f.concat(p[g]);for(let g=0,_=f.length;g<_;g++){const v=f[g];r.push(v.x,v.y,0),s.push(0,0,1),o.push(v.x,v.y)}for(let g=0,_=m.length;g<_;g++){const v=m[g];n.push(v[0]+h,v[1]+h,v[2]+h),l+=3}}this.setIndex(n),this.setAttribute("position",new $e(r,3)),this.setAttribute("normal",new $e(s,3)),this.setAttribute("uv",new $e(o,2))}toJSON(){const e=super.toJSON();return function Ote(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++)e.shapes.push(i[t].uuid);else e.shapes.push(i.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++)n.push(t[e.shapes[r]]);return new Uh(n,e.curveSegments)}}class Ea extends wt{constructor(e=1,t=32,n=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const l=Math.min(o+a,Math.PI);let c=0;const u=[],h=new C,d=new C,f=[],p=[],m=[],g=[];for(let _=0;_<=n;_++){const v=[],y=_/n;let b=0;0==_&&0==o?b=.5/t:_==n&&l==Math.PI&&(b=-.5/t);for(let w=0;w<=t;w++){const M=w/t;h.x=-e*Math.cos(r+M*s)*Math.sin(o+y*a),h.y=e*Math.cos(o+y*a),h.z=e*Math.sin(r+M*s)*Math.sin(o+y*a),p.push(h.x,h.y,h.z),d.copy(h).normalize(),m.push(d.x,d.y,d.z),g.push(M+b,1-y),v.push(c++)}u.push(v)}for(let _=0;_<n;_++)for(let v=0;v<t;v++){const y=u[_][v+1],b=u[_][v],w=u[_+1][v],M=u[_+1][v+1];(0!==_||o>0)&&f.push(y,b,M),(_!==n-1||l<Math.PI)&&f.push(b,w,M)}this.setIndex(f),this.setAttribute("position",new $e(p,3)),this.setAttribute("normal",new $e(m,3)),this.setAttribute("uv",new $e(g,2))}static fromJSON(e){return new Ea(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Vh extends mo{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Vh(e.radius,e.detail)}}class _o extends wt{constructor(e=1,t=.4,n=8,r=6,s=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:s},n=Math.floor(n),r=Math.floor(r);const o=[],a=[],l=[],c=[],u=new C,h=new C,d=new C;for(let f=0;f<=n;f++)for(let p=0;p<=r;p++){const m=p/r*s,g=f/n*Math.PI*2;h.x=(e+t*Math.cos(g))*Math.cos(m),h.y=(e+t*Math.cos(g))*Math.sin(m),h.z=t*Math.sin(g),a.push(h.x,h.y,h.z),u.x=e*Math.cos(m),u.y=e*Math.sin(m),d.subVectors(h,u).normalize(),l.push(d.x,d.y,d.z),c.push(p/r),c.push(f/n)}for(let f=1;f<=n;f++)for(let p=1;p<=r;p++){const g=(r+1)*(f-1)+p-1,_=(r+1)*(f-1)+p,v=(r+1)*f+p;o.push((r+1)*f+p-1,g,v),o.push(g,_,v)}this.setIndex(o),this.setAttribute("position",new $e(a,3)),this.setAttribute("normal",new $e(l,3)),this.setAttribute("uv",new $e(c,2))}static fromJSON(e){return new _o(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class jh extends wt{constructor(e=1,t=.4,n=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:s,q:o},n=Math.floor(n),r=Math.floor(r);const a=[],l=[],c=[],u=[],h=new C,d=new C,f=new C,p=new C,m=new C,g=new C,_=new C;for(let y=0;y<=n;++y){const b=y/n*s*Math.PI*2;v(b,s,o,e,f),v(b+.01,s,o,e,p),g.subVectors(p,f),_.addVectors(p,f),m.crossVectors(g,_),_.crossVectors(m,g),m.normalize(),_.normalize();for(let w=0;w<=r;++w){const M=w/r*Math.PI*2,T=-t*Math.cos(M),x=t*Math.sin(M);h.x=f.x+(T*_.x+x*m.x),h.y=f.y+(T*_.y+x*m.y),h.z=f.z+(T*_.z+x*m.z),l.push(h.x,h.y,h.z),d.subVectors(h,f).normalize(),c.push(d.x,d.y,d.z),u.push(y/n),u.push(w/r)}}for(let y=1;y<=n;y++)for(let b=1;b<=r;b++){const M=(r+1)*y+(b-1),T=(r+1)*y+b,x=(r+1)*(y-1)+b;a.push((r+1)*(y-1)+(b-1),M,x),a.push(M,T,x)}function v(y,b,w,M,T){const x=Math.cos(y),E=Math.sin(y),D=w/b*y,L=Math.cos(D);T.x=M*(2+L)*.5*x,T.y=M*(2+L)*E*.5,T.z=M*Math.sin(D)*.5}this.setIndex(a),this.setAttribute("position",new $e(l,3)),this.setAttribute("normal",new $e(c,3)),this.setAttribute("uv",new $e(u,2))}static fromJSON(e){return new jh(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class zh extends wt{constructor(e=new XS(new C(-1,-1,0),new C(-1,1,0),new C(1,1,0)),t=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new C,l=new C,c=new te;let u=new C;const h=[],d=[],f=[],p=[];function g(y){u=e.getPointAt(y/t,u);const b=o.normals[y],w=o.binormals[y];for(let M=0;M<=r;M++){const T=M/r*Math.PI*2,x=Math.sin(T),E=-Math.cos(T);l.x=E*b.x+x*w.x,l.y=E*b.y+x*w.y,l.z=E*b.z+x*w.z,l.normalize(),d.push(l.x,l.y,l.z),a.x=u.x+n*l.x,a.y=u.y+n*l.y,a.z=u.z+n*l.z,h.push(a.x,a.y,a.z)}}(function m(){for(let y=0;y<t;y++)g(y);g(!1===s?t:0),function v(){for(let y=0;y<=t;y++)for(let b=0;b<=r;b++)c.x=y/t,c.y=b/r,f.push(c.x,c.y)}(),function _(){for(let y=1;y<=t;y++)for(let b=1;b<=r;b++){const M=(r+1)*y+(b-1),T=(r+1)*y+b,x=(r+1)*(y-1)+b;p.push((r+1)*(y-1)+(b-1),M,x),p.push(M,T,x)}}()})(),this.setIndex(p),this.setAttribute("position",new $e(h,3)),this.setAttribute("normal",new $e(d,3)),this.setAttribute("uv",new $e(f,2))}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new zh((new qS[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Rk extends wt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,r=new C,s=new C;if(null!==e.index){const o=e.attributes.position,a=e.index;let l=e.groups;0===l.length&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const h=l[c],d=h.start;for(let p=d,m=d+h.count;p<m;p+=3)for(let g=0;g<3;g++){const _=a.getX(p+g),v=a.getX(p+(g+1)%3);r.fromBufferAttribute(o,_),s.fromBufferAttribute(o,v),!0===Ak(r,s,n)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const h=3*a+(c+1)%3;r.fromBufferAttribute(o,3*a+c),s.fromBufferAttribute(o,h),!0===Ak(r,s,n)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new $e(t,3))}}}function Ak(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return!0!==t.has(n)&&!0!==t.has(r)&&(t.add(n),t.add(r),!0)}var Dk=Object.freeze({__proto__:null,BoxGeometry:Xn,BoxBufferGeometry:Xn,CapsuleGeometry:Ih,CapsuleBufferGeometry:Ih,CircleGeometry:Fh,CircleBufferGeometry:Fh,ConeGeometry:Lh,ConeBufferGeometry:Lh,CylinderGeometry:mi,CylinderBufferGeometry:mi,DodecahedronGeometry:Oh,DodecahedronBufferGeometry:Oh,EdgesGeometry:xk,ExtrudeGeometry:Nh,ExtrudeBufferGeometry:Nh,IcosahedronGeometry:Fc,IcosahedronBufferGeometry:Fc,LatheGeometry:Pc,LatheBufferGeometry:Pc,OctahedronGeometry:go,OctahedronBufferGeometry:go,PlaneGeometry:Ca,PlaneBufferGeometry:Ca,PolyhedronGeometry:mo,PolyhedronBufferGeometry:mo,RingGeometry:Bh,RingBufferGeometry:Bh,ShapeGeometry:Uh,ShapeBufferGeometry:Uh,SphereGeometry:Ea,SphereBufferGeometry:Ea,TetrahedronGeometry:Vh,TetrahedronBufferGeometry:Vh,TorusGeometry:_o,TorusBufferGeometry:_o,TorusKnotGeometry:jh,TorusKnotBufferGeometry:jh,TubeGeometry:zh,TubeBufferGeometry:zh,WireframeGeometry:Rk});class Pk extends Ai{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ce(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class Ik extends Zn{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class vo extends Ai{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ce(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ce(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=al,this.normalScale=new te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Ra extends vo{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new te(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return xi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ce(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Ce(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ce(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class $S extends Ai{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ce(16777215),this.specular=new Ce(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ce(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=al,this.normalScale=new te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Nf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Fk extends Ai{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ce(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ce(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=al,this.normalScale=new te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Lk extends Ai{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=al,this.normalScale=new te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class Ok extends Ai{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ce(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ce(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Nf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class kk extends Ai{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ce(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=al,this.normalScale=new te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Nk extends Pi{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}const Yn={arraySlice:function(i,e,t){return Yn.isTypedArray(i)?new i.constructor(i.subarray(e,void 0!==t?t:i.length)):i.slice(e,t)},convertArray:function(i,e,t){return!i||!t&&i.constructor===e?i:"number"==typeof e.BYTES_PER_ELEMENT?new e(i):Array.prototype.slice.call(i)},isTypedArray:function(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)},getKeyframeOrder:function(i){const t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(function e(r,s){return i[r]-i[s]}),n},sortedArray:function(i,e,t){const n=i.length,r=new i.constructor(n);for(let s=0,o=0;o!==n;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=i[a+l]}return r},flattenJSON:function(i,e,t,n){let r=1,s=i[0];for(;void 0!==s&&void 0===s[n];)s=i[r++];if(void 0===s)return;let o=s[n];if(void 0!==o)if(Array.isArray(o))do{o=s[n],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=i[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[n],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=i[r++]}while(void 0!==s);else do{o=s[n],void 0!==o&&(e.push(s.time),t.push(o)),s=i[r++]}while(void 0!==s)},subclip:function(i,e,t,n,r=30){const s=i.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),h=[],d=[];for(let f=0;f<c.times.length;++f){const p=c.times[f]*r;if(!(p<t||p>=n)){h.push(c.times[f]);for(let m=0;m<u;++m)d.push(c.values[f*u+m])}}0!==h.length&&(c.times=Yn.convertArray(h,c.times.constructor),c.values=Yn.convertArray(d,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(i,e=0,t=i,n=30){n<=0&&(n=30);const r=t.tracks.length,s=e/n;for(let o=0;o<r;++o){const a=t.tracks[o],l=a.ValueTypeName;if("bool"===l||"string"===l)continue;const c=i.tracks.find(function(_){return _.name===a.name&&_.ValueTypeName===l});if(void 0===c)continue;let u=0;const h=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=h/3);let d=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=f/3);const p=a.times.length-1;let m;if(s<=a.times[0])m=Yn.arraySlice(a.values,u,h-u);else if(s>=a.times[p]){const _=p*h+u;m=Yn.arraySlice(a.values,_,_+h-u)}else{const _=a.createInterpolant(),v=u,y=h-u;_.evaluate(s),m=Yn.arraySlice(_.resultBuffer,v,y)}"quaternion"===l&&(new bn).fromArray(m).normalize().conjugate().toArray(m);const g=c.times.length;for(let _=0;_<g;++_){const v=_*f+d;if("quaternion"===l)bn.multiplyQuaternionsFlat(c.values,v,m,0,c.values,v);else{const y=f-2*d;for(let b=0;b<y;++b)c.values[v+b]-=m[b]}}}return i.blendMode=WM,i}};class Hh{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=n+2;;){if(void 0===r){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(s=r,r=t[++n],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(n=2,s=a);for(let l=n-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(r=s,s=t[--n-1],e>=s)break t}o=n,n=0}}for(;n<o;){const a=n+o>>>1;e<t[a]?o=a:n=a+1}if(r=t[n],s=t[n-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=n[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Bk extends Hh{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:yc,endingEnd:yc}}intervalChanged_(e,t,n){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case bc:s=e,a=2*t-n;break;case zf:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=n}if(void 0===l)switch(this.getSettings_().endingEnd){case bc:o=e,l=2*n-t;break;case zf:o=1,l=n+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(n-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-n),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(n-t)/(r-t),m=p*p,g=m*p,_=-d*g+2*d*m-d*p,v=(1+d)*g+(-1.5-2*d)*m+(-.5+d)*p+1,y=(-1-f)*g+(1.5+f)*m+.5*p,b=f*g-f*m;for(let w=0;w!==a;++w)s[w]=_*o[u+w]+v*o[c+w]+y*o[l+w]+b*o[h+w];return s}}class JS extends Hh{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(n-t)/(r-t),h=1-u;for(let d=0;d!==a;++d)s[d]=o[c+d]*h+o[l+d]*u;return s}}class Uk extends Hh{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class yo{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Yn.convertArray(t,this.TimeBufferType),this.values=Yn.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Yn.convertArray(e.times,Array),values:Yn.convertArray(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Uk(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new JS(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Bk(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case ah:t=this.InterpolantFactoryMethodDiscrete;break;case vc:t=this.InterpolantFactoryMethodLinear;break;case x_:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ah;case this.InterpolantFactoryMethodLinear:return vc;case this.InterpolantFactoryMethodSmooth:return x_}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let s=0,o=r-1;for(;s!==r&&n[s]<e;)++s;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Yn.arraySlice(n,s,o),this.values=Yn.arraySlice(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=n[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&Yn.isTypedArray(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=Yn.arraySlice(this.times),t=Yn.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===x_,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const h=a*n,d=h-n,f=h+n;for(let p=0;p!==n;++p){const m=t[h+p];if(m!==t[d+p]||m!==t[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const h=a*n,d=o*n;for(let f=0;f!==n;++f)t[d+f]=t[h+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*n,l=o*n,c=0;c!==n;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=Yn.arraySlice(e,0,o),this.values=Yn.arraySlice(t,0,o*n)):(this.times=e,this.values=t),this}clone(){const e=Yn.arraySlice(this.times,0),t=Yn.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}yo.prototype.TimeBufferType=Float32Array,yo.prototype.ValueBufferType=Float32Array,yo.prototype.DefaultInterpolation=vc;class Lc extends yo{}Lc.prototype.ValueTypeName="bool",Lc.prototype.ValueBufferType=Array,Lc.prototype.DefaultInterpolation=ah,Lc.prototype.InterpolantFactoryMethodLinear=void 0,Lc.prototype.InterpolantFactoryMethodSmooth=void 0;class eT extends yo{}eT.prototype.ValueTypeName="color";class Gh extends yo{}Gh.prototype.ValueTypeName="number";class Vk extends Hh{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(n-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)bn.slerpFlat(s,0,o,c-a,o,c,l);return s}}class yl extends yo{InterpolantFactoryMethodLinear(e){return new Vk(this.times,this.values,this.getValueSize(),e)}}yl.prototype.ValueTypeName="quaternion",yl.prototype.DefaultInterpolation=vc,yl.prototype.InterpolantFactoryMethodSmooth=void 0;class Oc extends yo{}Oc.prototype.ValueTypeName="string",Oc.prototype.ValueBufferType=Array,Oc.prototype.DefaultInterpolation=ah,Oc.prototype.InterpolantFactoryMethodLinear=void 0,Oc.prototype.InterpolantFactoryMethodSmooth=void 0;class Wh extends yo{}Wh.prototype.ValueTypeName="vector";class Xh{constructor(e,t=-1,n,r=w_){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=cs(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)t.push(Nte(n[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=n.length;s!==o;++s)t.push(yo.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=Yn.getKeyframeOrder(l);l=Yn.sortedArray(l,1,u),c=Yn.sortedArray(c,1,u),!r&&0===l[0]&&(l.push(s),c.push(c[0])),o.push(new Gh(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const h=u[1];let d=r[h];d||(r[h]=d=[]),d.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(h,d,f,p,m){if(0!==f.length){const g=[],_=[];Yn.flattenJSON(f,g,_,p),0!==g.length&&m.push(new h(d,g,_))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let h=0;h<c.length;h++){const d=c[h].keys;if(d&&0!==d.length)if(d[0].morphTargets){const f={};let p;for(p=0;p<d.length;p++)if(d[p].morphTargets)for(let m=0;m<d[p].morphTargets.length;m++)f[d[p].morphTargets[m]]=-1;for(const m in f){const g=[],_=[];for(let v=0;v!==d[p].morphTargets.length;++v){const y=d[p];g.push(y.time),_.push(y.morphTarget===m?1:0)}r.push(new Gh(".morphTargetInfluence["+m+"]",g,_))}l=f.length*o}else{const f=".bones["+t[h].name+"]";n(Wh,f+".position",d,"pos",r),n(yl,f+".quaternion",d,"rot",r),n(Wh,f+".scale",d,"scl",r)}}return 0===r.length?null:new this(s,l,r,a)}resetDuration(){let t=0;for(let n=0,r=this.tracks.length;n!==r;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Nte(i){if(void 0===i.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function kte(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Gh;case"vector":case"vector2":case"vector3":case"vector4":return Wh;case"color":return eT;case"quaternion":return yl;case"bool":case"boolean":return Lc;case"string":return Oc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}(i.type);if(void 0===i.times){const t=[],n=[];Yn.flattenJSON(i.keys,t,n,"value"),i.times=t,i.values=n}return void 0!==e.parse?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const kc={enabled:!1,files:{},add:function(i,e){!1!==this.enabled&&(this.files[i]=e)},get:function(i){if(!1!==this.enabled)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class tT{constructor(e,t,n){const r=this;let l,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(u){a++,!1===s&&void 0!==r.onStart&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,void 0!==r.onProgress&&r.onProgress(u,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,h){return c.push(u,h),this},this.removeHandler=function(u){const h=c.indexOf(u);return-1!==h&&c.splice(h,2),this},this.getHandler=function(u){for(let h=0,d=c.length;h<d;h+=2){const f=c[h],p=c[h+1];if(f.global&&(f.lastIndex=0),f.test(u))return p}return null}}}const jk=new tT;class Fr{constructor(e){this.manager=void 0!==e?e:jk,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,s){n.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Aa={};class Ds extends Fr{constructor(e){super(e)}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=kc.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==Aa[e])return void Aa[e].push({onLoad:t,onProgress:n,onError:r});Aa[e]=[],Aa[e].push({onLoad:t,onProgress:n,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===c.body||void 0===c.body.getReader)return c;const u=Aa[e],h=c.body.getReader(),d=c.headers.get("Content-Length"),f=d?parseInt(d):0,p=0!==f;let m=0;const g=new ReadableStream({start(_){!function v(){h.read().then(({done:y,value:b})=>{if(y)_.close();else{m+=b.byteLength;const w=new ProgressEvent("progress",{lengthComputable:p,loaded:m,total:f});for(let M=0,T=u.length;M<T;M++){const x=u[M];x.onProgress&&x.onProgress(w)}_.enqueue(b),v()}})}()}});return new Response(g)}throw Error(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>(new DOMParser).parseFromString(u,a));case"json":return c.json();default:if(void 0===a)return c.text();{const h=/charset="?([^;"\s]*)"?/i.exec(a),d=h&&h[1]?h[1].toLowerCase():void 0,f=new TextDecoder(d);return c.arrayBuffer().then(p=>f.decode(p))}}}).then(c=>{kc.add(e,c);const u=Aa[e];delete Aa[e];for(let h=0,d=u.length;h<d;h++){const f=u[h];f.onLoad&&f.onLoad(c)}}).catch(c=>{const u=Aa[e];if(void 0===u)throw this.manager.itemError(e),c;delete Aa[e];for(let h=0,d=u.length;h<d;h++){const f=u[h];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Bte extends Fr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new Ds(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=Xh.parse(e[n]);t.push(r)}return t}}class Ute extends Fr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=[],a=new pk,l=new Ds(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function u(h){l.load(e[h],function(d){const f=s.parse(d,!0);o[h]={width:f.width,height:f.height,format:f.format,mipmaps:f.mipmaps},c+=1,6===c&&(1===f.mipmapCount&&(a.minFilter=si),a.image=o,a.format=f.format,a.needsUpdate=!0,t&&t(a))},n,r)}if(Array.isArray(e))for(let h=0,d=e.length;h<d;++h)u(h);else l.load(e,function(h){const d=s.parse(h,!0);if(d.isCubemap){const f=d.mipmaps.length/d.mipmapCount;for(let p=0;p<f;p++){o[p]={mipmaps:[]};for(let m=0;m<d.mipmapCount;m++)o[p].mipmaps.push(d.mipmaps[p*d.mipmapCount+m]),o[p].format=d.format,o[p].width=d.width,o[p].height=d.height}a.image=o}else a.image.width=d.width,a.image.height=d.height,a.mipmaps=d.mipmaps;1===d.mipmapCount&&(a.minFilter=si),a.format=d.format,a.needsUpdate=!0,t&&t(a)},n,r);return a}}class fp extends Fr{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=kc.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Wf("img");function l(){u(),kc.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(h){u(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class Vte extends Fr{constructor(e){super(e)}load(e,t,n,r){const s=new $f,o=new fp(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(u){s.images[c]=u,a++,6===a&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class jte extends Fr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new Dc,a=new Ds(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){const c=s.parse(l);!c||(void 0!==c.image?o.image=c.image:void 0!==c.data&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=void 0!==c.wrapS?c.wrapS:dr,o.wrapT=void 0!==c.wrapT?c.wrapT:dr,o.magFilter=void 0!==c.magFilter?c.magFilter:si,o.minFilter=void 0!==c.minFilter?c.minFilter:si,o.anisotropy=void 0!==c.anisotropy?c.anisotropy:1,void 0!==c.encoding&&(o.encoding=c.encoding),void 0!==c.flipY&&(o.flipY=c.flipY),void 0!==c.format&&(o.format=c.format),void 0!==c.type&&(o.type=c.type),void 0!==c.mipmaps&&(o.mipmaps=c.mipmaps,o.minFilter=ya),1===c.mipmapCount&&(o.minFilter=si),void 0!==c.generateMipmaps&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,t&&t(o,c))},n,r),o}}class zk extends Fr{constructor(e){super(e)}load(e,t,n,r){const s=new mr,o=new fp(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},n,r),s}}class Da extends gn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ce(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class nT extends Da{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(gn.DefaultUp),this.updateMatrix(),this.groundColor=new Ce(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Hk=new st,Gk=new C,Wk=new C;class iT{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new te(512,512),this.map=null,this.mapPass=null,this.matrix=new st,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Q_,this._frameExtents=new te(1,1),this._viewportCount=1,this._viewports=[new dn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Gk.setFromMatrixPosition(e.matrixWorld),t.position.copy(Gk),Wk.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Wk),t.updateMatrixWorld(),Hk.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Hk),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class zte extends iT{constructor(){super(new zi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*Hf*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class rT extends Da{constructor(e,t,n=0,r=Math.PI/3,s=0,o=1){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(gn.DefaultUp),this.updateMatrix(),this.target=new gn,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.shadow=new zte}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const Xk=new st,pp=new C,sT=new C;class Hte extends iT{constructor(){super(new zi(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new te(4,2),this._viewportCount=6,this._viewports=[new dn(2,1,1,1),new dn(0,1,1,1),new dn(3,1,1,1),new dn(1,1,1,1),new dn(3,0,1,1),new dn(1,0,1,1)],this._cubeDirections=[new C(1,0,0),new C(-1,0,0),new C(0,0,1),new C(0,0,-1),new C(0,1,0),new C(0,-1,0)],this._cubeUps=[new C(0,1,0),new C(0,1,0),new C(0,1,0),new C(0,1,0),new C(0,0,1),new C(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),pp.setFromMatrixPosition(e.matrixWorld),n.position.copy(pp),sT.copy(n.position),sT.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(sT),n.updateMatrixWorld(),r.makeTranslation(-pp.x,-pp.y,-pp.z),Xk.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Xk)}}class xv extends Da{constructor(e,t,n=0,r=1){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new Hte}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Gte extends iT{constructor(){super(new Ec(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class wv extends Da{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(gn.DefaultUp),this.updateMatrix(),this.target=new gn,this.shadow=new Gte}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class oT extends Da{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Kk extends Da{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class qk{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new C)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],n*r*1.092548),t.addScaledVector(o[5],r*s*1.092548),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],n*s*1.092548),t.addScaledVector(o[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*r),t.addScaledVector(o[2],1.023328*s),t.addScaledVector(o[3],1.023328*n),t.addScaledVector(o[4],.858086*n*r),t.addScaledVector(o[5],.858086*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],.858086*n*s),t.addScaledVector(o[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const n=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-r*r)}}class Mv extends Da{constructor(e=new qk,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class Sv extends Fr{constructor(e){super(e),this.textures={}}load(e,t,n,r){const s=this,o=new Ds(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const t=this.textures;function n(s){return void 0===t[s]&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const r=Sv.createMaterialFromType(e.type);if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=(new Ce).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.iridescence&&(r.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(r.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&(r.vertexColors="number"==typeof e.vertexColors?e.vertexColors>0:e.vertexColors),void 0!==e.uniforms)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=n(o.value);break;case"c":r.uniforms[s].value=(new Ce).setHex(o.value);break;case"v2":r.uniforms[s].value=(new te).fromArray(o.value);break;case"v3":r.uniforms[s].value=(new C).fromArray(o.value);break;case"v4":r.uniforms[s].value=(new dn).fromArray(o.value);break;case"m3":r.uniforms[s].value=(new Xr).fromArray(o.value);break;case"m4":r.uniforms[s].value=(new st).fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new te).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new te).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(r.iridescenceMap=n(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=n(e.thicknessMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:Pk,SpriteMaterial:PS,RawShaderMaterial:Ik,ShaderMaterial:Zn,PointsMaterial:uv,MeshPhysicalMaterial:Ra,MeshStandardMaterial:vo,MeshPhongMaterial:$S,MeshToonMaterial:Fk,MeshNormalMaterial:Lk,MeshLambertMaterial:Ok,MeshDepthMaterial:tv,MeshDistanceMaterial:ES,MeshBasicMaterial:tr,MeshMatcapMaterial:kk,LineDashedMaterial:Nk,LineBasicMaterial:Pi,Material:Ai}[e]}}class bo{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Zk extends wt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Yk extends Fr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new Ds(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const t={},n={};function r(f,p){if(void 0!==t[p])return t[p];const g=f.interleavedBuffers[p],_=function s(f,p){if(void 0!==n[p])return n[p];const _=new Uint32Array(f.arrayBuffers[p]).buffer;return n[p]=_,_}(f,g.buffer),v=lh(g.type,_),y=new tp(v,g.stride);return y.uuid=g.uuid,t[p]=y,y}const o=e.isInstancedBufferGeometry?new Zk:new wt,a=e.data.index;if(void 0!==a){const f=lh(a.type,a.array);o.setIndex(new En(f,1))}const l=e.data.attributes;for(const f in l){const p=l[f];let m;if(p.isInterleavedBufferAttribute){const g=r(e.data,p.data);m=new gl(g,p.itemSize,p.offset,p.normalized)}else{const g=lh(p.type,p.array);m=new(p.isInstancedBufferAttribute?Ph:En)(g,p.itemSize,p.normalized)}void 0!==p.name&&(m.name=p.name),void 0!==p.usage&&m.setUsage(p.usage),void 0!==p.updateRange&&(m.updateRange.offset=p.updateRange.offset,m.updateRange.count=p.updateRange.count),o.setAttribute(f,m)}const c=e.data.morphAttributes;if(c)for(const f in c){const p=c[f],m=[];for(let g=0,_=p.length;g<_;g++){const v=p[g];let y;if(v.isInterleavedBufferAttribute){const b=r(e.data,v.data);y=new gl(b,v.itemSize,v.offset,v.normalized)}else{const b=lh(v.type,v.array);y=new En(b,v.itemSize,v.normalized)}void 0!==v.name&&(y.name=v.name),m.push(y)}o.morphAttributes[f]=m}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const h=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==h)for(let f=0,p=h.length;f!==p;++f){const m=h[f];o.addGroup(m.start,m.count,m.materialIndex)}const d=e.data.boundingSphere;if(void 0!==d){const f=new C;void 0!==d.center&&f.fromArray(d.center),o.boundingSphere=new xa(f,d.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Wte extends Fr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=""===this.path?bo.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new Ds(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(h){return void 0!==r&&r(h),void console.error("THREE:ObjectLoader: Can't parse "+e+".",h.message)}const u=c.metadata;void 0!==u&&void 0!==u.type&&"geometry"!==u.type.toLowerCase()?s.parse(c,t):console.error("THREE.ObjectLoader: Can't load "+e)},n,r)}loadAsync(e,t){var n=this;return so(function*(){const r=n,s=""===n.path?bo.extractUrlBase(e):n.path;n.resourcePath=n.resourcePath||s;const o=new Ds(n.manager);o.setPath(n.path),o.setRequestHeader(n.requestHeader),o.setWithCredentials(n.withCredentials);const a=yield o.loadAsync(e,t),l=JSON.parse(a),c=l.metadata;if(void 0===c||void 0===c.type||"geometry"===c.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return yield r.parseAsync(l)})()}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){void 0!==t&&t(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,n),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),void 0!==t){let h=!1;for(const d in o)if(o[d].data instanceof HTMLImageElement){h=!0;break}!1===h&&t(c)}return c}parseAsync(e){var t=this;return so(function*(){const n=t.parseAnimations(e.animations),r=t.parseShapes(e.shapes),s=t.parseGeometries(e.geometries,r),o=yield t.parseImagesAsync(e.images),a=t.parseTextures(e.textures,o),l=t.parseMaterials(e.materials,a),c=t.parseObject(e.object,s,l,a,n),u=t.parseSkeletons(e.skeletons,c);return t.bindSkeletons(c,u),c})()}parseShapes(e){const t={};if(void 0!==e)for(let n=0,r=e.length;n<r;n++){const s=(new Ic).fromJSON(e[n]);t[s.uuid]=s}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),void 0!==e)for(let s=0,o=e.length;s<o;s++){const a=(new sp).fromJSON(e[s],r);n[a.uuid]=a}return n}parseGeometries(e,t){const n={};if(void 0!==e){const r=new Yk;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:l.type in Dk?a=Dk[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,void 0!==l.name&&(a.name=l.name),!0===a.isBufferGeometry&&void 0!==l.userData&&(a.userData=l.userData),n[l.uuid]=a}}return n}parseMaterials(e,t){const n={},r={};if(void 0!==e){const s=new Sv;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const l=e[o];if("MultiMaterial"===l.type){const c=[];for(let u=0;u<l.materials.length;u++){const h=l.materials[u];void 0===n[h.uuid]&&(n[h.uuid]=s.parse(h)),c.push(n[h.uuid])}r[l.uuid]=c}else void 0===n[l.uuid]&&(n[l.uuid]=s.parse(l)),r[l.uuid]=n[l.uuid]}}return r}parseAnimations(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const s=Xh.parse(e[n]);t[s.uuid]=s}return t}parseImages(e,t){const n=this,r={};let s;function a(l){if("string"==typeof l){const c=l;return function o(l){return n.manager.itemStart(l),s.load(l,function(){n.manager.itemEnd(l)},void 0,function(){n.manager.itemError(l),n.manager.itemEnd(l)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:n.resourcePath+c)}return l.data?{data:lh(l.type,l.data),width:l.width,height:l.height}:null}if(void 0!==e&&e.length>0){const l=new tT(t);s=new fp(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,u=e.length;c<u;c++){const h=e[c],d=h.url;if(Array.isArray(d)){const f=[];for(let p=0,m=d.length;p<m;p++){const _=a(d[p]);null!==_&&(_ instanceof HTMLImageElement?f.push(_):f.push(new Dc(_.data,_.width,_.height)))}r[h.uuid]=new Mc(f)}else{const f=a(h.url);r[h.uuid]=new Mc(f)}}}return r}parseImagesAsync(e){var t=this;return so(function*(){const n=t,r={};let s;function o(l){return a.apply(this,arguments)}function a(){return(a=so(function*(l){if("string"==typeof l){const c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:n.resourcePath+c;return yield s.loadAsync(u)}return l.data?{data:lh(l.type,l.data),width:l.width,height:l.height}:null})).apply(this,arguments)}if(void 0!==e&&e.length>0){s=new fp(t.manager),s.setCrossOrigin(t.crossOrigin);for(let l=0,c=e.length;l<c;l++){const u=e[l],h=u.url;if(Array.isArray(h)){const d=[];for(let f=0,p=h.length;f<p;f++){const m=h[f],g=yield o(m);null!==g&&(g instanceof HTMLImageElement?d.push(g):d.push(new Dc(g.data,g.width,g.height)))}r[u.uuid]=new Mc(d)}else{const d=yield o(u.url);r[u.uuid]=new Mc(d)}}}return r})()}parseTextures(e,t){function n(s,o){return"number"==typeof s?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(void 0!==e)for(let s=0,o=e.length;s<o;s++){const a=e[s];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=t[a.image],c=l.data;let u;Array.isArray(c)?(u=new $f,6===c.length&&(u.needsUpdate=!0)):(u=c&&c.data?new Dc:new mr,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=a.uuid,void 0!==a.name&&(u.name=a.name),void 0!==a.mapping&&(u.mapping=n(a.mapping,Xte)),void 0!==a.offset&&u.offset.fromArray(a.offset),void 0!==a.repeat&&u.repeat.fromArray(a.repeat),void 0!==a.center&&u.center.fromArray(a.center),void 0!==a.rotation&&(u.rotation=a.rotation),void 0!==a.wrap&&(u.wrapS=n(a.wrap[0],Qk),u.wrapT=n(a.wrap[1],Qk)),void 0!==a.format&&(u.format=a.format),void 0!==a.type&&(u.type=a.type),void 0!==a.encoding&&(u.encoding=a.encoding),void 0!==a.minFilter&&(u.minFilter=n(a.minFilter,$k)),void 0!==a.magFilter&&(u.magFilter=n(a.magFilter,$k)),void 0!==a.anisotropy&&(u.anisotropy=a.anisotropy),void 0!==a.flipY&&(u.flipY=a.flipY),void 0!==a.premultiplyAlpha&&(u.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(u.unpackAlignment=a.unpackAlignment),void 0!==a.userData&&(u.userData=a.userData),r[a.uuid]=u}return r}parseObject(e,t,n,r,s){let o,u,h;function a(d){return void 0===t[d]&&console.warn("THREE.ObjectLoader: Undefined geometry",d),t[d]}function l(d){if(void 0!==d){if(Array.isArray(d)){const f=[];for(let p=0,m=d.length;p<m;p++){const g=d[p];void 0===n[g]&&console.warn("THREE.ObjectLoader: Undefined material",g),f.push(n[g])}return f}return void 0===n[d]&&console.warn("THREE.ObjectLoader: Undefined material",d),n[d]}}function c(d){return void 0===r[d]&&console.warn("THREE.ObjectLoader: Undefined texture",d),r[d]}switch(e.type){case"Scene":o=new DS,void 0!==e.background&&(o.background=Number.isInteger(e.background)?new Ce(e.background):c(e.background)),void 0!==e.environment&&(o.environment=c(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new ep(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new nv(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":o=new zi(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Ec(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new oT(e.color,e.intensity);break;case"DirectionalLight":o=new wv(e.color,e.intensity);break;case"PointLight":o=new xv(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new Kk(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new rT(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new nT(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=(new Mv).fromJSON(e);break;case"SkinnedMesh":u=a(e.geometry),h=l(e.material),o=new FS(u,h),void 0!==e.bindMode&&(o.bindMode=e.bindMode),void 0!==e.bindMatrix&&o.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(o.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),h=l(e.material),o=new Ke(u,h);break;case"InstancedMesh":u=a(e.geometry),h=l(e.material);const f=e.instanceMatrix,p=e.instanceColor;o=new LS(u,h,e.count),o.instanceMatrix=new Ph(new Float32Array(f.array),16),void 0!==p&&(o.instanceColor=new Ph(new Float32Array(p.array),p.itemSize));break;case"LOD":o=new JO;break;case"Line":o=new wi(a(e.geometry),l(e.material));break;case"LineLoop":o=new kS(a(e.geometry),l(e.material));break;case"LineSegments":o=new As(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new BS(a(e.geometry),l(e.material));break;case"Sprite":o=new QO(l(e.material));break;case"Group":o=new Xo;break;case"Bone":o=new av;break;default:o=new gn}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(o.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(o.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.frustumCulled&&(o.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(o.renderOrder=e.renderOrder),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.layers&&(o.layers.mask=e.layers),void 0!==e.children){const d=e.children;for(let f=0;f<d.length;f++)o.add(this.parseObject(d[f],t,n,r,s))}if(void 0!==e.animations){const d=e.animations;for(let f=0;f<d.length;f++)o.animations.push(s[d[f]])}if("LOD"===e.type){void 0!==e.autoUpdate&&(o.autoUpdate=e.autoUpdate);const d=e.levels;for(let f=0;f<d.length;f++){const p=d[f],m=o.getObjectByProperty("uuid",p.object);void 0!==m&&o.addLevel(m,p.distance)}}return o}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse(function(n){if(!0===n.isSkinnedMesh&&void 0!==n.skeleton){const r=t[n.skeleton];void 0===r?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const Xte={UVMapping:m_,CubeReflectionMapping:tl,CubeRefractionMapping:nl,EquirectangularReflectionMapping:Bf,EquirectangularRefractionMapping:Uf,CubeUVReflectionMapping:rh},Qk={RepeatWrapping:il,ClampToEdgeWrapping:dr,MirroredRepeatWrapping:sh},$k={NearestFilter:bi,NearestMipmapNearestFilter:Vf,NearestMipmapLinearFilter:jf,LinearFilter:si,LinearMipmapNearestFilter:g_,LinearMipmapLinearFilter:ya};class Jk extends Fr{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=kc.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){kc.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let Tv;const aT={getContext:function(){return void 0===Tv&&(Tv=new(window.AudioContext||window.webkitAudioContext)),Tv},setContext:function(i){Tv=i}};class Kte extends Fr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new Ds(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{const l=a.slice(0);aT.getContext().decodeAudioData(l,function(u){t(u)})}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}}class qte extends Mv{constructor(e,t,n=1){super(void 0,n),this.isHemisphereLightProbe=!0;const r=(new Ce).set(e),s=(new Ce).set(t),o=new C(r.r,r.g,r.b),a=new C(s.r,s.g,s.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}}class Zte extends Mv{constructor(e,t=1){super(void 0,t),this.isAmbientLightProbe=!0;const n=(new Ce).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const eN=new st,tN=new st,Nc=new st;class Yte{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new zi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new zi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Nc.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,o=t.near*Math.tan(xc*t.fov*.5)/t.zoom;let a,l;tN.elements[12]=-r,eN.elements[12]=r,a=-o*t.aspect+s,l=o*t.aspect+s,Nc.elements[0]=2*t.near/(l-a),Nc.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(Nc),a=-o*t.aspect-s,l=o*t.aspect-s,Nc.elements[0]=2*t.near/(l-a),Nc.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(Nc)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(tN),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(eN)}}class Cv{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=nN(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=nN();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function nN(){return(typeof performance>"u"?Date:performance).now()}const Bc=new C,iN=new bn,Qte=new C,Uc=new C;class $te extends gn{constructor(){super(),this.type="AudioListener",this.context=aT.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Cv}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Bc,iN,Qte),Uc.set(0,0,-1).applyQuaternion(iN),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Bc.x,r),t.positionY.linearRampToValueAtTime(Bc.y,r),t.positionZ.linearRampToValueAtTime(Bc.z,r),t.forwardX.linearRampToValueAtTime(Uc.x,r),t.forwardY.linearRampToValueAtTime(Uc.y,r),t.forwardZ.linearRampToValueAtTime(Uc.z,r),t.upX.linearRampToValueAtTime(n.x,r),t.upY.linearRampToValueAtTime(n.y,r),t.upZ.linearRampToValueAtTime(n.z,r)}else t.setPosition(Bc.x,Bc.y,Bc.z),t.setOrientation(Uc.x,Uc.y,Uc.z,n.x,n.y,n.z)}}class rN extends gn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Vc=new C,sN=new bn,Jte=new C,jc=new C;class ene extends rN{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(Vc,sN,Jte),jc.set(0,0,1).applyQuaternion(sN);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Vc.x,n),t.positionY.linearRampToValueAtTime(Vc.y,n),t.positionZ.linearRampToValueAtTime(Vc.z,n),t.orientationX.linearRampToValueAtTime(jc.x,n),t.orientationY.linearRampToValueAtTime(jc.y,n),t.orientationZ.linearRampToValueAtTime(jc.z,n)}else t.setPosition(Vc.x,Vc.y,Vc.z),t.setOrientation(jc.x,jc.y,jc.z)}}class tne{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class oN{constructor(e,t,n){let r,s,o;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(0===o){for(let a=0;a!==r;++a)n[s+a]=n[a];o=t}else o+=t,this._mixBufferRegion(n,s,0,t/o,r);this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1&&this._mixBufferRegion(n,r,t*this._origIndex,1-s,t),o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(n[l]!==n[l+t]){a.setValue(n,r);break}}saveOriginalState(){const t=this.buffer,n=this.valueSize,r=n*this._origIndex;this.binding.getValue(t,r);for(let s=n,o=r;s!==o;++s)t[s]=t[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[n+o]}_slerp(e,t,n,r){bn.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,s){const o=this._workIndex*s;bn.multiplyQuaternionsFlat(e,o,e,t,e,n),bn.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,n,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[n+a]*r}}_lerpAdditive(e,t,n,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[n+o]*r}}}const lT="\\[\\]\\.:\\/",nne=new RegExp("["+lT+"]","g"),cT="[^"+lT+"]",ine="[^"+lT.replace("\\.","")+"]",lne=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",cT)+/(WCOD+)?/.source.replace("WCOD",ine)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",cT)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",cT)+"$"),cne=["material","materials","bones"];class une{constructor(e,t,n){const r=n||Nn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}let Nn=(()=>{class i{constructor(t,n,r){this.path=n,this.parsedPath=r||i.parseTrackName(n),this.node=i.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,r){return t&&t.isAnimationObjectGroup?new i.Composite(t,n,r):new i(t,n,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(nne,"")}static parseTrackName(t){const n=lne.exec(t);if(null===n)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==cne.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,n){if(void 0===n||""===n||"."===n||-1===n||n===t.name||n===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(n);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===n||l.uuid===n)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[n++]=r[s]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++]}_setValue_array_setNeedsUpdate(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node;const n=this.parsedPath,r=n.objectName,s=n.propertyName;let o=n.propertyIndex;if(t||(t=i.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let u=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let h=0;h<t.length;h++)if(t[h].name===u){u=h;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return i.Composite=une,i})();Nn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Nn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Nn.prototype.GetterByBindingType=[Nn.prototype._getValue_direct,Nn.prototype._getValue_array,Nn.prototype._getValue_arrayElement,Nn.prototype._getValue_toArray],Nn.prototype.SetterByBindingTypeAndVersioning=[[Nn.prototype._setValue_direct,Nn.prototype._setValue_direct_setNeedsUpdate,Nn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Nn.prototype._setValue_array,Nn.prototype._setValue_array_setNeedsUpdate,Nn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Nn.prototype._setValue_arrayElement,Nn.prototype._setValue_arrayElement_setNeedsUpdate,Nn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Nn.prototype._setValue_fromArray,Nn.prototype._setValue_fromArray_setNeedsUpdate,Nn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class hne{constructor(){this.isAnimationObjectGroup=!0,this.uuid=cs(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,c=this.nCachedObjects_;for(let u=0,h=arguments.length;u!==h;++u){const d=arguments[u],f=d.uuid;let p=t[f];if(void 0===p){p=l++,t[f]=p,e.push(d);for(let m=0,g=o;m!==g;++m)s[m].push(new Nn(d,n[m],r[m]))}else if(p<c){a=e[p];const m=--c,g=e[m];t[g.uuid]=p,e[p]=g,t[f]=m,e[m]=d;for(let _=0,v=o;_!==v;++_){const y=s[_];let w=y[p];y[p]=y[m],void 0===w&&(w=new Nn(d,n[_],r[_])),y[m]=w}}else e[p]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,u=t[c];if(void 0!==u&&u>=s){const h=s++,d=e[h];t[d.uuid]=u,e[u]=d,t[c]=h,e[h]=l;for(let f=0,p=r;f!==p;++f){const m=n[f],_=m[u];m[u]=m[h],m[h]=_}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const u=arguments[a].uuid,h=t[u];if(void 0!==h)if(delete t[u],h<s){const d=--s,f=e[d],p=--o,m=e[p];t[f.uuid]=h,e[h]=f,t[m.uuid]=d,e[d]=m,e.pop();for(let g=0,_=r;g!==_;++g){const v=n[g],b=v[p];v[h]=v[d],v[d]=b,v.pop()}}else{const d=--o,f=e[d];d>0&&(t[f.uuid]=h),e[h]=f,e.pop();for(let p=0,m=r;p!==m;++p){const g=n[p];g[h]=g[d],g.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const s=this._bindings;if(void 0!==r)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,u=this.nCachedObjects_,h=new Array(l.length);r=s.length,n[e]=r,o.push(e),a.push(t),s.push(h);for(let d=u,f=l.length;d!==f;++d)h[d]=new Nn(l[d],e,t);return h}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a];t[e[a]]=n,o[n]=l,o.pop(),s[n]=s[a],s.pop(),r[n]=r[a],r.pop()}}}class dne{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:yc,endingEnd:yc};for(let c=0;c!==o;++c){const u=s[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=qL,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const r=this._clip.duration,s=e._clip.duration,a=r/s;e.warp(1,s/r,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+n,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled)return void this._updateWeight(e);const s=this._startTime;if(null!==s){const l=(e-s)*n;if(l<0||0===n)return;this._startTime=null,t=n*l}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;if(this.blendMode===WM)for(let u=0,h=l.length;u!==h;++u)l[u].evaluate(o),c[u].accumulateAdditive(a);else for(let u=0,h=l.length;u!==h;++u)l[u].evaluate(o),c[u].accumulate(r,a)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;null!==n&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,s=this._loopCount;const o=n===ZL;if(0===e)return-1===s?r:o&&1==(1&s)?t-r:r;if(n===GM){-1===s&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===s&&(e>=0?(s=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===l){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&1==(1&s))return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=bc,r.endingEnd=bc):(r.endingStart=e?this.zeroSlopeAtStart?bc:yc:zf,r.endingEnd=t?this.zeroSlopeAtEnd?bc:yc:zf)}_scheduleFading(e,t,n){const r=this._mixer,s=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=n,this}}const fne=new Float32Array(1);class aN extends ls{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=n.uuid,c=this._bindingsByRootAndName;let u=c[l];void 0===u&&(u={},c[l]=u);for(let h=0;h!==s;++h){const d=r[h],f=d.name;let p=u[f];if(void 0!==p)++p.referenceCount,o[h]=p;else{if(p=o[h],void 0!==p){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,l,f));continue}p=new oN(Nn.create(n,f,t&&t._propertyBindings[h].binding.parsedPath),d.ValueTypeName,d.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,f),o[h]=p}a[h].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,n)}const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];0==--s.useCount&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,s=this._actionsByClip;let o=s[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===l.length&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];0==--s.referenceCount&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];void 0===o&&(o={},r[t]=o),o[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,s=n.path,o=this._bindingsByRootAndName,a=o[r],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[s],0===Object.keys(a).length&&delete o[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new JS(new Float32Array(2),new Float32Array(2),1,fne),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const r=t||this._root,s=r.uuid;let o="string"==typeof e?Xh.findByName(r,e):e;const a=null!==o?o.uuid:e,l=this._actionsByClip[a];let c=null;if(void 0===n&&(n=null!==o?o.blendMode:w_),void 0!==l){const h=l.actionByRoot[s];if(void 0!==h&&h.blendMode===n)return h;c=l.knownActions[0],null===o&&(o=c._clip)}if(null===o)return null;const u=new dne(this,o,t,n);return this._bindAction(u,c),this._addInactiveAction(u,a,s),u}existingAction(e,t){const n=t||this._root,r=n.uuid,s="string"==typeof e?Xh.findByName(n,e):e,a=this._actionsByClip[s?s.uuid:e];return void 0!==a&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let n=this._nActiveActions-1;n>=0;--n)e[n].stop();return this}update(e){const t=this._actions,n=this._nActiveActions,r=this.time+=e*=this.timeScale,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==n;++c)t[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,s=r[n];if(void 0!==s){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const u=c._cacheIndex,h=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,h._cacheIndex=u,t[u]=h,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const l=n[o].actionByRoot[t];void 0!==l&&(this._deactivateAction(l),this._removeInactiveAction(l))}const s=this._bindingsByRootAndName[t];if(void 0!==s)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class uT{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new uT(void 0===this.value.clone?this.value:this.value.clone())}}class pne extends tp{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class mne{constructor(e,t,n,r,s){this.isGLBufferAttribute=!0,this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class mp{constructor(e,t,n=0,r=1/0){this.ray=new qf(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new B_,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,n=[]){return hT(e,this,n,t),n.sort(lN),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)hT(e[r],this,n,t);return n.sort(lN),n}}function lN(i,e){return i.distance-e.distance}function hT(i,e,t,n){if(i.layers.test(e.layers)&&i.raycast(e,t),!0===n){const r=i.children;for(let s=0,o=r.length;s<o;s++)hT(r[s],e,t,!0)}}class Ev{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(xi(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class gne{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return(new this.constructor).copy(this)}}const cN=new te;class _ne{constructor(e=new te(1/0,1/0),t=new te(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=cN.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return cN.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const uN=new C,Rv=new C;class hN{constructor(e=new C,t=new C){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){uN.subVectors(e,this.start),Rv.subVectors(this.end,this.start);const n=Rv.dot(Rv);let s=Rv.dot(uN)/n;return t&&(s=xi(s,0,1)),s}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const dN=new C;class vne extends gn{constructor(e,t){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const n=new wt,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,u=a/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}n.setAttribute("position",new $e(r,3));const s=new Pi({fog:!1,toneMapped:!1});this.cone=new As(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),dN.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(dN),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const bl=new C,Av=new st,dT=new st;class yne extends As{constructor(e){const t=fN(e),n=new wt,r=[],s=[],o=new Ce(0,0,1),a=new Ce(0,1,0);for(let c=0;c<t.length;c++){const u=t[c];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}n.setAttribute("position",new $e(r,3)),n.setAttribute("color",new $e(s,3)),super(n,new Pi({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");dT.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(Av.multiplyMatrices(dT,a.matrixWorld),bl.setFromMatrixPosition(Av),r.setXYZ(o,bl.x,bl.y,bl.z),Av.multiplyMatrices(dT,a.parent.matrixWorld),bl.setFromMatrixPosition(Av),r.setXYZ(o+1,bl.x,bl.y,bl.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function fN(i){const e=[];!0===i.isBone&&e.push(i);for(let t=0;t<i.children.length;t++)e.push.apply(e,fN(i.children[t]));return e}class bne extends Ke{constructor(e,t,n){super(new Ea(t,4,2),new tr({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.light.updateMatrixWorld(),this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const xne=new C,pN=new Ce,mN=new Ce;class wne extends gn{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const r=new go(t);r.rotateY(.5*Math.PI),this.material=new tr({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(3*s.count);r.setAttribute("color",new En(o,3)),this.add(new Ke(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");pN.copy(this.light.color),mN.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){const s=n<r/2?pN:mN;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}e.lookAt(xne.setFromMatrixPosition(this.light.matrixWorld).negate())}}class fT extends As{constructor(e=10,t=10,n=4473924,r=8947848){n=new Ce(n),r=new Ce(r);const s=t/2,o=e/t,a=e/2,l=[],c=[];for(let d=0,f=0,p=-a;d<=t;d++,p+=o){l.push(-a,0,p,a,0,p),l.push(p,0,-a,p,0,a);const m=d===s?n:r;m.toArray(c,f),f+=3,m.toArray(c,f),f+=3,m.toArray(c,f),f+=3,m.toArray(c,f),f+=3}const u=new wt;u.setAttribute("position",new $e(l,3)),u.setAttribute("color",new $e(c,3)),super(u,new Pi({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class Mne extends As{constructor(e=10,t=16,n=8,r=64,s=4473924,o=8947848){s=new Ce(s),o=new Ce(o);const a=[],l=[];for(let h=0;h<=t;h++){const d=h/t*(2*Math.PI),f=Math.sin(d)*e,p=Math.cos(d)*e;a.push(0,0,0),a.push(f,0,p);const m=1&h?s:o;l.push(m.r,m.g,m.b),l.push(m.r,m.g,m.b)}for(let h=0;h<=n;h++){const d=1&h?s:o,f=e-e/n*h;for(let p=0;p<r;p++){let m=p/r*(2*Math.PI),g=Math.sin(m)*f,_=Math.cos(m)*f;a.push(g,0,_),l.push(d.r,d.g,d.b),m=(p+1)/r*(2*Math.PI),g=Math.sin(m)*f,_=Math.cos(m)*f,a.push(g,0,_),l.push(d.r,d.g,d.b)}}const c=new wt;c.setAttribute("position",new $e(a,3)),c.setAttribute("color",new $e(l,3)),super(c,new Pi({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const gN=new C,Dv=new C,_N=new C;class Sne extends gn{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);let r=new wt;r.setAttribute("position",new $e([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new Pi({fog:!1,toneMapped:!1});this.lightPlane=new wi(r,s),this.add(this.lightPlane),r=new wt,r.setAttribute("position",new $e([0,0,0,0,0,1],3)),this.targetLine=new wi(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){gN.setFromMatrixPosition(this.light.matrixWorld),Dv.setFromMatrixPosition(this.light.target.matrixWorld),_N.subVectors(Dv,gN),this.lightPlane.lookAt(Dv),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Dv),this.targetLine.scale.z=_N.length()}}const Pv=new C,gi=new Qf;class Tne extends As{constructor(e){const t=new wt,n=new Pi({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};function a(p,m){l(p),l(m)}function l(p){r.push(0,0,0),s.push(0,0,0),void 0===o[p]&&(o[p]=[]),o[p].push(r.length/3-1)}a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4"),t.setAttribute("position",new $e(r,3)),t.setAttribute("color",new $e(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new Ce(16755200),u=new Ce(16711680),h=new Ce(43775),d=new Ce(16777215),f=new Ce(3355443);this.setColors(c,u,h,d,f)}setColors(e,t,n,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap;gi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Mi("c",t,e,gi,0,0,-1),Mi("t",t,e,gi,0,0,1),Mi("n1",t,e,gi,-1,-1,-1),Mi("n2",t,e,gi,1,-1,-1),Mi("n3",t,e,gi,-1,1,-1),Mi("n4",t,e,gi,1,1,-1),Mi("f1",t,e,gi,-1,-1,1),Mi("f2",t,e,gi,1,-1,1),Mi("f3",t,e,gi,-1,1,1),Mi("f4",t,e,gi,1,1,1),Mi("u1",t,e,gi,.7,1.1,-1),Mi("u2",t,e,gi,-.7,1.1,-1),Mi("u3",t,e,gi,0,2,-1),Mi("cf1",t,e,gi,-1,0,1),Mi("cf2",t,e,gi,1,0,1),Mi("cf3",t,e,gi,0,-1,1),Mi("cf4",t,e,gi,0,1,1),Mi("cn1",t,e,gi,-1,0,-1),Mi("cn2",t,e,gi,1,0,-1),Mi("cn3",t,e,gi,0,-1,-1),Mi("cn4",t,e,gi,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Mi(i,e,t,n,r,s,o){Pv.set(r,s,o).unproject(n);const a=e[i];if(void 0!==a){const l=t.getAttribute("position");for(let c=0,u=a.length;c<u;c++)l.setXYZ(a[c],Pv.x,Pv.y,Pv.z)}}const Iv=new Ho;class Cne extends As{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),s=new wt;s.setIndex(new En(n,1)),s.setAttribute("position",new En(r,3)),super(s,new Pi({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Iv.setFromObject(this.object),Iv.isEmpty())return;const t=Iv.min,n=Iv.max,r=this.geometry.attributes.position,s=r.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=t.x,s[4]=n.y,s[5]=n.z,s[6]=t.x,s[7]=t.y,s[8]=n.z,s[9]=n.x,s[10]=t.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=t.z,s[15]=t.x,s[16]=n.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=n.x,s[22]=t.y,s[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}}class vN extends As{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new wt;s.setIndex(new En(n,1)),s.setAttribute("position",new $e([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(s,new Pi({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class Ene extends wi{constructor(e,t=1,n=16776960){const r=n,o=new wt;o.setAttribute("position",new $e([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),o.computeBoundingSphere(),super(o,new Pi({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const l=new wt;l.setAttribute("position",new $e([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),l.computeBoundingSphere(),this.add(new Ke(l,new tr({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?as:el,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}}const yN=new C;let Fv,pT;class Rne extends gn{constructor(e=new C(0,0,1),t=new C(0,0,0),n=1,r=16776960,s=.2*n,o=.2*s){super(),this.type="ArrowHelper",void 0===Fv&&(Fv=new wt,Fv.setAttribute("position",new $e([0,0,0,0,1,0],3)),pT=new mi(0,.5,1,5,1),pT.translate(0,-.5,0)),this.position.copy(t),this.line=new wi(Fv,new Pi({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ke(pT,new tr({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{yN.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(yN,t)}}setLength(e,t=.2*e,n=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}class Ane extends As{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new wt;r.setAttribute("position",new $e(t,3)),r.setAttribute("color",new $e([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(r,new Pi({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const r=new Ce,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Dne{constructor(){this.type="ShapePath",this.color=new Ce,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new cp,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,s,o){return this.currentPath.bezierCurveTo(e,t,n,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function n(v){const y=[];for(let b=0,w=v.length;b<w;b++){const M=v[b],T=new Ic;T.curves=M.curves,y.push(T)}return y}function r(v,y){const b=y.length;let w=!1;for(let M=b-1,T=0;T<b;M=T++){let x=y[M],E=y[T],D=E.x-x.x,L=E.y-x.y;if(Math.abs(L)>Number.EPSILON){if(L<0&&(x=y[T],D=-D,E=y[M],L=-L),v.y<x.y||v.y>E.y)continue;if(v.y===x.y){if(v.x===x.x)return!0}else{const z=L*(v.x-x.x)-D*(v.y-x.y);if(0===z)return!0;if(z<0)continue;w=!w}}else{if(v.y!==x.y)continue;if(E.x<=v.x&&v.x<=x.x||x.x<=v.x&&v.x<=E.x)return!0}}return w}const s=Ko.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return n(o);let a,l,c;const u=[];if(1===o.length)return l=o[0],c=new Ic,c.curves=l.curves,u.push(c),u;let h=!s(o[0].getPoints());h=e?!h:h;const d=[],f=[];let g,_,p=[],m=0;f[m]=void 0,p[m]=[];for(let v=0,y=o.length;v<y;v++)l=o[v],g=l.getPoints(),a=s(g),a=e?!a:a,a?(!h&&f[m]&&m++,f[m]={s:new Ic,p:g},f[m].s.curves=l.curves,h&&m++,p[m]=[]):p[m].push({h:l,p:g[0]});if(!f[0])return n(o);if(f.length>1){let v=!1,y=0;for(let b=0,w=f.length;b<w;b++)d[b]=[];for(let b=0,w=f.length;b<w;b++){const M=p[b];for(let T=0;T<M.length;T++){const x=M[T];let E=!0;for(let D=0;D<f.length;D++)r(x.p,f[D].p)&&(b!==D&&y++,E?(E=!1,d[D].push(x)):v=!0);E&&d[b].push(x)}}y>0&&!1===v&&(p=d)}for(let v=0,y=f.length;v<y;v++){c=f[v].s,u.push(c),_=p[v];for(let b=0,w=_.length;b<w;b++)c.holes.push(_[b].h)}return u}}const{floatView:bN,uint32View:xN,baseTable:Pne,shiftTable:Ine,mantissaTable:Fne,exponentTable:Lne,offsetTable:One}=kne();function kne(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(n[l]=0,n[256|l]=32768,r[l]=24,r[256|l]=24):c<-14?(n[l]=1024>>-c-14,n[256|l]=1024>>-c-14|32768,r[l]=-c-1,r[256|l]=-c-1):c<=15?(n[l]=c+15<<10,n[256|l]=c+15<<10|32768,r[l]=13,r[256|l]=13):c<128?(n[l]=31744,n[256|l]=64512,r[l]=24,r[256|l]=24):(n[l]=31744,n[256|l]=64512,r[l]=13,r[256|l]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;0==(8388608&c);)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}var gp=Object.freeze({__proto__:null,toHalfFloat:function Nne(i){Math.abs(i)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),i=xi(i,-65504,65504),bN[0]=i;const e=xN[0],t=e>>23&511;return Pne[t]+((8388607&e)>>Ine[t])},fromHalfFloat:function Bne(i){const e=i>>10;return xN[0]=Fne[One[e]+(1023&i)]+Lne[e],bN[0]}});class Une extends wt{constructor(){console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),super()}}class Vne extends wt{constructor(){console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),super()}}function jne(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function zne(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function Hne(){console.error("THREE.ImmediateRenderObject has been removed.")}class Gne extends Wn{constructor(e,t,n){console.error('THREE.WebGLMultisampleRenderTarget has been removed. Use a normal render target and set the "samples" property to greater 0 to enable multisampling.'),super(e,t,n),this.samples=4}}class Wne extends Xf{constructor(e,t,n,r){console.warn("THREE.DataTexture2DArray has been renamed to DataArrayTexture."),super(e,t,n,r)}}class Xne extends P_{constructor(e,t,n,r){console.warn("THREE.DataTexture3D has been renamed to Data3DTexture."),super(e,t,n,r)}}function wN(i){return!(!i||!i.set)}function Ft(i,e){return wN(i)?void 0===e?i:Array.isArray(e)?(i.set(...e),i):i.copy&&e?(i.copy(e),i):void 0!==e?(i.set(e),i):i:e}function mT(i){return void 0!==i&&(i.observed||i.observers?.length>0)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:f_}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=f_);const gT={now:()=>(gT.delegate||Date).now(),delegate:void 0};class _T extends Lt{constructor(e=1/0,t=1/0,n=gT){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:n,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:o}=this;t||(n.push(e),!r&&n.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:r}=this,s=r.slice();for(let o=0;o<s.length&&!e.closed;o+=n?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<n.length&&n.splice(0,n.length-s),!r){const o=t.now();let a=0;for(let l=1;l<n.length&&n[l]<=o;l+=2)a=l;a&&n.splice(0,a+1)}}}class qne{constructor(){this.memberMap=new Map,this.children=[],this.eventListener={},this.add=(...e)=>(this.objRef&&this.objRef.add(...e),this.children.push(...e),this),this.remove=(...e)=>{this.objRef&&this.objRef.remove(...e);for(const t of e){const n=this.children.indexOf(t);n>=0&&(this.children=this.children.splice(n,1))}return this},this.applyToObject3D=e=>{if(this.memberMap.forEach((t,n)=>{const r=e[n];wN(r)?Ft(r,t):e[n]=t}),this.children.forEach(t=>e.add(t)),this.objRef?.parent){const t=this.objRef?.parent;t.remove(this.objRef),t.add(e)}},this.addEventListener=(e,t)=>{let n=this.eventListener[e];n||(n=[],this.eventListener[e]=n),n.push(t),this.objRef&&this.objRef.addEventListener(e,t)},this.removeEventListener=(e,t)=>{const n=this.eventListener[e];if(!n)return;const r=n.indexOf(t);r>=0&&n.splice(r,1)}}get(e,t,n){switch(t){case"__isProxy":return!0;case"applyToObject3D":return this.applyToObject3D;case"objRef":return this.objRef;case"add":return this.add;case"remove":return this.remove;case"children":return this.objRef?this.objRef.children:this.children;default:{const r=t;let s=this.objRef?this.objRef[r]:this.memberMap.get(r);return void 0===s&&(s=e[r],void 0!==s&&this.memberMap.set(r,s)),s??e[r]}}}set(e,t,n,r){return"objRef"===t?(n&&this.applyToObject3D(n),this.objRef=n):(this.memberMap.set(t,n),this.objRef&&(this.objRef[t]=n)),!0}}function MN(i){return!0===i.__isProxy&&void 0===i.objRef}let Kh=(()=>{class i{constructor(){this.autoAddToParent=!0,this.autoDispose=!0}set objRef(t){this.applyObjRef(t)}get objRef(){return this._objRef}addToParent(){}removeFromParent(){}get onUpdate(){return this.updateEmitter||(this.updateEmitter=new yt),this.updateEmitter}get objRef$(){return this._objRef$||(this._objRef$=new _T(1)),this._objRef$}ngOnInit(){this.objRef||(this.objRef=this.createThreeInstance(this.args))}getType(){throw new Error("derive me")}createThreeInstance(t){return Array.isArray(t)?new(this.getType())(...t):new(this.getType())(t)}ngOnChanges(t){if(!this.objRef||MN(this.objRef)){t.objRef?.currentValue?this.objRef=t.objRef?.currentValue:this.objRef||(this.objRef=this.createThreeInstance(t.args?.currentValue));for(const n in t)this[n]=t[n].currentValue;this.emitPropertyChanges(t)}else this.emitPropertyChanges(t)}disposeObjRef(){(function Kne(i){return!(!i||"function"!=typeof i.dispose)})(this.objRef)&&this.objRef.dispose()}ngOnDestroy(){this.removeFromParent(),this.autoDispose&&this.disposeObjRef()}applyObjRef(t){this._objRef!==t&&(this.removeFromParent(),this._objRef=t,this.autoAddToParent&&this.addToParent(),this.emitObjRefChange())}emitObjRefChange(){this._objRef&&!MN(this._objRef)&&(this._objRef.dispatchEvent?.({type:"loaded",object:this._objRef}),this._objRef$&&this._objRef$.next(this._objRef))}emitPropertyChanges(t){this._objRef&&this._objRef.dispatchEvent?.({type:"changes",changes:t}),this.updateEmitter&&this.updateEmitter.next(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["th-abs-wrapper"]],inputs:{autoAddToParent:"autoAddToParent",autoDispose:"autoDispose",objRef:"objRef",args:"args"},outputs:{onUpdate:"onUpdate",objRef$:"objRef$"},features:[$i],decls:0,vars:0,template:function(t,n){},encapsulation:2}),i})(),Yne=(()=>{class i extends Kh{constructor(t){super(),this.parent=t}addToParent(){this._objRef&&this._objRef.parent&&this._objRef.parent.uuid!==this.parent.objRef.uuid&&this.parent.objRef.add(this._objRef)}removeFromParent(){this._objRef?.parent?.remove(this._objRef)}applyObjRef(t){this.attachToParent(t,this._objRef),this._objRef=t,this.emitObjRefChange()}attachToParent(t,n){!this.parent.objRef||t===n&&n?.parent?.uuid===this.parent.objRef.uuid||(n&&n.parent&&n.parent.remove(n),t&&(!t.parent||t.parent&&t.parent.uuid!==this.parent.objRef.uuid)&&this.parent.objRef.add(t))}set lookAt(t){Promise.resolve().then(()=>{!this.objRef||(Array.isArray(t)?this.objRef.lookAt(...t):this.objRef.lookAt(t))})}}return i.\u0275fac=function(t){return new(t||i)(N(i))},i.\u0275cmp=De({type:i,selectors:[["th-abs-object"]],inputs:{lookAt:"lookAt"},features:[Se],decls:0,vars:0,template:function(t,n){},encapsulation:2}),i})(),on=(()=>{class i extends Yne{constructor(t){super(t)}getType(){return gn}set id(t){this._objRef&&(this._objRef.id=t)}set uuid(t){this._objRef&&(this._objRef.uuid=t)}set name(t){this._objRef&&(this._objRef.name=t)}set type(t){this._objRef&&(this._objRef.type=t)}set children(t){this._objRef&&(this._objRef.children=t)}set up(t){this._objRef&&(this._objRef.up=Ft(this._objRef.up,t))}set position(t){this._objRef&&Ft(this._objRef.position,t)}set rotation(t){this._objRef&&Ft(this._objRef.rotation,t)}set quaternion(t){this._objRef&&Ft(this._objRef.quaternion,t)}set scale(t){this._objRef&&Ft(this._objRef.scale,t)}set modelViewMatrix(t){this._objRef&&Ft(this._objRef.modelViewMatrix,t)}set normalMatrix(t){this._objRef&&Ft(this._objRef.normalMatrix,t)}set matrix(t){this._objRef&&(this._objRef.matrix=Ft(this._objRef.matrix,t))}set matrixWorld(t){this._objRef&&(this._objRef.matrixWorld=Ft(this._objRef.matrixWorld,t))}set matrixAutoUpdate(t){this._objRef&&(this._objRef.matrixAutoUpdate=t)}set matrixWorldNeedsUpdate(t){this._objRef&&(this._objRef.matrixWorldNeedsUpdate=t)}set layers(t){this._objRef&&(this._objRef.layers=Ft(this._objRef.layers,t))}set visible(t){this._objRef&&(this._objRef.visible=t)}set castShadow(t){this._objRef&&(this._objRef.castShadow=t)}set receiveShadow(t){this._objRef&&(this._objRef.receiveShadow=t)}set frustumCulled(t){this._objRef&&(this._objRef.frustumCulled=t)}set renderOrder(t){this._objRef&&(this._objRef.renderOrder=t)}set animations(t){this._objRef&&(this._objRef.animations=t)}set userData(t){this._objRef&&(this._objRef.userData=t)}set customDepthMaterial(t){this._objRef&&(this._objRef.customDepthMaterial=t)}set customDistanceMaterial(t){this._objRef&&(this._objRef.customDistanceMaterial=t)}set onBeforeRender(t){this._objRef&&(this._objRef.onBeforeRender=t)}set onAfterRender(t){this._objRef&&(this._objRef.onAfterRender=t)}}return i.\u0275fac=function(t){return new(t||i)(N(i,4))},i.\u0275cmp=De({type:i,selectors:[["th-object3D"]],inputs:{id:"id",uuid:"uuid",name:"name",type:"type",children:"children",up:"up",position:"position",rotation:"rotation",quaternion:"quaternion",scale:"scale",modelViewMatrix:"modelViewMatrix",normalMatrix:"normalMatrix",matrix:"matrix",matrixWorld:"matrixWorld",matrixAutoUpdate:"matrixAutoUpdate",matrixWorldNeedsUpdate:"matrixWorldNeedsUpdate",layers:"layers",visible:"visible",castShadow:"castShadow",receiveShadow:"receiveShadow",frustumCulled:"frustumCulled",renderOrder:"renderOrder",animations:"animations",userData:"userData",customDepthMaterial:"customDepthMaterial",customDistanceMaterial:"customDistanceMaterial",onBeforeRender:"onBeforeRender",onAfterRender:"onAfterRender"},features:[Xe([]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),vT=(()=>{class i extends on{getType(){return Qf}set matrixWorldInverse(t){this._objRef&&(this._objRef.matrixWorldInverse=Ft(this._objRef.matrixWorldInverse,t))}set projectionMatrix(t){this._objRef&&(this._objRef.projectionMatrix=Ft(this._objRef.projectionMatrix,t))}set projectionMatrixInverse(t){this._objRef&&(this._objRef.projectionMatrixInverse=Ft(this._objRef.projectionMatrixInverse,t))}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-camera"]],inputs:{matrixWorldInverse:"matrixWorldInverse",projectionMatrix:"projectionMatrix",projectionMatrixInverse:"projectionMatrixInverse"},features:[Xe([{provide:on,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),Lr=(()=>{class i extends vT{getType(){return zi}set type(t){this._objRef&&(this._objRef.type=t)}set zoom(t){this._objRef&&(this._objRef.zoom=t)}set fov(t){this._objRef&&(this._objRef.fov=t)}set aspect(t){this._objRef&&(this._objRef.aspect=t)}set near(t){this._objRef&&(this._objRef.near=t)}set far(t){this._objRef&&(this._objRef.far=t)}set focus(t){this._objRef&&(this._objRef.focus=t)}set view(t){this._objRef&&(this._objRef.view=t)}set filmGauge(t){this._objRef&&(this._objRef.filmGauge=t)}set filmOffset(t){this._objRef&&(this._objRef.filmOffset=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-perspectiveCamera"]],inputs:{type:"type",zoom:"zoom",fov:"fov",aspect:"aspect",near:"near",far:"far",focus:"focus",view:"view",filmGauge:"filmGauge",filmOffset:"filmOffset"},features:[Xe([{provide:on,useExisting:qe(()=>i)},{provide:vT,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),Qne=(()=>{class i extends on{getType(){return wi}set geometry(t){this._objRef&&(this._objRef.geometry=t)}set material(t){this._objRef&&(this._objRef.material=t)}set type(t){this._objRef&&(this._objRef.type=t)}set morphTargetInfluences(t){this._objRef&&(this._objRef.morphTargetInfluences=t)}set morphTargetDictionary(t){this._objRef&&(this._objRef.morphTargetDictionary=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-line"]],inputs:{geometry:"geometry",material:"material",type:"type",morphTargetInfluences:"morphTargetInfluences",morphTargetDictionary:"morphTargetDictionary"},features:[Xe([{provide:on,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),SN=(()=>{class i extends Qne{getType(){return As}set type(t){this._objRef&&(this._objRef.type=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-lineSegments"]],inputs:{type:"type"},features:[Xe([{provide:on,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),zc=(()=>{class i extends SN{getType(){return fT}set type(t){this._objRef&&(this._objRef.type=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-gridHelper"]],inputs:{type:"type"},features:[Xe([{provide:on,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),_p=(()=>{class i extends on{getType(){return Da}set type(t){this._objRef&&(this._objRef.type=t)}set color(t){this._objRef&&(this._objRef.color=Ft(this._objRef.color,t))}set intensity(t){this._objRef&&(this._objRef.intensity=t)}set shadow(t){this._objRef&&(this._objRef.shadow=t)}set shadowCameraFov(t){this._objRef&&(this._objRef.shadowCameraFov=t)}set shadowCameraLeft(t){this._objRef&&(this._objRef.shadowCameraLeft=t)}set shadowCameraRight(t){this._objRef&&(this._objRef.shadowCameraRight=t)}set shadowCameraTop(t){this._objRef&&(this._objRef.shadowCameraTop=t)}set shadowCameraBottom(t){this._objRef&&(this._objRef.shadowCameraBottom=t)}set shadowCameraNear(t){this._objRef&&(this._objRef.shadowCameraNear=t)}set shadowCameraFar(t){this._objRef&&(this._objRef.shadowCameraFar=t)}set shadowBias(t){this._objRef&&(this._objRef.shadowBias=t)}set shadowMapWidth(t){this._objRef&&(this._objRef.shadowMapWidth=t)}set shadowMapHeight(t){this._objRef&&(this._objRef.shadowMapHeight=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-light"]],inputs:{type:"type",color:"color",intensity:"intensity",shadow:"shadow",shadowCameraFov:"shadowCameraFov",shadowCameraLeft:"shadowCameraLeft",shadowCameraRight:"shadowCameraRight",shadowCameraTop:"shadowCameraTop",shadowCameraBottom:"shadowCameraBottom",shadowCameraNear:"shadowCameraNear",shadowCameraFar:"shadowCameraFar",shadowBias:"shadowBias",shadowMapWidth:"shadowMapWidth",shadowMapHeight:"shadowMapHeight"},features:[Xe([{provide:on,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),yT=(()=>{class i extends _p{getType(){return nT}set type(t){this._objRef&&(this._objRef.type=t)}set position(t){this._objRef&&(this._objRef.position=Ft(this._objRef.position,t))}set groundColor(t){this._objRef&&(this._objRef.groundColor=Ft(this._objRef.groundColor,t))}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-hemisphereLight"]],inputs:{type:"type",position:"position",groundColor:"groundColor"},features:[Xe([{provide:on,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),vp=(()=>{class i extends _p{getType(){return wv}set type(t){this._objRef&&(this._objRef.type=t)}set position(t){this._objRef&&Ft(this._objRef.position,t)}set target(t){this._objRef&&(this._objRef.target=t)}set intensity(t){this._objRef&&(this._objRef.intensity=t)}set shadow(t){this._objRef&&(this._objRef.shadow=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-directionalLight"]],inputs:{type:"type",position:"position",target:"target",intensity:"intensity",shadow:"shadow"},features:[Xe([{provide:on,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),Ps=(()=>{class i extends on{getType(){return Ke}set geometry(t){this._objRef&&(this._objRef.geometry=t)}set material(t){this._objRef&&(this._objRef.material=t)}set morphTargetInfluences(t){this._objRef&&(this._objRef.morphTargetInfluences=t)}set morphTargetDictionary(t){this._objRef&&(this._objRef.morphTargetDictionary=t)}set type(t){this._objRef&&(this._objRef.type=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-mesh"]],inputs:{geometry:"geometry",material:"material",morphTargetInfluences:"morphTargetInfluences",morphTargetDictionary:"morphTargetDictionary",type:"type"},features:[Xe([{provide:on,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),_r=(()=>{class i extends on{getType(){return DS}set type(t){this._objRef&&(this._objRef.type=t)}set fog(t){this._objRef&&(this._objRef.fog=t)}set overrideMaterial(t){this._objRef&&(this._objRef.overrideMaterial=t)}set autoUpdate(t){this._objRef&&(this._objRef.autoUpdate=t)}set background(t){this._objRef&&(this._objRef.background=Ft(this._objRef.background,t))}set environment(t){this._objRef&&(this._objRef.environment=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-scene"]],inputs:{type:"type",fog:"fog",overrideMaterial:"overrideMaterial",autoUpdate:"autoUpdate",background:"background",environment:"environment"},features:[Xe([{provide:on,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),$ne=(()=>{class i extends Kh{constructor(t){super(),this.parent=t}addToParent(){if(!this.parent.objRef)throw new Error("parent object doesn't hold a three js object instance");this.parent.objRef.material=this.objRef}removeFromParent(){this._objRef&&this.parent&&this.parent.objRef&&(this.parent.objRef.material=void 0)}}return i.\u0275fac=function(t){return new(t||i)(N(on))},i.\u0275cmp=De({type:i,selectors:[["th-abs-material"]],features:[Se],decls:0,vars:0,template:function(t,n){},encapsulation:2}),i})(),qh=(()=>{class i extends $ne{constructor(t){super(t)}getType(){return Ai}set alphaTest(t){this._objRef&&(this._objRef.alphaTest=t)}set alphaToCoverage(t){this._objRef&&(this._objRef.alphaToCoverage=t)}set blendDst(t){this._objRef&&(this._objRef.blendDst=t)}set blendDstAlpha(t){this._objRef&&(this._objRef.blendDstAlpha=t)}set blendEquation(t){this._objRef&&(this._objRef.blendEquation=t)}set blendEquationAlpha(t){this._objRef&&(this._objRef.blendEquationAlpha=t)}set blending(t){this._objRef&&(this._objRef.blending=t)}set blendSrc(t){this._objRef&&(this._objRef.blendSrc=t)}set blendSrcAlpha(t){this._objRef&&(this._objRef.blendSrcAlpha=t)}set clipIntersection(t){this._objRef&&(this._objRef.clipIntersection=t)}set clippingPlanes(t){this._objRef&&(this._objRef.clippingPlanes=t)}set clipShadows(t){this._objRef&&(this._objRef.clipShadows=t)}set colorWrite(t){this._objRef&&(this._objRef.colorWrite=t)}set defines(t){this._objRef&&(this._objRef.defines=t)}set depthFunc(t){this._objRef&&(this._objRef.depthFunc=t)}set depthTest(t){this._objRef&&(this._objRef.depthTest=t)}set depthWrite(t){this._objRef&&(this._objRef.depthWrite=t)}set id(t){this._objRef&&(this._objRef.id=t)}set stencilWrite(t){this._objRef&&(this._objRef.stencilWrite=t)}set stencilFunc(t){this._objRef&&(this._objRef.stencilFunc=t)}set stencilRef(t){this._objRef&&(this._objRef.stencilRef=t)}set stencilWriteMask(t){this._objRef&&(this._objRef.stencilWriteMask=t)}set stencilFuncMask(t){this._objRef&&(this._objRef.stencilFuncMask=t)}set stencilFail(t){this._objRef&&(this._objRef.stencilFail=t)}set stencilZFail(t){this._objRef&&(this._objRef.stencilZFail=t)}set stencilZPass(t){this._objRef&&(this._objRef.stencilZPass=t)}set name(t){this._objRef&&(this._objRef.name=t)}set needsUpdate(t){this._objRef&&(this._objRef.needsUpdate=t)}set opacity(t){this._objRef&&(this._objRef.opacity=t)}set polygonOffset(t){this._objRef&&(this._objRef.polygonOffset=t)}set polygonOffsetFactor(t){this._objRef&&(this._objRef.polygonOffsetFactor=t)}set polygonOffsetUnits(t){this._objRef&&(this._objRef.polygonOffsetUnits=t)}set precision(t){this._objRef&&(this._objRef.precision=t)}set premultipliedAlpha(t){this._objRef&&(this._objRef.premultipliedAlpha=t)}set dithering(t){this._objRef&&(this._objRef.dithering=t)}set side(t){this._objRef&&(this._objRef.side=t)}set shadowSide(t){this._objRef&&(this._objRef.shadowSide=t)}set toneMapped(t){this._objRef&&(this._objRef.toneMapped=t)}set transparent(t){this._objRef&&(this._objRef.transparent=t)}set type(t){this._objRef&&(this._objRef.type=t)}set uuid(t){this._objRef&&(this._objRef.uuid=t)}set vertexColors(t){this._objRef&&(this._objRef.vertexColors=t)}set visible(t){this._objRef&&(this._objRef.visible=t)}set userData(t){this._objRef&&(this._objRef.userData=t)}set version(t){this._objRef&&(this._objRef.version=t)}}return i.\u0275fac=function(t){return new(t||i)(N(on,4))},i.\u0275cmp=De({type:i,selectors:[["th-material"]],inputs:{alphaTest:"alphaTest",alphaToCoverage:"alphaToCoverage",blendDst:"blendDst",blendDstAlpha:"blendDstAlpha",blendEquation:"blendEquation",blendEquationAlpha:"blendEquationAlpha",blending:"blending",blendSrc:"blendSrc",blendSrcAlpha:"blendSrcAlpha",clipIntersection:"clipIntersection",clippingPlanes:"clippingPlanes",clipShadows:"clipShadows",colorWrite:"colorWrite",defines:"defines",depthFunc:"depthFunc",depthTest:"depthTest",depthWrite:"depthWrite",id:"id",stencilWrite:"stencilWrite",stencilFunc:"stencilFunc",stencilRef:"stencilRef",stencilWriteMask:"stencilWriteMask",stencilFuncMask:"stencilFuncMask",stencilFail:"stencilFail",stencilZFail:"stencilZFail",stencilZPass:"stencilZPass",name:"name",needsUpdate:"needsUpdate",opacity:"opacity",polygonOffset:"polygonOffset",polygonOffsetFactor:"polygonOffsetFactor",polygonOffsetUnits:"polygonOffsetUnits",precision:"precision",premultipliedAlpha:"premultipliedAlpha",dithering:"dithering",side:"side",shadowSide:"shadowSide",toneMapped:"toneMapped",transparent:"transparent",type:"type",uuid:"uuid",vertexColors:"vertexColors",visible:"visible",userData:"userData",version:"version"},features:[Xe([]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),Zh=(()=>{class i extends qh{getType(){return $S}set type(t){this._objRef&&(this._objRef.type=t)}set color(t){this._objRef&&(this._objRef.color=Ft(this._objRef.color,t))}set specular(t){this._objRef&&(this._objRef.specular=Ft(this._objRef.specular,t))}set shininess(t){this._objRef&&(this._objRef.shininess=t)}set map(t){this._objRef&&(this._objRef.map=t)}set lightMap(t){this._objRef&&(this._objRef.lightMap=t)}set lightMapIntensity(t){this._objRef&&(this._objRef.lightMapIntensity=t)}set aoMap(t){this._objRef&&(this._objRef.aoMap=t)}set aoMapIntensity(t){this._objRef&&(this._objRef.aoMapIntensity=t)}set emissive(t){this._objRef&&(this._objRef.emissive=Ft(this._objRef.emissive,t))}set emissiveIntensity(t){this._objRef&&(this._objRef.emissiveIntensity=t)}set emissiveMap(t){this._objRef&&(this._objRef.emissiveMap=t)}set bumpMap(t){this._objRef&&(this._objRef.bumpMap=t)}set bumpScale(t){this._objRef&&(this._objRef.bumpScale=t)}set normalMap(t){this._objRef&&(this._objRef.normalMap=t)}set normalMapType(t){this._objRef&&(this._objRef.normalMapType=t)}set normalScale(t){this._objRef&&(this._objRef.normalScale=Ft(this._objRef.normalScale,t))}set displacementMap(t){this._objRef&&(this._objRef.displacementMap=t)}set displacementScale(t){this._objRef&&(this._objRef.displacementScale=t)}set displacementBias(t){this._objRef&&(this._objRef.displacementBias=t)}set specularMap(t){this._objRef&&(this._objRef.specularMap=t)}set alphaMap(t){this._objRef&&(this._objRef.alphaMap=t)}set envMap(t){this._objRef&&(this._objRef.envMap=t)}set combine(t){this._objRef&&(this._objRef.combine=t)}set reflectivity(t){this._objRef&&(this._objRef.reflectivity=t)}set refractionRatio(t){this._objRef&&(this._objRef.refractionRatio=t)}set wireframe(t){this._objRef&&(this._objRef.wireframe=t)}set wireframeLinewidth(t){this._objRef&&(this._objRef.wireframeLinewidth=t)}set wireframeLinecap(t){this._objRef&&(this._objRef.wireframeLinecap=t)}set wireframeLinejoin(t){this._objRef&&(this._objRef.wireframeLinejoin=t)}set flatShading(t){this._objRef&&(this._objRef.flatShading=t)}set metal(t){this._objRef&&(this._objRef.metal=t)}set fog(t){this._objRef&&(this._objRef.fog=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-meshPhongMaterial"]],inputs:{type:"type",color:"color",specular:"specular",shininess:"shininess",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",emissive:"emissive",emissiveIntensity:"emissiveIntensity",emissiveMap:"emissiveMap",bumpMap:"bumpMap",bumpScale:"bumpScale",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",specularMap:"specularMap",alphaMap:"alphaMap",envMap:"envMap",combine:"combine",reflectivity:"reflectivity",refractionRatio:"refractionRatio",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",flatShading:"flatShading",metal:"metal",fog:"fog"},features:[Xe([{provide:qh,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),Jne=(()=>{class i extends Kh{constructor(t){super(),this.parent=t}addToParent(){!this.parent.objRef||(this.parent.objRef.geometry=this.objRef,this.parent.objRef.updateMorphTargets&&this.parent.objRef.updateMorphTargets())}removeFromParent(){this._objRef&&this.parent&&this.parent.objRef&&(this.parent.objRef.geometry=void 0)}}return i.\u0275fac=function(t){return new(t||i)(N(on))},i.\u0275cmp=De({type:i,selectors:[["th-abs-geometry"]],features:[Se],decls:0,vars:0,template:function(t,n){},encapsulation:2}),i})(),xo=(()=>{class i extends Jne{constructor(t){super(t)}getType(){return wt}set id(t){this._objRef&&(this._objRef.id=t)}set uuid(t){this._objRef&&(this._objRef.uuid=t)}set name(t){this._objRef&&(this._objRef.name=t)}set type(t){this._objRef&&(this._objRef.type=t)}set index(t){this._objRef&&(this._objRef.index=Ft(this._objRef.index,t))}set attributes(t){this._objRef&&(this._objRef.attributes=t)}set morphAttributes(t){this._objRef&&(this._objRef.morphAttributes=t)}set morphTargetsRelative(t){this._objRef&&(this._objRef.morphTargetsRelative=t)}set groups(t){this._objRef&&(this._objRef.groups=t)}set boundingBox(t){this._objRef&&(this._objRef.boundingBox=Ft(this._objRef.boundingBox,t))}set boundingSphere(t){this._objRef&&(this._objRef.boundingSphere=Ft(this._objRef.boundingSphere,t))}set drawRange(t){this._objRef&&(this._objRef.drawRange=t)}set userData(t){this._objRef&&(this._objRef.userData=t)}set drawcalls(t){this._objRef&&(this._objRef.drawcalls=t)}set offsets(t){this._objRef&&(this._objRef.offsets=t)}}return i.\u0275fac=function(t){return new(t||i)(N(on,4))},i.\u0275cmp=De({type:i,selectors:[["th-bufferGeometry"]],inputs:{id:"id",uuid:"uuid",name:"name",type:"type",index:"index",attributes:"attributes",morphAttributes:"morphAttributes",morphTargetsRelative:"morphTargetsRelative",groups:"groups",boundingBox:"boundingBox",boundingSphere:"boundingSphere",drawRange:"drawRange",userData:"userData",drawcalls:"drawcalls",offsets:"offsets"},features:[Xe([]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),bT=(()=>{class i extends xo{getType(){return Ca}set type(t){this._objRef&&(this._objRef.type=t)}set parameters(t){this._objRef&&(this._objRef.parameters=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-planeGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[Xe([{provide:xo,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();var Yh=(()=>{return(i=Yh||(Yh={})).mouseEnter="mouseEnter",i.mouseExit="mouseExit",i.click="click",Yh;var i})();let yp=(()=>{class i{constructor(){this.raycaster=new mp,this.selected=null,this.enabled=!0,this.groups=[],this.paused=!1,this.maxClickDistance=23,this.nid=i.instanceCnt++,this.onPointerMove=this.onPointerMove.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerUp=this.onPointerUp.bind(this)}ngOnDestroy(){this.disable(),this.unsubscribe()}subscribe(){if(!this.canvas)throw new Error("missing canvas");this.canvas.addEventListener("pointermove",this.onPointerMove),this.canvas.addEventListener("pointerdown",this.onPointerDown),this.canvas.addEventListener("pointerup",this.onPointerUp)}unsubscribe(){if(!this.canvas)throw new Error("missing canvas");this.canvas.removeEventListener("pointermove",this.onPointerMove),this.canvas.removeEventListener("pointerdown",this.onPointerDown),this.canvas.removeEventListener("pointerup",this.onPointerUp)}enable(){this.enabled=!0}disable(){this.enabled=!1}pause(){this.paused=!0}resume(){this.paused=!1}get isEnabled(){return this.enabled}init(t,n){this.camera=t,this.canvas=n,this.subscribe()}addEventTarget(t){this.groups.push(t)}removeEventTarget(t){const n=this.groups.indexOf(t);n>=0&&this.groups.splice(n,1)}onPointerMove(t){if(!this.isReady())return;const n=this.getFirstIntersectedGroup(t.layerX,t.layerY);if((!this.selected||this.selected!==n.target)&&(this.selected&&(this.selected.host.objRef?.dispatchEvent({type:Yh.mouseExit}),this.selected.onMouseExit(),this.selected=null),n&&n.target)){this.selected=n.target;const r={type:Yh.mouseEnter,face:n.face};this.selected.host.objRef?.dispatchEvent(r),this.selected.onMouseEnter(r)}}onPointerDown(t){this.maxClickDistance=t.width,this.pointerDownEvent=t}onPointerUp(t){const n=this.pointerDownEvent;if(this.pointerDownEvent=void 0,!this.isReady()||this.calcPointerDownUpDinstance(t,n)>this.maxClickDistance)return;const r=this.getFirstIntersectedGroup(t.layerX,t.layerY);if(r&&r.target&&r.target.host.objRef){const s={type:Yh.click,face:r.face};r.target.host.objRef.dispatchEvent(s),r.target.onClick(s)}}isReady(t){return!!(this.enabled&&(t||!this.paused)&&this.camera&&this.camera.objRef&&this.groups&&this.groups.length>0)}calcPointerDownUpDinstance(t,n){if(!n)return Number.MAX_VALUE;const r=t.layerX-n.layerX,s=t.layerY-n.layerY;return Math.sqrt(r*r+s*s)}getFirstIntersectedGroup(t,n){if(!this.camera||!this.canvas||!this.camera.objRef)return{face:null,target:null};const r=new te(t=t/this.canvas.clientWidth*2-1,n=-n/this.canvas.clientHeight*2+1);this.raycaster.setFromCamera(r,this.camera.objRef);let o,a,s=null;for(const l of this.groups){const c=l.host.objRef;if(!c)continue;const u=this.raycaster.intersectObject(c,!0);u.length>0&&(!o||o.distance>u[0].distance)&&(o=u[0],s=o.face,a=l)}return a?{target:a,face:s}:{target:null,face:null}}}return i.instanceCnt=0,i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();function Bn(i){return ui((e,t)=>{Nr(i).subscribe(Jn(t,()=>t.complete(),yy)),!t.closed&&e.subscribe(t)})}const TN={alpha:!0,antialias:!0,preserveDrawingBuffer:!0};let Hc=(()=>{class i{constructor(t){this.ngZone=t,this.clock=new Cv,this.destroyed$=new Lt,this.resizeEmitter=new yt,this.beforeRenderEmitter=new yt,this.views=[],this.beforeRender$=this.beforeRenderEmitter.pipe(Bn(this.destroyed$)),this.resize$=this.resizeEmitter.pipe(Bn(this.destroyed$))}get canvas(){return this.rendererParameters?.domElement}get renderer(){return this._renderer}ngOnDestroy(){this.resizeObserver&&this.canvas&&this.resizeObserver.unobserve(this.canvas)}initResizeObserver(){this.ngZone.runOutsideAngular(()=>{if(!this.canvas)throw new Error("missing canvas element");this.resize(),this.resizeObserver||(this.resizeObserver=new ResizeObserver(()=>{this.resize()})),this.resizeObserver.observe(this.canvas)})}initRenderer(){this._renderer||(this._renderer=new AS({canvas:this.rendererParameters?.domElement,...TN}),Object.assign(this._renderer,{...TN,...this.rendererParameters}),this.resize())}setRenderer(t){this.rendererParameters=t,this.initRenderer(),this.initResizeObserver()}addView(t){this.views.push(t);const n=this.calcRendererSize();n&&this.adjustViewDimensions(t,n.width,n.height)}render(){this.beforeRenderEmitter.emit({engine:this,delta:this.clock.getDelta()});for(const t of this.views)this.renderView(t)}renderView(t){if(!this._renderer)return;const n=t.camera,r=t.scene;if(!(n&&r&&n.objRef&&r.objRef))return;const s=this._renderer;mT(t.onRender)&&this.ngZone.run(()=>t.onRender.emit({renderer:s,scene:r,camera:n})),this.applyRendererParametersFromView(t),t.effectComposer?t.effectComposer.render():this._renderer.render(r.objRef,n.objRef)}applyRendererParametersFromView(t){!this._renderer||(t.viewPort&&(t.viewPort instanceof dn?this._renderer.setViewport(t.viewPort):this._renderer.setViewport(t.viewPort.x,t.viewPort.y,t.viewPort.width,t.viewPort.height)),t.scissor&&(t.scissor instanceof dn?this._renderer.setScissor(t.scissor):this._renderer.setScissor(t.scissor.x,t.scissor.y,t.scissor.width,t.scissor.height)),void 0!==t.scissorTest&&this._renderer.setScissorTest(t.scissorTest),t.clearColor&&this._renderer.setClearColor(t.clearColor),void 0!==t.clearAlpha&&this._renderer.setClearAlpha(t.clearAlpha),void 0!==t.shadow&&(this._renderer.shadowMap.enabled=!0))}resize(){if(!this._renderer||!this.canvas)return!1;const{width:t,height:n}=this.calcRendererSize();this._renderer.setSize(t,n,!1);for(const r of this.views)this.adjustViewDimensions(r,t,n);return this.resizeEmitter.emit({width:t,height:n}),!0}calcRendererSize(){if(!this._renderer||!this.canvas)return;const t=window.devicePixelRatio;return{width:(this.canvas.clientWidth??0)*t,height:(this.canvas.clientHeight??0)*t}}adjustViewDimensions(t,n,r){t.viewPort||(t.camera&&t.camera.objRef.aspect&&(t.camera.objRef.aspect=n/r,t.camera.objRef.updateProjectionMatrix()),t.effectComposer?.setSize(n,r))}}return i.\u0275fac=function(t){return new(t||i)(re(Pt))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})(),bp=(()=>{class i{constructor(t,n){this.engineService=t,this.ngZone=n,this.active=!0,this.destroyed$=new Lt,this.beforeRender$=this.engineService.beforeRender$,this.engineService.resize$.pipe(Bn(this.destroyed$)).subscribe(()=>this.requestAnimationFrame())}ngOnDestroy(){this.stop(),this.destroyed$.next(),this.destroyed$.complete()}start(){this.active||(this.active=!0,this.requestAnimationFrame())}stop(){this.active=!1,void 0!==this.frameId&&(cancelAnimationFrame(this.frameId),this.frameId=void 0)}isActive(){return this.active}requestAnimationFrame(){void 0===this.frameId&&this.ngZone.runOutsideAngular(()=>this.frameId=requestAnimationFrame(()=>{this.frameId=void 0,this.engineService.render(),this.active&&this.requestAnimationFrame()}))}}return i.\u0275fac=function(t){return new(t||i)(re(Hc),re(Pt))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})(),xl=(()=>{class i{constructor(t,n){this.engServ=t,this.raycaster=n,this.onRender=new yt}set contentScene(t){t&&(this.scene=t)}set effectComposer(t){this._effectComposer=t,this.configureEffectComposerRenderTarget()}get effectComposer(){return this._effectComposer}set camera(t){this._camera=t,this.initRaycaster()}get camera(){return this._camera}set contentCamera(t){t&&(this.camera=t)}set viewPort(t){this._viewPort=t,this.configureEffectComposerRenderTarget()}get viewPort(){return this._viewPort}ngOnInit(){this.initRaycaster()}initRaycaster(){this.camera&&this.engServ.canvas&&this.raycaster.init(this.camera,this.engServ.canvas)}add(t){}remove(t){}configureEffectComposerRenderTarget(){if(this.viewPort&&this.effectComposer){let t,n;this.viewPort instanceof dn?(t=this.viewPort.z,n=this.viewPort?.width):(t=this.viewPort.width,n=this.viewPort.height),this.effectComposer.setSize(t,n)}}}return i.\u0275fac=function(t){return new(t||i)(N(Hc),N(yp))},i.\u0275cmp=De({type:i,selectors:[["th-view"]],contentQueries:function(t,n,r){if(1&t&&(pi(r,_r,5),pi(r,vT,5)),2&t){let s;Et(s=Rt())&&(n.contentScene=s.first),Et(s=Rt())&&(n.contentCamera=s.first)}},inputs:{scene:"scene",effectComposer:"effectComposer",camera:"camera",shadow:"shadow",viewPort:"viewPort",scissor:"scissor",scissorTest:"scissorTest",clearColor:"clearColor",clearAlpha:"clearAlpha"},outputs:{onRender:"onRender"},features:[Xe([{provide:on,useExisting:qe(()=>i)},yp])],decls:0,vars:0,template:function(t,n){},encapsulation:2}),i})();const eie=["rendererCanvas"];let nr=(()=>{class i extends xl{constructor(t,n,r){super(t,r),this.engServ=t,this.animationLoop=n,this.raycaster=r,this.nid=i.instanceCnt++,this.disableDefaultView=!1,console.log("canvas "+this.nid)}get obj(){return this}set views(t){t.forEach(n=>this.engServ.addView(n))}set rendererCanvas(t){!t||(this._rendererCanvas=t,t.nativeElement.id+=this.nid)}get rendererCanvas(){return this._rendererCanvas}ngAfterContentChecked(){this.animationLoop.requestAnimationFrame()}ngAfterViewInit(){this.animationLoop.requestAnimationFrame()}ngOnInit(){this.applyRendererParameters(),super.ngOnInit(),this.disableDefaultView||this.engServ.addView(this)}applyRendererParameters(){if(!this.rendererCanvas)throw new Error("Missing Canvas");this.engServ.setRenderer({...this.rendererParameters,domElement:this.rendererCanvas.nativeElement})}}return i.instanceCnt=0,i.\u0275fac=function(t){return new(t||i)(N(Hc),N(bp),N(qe(()=>yp)))},i.\u0275cmp=De({type:i,selectors:[["th-canvas"]],contentQueries:function(t,n,r){if(1&t&&pi(r,xl,4),2&t){let s;Et(s=Rt())&&(n.views=s)}},viewQuery:function(t,n){if(1&t&&Pn(eie,7),2&t){let r;Et(r=Rt())&&(n.rendererCanvas=r.first)}},inputs:{rendererParameters:"rendererParameters",disableDefaultView:"disableDefaultView"},features:[Xe([{provide:on,useExisting:qe(()=>i)},Hc,bp,qe(()=>yp),{provide:xl,useExisting:qe(()=>i)}]),Se],decls:2,vars:0,consts:[["id","rendererCanvas"],["rendererCanvas",""]],template:function(t,n){1&t&&Ze(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{display:flex;flex:auto;line-height:0;height:100%}canvas[_ngcontent-%COMP%]{flex:auto;outline:none;width:100%;height:100%}"],changeDetection:0}),i})();var xp=function(){var i=0,e=document.createElement("div");function t(u){return e.appendChild(u.dom),u}function n(u){for(var h=0;h<e.children.length;h++)e.children[h].style.display=h===u?"block":"none";i=u}e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(u){u.preventDefault(),n(++i%e.children.length)},!1);var r=(performance||Date).now(),s=r,o=0,a=t(new xp.Panel("FPS","#0ff","#002")),l=t(new xp.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new xp.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:e,addPanel:t,showPanel:n,begin:function(){r=(performance||Date).now()},end:function(){o++;var u=(performance||Date).now();if(l.update(u-r,200),u>=s+1e3&&(a.update(1e3*o/(u-s),100),s=u,o=0,c)){var h=performance.memory;c.update(h.usedJSHeapSize/1048576,h.jsHeapSizeLimit/1048576)}return u},update:function(){r=this.end()},domElement:e,setMode:n}};xp.Panel=function(i,e,t){var n=1/0,r=0,s=Math.round,o=s(window.devicePixelRatio||1),a=80*o,l=48*o,c=3*o,u=2*o,h=3*o,d=15*o,f=74*o,p=30*o,m=document.createElement("canvas");m.width=a,m.height=l,m.style.cssText="width:80px;height:48px";var g=m.getContext("2d");return g.font="bold "+9*o+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=t,g.fillRect(0,0,a,l),g.fillStyle=e,g.fillText(i,c,u),g.fillRect(h,d,f,p),g.fillStyle=t,g.globalAlpha=.9,g.fillRect(h,d,f,p),{dom:m,update:function(_,v){n=Math.min(n,_),r=Math.max(r,_),g.fillStyle=t,g.globalAlpha=1,g.fillRect(0,0,a,d),g.fillStyle=e,g.fillText(s(_)+" "+i+" ("+s(n)+"-"+s(r)+")",c,u),g.drawImage(m,h+o,d,f-o,p,h,d,f-o,p),g.fillRect(h+f-o,d,o,p),g.fillStyle=t,g.globalAlpha=.9,g.fillRect(h+f-o,d,o,s((1-_/v)*p))}}};const tie=xp;let wp=(()=>{class i{constructor(t){this.engineService=t,this.stats=tie()}ngOnDestroy(){this.renderSubscription&&this.renderSubscription.unsubscribe()}ngOnInit(){if(!this.engineService.canvas)throw new Error("No canvas present");const t=this.engineService.canvas.parentElement;t&&(t.style.position="relative",this.stats.domElement.style.position="absolute",this.stats.showPanel(0),this.engineService.canvas.parentElement?.appendChild(this.stats.dom),this.renderSubscription=this.engineService.beforeRender$.subscribe(()=>{this.stats.update()}))}set thStats(t){this.stats.domElement.style.visibility=t?"visible":"hidden"}}return i.\u0275fac=function(t){return new(t||i)(N(Hc))},i.\u0275dir=tt({type:i,selectors:[["","thStats",""]],inputs:{thStats:"thStats"}}),i})();const CN="https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/assets/",Pa="assets/";class nie extends Fr{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new aie(t)}),this.register(function(t){return new pie(t)}),this.register(function(t){return new mie(t)}),this.register(function(t){return new cie(t)}),this.register(function(t){return new uie(t)}),this.register(function(t){return new hie(t)}),this.register(function(t){return new die(t)}),this.register(function(t){return new oie(t)}),this.register(function(t){return new fie(t)}),this.register(function(t){return new lie(t)}),this.register(function(t){return new rie(t)}),this.register(function(t){return new gie(t)})}load(e,t,n,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:bo.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new Ds(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let s;const o={},a={};if("string"==typeof e)s=e;else if(bo.decodeText(new Uint8Array(e,0,4))===EN){try{o[nn.KHR_BINARY_GLTF]=new _ie(e)}catch(h){return void(r&&r(h))}s=o[nn.KHR_BINARY_GLTF].content}else s=bo.decodeText(new Uint8Array(e));const l=JSON.parse(s);if(void 0===l.asset||l.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const c=new Die(l,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const h=this.pluginCallbacks[u](c);a[h.name]=h,o[h.name]=!0}if(l.extensionsUsed)for(let u=0;u<l.extensionsUsed.length;++u){const h=l.extensionsUsed[u],d=l.extensionsRequired||[];switch(h){case nn.KHR_MATERIALS_UNLIT:o[h]=new sie;break;case nn.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[h]=new bie;break;case nn.KHR_DRACO_MESH_COMPRESSION:o[h]=new vie(l,this.dracoLoader);break;case nn.KHR_TEXTURE_TRANSFORM:o[h]=new yie;break;case nn.KHR_MESH_QUANTIZATION:o[h]=new xie;break;default:d.indexOf(h)>=0&&void 0===a[h]&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(n,r)}parseAsync(e,t){const n=this;return new Promise(function(r,s){n.parse(e,t,r,s)})}}function iie(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const nn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class rie{constructor(e){this.parser=e,this.name=nn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const s=t[n];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const u=new Ce(16777215);void 0!==l.color&&u.fromArray(l.color);const h=void 0!==l.range?l.range:0;switch(l.type){case"directional":c=new wv(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new xv(u),c.distance=h;break;case"spot":c=new rT(u),c.distance=h,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,void 0!==l.intensity&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),t.cache.add(n,r),r}createNodeAttachment(e){const t=this,n=this.parser,s=n.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(l){return n._getNodeRef(t.cache,a,l)})}}class sie{constructor(){this.name=nn.KHR_MATERIALS_UNLIT}getMaterialType(){return tr}extendParams(e,t,n){const r=[];e.color=new Ce(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(n.assignTexture(e,"map",s.baseColorTexture,hn))}return Promise.all(r)}}class oie{constructor(e){this.parser=e,this.name=nn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class aie{constructor(e){this.parser=e,this.name=nn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Ra:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new te(a,a)}return Promise.all(s)}}class lie{constructor(e){this.parser=e,this.name=nn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Ra:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class cie{constructor(e){this.parser=e,this.name=nn.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Ra:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Ce(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];return void 0!==o.sheenColorFactor&&t.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,hn)),void 0!==o.sheenRoughnessTexture&&s.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class uie{constructor(e){this.parser=e,this.name=nn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Ra:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class hie{constructor(e){this.parser=e,this.name=nn.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Ra:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new Ce(a[0],a[1],a[2]),Promise.all(s)}}class die{constructor(e){this.parser=e,this.name=nn.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Ra:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class fie{constructor(e){this.parser=e,this.name=nn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Ra:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new Ce(a[0],a[1],a[2]),void 0!==o.specularColorTexture&&s.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,hn)),Promise.all(s)}}class pie{constructor(e){this.parser=e,this.name=nn.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class mie{constructor(e){this.parser=e,this.name=nn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class gie{constructor(e){this.name=nn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([s,o.ready]).then(function(a){const l=r.byteOffset||0,c=r.byteLength||0,u=r.count,h=r.byteStride,d=new ArrayBuffer(u*h),f=new Uint8Array(a[0],l,c);return o.decodeGltfBuffer(new Uint8Array(d),u,h,f,r.mode,r.filter),d})}return null}}const EN="glTF";class _ie{constructor(e){this.name=nn.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:bo.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==EN)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-12,r=new DataView(e,12);let s=0;for(;s<n;){const o=r.getUint32(s,!0);s+=4;const a=r.getUint32(s,!0);if(s+=4,1313821514===a){const l=new Uint8Array(e,12+s,o);this.content=bo.decodeText(l)}else if(5130562===a){const l=12+s;this.body=e.slice(l,l+o)}s+=o}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class vie{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=nn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const u in o){const h=wT[u]||u.toLowerCase();a[h]=o[u]}for(const u in e.attributes){const h=wT[u]||u.toLowerCase();if(void 0!==o[u]){const d=n.accessors[e.attributes[u]];c[h]=Sp[d.componentType],l[h]=!0===d.normalized}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(h){r.decodeDracoFile(u,function(d){for(const f in d.attributes){const p=d.attributes[f],m=l[f];void 0!==m&&(p.normalized=m)}h(d)},a,c)})})}}class yie{constructor(){this.name=nn.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class xT extends vo{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),r=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),s=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),a={specular:{value:(new Ce).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(l){for(const c in a)l.uniforms[c]=a[c];l.fragmentShader=l.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",r).replace("#include <metalnessmap_fragment>",s).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(l){a.specular.value=l}},specularMap:{get:function(){return a.specularMap.value},set:function(l){a.specularMap.value=l,l?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(l){a.glossiness.value=l}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(l){a.glossinessMap.value=l,l?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class bie{constructor(){this.name=nn.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity"]}getMaterialType(){return xT}extendParams(e,t,n){const r=t.extensions[this.name];e.color=new Ce(1,1,1),e.opacity=1;const s=[];if(Array.isArray(r.diffuseFactor)){const o=r.diffuseFactor;e.color.fromArray(o),e.opacity=o[3]}if(void 0!==r.diffuseTexture&&s.push(n.assignTexture(e,"map",r.diffuseTexture,hn)),e.emissive=new Ce(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new Ce(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){const o=r.specularGlossinessTexture;s.push(n.assignTexture(e,"glossinessMap",o)),s.push(n.assignTexture(e,"specularMap",o,hn))}return Promise.all(s)}createMaterial(e){const t=new xT(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=void 0===e.emissiveIntensity?1:e.emissiveIntensity,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=al,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t}}class xie{constructor(){this.name=nn.KHR_MESH_QUANTIZATION}}class AN extends Hh{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=n[s+o];return t}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=2*a,c=3*a,u=r-t,h=(n-t)/u,d=h*h,f=d*h,p=e*c,m=p-c,g=-2*f+3*d,_=f-d,v=1-g,y=_-d+h;for(let b=0;b!==a;b++)s[b]=v*o[m+b+a]+y*(o[m+b+l]*u)+g*o[p+b+a]+_*(o[p+b]*u);return s}}const wie=new bn;class Mie extends AN{interpolate_(e,t,n,r){const s=super.interpolate_(e,t,n,r);return wie.fromArray(s).normalize().toArray(s),s}}const Sp={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},DN={9728:bi,9729:si,9984:Vf,9985:g_,9986:jf,9987:ya},PN={33071:dr,33648:sh,10497:il},IN={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},wT={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},wl={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Sie={CUBICSPLINE:void 0,LINEAR:vc,STEP:ah};function Tp(i,e,t){for(const n in t.extensions)void 0===i[n]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function Gc(i,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Eie(i,e){if(i.updateMorphTargets(),void 0!==e.weights)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Rie(i){const e=i.extensions&&i.extensions[nn.KHR_DRACO_MESH_COMPRESSION];let t;return t=e?"draco:"+e.bufferView+":"+e.indices+":"+FN(e.attributes):i.indices+":"+FN(i.attributes)+":"+i.mode,t}function FN(i){let e="";const t=Object.keys(i).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+i[t[n]]+";";return e}function ST(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class Die{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new iie,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};const n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1;this.textureLoader=typeof createImageBitmap>"u"||n||r&&s<98?new zk(this.options.manager):new Jk(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Ds(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:n,userData:{}};Tp(s,a,r),Gc(a,r),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(n[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),s=(o,a)=>{const l=this.associations.get(o);null!=l&&this.associations.set(a,l);for(const[c,u]of o.children.entries())s(u,a.children[c])};return s(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&n.push(s)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[nn.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){n.load(bo.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const s=t.byteOffset||0;return n.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=IN[r.type],c=Sp[r.componentType],u=c.BYTES_PER_ELEMENT,d=r.byteOffset||0,f=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,p=!0===r.normalized;let m,g;if(f&&f!==u*l){const _=Math.floor(d/f),v="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+_+":"+r.count;let y=t.cache.get(v);y||(m=new c(a,_*f,r.count*f/u),y=new tp(m,f/u),t.cache.add(v,y)),g=new gl(y,l,d%f/u,p)}else m=null===a?new c(r.count*l):new c(a,d,r.count*l),g=new En(m,l,p);if(void 0!==r.sparse){const b=r.sparse.values.byteOffset||0,w=new(0,Sp[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*IN.SCALAR),M=new c(o[2],b,r.sparse.count*l);null!==a&&(g=new En(g.array.slice(),g.itemSize,g.normalized));for(let T=0,x=w.length;T<x;T++){const E=w[T];if(g.setX(E,M[T*l]),l>=2&&g.setY(E,M[T*l+1]),l>=3&&g.setZ(E,M[T*l+2]),l>=4&&g.setW(E,M[T*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=this.options.manager.getHandler(o.uri);null!==l&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,n){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,n).then(function(u){u.flipY=!1,o.name&&(u.name=o.name);const d=(s.samplers||{})[o.sampler]||{};return u.magFilter=DN[d.magFilter]||si,u.minFilter=DN[d.minFilter]||ya,u.wrapS=PN[d.wrapS]||il,u.wrapT=PN[d.wrapT]||il,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(h=>h.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(void 0!==o.bufferView)l=this.getDependency("bufferView",o.bufferView).then(function(h){c=!0;const d=new Blob([h],{type:o.mimeType});return l=a.createObjectURL(d),l});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(h){return new Promise(function(d,f){let p=d;!0===t.isImageBitmapLoader&&(p=function(m){const g=new mr(m);g.needsUpdate=!0,d(g)}),t.load(bo.resolveURL(h,s.path),p,void 0,f)})}).then(function(h){return!0===c&&a.revokeObjectURL(l),h.userData.mimeType=o.mimeType||function Aie(i){return i.search(/\.jpe?g($|\?)/i)>0||0===i.search(/^data\:image\/jpeg/)?"image/jpeg":i.search(/\.webp($|\?)/i)>0||0===i.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),h}).catch(function(h){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),h});return this.sourceCache[e]=u,u}assignTexture(e,t,n,r){const s=this;return this.getDependency("texture",n.index).then(function(o){if(void 0!==n.texCoord&&0!=n.texCoord&&!("aoMap"===t&&1==n.texCoord)&&console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),s.extensions[nn.KHR_TEXTURE_TRANSFORM]){const a=void 0!==n.extensions?n.extensions[nn.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[nn.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return void 0!==r&&(o.encoding=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new uv,Ai.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(a,l)),n=l}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new Pi,Ai.prototype.copy.call(l,n),l.color.copy(n.color),this.cache.add(a,l)),n=l}if(r||s||o){let a="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(a+="specular-glossiness:"),r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=n.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(n))),n=l}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=n}getMaterialType(){return vo}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},l=s.extensions||{},c=[];if(l[nn.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const h=r[nn.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];o=h.getMaterialType(),c.push(h.extendParams(a,s,t))}else if(l[nn.KHR_MATERIALS_UNLIT]){const h=r[nn.KHR_MATERIALS_UNLIT];o=h.getMaterialType(),c.push(h.extendParams(a,s,t))}else{const h=s.pbrMetallicRoughness||{};if(a.color=new Ce(1,1,1),a.opacity=1,Array.isArray(h.baseColorFactor)){const d=h.baseColorFactor;a.color.fromArray(d),a.opacity=d[3]}void 0!==h.baseColorTexture&&c.push(t.assignTexture(a,"map",h.baseColorTexture,hn)),a.metalness=void 0!==h.metallicFactor?h.metallicFactor:1,a.roughness=void 0!==h.roughnessFactor?h.roughnessFactor:1,void 0!==h.metallicRoughnessTexture&&(c.push(t.assignTexture(a,"metalnessMap",h.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",h.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=oo);const u=s.alphaMode||"OPAQUE";if("BLEND"===u?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===u&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==tr&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new te(1,1),void 0!==s.normalTexture.scale)){const h=s.normalTexture.scale;a.normalScale.set(h,h)}return void 0!==s.occlusionTexture&&o!==tr&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==tr&&(a.emissive=(new Ce).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&o!==tr&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,hn)),Promise.all(c).then(function(){let h;return h=o===xT?r[nn.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):new o(a),s.name&&(h.name=s.name),Gc(h,s),t.associations.set(h,{materials:e}),s.extensions&&Tp(r,h,s),h})}createUniqueName(e){const t=Nn.sanitizeNodeName(e||"");let n=t;for(let r=1;this.nodeNamesUsed[n];++r)n=t+"_"+r;return this.nodeNamesUsed[n]=!0,n}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function s(a){return n[nn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return ON(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],u=Rie(c),h=r[u];if(h)o.push(h.promise);else{let d;d=c.extensions&&c.extensions[nn.KHR_DRACO_MESH_COMPRESSION]?s(c):ON(new wt,c,t),r[u]={primitive:c,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const u=void 0===o[l].material?(void 0===(i=this.cache).DefaultMaterial&&(i.DefaultMaterial=new vo({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:el})),i.DefaultMaterial):this.getDependency("material",o[l].material);a.push(u)}var i;return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],h=[];for(let f=0,p=u.length;f<p;f++){const m=u[f],g=o[f];let _;const v=c[f];if(4===g.mode||5===g.mode||6===g.mode||void 0===g.mode)_=!0===s.isSkinnedMesh?new FS(m,v):new Ke(m,v),!0===_.isSkinnedMesh&&!_.geometry.attributes.skinWeight.normalized&&_.normalizeSkinWeights(),5===g.mode?_.geometry=kN(_.geometry,YL):6===g.mode&&(_.geometry=kN(_.geometry,XM));else if(1===g.mode)_=new As(m,v);else if(3===g.mode)_=new wi(m,v);else if(2===g.mode)_=new kS(m,v);else{if(0!==g.mode)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);_=new BS(m,v)}Object.keys(_.geometry.morphAttributes).length>0&&Eie(_,s),_.name=t.createUniqueName(s.name||"mesh_"+e),Gc(_,s),g.extensions&&Tp(r,_,g),t.assignFinalMaterial(_),h.push(_)}for(let f=0,p=h.length;f<p;f++)t.associations.set(h[f],{meshes:e,primitives:f});if(1===h.length)return h[0];const d=new Xo;t.associations.set(d,{meshes:e});for(let f=0,p=h.length;f<p;f++)d.add(h[f]);return d})}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new zi(kt.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new Ec(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Gc(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then(function(r){return n.inverseBindMatrices=r,n})}loadAnimation(e){const n=this.json.animations[e],r=[],s=[],o=[],a=[],l=[];for(let c=0,u=n.channels.length;c<u;c++){const h=n.channels[c],d=n.samplers[h.sampler],f=h.target,m=void 0!==n.parameters?n.parameters[d.input]:d.input,g=void 0!==n.parameters?n.parameters[d.output]:d.output;r.push(this.getDependency("node",void 0!==f.node?f.node:f.id)),s.push(this.getDependency("accessor",m)),o.push(this.getDependency("accessor",g)),a.push(d),l.push(f)}return Promise.all([Promise.all(r),Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[0],h=c[1],d=c[2],f=c[3],p=c[4],m=[];for(let _=0,v=u.length;_<v;_++){const y=u[_],b=h[_],w=d[_],M=f[_],T=p[_];if(void 0===y)continue;let x;switch(y.updateMatrix(),y.matrixAutoUpdate=!0,wl[T.path]){case wl.weights:x=Gh;break;case wl.rotation:x=yl;break;default:x=Wh}const E=y.name?y.name:y.uuid,D=void 0!==M.interpolation?Sie[M.interpolation]:vc,L=[];wl[T.path]===wl.weights?y.traverse(function(H){H.morphTargetInfluences&&L.push(H.name?H.name:H.uuid)}):L.push(E);let z=w.array;if(w.normalized){const H=ST(z.constructor),U=new Float32Array(z.length);for(let X=0,I=z.length;X<I;X++)U[X]=z[X]*H;z=U}for(let H=0,U=L.length;H<U;H++){const X=new x(L[H]+"."+wl[T.path],b.array,z,D);"CUBICSPLINE"===M.interpolation&&(X.createInterpolant=function(V){return new(this instanceof yl?Mie:AN)(this.times,this.values,this.getValueSize()/3,V)},X.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),m.push(X)}}return new Xh(n.name?n.name:"animation_"+e,void 0,m)})}createNodeMesh(e){const n=this,r=this.json.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then(function(s){const o=n._getNodeRef(n.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const n=this.extensions,r=this,s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"";return function(){const a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),Promise.all(a)}().then(function(a){let l;if(l=!0===s.isBone?new av:a.length>1?new Xo:1===a.length?a[0]:new gn,l!==a[0])for(let c=0,u=a.length;c<u;c++)l.add(a[c]);if(s.name&&(l.userData.name=s.name,l.name=o),Gc(l,s),s.extensions&&Tp(n,l,s),void 0!==s.matrix){const c=new st;c.fromArray(s.matrix),l.applyMatrix4(c)}else void 0!==s.translation&&l.position.fromArray(s.translation),void 0!==s.rotation&&l.quaternion.fromArray(s.rotation),void 0!==s.scale&&l.scale.fromArray(s.scale);return r.associations.has(l)||r.associations.set(l,{}),r.associations.get(l).nodes=e,l})}loadScene(e){const t=this.json,n=this.extensions,r=this.json.scenes[e],s=this,o=new Xo;r.name&&(o.name=s.createUniqueName(r.name)),Gc(o,r),r.extensions&&Tp(n,o,r);const a=r.nodes||[],l=[];for(let c=0,u=a.length;c<u;c++)l.push(LN(a[c],o,t,s));return Promise.all(l).then(function(){return s.associations=(u=>{const h=new Map;for(const[d,f]of s.associations)(d instanceof Ai||d instanceof mr)&&h.set(d,f);return u.traverse(d=>{const f=s.associations.get(d);null!=f&&h.set(d,f)}),h})(o),o})}}function LN(i,e,t,n){const r=t.nodes[i];return n.getDependency("node",i).then(function(s){if(void 0===r.skin)return s;let o;return n.getDependency("skin",r.skin).then(function(a){o=a;const l=[];for(let c=0,u=o.joints.length;c<u;c++)l.push(n.getDependency("node",o.joints[c]));return Promise.all(l)}).then(function(a){return s.traverse(function(l){if(!l.isMesh)return;const c=[],u=[];for(let h=0,d=a.length;h<d;h++){const f=a[h];if(f){c.push(f);const p=new st;void 0!==o.inverseBindMatrices&&p.fromArray(o.inverseBindMatrices.array,16*h),u.push(p)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',o.joints[h])}l.bind(new sp(c,u),l.matrixWorld)}),s})}).then(function(s){e.add(s);const o=[];if(r.children){const a=r.children;for(let l=0,c=a.length;l<c;l++)o.push(LN(a[l],s,t,n))}return Promise.all(o)})}function ON(i,e,t){const n=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){i.setAttribute(a,l)})}for(const o in n){const a=wT[o]||o.toLowerCase();a in i.attributes||r.push(s(n[o],a))}if(void 0!==e.indices&&!i.index){const o=t.getDependency("accessor",e.indices).then(function(a){i.setIndex(a)});r.push(o)}return Gc(i,e),function Pie(i,e,t){const n=e.attributes,r=new Ho;if(void 0===n.POSITION)return;{const a=t.json.accessors[n.POSITION],l=a.min,c=a.max;if(void 0===l||void 0===c)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new C(l[0],l[1],l[2]),new C(c[0],c[1],c[2])),a.normalized){const u=ST(Sp[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}const s=e.targets;if(void 0!==s){const a=new C,l=new C;for(let c=0,u=s.length;c<u;c++){const h=s[c];if(void 0!==h.POSITION){const d=t.json.accessors[h.POSITION],f=d.min,p=d.max;if(void 0!==f&&void 0!==p){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),d.normalized){const m=ST(Sp[d.componentType]);l.multiplyScalar(m)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}i.boundingBox=r;const o=new xa;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,i.boundingSphere=o}(i,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function Cie(i,e,t){let n=!1,r=!1,s=!1;for(let c=0,u=e.length;c<u;c++){const h=e[c];if(void 0!==h.POSITION&&(n=!0),void 0!==h.NORMAL&&(r=!0),void 0!==h.COLOR_0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(i);const o=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const h=e[c];if(n){const d=void 0!==h.POSITION?t.getDependency("accessor",h.POSITION):i.attributes.position;o.push(d)}if(r){const d=void 0!==h.NORMAL?t.getDependency("accessor",h.NORMAL):i.attributes.normal;a.push(d)}if(s){const d=void 0!==h.COLOR_0?t.getDependency("accessor",h.COLOR_0):i.attributes.color;l.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const h=c[1],d=c[2];return n&&(i.morphAttributes.position=c[0]),r&&(i.morphAttributes.normal=h),s&&(i.morphAttributes.color=d),i.morphTargetsRelative=!0,i})}(i,e.targets,t):i})}function kN(i,e){let t=i.getIndex();if(null===t){const o=[],a=i.getAttribute("position");if(void 0===a)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i;for(let l=0;l<a.count;l++)o.push(l);i.setIndex(o),t=i.getIndex()}const n=t.count-2,r=[];if(e===XM)for(let o=1;o<=n;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==n&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=i.clone();return s.setIndex(r),s}let NN=(()=>{class i{load(...t){return(new this.clazz).loadAsync(...t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})(),BN=(()=>{class i{constructor(t,n){this.host=t,this.zone=n,this.initialized=!1,this.animationLoop=ql(bp),this.proxy=function Zne(){return new Proxy(new gn,new qne)}(),t.objRef=this.proxy}set url(t){this._url=t,console.log("got some model"),this.load()}get url(){return this._url}get onLoaded(){return this.onLoaded$||(this.onLoaded$=new yt),this.onLoaded$}get onProgress(){return this.onProgress$||(this.onProgress$=new yt),this.onProgress$}ngOnInit(){this.initialized=!0,this.load()}load(){var t=this;return so(function*(){if(!t.initialized)return;if(void 0===t._url)throw new Error("missing url");if(!t.proxy)return;const n=t._url,r=mT(t.onProgress$)?o=>{t.zone.run(()=>{t.onProgress$?.next(o)})}:void 0,s=yield t.zone.runOutsideAngular(()=>t.service.load(n,r));t.animationLoop.requestAnimationFrame(),t.proxy.objRef=t.getRefFromResponse(s),t.host.objRef=t.proxy,t.onLoaded$&&void 0!==s&&t.zone.run(()=>t.onLoaded$?.next(s))})()}}return i.\u0275fac=function(t){rg()},i.\u0275dir=tt({type:i,inputs:{url:"url"},outputs:{onLoaded:"onLoaded",onProgress:"onProgress"}}),i})(),Iie=(()=>{class i extends NN{constructor(){super(...arguments),this.clazz=nie}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Qh=(()=>{class i extends BN{constructor(t,n,r){super(t,n),this.host=t,this.zone=n,this.service=r}getRefFromResponse(t){return t.scene}}return i.\u0275fac=function(t){return new(t||i)(N(on,1),N(Pt),N(Iie))},i.\u0275dir=tt({type:i,selectors:[["","loadGLTF",""]],features:[Se]}),i})(),UN=(()=>{class i{constructor(t,n){this.engineService=t,this.animationLoopService=n}get beforeRender(){return this.engineService.beforeRender$}get onResize(){return this.engineService.resize$}set renderOnDemand(t){t?this.animationLoopService.stop():this.animationLoopService.start()}get renderOnDemand(){return!this.animationLoopService.isActive()}}return i.\u0275fac=function(t){return new(t||i)(N(Hc),N(bp))},i.\u0275dir=tt({type:i,selectors:[["","beforeRender",""],["","onResize",""],["","renderOnDemand",""]],inputs:{renderOnDemand:"renderOnDemand"},outputs:{beforeRender:"beforeRender",onResize:"onResize"}}),i})(),Fie=(()=>{class i{constructor(){this.assetPath=Pa+"RobotExpressive.glb",this.states=["Idle","Walking","Running","Dance","Death","Sitting","Standing"],this.emotes=["Jump","Yes","No","Wave","Punch","ThumbsUp"],this.actions={}}onInit(t){this.animationMixer=new aN(t.scene),t.scene.traverse(n=>{n.isMesh&&(n.castShadow=!0,n.receiveShadow=!0)});for(const n of t.animations){const r=this.animationMixer.clipAction(n);this.actions[n.name]=r,(this.emotes.indexOf(n.name)>=0||this.states.indexOf(n.name)>=4)&&(r.clampWhenFinished=!0,r.loop=GM)}this.activeAction=this.actions.Walking,this.activeAction.play()}beforeRender(t){this.animationMixer&&this.animationMixer.update(t.delta)}fadeToAction(t,n){this.previousAction=this.activeAction,this.activeAction=this.actions[t],this.previousAction&&this.previousAction!==this.activeAction&&this.previousAction.fadeOut(n),this.activeAction.reset().setEffectiveTimeScale(1).setEffectiveWeight(1).fadeIn(n).play()}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["app-robot"]],decls:1,vars:2,consts:[["loadGLTF","",3,"url","castShadow","onLoaded","beforeRender"]],template:function(t,n){1&t&&(me(0,"th-mesh",0),gt("onLoaded",function(s){return n.onInit(s)})("beforeRender",function(s){return n.beforeRender(s)}),Te()),2&t&&Q("url",n.assetPath)("castShadow",!0)},dependencies:[Ps,Qh,UN],encapsulation:2,changeDetection:0}),i})(),VN=(()=>{class i{transform(t){return new ep(...t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275pipe=Qi({name:"fog",type:i,pure:!0}),i})();const Lie=["gridHelper"],Oie=function(i){return{outputEncoding:i}},kie=function(){return["#e0e0e0"]},Nie=function(){return["#e0e0e0",20,100]},Bie=function(){return[45,2,.25,100]},Uie=function(i){return[i,5,10]},Vie=function(){return[0,2,0]},jie=function(){return["#ffffff","#444444"]},zie=function(){return[0,20,0]},Hie=function(){return["#ffffff"]},Gie=function(){return[0,20,10]},Wie=function(i){return[i,0,0]},Xie=function(){return[2e3,2e3]},Kie=function(){return{color:"#999999",depthWrite:!1}},qie=function(){return[200,40,"#000000","#000000"]};let Zie=(()=>{class i{constructor(){this.Math=Math,this.outputEncoding=hn}ngAfterViewInit(){const t=this.gridHelper?.objRef?.material;t&&(t.opacity=.2,t.transparent=!0)}onBeforeRender(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["app-animation-example"]],viewQuery:function(t,n){if(1&t&&Pn(Lie,7),2&t){let r;Et(r=Rt())&&(n.gridHelper=r.first)}},decls:12,vars:38,consts:[[3,"rendererParameters","thStats","shadow","onRender"],[3,"background","fog"],[3,"args","position","lookAt"],[3,"args","position"],[3,"args","position","castShadow"],[3,"rotation","receiveShadow"],[3,"args"],[3,"args","receiveShadow"],["gridHelper",""]],template:function(t,n){1&t&&(me(0,"th-canvas",0),gt("onRender",function(){return n.onBeforeRender()}),me(1,"th-scene",1),xs(2,"fog"),Ze(3,"th-perspectiveCamera",2)(4,"th-hemisphereLight",3)(5,"th-directionalLight",4),me(6,"th-mesh",5),Ze(7,"th-planeGeometry",6)(8,"th-meshPhongMaterial",6),Te(),Ze(9,"th-gridHelper",7,8)(11,"app-robot"),Te()()),2&t&&(Q("rendererParameters",Tn(21,Oie,n.outputEncoding))("thStats",!0)("shadow",!0),se(1),Q("background",Ee(23,kie))("fog",ws(2,19,Ee(24,Nie))),se(2),Q("args",Ee(25,Bie))("position",Tn(26,Uie,-5))("lookAt",Ee(28,Vie)),se(1),Q("args",Ee(29,jie))("position",Ee(30,zie)),se(1),Q("args",Ee(31,Hie))("position",Ee(32,Gie))("castShadow",!0),se(1),Q("rotation",Tn(33,Wie,-.5*n.Math.PI))("receiveShadow",!0),se(1),Q("args",Ee(35,Xie)),se(1),Q("args",Ee(36,Kie)),se(1),Q("args",Ee(37,qie))("receiveShadow",!0))},dependencies:[Lr,zc,yT,vp,Ps,_r,Zh,bT,nr,wp,Fie,VN],encapsulation:2,changeDetection:0}),i})(),qo=(()=>{class i extends _p{getType(){return oT}set type(t){this._objRef&&(this._objRef.type=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-ambientLight"]],inputs:{type:"type"},features:[Xe([{provide:on,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),jN=(()=>{class i extends qh{getType(){return tr}set type(t){this._objRef&&(this._objRef.type=t)}set color(t){this._objRef&&(this._objRef.color=Ft(this._objRef.color,t))}set map(t){this._objRef&&(this._objRef.map=t)}set lightMap(t){this._objRef&&(this._objRef.lightMap=t)}set lightMapIntensity(t){this._objRef&&(this._objRef.lightMapIntensity=t)}set aoMap(t){this._objRef&&(this._objRef.aoMap=t)}set aoMapIntensity(t){this._objRef&&(this._objRef.aoMapIntensity=t)}set specularMap(t){this._objRef&&(this._objRef.specularMap=t)}set alphaMap(t){this._objRef&&(this._objRef.alphaMap=t)}set envMap(t){this._objRef&&(this._objRef.envMap=t)}set combine(t){this._objRef&&(this._objRef.combine=t)}set reflectivity(t){this._objRef&&(this._objRef.reflectivity=t)}set refractionRatio(t){this._objRef&&(this._objRef.refractionRatio=t)}set wireframe(t){this._objRef&&(this._objRef.wireframe=t)}set wireframeLinewidth(t){this._objRef&&(this._objRef.wireframeLinewidth=t)}set wireframeLinecap(t){this._objRef&&(this._objRef.wireframeLinecap=t)}set wireframeLinejoin(t){this._objRef&&(this._objRef.wireframeLinejoin=t)}set fog(t){this._objRef&&(this._objRef.fog=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-meshBasicMaterial"]],inputs:{type:"type",color:"color",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",specularMap:"specularMap",alphaMap:"alphaMap",envMap:"envMap",combine:"combine",reflectivity:"reflectivity",refractionRatio:"refractionRatio",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",fog:"fog"},features:[Xe([{provide:qh,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),TT=(()=>{class i extends xo{getType(){return Xn}set type(t){this._objRef&&(this._objRef.type=t)}set parameters(t){this._objRef&&(this._objRef.parameters=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-boxGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[Xe([{provide:xo,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();const Yie=function(){return{color:"purple"}},Qie=function(){return[75,2,.1,1e3]},$ie=function(){return[1,1,5]};let Jie=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["app-basic-example"]],decls:7,vars:6,consts:[[3,"args"],[3,"args","position"]],template:function(t,n){1&t&&(me(0,"th-canvas")(1,"th-scene")(2,"th-mesh"),Ze(3,"th-boxGeometry")(4,"th-meshBasicMaterial",0),Te(),Ze(5,"th-ambientLight")(6,"th-perspectiveCamera",1),Te()()),2&t&&(se(4),Q("args",Ee(3,Yie)),se(2),Q("args",Ee(4,Qie))("position",Ee(5,$ie)))},dependencies:[Lr,qo,Ps,_r,jN,TT,nr],encapsulation:2,changeDetection:0}),i})();const zN={type:"change"},CT={type:"start"},HN={type:"end"};class GN extends ls{constructor(e,t){super(),void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new C,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Cs.ROTATE,MIDDLE:Cs.DOLLY,RIGHT:Cs.PAN},this.touches={ONE:va.ROTATE,TWO:va.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(F){F.addEventListener("keydown",Wt),this._domElementKeyEvents=F},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(zN),n.update(),s=r.NONE},this.update=function(){const F=new C,le=(new bn).setFromUnitVectors(e.up,new C(0,1,0)),Ne=le.clone().invert(),je=new C,G=new bn,Ae=2*Math.PI;return function(){const _t=n.object.position;F.copy(_t).sub(n.target),F.applyQuaternion(le),a.setFromVector3(F),n.autoRotate&&s===r.NONE&&E(function T(){return 2*Math.PI/60/60*n.autoRotateSpeed}()),n.enableDamping?(a.theta+=l.theta*n.dampingFactor,a.phi+=l.phi*n.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let Le=n.minAzimuthAngle,Ye=n.maxAzimuthAngle;return isFinite(Le)&&isFinite(Ye)&&(Le<-Math.PI?Le+=Ae:Le>Math.PI&&(Le-=Ae),Ye<-Math.PI?Ye+=Ae:Ye>Math.PI&&(Ye-=Ae),a.theta=Le<=Ye?Math.max(Le,Math.min(Ye,a.theta)):a.theta>(Le+Ye)/2?Math.max(Le,a.theta):Math.min(Ye,a.theta)),a.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=c,a.radius=Math.max(n.minDistance,Math.min(n.maxDistance,a.radius)),!0===n.enableDamping?n.target.addScaledVector(u,n.dampingFactor):n.target.add(u),F.setFromSpherical(a),F.applyQuaternion(Ne),_t.copy(n.target).add(F),n.object.lookAt(n.target),!0===n.enableDamping?(l.theta*=1-n.dampingFactor,l.phi*=1-n.dampingFactor,u.multiplyScalar(1-n.dampingFactor)):(l.set(0,0,0),u.set(0,0,0)),c=1,!!(h||je.distanceToSquared(n.object.position)>o||8*(1-G.dot(n.object.quaternion))>o)&&(n.dispatchEvent(zN),je.copy(n.object.position),G.copy(n.object.quaternion),h=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",ae),n.domElement.removeEventListener("pointerdown",Me),n.domElement.removeEventListener("pointercancel",bt),n.domElement.removeEventListener("wheel",Jt),n.domElement.removeEventListener("pointermove",Je),n.domElement.removeEventListener("pointerup",Ge),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",Wt)};const n=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new Ev,l=new Ev;let c=1;const u=new C;let h=!1;const d=new te,f=new te,p=new te,m=new te,g=new te,_=new te,v=new te,y=new te,b=new te,w=[],M={};function x(){return Math.pow(.95,n.zoomSpeed)}function E(F){l.theta-=F}function D(F){l.phi-=F}const L=function(){const F=new C;return function(Ne,je){F.setFromMatrixColumn(je,0),F.multiplyScalar(-Ne),u.add(F)}}(),z=function(){const F=new C;return function(Ne,je){!0===n.screenSpacePanning?F.setFromMatrixColumn(je,1):(F.setFromMatrixColumn(je,0),F.crossVectors(n.object.up,F)),F.multiplyScalar(Ne),u.add(F)}}(),H=function(){const F=new C;return function(Ne,je){const G=n.domElement;if(n.object.isPerspectiveCamera){F.copy(n.object.position).sub(n.target);let Ue=F.length();Ue*=Math.tan(n.object.fov/2*Math.PI/180),L(2*Ne*Ue/G.clientHeight,n.object.matrix),z(2*je*Ue/G.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(L(Ne*(n.object.right-n.object.left)/n.object.zoom/G.clientWidth,n.object.matrix),z(je*(n.object.top-n.object.bottom)/n.object.zoom/G.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function U(F){n.object.isPerspectiveCamera?c/=F:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*F)),n.object.updateProjectionMatrix(),h=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function X(F){n.object.isPerspectiveCamera?c*=F:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/F)),n.object.updateProjectionMatrix(),h=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function I(F){d.set(F.clientX,F.clientY)}function W(F){m.set(F.clientX,F.clientY)}function he(){1===w.length?d.set(w[0].pageX,w[0].pageY):d.set(.5*(w[0].pageX+w[1].pageX),.5*(w[0].pageY+w[1].pageY))}function Re(){1===w.length?m.set(w[0].pageX,w[0].pageY):m.set(.5*(w[0].pageX+w[1].pageX),.5*(w[0].pageY+w[1].pageY))}function $(){const F=w[0].pageX-w[1].pageX,le=w[0].pageY-w[1].pageY,Ne=Math.sqrt(F*F+le*le);v.set(0,Ne)}function Fe(F){if(1==w.length)f.set(F.pageX,F.pageY);else{const Ne=ht(F);f.set(.5*(F.pageX+Ne.x),.5*(F.pageY+Ne.y))}p.subVectors(f,d).multiplyScalar(n.rotateSpeed);const le=n.domElement;E(2*Math.PI*p.x/le.clientHeight),D(2*Math.PI*p.y/le.clientHeight),d.copy(f)}function _e(F){if(1===w.length)g.set(F.pageX,F.pageY);else{const le=ht(F);g.set(.5*(F.pageX+le.x),.5*(F.pageY+le.y))}_.subVectors(g,m).multiplyScalar(n.panSpeed),H(_.x,_.y),m.copy(g)}function ot(F){const le=ht(F),Ne=F.pageX-le.x,je=F.pageY-le.y,G=Math.sqrt(Ne*Ne+je*je);y.set(0,G),b.set(0,Math.pow(y.y/v.y,n.zoomSpeed)),U(b.y),v.copy(y)}function Me(F){!1!==n.enabled&&(0===w.length&&(n.domElement.setPointerCapture(F.pointerId),n.domElement.addEventListener("pointermove",Je),n.domElement.addEventListener("pointerup",Ge)),function xe(F){w.push(F)}(F),"touch"===F.pointerType?function B(F){switch(Ve(F),w.length){case 1:switch(n.touches.ONE){case va.ROTATE:if(!1===n.enableRotate)return;he(),s=r.TOUCH_ROTATE;break;case va.PAN:if(!1===n.enablePan)return;Re(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(n.touches.TWO){case va.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function K(){n.enableZoom&&$(),n.enablePan&&Re()})(),s=r.TOUCH_DOLLY_PAN;break;case va.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function pe(){n.enableZoom&&$(),n.enableRotate&&he()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(CT)}(F):function mt(F){let le;switch(F.button){case 0:le=n.mouseButtons.LEFT;break;case 1:le=n.mouseButtons.MIDDLE;break;case 2:le=n.mouseButtons.RIGHT;break;default:le=-1}switch(le){case Cs.DOLLY:if(!1===n.enableZoom)return;(function V(F){v.set(F.clientX,F.clientY)})(F),s=r.DOLLY;break;case Cs.ROTATE:if(F.ctrlKey||F.metaKey||F.shiftKey){if(!1===n.enablePan)return;W(F),s=r.PAN}else{if(!1===n.enableRotate)return;I(F),s=r.ROTATE}break;case Cs.PAN:if(F.ctrlKey||F.metaKey||F.shiftKey){if(!1===n.enableRotate)return;I(F),s=r.ROTATE}else{if(!1===n.enablePan)return;W(F),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(CT)}(F))}function Je(F){!1!==n.enabled&&("touch"===F.pointerType?function P(F){switch(Ve(F),s){case r.TOUCH_ROTATE:if(!1===n.enableRotate)return;Fe(F),n.update();break;case r.TOUCH_PAN:if(!1===n.enablePan)return;_e(F),n.update();break;case r.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function ue(F){n.enableZoom&&ot(F),n.enablePan&&_e(F)})(F),n.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function de(F){n.enableZoom&&ot(F),n.enableRotate&&Fe(F)})(F),n.update();break;default:s=r.NONE}}(F):function dt(F){if(!1!==n.enabled)switch(s){case r.ROTATE:if(!1===n.enableRotate)return;!function j(F){f.set(F.clientX,F.clientY),p.subVectors(f,d).multiplyScalar(n.rotateSpeed);const le=n.domElement;E(2*Math.PI*p.x/le.clientHeight),D(2*Math.PI*p.y/le.clientHeight),d.copy(f),n.update()}(F);break;case r.DOLLY:if(!1===n.enableZoom)return;!function q(F){y.set(F.clientX,F.clientY),b.subVectors(y,v),b.y>0?U(x()):b.y<0&&X(x()),v.copy(y),n.update()}(F);break;case r.PAN:if(!1===n.enablePan)return;!function oe(F){g.set(F.clientX,F.clientY),_.subVectors(g,m).multiplyScalar(n.panSpeed),H(_.x,_.y),m.copy(g),n.update()}(F)}}(F))}function Ge(F){Pe(F),0===w.length&&(n.domElement.releasePointerCapture(F.pointerId),n.domElement.removeEventListener("pointermove",Je),n.domElement.removeEventListener("pointerup",Ge)),n.dispatchEvent(HN),s=r.NONE}function bt(F){Pe(F)}function Jt(F){!1===n.enabled||!1===n.enableZoom||s!==r.NONE||(F.preventDefault(),n.dispatchEvent(CT),function J(F){F.deltaY<0?X(x()):F.deltaY>0&&U(x()),n.update()}(F),n.dispatchEvent(HN))}function Wt(F){!1===n.enabled||!1===n.enablePan||function fe(F){let le=!1;switch(F.code){case n.keys.UP:H(0,n.keyPanSpeed),le=!0;break;case n.keys.BOTTOM:H(0,-n.keyPanSpeed),le=!0;break;case n.keys.LEFT:H(n.keyPanSpeed,0),le=!0;break;case n.keys.RIGHT:H(-n.keyPanSpeed,0),le=!0}le&&(F.preventDefault(),n.update())}(F)}function ae(F){!1!==n.enabled&&F.preventDefault()}function Pe(F){delete M[F.pointerId];for(let le=0;le<w.length;le++)if(w[le].pointerId==F.pointerId)return void w.splice(le,1)}function Ve(F){let le=M[F.pointerId];void 0===le&&(le=new te,M[F.pointerId]=le),le.set(F.pageX,F.pageY)}function ht(F){return M[(F.pointerId===w[0].pointerId?w[1]:w[0]).pointerId]}n.domElement.addEventListener("contextmenu",ae),n.domElement.addEventListener("pointerdown",Me),n.domElement.addEventListener("pointercancel",bt),n.domElement.addEventListener("wheel",Jt,{passive:!1}),this.update()}}class ere extends GN{constructor(e,t){super(e,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=Cs.PAN,this.mouseButtons.RIGHT=Cs.ROTATE,this.touches.ONE=va.PAN,this.touches.TWO=va.DOLLY_ROTATE}}let vr=(()=>{class i extends Kh{constructor(t,n){super(),this._camera=t,this.canvas=n,this.renderLoop=ql(bp)}createThreeInstance(t){t||(t=[this._camera.objRef,this.canvas?.rendererCanvas?.nativeElement]);const n=super.createThreeInstance(t);return this.patchDispatchEvent(n),this.subscribeControlUpdater(n),n}patchDispatchEvent(t){if(t.dispatchEvent){const n=this.origDispatchEventMethod=t.dispatchEvent;t.dispatchEvent=r=>{n.apply(t,r),this.renderLoop.requestAnimationFrame()}}}ngOnDestroy(){super.ngOnDestroy(),this.unpatchDispatchEvent(),this.unsubscribeControlUpdater()}unpatchDispatchEvent(){this.origDispatchEventMethod&&this._objRef&&(this._objRef.dispatchEvent=this.origDispatchEventMethod)}subscribeControlUpdater(t){void 0!==t.update&&(this.beforeRenderSubscription=this.renderLoop.beforeRender$.subscribe(n=>{t.update(n.delta)}))}unsubscribeControlUpdater(){this.beforeRenderSubscription&&this.beforeRenderSubscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(N(on),N(nr))},i.\u0275cmp=De({type:i,selectors:[["th-abs-control"]],features:[Se],decls:0,vars:0,template:function(t,n){},encapsulation:2}),i})(),Cp=(()=>{class i extends vr{getType(){return GN}set object(t){this._objRef&&(this._objRef.object=t)}set domElement(t){this._objRef&&(this._objRef.domElement=t)}set enabled(t){this._objRef&&(this._objRef.enabled=t)}set target(t){this._objRef&&(this._objRef.target=Ft(this._objRef.target,t))}set center(t){this._objRef&&(this._objRef.center=Ft(this._objRef.center,t))}set minDistance(t){this._objRef&&(this._objRef.minDistance=t)}set maxDistance(t){this._objRef&&(this._objRef.maxDistance=t)}set minZoom(t){this._objRef&&(this._objRef.minZoom=t)}set maxZoom(t){this._objRef&&(this._objRef.maxZoom=t)}set minPolarAngle(t){this._objRef&&(this._objRef.minPolarAngle=t)}set maxPolarAngle(t){this._objRef&&(this._objRef.maxPolarAngle=t)}set minAzimuthAngle(t){this._objRef&&(this._objRef.minAzimuthAngle=t)}set maxAzimuthAngle(t){this._objRef&&(this._objRef.maxAzimuthAngle=t)}set enableDamping(t){this._objRef&&(this._objRef.enableDamping=t)}set dampingFactor(t){this._objRef&&(this._objRef.dampingFactor=t)}set enableZoom(t){this._objRef&&(this._objRef.enableZoom=t)}set zoomSpeed(t){this._objRef&&(this._objRef.zoomSpeed=t)}set enableRotate(t){this._objRef&&(this._objRef.enableRotate=t)}set rotateSpeed(t){this._objRef&&(this._objRef.rotateSpeed=t)}set enablePan(t){this._objRef&&(this._objRef.enablePan=t)}set panSpeed(t){this._objRef&&(this._objRef.panSpeed=t)}set screenSpacePanning(t){this._objRef&&(this._objRef.screenSpacePanning=t)}set keyPanSpeed(t){this._objRef&&(this._objRef.keyPanSpeed=t)}set autoRotate(t){this._objRef&&(this._objRef.autoRotate=t)}set autoRotateSpeed(t){this._objRef&&(this._objRef.autoRotateSpeed=t)}set keys(t){this._objRef&&(this._objRef.keys=t)}set mouseButtons(t){this._objRef&&(this._objRef.mouseButtons=t)}set touches(t){this._objRef&&(this._objRef.touches=t)}set target0(t){this._objRef&&(this._objRef.target0=Ft(this._objRef.target0,t))}set position0(t){this._objRef&&(this._objRef.position0=Ft(this._objRef.position0,t))}set zoomO(t){this._objRef&&(this._objRef.zoomO=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-orbitControls"]],inputs:{object:"object",domElement:"domElement",enabled:"enabled",target:"target",center:"center",minDistance:"minDistance",maxDistance:"maxDistance",minZoom:"minZoom",maxZoom:"maxZoom",minPolarAngle:"minPolarAngle",maxPolarAngle:"maxPolarAngle",minAzimuthAngle:"minAzimuthAngle",maxAzimuthAngle:"maxAzimuthAngle",enableDamping:"enableDamping",dampingFactor:"dampingFactor",enableZoom:"enableZoom",zoomSpeed:"zoomSpeed",enableRotate:"enableRotate",rotateSpeed:"rotateSpeed",enablePan:"enablePan",panSpeed:"panSpeed",screenSpacePanning:"screenSpacePanning",keyPanSpeed:"keyPanSpeed",autoRotate:"autoRotate",autoRotateSpeed:"autoRotateSpeed",keys:"keys",mouseButtons:"mouseButtons",touches:"touches",target0:"target0",position0:"position0",zoomO:"zoomO"},features:[Xe([{provide:vr,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),Wc=(()=>{class i extends _p{getType(){return xv}set type(t){this._objRef&&(this._objRef.type=t)}set intensity(t){this._objRef&&(this._objRef.intensity=t)}set distance(t){this._objRef&&(this._objRef.distance=t)}set decay(t){this._objRef&&(this._objRef.decay=t)}set shadow(t){this._objRef&&(this._objRef.shadow=t)}set power(t){this._objRef&&(this._objRef.power=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-pointLight"]],inputs:{type:"type",intensity:"intensity",distance:"distance",decay:"decay",shadow:"shadow",power:"power"},features:[Xe([{provide:on,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),Lv=(()=>{class i{constructor(t,n){this.host=t,this.raycasterService=n,this.mouseEnter=new yt,this.mouseExit=new yt,this.click=new yt,this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseExit=this.onMouseExit.bind(this),this.onClick=this.onClick.bind(this)}ngAfterViewInit(){this.subscribeEvents()}subscribeEvents(){this.raycasterService.addEventTarget(this)}unSubscribeEvents(){this.raycasterService.removeEventTarget(this)}onMouseExit(){this.mouseExit.emit({component:this.host})}onMouseEnter(t){this.mouseEnter.emit({component:this.host,face:t.face})}onClick(t){this.click.emit({component:this.host,face:t.face})}ngOnDestroy(){this.unSubscribeEvents()}}return i.\u0275fac=function(t){return new(t||i)(N(on,1),N(yp))},i.\u0275dir=tt({type:i,selectors:[["","onClick",""],["","onMouseEnter",""],["","onMouseExit",""]],outputs:{mouseEnter:"onMouseEnter",mouseExit:"onMouseExit",click:"onClick"}}),i})();const tre=function(){return[2,2,2]},nre=function(){return[1,1,1]},ire=function(){return[10,10]},WN=function(){return[10,10,10]},rre=function(){return[45,2,.1,100]},sre=function(){return[0,0,0]};let ore=(()=>{class i{constructor(){this.selected=!1,this.glbPath=`${Pa}DamagedHelmet.glb`}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["app-controls-example"]],decls:8,vars:15,consts:[[3,"thStats"],["loadGLTF","",3,"url","scale","onClick"],[3,"args"],[3,"position"],[3,"args","position","lookAt"]],template:function(t,n){1&t&&(me(0,"th-canvas",0)(1,"th-scene"),Ze(2,"th-ambientLight"),me(3,"th-object3D",1),gt("onClick",function(){return n.selected=!n.selected}),Te(),Ze(4,"th-gridHelper",2)(5,"th-pointLight",3),me(6,"th-perspectiveCamera",4),Ze(7,"th-orbitControls"),Te()()()),2&t&&(Q("thStats",!0),se(3),Q("url",n.glbPath)("scale",n.selected?Ee(8,tre):Ee(9,nre)),se(1),Q("args",Ee(10,ire)),se(1),Q("position",Ee(11,WN)),se(1),Q("args",Ee(12,rre))("position",Ee(13,WN))("lookAt",Ee(14,sre)))},dependencies:[Cp,Lr,on,zc,Wc,qo,_r,nr,Qh,Lv,wp],encapsulation:2,changeDetection:0}),i})();const are=function(){return[0,1,0]},lre=function(){return[10,10]},XN=function(){return[10,10,10]},cre=function(){return[45,2,.1,100]},ure=function(){return[0,0,0]};let hre=(()=>{class i{constructor(t){this.cdref=t,this.modelScale=[1,1,1],this.rotation=[0,0,0],this.modelUrl1=`${Pa}DamagedHelmet.glb`,this.modelUrl2=`${Pa}BoomBox.glb`,this.modelUrl=this.toggleModel(),this.intervalHandle=window.setInterval(()=>this.toggleModel(),3e3)}toggleModel(){return this.modelUrl=this.modelUrl!==this.modelUrl1?this.modelUrl1:this.modelUrl2,this.cdref.markForCheck(),this.modelUrl}onLoaded(){this.modelScale=this.modelUrl!==this.modelUrl1?[100,100,100]:[1,1,1]}onRefChange(t){}onBeforeRender(){this.rotation=[0,this.rotation[1]+.01,0]}ngOnDestroy(){window.clearInterval(this.intervalHandle)}}return i.\u0275fac=function(t){return new(t||i)(N(Ci))},i.\u0275cmp=De({type:i,selectors:[["app-dynamic-loader-example"]],decls:7,vars:15,consts:[[3,"onRender"],["loadGLTF","",3,"url","scale","rotation","position","onLoaded","objRef$"],[3,"args"],[3,"position"],[3,"args","position","lookAt"]],template:function(t,n){1&t&&(me(0,"th-canvas",0),gt("onRender",function(){return n.onBeforeRender()}),me(1,"th-scene"),Ze(2,"th-ambientLight"),me(3,"th-object3D",1),gt("onLoaded",function(){return n.onLoaded()})("objRef$",function(s){return n.onRefChange(s)}),Te(),Ze(4,"th-gridHelper",2)(5,"th-pointLight",3)(6,"th-perspectiveCamera",4),Te()()),2&t&&(se(3),Q("url",n.modelUrl)("scale",n.modelScale)("rotation",n.rotation)("position",Ee(9,are)),se(1),Q("args",Ee(10,lre)),se(1),Q("position",Ee(11,XN)),se(1),Q("args",Ee(12,cre))("position",Ee(13,XN))("lookAt",Ee(14,ure)))},dependencies:[Lr,on,zc,Wc,qo,_r,nr,Qh],encapsulation:2}),i})();function dre(i,e){if(1&i&&(me(0,"li"),Cn(1),Te()),2&i){const t=e.$implicit;se(1),pg(" ",t," ")}}const fre=function(){return[10,10]},KN=function(){return[10,10,10]},pre=function(){return[45,2,.1,100]},mre=function(){return[0,0,0]};let gre=(()=>{class i{constructor(t){this.cdref=t,this.changes=[],this.rotation=[0,0,0],this.position=[0,1,0],this.assetPath=`${Pa}DamagedHelmet.glb`,window.setInterval(()=>{this.rotation=[0,this.rotation[1]+.05,0],this.cdref.markForCheck()},1500),window.setInterval(()=>{this.position=[0,(this.position[1]+1)%5,0],this.cdref.markForCheck()},3e3)}logUpdates(t){this.changes.length>=20&&this.changes.shift(),this.changes.push(Object.keys(t).toString())}onLoaded(){this.changes.push("Model loaded")}}return i.\u0275fac=function(t){return new(t||i)(N(Ci))},i.\u0275cmp=De({type:i,selectors:[["app-events-example"]],decls:12,vars:14,consts:[["loadGLTF","",3,"url","rotation","position","onUpdate","onLoaded"],[3,"args"],[3,"position"],[3,"args","position","lookAt"],[1,"change-list"],[4,"ngFor","ngForOf"]],template:function(t,n){1&t&&(me(0,"th-canvas")(1,"th-scene"),Ze(2,"th-ambientLight"),me(3,"th-object3D",0),gt("onUpdate",function(s){return n.logUpdates(s)})("onLoaded",function(){return n.onLoaded()}),Te(),Ze(4,"th-gridHelper",1)(5,"th-pointLight",2)(6,"th-perspectiveCamera",3),Te()(),me(7,"div",4)(8,"h1"),Cn(9,"Updates"),Te(),me(10,"ol"),Sn(11,dre,2,1,"li",5),Te()()),2&t&&(se(3),Q("url",n.assetPath)("rotation",n.rotation)("position",n.position),se(1),Q("args",Ee(9,fre)),se(1),Q("position",Ee(10,KN)),se(1),Q("args",Ee(11,pre))("position",Ee(12,KN))("lookAt",Ee(13,mre)),se(5),Q("ngForOf",n.changes))},dependencies:[oc,Lr,on,zc,Wc,qo,_r,nr,Qh],styles:[".change-list[_ngcontent-%COMP%]{padding:1em;box-shadow:0 4px 8px #0003;transition:.3s}[_nghost-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr)}"],changeDetection:0}),i})();const $h=JSON.parse('{"name":"ngx-three","version":"0.18.0","scripts":{"ng":"ng","start":"ng serve","build":"ng build ngx-three","build:prod":"ng build ngx-three --configuration production","build:demo":"ng build ngx-three-demo --configuration production --base-href /ngx-three/","test":"ng test","test-headless":"ng test --watch=false --browsers=ChromeHeadless","lint":"ng lint","e2e":"ng e2e","copy:docs":"(cp README.md dist/ngx-three/ || copy README.md dist\\\\ngx-three)","package":"ng build --configuration production ngx-three && npm run copy:docs","format":"prettier-eslint --write \\"{,!(node_modules|dist)/**/}*.{ts,tsx}\\""},"private":true,"dependencies":{"@angular/animations":"^14.0.2","@angular/cdk":"^14.0.2","@angular/common":"^14.0.2","@angular/compiler":"^14.0.2","@angular/core":"^14.0.2","@angular/forms":"^14.0.2","@angular/material":"^14.0.2","@angular/platform-browser":"^14.0.2","@angular/platform-browser-dynamic":"^14.0.2","@angular/router":"^14.0.2","@stackblitz/sdk":"^1.5.3","ngx-highlightjs":"^7.0.0","normalize.css":"^8.0.1","rxjs":"~7.5.5","simplex-noise":"^3.0.1","three":"~0.142.0","tslib":"^2.3.1","zone.js":"~0.11.4"},"devDependencies":{"@angular-devkit/build-angular":"^14.0.2","@angular-eslint/builder":"~13.5.0","@angular-eslint/eslint-plugin":"~13.5.0","@angular-eslint/eslint-plugin-template":"~13.5.0","@angular-eslint/schematics":"^14.0.0-alpha.3","@angular-eslint/template-parser":"~13.5.0","@angular/cli":"^14.0.2","@angular/compiler-cli":"^14.0.2","@types/jasmine":"~3.6.0","@types/node":"^18.0.0","@types/prettier":"^2.6.3","@types/three":"~0.142.0","@typescript-eslint/eslint-plugin":"5.29.0","@typescript-eslint/parser":"5.29.0","eslint":"^8.18.0","eslint-plugin-import":"^2.26.0","eslint-plugin-jsdoc":"^39.3.3","eslint-plugin-prefer-arrow":"^1.2.3","jasmine-core":"~3.6.0","jasmine-spec-reporter":"~5.0.0","karma":"~6.3.9","karma-chrome-launcher":"~3.1.0","karma-coverage":"~2.0.3","karma-jasmine":"~4.0.0","karma-jasmine-html-reporter":"^1.5.0","ng-packagr":"^14.0.2","prettier":"^2.7.1","prettier-eslint":"^15.0.1","prettier-eslint-cli":"^5.0.1","ts-node":"^10.8.1","typescript":"~4.7.4","utility-types":"^3.10.0","acorn":">=8"}}'),qN='\nimport "zone.js";';function ET(){return(ET=so(function*(i,e){const n=Ep($N(i)),r=QN(n),s={"package.json":yre(),"src/index.html":{content:YN(r)},"src/main.ts":{content:ZN(n,e)},"src/polyfills.ts":{content:qN},"src/assets.ts":{content:`export const ASSET_PATH = '${CN}';`}};yield vre(i,s),fetch("https://codesandbox.io/api/v1/sandboxes/define?json=1",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({files:s})}).then(o=>o.json()).then(o=>window.open(`https://codesandbox.io/s/${o.sandbox_id}`,"_blank"))})).apply(this,arguments)}function vre(i,e){return Promise.all(i.map(t=>fetch(t).then(function(){var n=so(function*(r){e[`src/app/${Ep(t)}`]={content:yield r.text()}});return function(r){return n.apply(this,arguments)}}())))}function yre(){return{content:{main:"src/main.ts",dependencies:{"ngx-three":"latest","@types/three":$h.devDependencies["@types/three"],...$h.dependencies},devDependencies:{...$h.devDependencies}}}}function Ep(i){return i.replace(/^.*[\\\/]/,"")}function ZN(i,e){const t=function wre(i){if(i&&i.length>0)return i[0]}(e)??function bre(i){return i.replace(".ts","").replace(/(?:^\w|[A-Z]|\b\w)/g,(e,t)=>e.toUpperCase()).replace(/[-.]/g,"")}(i),n=function Mre(i,e){return i&&i.length>0?i.join(","):e}(e,t);return`\n            import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n            import { NgModule } from '@angular/core';\n            import { BrowserModule } from '@angular/platform-browser';\n            import { NgxThreeModule } from 'ngx-three';\n            import { FormsModule } from '@angular/forms';\n            import { ${n} } from './app/${i.replace(".ts","")}';\n\n            @NgModule({\n                imports: [\n                    BrowserModule,\n                    NgxThreeModule,\n                    FormsModule\n                ],\n                providers: [],\n                declarations: [${n}],\n                bootstrap: [${t}]\n            })\n            export class AppModule {}\n\n            platformBrowserDynamic().bootstrapModule(AppModule)\n            .catch(err => console.log(err));\n            `}function YN(i){return`\n    <!DOCTYPE html>\n    <html lang="en">\n    <head>\n        <meta charset="utf-8" />\n        <title>NgxThreeDemo</title>\n        <base href="/" />\n        <meta name="viewport" content="width=device-width, initial-scale=1" />\n        <link rel="icon" type="image/x-icon" href="favicon.ico" />\n    </head>\n    <body>\n        <${i}></${i}>\n    </body>\n    </html>\n    `}function QN(i){return"app-"+i.replace(".component.ts","")}function $N(i){for(const e of i)if(e.endsWith(".ts"))return e;return""}function xre(i){for(const e of i)if(e.endsWith(".html"))return e}function Jh(i){return i&&i.origin?i.origin:"https://stackblitz.com"}function JN(){return Math.random().toString(36).substring(7)}function ed(i){var e=[];return i&&(i.forceEmbedLayout&&e.push("embed=1"),i.clickToLoad&&e.push("ctl=1"),"string"==typeof i.openFile&&e.push("file="+i.openFile),"preview"!==i.view&&"editor"!==i.view||e.push("view="+i.view),"light"!==i.theme&&"dark"!==i.theme||e.push("theme="+i.theme),i.hideExplorer&&e.push("hideExplorer=1"),i.hideNavigation&&e.push("hideNavigation=1"),i.hideDevTools&&e.push("hidedevtools=1"),"number"==typeof i.devToolsHeight&&i.devToolsHeight>=0&&i.devToolsHeight<=100&&e.push("devtoolsheight="+Math.round(i.devToolsHeight))),e.length?"?"+e.join("&"):""}function RT(i,e,t){if(null===i.parentNode)throw new Error("Invalid Element");e.id=i.id,function Tre(i,e){e&&(e.hasOwnProperty("height")&&(i.height=""+e.height),e.hasOwnProperty("width")&&(i.width=""+e.width)),i.height||(i.height="300"),i.width||i.setAttribute("style","width:100%;")}(e,t),i.parentNode.replaceChild(e,i)}function AT(i){if("string"==typeof i){var e=document.getElementById(i);if(null!==e)return e}else if(i instanceof HTMLElement)return i;throw new Error("Invalid Element")}function DT(i){return i&&!1===i.newWindow?"_self":"_blank"}var e3=function(i){var e=this;this.pending={},this.port=i,this.port.onmessage=function(t){if(t.data.payload.__reqid){var n=t.data.payload.__reqid,r=t.data.payload.__success;if(e.pending[n]){if(delete t.data.payload.__reqid,delete t.data.payload.__success,r){var s=0===Object.keys(t.data.payload).length&&t.data.payload.constructor===Object?null:t.data.payload;e.pending[n].resolve(s)}else e.pending[n].reject(t.data.payload.error?t.data.type+": "+t.data.payload.error:t.data.type);delete e.pending[n]}}}};e3.prototype.request=function(i){var e=this,t=JN();return new Promise(function(n,r){e.pending[t]={resolve:n,reject:r},i.payload.__reqid=t,e.port.postMessage(i)})};var Ov=function(i,e){var t=this;this.rdc=new e3(i),this.preview={},Object.defineProperty(this.preview,"origin",{value:e.previewOrigin,writable:!1}),this.editor={openFile:function(n){return t.rdc.request({type:"SDK_OPEN_FILE",payload:{path:n}})}}};Ov.prototype.applyFsDiff=function(i){return this.rdc.request({type:"SDK_APPLY_FS_DIFF",payload:i})},Ov.prototype.getFsSnapshot=function(){return this.rdc.request({type:"SDK_GET_FS_SNAPSHOT",payload:{}})},Ov.prototype.getDependencies=function(){return this.rdc.request({type:"SDK_GET_DEPS_SNAPSHOT",payload:{}})};var kv=[],Cre=function(i){var e=this;this.id=JN(),this.element=i,this.pending=new Promise(function(t,n){var r=function(c){c.data.action&&"SDK_INIT_SUCCESS"===c.data.action&&c.data.id===e.id&&(e.vm=new Ov(c.ports[0],c.data.payload),t(e.vm),o())},s=function(){e.element.contentWindow&&e.element.contentWindow.postMessage({action:"SDK_INIT",id:e.id},"*")};function o(){window.clearInterval(l),window.removeEventListener("message",r)}window.addEventListener("message",r),s();var a=0,l=window.setInterval(function(){if(e.vm)o();else{if(a>=20)return o(),n("Timeout: Unable to establish a connection with the StackBlitz VM"),void kv.forEach(function(c,u){c.id===e.id&&kv.splice(u,1)});a++,s()}},500)}),kv.push(this)},t3=["typescript","create-react-app","angular-cli","javascript","polymer","vue"];function Xc(i,e){var t=document.createElement("input");return t.type="hidden",t.name=i,t.value=e,t}function n3(i){-1===t3.indexOf(i.template)&&console.warn("Unsupported project template, must be one of: "+t3.join(", "));var e=document.createElement("form");return e.method="POST",e.setAttribute("style","display:none;"),e.appendChild(Xc("project[title]",i.title)),e.appendChild(Xc("project[description]",i.description)),e.appendChild(Xc("project[template]",i.template)),i.tags&&i.tags.forEach(function(t){e.appendChild(Xc("project[tags][]",t))}),i.dependencies&&e.appendChild(Xc("project[dependencies]",JSON.stringify(i.dependencies))),i.settings&&e.appendChild(Xc("project[settings]",JSON.stringify(i.settings))),Object.keys(i.files).forEach(function(t){e.appendChild(Xc("project[files]["+t+"]",i.files[t]))}),e}var Nv={connect:function(i){if(!i||!i.contentWindow)return Promise.reject("Provided element is not an iframe.");var e=function(i){var e=i instanceof Element?"element":"id";return kv.find(function(n){return n[e]===i})||null}(i);return e?e.pending:new Cre(i).pending},openGithubProject:function(i,e){window.open(Jh(e)+"/github/"+i+ed(e),DT(e))},openProject:function(i,e){!function Are(i,e){var t=n3(i);t.action=Jh(e)+"/run"+ed(e),t.target=DT(e),document.body.appendChild(t),t.submit(),document.body.removeChild(t)}(i,e)},openProjectId:function(i,e){window.open(Jh(e)+"/edit/"+i+ed(e),DT(e))},embedGithubProject:function(i,e,t){var n=AT(i),r=document.createElement("iframe");return r.src=Jh(t)+"/github/"+e+ed(t),RT(n,r,t),Nv.connect(r)},embedProject:function(i,e,t){var n=AT(i),r=function Rre(i,e){var t=n3(i);return t.action=Jh(e)+"/run"+ed(e),t.id="sb","<html><head><title></title></head><body>"+t.outerHTML+"<script>document.getElementById('sb').submit();<\/script></body></html>"}(e,t),s=document.createElement("iframe");return RT(n,s,t),s.contentDocument&&s.contentDocument.write(r),Nv.connect(s)},embedProjectId:function(i,e,t){var n=AT(i),r=document.createElement("iframe");return r.src=Jh(t)+"/edit/"+e+ed(t),RT(n,r,t),Nv.connect(r)}};const Dre=Nv;function PT(){return(PT=so(function*(i,e){const t=$N(i),n=xre(i),r=Ep(t),s=QN(r),o={template:"angular-cli",title:s,description:"ngx-three example "+s,files:{"src/index.html":YN(s),"src/main.ts":ZN(r,e),"src/polyfills.ts":qN,"src/assets.ts":`export const ASSET_PATH = '${CN}';`},dependencies:{"ngx-three":"latest","@types/three":$h.devDependencies["@types/three"],...$h.dependencies},devDependencies:{...$h.devDependencies}};yield Ire(i,o.files);const a=n?{openFile:`src/app/${Ep(n)}`}:void 0;Dre.openProject(o,a)})).apply(this,arguments)}function Ire(i,e){return Promise.all(i.map(t=>fetch(t).then(function(){var n=so(function*(r){const s=yield r.text();e[`src/app/${Ep(t)}`]=s});return function(r){return n.apply(this,arguments)}}())))}class Bv{constructor(){this.urls=[],this.fileNames=[]}setUrls(e){this.urls=e,this.fileNames=this.extractFileNames()}extractFileNames(){return this.urls.map(e=>e.split("/").pop()??"")}toStackblitz(e){e?.preventDefault(),function Pre(i,e){PT.apply(this,arguments)}(this.urls,this.declarations)}toCodeSandbox(e){e?.preventDefault(),function _re(i,e){ET.apply(this,arguments)}(this.urls,this.declarations)}}let IT;try{IT=typeof Intl<"u"&&Intl.v8BreakIterator}catch{IT=!1}let Rp,Uv,Kc,FT,yr=(()=>{class i{constructor(t){this._platformId=t,this.isBrowser=this._platformId?R2(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!IT)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return i.\u0275fac=function(t){return new(t||i)(re(_f))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function Ap(i){return function Fre(){if(null==Rp&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Rp=!0}))}finally{Rp=Rp||!1}return Rp}()?i:!!i.capture}function s3(){if(null==Kc){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Kc=!1,Kc;if("scrollBehavior"in document.documentElement.style)Kc=!0;else{const i=Element.prototype.scrollTo;Kc=!!i&&!/\{\s*\[native code\]\s*\}/.test(i.toString())}}return Kc}function Dp(){if("object"!=typeof document||!document)return 0;if(null==Uv){const i=document.createElement("div"),e=i.style;i.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),n=t.style;n.width="2px",n.height="1px",i.appendChild(t),document.body.appendChild(i),Uv=0,0===i.scrollLeft&&(i.scrollLeft=1,Uv=0===i.scrollLeft?1:2),i.remove()}return Uv}function qc(i){return i.composedPath?i.composedPath()[0]:i.target}function LT(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function nd(i,...e){return e.length?e.some(t=>i[t]):i.altKey||i.shiftKey||i.ctrlKey||i.metaKey}class qre extends $n{constructor(e,t){super()}schedule(e,t=0){return this}}const Vv={setInterval(i,e,...t){const{delegate:n}=Vv;return n?.setInterval?n.setInterval(i,e,...t):setInterval(i,e,...t)},clearInterval(i){const{delegate:e}=Vv;return(e?.clearInterval||clearInterval)(i)},delegate:void 0};class NT extends qre{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,n=0){return Vv.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;Vv.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,n=!1;try{this.work(e)}catch(s){n=!0,r=s||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,mm(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}class Pp{constructor(e,t=Pp.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}Pp.now=gT.now;class BT extends Pp{constructor(e,t=Pp.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const UT=new BT(NT),Zre=UT;function jv(i,e=UT){return ui((t,n)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const c=s;s=null,n.next(c)}};function l(){const c=o+i,u=e.now();if(u<c)return r=this.schedule(void 0,c-u),void n.add(r);a()}t.subscribe(Jn(n,c=>{s=c,o=e.now(),r||(r=e.schedule(l,i),n.add(r))},()=>{a(),n.complete()},void 0,()=>{s=r=null}))})}function VT(i){return Vi((e,t)=>i<=t)}function jT(i,e=ja){return i=i??Yre,ui((t,n)=>{let r,s=!0;t.subscribe(Jn(n,o=>{const a=e(o);(s||!i(r,a))&&(s=!1,r=a,n.next(o))}))})}function Yre(i,e){return i===e}function ai(i){return null!=i&&"false"!=`${i}`}function Is(i,e=0){return function Qre(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}(i)?Number(i):e}function zv(i){return Array.isArray(i)?i:[i]}function Ii(i){return null==i?"":"string"==typeof i?i:`${i}px`}function Zc(i){return i instanceof Kt?i.nativeElement:i}let f3=(()=>{class i{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),$re=(()=>{class i{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,n)=>this._cleanupObserver(n))}observe(t){const n=Zc(t);return new wn(r=>{const o=this._observeElement(n).subscribe(r);return()=>{o.unsubscribe(),this._unobserveElement(n)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const n=new Lt,r=this._mutationObserverFactory.create(s=>n.next(s));r&&r.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:r,stream:n,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:n,stream:r}=this._observedElements.get(t);n&&n.disconnect(),r.complete(),this._observedElements.delete(t)}}}return i.\u0275fac=function(t){return new(t||i)(re(f3))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Jre=(()=>{class i{constructor(t,n,r){this._contentObserver=t,this._elementRef=n,this._ngZone=r,this.event=new yt,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(t){this._disabled=ai(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=Is(t),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(jv(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(N($re),N(Kt),N(Pt))},i.\u0275dir=tt({type:i,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),i})(),zT=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({providers:[f3]}),i})(),ese=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({}),i})();const p3=new Set;let id,tse=(()=>{class i{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):ise}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function nse(i){if(!p3.has(i))try{id||(id=document.createElement("style"),id.setAttribute("type","text/css"),document.head.appendChild(id)),id.sheet&&(id.sheet.insertRule(`@media ${i} {body{ }}`,0),p3.add(i))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return i.\u0275fac=function(t){return new(t||i)(re(yr))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function ise(i){return{matches:"all"===i||""===i,media:i,addListener:()=>{},removeListener:()=>{}}}let m3=(()=>{class i{constructor(t,n){this._mediaMatcher=t,this._zone=n,this._queries=new Map,this._destroySubject=new Lt}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return g3(zv(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=Vw(g3(zv(t)).map(o=>this._registerQuery(o).observable));return s=Zg(s.pipe(Br(1)),s.pipe(VT(1),jv(0))),s.pipe(xt(o=>{const a={matches:!1,breakpoints:{}};return o.forEach(({matches:l,query:c})=>{a.matches=a.matches||l,a.breakpoints[c]=l}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const n=this._mediaMatcher.matchMedia(t),s={observable:new wn(o=>{const a=l=>this._zone.run(()=>o.next(l));return n.addListener(a),()=>{n.removeListener(a)}}).pipe(ma(n),xt(({matches:o})=>({query:t,matches:o})),Bn(this._destroySubject)),mql:n};return this._queries.set(t,s),s}}return i.\u0275fac=function(t){return new(t||i)(re(tse),re(Pt))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function g3(i){return i.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}class y3 extends class ase{constructor(e){this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new Lt,this._typeaheadSubscription=$n.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._skipPredicateFn=t=>t.disabled,this._pressedLetters=[],this.tabOut=new Lt,this.change=new Lt,e instanceof rc&&e.changes.subscribe(t=>{if(this._activeItem){const r=t.toArray().indexOf(this._activeItem);r>-1&&r!==this._activeItemIndex&&(this._activeItemIndex=r)}})}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(Gn(t=>this._pressedLetters.push(t)),jv(e),Vi(()=>this._pressedLetters.length>0),xt(()=>this._pressedLetters.join(""))).subscribe(t=>{const n=this._getItemsArray();for(let r=1;r<n.length+1;r++){const s=(this._activeItemIndex+r)%n.length,o=n[s];if(!this._skipPredicateFn(o)&&0===o.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(s);break}}this._pressedLetters=[]}),this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}setActiveItem(e){const t=this._activeItem;this.updateActiveItem(e),this._activeItem!==t&&this.change.next(this._activeItemIndex)}onKeydown(e){const t=e.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!e[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;default:return void((r||nd(e,"shiftKey"))&&(e.key&&1===e.key.length?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))))}this._pressedLetters=[],e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){const t=this._getItemsArray(),n="number"==typeof e?e:t.indexOf(e);this._activeItem=t[n]??null,this._activeItemIndex=n}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){const t=this._getItemsArray();for(let n=1;n<=t.length;n++){const r=(this._activeItemIndex+e*n+t.length)%t.length;if(!this._skipPredicateFn(t[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,t){const n=this._getItemsArray();if(n[e]){for(;this._skipPredicateFn(n[e]);)if(!n[e+=t])return;this.setActiveItem(e)}}_getItemsArray(){return this._items instanceof rc?this._items.toArray():this._items}}{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(e){return this._origin=e,this}setActiveItem(e){super.setActiveItem(e),this.activeItem&&this.activeItem.focus(this._origin)}}let b3=(()=>{class i{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function cse(i){return!!(i.offsetWidth||i.offsetHeight||"function"==typeof i.getClientRects&&i.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const n=function lse(i){try{return i.frameElement}catch{return null}}(function _se(i){return i.ownerDocument&&i.ownerDocument.defaultView||window}(t));if(n&&(-1===w3(n)||!this.isVisible(n)))return!1;let r=t.nodeName.toLowerCase(),s=w3(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function mse(i){let e=i.nodeName.toLowerCase(),t="input"===e&&i.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,n){return function gse(i){return!function hse(i){return function fse(i){return"input"==i.nodeName.toLowerCase()}(i)&&"hidden"==i.type}(i)&&(function use(i){let e=i.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(i)||function dse(i){return function pse(i){return"a"==i.nodeName.toLowerCase()}(i)&&i.hasAttribute("href")}(i)||i.hasAttribute("contenteditable")||x3(i))}(t)&&!this.isDisabled(t)&&(n?.ignoreVisibility||this.isVisible(t))}}return i.\u0275fac=function(t){return new(t||i)(re(yr))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function x3(i){if(!i.hasAttribute("tabindex")||void 0===i.tabIndex)return!1;let e=i.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function w3(i){if(!x3(i))return null;const e=parseInt(i.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class vse{constructor(e,t,n,r,s=!1){this._element=e,this._checker=t,this._ngZone=n,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const n=this._getFirstTabbableElement(t);return n?.focus(e),!!n}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let n=0;n<t.length;n++){const r=t[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[n]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let n=t.length-1;n>=0;n--){const r=t[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[n]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(Br(1)).subscribe(e)}}let yse=(()=>{class i{constructor(t,n,r){this._checker=t,this._ngZone=n,this._document=r}create(t,n=!1){return new vse(t,this._checker,this._ngZone,this._document,n)}}return i.\u0275fac=function(t){return new(t||i)(re(b3),re(Pt),re(Vt))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function M3(i){return 0===i.buttons||0===i.offsetX&&0===i.offsetY}function S3(i){const e=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const bse=new He("cdk-input-modality-detector-options"),xse={ignoreKeys:[18,17,224,91,16]},rd=Ap({passive:!0,capture:!0});let wse=(()=>{class i{constructor(t,n,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new ss(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(a=>a===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=qc(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(M3(o)?"keyboard":"mouse"),this._mostRecentTarget=qc(o))},this._onTouchstart=o=>{S3(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=qc(o))},this._options={...xse,...s},this.modalityDetected=this._modality.pipe(VT(1)),this.modalityChanged=this.modalityDetected.pipe(jT()),t.isBrowser&&n.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,rd),r.addEventListener("mousedown",this._onMousedown,rd),r.addEventListener("touchstart",this._onTouchstart,rd)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,rd),document.removeEventListener("mousedown",this._onMousedown,rd),document.removeEventListener("touchstart",this._onTouchstart,rd))}}return i.\u0275fac=function(t){return new(t||i)(re(yr),re(Pt),re(Vt),re(bse,8))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Sse=new He("cdk-focus-monitor-default-options"),Hv=Ap({passive:!0,capture:!0});let Ip=(()=>{class i{constructor(t,n,r,s,o){this._ngZone=t,this._platform=n,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Lt,this._rootNodeFocusAndBlurListener=a=>{const l=qc(a),c="focus"===a.type?this._onFocus:this._onBlur;for(let u=l;u;u=u.parentElement)c.call(this,a,u)},this._document=s,this._detectionMode=o?.detectionMode||0}monitor(t,n=!1){const r=Zc(t);if(!this._platform.isBrowser||1!==r.nodeType)return Mt(null);const s=function Ore(i){if(function Lre(){if(null==FT){const i=typeof document<"u"?document.head:null;FT=!(!i||!i.createShadowRoot&&!i.attachShadow)}return FT}()){const e=i.getRootNode?i.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return n&&(o.checkChildren=!0),o.subject;const a={checkChildren:n,subject:new Lt,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const n=Zc(t),r=this._elementInfo.get(n);r&&(r.subject.complete(),this._setClasses(n),this._elementInfo.delete(n),this._removeGlobalListeners(r))}focusVia(t,n,r){const s=Zc(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,l])=>this._originChanged(a,n,l)):(this._setOrigin(n),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,n)=>this.stopMonitoring(n))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,n){t.classList.toggle("cdk-focused",!!n),t.classList.toggle("cdk-touch-focused","touch"===n),t.classList.toggle("cdk-keyboard-focused","keyboard"===n),t.classList.toggle("cdk-mouse-focused","mouse"===n),t.classList.toggle("cdk-program-focused","program"===n)}_setOrigin(t,n=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&n,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,n){const r=this._elementInfo.get(n),s=qc(t);!r||!r.checkChildren&&n!==s||this._originChanged(n,this._getFocusOrigin(s),r)}_onBlur(t,n){const r=this._elementInfo.get(n);!r||r.checkChildren&&t.relatedTarget instanceof Node&&n.contains(t.relatedTarget)||(this._setClasses(n),this._emitOrigin(r,null))}_emitOrigin(t,n){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(n))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const n=t.rootNode,r=this._rootNodeFocusListenerCount.get(n)||0;r||this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",this._rootNodeFocusAndBlurListener,Hv),n.addEventListener("blur",this._rootNodeFocusAndBlurListener,Hv)}),this._rootNodeFocusListenerCount.set(n,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Bn(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const n=t.rootNode;if(this._rootNodeFocusListenerCount.has(n)){const r=this._rootNodeFocusListenerCount.get(n);r>1?this._rootNodeFocusListenerCount.set(n,r-1):(n.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Hv),n.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Hv),this._rootNodeFocusListenerCount.delete(n))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,n,r){this._setClasses(t,n),this._emitOrigin(r,n),this._lastFocusOrigin=n}_getClosestElementsInfo(t){const n=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&n.push([s,r])}),n}}return i.\u0275fac=function(t){return new(t||i)(re(Pt),re(yr),re(wse),re(Vt,8),re(Sse,8))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Tse=(()=>{class i{constructor(t,n){this._elementRef=t,this._focusMonitor=n,this.cdkFocusChange=new yt}ngAfterViewInit(){const t=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(t,1===t.nodeType&&t.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(n=>this.cdkFocusChange.emit(n))}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(Ip))},i.\u0275dir=tt({type:i,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"}}),i})();const C3="cdk-high-contrast-black-on-white",E3="cdk-high-contrast-white-on-black",HT="cdk-high-contrast-active";let R3=(()=>{class i{constructor(t,n){this._platform=t,this._document=n,this._breakpointSubscription=ql(m3).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const n=this._document.defaultView||window,r=n&&n.getComputedStyle?n.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(HT,C3,E3),this._hasCheckedHighContrastMode=!0;const n=this.getHighContrastMode();1===n?t.add(HT,C3):2===n&&t.add(HT,E3)}}}return i.\u0275fac=function(t){return new(t||i)(re(yr),re(Vt))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Cse=(()=>{class i{constructor(t){t._applyBodyHighContrastModeCssClasses()}}return i.\u0275fac=function(t){return new(t||i)(re(R3))},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[zT]}),i})();const Ese=new He("cdk-dir-doc",{providedIn:"root",factory:function Rse(){return ql(Vt)}}),Ase=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Fa=(()=>{class i{constructor(t){if(this.value="ltr",this.change=new yt,t){const r=t.documentElement?t.documentElement.dir:null;this.value=function Dse(i){const e=i?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?Ase.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||r||"ltr")}}ngOnDestroy(){this.change.complete()}}return i.\u0275fac=function(t){return new(t||i)(re(Ese,8))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Fp=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({}),i})();const Ise=new He("mat-sanity-checks",{providedIn:"root",factory:function Pse(){return!0}});let In=(()=>{class i{constructor(t,n,r){this._sanityChecks=n,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!LT()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return i.\u0275fac=function(t){return new(t||i)(re(R3),re(Ise,8),re(Vt))},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[Fp,Fp]}),i})();function Lp(i){return class extends i{constructor(...e){super(...e),this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=ai(e)}}}function Op(i,e){return class extends i{constructor(...t){super(...t),this.defaultColor=e,this.color=e}get color(){return this._color}set color(t){const n=t||this.defaultColor;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}}}function sd(i){return class extends i{constructor(...e){super(...e),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=ai(e)}}}let P3=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=tt({type:i,selectors:[["","mat-line",""],["","matLine",""]],hostAttrs:[1,"mat-line"]}),i})();function kp(i,e,t){i.nativeElement.classList.toggle(e,t)}let F3=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[In,In]}),i})();class Ose{constructor(e,t,n,r=!1){this._renderer=e,this.element=t,this.config=n,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const L3={enterDuration:225,exitDuration:150},GT=Ap({passive:!0}),O3=["mousedown","touchstart"],k3=["mouseup","mouseleave","touchend","touchcancel"];class Nse{constructor(e,t,n,r){this._target=e,this._ngZone=t,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Zc(n))}fadeInRipple(e,t,n={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...L3,...n.animation};n.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=n.radius||function Bse(i,e,t){const n=Math.max(Math.abs(i-t.left),Math.abs(i-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(n*n+r*r)}(e,t,r),a=e-r.left,l=t-r.top,c=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=a-o+"px",u.style.top=l-o+"px",u.style.height=2*o+"px",u.style.width=2*o+"px",null!=n.color&&(u.style.backgroundColor=n.color),u.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(u);const h=window.getComputedStyle(u),f=h.transitionDuration,p="none"===h.transitionProperty||"0s"===f||"0s, 0s"===f,m=new Ose(this,u,n,p);u.style.transform="scale3d(1, 1, 1)",m.state=0,n.persistent||(this._mostRecentTransientRipple=m);let g=null;return!p&&(c||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const _=()=>this._finishRippleTransition(m),v=()=>this._destroyRipple(m);u.addEventListener("transitionend",_),u.addEventListener("transitioncancel",v),g={onTransitionEnd:_,onTransitionCancel:v}}),this._activeRipples.set(m,g),(p||!c)&&this._finishRippleTransition(m),m}fadeOutRipple(e){if(2===e.state||3===e.state)return;const t=e.element,n={...L3,...e.config.animation};t.style.transitionDuration=`${n.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=Zc(e);!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,this._registerEvents(O3))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(k3),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){0===e.state?this._startFadeOutTransition(e):2===e.state&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:n}=e.config;e.state=1,!n&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=M3(e),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!n&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!S3(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let n=0;n<t.length;n++)this.fadeInRipple(t[n].clientX,t[n].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_registerEvents(e){this._ngZone.runOutsideAngular(()=>{e.forEach(t=>{this._triggerElement.addEventListener(t,this,GT)})})}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){this._triggerElement&&(O3.forEach(e=>{this._triggerElement.removeEventListener(e,this,GT)}),this._pointerUpEventsRegistered&&k3.forEach(e=>{this._triggerElement.removeEventListener(e,this,GT)}))}}const Use=new He("mat-ripple-global-options");let od=(()=>{class i{constructor(t,n,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new Nse(this,n,t,r)}get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,n=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,n,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(Pt),N(yr),N(Use,8),N(Ar,8))},i.\u0275dir=tt({type:i,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,n){2&t&&mn("mat-ripple-unbounded",n.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),i})(),Gv=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[In,In]}),i})(),WT=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[In]}),i})(),N3=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[Gv,Qa,In,WT]}),i})();function B3(...i){const e=Ry(i),{args:t,keys:n}=Q2(i),r=new wn(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let u=0;u<o;u++){let h=!1;Nr(t[u]).subscribe(Jn(s,d=>{h||(h=!0,c--),a[u]=d},()=>l--,void 0,()=>{(!l||!h)&&(c||s.next(n?$2(n,a):a),s.complete())}))}});return e?r.pipe(Uw(e)):r}class U3{}class V3{}class La{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const n=t.indexOf(":");if(n>0){const r=t.slice(0,n),s=r.toLowerCase(),o=t.slice(n+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let n=e[t];const r=t.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof La?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new La;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof La?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...n),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class jse{encodeKey(e){return j3(e)}encodeValue(e){return j3(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Hse=/%(\d[a-f0-9])/gi,Gse={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function j3(i){return encodeURIComponent(i).replace(Hse,(e,t)=>Gse[t]??e)}function Wv(i){return`${i}`}class Oa{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new jse,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function zse(i,e){const t=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t],r=Array.isArray(n)?n.map(Wv):[Wv(n)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const r=e[n];Array.isArray(r)?r.forEach(s=>{t.push({param:n,value:s,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Oa({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Wv(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let n=this.map.get(e.param)||[];const r=n.indexOf(Wv(e.value));-1!==r&&n.splice(r,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Wse{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function z3(i){return typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer}function H3(i){return typeof Blob<"u"&&i instanceof Blob}function G3(i){return typeof FormData<"u"&&i instanceof FormData}class Np{constructor(e,t,n,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Xse(i){switch(i){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,s=r):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new La),this.context||(this.context=new Wse),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new Oa,this.urlWithParams=t}serializeBody(){return null===this.body?null:z3(this.body)||H3(this.body)||G3(this.body)||function Kse(i){return typeof URLSearchParams<"u"&&i instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Oa?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||G3(this.body)?null:H3(this.body)?this.body.type||null:z3(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Oa?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,n=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let l=e.headers||this.headers,c=e.params||this.params;const u=e.context??this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((h,d)=>h.set(d,e.setHeaders[d]),l)),e.setParams&&(c=Object.keys(e.setParams).reduce((h,d)=>h.set(d,e.setParams[d]),c)),new Np(t,n,s,{params:c,headers:l,context:u,reportProgress:a,responseType:r,withCredentials:o})}}var Fi=(()=>((Fi=Fi||{})[Fi.Sent=0]="Sent",Fi[Fi.UploadProgress=1]="UploadProgress",Fi[Fi.ResponseHeader=2]="ResponseHeader",Fi[Fi.DownloadProgress=3]="DownloadProgress",Fi[Fi.Response=4]="Response",Fi[Fi.User=5]="User",Fi))();class XT{constructor(e,t=200,n="OK"){this.headers=e.headers||new La,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class KT extends XT{constructor(e={}){super(e),this.type=Fi.ResponseHeader}clone(e={}){return new KT({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Xv extends XT{constructor(e={}){super(e),this.type=Fi.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Xv({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class W3 extends XT{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function qT(i,e){return{body:e,headers:i.headers,context:i.context,observe:i.observe,params:i.params,reportProgress:i.reportProgress,responseType:i.responseType,withCredentials:i.withCredentials}}let Kv=(()=>{class i{constructor(t){this.handler=t}request(t,n,r={}){let s;if(t instanceof Np)s=t;else{let l,c;l=r.headers instanceof La?r.headers:new La(r.headers),r.params&&(c=r.params instanceof Oa?r.params:new Oa({fromObject:r.params})),s=new Np(t,n,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=Mt(s).pipe(Ju(l=>this.handler.handle(l)));if(t instanceof Np||"events"===r.observe)return o;const a=o.pipe(Vi(l=>l instanceof Xv));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(xt(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(xt(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(xt(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(xt(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,n={}){return this.request("DELETE",t,n)}get(t,n={}){return this.request("GET",t,n)}head(t,n={}){return this.request("HEAD",t,n)}jsonp(t,n){return this.request("JSONP",t,{params:(new Oa).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,n={}){return this.request("OPTIONS",t,n)}patch(t,n,r={}){return this.request("PATCH",t,qT(r,n))}post(t,n,r={}){return this.request("POST",t,qT(r,n))}put(t,n,r={}){return this.request("PUT",t,qT(r,n))}}return i.\u0275fac=function(t){return new(t||i)(re(U3))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();class X3{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const K3=new He("HTTP_INTERCEPTORS");let qse=(()=>{class i{intercept(t,n){return n.handle(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();const Zse=/^\)\]\}',?\n/;let q3=(()=>{class i{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new wn(n=>{const r=this.xhrFactory.build();if(r.open(t.method,t.urlWithParams),t.withCredentials&&(r.withCredentials=!0),t.headers.forEach((f,p)=>r.setRequestHeader(f,p.join(","))),t.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const f=t.detectContentTypeHeader();null!==f&&r.setRequestHeader("Content-Type",f)}if(t.responseType){const f=t.responseType.toLowerCase();r.responseType="json"!==f?f:"text"}const s=t.serializeBody();let o=null;const a=()=>{if(null!==o)return o;const f=r.statusText||"OK",p=new La(r.getAllResponseHeaders()),m=function Yse(i){return"responseURL"in i&&i.responseURL?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):null}(r)||t.url;return o=new KT({headers:p,status:r.status,statusText:f,url:m}),o},l=()=>{let{headers:f,status:p,statusText:m,url:g}=a(),_=null;204!==p&&(_=typeof r.response>"u"?r.responseText:r.response),0===p&&(p=_?200:0);let v=p>=200&&p<300;if("json"===t.responseType&&"string"==typeof _){const y=_;_=_.replace(Zse,"");try{_=""!==_?JSON.parse(_):null}catch(b){_=y,v&&(v=!1,_={error:b,text:_})}}v?(n.next(new Xv({body:_,headers:f,status:p,statusText:m,url:g||void 0})),n.complete()):n.error(new W3({error:_,headers:f,status:p,statusText:m,url:g||void 0}))},c=f=>{const{url:p}=a(),m=new W3({error:f,status:r.status||0,statusText:r.statusText||"Unknown Error",url:p||void 0});n.error(m)};let u=!1;const h=f=>{u||(n.next(a()),u=!0);let p={type:Fi.DownloadProgress,loaded:f.loaded};f.lengthComputable&&(p.total=f.total),"text"===t.responseType&&!!r.responseText&&(p.partialText=r.responseText),n.next(p)},d=f=>{let p={type:Fi.UploadProgress,loaded:f.loaded};f.lengthComputable&&(p.total=f.total),n.next(p)};return r.addEventListener("load",l),r.addEventListener("error",c),r.addEventListener("timeout",c),r.addEventListener("abort",c),t.reportProgress&&(r.addEventListener("progress",h),null!==s&&r.upload&&r.upload.addEventListener("progress",d)),r.send(s),n.next({type:Fi.Sent}),()=>{r.removeEventListener("error",c),r.removeEventListener("abort",c),r.removeEventListener("load",l),r.removeEventListener("timeout",c),t.reportProgress&&(r.removeEventListener("progress",h),null!==s&&r.upload&&r.upload.removeEventListener("progress",d)),r.readyState!==r.DONE&&r.abort()}})}}return i.\u0275fac=function(t){return new(t||i)(re(D2))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();const ZT=new He("XSRF_COOKIE_NAME"),YT=new He("XSRF_HEADER_NAME");class Z3{}let Qse=(()=>{class i{constructor(t,n,r){this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=_2(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return i.\u0275fac=function(t){return new(t||i)(re(Vt),re(_f),re(ZT))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})(),QT=(()=>{class i{constructor(t,n){this.tokenService=t,this.headerName=n}intercept(t,n){const r=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||r.startsWith("http://")||r.startsWith("https://"))return n.handle(t);const s=this.tokenService.getToken();return null!==s&&!t.headers.has(this.headerName)&&(t=t.clone({headers:t.headers.set(this.headerName,s)})),n.handle(t)}}return i.\u0275fac=function(t){return new(t||i)(re(Z3),re(YT))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})(),$se=(()=>{class i{constructor(t,n){this.backend=t,this.injector=n,this.chain=null}handle(t){if(null===this.chain){const n=this.injector.get(K3,[]);this.chain=n.reduceRight((r,s)=>new X3(r,s),this.backend)}return this.chain.handle(t)}}return i.\u0275fac=function(t){return new(t||i)(re(V3),re(Xi))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})(),Jse=(()=>{class i{static disable(){return{ngModule:i,providers:[{provide:QT,useClass:qse}]}}static withOptions(t={}){return{ngModule:i,providers:[t.cookieName?{provide:ZT,useValue:t.cookieName}:[],t.headerName?{provide:YT,useValue:t.headerName}:[]]}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({providers:[QT,{provide:K3,useExisting:QT,multi:!0},{provide:Z3,useClass:Qse},{provide:ZT,useValue:"XSRF-TOKEN"},{provide:YT,useValue:"X-XSRF-TOKEN"}]}),i})(),eoe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({providers:[Kv,{provide:U3,useClass:$se},q3,{provide:V3,useExisting:q3}],imports:[Jse.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),i})();const toe=["*"];let qv;function Bp(i){return function noe(){if(void 0===qv&&(qv=null,typeof window<"u")){const i=window;void 0!==i.trustedTypes&&(qv=i.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return qv}()?.createHTML(i)||i}function Y3(i){return Error(`Unable to find icon with the name "${i}"`)}function Q3(i){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${i}".`)}function $3(i){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${i}".`)}class Yc{constructor(e,t,n){this.url=e,this.svgText=t,this.options=n}}let Zv=(()=>{class i{constructor(t,n,r,s){this._httpClient=t,this._sanitizer=n,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons"],this._document=r}addSvgIcon(t,n,r){return this.addSvgIconInNamespace("",t,n,r)}addSvgIconLiteral(t,n,r){return this.addSvgIconLiteralInNamespace("",t,n,r)}addSvgIconInNamespace(t,n,r,s){return this._addSvgIconConfig(t,n,new Yc(r,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,n,r,s){const o=this._sanitizer.sanitize(pn.HTML,r);if(!o)throw $3(r);const a=Bp(o);return this._addSvgIconConfig(t,n,new Yc("",a,s))}addSvgIconSet(t,n){return this.addSvgIconSetInNamespace("",t,n)}addSvgIconSetLiteral(t,n){return this.addSvgIconSetLiteralInNamespace("",t,n)}addSvgIconSetInNamespace(t,n,r){return this._addSvgIconSetConfig(t,new Yc(n,null,r))}addSvgIconSetLiteralInNamespace(t,n,r){const s=this._sanitizer.sanitize(pn.HTML,n);if(!s)throw $3(n);const o=Bp(s);return this._addSvgIconSetConfig(t,new Yc("",o,r))}registerFontClassAlias(t,n=t){return this._fontCssClassesByAlias.set(t,n),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const n=this._sanitizer.sanitize(pn.RESOURCE_URL,t);if(!n)throw Q3(t);const r=this._cachedIconsByUrl.get(n);return r?Mt(Yv(r)):this._loadSvgIconFromConfig(new Yc(t,null)).pipe(Gn(s=>this._cachedIconsByUrl.set(n,s)),xt(s=>Yv(s)))}getNamedSvgIcon(t,n=""){const r=J3(n,t);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(n,t),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const o=this._iconSetConfigs.get(n);return o?this._getSvgFromIconSetConfigs(t,o):no(Y3(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?Mt(Yv(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(xt(n=>Yv(n)))}_getSvgFromIconSetConfigs(t,n){const r=this._extractIconWithNameFromAnySet(t,n);return r?Mt(r):B3(n.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(io(a=>{const c=`Loading icon set URL: ${this._sanitizer.sanitize(pn.RESOURCE_URL,o.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(c)),Mt(null)})))).pipe(xt(()=>{const o=this._extractIconWithNameFromAnySet(t,n);if(!o)throw Y3(t);return o}))}_extractIconWithNameFromAnySet(t,n){for(let r=n.length-1;r>=0;r--){const s=n[r];if(s.svgText&&s.svgText.toString().indexOf(t)>-1){const o=this._svgElementFromConfig(s),a=this._extractSvgIconFromSet(o,t,s.options);if(a)return a}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(Gn(n=>t.svgText=n),xt(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?Mt(null):this._fetchIcon(t).pipe(Gn(n=>t.svgText=n))}_extractSvgIconFromSet(t,n,r){const s=t.querySelector(`[id="${n}"]`);if(!s)return null;const o=s.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,r);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),r);const a=this._svgElementFromString(Bp("<svg></svg>"));return a.appendChild(o),this._setSvgAttributes(a,r)}_svgElementFromString(t){const n=this._document.createElement("DIV");n.innerHTML=t;const r=n.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const n=this._svgElementFromString(Bp("<svg></svg>")),r=t.attributes;for(let s=0;s<r.length;s++){const{name:o,value:a}=r[s];"id"!==o&&n.setAttribute(o,a)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&n.appendChild(t.childNodes[s].cloneNode(!0));return n}_setSvgAttributes(t,n){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),n&&n.viewBox&&t.setAttribute("viewBox",n.viewBox),t}_fetchIcon(t){const{url:n,options:r}=t,s=r?.withCredentials??!1;if(!this._httpClient)throw function ioe(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==n)throw Error(`Cannot fetch icon from URL "${n}".`);const o=this._sanitizer.sanitize(pn.RESOURCE_URL,n);if(!o)throw Q3(n);const a=this._inProgressUrlFetches.get(o);if(a)return a;const l=this._httpClient.get(o,{responseType:"text",withCredentials:s}).pipe(xt(c=>Bp(c)),Qg(()=>this._inProgressUrlFetches.delete(o)),Ay());return this._inProgressUrlFetches.set(o,l),l}_addSvgIconConfig(t,n,r){return this._svgIconConfigs.set(J3(t,n),r),this}_addSvgIconSetConfig(t,n){const r=this._iconSetConfigs.get(t);return r?r.push(n):this._iconSetConfigs.set(t,[n]),this}_svgElementFromConfig(t){if(!t.svgElement){const n=this._svgElementFromString(t.svgText);this._setSvgAttributes(n,t.options),t.svgElement=n}return t.svgElement}_getIconConfigFromResolvers(t,n){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](n,t);if(s)return soe(s)?new Yc(s.url,null,s.options):new Yc(s,null)}}}return i.\u0275fac=function(t){return new(t||i)(re(Kv,8),re(qg),re(Vt,8),re(aa))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function Yv(i){return i.cloneNode(!0)}function J3(i,e){return i+":"+e}function soe(i){return!(!i.url||!i.options)}const ooe=Op(class{constructor(i){this._elementRef=i}}),aoe=new He("MAT_ICON_DEFAULT_OPTIONS"),loe=new He("mat-icon-location",{providedIn:"root",factory:function coe(){const i=ql(Vt),e=i?i.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),eB=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],uoe=eB.map(i=>`[${i}]`).join(", "),hoe=/^url\(['"]?#(.*?)['"]?\)$/;let tB=(()=>{class i extends ooe{constructor(t,n,r,s,o,a){super(t),this._iconRegistry=n,this._location=s,this._errorHandler=o,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=$n.EMPTY,a&&(a.color&&(this.color=this.defaultColor=a.color),a.fontSet&&(this.fontSet=a.fontSet)),r||t.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(t){this._inline=ai(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const n=this._cleanupFontValue(t);n!==this._fontSet&&(this._fontSet=n,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const n=this._cleanupFontValue(t);n!==this._fontIcon&&(this._fontIcon=n,this._updateFontIconClasses())}_splitIconName(t){if(!t)return["",""];const n=t.split(":");switch(n.length){case 1:return["",n[0]];case 2:return n;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const n=this._location.getPathname();n!==this._previousPath&&(this._previousPath=n,this._prependPathToReferences(n))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const n=this._location.getPathname();this._previousPath=n,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(n),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let n=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();n--;){const r=t.childNodes[n];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,n=(this.fontSet?[this._iconRegistry.classNameForFontAlias(this.fontSet)]:this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>t.classList.remove(r)),n.forEach(r=>t.classList.add(r)),this._previousFontSetClass=n,this.fontIcon!==this._previousFontIconClass&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const n=this._elementsWithExternalReferences;n&&n.forEach((r,s)=>{r.forEach(o=>{s.setAttribute(o.name,`url('${t}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(t){const n=t.querySelectorAll(uoe),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<n.length;s++)eB.forEach(o=>{const a=n[s],l=a.getAttribute(o),c=l?l.match(hoe):null;if(c){let u=r.get(a);u||(u=[],r.set(a,u)),u.push({name:o,value:c[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[n,r]=this._splitIconName(t);n&&(this._svgNamespace=n),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,n).pipe(Br(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${n}:${r}! ${s.message}`))})}}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(Zv),Kl("aria-hidden"),N(loe),N(aa),N(aoe,8))},i.\u0275cmp=De({type:i,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:7,hostBindings:function(t,n){2&t&&(vi("data-mat-icon-type",n._usingFontIcon()?"font":"svg")("data-mat-icon-name",n._svgName||n.fontIcon)("data-mat-icon-namespace",n._svgNamespace||n.fontSet),mn("mat-icon-inline",n.inline)("mat-icon-no-color","primary"!==n.color&&"accent"!==n.color&&"warn"!==n.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[Se],ngContentSelectors:toe,decls:1,vars:0,template:function(t,n){1&t&&(Ji(),zn(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),i})(),$T=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[In,In]}),i})();const doe=["*",[["mat-card-footer"]]],foe=["*","mat-card-footer"];let poe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=tt({type:i,selectors:[["mat-card-content"],["","mat-card-content",""],["","matCardContent",""]],hostAttrs:[1,"mat-card-content"]}),i})(),moe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=tt({type:i,selectors:[["mat-card-footer"]],hostAttrs:[1,"mat-card-footer"]}),i})(),goe=(()=>{class i{constructor(t){this._animationMode=t}}return i.\u0275fac=function(t){return new(t||i)(N(Ar,8))},i.\u0275cmp=De({type:i,selectors:[["mat-card"]],hostAttrs:[1,"mat-card","mat-focus-indicator"],hostVars:2,hostBindings:function(t,n){2&t&&mn("_mat-animation-noopable","NoopAnimations"===n._animationMode)},exportAs:["matCard"],ngContentSelectors:foe,decls:2,vars:0,template:function(t,n){1&t&&(Ji(doe),zn(0),zn(1,1))},styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:block;position:relative;padding:16px;border-radius:4px}.mat-card._mat-animation-noopable{transition:none !important;animation:none !important}.mat-card>.mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card>.mat-divider-horizontal{left:auto;right:0}.mat-card>.mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card>.mat-divider-horizontal.mat-divider-inset{margin-right:0}.cdk-high-contrast-active .mat-card{outline:solid 1px}.mat-card-actions,.mat-card-subtitle,.mat-card-content{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px;display:block;overflow:hidden}.mat-card-image img{width:100%}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button,.mat-card-actions .mat-stroked-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media(max-width: 599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card>:first-child,.mat-card-content>:first-child{margin-top:0}.mat-card>:last-child:not(.mat-card-footer),.mat-card-content>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions:not(.mat-card-actions-align-end) .mat-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-raised-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-stroked-button:first-child{margin-left:0;margin-right:0}.mat-card-actions-align-end .mat-button:last-child,.mat-card-actions-align-end .mat-raised-button:last-child,.mat-card-actions-align-end .mat-stroked-button:last-child{margin-left:0;margin-right:0}.mat-card-title:not(:first-child),.mat-card-subtitle:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}"],encapsulation:2,changeDetection:0}),i})(),nB=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[In,In]}),i})();class JT{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class _oe extends JT{constructor(e,t,n,r){super(),this.component=e,this.viewContainerRef=t,this.injector=n,this.componentFactoryResolver=r}}class iB extends JT{constructor(e,t,n,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=n,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class voe extends JT{constructor(e){super(),this.element=e instanceof Kt?e.nativeElement:e}}class rB{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof _oe?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof iB?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof voe?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class yoe extends rB{constructor(e,t,n,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=n,this._defaultInjector=r,this.attachDomPortal=o=>{const a=o.element,l=this._document.createComment("dom-portal");a.parentNode.insertBefore(l,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(a,l)})},this._document=s}attachComponentPortal(e){const n=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(n,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector),this.setDisposeFn(()=>r.destroy())):(r=n.create(e.injector||this._defaultInjector||Xi.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,n=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return n.rootNodes.forEach(r=>this.outletElement.appendChild(r)),n.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(n);-1!==r&&t.remove(r)}),this._attachedPortal=e,n}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let eC=(()=>{class i extends rB{constructor(t,n,r){super(),this._componentFactoryResolver=t,this._viewContainerRef=n,this._isInitialized=!1,this.attached=new yt,this.attachDomPortal=s=>{const o=s.element,a=this._document.createComment("dom-portal");s.setAttachedHost(this),o.parentNode.insertBefore(a,o),this._getRootNode().appendChild(o),this._attachedPortal=s,super.setDisposeFn(()=>{a.parentNode&&a.parentNode.replaceChild(o,a)})},this._document=r}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(t){t.setAttachedHost(this);const n=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,s=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),o=n.createComponent(s,n.length,t.injector||n.injector);return n!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=t,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(t){t.setAttachedHost(this);const n=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=n,this.attached.emit(n),n}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}}return i.\u0275fac=function(t){return new(t||i)(N(qa),N(zr),N(Vt))},i.\u0275dir=tt({type:i,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[Se]}),i})(),sB=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({}),i})();const boe=["addListener","removeListener"],xoe=["addEventListener","removeEventListener"],woe=["on","off"];function Ml(i,e,t,n){if(cn(t)&&(n=t,t=void 0),n)return Ml(i,e,t).pipe(Uw(n));const[r,s]=function Toe(i){return cn(i.addEventListener)&&cn(i.removeEventListener)}(i)?xoe.map(o=>a=>i[o](e,a,t)):function Moe(i){return cn(i.addListener)&&cn(i.removeListener)}(i)?boe.map(oB(i,e)):function Soe(i){return cn(i.on)&&cn(i.off)}(i)?woe.map(oB(i,e)):[];if(!r&&Cy(i))return Gi(o=>Ml(o,e,t))(Nr(i));if(!r)throw new TypeError("Invalid event target");return new wn(o=>{const a=(...l)=>o.next(1<l.length?l:l[0]);return r(a),()=>s(a)})}function oB(i,e){return t=>n=>i[t](e,n)}function aB(i=0,e,t=Zre){let n=-1;return null!=e&&(pE(e)?t=e:n=e),new wn(r=>{let s=function Coe(i){return i instanceof Date&&!isNaN(i)}(i)?+i-t.now():i;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=n?this.schedule(void 0,n):r.complete())},s)})}class lB{}const ka="*";function Up(i,e){return{type:7,name:i,definitions:e,options:{}}}function Sl(i,e=null){return{type:4,styles:e,timings:i}}function cB(i,e=null){return{type:2,steps:i,options:e}}function Or(i){return{type:6,styles:i,offset:null}}function Na(i,e,t){return{type:0,name:i,styles:e,options:t}}function Ba(i,e,t=null){return{type:1,expr:i,animation:e,options:t}}function uB(i){Promise.resolve(null).then(i)}class Vp{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){uB(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class hB{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,r=0;const s=this.players.length;0==s?uB(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++n==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const r=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(r)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}const jp={schedule(i){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:n}=jp;n&&(e=n.requestAnimationFrame,t=n.cancelAnimationFrame);const r=e(s=>{t=void 0,i(s)});return new $n(()=>t?.(r))},requestAnimationFrame(...i){const{delegate:e}=jp;return(e?.requestAnimationFrame||requestAnimationFrame)(...i)},cancelAnimationFrame(...i){const{delegate:e}=jp;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...i)},delegate:void 0},Qv=new class Poe extends BT{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;e=e||n.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=n[0])&&e.id===t&&n.shift());if(this._active=!1,r){for(;(e=n[0])&&e.id===t&&n.shift();)e.unsubscribe();throw r}}}(class Doe extends NT{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e._scheduled||(e._scheduled=jp.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,n=0){if(null!=n&&n>0||null==n&&this.delay>0)return super.recycleAsyncId(e,t,n);e.actions.some(r=>r.id===t)||(jp.cancelAnimationFrame(t),e._scheduled=void 0)}});let nC,Ioe=1;const $v={};function dB(i){return i in $v&&(delete $v[i],!0)}const Foe={setImmediate(i){const e=Ioe++;return $v[e]=!0,nC||(nC=Promise.resolve()),nC.then(()=>dB(e)&&i()),e},clearImmediate(i){dB(i)}},{setImmediate:Loe,clearImmediate:Ooe}=Foe,Jv={setImmediate(...i){const{delegate:e}=Jv;return(e?.setImmediate||Loe)(...i)},clearImmediate(i){const{delegate:e}=Jv;return(e?.clearImmediate||Ooe)(i)},delegate:void 0};new class Noe extends BT{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;e=e||n.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=n[0])&&e.id===t&&n.shift());if(this._active=!1,r){for(;(e=n[0])&&e.id===t&&n.shift();)e.unsubscribe();throw r}}}(class koe extends NT{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e._scheduled||(e._scheduled=Jv.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,n=0){if(null!=n&&n>0||null==n&&this.delay>0)return super.recycleAsyncId(e,t,n);e.actions.some(r=>r.id===t)||(Jv.clearImmediate(t),e._scheduled=void 0)}});function fB(i,e=UT){return function Uoe(i){return ui((e,t)=>{let n=!1,r=null,s=null,o=!1;const a=()=>{if(s?.unsubscribe(),s=null,n){n=!1;const c=r;r=null,t.next(c)}o&&t.complete()},l=()=>{s=null,o&&t.complete()};e.subscribe(Jn(t,c=>{n=!0,r=c,s||Nr(i(c)).subscribe(s=Jn(t,a,l))},()=>{o=!0,(!n||!s||s.closed)&&t.complete()}))})}(()=>aB(i,e))}let e0=(()=>{class i{constructor(t,n,r){this._ngZone=t,this._platform=n,this._scrolled=new Lt,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const n=this.scrollContainers.get(t);n&&(n.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new wn(n=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(fB(t)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Mt()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(t,n){const r=this.getAncestorScrollContainers(t);return this.scrolled(n).pipe(Vi(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const n=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&n.push(s)}),n}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,n){let r=Zc(n),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Ml(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return i.\u0275fac=function(t){return new(t||i)(re(Pt),re(yr),re(Vt,8))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),zp=(()=>{class i{constructor(t,n,r,s){this.elementRef=t,this.scrollDispatcher=n,this.ngZone=r,this.dir=s,this._destroyed=new Lt,this._elementScrolled=new wn(o=>this.ngZone.runOutsideAngular(()=>Ml(this.elementRef.nativeElement,"scroll").pipe(Bn(this._destroyed)).subscribe(o)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const n=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=r?t.end:t.start),null==t.right&&(t.right=r?t.start:t.end),null!=t.bottom&&(t.top=n.scrollHeight-n.clientHeight-t.bottom),r&&0!=Dp()?(null!=t.left&&(t.right=n.scrollWidth-n.clientWidth-t.left),2==Dp()?t.left=t.right:1==Dp()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=n.scrollWidth-n.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const n=this.elementRef.nativeElement;s3()?n.scrollTo(t):(null!=t.top&&(n.scrollTop=t.top),null!=t.left&&(n.scrollLeft=t.left))}measureScrollOffset(t){const n="left",r="right",s=this.elementRef.nativeElement;if("top"==t)return s.scrollTop;if("bottom"==t)return s.scrollHeight-s.clientHeight-s.scrollTop;const o=this.dir&&"rtl"==this.dir.value;return"start"==t?t=o?r:n:"end"==t&&(t=o?n:r),o&&2==Dp()?t==n?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:o&&1==Dp()?t==n?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:t==n?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(e0),N(Pt),N(Fa,8))},i.\u0275dir=tt({type:i,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),i})(),ad=(()=>{class i{constructor(t,n,r){this._platform=t,this._change=new Lt,this._changeListener=s=>{this._change.next(s)},this._document=r,n.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:n,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+n,height:r,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,n=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||n.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||n.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(fB(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return i.\u0275fac=function(t){return new(t||i)(re(yr),re(Pt),re(Vt,8))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Hp=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({}),i})(),pB=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[Fp,Hp,Fp,Hp]}),i})();function zoe(i,e){1&i&&zn(0)}const mB=["*"];function Hoe(i,e){}const Goe=function(i){return{animationDuration:i}},Woe=function(i,e){return{value:i,params:e}},Xoe=["tabListContainer"],Koe=["tabList"],qoe=["tabListInner"],Zoe=["nextPaginator"],Yoe=["previousPaginator"],Qoe=["tabBodyWrapper"],$oe=["tabHeader"];function Joe(i,e){}function eae(i,e){1&i&&Sn(0,Joe,0,0,"ng-template",10),2&i&&Q("cdkPortalOutlet",ii().$implicit.templateLabel)}function tae(i,e){1&i&&Cn(0),2&i&&rf(ii().$implicit.textLabel)}function nae(i,e){if(1&i){const t=Fo();me(0,"div",6),gt("click",function(){const r=Vr(t),s=r.$implicit,o=r.index,a=ii(),l=yn(1);return jr(a._handleClick(s,l,o))})("cdkFocusChange",function(r){const o=Vr(t).index;return jr(ii()._tabFocusChanged(r,o))}),me(1,"div",7),Sn(2,eae,1,1,"ng-template",8),Sn(3,tae,1,1,"ng-template",null,9,uI),Te()()}if(2&i){const t=e.$implicit,n=e.index,r=yn(4),s=ii();mn("mat-tab-label-active",s.selectedIndex===n),Q("id",s._getTabLabelId(n))("ngClass",t.labelClass)("disabled",t.disabled)("matRippleDisabled",t.disabled||s.disableRipple),vi("tabIndex",s._getTabIndex(t,n))("aria-posinset",n+1)("aria-setsize",s._tabs.length)("aria-controls",s._getTabContentId(n))("aria-selected",s.selectedIndex===n)("aria-label",t.ariaLabel||null)("aria-labelledby",!t.ariaLabel&&t.ariaLabelledby?t.ariaLabelledby:null),se(2),Q("ngIf",t.templateLabel)("ngIfElse",r)}}function iae(i,e){if(1&i){const t=Fo();me(0,"mat-tab-body",11),gt("_onCentered",function(){return Vr(t),jr(ii()._removeTabBodyWrapperHeight())})("_onCentering",function(r){return Vr(t),jr(ii()._setTabBodyWrapperHeight(r))}),Te()}if(2&i){const t=e.$implicit,n=e.index,r=ii();mn("mat-tab-body-active",r.selectedIndex===n),Q("id",r._getTabContentId(n))("ngClass",t.bodyClass)("content",t.content)("position",t.position)("origin",t.origin)("animationDuration",r.animationDuration)("preserveContent",r.preserveContent),vi("tabindex",null!=r.contentTabIndex&&r.selectedIndex===n?r.contentTabIndex:null)("aria-labelledby",r._getTabLabelId(n))}}const rae=new He("MatInkBarPositioner",{providedIn:"root",factory:function sae(){return e=>({left:e?(e.offsetLeft||0)+"px":"0",width:e?(e.offsetWidth||0)+"px":"0"})}});let gB=(()=>{class i{constructor(t,n,r,s){this._elementRef=t,this._ngZone=n,this._inkBarPositioner=r,this._animationMode=s}alignToElement(t){this.show(),this._ngZone.onStable.pipe(Br(1)).subscribe(()=>{const n=this._inkBarPositioner(t),r=this._elementRef.nativeElement;r.style.left=n.left,r.style.width=n.width})}show(){this._elementRef.nativeElement.style.visibility="visible"}hide(){this._elementRef.nativeElement.style.visibility="hidden"}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(Pt),N(rae),N(Ar,8))},i.\u0275dir=tt({type:i,selectors:[["mat-ink-bar"]],hostAttrs:[1,"mat-ink-bar"],hostVars:2,hostBindings:function(t,n){2&t&&mn("_mat-animation-noopable","NoopAnimations"===n._animationMode)}}),i})();const oae=new He("MatTabContent"),aae=new He("MatTabLabel"),lae=new He("MAT_TAB"),cae=Lp(class{}),_B=new He("MAT_TAB_GROUP");let vB=(()=>{class i extends cae{constructor(t,n){super(),this._viewContainerRef=t,this._closestTabGroup=n,this.textLabel="",this._contentPortal=null,this._stateChanges=new Lt,this.position=null,this.origin=null,this.isActive=!1}get templateLabel(){return this._templateLabel}set templateLabel(t){this._setTemplateLabelInput(t)}get content(){return this._contentPortal}ngOnChanges(t){(t.hasOwnProperty("textLabel")||t.hasOwnProperty("disabled"))&&this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}ngOnInit(){this._contentPortal=new iB(this._explicitContent||this._implicitContent,this._viewContainerRef)}_setTemplateLabelInput(t){t&&t._closestTab===this&&(this._templateLabel=t)}}return i.\u0275fac=function(t){return new(t||i)(N(zr),N(_B,8))},i.\u0275cmp=De({type:i,selectors:[["mat-tab"]],contentQueries:function(t,n,r){if(1&t&&(pi(r,aae,5),pi(r,oae,7,Js)),2&t){let s;Et(s=Rt())&&(n.templateLabel=s.first),Et(s=Rt())&&(n._explicitContent=s.first)}},viewQuery:function(t,n){if(1&t&&Pn(Js,7),2&t){let r;Et(r=Rt())&&(n._implicitContent=r.first)}},inputs:{disabled:"disabled",textLabel:["label","textLabel"],ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],labelClass:"labelClass",bodyClass:"bodyClass"},exportAs:["matTab"],features:[Xe([{provide:lae,useExisting:i}]),Se,$i],ngContentSelectors:mB,decls:1,vars:0,template:function(t,n){1&t&&(Ji(),Sn(0,zoe,1,0,"ng-template"))},encapsulation:2}),i})();const uae={translateTab:Up("translateTab",[Na("center, void, left-origin-center, right-origin-center",Or({transform:"none"})),Na("left",Or({transform:"translate3d(-100%, 0, 0)",minHeight:"1px",visibility:"hidden"})),Na("right",Or({transform:"translate3d(100%, 0, 0)",minHeight:"1px",visibility:"hidden"})),Ba("* => left, * => right, left => center, right => center",Sl("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")),Ba("void => left-origin-center",[Or({transform:"translate3d(-100%, 0, 0)",visibility:"hidden"}),Sl("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")]),Ba("void => right-origin-center",[Or({transform:"translate3d(100%, 0, 0)",visibility:"hidden"}),Sl("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")])])};let hae=(()=>{class i extends eC{constructor(t,n,r,s){super(t,n,s),this._host=r,this._centeringSub=$n.EMPTY,this._leavingSub=$n.EMPTY}ngOnInit(){super.ngOnInit(),this._centeringSub=this._host._beforeCentering.pipe(ma(this._host._isCenterPosition(this._host._position))).subscribe(t=>{t&&!this.hasAttached()&&this.attach(this._host._content)}),this._leavingSub=this._host._afterLeavingCenter.subscribe(()=>{this._host.preserveContent||this.detach()})}ngOnDestroy(){super.ngOnDestroy(),this._centeringSub.unsubscribe(),this._leavingSub.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(N(qa),N(zr),N(qe(()=>yB)),N(Vt))},i.\u0275dir=tt({type:i,selectors:[["","matTabBodyHost",""]],features:[Se]}),i})(),dae=(()=>{class i{constructor(t,n,r){this._elementRef=t,this._dir=n,this._dirChangeSubscription=$n.EMPTY,this._translateTabComplete=new Lt,this._onCentering=new yt,this._beforeCentering=new yt,this._afterLeavingCenter=new yt,this._onCentered=new yt(!0),this.animationDuration="500ms",this.preserveContent=!1,n&&(this._dirChangeSubscription=n.change.subscribe(s=>{this._computePositionAnimationState(s),r.markForCheck()})),this._translateTabComplete.pipe(jT((s,o)=>s.fromState===o.fromState&&s.toState===o.toState)).subscribe(s=>{this._isCenterPosition(s.toState)&&this._isCenterPosition(this._position)&&this._onCentered.emit(),this._isCenterPosition(s.fromState)&&!this._isCenterPosition(this._position)&&this._afterLeavingCenter.emit()})}set position(t){this._positionIndex=t,this._computePositionAnimationState()}ngOnInit(){"center"==this._position&&null!=this.origin&&(this._position=this._computePositionFromOrigin(this.origin))}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._translateTabComplete.complete()}_onTranslateTabStarted(t){const n=this._isCenterPosition(t.toState);this._beforeCentering.emit(n),n&&this._onCentering.emit(this._elementRef.nativeElement.clientHeight)}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_isCenterPosition(t){return"center"==t||"left-origin-center"==t||"right-origin-center"==t}_computePositionAnimationState(t=this._getLayoutDirection()){this._position=this._positionIndex<0?"ltr"==t?"left":"right":this._positionIndex>0?"ltr"==t?"right":"left":"center"}_computePositionFromOrigin(t){const n=this._getLayoutDirection();return"ltr"==n&&t<=0||"rtl"==n&&t>0?"left-origin-center":"right-origin-center"}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(Fa,8),N(Ci))},i.\u0275dir=tt({type:i,inputs:{_content:["content","_content"],origin:"origin",animationDuration:"animationDuration",preserveContent:"preserveContent",position:"position"},outputs:{_onCentering:"_onCentering",_beforeCentering:"_beforeCentering",_afterLeavingCenter:"_afterLeavingCenter",_onCentered:"_onCentered"}}),i})(),yB=(()=>{class i extends dae{constructor(t,n,r){super(t,n,r)}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(Fa,8),N(Ci))},i.\u0275cmp=De({type:i,selectors:[["mat-tab-body"]],viewQuery:function(t,n){if(1&t&&Pn(eC,5),2&t){let r;Et(r=Rt())&&(n._portalHost=r.first)}},hostAttrs:[1,"mat-tab-body"],features:[Se],decls:3,vars:6,consts:[["cdkScrollable","",1,"mat-tab-body-content"],["content",""],["matTabBodyHost",""]],template:function(t,n){1&t&&(me(0,"div",0,1),gt("@translateTab.start",function(s){return n._onTranslateTabStarted(s)})("@translateTab.done",function(s){return n._translateTabComplete.next(s)}),Sn(2,Hoe,0,0,"ng-template",2),Te()),2&t&&Q("@translateTab",ic(3,Woe,n._position,Tn(1,Goe,n.animationDuration)))},dependencies:[hae],styles:['.mat-tab-body-content{height:100%;overflow:auto}.mat-tab-group-dynamic-height .mat-tab-body-content{overflow:hidden}.mat-tab-body-content[style*="visibility: hidden"]{display:none}'],encapsulation:2,data:{animation:[uae.translateTab]}}),i})();const bB=new He("MAT_TABS_CONFIG"),fae=Lp(class{});let xB=(()=>{class i extends fae{constructor(t){super(),this.elementRef=t}focus(){this.elementRef.nativeElement.focus()}getOffsetLeft(){return this.elementRef.nativeElement.offsetLeft}getOffsetWidth(){return this.elementRef.nativeElement.offsetWidth}}return i.\u0275fac=function(t){return new(t||i)(N(Kt))},i.\u0275dir=tt({type:i,selectors:[["","matTabLabelWrapper",""]],hostVars:3,hostBindings:function(t,n){2&t&&(vi("aria-disabled",!!n.disabled),mn("mat-tab-disabled",n.disabled))},inputs:{disabled:"disabled"},features:[Se]}),i})();const wB=Ap({passive:!0});let gae=(()=>{class i{constructor(t,n,r,s,o,a,l){this._elementRef=t,this._changeDetectorRef=n,this._viewportRuler=r,this._dir=s,this._ngZone=o,this._platform=a,this._animationMode=l,this._scrollDistance=0,this._selectedIndexChanged=!1,this._destroyed=new Lt,this._showPaginationControls=!1,this._disableScrollAfter=!0,this._disableScrollBefore=!0,this._stopScrolling=new Lt,this._disablePagination=!1,this._selectedIndex=0,this.selectFocusedIndex=new yt,this.indexFocused=new yt,o.runOutsideAngular(()=>{Ml(t.nativeElement,"mouseleave").pipe(Bn(this._destroyed)).subscribe(()=>{this._stopInterval()})})}get disablePagination(){return this._disablePagination}set disablePagination(t){this._disablePagination=ai(t)}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){t=Is(t),this._selectedIndex!=t&&(this._selectedIndexChanged=!0,this._selectedIndex=t,this._keyManager&&this._keyManager.updateActiveItem(t))}ngAfterViewInit(){Ml(this._previousPaginator.nativeElement,"touchstart",wB).pipe(Bn(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("before")}),Ml(this._nextPaginator.nativeElement,"touchstart",wB).pipe(Bn(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("after")})}ngAfterContentInit(){const t=this._dir?this._dir.change:Mt("ltr"),n=this._viewportRuler.change(150),r=()=>{this.updatePagination(),this._alignInkBarToSelectedTab()};this._keyManager=new y3(this._items).withHorizontalOrientation(this._getLayoutDirection()).withHomeAndEnd().withWrap(),this._keyManager.updateActiveItem(this._selectedIndex),this._ngZone.onStable.pipe(Br(1)).subscribe(r),lu(t,n,this._items.changes,this._itemsResized()).pipe(Bn(this._destroyed)).subscribe(()=>{this._ngZone.run(()=>{Promise.resolve().then(()=>{this._scrollDistance=Math.max(0,Math.min(this._getMaxScrollDistance(),this._scrollDistance)),r()})}),this._keyManager.withHorizontalOrientation(this._getLayoutDirection())}),this._keyManager.change.pipe(Bn(this._destroyed)).subscribe(s=>{this.indexFocused.emit(s),this._setTabFocus(s)})}_itemsResized(){return"function"!=typeof ResizeObserver?xr:this._items.changes.pipe(ma(this._items),Uo(t=>new wn(n=>this._ngZone.runOutsideAngular(()=>{const r=new ResizeObserver(()=>{n.next()});return t.forEach(s=>{r.observe(s.elementRef.nativeElement)}),()=>{r.disconnect()}}))),VT(1))}ngAfterContentChecked(){this._tabLabelCount!=this._items.length&&(this.updatePagination(),this._tabLabelCount=this._items.length,this._changeDetectorRef.markForCheck()),this._selectedIndexChanged&&(this._scrollToLabel(this._selectedIndex),this._checkScrollingControls(),this._alignInkBarToSelectedTab(),this._selectedIndexChanged=!1,this._changeDetectorRef.markForCheck()),this._scrollDistanceChanged&&(this._updateTabScrollPosition(),this._scrollDistanceChanged=!1,this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete(),this._stopScrolling.complete()}_handleKeydown(t){if(!nd(t))switch(t.keyCode){case 13:case 32:this.focusIndex!==this.selectedIndex&&(this.selectFocusedIndex.emit(this.focusIndex),this._itemSelected(t));break;default:this._keyManager.onKeydown(t)}}_onContentChanges(){const t=this._elementRef.nativeElement.textContent;t!==this._currentTextContent&&(this._currentTextContent=t||"",this._ngZone.run(()=>{this.updatePagination(),this._alignInkBarToSelectedTab(),this._changeDetectorRef.markForCheck()}))}updatePagination(){this._checkPaginationEnabled(),this._checkScrollingControls(),this._updateTabScrollPosition()}get focusIndex(){return this._keyManager?this._keyManager.activeItemIndex:0}set focusIndex(t){!this._isValidIndex(t)||this.focusIndex===t||!this._keyManager||this._keyManager.setActiveItem(t)}_isValidIndex(t){if(!this._items)return!0;const n=this._items?this._items.toArray()[t]:null;return!!n&&!n.disabled}_setTabFocus(t){if(this._showPaginationControls&&this._scrollToLabel(t),this._items&&this._items.length){this._items.toArray()[t].focus();const n=this._tabListContainer.nativeElement;n.scrollLeft="ltr"==this._getLayoutDirection()?0:n.scrollWidth-n.offsetWidth}}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_updateTabScrollPosition(){if(this.disablePagination)return;const t=this.scrollDistance,n="ltr"===this._getLayoutDirection()?-t:t;this._tabList.nativeElement.style.transform=`translateX(${Math.round(n)}px)`,(this._platform.TRIDENT||this._platform.EDGE)&&(this._tabListContainer.nativeElement.scrollLeft=0)}get scrollDistance(){return this._scrollDistance}set scrollDistance(t){this._scrollTo(t)}_scrollHeader(t){return this._scrollTo(this._scrollDistance+("before"==t?-1:1)*this._tabListContainer.nativeElement.offsetWidth/3)}_handlePaginatorClick(t){this._stopInterval(),this._scrollHeader(t)}_scrollToLabel(t){if(this.disablePagination)return;const n=this._items?this._items.toArray()[t]:null;if(!n)return;const r=this._tabListContainer.nativeElement.offsetWidth,{offsetLeft:s,offsetWidth:o}=n.elementRef.nativeElement;let a,l;"ltr"==this._getLayoutDirection()?(a=s,l=a+o):(l=this._tabListInner.nativeElement.offsetWidth-s,a=l-o);const c=this.scrollDistance,u=this.scrollDistance+r;a<c?this.scrollDistance-=c-a+60:l>u&&(this.scrollDistance+=l-u+60)}_checkPaginationEnabled(){if(this.disablePagination)this._showPaginationControls=!1;else{const t=this._tabListInner.nativeElement.scrollWidth>this._elementRef.nativeElement.offsetWidth;t||(this.scrollDistance=0),t!==this._showPaginationControls&&this._changeDetectorRef.markForCheck(),this._showPaginationControls=t}}_checkScrollingControls(){this.disablePagination?this._disableScrollAfter=this._disableScrollBefore=!0:(this._disableScrollBefore=0==this.scrollDistance,this._disableScrollAfter=this.scrollDistance==this._getMaxScrollDistance(),this._changeDetectorRef.markForCheck())}_getMaxScrollDistance(){return this._tabListInner.nativeElement.scrollWidth-this._tabListContainer.nativeElement.offsetWidth||0}_alignInkBarToSelectedTab(){const t=this._items&&this._items.length?this._items.toArray()[this.selectedIndex]:null,n=t?t.elementRef.nativeElement:null;n?this._inkBar.alignToElement(n):this._inkBar.hide()}_stopInterval(){this._stopScrolling.next()}_handlePaginatorPress(t,n){n&&null!=n.button&&0!==n.button||(this._stopInterval(),aB(650,100).pipe(Bn(lu(this._stopScrolling,this._destroyed))).subscribe(()=>{const{maxScrollDistance:r,distance:s}=this._scrollHeader(t);(0===s||s>=r)&&this._stopInterval()}))}_scrollTo(t){if(this.disablePagination)return{maxScrollDistance:0,distance:0};const n=this._getMaxScrollDistance();return this._scrollDistance=Math.max(0,Math.min(n,t)),this._scrollDistanceChanged=!0,this._checkScrollingControls(),{maxScrollDistance:n,distance:this._scrollDistance}}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(Ci),N(ad),N(Fa,8),N(Pt),N(yr),N(Ar,8))},i.\u0275dir=tt({type:i,inputs:{disablePagination:"disablePagination"}}),i})(),_ae=(()=>{class i extends gae{constructor(t,n,r,s,o,a,l){super(t,n,r,s,o,a,l),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=ai(t)}_itemSelected(t){t.preventDefault()}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(Ci),N(ad),N(Fa,8),N(Pt),N(yr),N(Ar,8))},i.\u0275dir=tt({type:i,inputs:{disableRipple:"disableRipple"},features:[Se]}),i})(),vae=(()=>{class i extends _ae{constructor(t,n,r,s,o,a,l){super(t,n,r,s,o,a,l)}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(Ci),N(ad),N(Fa,8),N(Pt),N(yr),N(Ar,8))},i.\u0275cmp=De({type:i,selectors:[["mat-tab-header"]],contentQueries:function(t,n,r){if(1&t&&pi(r,xB,4),2&t){let s;Et(s=Rt())&&(n._items=s)}},viewQuery:function(t,n){if(1&t&&(Pn(gB,7),Pn(Xoe,7),Pn(Koe,7),Pn(qoe,7),Pn(Zoe,5),Pn(Yoe,5)),2&t){let r;Et(r=Rt())&&(n._inkBar=r.first),Et(r=Rt())&&(n._tabListContainer=r.first),Et(r=Rt())&&(n._tabList=r.first),Et(r=Rt())&&(n._tabListInner=r.first),Et(r=Rt())&&(n._nextPaginator=r.first),Et(r=Rt())&&(n._previousPaginator=r.first)}},hostAttrs:[1,"mat-tab-header"],hostVars:4,hostBindings:function(t,n){2&t&&mn("mat-tab-header-pagination-controls-enabled",n._showPaginationControls)("mat-tab-header-rtl","rtl"==n._getLayoutDirection())},inputs:{selectedIndex:"selectedIndex"},outputs:{selectFocusedIndex:"selectFocusedIndex",indexFocused:"indexFocused"},features:[Se],ngContentSelectors:mB,decls:14,vars:10,consts:[["aria-hidden","true","type","button","mat-ripple","","tabindex","-1",1,"mat-tab-header-pagination","mat-tab-header-pagination-before","mat-elevation-z4",3,"matRippleDisabled","disabled","click","mousedown","touchend"],["previousPaginator",""],[1,"mat-tab-header-pagination-chevron"],[1,"mat-tab-label-container",3,"keydown"],["tabListContainer",""],["role","tablist",1,"mat-tab-list",3,"cdkObserveContent"],["tabList",""],[1,"mat-tab-labels"],["tabListInner",""],["aria-hidden","true","type","button","mat-ripple","","tabindex","-1",1,"mat-tab-header-pagination","mat-tab-header-pagination-after","mat-elevation-z4",3,"matRippleDisabled","disabled","mousedown","click","touchend"],["nextPaginator",""]],template:function(t,n){1&t&&(Ji(),me(0,"button",0,1),gt("click",function(){return n._handlePaginatorClick("before")})("mousedown",function(s){return n._handlePaginatorPress("before",s)})("touchend",function(){return n._stopInterval()}),Ze(2,"div",2),Te(),me(3,"div",3,4),gt("keydown",function(s){return n._handleKeydown(s)}),me(5,"div",5,6),gt("cdkObserveContent",function(){return n._onContentChanges()}),me(7,"div",7,8),zn(9),Te(),Ze(10,"mat-ink-bar"),Te()(),me(11,"button",9,10),gt("mousedown",function(s){return n._handlePaginatorPress("after",s)})("click",function(){return n._handlePaginatorClick("after")})("touchend",function(){return n._stopInterval()}),Ze(13,"div",2),Te()),2&t&&(mn("mat-tab-header-pagination-disabled",n._disableScrollBefore),Q("matRippleDisabled",n._disableScrollBefore||n.disableRipple)("disabled",n._disableScrollBefore||null),se(5),mn("_mat-animation-noopable","NoopAnimations"===n._animationMode),se(6),mn("mat-tab-header-pagination-disabled",n._disableScrollAfter),Q("matRippleDisabled",n._disableScrollAfter||n.disableRipple)("disabled",n._disableScrollAfter||null))},dependencies:[od,Jre,gB],styles:[".mat-tab-header{display:flex;overflow:hidden;position:relative;flex-shrink:0}.mat-tab-header-pagination{-webkit-user-select:none;user-select:none;position:relative;display:none;justify-content:center;align-items:center;min-width:32px;cursor:pointer;z-index:2;-webkit-tap-highlight-color:rgba(0,0,0,0);touch-action:none;box-sizing:content-box;background:none;border:none;outline:0;padding:0}.mat-tab-header-pagination::-moz-focus-inner{border:0}.mat-tab-header-pagination-controls-enabled .mat-tab-header-pagination{display:flex}.mat-tab-header-pagination-before,.mat-tab-header-rtl .mat-tab-header-pagination-after{padding-left:4px}.mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-rtl .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(-135deg)}.mat-tab-header-rtl .mat-tab-header-pagination-before,.mat-tab-header-pagination-after{padding-right:4px}.mat-tab-header-rtl .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(45deg)}.mat-tab-header-pagination-chevron{border-style:solid;border-width:2px 2px 0 0;height:8px;width:8px}.mat-tab-header-pagination-disabled{box-shadow:none;cursor:default}.mat-tab-list{flex-grow:1;position:relative;transition:transform 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-ink-bar{position:absolute;bottom:0;height:2px;transition:500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-ink-bar._mat-animation-noopable{transition:none !important;animation:none !important}.mat-tab-group-inverted-header .mat-ink-bar{bottom:auto;top:0}.cdk-high-contrast-active .mat-ink-bar{outline:solid 2px;height:0}.mat-tab-labels{display:flex}[mat-align-tabs=center]>.mat-tab-header .mat-tab-labels{justify-content:center}[mat-align-tabs=end]>.mat-tab-header .mat-tab-labels{justify-content:flex-end}.mat-tab-label-container{display:flex;flex-grow:1;overflow:hidden;z-index:1}.mat-tab-list._mat-animation-noopable{transition:none !important;animation:none !important}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{min-width:72px}}"],encapsulation:2}),i})(),yae=0;class bae{}const xae=Op(sd(class{constructor(i){this._elementRef=i}}),"primary");let wae=(()=>{class i extends xae{constructor(t,n,r,s){super(t),this._changeDetectorRef=n,this._animationMode=s,this._tabs=new rc,this._indexToSelect=0,this._lastFocusedTabIndex=null,this._tabBodyWrapperHeight=0,this._tabsSubscription=$n.EMPTY,this._tabLabelSubscription=$n.EMPTY,this._dynamicHeight=!1,this._selectedIndex=null,this.headerPosition="above",this._disablePagination=!1,this._preserveContent=!1,this.selectedIndexChange=new yt,this.focusChange=new yt,this.animationDone=new yt,this.selectedTabChange=new yt(!0),this._groupId=yae++,this.animationDuration=r&&r.animationDuration?r.animationDuration:"500ms",this.disablePagination=!(!r||null==r.disablePagination)&&r.disablePagination,this.dynamicHeight=!(!r||null==r.dynamicHeight)&&r.dynamicHeight,this.contentTabIndex=r?.contentTabIndex??null,this.preserveContent=!!r?.preserveContent}get dynamicHeight(){return this._dynamicHeight}set dynamicHeight(t){this._dynamicHeight=ai(t)}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){this._indexToSelect=Is(t,null)}get animationDuration(){return this._animationDuration}set animationDuration(t){this._animationDuration=/^\d+$/.test(t+"")?t+"ms":t}get contentTabIndex(){return this._contentTabIndex}set contentTabIndex(t){this._contentTabIndex=Is(t,null)}get disablePagination(){return this._disablePagination}set disablePagination(t){this._disablePagination=ai(t)}get preserveContent(){return this._preserveContent}set preserveContent(t){this._preserveContent=ai(t)}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){const n=this._elementRef.nativeElement;n.classList.remove(`mat-background-${this.backgroundColor}`),t&&n.classList.add(`mat-background-${t}`),this._backgroundColor=t}ngAfterContentChecked(){const t=this._indexToSelect=this._clampTabIndex(this._indexToSelect);if(this._selectedIndex!=t){const n=null==this._selectedIndex;if(!n){this.selectedTabChange.emit(this._createChangeEvent(t));const r=this._tabBodyWrapper.nativeElement;r.style.minHeight=r.clientHeight+"px"}Promise.resolve().then(()=>{this._tabs.forEach((r,s)=>r.isActive=s===t),n||(this.selectedIndexChange.emit(t),this._tabBodyWrapper.nativeElement.style.minHeight="")})}this._tabs.forEach((n,r)=>{n.position=r-t,null!=this._selectedIndex&&0==n.position&&!n.origin&&(n.origin=t-this._selectedIndex)}),this._selectedIndex!==t&&(this._selectedIndex=t,this._lastFocusedTabIndex=null,this._changeDetectorRef.markForCheck())}ngAfterContentInit(){this._subscribeToAllTabChanges(),this._subscribeToTabLabels(),this._tabsSubscription=this._tabs.changes.subscribe(()=>{const t=this._clampTabIndex(this._indexToSelect);if(t===this._selectedIndex){const n=this._tabs.toArray();let r;for(let s=0;s<n.length;s++)if(n[s].isActive){this._indexToSelect=this._selectedIndex=s,this._lastFocusedTabIndex=null,r=n[s];break}!r&&n[t]&&Promise.resolve().then(()=>{n[t].isActive=!0,this.selectedTabChange.emit(this._createChangeEvent(t))})}this._changeDetectorRef.markForCheck()})}_subscribeToAllTabChanges(){this._allTabs.changes.pipe(ma(this._allTabs)).subscribe(t=>{this._tabs.reset(t.filter(n=>n._closestTabGroup===this||!n._closestTabGroup)),this._tabs.notifyOnChanges()})}ngOnDestroy(){this._tabs.destroy(),this._tabsSubscription.unsubscribe(),this._tabLabelSubscription.unsubscribe()}realignInkBar(){this._tabHeader&&this._tabHeader._alignInkBarToSelectedTab()}updatePagination(){this._tabHeader&&this._tabHeader.updatePagination()}focusTab(t){const n=this._tabHeader;n&&(n.focusIndex=t)}_focusChanged(t){this._lastFocusedTabIndex=t,this.focusChange.emit(this._createChangeEvent(t))}_createChangeEvent(t){const n=new bae;return n.index=t,this._tabs&&this._tabs.length&&(n.tab=this._tabs.toArray()[t]),n}_subscribeToTabLabels(){this._tabLabelSubscription&&this._tabLabelSubscription.unsubscribe(),this._tabLabelSubscription=lu(...this._tabs.map(t=>t._stateChanges)).subscribe(()=>this._changeDetectorRef.markForCheck())}_clampTabIndex(t){return Math.min(this._tabs.length-1,Math.max(t||0,0))}_getTabLabelId(t){return`mat-tab-label-${this._groupId}-${t}`}_getTabContentId(t){return`mat-tab-content-${this._groupId}-${t}`}_setTabBodyWrapperHeight(t){if(!this._dynamicHeight||!this._tabBodyWrapperHeight)return;const n=this._tabBodyWrapper.nativeElement;n.style.height=this._tabBodyWrapperHeight+"px",this._tabBodyWrapper.nativeElement.offsetHeight&&(n.style.height=t+"px")}_removeTabBodyWrapperHeight(){const t=this._tabBodyWrapper.nativeElement;this._tabBodyWrapperHeight=t.clientHeight,t.style.height="",this.animationDone.emit()}_handleClick(t,n,r){t.disabled||(this.selectedIndex=n.focusIndex=r)}_getTabIndex(t,n){return t.disabled?null:n===(this._lastFocusedTabIndex??this.selectedIndex)?0:-1}_tabFocusChanged(t,n){t&&"mouse"!==t&&"touch"!==t&&(this._tabHeader.focusIndex=n)}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(Ci),N(bB,8),N(Ar,8))},i.\u0275dir=tt({type:i,inputs:{dynamicHeight:"dynamicHeight",selectedIndex:"selectedIndex",headerPosition:"headerPosition",animationDuration:"animationDuration",contentTabIndex:"contentTabIndex",disablePagination:"disablePagination",preserveContent:"preserveContent",backgroundColor:"backgroundColor"},outputs:{selectedIndexChange:"selectedIndexChange",focusChange:"focusChange",animationDone:"animationDone",selectedTabChange:"selectedTabChange"},features:[Se]}),i})(),Mae=(()=>{class i extends wae{constructor(t,n,r,s){super(t,n,r,s)}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(Ci),N(bB,8),N(Ar,8))},i.\u0275cmp=De({type:i,selectors:[["mat-tab-group"]],contentQueries:function(t,n,r){if(1&t&&pi(r,vB,5),2&t){let s;Et(s=Rt())&&(n._allTabs=s)}},viewQuery:function(t,n){if(1&t&&(Pn(Qoe,5),Pn($oe,5)),2&t){let r;Et(r=Rt())&&(n._tabBodyWrapper=r.first),Et(r=Rt())&&(n._tabHeader=r.first)}},hostAttrs:[1,"mat-tab-group"],hostVars:4,hostBindings:function(t,n){2&t&&mn("mat-tab-group-dynamic-height",n.dynamicHeight)("mat-tab-group-inverted-header","below"===n.headerPosition)},inputs:{color:"color",disableRipple:"disableRipple"},exportAs:["matTabGroup"],features:[Xe([{provide:_B,useExisting:i}]),Se],decls:6,vars:7,consts:[[3,"selectedIndex","disableRipple","disablePagination","indexFocused","selectFocusedIndex"],["tabHeader",""],["class","mat-tab-label mat-focus-indicator","role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",3,"id","mat-tab-label-active","ngClass","disabled","matRippleDisabled","click","cdkFocusChange",4,"ngFor","ngForOf"],[1,"mat-tab-body-wrapper"],["tabBodyWrapper",""],["role","tabpanel",3,"id","mat-tab-body-active","ngClass","content","position","origin","animationDuration","preserveContent","_onCentered","_onCentering",4,"ngFor","ngForOf"],["role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",1,"mat-tab-label","mat-focus-indicator",3,"id","ngClass","disabled","matRippleDisabled","click","cdkFocusChange"],[1,"mat-tab-label-content"],[3,"ngIf","ngIfElse"],["tabTextLabel",""],[3,"cdkPortalOutlet"],["role","tabpanel",3,"id","ngClass","content","position","origin","animationDuration","preserveContent","_onCentered","_onCentering"]],template:function(t,n){1&t&&(me(0,"mat-tab-header",0,1),gt("indexFocused",function(s){return n._focusChanged(s)})("selectFocusedIndex",function(s){return n.selectedIndex=s}),Sn(2,nae,5,15,"div",2),Te(),me(3,"div",3,4),Sn(5,iae,1,11,"mat-tab-body",5),Te()),2&t&&(Q("selectedIndex",n.selectedIndex||0)("disableRipple",n.disableRipple)("disablePagination",n.disablePagination),se(2),Q("ngForOf",n._tabs),se(1),mn("_mat-animation-noopable","NoopAnimations"===n._animationMode),se(2),Q("ngForOf",n._tabs))},dependencies:[v2,oc,$u,eC,od,Tse,xB,yB,vae],styles:[".mat-tab-group{display:flex;flex-direction:column;max-width:100%}.mat-tab-group.mat-tab-group-inverted-header{flex-direction:column-reverse}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{padding:0 12px}}@media(max-width: 959px){.mat-tab-label{padding:0 12px}}.mat-tab-group[mat-stretch-tabs]>.mat-tab-header .mat-tab-label{flex-basis:0;flex-grow:1}.mat-tab-body-wrapper{position:relative;overflow:hidden;display:flex;transition:height 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-tab-body-wrapper._mat-animation-noopable{transition:none !important;animation:none !important}.mat-tab-body{top:0;left:0;right:0;bottom:0;position:absolute;display:block;overflow:hidden;outline:0;flex-basis:100%}.mat-tab-body.mat-tab-body-active{position:relative;overflow-x:hidden;overflow-y:auto;z-index:1;flex-grow:1}.mat-tab-group.mat-tab-group-dynamic-height .mat-tab-body.mat-tab-body-active{overflow-y:hidden}"],encapsulation:2}),i})(),SB=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[Qa,In,sB,Gv,zT,Cse,In]}),i})();const{isArray:Sae}=Array;const t0=new He("HIGHLIGHT_OPTIONS");let Eae=(()=>{class i{constructor(t,n,r){this.doc=t,this._options=r,this._ready=new ss(null),this.ready=this._ready.asObservable().pipe(Vi(s=>!!s),xt(s=>s),Br(1)),R2(n)&&(t.defaultView.hljs?this._ready.next(t.defaultView.hljs):this._loadLibrary().pipe(Uo(s=>this._options&&this._options.lineNumbersLoader?(t.defaultView.hljs=s,this.loadLineNumbers().pipe(Gn(()=>this._ready.next(s)))):(this._ready.next(s),xr)),io(s=>(console.error("[HLJS] ",s),xr))).subscribe(),this._options?.themePath&&this.loadTheme(this._options.themePath))}_loadLibrary(){if(this._options){if(this._options.fullLibraryLoader&&this._options.coreLibraryLoader)return no(()=>"The full library and the core library were imported, only one of them should be imported!");if(this._options.fullLibraryLoader&&this._options.languages)return no(()=>"The highlighting languages were imported they are not needed!");if(this._options.coreLibraryLoader&&!this._options.languages)return no(()=>"The highlighting languages were not imported!");if(!this._options.coreLibraryLoader&&this._options.languages)return no(()=>"The core library was not imported!");if(this._options.fullLibraryLoader)return this.loadFullLibrary();if(this._options.coreLibraryLoader&&this._options.languages&&Object.keys(this._options.languages).length)return this.loadCoreLibrary().pipe(Uo(t=>this._loadLanguages(t)))}return no(()=>"Highlight.js library was not imported!")}_loadLanguages(t){return function Cae(...i){const e=Ry(i),t=function Tae(i){return 1===i.length&&Sae(i[0])?i[0]:i}(i);return t.length?new wn(n=>{let r=t.map(()=>[]),s=t.map(()=>!1);n.add(()=>{r=s=null});for(let o=0;!n.closed&&o<t.length;o++)Nr(t[o]).subscribe(Jn(n,a=>{if(r[o].push(a),r.every(l=>l.length)){const l=r.map(c=>c.shift());n.next(e?e(...l):l),r.some((c,u)=>!c.length&&s[u])&&n.complete()}},()=>{s[o]=!0,!r[o].length&&n.complete()}));return()=>{r=s=null}}):xr}(...Object.entries(this._options.languages).map(([r,s])=>n0(s()).pipe(Gn(o=>t.registerLanguage(r,o))))).pipe(xt(()=>t))}loadCoreLibrary(){return n0(this._options.coreLibraryLoader())}loadFullLibrary(){return n0(this._options.fullLibraryLoader())}loadLineNumbers(){return n0(this._options.lineNumbersLoader())}setTheme(t){this._themeLinkElement.href=t}loadTheme(t){this._themeLinkElement=this.doc.createElement("link"),this._themeLinkElement.href=t,this._themeLinkElement.type="text/css",this._themeLinkElement.rel="stylesheet",this._themeLinkElement.media="screen,print",this.doc.head.appendChild(this._themeLinkElement)}}return i.\u0275fac=function(t){return new(t||i)(re(Vt),re(_f),re(t0,8))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const n0=i=>_i(i).pipe(Vi(e=>!!e&&!!e.default),xt(e=>e.default));let Rae=(()=>{class i{constructor(t,n){this._loader=t,this._hljs=null,t.ready.subscribe(r=>{this._hljs=r,n&&n.config&&(r.configure(n.config),r.listLanguages().length<1&&console.error("[HighlightJS]: No languages were registered!"))})}get hljs(){return this._hljs}highlight(t,{language:n,ignoreIllegals:r}){return this._loader.ready.pipe(xt(s=>s.highlight(t,{language:n,ignoreIllegals:r})))}highlightAuto(t,n){return this._loader.ready.pipe(xt(r=>r.highlightAuto(t,n)))}highlightElement(t){return this._loader.ready.pipe(xt(n=>n.highlightElement(t)))}highlightAll(){return this._loader.ready.pipe(xt(t=>t.highlightAll()))}configure(t){return this._loader.ready.pipe(xt(n=>n.configure(t)))}registerLanguage(t,n){return this._loader.ready.pipe(Gn(r=>r.registerLanguage(t,n)))}unregisterLanguage(t){return this._loader.ready.pipe(Gn(n=>n.unregisterLanguage(t)))}registerAliases(t,{languageName:n}){return this._loader.ready.pipe(Gn(r=>r.registerAliases(t,{languageName:n})))}listLanguages(){return this._loader.ready.pipe(xt(t=>t.listLanguages()))}getLanguage(t){return this._loader.ready.pipe(xt(n=>n.getLanguage(t)))}safeMode(){return this._loader.ready.pipe(xt(t=>t.safeMode()))}debugMode(){return this._loader.ready.pipe(xt(t=>t.debugMode()))}lineNumbersBlock(t){return this._loader.ready.pipe(Vi(n=>!!n.lineNumbersBlock),Gn(n=>n.lineNumbersBlock(t)))}}return i.\u0275fac=function(t){return new(t||i)(re(Eae),re(t0,8))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Aae=(()=>{class i{constructor(t,n,r,s){this._hljs=n,this._sanitizer=r,this._options=s,this.highlighted=new yt,this._nativeElement=t.nativeElement}ngOnChanges(t){null!==t?.code?.currentValue&&t.code.currentValue!==t.code.previousValue&&(this.code?this.highlightElement(this.code,this.languages):this.setTextContent(""))}highlightElement(t,n){this.setTextContent(t),this._hljs.highlightAuto(t,n).subscribe(r=>{this.setInnerHTML(r?.value),this.lineNumbers&&this._options&&this._options.lineNumbersLoader&&this.addLineNumbers(),this.highlighted.emit(r)})}addLineNumbers(){this.destroyLineNumbersObserver(),Qv.schedule(()=>{this._hljs.lineNumbersBlock(this._nativeElement).subscribe(),this._lineNumbersObs=new MutationObserver(()=>{this._nativeElement.firstElementChild&&"TABLE"===this._nativeElement.firstElementChild.tagName.toUpperCase()&&this._nativeElement.classList.add("hljs-line-numbers"),this.destroyLineNumbersObserver()}),this._lineNumbersObs.observe(this._nativeElement,{childList:!0})})}destroyLineNumbersObserver(){this._lineNumbersObs&&(this._lineNumbersObs.disconnect(),this._lineNumbersObs=null)}setTextContent(t){Qv.schedule(()=>this._nativeElement.textContent=t)}setInnerHTML(t){Qv.schedule(()=>this._nativeElement.innerHTML=this._sanitizer.sanitize(pn.HTML,t)||"")}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(Rae),N(qg),N(t0,8))},i.\u0275dir=tt({type:i,selectors:[["","highlight",""]],hostVars:2,hostBindings:function(t,n){2&t&&mn("hljs",!0)},inputs:{code:["highlight","code"],languages:"languages",lineNumbers:"lineNumbers"},outputs:{highlighted:"highlighted"},features:[$i]}),i})(),TB=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({}),i})();const Pae={connector:()=>new Lt};function Lae(i,e,t,n){t&&!cn(t)&&(n=t);const r=cn(t)?t:void 0;return s=>function Fae(i,e){const t=cn(i)?i:()=>i;return cn(e)?function Iae(i,e=Pae){const{connector:t}=e;return ui((n,r)=>{const s=t();_i(i(function Dae(i){return new wn(e=>i.subscribe(e))}(s))).subscribe(r),r.add(n.subscribe(s))})}(e,{connector:t}):n=>new jw(n,t)}(new _T(i,e,n),r)(s)}const Oae=new He("GIST_OPTIONS");let kae=(()=>{class i{constructor(t,n){this._http=t,this._options=n}getCodeFromGist(t){let n;return this.isOAuthProvided()&&(n=(new Oa).set("client_id",this._options.clientId).set("client_secret",this._options.clientSecret)),this.fetchFile(`https://api.github.com/gists/${t}`,{params:n,responseType:"json"})}getCodeFromUrl(t){return this.fetchFile(t,{responseType:"text"})}isOAuthProvided(){return!!this._options&&!!this._options.clientId&&!!this._options.clientSecret}fetchFile(t,n){return function Nae(i){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(i)}(t)?this._http.get(t,n).pipe(Lae(1),Yg(),io(r=>(console.error("[NgxHighlight]: Unable to fetch the URL!",r.message),xr))):xr}}return i.\u0275fac=function(t){return new(t||i)(re(Kv),re(Oae,8))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Bae=(()=>{class i{constructor(t){this._loader=t}transform(t){return this._loader.getCodeFromUrl(t)}}return i.\u0275fac=function(t){return new(t||i)(N(kae,16))},i.\u0275pipe=Qi({name:"codeFromUrl",type:i,pure:!0}),i})(),Uae=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[TB,eoe,TB]}),i})();function Vae(i,e){if(1&i&&(me(0,"mat-tab",5)(1,"pre"),Cn(2,"            "),Ze(3,"code",6),xs(4,"async"),xs(5,"codeFromUrl"),Cn(6,"\n        "),Te()()),2&i){const t=e.$implicit,n=e.index,r=ii();Q("label",r.fileNames[n]),se(3),Q("highlight",ws(4,3,ws(5,5,t)))("lineNumbers",r.lineNumbers)}}let jae=(()=>{class i{constructor(t){this.editorService=t,this.fileNames=[],this.lineNumbers=!1}set codeUrls(t){this.editorService.setUrls(t),this.fileNames=this.editorService.fileNames}get codeUrls(){return this.editorService.urls}}return i.\u0275fac=function(t){return new(t||i)(N(Bv))},i.\u0275cmp=De({type:i,selectors:[["app-code"]],inputs:{codeUrls:"codeUrls",lineNumbers:"lineNumbers"},decls:14,vars:1,consts:[["color","accent"],[1,"code-wrapper","hljs"],["dynamicHeight","","color","primary","backgroundColor","primary"],[3,"label",4,"ngFor","ngForOf"],["href","#",1,"gist-url",3,"click"],[3,"label"],[3,"highlight","lineNumbers"]],template:function(t,n){1&t&&(me(0,"mat-card",0)(1,"mat-card-content")(2,"div",1)(3,"mat-tab-group",2),Sn(4,Vae,7,7,"mat-tab",3),Te()()(),me(5,"mat-card-footer")(6,"a",4),gt("click",function(s){return n.editorService.toCodeSandbox(s)}),me(7,"mat-icon"),Cn(8,"crop_din"),Te(),Cn(9," CodeSandbox "),Te(),me(10,"a",4),gt("click",function(s){return n.editorService.toStackblitz(s)}),me(11,"mat-icon"),Cn(12,"bolt"),Te(),Cn(13," Stackblitz "),Te()()()),2&t&&(se(4),Q("ngForOf",n.codeUrls))},dependencies:[oc,tB,goe,poe,moe,Mae,vB,Aae,Dw,Bae],styles:["pre[_ngcontent-%COMP%]{display:flex;margin-top:0;margin-bottom:0;word-wrap:break-word}pre[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{flex:1;line-height:1.8em;font-size:14px;min-height:100%;padding:1em 1.2em}pre[_ngcontent-%COMP%]   code.hljs-line-numbers[_ngcontent-%COMP%]{padding:0}.mat-card[_ngcontent-%COMP%]{padding:0;margin-bottom:3em}.mat-card-header[_ngcontent-%COMP%]{margin:0!important;padding:0!important;display:flex;align-items:center;height:40px}.mat-card-content[_ngcontent-%COMP%]{position:relative;overflow:hidden;padding:1px;margin-bottom:0}.mat-card-footer[_ngcontent-%COMP%]{padding:10px!important;margin:0!important;display:flex;flex-direction:row-reverse}.mat-card-footer[_ngcontent-%COMP%]   .gist-url[_ngcontent-%COMP%]{display:flex;align-items:center;font-weight:300;font-size:13px;text-decoration:unset}.mat-card-footer[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.mat-icon[_ngcontent-%COMP%]{margin:0 3px}.code-wrapper[_ngcontent-%COMP%]{border-radius:3px 3px 0 0}  .hljs{padding:0;border:none;transition:border ease 1s}  .hljs-ln{padding:10px 0}  .hljs-ln tr:first-child td{padding-top:10px!important}  .hljs-ln tr:last-child td{padding-bottom:10px!important}  td.hljs-ln-numbers{-webkit-user-select:none;user-select:none;text-align:center;color:#cccccc6b;border-right:1px solid rgba(204,204,204,.1098039216);vertical-align:top;padding-right:10px!important;padding-left:10px!important}  td.hljs-ln-code{padding-left:10px!important}"],changeDetection:0}),i})();function zae(i,e){1&i&&Ax(0)}let Hae=(()=>{class i{constructor(t,n){this.editorService=t,this.route=n,this.exampleComponent=null,this.codeUrls=this.route.snapshot.data.codeUrls??[],this.editorService.declarations=this.route.snapshot.data.declarations,this.exampleComponent=this.route.snapshot.data.exampleComponent}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)(N(Bv),N(uc))},i.\u0275cmp=De({type:i,selectors:[["app-example-page"]],decls:3,vars:3,consts:[[1,"example-container"],[4,"ngComponentOutlet"],[3,"lineNumbers","codeUrls"]],template:function(t,n){1&t&&(me(0,"div",0),Sn(1,zae,1,0,"ng-container",1),Te(),Ze(2,"app-code",2)),2&t&&(se(1),Q("ngComponentOutlet",n.exampleComponent),se(1),Q("lineNumbers",!0)("codeUrls",n.codeUrls))},dependencies:[y2,jae]}),i})();const Gae=.5*(Math.sqrt(3)-1),Gp=(3-Math.sqrt(3))/6,Zo=1/6,Xae=(Math.sqrt(5)-1)/4,ir=(5-Math.sqrt(5))/20,qi=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),Li=new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]);let $ae=(()=>{class i extends Ps{getType(){return LS}set count(t){this._objRef&&(this._objRef.count=t)}set instanceColor(t){this._objRef&&(this._objRef.instanceColor=Ft(this._objRef.instanceColor,t))}set instanceMatrix(t){this._objRef&&(this._objRef.instanceMatrix=Ft(this._objRef.instanceMatrix,t))}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-instancedMesh"]],inputs:{count:"count",instanceColor:"instanceColor",instanceMatrix:"instanceMatrix"},features:[Xe([{provide:on,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();const Jae=["canvas"],ele=["light"],tle=["instancedMesh"],nle=function(){return[0,0,30]},ile=function(){return[0,0,0]},rle=function(){return["#808080"]},sle=function(i){return[void 0,void 0,i]},ole=function(i,e,t){return[i,e,t]},CB=function(){return["#9C1E15"]},ale=function(i){return[0,0,i]},lle=function(i,e){return[i,e]};let cle=(()=>{class i{constructor(){this.SIZE=1.5,this.NX=20,this.NY=20,this.PADDING=1,this.SIZEP=this.SIZE+this.PADDING,this.W=this.NX*this.SIZEP-this.PADDING,this.H=this.NY*this.SIZEP-this.PADDING,this.NUM_INSTANCES=this.NX*this.NY,this.dummy=new gn,this.simplex=new class Kae{constructor(e=Math.random){const t="function"==typeof e?e:function Yae(i){let e=0,t=0,n=0,r=1;const s=function Qae(){let i=4022871197;return function(e){e=e.toString();for(let t=0;t<e.length;t++){i+=e.charCodeAt(t);let n=.02519603282416938*i;i=n>>>0,n-=i,n*=i,i=n>>>0,n-=i,i+=4294967296*n}return 2.3283064365386963e-10*(i>>>0)}}();return e=s(" "),t=s(" "),n=s(" "),e-=s(i),e<0&&(e+=1),t-=s(i),t<0&&(t+=1),n-=s(i),n<0&&(n+=1),function(){const o=2091639*e+2.3283064365386963e-10*r;return e=t,t=n,n=o-(r=0|o)}}(e);this.p=function Zae(i){const e=new Uint8Array(256);for(let t=0;t<256;t++)e[t]=t;for(let t=0;t<255;t++){const n=t+~~(i()*(256-t)),r=e[t];e[t]=e[n],e[n]=r}return e}(t),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(let n=0;n<512;n++)this.perm[n]=this.p[255&n],this.permMod12[n]=this.perm[n]%12}noise2D(e,t){const n=this.permMod12,r=this.perm;let s=0,o=0,a=0;const l=(e+t)*Gae,c=Math.floor(e+l),u=Math.floor(t+l),h=(c+u)*Gp,p=e-(c-h),m=t-(u-h);let g,_;p>m?(g=1,_=0):(g=0,_=1);const v=p-g+Gp,y=m-_+Gp,b=p-1+2*Gp,w=m-1+2*Gp,M=255&c,T=255&u;let x=.5-p*p-m*m;if(x>=0){const L=3*n[M+r[T]];x*=x,s=x*x*(qi[L]*p+qi[L+1]*m)}let E=.5-v*v-y*y;if(E>=0){const L=3*n[M+g+r[T+_]];E*=E,o=E*E*(qi[L]*v+qi[L+1]*y)}let D=.5-b*b-w*w;if(D>=0){const L=3*n[M+1+r[T+1]];D*=D,a=D*D*(qi[L]*b+qi[L+1]*w)}return 70*(s+o+a)}noise3D(e,t,n){const r=this.permMod12,s=this.perm;let o,a,l,c;const u=.3333333333333333*(e+t+n),h=Math.floor(e+u),d=Math.floor(t+u),f=Math.floor(n+u),p=(h+d+f)*Zo,v=e-(h-p),y=t-(d-p),b=n-(f-p);let w,M,T,x,E,D;v>=y?y>=b?(w=1,M=0,T=0,x=1,E=1,D=0):v>=b?(w=1,M=0,T=0,x=1,E=0,D=1):(w=0,M=0,T=1,x=1,E=0,D=1):y<b?(w=0,M=0,T=1,x=0,E=1,D=1):v<b?(w=0,M=1,T=0,x=0,E=1,D=1):(w=0,M=1,T=0,x=1,E=1,D=0);const L=v-w+Zo,z=y-M+Zo,H=b-T+Zo,U=v-x+2*Zo,X=y-E+2*Zo,I=b-D+2*Zo,V=v-1+.5,W=y-1+.5,j=b-1+.5,q=255&h,oe=255&d,J=255&f;let fe=.6-v*v-y*y-b*b;if(fe<0)o=0;else{const K=3*r[q+s[oe+s[J]]];fe*=fe,o=fe*fe*(qi[K]*v+qi[K+1]*y+qi[K+2]*b)}let he=.6-L*L-z*z-H*H;if(he<0)a=0;else{const K=3*r[q+w+s[oe+M+s[J+T]]];he*=he,a=he*he*(qi[K]*L+qi[K+1]*z+qi[K+2]*H)}let Re=.6-U*U-X*X-I*I;if(Re<0)l=0;else{const K=3*r[q+x+s[oe+E+s[J+D]]];Re*=Re,l=Re*Re*(qi[K]*U+qi[K+1]*X+qi[K+2]*I)}let $=.6-V*V-W*W-j*j;if($<0)c=0;else{const K=3*r[q+1+s[oe+1+s[J+1]]];$*=$,c=$*$*(qi[K]*V+qi[K+1]*W+qi[K+2]*j)}return 32*(o+a+l+c)}noise4D(e,t,n,r){const s=this.perm;let o,a,l,c,u;const h=(e+t+n+r)*Xae,d=Math.floor(e+h),f=Math.floor(t+h),p=Math.floor(n+h),m=Math.floor(r+h),g=(d+f+p+m)*ir,w=e-(d-g),M=t-(f-g),T=n-(p-g),x=r-(m-g);let E=0,D=0,L=0,z=0;w>M?E++:D++,w>T?E++:L++,w>x?E++:z++,M>T?D++:L++,M>x?D++:z++,T>x?L++:z++;const H=E>=3?1:0,U=D>=3?1:0,X=L>=3?1:0,I=z>=3?1:0,V=E>=2?1:0,W=D>=2?1:0,j=L>=2?1:0,q=z>=2?1:0,oe=E>=1?1:0,J=D>=1?1:0,fe=L>=1?1:0,he=z>=1?1:0,Re=w-H+ir,$=M-U+ir,K=T-X+ir,pe=x-I+ir,Fe=w-V+2*ir,_e=M-W+2*ir,ot=T-j+2*ir,ue=x-q+2*ir,de=w-oe+3*ir,Me=M-J+3*ir,Je=T-fe+3*ir,Ge=x-he+3*ir,bt=w-1+4*ir,mt=M-1+4*ir,dt=T-1+4*ir,Jt=x-1+4*ir,Wt=255&d,B=255&f,P=255&p,ae=255&m;let xe=.6-w*w-M*M-T*T-x*x;if(xe<0)o=0;else{const le=s[Wt+s[B+s[P+s[ae]]]]%32*4;xe*=xe,o=xe*xe*(Li[le]*w+Li[le+1]*M+Li[le+2]*T+Li[le+3]*x)}let Pe=.6-Re*Re-$*$-K*K-pe*pe;if(Pe<0)a=0;else{const le=s[Wt+H+s[B+U+s[P+X+s[ae+I]]]]%32*4;Pe*=Pe,a=Pe*Pe*(Li[le]*Re+Li[le+1]*$+Li[le+2]*K+Li[le+3]*pe)}let Ve=.6-Fe*Fe-_e*_e-ot*ot-ue*ue;if(Ve<0)l=0;else{const le=s[Wt+V+s[B+W+s[P+j+s[ae+q]]]]%32*4;Ve*=Ve,l=Ve*Ve*(Li[le]*Fe+Li[le+1]*_e+Li[le+2]*ot+Li[le+3]*ue)}let ht=.6-de*de-Me*Me-Je*Je-Ge*Ge;if(ht<0)c=0;else{const le=s[Wt+oe+s[B+J+s[P+fe+s[ae+he]]]]%32*4;ht*=ht,c=ht*ht*(Li[le]*de+Li[le+1]*Me+Li[le+2]*Je+Li[le+3]*Ge)}let F=.6-bt*bt-mt*mt-dt*dt-Jt*Jt;if(F<0)u=0;else{const le=s[Wt+1+s[B+1+s[P+1+s[ae+1]]]]%32*4;F*=F,u=F*F*(Li[le]*bt+Li[le+1]*mt+Li[le+2]*dt+Li[le+3]*Jt)}return 27*(o+a+l+c+u)}},this.pointerPN={x:0,y:0}}ngOnInit(){}onRender(){this.updateLightPosition(),this.updateInstanceMatrix()}updateLightPosition(){this.light&&this.light.objRef&&(this.light.objRef.position.x=this.pointerPN.x*this.W,this.light.objRef.position.y=this.pointerPN.y*this.H)}updateInstanceMatrix(){if(!this.instancedMesh||!this.instancedMesh.objRef)return;const t=-this.W/2+this.PADDING,n=-this.H/2+this.PADDING,r=1e-4*Date.now(),s=.1*this.pointerPN.x,o=.1*this.pointerPN.y;let l,c,u,h,d,f;for(let p=0;p<this.NX;p++)for(let m=0;m<this.NY;m++)l=t+p*this.SIZEP,c=n+m*this.SIZEP,u=.005*l+s,h=.005*c+o,d=this.simplex.noise3D(u,h,r)*Math.PI,f=this.simplex.noise3D(h,u,r)*Math.PI,this.dummy.position.set(l,c,-10),this.dummy.rotation.set(d,f,0),this.dummy.updateMatrix(),this.instancedMesh?.objRef?.setMatrixAt(p*this.NY+m,this.dummy.matrix);this.instancedMesh.objRef.instanceMatrix.needsUpdate=!0}onMouseMove(t){if(!this.canvas||!this.canvas.rendererCanvas)return;const n=this.canvas.rendererCanvas.nativeElement;this.pointerPN.x=(t.clientX-n.offsetLeft+window.scrollX)/n.width*2-1,this.pointerPN.y=-(t.clientY-n.offsetTop+window.scrollY)/n.height*2+1}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["app-instanced-mesh-example"]],viewQuery:function(t,n){if(1&t&&(Pn(Jae,5),Pn(ele,5),Pn(tle,5)),2&t){let r;Et(r=Rt())&&(n.canvas=r.first),Et(r=Rt())&&(n.light=r.first),Et(r=Rt())&&(n.instancedMesh=r.first)}},hostBindings:function(t,n){1&t&&gt("mousemove",function(s){return n.onMouseMove(s)},!1,$m)},decls:15,vars:33,consts:[[3,"shadow","onRender"],["canvas",""],[3,"position","lookAt"],[3,"color"],[3,"castShadow","shadowMapHeight","shadowMapWidth"],["light",""],[3,"args","count","castShadow","receiveShadow"],["instancedMesh",""],[3,"args"],[3,"position","receiveShadow"]],template:function(t,n){1&t&&(me(0,"th-canvas",0,1),gt("onRender",function(){return n.onRender()}),me(2,"th-scene")(3,"th-perspectiveCamera",2),Ze(4,"th-orbitControls"),Te(),Ze(5,"th-ambientLight",3)(6,"th-pointLight",4,5),me(8,"th-instancedMesh",6,7),Ze(10,"th-boxGeometry",8)(11,"th-meshPhongMaterial",3),Te(),me(12,"th-mesh",9),Ze(13,"th-planeGeometry",8)(14,"th-meshPhongMaterial",3),Te()()()),2&t&&(Q("shadow",!0),se(3),Q("position",Ee(17,nle))("lookAt",Ee(18,ile)),se(2),Q("color",Ee(19,rle)),se(1),Q("castShadow",!0)("shadowMapHeight",1024)("shadowMapWidth",1024),se(2),Q("args",Tn(20,sle,n.NUM_INSTANCES))("count",n.NUM_INSTANCES)("castShadow",!0)("receiveShadow",!0),se(2),Q("args",xg(22,ole,n.SIZE,n.SIZE,n.SIZE)),se(1),Q("color",Ee(26,CB)),se(1),Q("position",Tn(27,ale,-10-n.SIZE))("receiveShadow",!0),se(1),Q("args",ic(29,lle,2*n.W,2*n.H)),se(1),Q("color",Ee(32,CB)))},dependencies:[Cp,Lr,Wc,qo,$ae,Ps,_r,Zh,TT,bT,nr],encapsulation:2,changeDetection:0}),i})();const ule=function(){return[2,2,2]},hle=function(){return[1,1,1]},dle=function(){return{color:"purple"}},fle=function(i){return[i,0,0]},ple=function(){return[2,0,0]},mle=function(){return[75,2,.1,1e3]},gle=function(){return[1,1,5]};let _le=(()=>{class i{constructor(){this.selected=!1,this.rotation=[0,0,0],this.position=[0,0,0]}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["app-box"]],inputs:{rotation:"rotation",position:"position"},decls:3,vars:7,consts:[[3,"rotation","position","scale","onClick"],[3,"args"]],template:function(t,n){1&t&&(me(0,"th-mesh",0),gt("onClick",function(){return n.selected=!n.selected}),Ze(1,"th-boxGeometry")(2,"th-meshBasicMaterial",1),Te()),2&t&&(Q("rotation",n.rotation)("position",n.position)("scale",n.selected?Ee(4,ule):Ee(5,hle)),se(2),Q("args",Ee(6,dle)))},dependencies:[Ps,jN,TT,Lv],encapsulation:2,changeDetection:0}),i})(),vle=(()=>{class i{constructor(){this.rotation=[0,0,0]}onBeforeRender(){this.rotation=[0,this.rotation[2]+.01,this.rotation[2]+.01]}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["app-introductory-example"]],decls:6,vars:11,consts:[[3,"onRender"],[3,"position","rotation"],[3,"args","position"]],template:function(t,n){1&t&&(me(0,"th-canvas",0),gt("onRender",function(){return n.onBeforeRender()}),me(1,"th-scene"),Ze(2,"app-box",1)(3,"app-box",1)(4,"th-ambientLight")(5,"th-perspectiveCamera",2),Te()()),2&t&&(se(2),Q("position",Tn(6,fle,-2))("rotation",n.rotation),se(1),Q("position",Ee(8,ple))("rotation",n.rotation),se(2),Q("args",Ee(9,mle))("position",Ee(10,gle)))},dependencies:[Lr,qo,_r,nr,_le],encapsulation:2,changeDetection:0}),i})();const yle=function(){return[0,1,0]},ble=function(){return[100,100,100]},xle=function(i){return[0,0,i]},wle=function(){return[10,10]},EB=function(){return[10,10,10]},Mle=function(){return[45,2,.1,100]},Sle=function(){return[0,0,0]};let Tle=(()=>{class i{constructor(){this.assetPath1=`${Pa}DamagedHelmet.glb`,this.assetPath2=`${Pa}BoomBox.glb`,this.rotation=[0,0,0]}onBeforeRender(){this.rotation=[0,this.rotation[1]+.01,0]}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["app-loader-example"]],decls:8,vars:22,consts:[[3,"onRender"],[3,"thStats"],["loadGLTF","",3,"url","rotation","position"],["loadGLTF","",3,"url","scale","rotation","position"],[3,"args"],[3,"position"],[3,"args","position","lookAt"]],template:function(t,n){1&t&&(me(0,"th-canvas",0),gt("onRender",function(){return n.onBeforeRender()}),me(1,"th-scene",1),Ze(2,"th-ambientLight"),me(3,"th-object3D",2),Ze(4,"th-object3D",3),Te(),Ze(5,"th-gridHelper",4)(6,"th-pointLight",5)(7,"th-perspectiveCamera",6),Te()()),2&t&&(se(1),Q("thStats",!0),se(2),Q("url",n.assetPath1)("rotation",n.rotation)("position",Ee(13,yle)),se(1),Q("url",n.assetPath2)("scale",Ee(14,ble))("rotation",n.rotation)("position",Tn(15,xle,-3)),se(1),Q("args",Ee(17,wle)),se(1),Q("position",Ee(18,EB)),se(1),Q("args",Ee(19,Mle))("position",Ee(20,EB))("lookAt",Ee(21,Sle)))},dependencies:[Lr,on,zc,Wc,qo,_r,nr,Qh,wp],encapsulation:2,changeDetection:0}),i})(),RB=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({}),i})(),Cle=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[RB,RB]}),i})();new C,new C,new C,new C,new C,new Ce;var rC=function(i){return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))};try{URL.revokeObjectURL(rC(""))}catch{rC=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)}}var Fn=Uint8Array,Zi=Uint16Array,Tl=Uint32Array,ld=new Fn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),cd=new Fn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),OB=(new Fn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),function(i,e){for(var t=new Zi(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];var r=new Tl(t[30]);for(n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)r[s]=s-t[n]<<5|n;return[t,r]}),kB=OB(ld,2),s0=kB[1];kB[0][28]=258,s0[258]=28,OB(cd,0);for(var Xp=new Zi(32768),Qn=0;Qn<32768;++Qn){var Cl=(43690&Qn)>>>1|(21845&Qn)<<1;Xp[Qn]=((65280&(Cl=(61680&(Cl=(52428&Cl)>>>2|(13107&Cl)<<2))>>>4|(3855&Cl)<<4))>>>8|(255&Cl)<<8)>>>1}var Qc=new Fn(288);for(Qn=0;Qn<144;++Qn)Qc[Qn]=8;for(Qn=144;Qn<256;++Qn)Qc[Qn]=9;for(Qn=256;Qn<280;++Qn)Qc[Qn]=7;for(Qn=280;Qn<288;++Qn)Qc[Qn]=8;var o0=new Fn(32);for(Qn=0;Qn<32;++Qn)o0[Qn]=5;var d0=new Fn(0),gC=typeof TextDecoder<"u"&&new TextDecoder;try{gC.decode(d0,{stream:!0})}catch{}new ph,new C;const pd={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor.a *= opacity;\n\n\n\t\t}"};class Qo{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const nce=new Ec(-1,1,1,-1,0,1),yC=new wt;yC.setAttribute("position",new $e([-1,3,0,-1,-1,0,3,-1,0],3)),yC.setAttribute("uv",new $e([0,2,0,0,2,0],2));class md{constructor(e){this._mesh=new Ke(yC,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,nce)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class bC extends Qo{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof Zn?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Go.clone(e.uniforms),this.material=new Zn({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new md(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}class mU extends Qo{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){const r=e.getContext(),s=e.state;let o,a;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0),this.inverse?(o=0,a=1):(o=1,a=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),s.buffers.stencil.setClear(a),s.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}}class ice extends Qo{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class rce{constructor(e,t){if(this.renderer=e,void 0===t){const n=e.getSize(new te);this._pixelRatio=e.getPixelRatio(),this._width=n.width,this._height=n.height,(t=new Wn(this._width*this._pixelRatio,this._height*this._pixelRatio)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===pd&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===bC&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new bC(pd),this.clock=new Cv}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let n=!1;for(let r=0,s=this.passes.length;r<s;r++){const o=this.passes[r];if(!1!==o.enabled){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),o.needsSwap){if(n){const a=this.renderer.getContext(),l=this.renderer.state.buffers.stencil;l.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),l.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==mU&&(o instanceof mU?n=!0:o instanceof ice&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new te);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}new Ec(-1,1,1,-1,0,1);const xC=new wt;xC.setAttribute("position",new $e([-1,3,0,-1,-1,0,3,-1,0],3)),xC.setAttribute("uv",new $e([0,2,0,0,2,0],2));let oce=(()=>{class i extends Kh{getType(){return rce}set renderer(t){this._objRef&&(this._objRef.renderer=t)}set renderTarget1(t){this._objRef&&(this._objRef.renderTarget1=t)}set renderTarget2(t){this._objRef&&(this._objRef.renderTarget2=t)}set writeBuffer(t){this._objRef&&(this._objRef.writeBuffer=t)}set readBuffer(t){this._objRef&&(this._objRef.readBuffer=t)}set passes(t){this._objRef&&(this._objRef.passes=t)}set copyPass(t){this._objRef&&(this._objRef.copyPass=t)}set clock(t){this._objRef&&(this._objRef.clock=t)}set renderToScreen(t){this._objRef&&(this._objRef.renderToScreen=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-effectComposerGen"]],inputs:{renderer:"renderer",renderTarget1:"renderTarget1",renderTarget2:"renderTarget2",writeBuffer:"writeBuffer",readBuffer:"readBuffer",passes:"passes",copyPass:"copyPass",clock:"clock",renderToScreen:"renderToScreen"},features:[Xe([]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),x0=(()=>{class i extends oce{constructor(t,n){super(),this.view=t,this.engineService=n}createThreeInstance(t){return t||(t=new Array(5)),t[0]=t[0]??this.engineService.renderer,t[1]=t[1]??this.initRenderTarget(),super.createThreeInstance(t)}initRenderTarget(){if(this.view.viewPort){let t,n;return this.view.viewPort instanceof dn?(t=this.view.viewPort.z,n=this.view.viewPort?.width):(t=this.view.viewPort.width,n=this.view.viewPort.height),new Wn(t,n)}}addToParent(){this._objRef&&(this.view.effectComposer=this._objRef)}removeFromParent(){this.view.effectComposer=void 0}}return i.\u0275fac=function(t){return new(t||i)(N(xl),N(Hc))},i.\u0275cmp=De({type:i,selectors:[["th-effectComposer"]],features:[Xe([]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),Dl=(()=>{class i extends Kh{constructor(t){super(),this.effectComposer=t}addToParent(){this._objRef&&this.effectComposer&&this.effectComposer.objRef&&this.effectComposer.objRef.addPass(this._objRef)}removeFromParent(){this._objRef&&this.effectComposer&&this.effectComposer.objRef&&this.effectComposer.objRef.removePass(this._objRef)}}return i.\u0275fac=function(t){return new(t||i)(N(x0,8))},i.\u0275cmp=De({type:i,selectors:[["th-abs-control"]],features:[Se],decls:0,vars:0,template:function(t,n){},encapsulation:2}),i})();class ace extends Qo{constructor(e,t,n,r,s){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=void 0!==s?s:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Ce}render(e,t,n){const r=e.autoClear;let s,o;e.autoClear=!1,void 0!==this.overrideMaterial&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),s=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,s),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=o),e.autoClear=r}}let Qp=(()=>{class i extends Dl{getType(){return Qo}set enabled(t){this._objRef&&(this._objRef.enabled=t)}set needsSwap(t){this._objRef&&(this._objRef.needsSwap=t)}set clear(t){this._objRef&&(this._objRef.clear=t)}set renderToScreen(t){this._objRef&&(this._objRef.renderToScreen=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-pass"]],inputs:{enabled:"enabled",needsSwap:"needsSwap",clear:"clear",renderToScreen:"renderToScreen"},features:[Xe([{provide:Dl,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),lce=(()=>{class i extends Qp{getType(){return ace}set scene(t){this._objRef&&(this._objRef.scene=t)}set camera(t){this._objRef&&(this._objRef.camera=t)}set overrideMaterial(t){this._objRef&&(this._objRef.overrideMaterial=t)}set clearColor(t){this._objRef&&(this._objRef.clearColor=Ft(this._objRef.clearColor,t))}set clearAlpha(t){this._objRef&&(this._objRef.clearAlpha=t)}set clearDepth(t){this._objRef&&(this._objRef.clearDepth=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-renderPassGen"]],inputs:{scene:"scene",camera:"camera",overrideMaterial:"overrideMaterial",clearColor:"clearColor",clearAlpha:"clearAlpha",clearDepth:"clearDepth"},features:[Xe([{provide:Dl,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),gU=(()=>{class i extends lce{constructor(t,n){super(t),this.effectComposer=t,this.view=n}createThreeInstance(t){return t||(t=new Array(5)),t[0]=t[0]??this.view.scene,t[1]=t[1]??this.view.camera,t[2]=t[2]??this.overrideMaterial,t[3]=t[3]??this.clearColor,t[4]=t[4]??this.clearAlpha,super.createThreeInstance(t)}ngAfterContentChecked(){!this._objRef||(this.view.scene&&this.view.scene.objRef&&(this._objRef.scene=this.view.scene.objRef),this.view.camera&&this.view.camera.objRef&&(this._objRef.camera=this.view.camera.objRef))}}return i.\u0275fac=function(t){return new(t||i)(N(x0),N(xl))},i.\u0275cmp=De({type:i,selectors:[["th-renderPass"]],features:[Xe([{provide:Dl,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();const $c=new mp,qr=new C,Pl=new C,ti=new bn,_U={X:new C(1,0,0),Y:new C(0,1,0),Z:new C(0,0,1)},wC={type:"change"},vU={type:"mouseDown"},yU={type:"mouseUp",mode:null},bU={type:"objectChange"};class xU extends gn{constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const n=new pce;this._gizmo=n,this.add(n);const r=new mce;this._plane=r,this.add(r);const s=this;function o(v,y){let b=y;Object.defineProperty(s,v,{get:function(){return void 0!==b?b:y},set:function(w){b!==w&&(b=w,r[v]=w,n[v]=w,s.dispatchEvent({type:v+"-changed",value:w}),s.dispatchEvent(wC))}}),s[v]=y,r[v]=y,n[v]=y}o("camera",e),o("object",void 0),o("enabled",!0),o("axis",null),o("mode","translate"),o("translationSnap",null),o("rotationSnap",null),o("scaleSnap",null),o("space","world"),o("size",1),o("dragging",!1),o("showX",!0),o("showY",!0),o("showZ",!0);const a=new C,l=new C,c=new bn,u=new bn,h=new C,d=new bn,f=new C,p=new C,m=new C,_=new C;o("worldPosition",a),o("worldPositionStart",l),o("worldQuaternion",c),o("worldQuaternionStart",u),o("cameraPosition",h),o("cameraQuaternion",d),o("pointStart",f),o("pointEnd",p),o("rotationAxis",m),o("rotationAngle",0),o("eye",_),this._offset=new C,this._startNorm=new C,this._endNorm=new C,this._cameraScale=new C,this._parentPosition=new C,this._parentQuaternion=new bn,this._parentQuaternionInv=new bn,this._parentScale=new C,this._worldScaleStart=new C,this._worldQuaternionInv=new bn,this._worldScale=new C,this._positionStart=new C,this._quaternionStart=new bn,this._scaleStart=new C,this._getPointer=cce.bind(this),this._onPointerDown=hce.bind(this),this._onPointerHover=uce.bind(this),this._onPointerMove=dce.bind(this),this._onPointerUp=fce.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye):this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;$c.setFromCamera(e,this.camera);const t=MC(this._gizmo.picker[this.mode],$c);this.axis=t?t.object.name:null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){$c.setFromCamera(e,this.camera);const t=MC(this._plane,$c,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,vU.mode=this.mode,this.dispatchEvent(vU)}}pointerMove(e){const t=this.axis,n=this.mode,r=this.object;let s=this.space;if("scale"===n?s="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(s="world"),void 0===r||null===t||!1===this.dragging||-1!==e.button)return;$c.setFromCamera(e,this.camera);const o=MC(this._plane,$c,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),"translate"===n)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===s&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===s&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),r.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===s&&(r.position.applyQuaternion(ti.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this._quaternionStart)),"world"===s&&(r.parent&&r.position.add(qr.setFromMatrixPosition(r.parent.matrixWorld)),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(qr.setFromMatrixPosition(r.parent.matrixWorld))));else if("scale"===n){if(-1!==t.search("XYZ")){let a=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(a*=-1),Pl.set(a,a,a)}else qr.copy(this.pointStart),Pl.copy(this.pointEnd),qr.applyQuaternion(this._worldQuaternionInv),Pl.applyQuaternion(this._worldQuaternionInv),Pl.divide(qr),-1===t.search("X")&&(Pl.x=1),-1===t.search("Y")&&(Pl.y=1),-1===t.search("Z")&&(Pl.z=1);r.scale.copy(this._scaleStart).multiply(Pl),this.scaleSnap&&(-1!==t.search("X")&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===n){this._offset.copy(this.pointEnd).sub(this.pointStart);const a=20/this.worldPosition.distanceTo(qr.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(qr.copy(this.rotationAxis).cross(this.eye))*a):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(_U[t]),qr.copy(_U[t]),"local"===s&&qr.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(qr.cross(this.eye).normalize())*a),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===s&&"E"!==t&&"XYZE"!==t?(r.quaternion.copy(this._quaternionStart),r.quaternion.multiply(ti.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),r.quaternion.copy(ti.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(wC),this.dispatchEvent(bU)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(yU.mode=this.mode,this.dispatchEvent(yU)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){!this.enabled||this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(wC),this.dispatchEvent(bU),this.pointStart.copy(this.pointEnd))}getRaycaster(){return $c}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}update(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}}function cce(i){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:i.button};{const e=this.domElement.getBoundingClientRect();return{x:(i.clientX-e.left)/e.width*2-1,y:-(i.clientY-e.top)/e.height*2+1,button:i.button}}}function uce(i){if(this.enabled)switch(i.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(i))}}function hce(i){!this.enabled||(document.pointerLockElement||this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(i)),this.pointerDown(this._getPointer(i)))}function dce(i){!this.enabled||this.pointerMove(this._getPointer(i))}function fce(i){!this.enabled||(this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(i)))}function MC(i,e,t){const n=e.intersectObject(i,!0);for(let r=0;r<n.length;r++)if(n[r].object.visible||t)return n[r];return!1}const w0=new ph,Un=new C(0,1,0),wU=new C(0,0,0),MU=new st,M0=new bn,S0=new bn,$o=new C,SU=new st,$p=new C(1,0,0),Jc=new C(0,1,0),Jp=new C(0,0,1),T0=new C,em=new C,tm=new C;class pce extends gn{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new tr({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new Pi({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),n=e.clone();n.opacity=.15;const r=t.clone();r.opacity=.5;const s=e.clone();s.color.setHex(16711680);const o=e.clone();o.color.setHex(65280);const a=e.clone();a.color.setHex(255);const l=e.clone();l.color.setHex(16711680),l.opacity=.5;const c=e.clone();c.color.setHex(65280),c.opacity=.5;const u=e.clone();u.color.setHex(255),u.opacity=.5;const h=e.clone();h.opacity=.25;const d=e.clone();d.color.setHex(16776960),d.opacity=.25,e.clone().color.setHex(16776960);const p=e.clone();p.color.setHex(7895160);const m=new mi(0,.04,.1,12);m.translate(0,.05,0);const g=new Xn(.08,.08,.08);g.translate(0,.04,0);const _=new wt;_.setAttribute("position",new $e([0,0,0,1,0,0],3));const v=new mi(.0075,.0075,.5,3);function y(X,I){const V=new _o(X,.0075,3,64,I*Math.PI*2);return V.rotateY(Math.PI/2),V.rotateX(Math.PI/2),V}v.translate(0,.25,0);const w={X:[[new Ke(m,s),[.5,0,0],[0,0,-Math.PI/2]],[new Ke(m,s),[-.5,0,0],[0,0,Math.PI/2]],[new Ke(v,s),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new Ke(m,o),[0,.5,0]],[new Ke(m,o),[0,-.5,0],[Math.PI,0,0]],[new Ke(v,o)]],Z:[[new Ke(m,a),[0,0,.5],[Math.PI/2,0,0]],[new Ke(m,a),[0,0,-.5],[-Math.PI/2,0,0]],[new Ke(v,a),null,[Math.PI/2,0,0]]],XYZ:[[new Ke(new go(.1,0),h.clone()),[0,0,0]]],XY:[[new Ke(new Xn(.15,.15,.01),u.clone()),[.15,.15,0]]],YZ:[[new Ke(new Xn(.15,.15,.01),l.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Ke(new Xn(.15,.15,.01),c.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},M={X:[[new Ke(new mi(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new Ke(new mi(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Ke(new mi(.2,0,.6,4),n),[0,.3,0]],[new Ke(new mi(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Ke(new mi(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new Ke(new mi(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new Ke(new go(.2,0),n)]],XY:[[new Ke(new Xn(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new Ke(new Xn(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Ke(new Xn(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]]},T={START:[[new Ke(new go(.01,2),r),null,null,null,"helper"]],END:[[new Ke(new go(.01,2),r),null,null,null,"helper"]],DELTA:[[new wi(function b(){const X=new wt;return X.setAttribute("position",new $e([0,0,0,1,1,1],3)),X}(),r),null,null,null,"helper"]],X:[[new wi(_,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new wi(_,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new wi(_,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},x={XYZE:[[new Ke(y(.5,1),p),null,[0,Math.PI/2,0]]],X:[[new Ke(y(.5,.5),s)]],Y:[[new Ke(y(.5,.5),o),null,[0,0,-Math.PI/2]]],Z:[[new Ke(y(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new Ke(y(.75,1),d),null,[0,Math.PI/2,0]]]},E={AXIS:[[new wi(_,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},D={XYZE:[[new Ke(new Ea(.25,10,8),n)]],X:[[new Ke(new _o(.5,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new Ke(new _o(.5,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new Ke(new _o(.5,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new Ke(new _o(.75,.1,2,24),n)]]},L={X:[[new Ke(g,s),[.5,0,0],[0,0,-Math.PI/2]],[new Ke(v,s),[0,0,0],[0,0,-Math.PI/2]],[new Ke(g,s),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new Ke(g,o),[0,.5,0]],[new Ke(v,o)],[new Ke(g,o),[0,-.5,0],[0,0,Math.PI]]],Z:[[new Ke(g,a),[0,0,.5],[Math.PI/2,0,0]],[new Ke(v,a),[0,0,0],[Math.PI/2,0,0]],[new Ke(g,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new Ke(new Xn(.15,.15,.01),u),[.15,.15,0]]],YZ:[[new Ke(new Xn(.15,.15,.01),l),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Ke(new Xn(.15,.15,.01),c),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Ke(new Xn(.1,.1,.1),h.clone())]]},z={X:[[new Ke(new mi(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new Ke(new mi(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Ke(new mi(.2,0,.6,4),n),[0,.3,0]],[new Ke(new mi(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Ke(new mi(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new Ke(new mi(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new Ke(new Xn(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new Ke(new Xn(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Ke(new Xn(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Ke(new Xn(.2,.2,.2),n),[0,0,0]]]},H={X:[[new wi(_,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new wi(_,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new wi(_,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function U(X){const I=new gn;for(const V in X)for(let W=X[V].length;W--;){const j=X[V][W][0].clone(),q=X[V][W][1],oe=X[V][W][2],J=X[V][W][3],fe=X[V][W][4];j.name=V,j.tag=fe,q&&j.position.set(q[0],q[1],q[2]),oe&&j.rotation.set(oe[0],oe[1],oe[2]),J&&j.scale.set(J[0],J[1],J[2]),j.updateMatrix();const he=j.geometry.clone();he.applyMatrix4(j.matrix),j.geometry=he,j.renderOrder=1/0,j.position.set(0,0,0),j.rotation.set(0,0,0),j.scale.set(1,1,1),I.add(j)}return I}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=U(w)),this.add(this.gizmo.rotate=U(x)),this.add(this.gizmo.scale=U(L)),this.add(this.picker.translate=U(M)),this.add(this.picker.rotate=U(D)),this.add(this.picker.scale=U(z)),this.add(this.helper.translate=U(T)),this.add(this.helper.rotate=U(E)),this.add(this.helper.scale=U(H)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const n="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:S0;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let r=[];r=r.concat(this.picker[this.mode].children),r=r.concat(this.gizmo[this.mode].children),r=r.concat(this.helper[this.mode].children);for(let s=0;s<r.length;s++){const o=r[s];let a;o.visible=!0,o.rotation.set(0,0,0),o.position.copy(this.worldPosition),a=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),o.scale.set(1,1,1).multiplyScalar(a*this.size/4),"helper"!==o.tag?(o.quaternion.copy(n),"translate"===this.mode||"scale"===this.mode?("X"===o.name&&Math.abs(Un.copy($p).applyQuaternion(n).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Y"===o.name&&Math.abs(Un.copy(Jc).applyQuaternion(n).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Z"===o.name&&Math.abs(Un.copy(Jp).applyQuaternion(n).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XY"===o.name&&Math.abs(Un.copy(Jp).applyQuaternion(n).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"YZ"===o.name&&Math.abs(Un.copy($p).applyQuaternion(n).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XZ"===o.name&&Math.abs(Un.copy(Jc).applyQuaternion(n).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1)):"rotate"===this.mode&&(M0.copy(n),Un.copy(this.eye).applyQuaternion(ti.copy(n).invert()),-1!==o.name.search("E")&&o.quaternion.setFromRotationMatrix(MU.lookAt(this.eye,wU,Jc)),"X"===o.name&&(ti.setFromAxisAngle($p,Math.atan2(-Un.y,Un.z)),ti.multiplyQuaternions(M0,ti),o.quaternion.copy(ti)),"Y"===o.name&&(ti.setFromAxisAngle(Jc,Math.atan2(Un.x,Un.z)),ti.multiplyQuaternions(M0,ti),o.quaternion.copy(ti)),"Z"===o.name&&(ti.setFromAxisAngle(Jp,Math.atan2(Un.y,Un.x)),ti.multiplyQuaternions(M0,ti),o.quaternion.copy(ti))),o.visible=o.visible&&(-1===o.name.indexOf("X")||this.showX),o.visible=o.visible&&(-1===o.name.indexOf("Y")||this.showY),o.visible=o.visible&&(-1===o.name.indexOf("Z")||this.showZ),o.visible=o.visible&&(-1===o.name.indexOf("E")||this.showX&&this.showY&&this.showZ),o.material._color=o.material._color||o.material.color.clone(),o.material._opacity=o.material._opacity||o.material.opacity,o.material.color.copy(o.material._color),o.material.opacity=o.material._opacity,this.enabled&&this.axis&&(o.name===this.axis||this.axis.split("").some(function(l){return o.name===l}))&&(o.material.color.setHex(16776960),o.material.opacity=1)):(o.visible=!1,"AXIS"===o.name?(o.position.copy(this.worldPositionStart),o.visible=!!this.axis,"X"===this.axis&&(ti.setFromEuler(w0.set(0,0,0)),o.quaternion.copy(n).multiply(ti),Math.abs(Un.copy($p).applyQuaternion(n).dot(this.eye))>.9&&(o.visible=!1)),"Y"===this.axis&&(ti.setFromEuler(w0.set(0,0,Math.PI/2)),o.quaternion.copy(n).multiply(ti),Math.abs(Un.copy(Jc).applyQuaternion(n).dot(this.eye))>.9&&(o.visible=!1)),"Z"===this.axis&&(ti.setFromEuler(w0.set(0,Math.PI/2,0)),o.quaternion.copy(n).multiply(ti),Math.abs(Un.copy(Jp).applyQuaternion(n).dot(this.eye))>.9&&(o.visible=!1)),"XYZE"===this.axis&&(ti.setFromEuler(w0.set(0,Math.PI/2,0)),Un.copy(this.rotationAxis),o.quaternion.setFromRotationMatrix(MU.lookAt(wU,Un,Jc)),o.quaternion.multiply(ti),o.visible=this.dragging),"E"===this.axis&&(o.visible=!1)):"START"===o.name?(o.position.copy(this.worldPositionStart),o.visible=this.dragging):"END"===o.name?(o.position.copy(this.worldPosition),o.visible=this.dragging):"DELTA"===o.name?(o.position.copy(this.worldPositionStart),o.quaternion.copy(this.worldQuaternionStart),qr.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),qr.applyQuaternion(this.worldQuaternionStart.clone().invert()),o.scale.copy(qr),o.visible=this.dragging):(o.quaternion.copy(n),o.position.copy(this.dragging?this.worldPositionStart:this.worldPosition),this.axis&&(o.visible=-1!==this.axis.search(o.name))))}super.updateMatrixWorld(e)}}class mce extends Ke{constructor(){super(new Ca(1e5,1e5,2,2),new tr({visible:!1,wireframe:!0,side:oo,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),T0.copy($p).applyQuaternion("local"===t?this.worldQuaternion:S0),em.copy(Jc).applyQuaternion("local"===t?this.worldQuaternion:S0),tm.copy(Jp).applyQuaternion("local"===t?this.worldQuaternion:S0),Un.copy(em),this.mode){case"translate":case"scale":switch(this.axis){case"X":Un.copy(this.eye).cross(T0),$o.copy(T0).cross(Un);break;case"Y":Un.copy(this.eye).cross(em),$o.copy(em).cross(Un);break;case"Z":Un.copy(this.eye).cross(tm),$o.copy(tm).cross(Un);break;case"XY":$o.copy(tm);break;case"YZ":$o.copy(T0);break;case"XZ":Un.copy(tm),$o.copy(em);break;case"XYZ":case"E":$o.set(0,0,0)}break;default:$o.set(0,0,0)}0===$o.length()?this.quaternion.copy(this.cameraQuaternion):(SU.lookAt(qr.set(0,0,0),$o,Un),this.quaternion.setFromRotationMatrix(SU)),super.updateMatrixWorld(e)}}let gce=(()=>{class i extends vr{getType(){return xU}set domElement(t){this._objRef&&(this._objRef.domElement=t)}set camera(t){this._objRef&&(this._objRef.camera=t)}set object(t){this._objRef&&(this._objRef.object=t)}set enabled(t){this._objRef&&(this._objRef.enabled=t)}set axis(t){this._objRef&&(this._objRef.axis=t)}set mode(t){this._objRef&&(this._objRef.mode=t)}set translationSnap(t){this._objRef&&(this._objRef.translationSnap=t)}set rotationSnap(t){this._objRef&&(this._objRef.rotationSnap=t)}set space(t){this._objRef&&(this._objRef.space=t)}set size(t){this._objRef&&(this._objRef.size=t)}set dragging(t){this._objRef&&(this._objRef.dragging=t)}set showX(t){this._objRef&&(this._objRef.showX=t)}set showY(t){this._objRef&&(this._objRef.showY=t)}set showZ(t){this._objRef&&(this._objRef.showZ=t)}set mouseButtons(t){this._objRef&&(this._objRef.mouseButtons=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-transformControlsGen"]],inputs:{domElement:"domElement",camera:"camera",object:"object",enabled:"enabled",axis:"axis",mode:"mode",translationSnap:"translationSnap",rotationSnap:"rotationSnap",space:"space",size:"size",dragging:"dragging",showX:"showX",showY:"showY",showZ:"showZ",mouseButtons:"mouseButtons"},features:[Xe([{provide:vr,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),_ce=(()=>{class i extends gce{getType(){return xU}set object(t){this._objRef&&(this._objRef.object=t,t?this._objRef.attach(t):this._objRef.detach())}addToParent(){this._objRef&&this.canvas?.scene?.objRef?.add(this._objRef)}removeFromParent(){this._objRef&&this.canvas?.scene?.objRef?.remove(this._objRef)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-transformControls"]],inputs:{object:"object"},features:[Xe([{provide:vr,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();function ut(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}const vt={IDLE:Symbol(),ROTATE:Symbol(),PAN:Symbol(),SCALE:Symbol(),FOV:Symbol(),FOCUS:Symbol(),ZROTATE:Symbol(),TOUCH_MULTI:Symbol(),ANIMATION_FOCUS:Symbol(),ANIMATION_ROTATE:Symbol()},Rn={NONE:Symbol(),ONE_FINGER:Symbol(),ONE_FINGER_SWITCHED:Symbol(),TWO_FINGER:Symbol(),MULT_FINGER:Symbol(),CURSOR:Symbol()},Ht={x:0,y:0},fs={camera:new st,gizmos:new st},Kn={type:"change"},Mo={type:"start"},Os={type:"end"},vce=new mp,Oi=new C,TU=new st,CU=new st,So=new C;class yce extends ls{constructor(e,t,n=null){super(),ut(this,"onWindowResize",()=>{const r=(this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3;this._tbRadius=this.calculateTbRadius(this.camera);const s=this._tbRadius/r,a=new _l(0,0,s,s).getPoints(this._curvePts),l=(new wt).setFromPoints(a);for(const c in this._gizmos.children)this._gizmos.children[c].geometry=l;this.dispatchEvent(Kn)}),ut(this,"onContextMenu",r=>{if(this.enabled)for(let s=0;s<this.mouseActions.length;s++)if(2==this.mouseActions[s].mouse){r.preventDefault();break}}),ut(this,"onPointerCancel",()=>{this._touchStart.splice(0,this._touchStart.length),this._touchCurrent.splice(0,this._touchCurrent.length),this._input=Rn.NONE}),ut(this,"onPointerDown",r=>{if(0==r.button&&r.isPrimary?(this._downValid=!0,this._downEvents.push(r),this._downStart=performance.now()):this._downValid=!1,"touch"==r.pointerType&&this._input!=Rn.CURSOR)switch(this._touchStart.push(r),this._touchCurrent.push(r),this._input){case Rn.NONE:this._input=Rn.ONE_FINGER,this.onSinglePanStart(r,"ROTATE"),window.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerup",this.onPointerUp);break;case Rn.ONE_FINGER:case Rn.ONE_FINGER_SWITCHED:this._input=Rn.TWO_FINGER,this.onRotateStart(),this.onPinchStart(),this.onDoublePanStart();break;case Rn.TWO_FINGER:this._input=Rn.MULT_FINGER,this.onTriplePanStart(r)}else if("touch"!=r.pointerType&&this._input==Rn.NONE){let s=null;r.ctrlKey||r.metaKey?s="CTRL":r.shiftKey&&(s="SHIFT"),this._mouseOp=this.getOpFromAction(r.button,s),null!=this._mouseOp&&(window.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerup",this.onPointerUp),this._input=Rn.CURSOR,this._button=r.button,this.onSinglePanStart(r,this._mouseOp))}}),ut(this,"onPointerMove",r=>{if("touch"==r.pointerType&&this._input!=Rn.CURSOR)switch(this._input){case Rn.ONE_FINGER:this.updateTouchEvent(r),this.onSinglePanMove(r,vt.ROTATE);break;case Rn.ONE_FINGER_SWITCHED:if(this.calculatePointersDistance(this._touchCurrent[0],r)*this._devPxRatio>=this._switchSensibility){this._input=Rn.ONE_FINGER,this.updateTouchEvent(r),this.onSinglePanStart(r,"ROTATE");break}break;case Rn.TWO_FINGER:this.updateTouchEvent(r),this.onRotateMove(),this.onPinchMove(),this.onDoublePanMove();break;case Rn.MULT_FINGER:this.updateTouchEvent(r),this.onTriplePanMove(r)}else if("touch"!=r.pointerType&&this._input==Rn.CURSOR){let s=null;r.ctrlKey||r.metaKey?s="CTRL":r.shiftKey&&(s="SHIFT");const o=this.getOpStateFromAction(this._button,s);null!=o&&this.onSinglePanMove(r,o)}this._downValid&&this.calculatePointersDistance(this._downEvents[this._downEvents.length-1],r)*this._devPxRatio>this._movementThreshold&&(this._downValid=!1)}),ut(this,"onPointerUp",r=>{if("touch"==r.pointerType&&this._input!=Rn.CURSOR){const s=this._touchCurrent.length;for(let o=0;o<s;o++)if(this._touchCurrent[o].pointerId==r.pointerId){this._touchCurrent.splice(o,1),this._touchStart.splice(o,1);break}switch(this._input){case Rn.ONE_FINGER:case Rn.ONE_FINGER_SWITCHED:window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=Rn.NONE,this.onSinglePanEnd();break;case Rn.TWO_FINGER:this.onDoublePanEnd(r),this.onPinchEnd(r),this.onRotateEnd(r),this._input=Rn.ONE_FINGER_SWITCHED;break;case Rn.MULT_FINGER:0==this._touchCurrent.length&&(window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=Rn.NONE,this.onTriplePanEnd())}}else"touch"!=r.pointerType&&this._input==Rn.CURSOR&&(window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=Rn.NONE,this.onSinglePanEnd(),this._button=-1);if(r.isPrimary)if(this._downValid)if(r.timeStamp-this._downEvents[this._downEvents.length-1].timeStamp<=this._maxDownTime)if(0==this._nclicks)this._nclicks=1,this._clickStart=performance.now();else{const o=r.timeStamp-this._clickStart,a=this.calculatePointersDistance(this._downEvents[1],this._downEvents[0])*this._devPxRatio;o<=this._maxInterval&&a<=this._posThreshold?(this._nclicks=0,this._downEvents.splice(0,this._downEvents.length),this.onDoubleTap(r)):(this._nclicks=1,this._downEvents.shift(),this._clickStart=performance.now())}else this._downValid=!1,this._nclicks=0,this._downEvents.splice(0,this._downEvents.length);else this._nclicks=0,this._downEvents.splice(0,this._downEvents.length)}),ut(this,"onWheel",r=>{if(this.enabled&&this.enableZoom){let s=null;r.ctrlKey||r.metaKey?s="CTRL":r.shiftKey&&(s="SHIFT");const o=this.getOpFromAction("WHEEL",s);if(null!=o){r.preventDefault(),this.dispatchEvent(Mo);const a=125;let l=r.deltaY/a,c=1;switch(l>0?c=1/this.scaleFactor:l<0&&(c=this.scaleFactor),o){case"ZOOM":if(this.updateTbState(vt.SCALE,!0),l>0?c=1/Math.pow(this.scaleFactor,l):l<0&&(c=Math.pow(this.scaleFactor,-l)),this.cursorZoom&&this.enablePan){let u;this.camera.isOrthographicCamera?u=this.unprojectOnTbPlane(this.camera,r.clientX,r.clientY,this.domElement).applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._gizmos.position):this.camera.isPerspectiveCamera&&(u=this.unprojectOnTbPlane(this.camera,r.clientX,r.clientY,this.domElement).applyQuaternion(this.camera.quaternion).add(this._gizmos.position)),this.applyTransformMatrix(this.scale(c,u))}else this.applyTransformMatrix(this.scale(c,this._gizmos.position));null!=this._grid&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(vt.IDLE,!1),this.dispatchEvent(Kn),this.dispatchEvent(Os);break;case"FOV":if(this.camera.isPerspectiveCamera){this.updateTbState(vt.FOV,!0),0!=r.deltaX&&(l=r.deltaX/a,c=1,l>0?c=1/Math.pow(this.scaleFactor,l):l<0&&(c=Math.pow(this.scaleFactor,-l))),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);const u=this._v3_1.distanceTo(this._gizmos.position);let h=u/c;h=kt.clamp(h,this.minDistance,this.maxDistance);const d=u*Math.tan(kt.DEG2RAD*this.camera.fov*.5);let f=kt.RAD2DEG*(2*Math.atan(d/h));f>this.maxFov?f=this.maxFov:f<this.minFov&&(f=this.minFov),c=u/(d/Math.tan(kt.DEG2RAD*(f/2))),this.setFov(f),this.applyTransformMatrix(this.scale(c,this._gizmos.position,!1))}null!=this._grid&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(vt.IDLE,!1),this.dispatchEvent(Kn),this.dispatchEvent(Os)}}}}),ut(this,"onSinglePanStart",(r,s)=>{if(this.enabled)switch(this.dispatchEvent(Mo),this.setCenter(r.clientX,r.clientY),s){case"PAN":if(!this.enablePan)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(Kn)),this.updateTbState(vt.PAN,!0),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.camera,Ht.x,Ht.y,this.domElement)),this.enableGrid&&(this.drawGrid(),this.dispatchEvent(Kn));break;case"ROTATE":if(!this.enableRotate)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1),this.updateTbState(vt.ROTATE,!0),this._startCursorPosition.copy(this.unprojectOnTbSurface(this.camera,Ht.x,Ht.y,this.domElement,this._tbRadius)),this.activateGizmos(!0),this.enableAnimations&&(this._timePrev=this._timeCurrent=performance.now(),this._angleCurrent=this._anglePrev=0,this._cursorPosPrev.copy(this._startCursorPosition),this._cursorPosCurr.copy(this._cursorPosPrev),this._wCurr=0,this._wPrev=this._wCurr),this.dispatchEvent(Kn);break;case"FOV":if(!this.camera.isPerspectiveCamera||!this.enableZoom)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(Kn)),this.updateTbState(vt.FOV,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(Ht.x,Ht.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition);break;case"ZOOM":if(!this.enableZoom)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(Kn)),this.updateTbState(vt.SCALE,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(Ht.x,Ht.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition)}}),ut(this,"onSinglePanMove",(r,s)=>{if(this.enabled){const o=s!=this._state;switch(this.setCenter(r.clientX,r.clientY),s){case vt.PAN:this.enablePan&&(o?(this.dispatchEvent(Os),this.dispatchEvent(Mo),this.updateTbState(s,!0),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.camera,Ht.x,Ht.y,this.domElement)),this.enableGrid&&this.drawGrid(),this.activateGizmos(!1)):(this._currentCursorPosition.copy(this.unprojectOnTbPlane(this.camera,Ht.x,Ht.y,this.domElement)),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition))));break;case vt.ROTATE:if(this.enableRotate)if(o)this.dispatchEvent(Os),this.dispatchEvent(Mo),this.updateTbState(s,!0),this._startCursorPosition.copy(this.unprojectOnTbSurface(this.camera,Ht.x,Ht.y,this.domElement,this._tbRadius)),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!0);else{this._currentCursorPosition.copy(this.unprojectOnTbSurface(this.camera,Ht.x,Ht.y,this.domElement,this._tbRadius));const a=this._startCursorPosition.distanceTo(this._currentCursorPosition),l=this._startCursorPosition.angleTo(this._currentCursorPosition),c=Math.max(a/this._tbRadius,l);this.applyTransformMatrix(this.rotate(this.calculateRotationAxis(this._startCursorPosition,this._currentCursorPosition),c)),this.enableAnimations&&(this._timePrev=this._timeCurrent,this._timeCurrent=performance.now(),this._anglePrev=this._angleCurrent,this._angleCurrent=c,this._cursorPosPrev.copy(this._cursorPosCurr),this._cursorPosCurr.copy(this._currentCursorPosition),this._wPrev=this._wCurr,this._wCurr=this.calculateAngularSpeed(this._anglePrev,this._angleCurrent,this._timePrev,this._timeCurrent))}break;case vt.SCALE:if(this.enableZoom)if(o)this.dispatchEvent(Os),this.dispatchEvent(Mo),this.updateTbState(s,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(Ht.x,Ht.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(.5*this.getCursorNDC(Ht.x,Ht.y,this.domElement).y);const l=this._currentCursorPosition.y-this._startCursorPosition.y;let c=1;l<0?c=1/Math.pow(this.scaleFactor,8*-l):l>0&&(c=Math.pow(this.scaleFactor,8*l)),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState),this.applyTransformMatrix(this.scale(c,this._v3_1))}break;case vt.FOV:if(this.enableZoom&&this.camera.isPerspectiveCamera)if(o)this.dispatchEvent(Os),this.dispatchEvent(Mo),this.updateTbState(s,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(Ht.x,Ht.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(.5*this.getCursorNDC(Ht.x,Ht.y,this.domElement).y);const l=this._currentCursorPosition.y-this._startCursorPosition.y;let c=1;l<0?c=1/Math.pow(this.scaleFactor,8*-l):l>0&&(c=Math.pow(this.scaleFactor,8*l)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);const u=this._v3_1.distanceTo(this._gizmos.position);let h=u/c;h=kt.clamp(h,this.minDistance,this.maxDistance);const d=u*Math.tan(kt.DEG2RAD*this._fovState*.5);let f=kt.RAD2DEG*(2*Math.atan(d/h));f=kt.clamp(f,this.minFov,this.maxFov);const p=d/Math.tan(kt.DEG2RAD*(f/2));c=u/p,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(f),this.applyTransformMatrix(this.scale(c,this._v3_2,!1)),Oi.copy(this._gizmos.position).sub(this.camera.position).normalize().multiplyScalar(p/u),this._m4_1.makeTranslation(Oi.x,Oi.y,Oi.z)}}this.dispatchEvent(Kn)}}),ut(this,"onSinglePanEnd",()=>{if(this._state==vt.ROTATE){if(!this.enableRotate)return;if(this.enableAnimations)if(performance.now()-this._timeCurrent<120){const s=Math.abs((this._wPrev+this._wCurr)/2),o=this;this._animationId=window.requestAnimationFrame(function(a){o.updateTbState(vt.ANIMATION_ROTATE,!0);const l=o.calculateRotationAxis(o._cursorPosPrev,o._cursorPosCurr);o.onRotationAnim(a,l,Math.min(s,o.wMax))})}else this.updateTbState(vt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(Kn);else this.updateTbState(vt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(Kn)}else(this._state==vt.PAN||this._state==vt.IDLE)&&(this.updateTbState(vt.IDLE,!1),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1),this.dispatchEvent(Kn));this.dispatchEvent(Os)}),ut(this,"onDoubleTap",r=>{if(this.enabled&&this.enablePan&&null!=this.scene){this.dispatchEvent(Mo),this.setCenter(r.clientX,r.clientY);const s=this.unprojectOnObj(this.getCursorNDC(Ht.x,Ht.y,this.domElement),this.camera);if(null!=s&&this.enableAnimations){const o=this;-1!=this._animationId&&window.cancelAnimationFrame(this._animationId),this._timeStart=-1,this._animationId=window.requestAnimationFrame(function(a){o.updateTbState(vt.ANIMATION_FOCUS,!0),o.onFocusAnim(a,s,o._cameraMatrixState,o._gizmoMatrixState)})}else null!=s&&!this.enableAnimations&&(this.updateTbState(vt.FOCUS,!0),this.focus(s,this.scaleFactor),this.updateTbState(vt.IDLE,!1),this.dispatchEvent(Kn))}this.dispatchEvent(Os)}),ut(this,"onDoublePanStart",()=>{this.enabled&&this.enablePan&&(this.dispatchEvent(Mo),this.updateTbState(vt.PAN,!0),this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.camera,Ht.x,Ht.y,this.domElement,!0)),this._currentCursorPosition.copy(this._startCursorPosition),this.activateGizmos(!1))}),ut(this,"onDoublePanMove",()=>{this.enabled&&this.enablePan&&(this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._state!=vt.PAN&&(this.updateTbState(vt.PAN,!0),this._startCursorPosition.copy(this._currentCursorPosition)),this._currentCursorPosition.copy(this.unprojectOnTbPlane(this.camera,Ht.x,Ht.y,this.domElement,!0)),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition,!0)),this.dispatchEvent(Kn))}),ut(this,"onDoublePanEnd",()=>{this.updateTbState(vt.IDLE,!1),this.dispatchEvent(Os)}),ut(this,"onRotateStart",()=>{this.enabled&&this.enableRotate&&(this.dispatchEvent(Mo),this.updateTbState(vt.ZROTATE,!0),this._startFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this._currentFingerRotation=this._startFingerRotation,this.camera.getWorldDirection(this._rotationAxis),!this.enablePan&&!this.enableZoom&&this.activateGizmos(!0))}),ut(this,"onRotateMove",()=>{if(this.enabled&&this.enableRotate){let r;this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._state!=vt.ZROTATE&&(this.updateTbState(vt.ZROTATE,!0),this._startFingerRotation=this._currentFingerRotation),this._currentFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this.enablePan?(this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),r=this.unprojectOnTbPlane(this.camera,Ht.x,Ht.y,this.domElement).applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._v3_2)):r=(new C).setFromMatrixPosition(this._gizmoMatrixState),this.applyTransformMatrix(this.zRotate(r,kt.DEG2RAD*(this._startFingerRotation-this._currentFingerRotation))),this.dispatchEvent(Kn)}}),ut(this,"onRotateEnd",()=>{this.updateTbState(vt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(Os)}),ut(this,"onPinchStart",()=>{this.enabled&&this.enableZoom&&(this.dispatchEvent(Mo),this.updateTbState(vt.SCALE,!0),this._startFingerDistance=this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),this._currentFingerDistance=this._startFingerDistance,this.activateGizmos(!1))}),ut(this,"onPinchMove",()=>{if(this.enabled&&this.enableZoom){this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2);const r=12;this._state!=vt.SCALE&&(this._startFingerDistance=this._currentFingerDistance,this.updateTbState(vt.SCALE,!0)),this._currentFingerDistance=Math.max(this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),r*this._devPxRatio);const s=this._currentFingerDistance/this._startFingerDistance;let o;this.enablePan?this.camera.isOrthographicCamera?o=this.unprojectOnTbPlane(this.camera,Ht.x,Ht.y,this.domElement).applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._gizmos.position):this.camera.isPerspectiveCamera&&(o=this.unprojectOnTbPlane(this.camera,Ht.x,Ht.y,this.domElement).applyQuaternion(this.camera.quaternion).add(this._gizmos.position)):o=this._gizmos.position,this.applyTransformMatrix(this.scale(s,o)),this.dispatchEvent(Kn)}}),ut(this,"onPinchEnd",()=>{this.updateTbState(vt.IDLE,!1),this.dispatchEvent(Os)}),ut(this,"onTriplePanStart",()=>{if(this.enabled&&this.enableZoom){this.dispatchEvent(Mo),this.updateTbState(vt.SCALE,!0);let r=0,s=0;const o=this._touchCurrent.length;for(let a=0;a<o;a++)r+=this._touchCurrent[a].clientX,s+=this._touchCurrent[a].clientY;this.setCenter(r/o,s/o),this._startCursorPosition.setY(.5*this.getCursorNDC(Ht.x,Ht.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition)}}),ut(this,"onTriplePanMove",()=>{if(this.enabled&&this.enableZoom){let r=0,s=0;const o=this._touchCurrent.length;for(let m=0;m<o;m++)r+=this._touchCurrent[m].clientX,s+=this._touchCurrent[m].clientY;this.setCenter(r/o,s/o);const a=8;this._currentCursorPosition.setY(.5*this.getCursorNDC(Ht.x,Ht.y,this.domElement).y);const l=this._currentCursorPosition.y-this._startCursorPosition.y;let c=1;l<0?c=1/Math.pow(this.scaleFactor,-l*a):l>0&&(c=Math.pow(this.scaleFactor,l*a)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);const u=this._v3_1.distanceTo(this._gizmos.position);let h=u/c;h=kt.clamp(h,this.minDistance,this.maxDistance);const d=u*Math.tan(kt.DEG2RAD*this._fovState*.5);let f=kt.RAD2DEG*(2*Math.atan(d/h));f=kt.clamp(f,this.minFov,this.maxFov);const p=d/Math.tan(kt.DEG2RAD*(f/2));c=u/p,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(f),this.applyTransformMatrix(this.scale(c,this._v3_2,!1)),Oi.copy(this._gizmos.position).sub(this.camera.position).normalize().multiplyScalar(p/u),this._m4_1.makeTranslation(Oi.x,Oi.y,Oi.z),this.dispatchEvent(Kn)}}),ut(this,"onTriplePanEnd",()=>{this.updateTbState(vt.IDLE,!1),this.dispatchEvent(Os)}),ut(this,"setCenter",(r,s)=>{Ht.x=r,Ht.y=s}),ut(this,"initializeMouseActions",()=>{this.setMouseAction("PAN",0,"CTRL"),this.setMouseAction("PAN",2),this.setMouseAction("ROTATE",0),this.setMouseAction("ZOOM","WHEEL"),this.setMouseAction("ZOOM",1),this.setMouseAction("FOV","WHEEL","SHIFT"),this.setMouseAction("FOV",1,"SHIFT")}),ut(this,"compareMouseAction",(r,s)=>r.operation==s.operation&&r.mouse==s.mouse&&r.key==s.key),ut(this,"setMouseAction",(r,s,o=null)=>{let u;if(!["PAN","ROTATE","ZOOM","FOV"].includes(r)||![0,1,2,"WHEEL"].includes(s)||!["CTRL","SHIFT",null].includes(o)||"WHEEL"==s&&"ZOOM"!=r&&"FOV"!=r)return!1;switch(r){case"PAN":u=vt.PAN;break;case"ROTATE":u=vt.ROTATE;break;case"ZOOM":u=vt.SCALE;break;case"FOV":u=vt.FOV}const h={operation:r,mouse:s,key:o,state:u};for(let d=0;d<this.mouseActions.length;d++)if(this.mouseActions[d].mouse==h.mouse&&this.mouseActions[d].key==h.key)return this.mouseActions.splice(d,1,h),!0;return this.mouseActions.push(h),!0}),ut(this,"unsetMouseAction",(r,s=null)=>{for(let o=0;o<this.mouseActions.length;o++)if(this.mouseActions[o].mouse==r&&this.mouseActions[o].key==s)return this.mouseActions.splice(o,1),!0;return!1}),ut(this,"getOpFromAction",(r,s)=>{let o;for(let a=0;a<this.mouseActions.length;a++)if(o=this.mouseActions[a],o.mouse==r&&o.key==s)return o.operation;if(null!=s)for(let a=0;a<this.mouseActions.length;a++)if(o=this.mouseActions[a],o.mouse==r&&null==o.key)return o.operation;return null}),ut(this,"getOpStateFromAction",(r,s)=>{let o;for(let a=0;a<this.mouseActions.length;a++)if(o=this.mouseActions[a],o.mouse==r&&o.key==s)return o.state;if(null!=s)for(let a=0;a<this.mouseActions.length;a++)if(o=this.mouseActions[a],o.mouse==r&&null==o.key)return o.state;return null}),ut(this,"getAngle",(r,s)=>180*Math.atan2(s.clientY-r.clientY,s.clientX-r.clientX)/Math.PI),ut(this,"updateTouchEvent",r=>{for(let s=0;s<this._touchCurrent.length;s++)if(this._touchCurrent[s].pointerId==r.pointerId){this._touchCurrent.splice(s,1,r);break}}),ut(this,"calculateAngularSpeed",(r,s,o,a)=>{const c=(a-o)/1e3;return 0==c?0:(s-r)/c}),ut(this,"calculatePointersDistance",(r,s)=>Math.sqrt(Math.pow(s.clientX-r.clientX,2)+Math.pow(s.clientY-r.clientY,2))),ut(this,"calculateRotationAxis",(r,s)=>(this._rotationMatrix.extractRotation(this._cameraMatrixState),this._quat.setFromRotationMatrix(this._rotationMatrix),this._rotationAxis.crossVectors(r,s).applyQuaternion(this._quat),this._rotationAxis.normalize().clone())),ut(this,"calculateTbRadius",r=>{const s=r.position.distanceTo(this._gizmos.position);if("PerspectiveCamera"==r.type){const o=kt.DEG2RAD*r.fov*.5,a=Math.atan(r.aspect*Math.tan(o));return Math.tan(Math.min(o,a))*s*this.radiusFactor}if("OrthographicCamera"==r.type)return Math.min(r.top,r.right)*this.radiusFactor}),ut(this,"focus",(r,s,o=1)=>{Oi.copy(r).sub(this._gizmos.position).multiplyScalar(o),this._translationMatrix.makeTranslation(Oi.x,Oi.y,Oi.z),TU.copy(this._gizmoMatrixState),this._gizmoMatrixState.premultiply(this._translationMatrix),this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),CU.copy(this._cameraMatrixState),this._cameraMatrixState.premultiply(this._translationMatrix),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.enableZoom&&this.applyTransformMatrix(this.scale(s,this._gizmos.position)),this._gizmoMatrixState.copy(TU),this._cameraMatrixState.copy(CU)}),ut(this,"drawGrid",()=>{if(null!=this.scene){let o,a,l,c;if(this.camera.isOrthographicCamera)l=Math.max(this.camera.right-this.camera.left,this.camera.bottom-this.camera.top),c=l/20,o=l/this.camera.zoom*3,a=o/c*this.camera.zoom;else if(this.camera.isPerspectiveCamera){const u=this.camera.position.distanceTo(this._gizmos.position),h=kt.DEG2RAD*this.camera.fov*.5,d=Math.atan(this.camera.aspect*Math.tan(h));l=Math.tan(Math.max(h,d))*u*2,c=l/20,o=3*l,a=o/c}null==this._grid&&(this._grid=new fT(o,a,8947848,8947848),this._grid.position.copy(this._gizmos.position),this._gridPosition.copy(this._grid.position),this._grid.quaternion.copy(this.camera.quaternion),this._grid.rotateX(.5*Math.PI),this.scene.add(this._grid))}}),ut(this,"dispose",()=>{-1!=this._animationId&&window.cancelAnimationFrame(this._animationId),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("pointercancel",this.onPointerCancel),this.domElement.removeEventListener("wheel",this.onWheel),this.domElement.removeEventListener("contextmenu",this.onContextMenu),window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),window.removeEventListener("resize",this.onWindowResize),null!==this.scene&&this.scene.remove(this._gizmos),this.disposeGrid()}),ut(this,"disposeGrid",()=>{null!=this._grid&&null!=this.scene&&(this.scene.remove(this._grid),this._grid=null)}),ut(this,"easeOutCubic",r=>1-Math.pow(1-r,3)),ut(this,"activateGizmos",r=>{const s=this._gizmos.children[0],o=this._gizmos.children[1],a=this._gizmos.children[2];r?(s.material.setValues({opacity:1}),o.material.setValues({opacity:1}),a.material.setValues({opacity:1})):(s.material.setValues({opacity:.6}),o.material.setValues({opacity:.6}),a.material.setValues({opacity:.6}))}),ut(this,"getCursorNDC",(r,s,o)=>{const a=o.getBoundingClientRect();return this._v2_1.setX((r-a.left)/a.width*2-1),this._v2_1.setY((a.bottom-s)/a.height*2-1),this._v2_1.clone()}),ut(this,"getCursorPosition",(r,s,o)=>(this._v2_1.copy(this.getCursorNDC(r,s,o)),this._v2_1.x*=.5*(this.camera.right-this.camera.left),this._v2_1.y*=.5*(this.camera.top-this.camera.bottom),this._v2_1.clone())),ut(this,"setCamera",r=>{r.lookAt(this.target),r.updateMatrix(),"PerspectiveCamera"==r.type&&(this._fov0=r.fov,this._fovState=r.fov),this._cameraMatrixState0.copy(r.matrix),this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraProjectionState.copy(r.projectionMatrix),this._zoom0=r.zoom,this._zoomState=this._zoom0,this._initialNear=r.near,this._nearPos0=r.position.distanceTo(this.target)-r.near,this._nearPos=this._initialNear,this._initialFar=r.far,this._farPos0=r.position.distanceTo(this.target)-r.far,this._farPos=this._initialFar,this._up0.copy(r.up),this._upState.copy(r.up),this.camera=r,this.camera.updateProjectionMatrix(),this._tbRadius=this.calculateTbRadius(r),this.makeGizmos(this.target,this._tbRadius)}),ut(this,"makeGizmos",(r,s)=>{const a=new _l(0,0,s,s).getPoints(this._curvePts),l=(new wt).setFromPoints(a),c=new Pi({color:16744576,fog:!1,transparent:!0,opacity:.6}),u=new Pi({color:8454016,fog:!1,transparent:!0,opacity:.6}),h=new Pi({color:8421631,fog:!1,transparent:!0,opacity:.6}),d=new wi(l,c),f=new wi(l,u),p=new wi(l,h),m=.5*Math.PI;if(d.rotation.x=m,f.rotation.y=m,this._gizmoMatrixState0.identity().setPosition(r),this._gizmoMatrixState.copy(this._gizmoMatrixState0),1!==this.camera.zoom){const g=1/this.camera.zoom;this._scaleMatrix.makeScale(g,g,g),this._translationMatrix.makeTranslation(-r.x,-r.y,-r.z),this._gizmoMatrixState.premultiply(this._translationMatrix).premultiply(this._scaleMatrix),this._translationMatrix.makeTranslation(r.x,r.y,r.z),this._gizmoMatrixState.premultiply(this._translationMatrix)}this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.traverse(function(g){g.isLine&&(g.geometry.dispose(),g.material.dispose())}),this._gizmos.clear(),this._gizmos.add(d),this._gizmos.add(f),this._gizmos.add(p)}),ut(this,"onFocusAnim",(r,s,o,a)=>{if(-1==this._timeStart&&(this._timeStart=r),this._state==vt.ANIMATION_FOCUS){const c=(r-this._timeStart)/this.focusAnimationTime;if(this._gizmoMatrixState.copy(a),c>=1)this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(s,this.scaleFactor),this._timeStart=-1,this.updateTbState(vt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(Kn);else{const u=this.easeOutCubic(c),h=1-u+this.scaleFactor*u;this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(s,h,u),this.dispatchEvent(Kn);const d=this;this._animationId=window.requestAnimationFrame(function(f){d.onFocusAnim(f,s,o,a.clone())})}}else this._animationId=-1,this._timeStart=-1}),ut(this,"onRotationAnim",(r,s,o)=>{if(-1==this._timeStart&&(this._anglePrev=0,this._angleCurrent=0,this._timeStart=r),this._state==vt.ANIMATION_ROTATE){const a=(r-this._timeStart)/1e3;if(o+-this.dampingFactor*a>0){this._angleCurrent=.5*-this.dampingFactor*Math.pow(a,2)+o*a+0,this.applyTransformMatrix(this.rotate(s,this._angleCurrent)),this.dispatchEvent(Kn);const c=this;this._animationId=window.requestAnimationFrame(function(u){c.onRotationAnim(u,s,o)})}else this._animationId=-1,this._timeStart=-1,this.updateTbState(vt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(Kn)}else this._animationId=-1,this._timeStart=-1,this._state!=vt.ROTATE&&(this.activateGizmos(!1),this.dispatchEvent(Kn))}),ut(this,"pan",(r,s,o=!1)=>{const a=r.clone().sub(s);if(this.camera.isOrthographicCamera)a.multiplyScalar(1/this.camera.zoom);else if(this.camera.isPerspectiveCamera&&o){this._v3_1.setFromMatrixPosition(this._cameraMatrixState0),this._v3_2.setFromMatrixPosition(this._gizmoMatrixState0);const l=this._v3_1.distanceTo(this._v3_2)/this.camera.position.distanceTo(this._gizmos.position);a.multiplyScalar(1/l)}return this._v3_1.set(a.x,a.y,0).applyQuaternion(this.camera.quaternion),this._m4_1.makeTranslation(this._v3_1.x,this._v3_1.y,this._v3_1.z),this.setTransformationMatrices(this._m4_1,this._m4_1),fs}),ut(this,"reset",()=>{this.camera.zoom=this._zoom0,this.camera.isPerspectiveCamera&&(this.camera.fov=this._fov0),this.camera.near=this._nearPos,this.camera.far=this._farPos,this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.up.copy(this._up0),this.camera.updateMatrix(),this.camera.updateProjectionMatrix(),this._gizmoMatrixState.copy(this._gizmoMatrixState0),this._gizmoMatrixState0.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix(),this._tbRadius=this.calculateTbRadius(this.camera),this.makeGizmos(this._gizmos.position,this._tbRadius),this.camera.lookAt(this._gizmos.position),this.updateTbState(vt.IDLE,!1),this.dispatchEvent(Kn)}),ut(this,"rotate",(r,s)=>{const o=this._gizmos.position;return this._translationMatrix.makeTranslation(-o.x,-o.y,-o.z),this._rotationMatrix.makeRotationAxis(r,-s),this._m4_1.makeTranslation(o.x,o.y,o.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this.setTransformationMatrices(this._m4_1),fs}),ut(this,"copyState",()=>{let r;this.camera.isOrthographicCamera?r=JSON.stringify({arcballState:{cameraFar:this.camera.far,cameraMatrix:this.camera.matrix,cameraNear:this.camera.near,cameraUp:this.camera.up,cameraZoom:this.camera.zoom,gizmoMatrix:this._gizmos.matrix}}):this.camera.isPerspectiveCamera&&(r=JSON.stringify({arcballState:{cameraFar:this.camera.far,cameraFov:this.camera.fov,cameraMatrix:this.camera.matrix,cameraNear:this.camera.near,cameraUp:this.camera.up,cameraZoom:this.camera.zoom,gizmoMatrix:this._gizmos.matrix}})),navigator.clipboard.writeText(r)}),ut(this,"pasteState",()=>{const r=this;navigator.clipboard.readText().then(function(o){r.setStateFromJSON(o)})}),ut(this,"saveState",()=>{this._cameraMatrixState0.copy(this.camera.matrix),this._gizmoMatrixState0.copy(this._gizmos.matrix),this._nearPos=this.camera.near,this._farPos=this.camera.far,this._zoom0=this.camera.zoom,this._up0.copy(this.camera.up),this.camera.isPerspectiveCamera&&(this._fov0=this.camera.fov)}),ut(this,"scale",(r,s,o=!0)=>{So.copy(s);let a=1/r;if(this.camera.isOrthographicCamera){this.camera.zoom=this._zoomState,this.camera.zoom*=r,this.camera.zoom>this.maxZoom?(this.camera.zoom=this.maxZoom,a=this._zoomState/this.maxZoom):this.camera.zoom<this.minZoom&&(this.camera.zoom=this.minZoom,a=this._zoomState/this.minZoom),this.camera.updateProjectionMatrix(),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState),this._scaleMatrix.makeScale(a,a,a),this._translationMatrix.makeTranslation(-this._v3_1.x,-this._v3_1.y,-this._v3_1.z),this._m4_2.makeTranslation(this._v3_1.x,this._v3_1.y,this._v3_1.z).multiply(this._scaleMatrix),this._m4_2.multiply(this._translationMatrix),So.sub(this._v3_1);const l=So.clone().multiplyScalar(a);return So.sub(l),this._m4_1.makeTranslation(So.x,So.y,So.z),this._m4_2.premultiply(this._m4_1),this.setTransformationMatrices(this._m4_1,this._m4_2),fs}if(this.camera.isPerspectiveCamera){this._v3_1.setFromMatrixPosition(this._cameraMatrixState),this._v3_2.setFromMatrixPosition(this._gizmoMatrixState);let l=this._v3_1.distanceTo(So),c=l-l*a;const u=l-c;if(u<this.minDistance?(a=this.minDistance/l,c=l-l*a):u>this.maxDistance&&(a=this.maxDistance/l,c=l-l*a),Oi.copy(So).sub(this._v3_1).normalize().multiplyScalar(c),this._m4_1.makeTranslation(Oi.x,Oi.y,Oi.z),o){const h=this._v3_2;l=h.distanceTo(So),c=l-l*a,Oi.copy(So).sub(this._v3_2).normalize().multiplyScalar(c),this._translationMatrix.makeTranslation(h.x,h.y,h.z),this._scaleMatrix.makeScale(a,a,a),this._m4_2.makeTranslation(Oi.x,Oi.y,Oi.z).multiply(this._translationMatrix),this._m4_2.multiply(this._scaleMatrix),this._translationMatrix.makeTranslation(-h.x,-h.y,-h.z),this._m4_2.multiply(this._translationMatrix),this.setTransformationMatrices(this._m4_1,this._m4_2)}else this.setTransformationMatrices(this._m4_1);return fs}}),ut(this,"setFov",r=>{this.camera.isPerspectiveCamera&&(this.camera.fov=kt.clamp(r,this.minFov,this.maxFov),this.camera.updateProjectionMatrix())}),ut(this,"zRotate",(r,s)=>(this._rotationMatrix.makeRotationAxis(this._rotationAxis,s),this._translationMatrix.makeTranslation(-r.x,-r.y,-r.z),this._m4_1.makeTranslation(r.x,r.y,r.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState).sub(r),this._v3_2.copy(this._v3_1).applyAxisAngle(this._rotationAxis,s),this._v3_2.sub(this._v3_1),this._m4_2.makeTranslation(this._v3_2.x,this._v3_2.y,this._v3_2.z),this.setTransformationMatrices(this._m4_1,this._m4_2),fs)),ut(this,"unprojectOnObj",(r,s)=>{const o=this.getRaycaster();o.near=s.near,o.far=s.far,o.setFromCamera(r,s);const a=o.intersectObjects(this.scene.children,!0);for(let l=0;l<a.length;l++)if(a[l].object.uuid!=this._gizmos.uuid&&null!=a[l].face)return a[l].point.clone();return null}),ut(this,"unprojectOnTbSurface",(r,s,o,a,l)=>{if("OrthographicCamera"==r.type){this._v2_1.copy(this.getCursorPosition(s,o,a)),this._v3_1.set(this._v2_1.x,this._v2_1.y,0);const c=Math.pow(this._v2_1.x,2),u=Math.pow(this._v2_1.y,2),h=Math.pow(this._tbRadius,2);return this._v3_1.setZ(c+u<=.5*h?Math.sqrt(h-(c+u)):.5*h/Math.sqrt(c+u)),this._v3_1}if("PerspectiveCamera"==r.type){this._v2_1.copy(this.getCursorNDC(s,o,a)),this._v3_1.set(this._v2_1.x,this._v2_1.y,-1),this._v3_1.applyMatrix4(r.projectionMatrixInverse);const c=this._v3_1.clone().normalize(),u=r.position.distanceTo(this._gizmos.position),h=Math.pow(l,2),d=this._v3_1.z,f=Math.sqrt(Math.pow(this._v3_1.x,2)+Math.pow(this._v3_1.y,2));if(0==f)return c.set(this._v3_1.x,this._v3_1.y,l),c;const p=d/f,m=u;let g=Math.pow(p,2)+1,_=2*p*m,v=Math.pow(m,2)-h,y=Math.pow(_,2)-4*g*v;if(y>=0&&(this._v2_1.setX((-_-Math.sqrt(y))/(2*g)),this._v2_1.setY(p*this._v2_1.x+m),kt.RAD2DEG*this._v2_1.angle()>=45)){const M=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(u-this._v2_1.y,2));return c.multiplyScalar(M),c.z+=u,c}g=p,_=m,v=.5*-h,y=Math.pow(_,2)-4*g*v,this._v2_1.setX((-_-Math.sqrt(y))/(2*g)),this._v2_1.setY(p*this._v2_1.x+m);const b=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(u-this._v2_1.y,2));return c.multiplyScalar(b),c.z+=u,c}}),ut(this,"unprojectOnTbPlane",(r,s,o,a,l=!1)=>{if("OrthographicCamera"==r.type)return this._v2_1.copy(this.getCursorPosition(s,o,a)),this._v3_1.set(this._v2_1.x,this._v2_1.y,0),this._v3_1.clone();if("PerspectiveCamera"==r.type){this._v2_1.copy(this.getCursorNDC(s,o,a)),this._v3_1.set(this._v2_1.x,this._v2_1.y,-1),this._v3_1.applyMatrix4(r.projectionMatrixInverse);const c=this._v3_1.clone().normalize(),u=this._v3_1.z,h=Math.sqrt(Math.pow(this._v3_1.x,2)+Math.pow(this._v3_1.y,2));let d;if(d=l?this._v3_1.setFromMatrixPosition(this._cameraMatrixState0).distanceTo(this._v3_2.setFromMatrixPosition(this._gizmoMatrixState0)):r.position.distanceTo(this._gizmos.position),0==h)return c.set(0,0,0),c;const m=-d/(u/h),g=Math.sqrt(Math.pow(d,2)+Math.pow(m,2));return c.multiplyScalar(g),c.z=0,c}}),ut(this,"updateMatrixState",()=>{this._cameraMatrixState.copy(this.camera.matrix),this._gizmoMatrixState.copy(this._gizmos.matrix),this.camera.isOrthographicCamera?(this._cameraProjectionState.copy(this.camera.projectionMatrix),this.camera.updateProjectionMatrix(),this._zoomState=this.camera.zoom):this.camera.isPerspectiveCamera&&(this._fovState=this.camera.fov)}),ut(this,"updateTbState",(r,s)=>{this._state=r,s&&this.updateMatrixState()}),ut(this,"update",()=>{if(!1===this.target.equals(this._currentTarget)&&(this._gizmos.position.copy(this.target),this._tbRadius=this.calculateTbRadius(this.camera),this.makeGizmos(this.target,this._tbRadius),this._currentTarget.copy(this.target)),this.camera.isOrthographicCamera){if(this.camera.zoom>this.maxZoom||this.camera.zoom<this.minZoom){const s=kt.clamp(this.camera.zoom,this.minZoom,this.maxZoom);this.applyTransformMatrix(this.scale(s/this.camera.zoom,this._gizmos.position,!0))}}else if(this.camera.isPerspectiveCamera){const s=this.camera.position.distanceTo(this._gizmos.position);if(s>this.maxDistance+1e-6||s<this.minDistance-1e-6){const a=kt.clamp(s,this.minDistance,this.maxDistance);this.applyTransformMatrix(this.scale(a/s,this._gizmos.position)),this.updateMatrixState()}(this.camera.fov<this.minFov||this.camera.fov>this.maxFov)&&(this.camera.fov=kt.clamp(this.camera.fov,this.minFov,this.maxFov),this.camera.updateProjectionMatrix());const o=this._tbRadius;if(this._tbRadius=this.calculateTbRadius(this.camera),o<this._tbRadius-1e-6||o>this._tbRadius+1e-6){const l=this._tbRadius/((this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3),u=new _l(0,0,l,l).getPoints(this._curvePts),h=(new wt).setFromPoints(u);for(const d in this._gizmos.children)this._gizmos.children[d].geometry=h}}this.camera.lookAt(this._gizmos.position)}),ut(this,"setStateFromJSON",r=>{const s=JSON.parse(r);if(null!=s.arcballState){this._cameraMatrixState.fromArray(s.arcballState.cameraMatrix.elements),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.up.copy(s.arcballState.cameraUp),this.camera.near=s.arcballState.cameraNear,this.camera.far=s.arcballState.cameraFar,this.camera.zoom=s.arcballState.cameraZoom,this.camera.isPerspectiveCamera&&(this.camera.fov=s.arcballState.cameraFov),this._gizmoMatrixState.fromArray(s.arcballState.gizmoMatrix.elements),this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.camera.updateMatrix(),this.camera.updateProjectionMatrix(),this._gizmos.updateMatrix(),this._tbRadius=this.calculateTbRadius(this.camera);const o=(new st).copy(this._gizmoMatrixState0);this.makeGizmos(this._gizmos.position,this._tbRadius),this._gizmoMatrixState0.copy(o),this.camera.lookAt(this._gizmos.position),this.updateTbState(vt.IDLE,!1),this.dispatchEvent(Kn)}}),this.camera=null,this.domElement=t,this.scene=n,this.target=new C,this._currentTarget=new C,this.radiusFactor=.67,this.mouseActions=[],this._mouseOp=null,this._v2_1=new te,this._v3_1=new C,this._v3_2=new C,this._m4_1=new st,this._m4_2=new st,this._quat=new bn,this._translationMatrix=new st,this._rotationMatrix=new st,this._scaleMatrix=new st,this._rotationAxis=new C,this._cameraMatrixState=new st,this._cameraProjectionState=new st,this._fovState=1,this._upState=new C,this._zoomState=1,this._nearPos=0,this._farPos=0,this._gizmoMatrixState=new st,this._up0=new C,this._zoom0=1,this._fov0=0,this._initialNear=0,this._nearPos0=0,this._initialFar=0,this._farPos0=0,this._cameraMatrixState0=new st,this._gizmoMatrixState0=new st,this._button=-1,this._touchStart=[],this._touchCurrent=[],this._input=Rn.NONE,this._switchSensibility=32,this._startFingerDistance=0,this._currentFingerDistance=0,this._startFingerRotation=0,this._currentFingerRotation=0,this._devPxRatio=0,this._downValid=!0,this._nclicks=0,this._downEvents=[],this._downStart=0,this._clickStart=0,this._maxDownTime=250,this._maxInterval=300,this._posThreshold=24,this._movementThreshold=24,this._currentCursorPosition=new C,this._startCursorPosition=new C,this._grid=null,this._gridPosition=new C,this._gizmos=new Xo,this._curvePts=128,this._timeStart=-1,this._animationId=-1,this.focusAnimationTime=500,this._timePrev=0,this._timeCurrent=0,this._anglePrev=0,this._angleCurrent=0,this._cursorPosPrev=new C,this._cursorPosCurr=new C,this._wPrev=0,this._wCurr=0,this.adjustNearFar=!1,this.scaleFactor=1.1,this.dampingFactor=25,this.wMax=20,this.enableAnimations=!0,this.enableGrid=!1,this.cursorZoom=!1,this.minFov=5,this.maxFov=90,this.enabled=!0,this.enablePan=!0,this.enableRotate=!0,this.enableZoom=!0,this.enableGizmos=!0,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this._tbRadius=1,this._state=vt.IDLE,this.setCamera(e),null!=this.scene&&this.scene.add(this._gizmos),this.domElement.style.touchAction="none",this._devPxRatio=window.devicePixelRatio,this.initializeMouseActions(),this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("wheel",this.onWheel),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointercancel",this.onPointerCancel),window.addEventListener("resize",this.onWindowResize)}applyTransformMatrix(e){if(null!=e.camera&&(this._m4_1.copy(this._cameraMatrixState).premultiply(e.camera),this._m4_1.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.updateMatrix(),(this._state==vt.ROTATE||this._state==vt.ZROTATE||this._state==vt.ANIMATION_ROTATE)&&this.camera.up.copy(this._upState).applyQuaternion(this.camera.quaternion)),null!=e.gizmos&&(this._m4_1.copy(this._gizmoMatrixState).premultiply(e.gizmos),this._m4_1.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix()),this._state==vt.SCALE||this._state==vt.FOCUS||this._state==vt.ANIMATION_FOCUS)if(this._tbRadius=this.calculateTbRadius(this.camera),this.adjustNearFar){const t=this.camera.position.distanceTo(this._gizmos.position),n=new Ho;n.setFromObject(this._gizmos);const r=new xa;n.getBoundingSphere(r);const s=Math.max(this._nearPos0,r.radius+r.center.length()),a=Math.min(s,t-this._initialNear);this.camera.near=t-a;const l=Math.min(this._farPos0,-r.radius+r.center.length()),u=Math.min(l,t-this._initialFar);this.camera.far=t-u,this.camera.updateProjectionMatrix()}else{let t=!1;this.camera.near!=this._initialNear&&(this.camera.near=this._initialNear,t=!0),this.camera.far!=this._initialFar&&(this.camera.far=this._initialFar,t=!0),t&&this.camera.updateProjectionMatrix()}}setGizmosVisible(e){this._gizmos.visible=e,this.dispatchEvent(Kn)}setTbRadius(e){this.radiusFactor=e,this._tbRadius=this.calculateTbRadius(this.camera);const n=new _l(0,0,this._tbRadius,this._tbRadius).getPoints(this._curvePts),r=(new wt).setFromPoints(n);for(const s in this._gizmos.children)this._gizmos.children[s].geometry=r;this.dispatchEvent(Kn)}setTransformationMatrices(e=null,t=null){null!=e?null!=fs.camera?fs.camera.copy(e):fs.camera=e.clone():fs.camera=null,null!=t?null!=fs.gizmos?fs.gizmos.copy(t):fs.gizmos=t.clone():fs.gizmos=null}getRaycaster(){return vce}}let bce=(()=>{class i extends vr{getType(){return yce}set camera(t){this._objRef&&(this._objRef.camera=t)}set domElement(t){this._objRef&&(this._objRef.domElement=t)}set scene(t){this._objRef&&(this._objRef.scene=t)}set focusAnimationTime(t){this._objRef&&(this._objRef.focusAnimationTime=t)}set enabled(t){this._objRef&&(this._objRef.enabled=t)}set enablePan(t){this._objRef&&(this._objRef.enablePan=t)}set enableRotate(t){this._objRef&&(this._objRef.enableRotate=t)}set enableZoom(t){this._objRef&&(this._objRef.enableZoom=t)}set enableGizmos(t){this._objRef&&(this._objRef.enableGizmos=t)}set adjustNearFar(t){this._objRef&&(this._objRef.adjustNearFar=t)}set scaleFactor(t){this._objRef&&(this._objRef.scaleFactor=t)}set dampingFactor(t){this._objRef&&(this._objRef.dampingFactor=t)}set wMax(t){this._objRef&&(this._objRef.wMax=t)}set enableAnimations(t){this._objRef&&(this._objRef.enableAnimations=t)}set enableGrid(t){this._objRef&&(this._objRef.enableGrid=t)}set cursorZoom(t){this._objRef&&(this._objRef.cursorZoom=t)}set minFov(t){this._objRef&&(this._objRef.minFov=t)}set maxFov(t){this._objRef&&(this._objRef.maxFov=t)}set minDistance(t){this._objRef&&(this._objRef.minDistance=t)}set maxDistance(t){this._objRef&&(this._objRef.maxDistance=t)}set minZoom(t){this._objRef&&(this._objRef.minZoom=t)}set maxZoom(t){this._objRef&&(this._objRef.maxZoom=t)}set target(t){this._objRef&&(this._objRef.target=Ft(this._objRef.target,t))}set radiusFactor(t){this._objRef&&(this._objRef.radiusFactor=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-arcballControls"]],inputs:{camera:"camera",domElement:"domElement",scene:"scene",focusAnimationTime:"focusAnimationTime",enabled:"enabled",enablePan:"enablePan",enableRotate:"enableRotate",enableZoom:"enableZoom",enableGizmos:"enableGizmos",adjustNearFar:"adjustNearFar",scaleFactor:"scaleFactor",dampingFactor:"dampingFactor",wMax:"wMax",enableAnimations:"enableAnimations",enableGrid:"enableGrid",cursorZoom:"cursorZoom",minFov:"minFov",maxFov:"maxFov",minDistance:"minDistance",maxDistance:"maxDistance",minZoom:"minZoom",maxZoom:"maxZoom",target:"target",radiusFactor:"radiusFactor"},features:[Xe([{provide:vr,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();const SC={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new te(.001953125,0)},cKernel:{value:[]}},vertexShader:"\n\n\t\tuniform vec2 uImageIncrement;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float cKernel[ KERNEL_SIZE_INT ];\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec2 uImageIncrement;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec2 imageCoord = vUv;\n\t\t\tvec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );\n\n\t\t\tfor( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {\n\n\t\t\t\tsum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];\n\t\t\t\timageCoord += uImageIncrement;\n\n\t\t\t}\n\n\t\t\tgl_FragColor = sum;\n\n\t\t}",buildKernel:function(i){let t=2*Math.ceil(3*i)+1;t>25&&(t=25);const n=.5*(t-1),r=new Array(t);let s=0;for(let o=0;o<t;++o)r[o]=xce(o-n,i),s+=r[o];for(let o=0;o<t;++o)r[o]/=s;return r}};function xce(i,e){return Math.exp(-i*i/(2*e*e))}class gd extends Qo{constructor(e=1,t=25,n=4,r=256){super(),this.renderTargetX=new Wn(r,r),this.renderTargetX.texture.name="BloomPass.x",this.renderTargetY=new Wn(r,r),this.renderTargetY.texture.name="BloomPass.y",this.combineUniforms=Go.clone(TC.uniforms),this.combineUniforms.strength.value=e,this.materialCombine=new Zn({uniforms:this.combineUniforms,vertexShader:TC.vertexShader,fragmentShader:TC.fragmentShader,blending:ih,transparent:!0}),void 0===SC&&console.error("THREE.BloomPass relies on ConvolutionShader");const s=SC;this.convolutionUniforms=Go.clone(s.uniforms),this.convolutionUniforms.uImageIncrement.value=gd.blurX,this.convolutionUniforms.cKernel.value=SC.buildKernel(n),this.materialConvolution=new Zn({uniforms:this.convolutionUniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,defines:{KERNEL_SIZE_FLOAT:t.toFixed(1),KERNEL_SIZE_INT:t.toFixed(0)}}),this.needsSwap=!1,this.fsQuad=new md(null)}render(e,t,n,r,s){s&&e.state.buffers.stencil.setTest(!1),this.fsQuad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=n.texture,this.convolutionUniforms.uImageIncrement.value=gd.blurX,e.setRenderTarget(this.renderTargetX),e.clear(),this.fsQuad.render(e),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=gd.blurY,e.setRenderTarget(this.renderTargetY),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCombine,this.combineUniforms.tDiffuse.value=this.renderTargetY.texture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(n),this.clear&&e.clear(),this.fsQuad.render(e)}}const TC={uniforms:{tDiffuse:{value:null},strength:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float strength;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = strength * texel;\n\n\t\t}"};gd.blurX=new te(.001953125,0),gd.blurY=new te(0,.001953125),new C,new hN,new Wo,new C,new hs;const DU={uniforms:{tDiffuse:{value:null},tSize:{value:new te(256,256)},center:{value:new te(.5,.5)},angle:{value:1.57},scale:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform vec2 center;\n\t\tuniform float angle;\n\t\tuniform float scale;\n\t\tuniform vec2 tSize;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tfloat pattern() {\n\n\t\t\tfloat s = sin( angle ), c = cos( angle );\n\n\t\t\tvec2 tex = vUv * tSize - center;\n\t\t\tvec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;\n\n\t\t\treturn ( sin( point.x ) * sin( point.y ) ) * 4.0;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvec4 color = texture2D( tDiffuse, vUv );\n\n\t\t\tfloat average = ( color.r + color.g + color.b ) / 3.0;\n\n\t\t\tgl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );\n\n\t\t}"},_d=new Wo,Il=new mp,nm=new te,PU=new C,R0=new C,RC=new C,IU=new st;class Tce extends ls{constructor(e,t,n){super(),n.style.touchAction="none";let r=null,s=null;const o=[],a=this;function l(){n.addEventListener("pointermove",f),n.addEventListener("pointerdown",p),n.addEventListener("pointerup",m),n.addEventListener("pointerleave",m)}function c(){n.removeEventListener("pointermove",f),n.removeEventListener("pointerdown",p),n.removeEventListener("pointerup",m),n.removeEventListener("pointerleave",m),n.style.cursor=""}function f(_){if(!1!==a.enabled){if(g(_),Il.setFromCamera(nm,t),r)return Il.ray.intersectPlane(_d,R0)&&r.position.copy(R0.sub(PU).applyMatrix4(IU)),void a.dispatchEvent({type:"drag",object:r});if("mouse"===_.pointerType||"pen"===_.pointerType)if(o.length=0,Il.setFromCamera(nm,t),Il.intersectObjects(e,!0,o),o.length>0){const v=o[0].object;_d.setFromNormalAndCoplanarPoint(t.getWorldDirection(_d.normal),RC.setFromMatrixPosition(v.matrixWorld)),s!==v&&null!==s&&(a.dispatchEvent({type:"hoveroff",object:s}),n.style.cursor="auto",s=null),s!==v&&(a.dispatchEvent({type:"hoveron",object:v}),n.style.cursor="pointer",s=v)}else null!==s&&(a.dispatchEvent({type:"hoveroff",object:s}),n.style.cursor="auto",s=null)}}function p(_){!1!==a.enabled&&(g(_),o.length=0,Il.setFromCamera(nm,t),Il.intersectObjects(e,!0,o),o.length>0&&(r=!0===a.transformGroup?e[0]:o[0].object,_d.setFromNormalAndCoplanarPoint(t.getWorldDirection(_d.normal),RC.setFromMatrixPosition(r.matrixWorld)),Il.ray.intersectPlane(_d,R0)&&(IU.copy(r.parent.matrixWorld).invert(),PU.copy(R0).sub(RC.setFromMatrixPosition(r.matrixWorld))),n.style.cursor="move",a.dispatchEvent({type:"dragstart",object:r})))}function m(){!1!==a.enabled&&(r&&(a.dispatchEvent({type:"dragend",object:r}),r=null),n.style.cursor=s?"pointer":"auto")}function g(_){const v=n.getBoundingClientRect();nm.x=(_.clientX-v.left)/v.width*2-1,nm.y=-(_.clientY-v.top)/v.height*2+1}l(),this.enabled=!0,this.transformGroup=!1,this.activate=l,this.deactivate=c,this.dispose=function u(){c()},this.getObjects=function h(){return e},this.getRaycaster=function d(){return Il}}}let Cce=(()=>{class i extends vr{getType(){return Tce}set object(t){this._objRef&&(this._objRef.object=t)}set enabled(t){this._objRef&&(this._objRef.enabled=t)}set transformGroup(t){this._objRef&&(this._objRef.transformGroup=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-dragControls"]],inputs:{object:"object",enabled:"enabled",transformGroup:"transformGroup"},features:[Xe([{provide:vr,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();const FU={uniforms:{tDiffuse:{value:null},time:{value:0},nIntensity:{value:.5},sIntensity:{value:.05},sCount:{value:4096},grayscale:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\t#include <common>\n\n\t\t// control parameter\n\t\tuniform float time;\n\n\t\tuniform bool grayscale;\n\n\t\t// noise effect intensity value (0 = no effect, 1 = full effect)\n\t\tuniform float nIntensity;\n\n\t\t// scanlines effect intensity value (0 = no effect, 1 = full effect)\n\t\tuniform float sIntensity;\n\n\t\t// scanlines effect count value (0 = no effect, 4096 = full effect)\n\t\tuniform float sCount;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t// sample the source\n\t\t\tvec4 cTextureScreen = texture2D( tDiffuse, vUv );\n\n\t\t// make some noise\n\t\t\tfloat dx = rand( vUv + time );\n\n\t\t// add noise\n\t\t\tvec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );\n\n\t\t// get us a sine and cosine\n\t\t\tvec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );\n\n\t\t// add scanlines\n\t\t\tcResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;\n\n\t\t// interpolate between source and result by intensity\n\t\t\tcResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );\n\n\t\t// convert to grayscale if desired\n\t\t\tif( grayscale ) {\n\n\t\t\t\tcResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );\n\n\t\t\t}\n\n\t\t\tgl_FragColor =  vec4( cResult, cTextureScreen.a );\n\n\t\t}"};class Ece extends Qo{constructor(e,t,n,r){super(),void 0===FU&&console.error("THREE.FilmPass relies on FilmShader");const s=FU;this.uniforms=Go.clone(s.uniforms),this.material=new Zn({uniforms:this.uniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader}),void 0!==r&&(this.uniforms.grayscale.value=r),void 0!==e&&(this.uniforms.nIntensity.value=e),void 0!==t&&(this.uniforms.sIntensity.value=t),void 0!==n&&(this.uniforms.sCount.value=n),this.fsQuad=new md(this.material)}render(e,t,n,r){this.uniforms.tDiffuse.value=n.texture,this.uniforms.time.value+=r,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}}let Rce=(()=>{class i extends Qp{getType(){return Ece}set uniforms(t){this._objRef&&Object.assign(this._objRef.uniforms,t)}set material(t){this._objRef&&(this._objRef.material=t)}set fsQuad(t){this._objRef&&(this._objRef.fsQuad=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-filmPass"]],inputs:{uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[Xe([{provide:Dl,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();const LU=new C,AC=new Ev,DC=new C;class Ace{constructor(e,t){void 0===t&&(console.warn('THREE.FirstPersonControls: The second parameter "domElement" is now mandatory.'),t=document),this.object=e,this.domElement=t,this.enabled=!0,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.mouseDragOn=!1,this.autoSpeedFactor=0,this.mouseX=0,this.mouseY=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.viewHalfX=0,this.viewHalfY=0;let n=0,r=0;this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onMouseDown=function(h){if(this.domElement!==document&&this.domElement.focus(),this.activeLook)switch(h.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0},this.onMouseUp=function(h){if(this.activeLook)switch(h.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1},this.onMouseMove=function(h){this.domElement===document?(this.mouseX=h.pageX-this.viewHalfX,this.mouseY=h.pageY-this.viewHalfY):(this.mouseX=h.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=h.pageY-this.domElement.offsetTop-this.viewHalfY)},this.onKeyDown=function(h){switch(h.code){case"ArrowUp":case"KeyW":this.moveForward=!0;break;case"ArrowLeft":case"KeyA":this.moveLeft=!0;break;case"ArrowDown":case"KeyS":this.moveBackward=!0;break;case"ArrowRight":case"KeyD":this.moveRight=!0;break;case"KeyR":this.moveUp=!0;break;case"KeyF":this.moveDown=!0}},this.onKeyUp=function(h){switch(h.code){case"ArrowUp":case"KeyW":this.moveForward=!1;break;case"ArrowLeft":case"KeyA":this.moveLeft=!1;break;case"ArrowDown":case"KeyS":this.moveBackward=!1;break;case"ArrowRight":case"KeyD":this.moveRight=!1;break;case"KeyR":this.moveUp=!1;break;case"KeyF":this.moveDown=!1}},this.lookAt=function(h,d,f){return h.isVector3?DC.copy(h):DC.set(h,d,f),this.object.lookAt(DC),u(this),this},this.update=function(){const h=new C;return function(f){if(!1===this.enabled)return;if(this.heightSpeed){const w=kt.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=f*(w*this.heightCoef)}else this.autoSpeedFactor=0;const p=f*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(p+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(p),this.moveLeft&&this.object.translateX(-p),this.moveRight&&this.object.translateX(p),this.moveUp&&this.object.translateY(p),this.moveDown&&this.object.translateY(-p);let m=f*this.lookSpeed;this.activeLook||(m=0);let g=1;this.constrainVertical&&(g=Math.PI/(this.verticalMax-this.verticalMin)),r-=this.mouseX*m,this.lookVertical&&(n-=this.mouseY*m*g),n=Math.max(-85,Math.min(85,n));let _=kt.degToRad(90-n);const v=kt.degToRad(r);this.constrainVertical&&(_=kt.mapLinear(_,0,Math.PI,this.verticalMin,this.verticalMax));const y=this.object.position;h.setFromSphericalCoords(1,_,v).add(y),this.object.lookAt(h)}}(),this.dispose=function(){this.domElement.removeEventListener("contextmenu",OU),this.domElement.removeEventListener("mousedown",o),this.domElement.removeEventListener("mousemove",s),this.domElement.removeEventListener("mouseup",a),window.removeEventListener("keydown",l),window.removeEventListener("keyup",c)};const s=this.onMouseMove.bind(this),o=this.onMouseDown.bind(this),a=this.onMouseUp.bind(this),l=this.onKeyDown.bind(this),c=this.onKeyUp.bind(this);function u(h){const d=h.object.quaternion;LU.set(0,0,-1).applyQuaternion(d),AC.setFromVector3(LU),n=90-kt.radToDeg(AC.phi),r=kt.radToDeg(AC.theta)}this.domElement.addEventListener("contextmenu",OU),this.domElement.addEventListener("mousemove",s),this.domElement.addEventListener("mousedown",o),this.domElement.addEventListener("mouseup",a),window.addEventListener("keydown",l),window.addEventListener("keyup",c),this.handleResize(),u(this)}}function OU(i){i.preventDefault()}let Dce=(()=>{class i extends vr{getType(){return Ace}set object(t){this._objRef&&(this._objRef.object=t)}set domElement(t){this._objRef&&(this._objRef.domElement=t)}set enabled(t){this._objRef&&(this._objRef.enabled=t)}set movementSpeed(t){this._objRef&&(this._objRef.movementSpeed=t)}set lookSpeed(t){this._objRef&&(this._objRef.lookSpeed=t)}set lookVertical(t){this._objRef&&(this._objRef.lookVertical=t)}set autoForward(t){this._objRef&&(this._objRef.autoForward=t)}set activeLook(t){this._objRef&&(this._objRef.activeLook=t)}set heightSpeed(t){this._objRef&&(this._objRef.heightSpeed=t)}set heightCoef(t){this._objRef&&(this._objRef.heightCoef=t)}set heightMin(t){this._objRef&&(this._objRef.heightMin=t)}set heightMax(t){this._objRef&&(this._objRef.heightMax=t)}set constrainVertical(t){this._objRef&&(this._objRef.constrainVertical=t)}set verticalMin(t){this._objRef&&(this._objRef.verticalMin=t)}set verticalMax(t){this._objRef&&(this._objRef.verticalMax=t)}set mouseDragOn(t){this._objRef&&(this._objRef.mouseDragOn=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-firstPersonControls"]],inputs:{object:"object",domElement:"domElement",enabled:"enabled",movementSpeed:"movementSpeed",lookSpeed:"lookSpeed",lookVertical:"lookVertical",autoForward:"autoForward",activeLook:"activeLook",heightSpeed:"heightSpeed",heightCoef:"heightCoef",heightMin:"heightMin",heightMax:"heightMax",constrainVertical:"constrainVertical",verticalMin:"verticalMin",verticalMax:"verticalMax",mouseDragOn:"mouseDragOn"},features:[Xe([{provide:vr,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();const Pce={type:"change"};class Ice extends ls{constructor(e,t){super(),void 0===t&&(console.warn('THREE.FlyControls: The second parameter "domElement" is now mandatory.'),t=document),this.object=e,this.domElement=t,this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1;const n=this,r=1e-6,s=new bn,o=new C;this.tmpQuaternion=new bn,this.mouseStatus=0,this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this.moveVector=new C(0,0,0),this.rotationVector=new C(0,0,0),this.keydown=function(d){if(!d.altKey){switch(d.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this.moveState.forward=1;break;case"KeyS":this.moveState.back=1;break;case"KeyA":this.moveState.left=1;break;case"KeyD":this.moveState.right=1;break;case"KeyR":this.moveState.up=1;break;case"KeyF":this.moveState.down=1;break;case"ArrowUp":this.moveState.pitchUp=1;break;case"ArrowDown":this.moveState.pitchDown=1;break;case"ArrowLeft":this.moveState.yawLeft=1;break;case"ArrowRight":this.moveState.yawRight=1;break;case"KeyQ":this.moveState.rollLeft=1;break;case"KeyE":this.moveState.rollRight=1}this.updateMovementVector(),this.updateRotationVector()}},this.keyup=function(d){switch(d.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this.moveState.forward=0;break;case"KeyS":this.moveState.back=0;break;case"KeyA":this.moveState.left=0;break;case"KeyD":this.moveState.right=0;break;case"KeyR":this.moveState.up=0;break;case"KeyF":this.moveState.down=0;break;case"ArrowUp":this.moveState.pitchUp=0;break;case"ArrowDown":this.moveState.pitchDown=0;break;case"ArrowLeft":this.moveState.yawLeft=0;break;case"ArrowRight":this.moveState.yawRight=0;break;case"KeyQ":this.moveState.rollLeft=0;break;case"KeyE":this.moveState.rollRight=0}this.updateMovementVector(),this.updateRotationVector()},this.mousedown=function(d){if(this.dragToLook)this.mouseStatus++;else{switch(d.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1}this.updateMovementVector()}},this.mousemove=function(d){if(!this.dragToLook||this.mouseStatus>0){const f=this.getContainerDimensions(),p=f.size[0]/2,m=f.size[1]/2;this.moveState.yawLeft=-(d.pageX-f.offset[0]-p)/p,this.moveState.pitchDown=(d.pageY-f.offset[1]-m)/m,this.updateRotationVector()}},this.mouseup=function(d){if(this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(d.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0}this.updateMovementVector()}this.updateRotationVector()},this.update=function(d){const f=d*n.movementSpeed,p=d*n.rollSpeed;n.object.translateX(n.moveVector.x*f),n.object.translateY(n.moveVector.y*f),n.object.translateZ(n.moveVector.z*f),n.tmpQuaternion.set(n.rotationVector.x*p,n.rotationVector.y*p,n.rotationVector.z*p,1).normalize(),n.object.quaternion.multiply(n.tmpQuaternion),(o.distanceToSquared(n.object.position)>r||8*(1-s.dot(n.object.quaternion))>r)&&(n.dispatchEvent(Pce),s.copy(n.object.quaternion),o.copy(n.object.position))},this.updateMovementVector=function(){const d=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-d+this.moveState.back},this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft},this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}},this.dispose=function(){this.domElement.removeEventListener("contextmenu",kU),this.domElement.removeEventListener("mousedown",l),this.domElement.removeEventListener("mousemove",a),this.domElement.removeEventListener("mouseup",c),window.removeEventListener("keydown",u),window.removeEventListener("keyup",h)};const a=this.mousemove.bind(this),l=this.mousedown.bind(this),c=this.mouseup.bind(this),u=this.keydown.bind(this),h=this.keyup.bind(this);this.domElement.addEventListener("contextmenu",kU),this.domElement.addEventListener("mousemove",a),this.domElement.addEventListener("mousedown",l),this.domElement.addEventListener("mouseup",c),window.addEventListener("keydown",u),window.addEventListener("keyup",h),this.updateMovementVector(),this.updateRotationVector()}}function kU(i){i.preventDefault()}let Fce=(()=>{class i extends vr{getType(){return Ice}set object(t){this._objRef&&(this._objRef.object=t)}set domElement(t){this._objRef&&(this._objRef.domElement=t)}set movementSpeed(t){this._objRef&&(this._objRef.movementSpeed=t)}set rollSpeed(t){this._objRef&&(this._objRef.rollSpeed=t)}set dragToLook(t){this._objRef&&(this._objRef.dragToLook=t)}set autoForward(t){this._objRef&&(this._objRef.autoForward=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-flyControls"]],inputs:{object:"object",domElement:"domElement",movementSpeed:"movementSpeed",rollSpeed:"rollSpeed",dragToLook:"dragToLook",autoForward:"autoForward"},features:[Xe([{provide:vr,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();const NU={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t}",fragmentShader:"\n\n\t\tuniform int byp; //should we apply the glitch ?\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tDisp;\n\n\t\tuniform float amount;\n\t\tuniform float angle;\n\t\tuniform float seed;\n\t\tuniform float seed_x;\n\t\tuniform float seed_y;\n\t\tuniform float distortion_x;\n\t\tuniform float distortion_y;\n\t\tuniform float col_s;\n\n\t\tvarying vec2 vUv;\n\n\n\t\tfloat rand(vec2 co){\n\t\t\treturn fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n\t\t}\n\n\t\tvoid main() {\n\t\t\tif(byp<1) {\n\t\t\t\tvec2 p = vUv;\n\t\t\t\tfloat xs = floor(gl_FragCoord.x / 0.5);\n\t\t\t\tfloat ys = floor(gl_FragCoord.y / 0.5);\n\t\t\t\t//based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch\n\t\t\t\tfloat disp = texture2D(tDisp, p*seed*seed).r;\n\t\t\t\tif(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {\n\t\t\t\t\tif(seed_x>0.){\n\t\t\t\t\t\tp.y = 1. - (p.y + distortion_y);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tp.y = distortion_y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {\n\t\t\t\t\tif(seed_y>0.){\n\t\t\t\t\t\tp.x=distortion_x;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tp.x = 1. - (p.x + distortion_x);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tp.x+=disp*seed_x*(seed/5.);\n\t\t\t\tp.y+=disp*seed_y*(seed/5.);\n\t\t\t\t//base from RGB shift shader\n\t\t\t\tvec2 offset = amount * vec2( cos(angle), sin(angle));\n\t\t\t\tvec4 cr = texture2D(tDiffuse, p + offset);\n\t\t\t\tvec4 cga = texture2D(tDiffuse, p);\n\t\t\t\tvec4 cb = texture2D(tDiffuse, p - offset);\n\t\t\t\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);\n\t\t\t\t//add noise\n\t\t\t\tvec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);\n\t\t\t\tgl_FragColor = gl_FragColor+ snow;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tgl_FragColor=texture2D (tDiffuse, vUv);\n\t\t\t}\n\t\t}"};class Lce extends Qo{constructor(e=64){super(),void 0===NU&&console.error("THREE.GlitchPass relies on DigitalGlitch");const t=NU;this.uniforms=Go.clone(t.uniforms),this.uniforms.tDisp.value=this.generateHeightmap(e),this.material=new Zn({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.fsQuad=new md(this.material),this.goWild=!1,this.curF=0,this.generateTrigger()}render(e,t,n){!1===e.capabilities.isWebGL2&&(this.uniforms.tDisp.value.format=wM),this.uniforms.tDiffuse.value=n.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||1==this.goWild?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=kt.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=kt.randFloat(-1,1),this.uniforms.seed_y.value=kt.randFloat(-1,1),this.uniforms.distortion_x.value=kt.randFloat(0,1),this.uniforms.distortion_y.value=kt.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=kt.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=kt.randFloat(0,1),this.uniforms.distortion_y.value=kt.randFloat(0,1),this.uniforms.seed_x.value=kt.randFloat(-.3,.3),this.uniforms.seed_y.value=kt.randFloat(-.3,.3)):0==this.goWild&&(this.uniforms.byp.value=1),this.curF++,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}generateTrigger(){this.randX=kt.randInt(120,240)}generateHeightmap(e){const t=new Float32Array(e*e),n=e*e;for(let s=0;s<n;s++){const o=kt.randFloat(0,1);t[s]=o}const r=new Dc(t,e,e,_c,Wr);return r.needsUpdate=!0,r}}let Oce=(()=>{class i extends Qp{getType(){return Lce}set uniforms(t){this._objRef&&Object.assign(this._objRef.uniforms,t)}set material(t){this._objRef&&(this._objRef.material=t)}set fsQuad(t){this._objRef&&(this._objRef.fsQuad=t)}set goWild(t){this._objRef&&(this._objRef.goWild=t)}set curF(t){this._objRef&&(this._objRef.curF=t)}set randX(t){this._objRef&&(this._objRef.randX=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-glitchPass"]],inputs:{uniforms:"uniforms",material:"material",fsQuad:"fsQuad",goWild:"goWild",curF:"curF",randX:"randX"},features:[Xe([{provide:Dl,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();Math,Math,Math;class PC{constructor(e=Math){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(let t=0;t<256;t++)this.p[t]=Math.floor(256*e.random());this.perm=[];for(let t=0;t<512;t++)this.perm[t]=this.p[255&t];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}dot(e,t,n){return e[0]*t+e[1]*n}dot3(e,t,n,r){return e[0]*t+e[1]*n+e[2]*r}dot4(e,t,n,r,s){return e[0]*t+e[1]*n+e[2]*r+e[3]*s}noise(e,t){let n,r,s;const a=(e+t)*(.5*(Math.sqrt(3)-1)),l=Math.floor(e+a),c=Math.floor(t+a),u=(3-Math.sqrt(3))/6,h=(l+c)*u,p=e-(l-h),m=t-(c-h);let g,_;p>m?(g=1,_=0):(g=0,_=1);const v=p-g+u,y=m-_+u,b=p-1+2*u,w=m-1+2*u,M=255&l,T=255&c,E=this.perm[M+g+this.perm[T+_]]%12,D=this.perm[M+1+this.perm[T+1]]%12;let L=.5-p*p-m*m;L<0?n=0:(L*=L,n=L*L*this.dot(this.grad3[this.perm[M+this.perm[T]]%12],p,m));let z=.5-v*v-y*y;z<0?r=0:(z*=z,r=z*z*this.dot(this.grad3[E],v,y));let H=.5-b*b-w*w;return H<0?s=0:(H*=H,s=H*H*this.dot(this.grad3[D],b,w)),70*(n+r+s)}noise3d(e,t,n){let r,s,o,a;const c=.3333333333333333*(e+t+n),u=Math.floor(e+c),h=Math.floor(t+c),d=Math.floor(n+c),f=1/6,p=(u+h+d)*f,v=e-(u-p),y=t-(h-p),b=n-(d-p);let w,M,T,x,E,D;v>=y?y>=b?(w=1,M=0,T=0,x=1,E=1,D=0):v>=b?(w=1,M=0,T=0,x=1,E=0,D=1):(w=0,M=0,T=1,x=1,E=0,D=1):y<b?(w=0,M=0,T=1,x=0,E=1,D=1):v<b?(w=0,M=1,T=0,x=0,E=1,D=1):(w=0,M=1,T=0,x=1,E=1,D=0);const L=v-w+f,z=y-M+f,H=b-T+f,U=v-x+2*f,X=y-E+2*f,I=b-D+2*f,V=v-1+.5,W=y-1+.5,j=b-1+.5,q=255&u,oe=255&h,J=255&d,he=this.perm[q+w+this.perm[oe+M+this.perm[J+T]]]%12,Re=this.perm[q+x+this.perm[oe+E+this.perm[J+D]]]%12,$=this.perm[q+1+this.perm[oe+1+this.perm[J+1]]]%12;let K=.6-v*v-y*y-b*b;K<0?r=0:(K*=K,r=K*K*this.dot3(this.grad3[this.perm[q+this.perm[oe+this.perm[J]]]%12],v,y,b));let pe=.6-L*L-z*z-H*H;pe<0?s=0:(pe*=pe,s=pe*pe*this.dot3(this.grad3[he],L,z,H));let Fe=.6-U*U-X*X-I*I;Fe<0?o=0:(Fe*=Fe,o=Fe*Fe*this.dot3(this.grad3[Re],U,X,I));let _e=.6-V*V-W*W-j*j;return _e<0?a=0:(_e*=_e,a=_e*_e*this.dot3(this.grad3[$],V,W,j)),32*(r+s+o+a)}noise4d(e,t,n,r){const s=this.grad4,o=this.simplex,a=this.perm,l=(Math.sqrt(5)-1)/4,c=(5-Math.sqrt(5))/20;let u,h,d,f,p;const m=(e+t+n+r)*l,g=Math.floor(e+m),_=Math.floor(t+m),v=Math.floor(n+m),y=Math.floor(r+m),b=(g+_+v+y)*c,E=e-(g-b),D=t-(_-b),L=n-(v-b),z=r-(y-b),j=(E>D?32:0)+(E>L?16:0)+(D>L?8:0)+(E>z?4:0)+(D>z?2:0)+(L>z?1:0),q=o[j][0]>=3?1:0,oe=o[j][1]>=3?1:0,J=o[j][2]>=3?1:0,fe=o[j][3]>=3?1:0,he=o[j][0]>=2?1:0,Re=o[j][1]>=2?1:0,$=o[j][2]>=2?1:0,K=o[j][3]>=2?1:0,pe=o[j][0]>=1?1:0,Fe=o[j][1]>=1?1:0,_e=o[j][2]>=1?1:0,ot=o[j][3]>=1?1:0,ue=E-q+c,de=D-oe+c,Me=L-J+c,Je=z-fe+c,Ge=E-he+2*c,bt=D-Re+2*c,mt=L-$+2*c,dt=z-K+2*c,Jt=E-pe+3*c,Wt=D-Fe+3*c,B=L-_e+3*c,P=z-ot+3*c,ae=E-1+4*c,xe=D-1+4*c,Pe=L-1+4*c,Ve=z-1+4*c,ht=255&g,F=255&_,le=255&v,Ne=255&y,G=a[ht+q+a[F+oe+a[le+J+a[Ne+fe]]]]%32,Ae=a[ht+he+a[F+Re+a[le+$+a[Ne+K]]]]%32,Ue=a[ht+pe+a[F+Fe+a[le+_e+a[Ne+ot]]]]%32,_t=a[ht+1+a[F+1+a[le+1+a[Ne+1]]]]%32;let Le=.6-E*E-D*D-L*L-z*z;Le<0?u=0:(Le*=Le,u=Le*Le*this.dot4(s[a[ht+a[F+a[le+a[Ne]]]]%32],E,D,L,z));let Ye=.6-ue*ue-de*de-Me*Me-Je*Je;Ye<0?h=0:(Ye*=Ye,h=Ye*Ye*this.dot4(s[G],ue,de,Me,Je));let Be=.6-Ge*Ge-bt*bt-mt*mt-dt*dt;Be<0?d=0:(Be*=Be,d=Be*Be*this.dot4(s[Ae],Ge,bt,mt,dt));let ge=.6-Jt*Jt-Wt*Wt-B*B-P*P;ge<0?f=0:(ge*=ge,f=ge*ge*this.dot4(s[Ue],Jt,Wt,B,P));let Zt=.6-ae*ae-xe*xe-Pe*Pe-Ve*Ve;return Zt<0?p=0:(Zt*=Zt,p=Zt*Zt*this.dot4(s[_t],ae,xe,Pe,Ve)),27*(u+h+d+f+p)}}class ci extends wt{constructor(e={}){super(),this.isLightningStrike=!0,this.type="LightningStrike",this.init(ci.copyParameters(e,e)),this.createMesh()}static createRandomGenerator(){const t=[];for(let r=0;r<2053;r++)t.push(Math.random());const n={currentSeed:0,random:function(){const r=t[n.currentSeed];return n.currentSeed=(n.currentSeed+1)%2053,r},getSeed:function(){return n.currentSeed/2053},setSeed:function(r){n.currentSeed=Math.floor(2053*r)%2053}};return n}static copyParameters(e={},t={}){const n=function(r){return t===e?r:r.clone()};return e.sourceOffset=void 0!==t.sourceOffset?n(t.sourceOffset):new C(0,100,0),e.destOffset=void 0!==t.destOffset?n(t.destOffset):new C(0,0,0),e.timeScale=void 0!==t.timeScale?t.timeScale:1,e.roughness=void 0!==t.roughness?t.roughness:.9,e.straightness=void 0!==t.straightness?t.straightness:.7,e.up0=void 0!==t.up0?n(t.up0):new C(0,0,1),e.up1=void 0!==t.up1?n(t.up1):new C(0,0,1),e.radius0=void 0!==t.radius0?t.radius0:1,e.radius1=void 0!==t.radius1?t.radius1:1,e.radius0Factor=void 0!==t.radius0Factor?t.radius0Factor:.5,e.radius1Factor=void 0!==t.radius1Factor?t.radius1Factor:.2,e.minRadius=void 0!==t.minRadius?t.minRadius:.2,e.isEternal=void 0!==t.isEternal?t.isEternal:void 0===t.birthTime||void 0===t.deathTime,e.birthTime=t.birthTime,e.deathTime=t.deathTime,e.propagationTimeFactor=void 0!==t.propagationTimeFactor?t.propagationTimeFactor:.1,e.vanishingTimeFactor=void 0!==t.vanishingTimeFactor?t.vanishingTimeFactor:.9,e.subrayPeriod=void 0!==t.subrayPeriod?t.subrayPeriod:4,e.subrayDutyCycle=void 0!==t.subrayDutyCycle?t.subrayDutyCycle:.6,e.maxIterations=void 0!==t.maxIterations?t.maxIterations:9,e.isStatic=void 0!==t.isStatic&&t.isStatic,e.ramification=void 0!==t.ramification?t.ramification:5,e.maxSubrayRecursion=void 0!==t.maxSubrayRecursion?t.maxSubrayRecursion:3,e.recursionProbability=void 0!==t.recursionProbability?t.recursionProbability:.6,e.generateUVs=void 0!==t.generateUVs&&t.generateUVs,e.randomGenerator=t.randomGenerator,e.noiseSeed=t.noiseSeed,e.onDecideSubrayCreation=t.onDecideSubrayCreation,e.onSubrayCreation=t.onSubrayCreation,e}update(e){this.isStatic||(this.rayParameters.isEternal||this.rayParameters.birthTime<=e&&e<=this.rayParameters.deathTime?(this.updateMesh(e),this.state=e<this.subrays[0].endPropagationTime?ci.RAY_PROPAGATING:e>this.subrays[0].beginVanishingTime?ci.RAY_VANISHING:ci.RAY_STEADY,this.visible=!0):(this.visible=!1,this.state=e<this.rayParameters.birthTime?ci.RAY_UNBORN:ci.RAY_EXTINGUISHED))}init(e){this.rayParameters=e,this.maxIterations=void 0!==e.maxIterations?Math.floor(e.maxIterations):9,e.maxIterations=this.maxIterations,this.isStatic=void 0!==e.isStatic&&e.isStatic,e.isStatic=this.isStatic,this.ramification=void 0!==e.ramification?Math.floor(e.ramification):5,e.ramification=this.ramification,this.maxSubrayRecursion=void 0!==e.maxSubrayRecursion?Math.floor(e.maxSubrayRecursion):3,e.maxSubrayRecursion=this.maxSubrayRecursion,this.recursionProbability=void 0!==e.recursionProbability?e.recursionProbability:.6,e.recursionProbability=this.recursionProbability,this.generateUVs=void 0!==e.generateUVs&&e.generateUVs,e.generateUVs=this.generateUVs,void 0!==e.randomGenerator?(this.randomGenerator=e.randomGenerator,this.seedGenerator=e.randomGenerator,void 0!==e.noiseSeed&&this.seedGenerator.setSeed(e.noiseSeed)):(this.randomGenerator=ci.createRandomGenerator(),this.seedGenerator=Math),void 0!==e.onDecideSubrayCreation?this.onDecideSubrayCreation=e.onDecideSubrayCreation:(this.createDefaultSubrayCreationCallbacks(),void 0!==e.onSubrayCreation&&(this.onSubrayCreation=e.onSubrayCreation)),this.state=ci.RAY_INITIALIZED,this.maxSubrays=Math.ceil(1+Math.pow(this.ramification,Math.max(0,this.maxSubrayRecursion-1))),e.maxSubrays=this.maxSubrays,this.maxRaySegments=2*(1<<this.maxIterations),this.subrays=[];for(let t=0;t<this.maxSubrays;t++)this.subrays.push(this.createSubray());this.raySegments=[];for(let t=0;t<this.maxRaySegments;t++)this.raySegments.push(this.createSegment());this.time=0,this.timeFraction=0,this.currentSegmentCallback=null,this.currentCreateTriangleVertices=this.generateUVs?this.createTriangleVerticesWithUVs:this.createTriangleVerticesWithoutUVs,this.numSubrays=0,this.currentSubray=null,this.currentSegmentIndex=0,this.isInitialSegment=!1,this.subrayProbability=0,this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.vertices=null,this.uvs=null,this.indices=null,this.positionAttribute=null,this.uvsAttribute=null,this.simplexX=new PC(this.seedGenerator),this.simplexY=new PC(this.seedGenerator),this.simplexZ=new PC(this.seedGenerator),this.forwards=new C,this.forwardsFill=new C,this.side=new C,this.down=new C,this.middlePos=new C,this.middleLinPos=new C,this.newPos=new C,this.vPos=new C,this.cross1=new C}createMesh(){const e=1<<this.maxIterations,t=3*(e+1)*this.maxSubrays,n=18*e*this.maxSubrays;this.vertices=new Float32Array(3*t),this.indices=new Uint32Array(n),this.generateUVs&&(this.uvs=new Float32Array(2*t)),this.fillMesh(0),this.setIndex(new j_(this.indices,1)),this.positionAttribute=new $e(this.vertices,3),this.setAttribute("position",this.positionAttribute),this.generateUVs&&(this.uvsAttribute=new $e(new Float32Array(this.uvs),2),this.setAttribute("uv",this.uvsAttribute)),this.isStatic||(this.index.usage=T_,this.positionAttribute.usage=T_,this.generateUVs&&(this.uvsAttribute.usage=T_)),this.vertices=this.positionAttribute.array,this.indices=this.index.array,this.generateUVs&&(this.uvs=this.uvsAttribute.array)}updateMesh(e){this.fillMesh(e),this.drawRange.count=this.currentIndex,this.index.needsUpdate=!0,this.positionAttribute.needsUpdate=!0,this.generateUVs&&(this.uvsAttribute.needsUpdate=!0)}fillMesh(e){const t=this;this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.fractalRay(e,function(r){const s=t.currentSubray;e<s.birthTime||(this.rayParameters.isEternal&&0==t.currentSubray.recursion?(t.createPrism(r),t.onDecideSubrayCreation(r,t)):e<s.endPropagationTime?t.timeFraction>=r.fraction0*s.propagationTimeFactor&&(t.createPrism(r),t.onDecideSubrayCreation(r,t)):e<s.beginVanishingTime?(t.createPrism(r),t.onDecideSubrayCreation(r,t)):(t.timeFraction<=s.vanishingTimeFactor+r.fraction1*(1-s.vanishingTimeFactor)&&t.createPrism(r),t.onDecideSubrayCreation(r,t)))})}addNewSubray(){return this.subrays[this.numSubrays++]}initSubray(e,t){e.pos0.copy(t.sourceOffset),e.pos1.copy(t.destOffset),e.up0.copy(t.up0),e.up1.copy(t.up1),e.radius0=t.radius0,e.radius1=t.radius1,e.birthTime=t.birthTime,e.deathTime=t.deathTime,e.timeScale=t.timeScale,e.roughness=t.roughness,e.straightness=t.straightness,e.propagationTimeFactor=t.propagationTimeFactor,e.vanishingTimeFactor=t.vanishingTimeFactor,e.maxIterations=this.maxIterations,e.seed=void 0!==t.noiseSeed?t.noiseSeed:0,e.recursion=0}fractalRay(e,t){this.time=e,this.currentSegmentCallback=t,this.numSubrays=0,this.initSubray(this.addNewSubray(),this.rayParameters);for(let n=0;n<this.numSubrays;n++){const r=this.subrays[n];this.currentSubray=r,this.randomGenerator.setSeed(r.seed),r.endPropagationTime=kt.lerp(r.birthTime,r.deathTime,r.propagationTimeFactor),r.beginVanishingTime=kt.lerp(r.deathTime,r.birthTime,1-r.vanishingTimeFactor);const s=this.randomGenerator.random;r.linPos0.set(s(),s(),s()).multiplyScalar(1e3),r.linPos1.set(s(),s(),s()).multiplyScalar(1e3),this.timeFraction=(e-r.birthTime)/(r.deathTime-r.birthTime),this.currentSegmentIndex=0,this.isInitialSegment=!0;const o=this.getNewSegment();o.iteration=0,o.pos0.copy(r.pos0),o.pos1.copy(r.pos1),o.linPos0.copy(r.linPos0),o.linPos1.copy(r.linPos1),o.up0.copy(r.up0),o.up1.copy(r.up1),o.radius0=r.radius0,o.radius1=r.radius1,o.fraction0=0,o.fraction1=1,o.positionVariationFactor=1-r.straightness,this.subrayProbability=this.ramification*Math.pow(this.recursionProbability,r.recursion)/(1<<r.maxIterations),this.fractalRayRecursive(o)}this.currentSegmentCallback=null,this.currentSubray=null}fractalRayRecursive(e){if(e.iteration>=this.currentSubray.maxIterations)return void this.currentSegmentCallback(e);this.forwards.subVectors(e.pos1,e.pos0);let t=this.forwards.length();t<1e-6&&(this.forwards.set(0,0,.01),t=this.forwards.length());const n=.5*(e.radius0+e.radius1),r=.5*(e.fraction0+e.fraction1),s=this.time*this.currentSubray.timeScale*Math.pow(2,e.iteration);this.middlePos.lerpVectors(e.pos0,e.pos1,.5),this.middleLinPos.lerpVectors(e.linPos0,e.linPos1,.5);const o=this.middleLinPos;this.newPos.set(this.simplexX.noise4d(o.x,o.y,o.z,s),this.simplexY.noise4d(o.x,o.y,o.z,s),this.simplexZ.noise4d(o.x,o.y,o.z,s)),this.newPos.multiplyScalar(e.positionVariationFactor*t),this.newPos.add(this.middlePos);const a=this.getNewSegment();a.pos0.copy(e.pos0),a.pos1.copy(this.newPos),a.linPos0.copy(e.linPos0),a.linPos1.copy(this.middleLinPos),a.up0.copy(e.up0),a.up1.copy(e.up1),a.radius0=e.radius0,a.radius1=n,a.fraction0=e.fraction0,a.fraction1=r,a.positionVariationFactor=e.positionVariationFactor*this.currentSubray.roughness,a.iteration=e.iteration+1;const l=this.getNewSegment();l.pos0.copy(this.newPos),l.pos1.copy(e.pos1),l.linPos0.copy(this.middleLinPos),l.linPos1.copy(e.linPos1),this.cross1.crossVectors(e.up0,this.forwards.normalize()),l.up0.crossVectors(this.forwards,this.cross1).normalize(),l.up1.copy(e.up1),l.radius0=n,l.radius1=e.radius1,l.fraction0=r,l.fraction1=e.fraction1,l.positionVariationFactor=e.positionVariationFactor*this.currentSubray.roughness,l.iteration=e.iteration+1,this.fractalRayRecursive(a),this.fractalRayRecursive(l)}createPrism(e){this.forwardsFill.subVectors(e.pos1,e.pos0).normalize(),this.isInitialSegment&&(this.currentCreateTriangleVertices(e.pos0,e.up0,this.forwardsFill,e.radius0,0),this.isInitialSegment=!1),this.currentCreateTriangleVertices(e.pos1,e.up0,this.forwardsFill,e.radius1,e.fraction1),this.createPrismFaces()}createTriangleVerticesWithoutUVs(e,t,n,r){this.side.crossVectors(t,n).multiplyScalar(r*ci.COS30DEG),this.down.copy(t).multiplyScalar(-r*ci.SIN30DEG);const s=this.vPos,o=this.vertices;s.copy(e).sub(this.side).add(this.down),o[this.currentCoordinate++]=s.x,o[this.currentCoordinate++]=s.y,o[this.currentCoordinate++]=s.z,s.copy(e).add(this.side).add(this.down),o[this.currentCoordinate++]=s.x,o[this.currentCoordinate++]=s.y,o[this.currentCoordinate++]=s.z,s.copy(t).multiplyScalar(r).add(e),o[this.currentCoordinate++]=s.x,o[this.currentCoordinate++]=s.y,o[this.currentCoordinate++]=s.z,this.currentVertex+=3}createTriangleVerticesWithUVs(e,t,n,r,s){this.side.crossVectors(t,n).multiplyScalar(r*ci.COS30DEG),this.down.copy(t).multiplyScalar(-r*ci.SIN30DEG);const o=this.vPos,a=this.vertices,l=this.uvs;o.copy(e).sub(this.side).add(this.down),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=s,l[this.currentUVCoordinate++]=0,o.copy(e).add(this.side).add(this.down),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=s,l[this.currentUVCoordinate++]=.5,o.copy(t).multiplyScalar(r).add(e),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=s,l[this.currentUVCoordinate++]=1,this.currentVertex+=3}createPrismFaces(e){const t=this.indices;e=this.currentVertex-6,t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+5,t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+5,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+5}createDefaultSubrayCreationCallbacks(){const e=this.randomGenerator.random;this.onDecideSubrayCreation=function(o,a){const l=a.currentSubray,c=a.rayParameters.subrayPeriod,u=a.rayParameters.subrayDutyCycle,h=a.rayParameters.isEternal&&0==l.recursion?-e()*c:kt.lerp(l.birthTime,l.endPropagationTime,o.fraction0)-e()*c,d=a.time-h,f=Math.floor(d/c),p=e()*(f+1);let g=0;if(d%c<=u*c&&(g=a.subrayProbability),l.recursion<a.maxSubrayRecursion&&a.numSubrays<a.maxSubrays&&e()<g){const _=a.addNewSubray(),v=a.randomGenerator.getSeed();_.seed=p,a.randomGenerator.setSeed(p),_.recursion=l.recursion+1,_.maxIterations=Math.max(1,l.maxIterations-1),_.linPos0.set(e(),e(),e()).multiplyScalar(1e3),_.linPos1.set(e(),e(),e()).multiplyScalar(1e3),_.up0.copy(l.up0),_.up1.copy(l.up1),_.radius0=o.radius0*a.rayParameters.radius0Factor,_.radius1=Math.min(a.rayParameters.minRadius,o.radius1*a.rayParameters.radius1Factor),_.birthTime=h+f*c,_.deathTime=_.birthTime+c*u,!a.rayParameters.isEternal&&0==l.recursion&&(_.birthTime=Math.max(_.birthTime,l.birthTime),_.deathTime=Math.min(_.deathTime,l.deathTime)),_.timeScale=2*l.timeScale,_.roughness=l.roughness,_.straightness=l.straightness,_.propagationTimeFactor=l.propagationTimeFactor,_.vanishingTimeFactor=l.vanishingTimeFactor,a.onSubrayCreation(o,l,_,a),a.randomGenerator.setSeed(v)}};const t=new C,n=new C,r=new C,s=new C;this.onSubrayCreation=function(o,a,l,c){c.subrayCylinderPosition(o,a,l,.5,.6,.2)},this.subrayConePosition=function(o,a,l,c,u,h){l.pos0.copy(o.pos0),t.subVectors(a.pos1,a.pos0),n.copy(t).normalize(),t.multiplyScalar(o.fraction0+(1-o.fraction0)*(e()*c));const d=t.length();r.crossVectors(a.up0,n);const f=2*Math.PI*e();r.multiplyScalar(Math.cos(f)),s.copy(a.up0).multiplyScalar(Math.sin(f)),l.pos1.copy(r).add(s).multiplyScalar(d*u*(h+e()*(1-h))).add(t).add(a.pos0)},this.subrayCylinderPosition=function(o,a,l,c,u,h){l.pos0.copy(o.pos0),t.subVectors(a.pos1,a.pos0),n.copy(t).normalize(),t.multiplyScalar(o.fraction0+(1-o.fraction0)*((2*e()-1)*c));const d=t.length();r.crossVectors(a.up0,n);const f=2*Math.PI*e();r.multiplyScalar(Math.cos(f)),s.copy(a.up0).multiplyScalar(Math.sin(f)),l.pos1.copy(r).add(s).multiplyScalar(d*u*(h+e()*(1-h))).add(t).add(a.pos0)}}createSubray(){return{seed:0,maxIterations:0,recursion:0,pos0:new C,pos1:new C,linPos0:new C,linPos1:new C,up0:new C,up1:new C,radius0:0,radius1:0,birthTime:0,deathTime:0,timeScale:0,roughness:0,straightness:0,propagationTimeFactor:0,vanishingTimeFactor:0,endPropagationTime:0,beginVanishingTime:0}}createSegment(){return{iteration:0,pos0:new C,pos1:new C,linPos0:new C,linPos1:new C,up0:new C,up1:new C,radius0:0,radius1:0,fraction0:0,fraction1:0,positionVariationFactor:0}}getNewSegment(){return this.raySegments[this.currentSegmentIndex++]}copy(e){return super.copy(e),this.init(ci.copyParameters({},e.rayParameters)),this}clone(){return new this.constructor(ci.copyParameters({},this.rayParameters))}}ci.RAY_INITIALIZED=0,ci.RAY_UNBORN=1,ci.RAY_PROPAGATING=2,ci.RAY_STEADY=3,ci.RAY_VANISHING=4,ci.RAY_EXTINGUISHED=5,ci.COS30DEG=Math.cos(30*Math.PI/180),ci.SIN30DEG=Math.sin(30*Math.PI/180);let BU=(()=>{class i extends Qp{getType(){return bC}set textureID(t){this._objRef&&(this._objRef.textureID=t)}set uniforms(t){this._objRef&&Object.assign(this._objRef.uniforms,t)}set material(t){this._objRef&&(this._objRef.material=t)}set fsQuad(t){this._objRef&&(this._objRef.fsQuad=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-shaderPass"]],inputs:{textureID:"textureID",uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[Xe([{provide:Dl,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),Nce=(()=>{class i extends Cp{getType(){return ere}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-mapControls"]],features:[Xe([{provide:vr,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();class eu extends Qo{constructor(e,t,n,r){super(),this.renderScene=t,this.renderCamera=n,this.selectedObjects=void 0!==r?r:[],this.visibleEdgeColor=new Ce(1,1,1),this.hiddenEdgeColor=new Ce(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this.resolution=void 0!==e?new te(e.x,e.y):new te(256,256);const s=Math.round(this.resolution.x/this.downSampleRatio),o=Math.round(this.resolution.y/this.downSampleRatio);this.renderTargetMaskBuffer=new Wn(this.resolution.x,this.resolution.y),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new tv,this.depthMaterial.side=oo,this.depthMaterial.depthPacking=KM,this.depthMaterial.blending=ao,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=oo,this.prepareMaskMaterial.fragmentShader=function u(h,d){return h.replace(/DEPTH_TO_VIEW_Z/g,(d.isPerspectiveCamera?"perspective":"orthographic")+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new Wn(this.resolution.x,this.resolution.y),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new Wn(s,o),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new Wn(s,o),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new Wn(Math.round(s/2),Math.round(o/2)),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new Wn(s,o),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new Wn(Math.round(s/2),Math.round(o/2)),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1,this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value.set(s,o),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(s/2),Math.round(o/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial(),void 0===pd&&console.error("THREE.OutlinePass relies on CopyShader");const c=pd;this.copyUniforms=Go.clone(c.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new Zn({uniforms:this.copyUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,blending:ao,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Ce,this.oldClearAlpha=1,this.fsQuad=new md(null),this.tempPulseColor1=new Ce,this.tempPulseColor2=new Ce,this.textureMatrix=new st}dispose(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()}setSize(e,t){this.renderTargetMaskBuffer.setSize(e,t),this.renderTargetDepthBuffer.setSize(e,t);let n=Math.round(e/this.downSampleRatio),r=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(n,r),this.renderTargetBlurBuffer1.setSize(n,r),this.renderTargetEdgeBuffer1.setSize(n,r),this.separableBlurMaterial1.uniforms.texSize.value.set(n,r),n=Math.round(n/2),r=Math.round(r/2),this.renderTargetBlurBuffer2.setSize(n,r),this.renderTargetEdgeBuffer2.setSize(n,r),this.separableBlurMaterial2.uniforms.texSize.value.set(n,r)}changeVisibilityOfSelectedObjects(e){const t=this._visibilityCache;function n(r){r.isMesh&&(!0===e?r.visible=t.get(r):(t.set(r,r.visible),r.visible=e))}for(let r=0;r<this.selectedObjects.length;r++)this.selectedObjects[r].traverse(n)}changeVisibilityOfNonSelectedObjects(e){const t=this._visibilityCache,n=[];function r(o){o.isMesh&&n.push(o)}for(let o=0;o<this.selectedObjects.length;o++)this.selectedObjects[o].traverse(r);this.renderScene.traverse(function s(o){if(o.isMesh||o.isSprite){let a=!1;for(let l=0;l<n.length;l++)if(n[l].id===o.id){a=!0;break}if(!1===a){const l=o.visible;(!1===e||!0===t.get(o))&&(o.visible=e),t.set(o,l)}}else(o.isPoints||o.isLine)&&(!0===e?o.visible=t.get(o):(t.set(o,o.visible),o.visible=e))})}updateTextureMatrix(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)}render(e,t,n,r,s){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,s&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);const a=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this.renderScene.background=a,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){const l=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(l),this.tempPulseColor2.multiplyScalar(l)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=eu.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=eu.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=eu.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=eu.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(n),this.fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=n.texture,e.setRenderTarget(null),this.fsQuad.render(e))}getPrepareMaskMaterial(){return new Zn({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new te(.5,.5)},textureMatrix:{value:null}},vertexShader:"#include <morphtarget_pars_vertex>\n\t\t\t\t#include <skinning_pars_vertex>\n\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tuniform mat4 textureMatrix;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <morphtarget_vertex>\n\t\t\t\t\t#include <skinning_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t\tvPosition = mvPosition;\n\t\t\t\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t\t\t\t\tprojTexCoord = textureMatrix * worldPosition;\n\n\t\t\t\t}",fragmentShader:"#include <packing>\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tuniform sampler2D depthTexture;\n\t\t\t\tuniform vec2 cameraNearFar;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));\n\t\t\t\t\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );\n\t\t\t\t\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;\n\t\t\t\t\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);\n\n\t\t\t\t}"})}getEdgeDetectionMaterial(){return new Zn({uniforms:{maskTexture:{value:null},texSize:{value:new te(.5,.5)},visibleEdgeColor:{value:new C(1,1,1)},hiddenEdgeColor:{value:new C(1,1,1)}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec3 visibleEdgeColor;\n\t\t\t\tuniform vec3 hiddenEdgeColor;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\n\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\n\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\n\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\n\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\n\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\n\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\n\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\n\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\n\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\n\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\n\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\n\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\n\t\t\t\t}"})}getSeperableBlurMaterial(e){return new Zn({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new te(.5,.5)},direction:{value:new te(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\t\t\t\tuniform float kernelRadius;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat sigma = kernelRadius/2.0;\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, sigma);\n\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\n\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\n\t\t\t\t\tvec2 uvOffset = delta;\n\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = kernelRadius * float(i) / float(MAX_RADIUS);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, sigma);\n\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\n\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\n\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\n\t\t\t\t\t\tweightSum += (2.0 * w);\n\t\t\t\t\t\tuvOffset += delta;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\n\t\t\t\t}"})}getOverlayMaterial(){return new Zn({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform sampler2D edgeTexture1;\n\t\t\t\tuniform sampler2D edgeTexture2;\n\t\t\t\tuniform sampler2D patternTexture;\n\t\t\t\tuniform float edgeStrength;\n\t\t\t\tuniform float edgeGlow;\n\t\t\t\tuniform bool usePatternTexture;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\n\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\n\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\n\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\n\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\n\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\n\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\n\t\t\t\t\tif(usePatternTexture)\n\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\n\t\t\t\t\tgl_FragColor = finalColor;\n\t\t\t\t}",blending:ih,depthTest:!1,depthWrite:!1,transparent:!0})}}eu.BlurDirectionX=new te(1,0),eu.BlurDirectionY=new te(0,1),new ph(0,0,0,"YXZ"),new C,Math,new C,new te(512,512),new st,new st,new te(512,512),new te(0,0),new te(1/1024,1/512),new te(1/1024,1/512),new te(1/1024,1/512),new te,new st,new st,new te,new te,new st,new st,new te;const IC={type:"change"},FC={type:"start"},LC={type:"end"};class Gce extends ls{constructor(e,t){super(),void 0===t&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');const n=this;this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:Cs.ROTATE,MIDDLE:Cs.DOLLY,RIGHT:Cs.PAN},this.target=new C;const s=1e-6,o=new C;let a=1,l=-1,c=-1,u=0,h=0,d=0;const f=new C,p=new te,m=new te,g=new C,_=new te,v=new te,y=new te,b=new te,w=[],M={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const K=n.domElement.getBoundingClientRect(),pe=n.domElement.ownerDocument.documentElement;n.screen.left=K.left+window.pageXOffset-pe.clientLeft,n.screen.top=K.top+window.pageYOffset-pe.clientTop,n.screen.width=K.width,n.screen.height=K.height};const T=function(){const K=new te;return function(Fe,_e){return K.set((Fe-n.screen.left)/n.screen.width,(_e-n.screen.top)/n.screen.height),K}}(),x=function(){const K=new te;return function(Fe,_e){return K.set((Fe-.5*n.screen.width-n.screen.left)/(.5*n.screen.width),(n.screen.height+2*(n.screen.top-_e))/n.screen.width),K}}();function E(K){!1!==n.enabled&&(0===w.length&&(n.domElement.setPointerCapture(K.pointerId),n.domElement.addEventListener("pointermove",D),n.domElement.addEventListener("pointerup",L)),function fe(K){w.push(K)}(K),"touch"===K.pointerType?function j(K){if(1===(Re(K),w.length))l=3,m.copy(x(w[0].pageX,w[0].pageY)),p.copy(m);else{l=4;const pe=w[0].pageX-w[1].pageX,Fe=w[0].pageY-w[1].pageY;h=u=Math.sqrt(pe*pe+Fe*Fe),y.copy(T((w[0].pageX+w[1].pageX)/2,(w[0].pageY+w[1].pageY)/2)),b.copy(y)}n.dispatchEvent(FC)}(K):function X(K){if(-1===l)switch(K.button){case n.mouseButtons.LEFT:l=0;break;case n.mouseButtons.MIDDLE:l=1;break;case n.mouseButtons.RIGHT:l=2}const pe=-1!==c?c:l;0!==pe||n.noRotate?1!==pe||n.noZoom?2===pe&&!n.noPan&&(y.copy(T(K.pageX,K.pageY)),b.copy(y)):(_.copy(T(K.pageX,K.pageY)),v.copy(_)):(m.copy(x(K.pageX,K.pageY)),p.copy(m)),n.dispatchEvent(FC)}(K))}function D(K){!1!==n.enabled&&("touch"===K.pointerType?function q(K){if(1===(Re(K),w.length))p.copy(m),m.copy(x(K.pageX,K.pageY));else{const pe=function $(K){return M[(K.pointerId===w[0].pointerId?w[1]:w[0]).pointerId]}(K),Fe=K.pageX-pe.x,_e=K.pageY-pe.y;h=Math.sqrt(Fe*Fe+_e*_e),b.copy(T((K.pageX+pe.x)/2,(K.pageY+pe.y)/2))}}(K):function I(K){const pe=-1!==c?c:l;0!==pe||n.noRotate?1!==pe||n.noZoom?2===pe&&!n.noPan&&b.copy(T(K.pageX,K.pageY)):v.copy(T(K.pageX,K.pageY)):(p.copy(m),m.copy(x(K.pageX,K.pageY)))}(K))}function L(K){!1!==n.enabled&&("touch"===K.pointerType?function oe(K){switch(w.length){case 0:l=-1;break;case 1:l=3,m.copy(x(K.pageX,K.pageY)),p.copy(m);break;case 2:l=4,m.copy(x(K.pageX-p.x,K.pageY-p.y)),p.copy(m)}n.dispatchEvent(LC)}(K):function V(){l=-1,n.dispatchEvent(LC)}(),he(K),0===w.length&&(n.domElement.releasePointerCapture(K.pointerId),n.domElement.removeEventListener("pointermove",D),n.domElement.removeEventListener("pointerup",L)))}function z(K){he(K)}function H(K){!1!==n.enabled&&(window.removeEventListener("keydown",H),-1===c&&(K.code!==n.keys[0]||n.noRotate?K.code!==n.keys[1]||n.noZoom?K.code===n.keys[2]&&!n.noPan&&(c=2):c=1:c=0))}function U(){!1!==n.enabled&&(c=-1,window.addEventListener("keydown",H))}function W(K){if(!1!==n.enabled&&!0!==n.noZoom){switch(K.preventDefault(),K.deltaMode){case 2:_.y-=.025*K.deltaY;break;case 1:_.y-=.01*K.deltaY;break;default:_.y-=25e-5*K.deltaY}n.dispatchEvent(FC),n.dispatchEvent(LC)}}function J(K){!1!==n.enabled&&K.preventDefault()}function he(K){delete M[K.pointerId];for(let pe=0;pe<w.length;pe++)if(w[pe].pointerId==K.pointerId)return void w.splice(pe,1)}function Re(K){let pe=M[K.pointerId];void 0===pe&&(pe=new te,M[K.pointerId]=pe),pe.set(K.pageX,K.pageY)}this.rotateCamera=function(){const K=new C,pe=new bn,Fe=new C,_e=new C,ot=new C,ue=new C;return function(){ue.set(m.x-p.x,m.y-p.y,0);let Me=ue.length();Me?(f.copy(n.object.position).sub(n.target),Fe.copy(f).normalize(),_e.copy(n.object.up).normalize(),ot.crossVectors(_e,Fe).normalize(),_e.setLength(m.y-p.y),ot.setLength(m.x-p.x),ue.copy(_e.add(ot)),K.crossVectors(ue,f).normalize(),Me*=n.rotateSpeed,pe.setFromAxisAngle(K,Me),f.applyQuaternion(pe),n.object.up.applyQuaternion(pe),g.copy(K),d=Me):!n.staticMoving&&d&&(d*=Math.sqrt(1-n.dynamicDampingFactor),f.copy(n.object.position).sub(n.target),pe.setFromAxisAngle(g,d),f.applyQuaternion(pe),n.object.up.applyQuaternion(pe)),p.copy(m)}}(),this.zoomCamera=function(){let K;4===l?(K=u/h,u=h,n.object.isPerspectiveCamera?f.multiplyScalar(K):n.object.isOrthographicCamera?(n.object.zoom/=K,n.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(K=1+(v.y-_.y)*n.zoomSpeed,1!==K&&K>0&&(n.object.isPerspectiveCamera?f.multiplyScalar(K):n.object.isOrthographicCamera?(n.object.zoom/=K,n.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),n.staticMoving?_.copy(v):_.y+=(v.y-_.y)*this.dynamicDampingFactor)},this.panCamera=function(){const K=new te,pe=new C,Fe=new C;return function(){if(K.copy(b).sub(y),K.lengthSq()){if(n.object.isOrthographicCamera){const ue=(n.object.top-n.object.bottom)/n.object.zoom/n.domElement.clientWidth;K.x*=(n.object.right-n.object.left)/n.object.zoom/n.domElement.clientWidth,K.y*=ue}K.multiplyScalar(f.length()*n.panSpeed),Fe.copy(f).cross(n.object.up).setLength(K.x),Fe.add(pe.copy(n.object.up).setLength(K.y)),n.object.position.add(Fe),n.target.add(Fe),n.staticMoving?y.copy(b):y.add(K.subVectors(b,y).multiplyScalar(n.dynamicDampingFactor))}}}(),this.checkDistances=function(){(!n.noZoom||!n.noPan)&&(f.lengthSq()>n.maxDistance*n.maxDistance&&(n.object.position.addVectors(n.target,f.setLength(n.maxDistance)),_.copy(v)),f.lengthSq()<n.minDistance*n.minDistance&&(n.object.position.addVectors(n.target,f.setLength(n.minDistance)),_.copy(v)))},this.update=function(){f.subVectors(n.object.position,n.target),n.noRotate||n.rotateCamera(),n.noZoom||n.zoomCamera(),n.noPan||n.panCamera(),n.object.position.addVectors(n.target,f),n.object.isPerspectiveCamera?(n.checkDistances(),n.object.lookAt(n.target),o.distanceToSquared(n.object.position)>s&&(n.dispatchEvent(IC),o.copy(n.object.position))):n.object.isOrthographicCamera?(n.object.lookAt(n.target),(o.distanceToSquared(n.object.position)>s||a!==n.object.zoom)&&(n.dispatchEvent(IC),o.copy(n.object.position),a=n.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){l=-1,c=-1,n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.up.copy(n.up0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),f.subVectors(n.object.position,n.target),n.object.lookAt(n.target),n.dispatchEvent(IC),o.copy(n.object.position),a=n.object.zoom},this.dispose=function(){n.domElement.removeEventListener("contextmenu",J),n.domElement.removeEventListener("pointerdown",E),n.domElement.removeEventListener("pointercancel",z),n.domElement.removeEventListener("wheel",W),n.domElement.removeEventListener("pointermove",D),n.domElement.removeEventListener("pointerup",L),window.removeEventListener("keydown",H),window.removeEventListener("keyup",U)},this.domElement.addEventListener("contextmenu",J),this.domElement.addEventListener("pointerdown",E),this.domElement.addEventListener("pointercancel",z),this.domElement.addEventListener("wheel",W,{passive:!1}),window.addEventListener("keydown",H),window.addEventListener("keyup",U),this.handleResize(),this.update()}}let Wce=(()=>{class i extends vr{getType(){return Gce}set object(t){this._objRef&&(this._objRef.object=t)}set domElement(t){this._objRef&&(this._objRef.domElement=t)}set enabled(t){this._objRef&&(this._objRef.enabled=t)}set screen(t){this._objRef&&(this._objRef.screen=t)}set rotateSpeed(t){this._objRef&&(this._objRef.rotateSpeed=t)}set zoomSpeed(t){this._objRef&&(this._objRef.zoomSpeed=t)}set panSpeed(t){this._objRef&&(this._objRef.panSpeed=t)}set noRotate(t){this._objRef&&(this._objRef.noRotate=t)}set noZoom(t){this._objRef&&(this._objRef.noZoom=t)}set noPan(t){this._objRef&&(this._objRef.noPan=t)}set noRoll(t){this._objRef&&(this._objRef.noRoll=t)}set staticMoving(t){this._objRef&&(this._objRef.staticMoving=t)}set dynamicDampingFactor(t){this._objRef&&(this._objRef.dynamicDampingFactor=t)}set minDistance(t){this._objRef&&(this._objRef.minDistance=t)}set maxDistance(t){this._objRef&&(this._objRef.maxDistance=t)}set keys(t){this._objRef&&(this._objRef.keys=t)}set mouseButtons(t){this._objRef&&(this._objRef.mouseButtons=t)}set target(t){this._objRef&&(this._objRef.target=Ft(this._objRef.target,t))}set position0(t){this._objRef&&(this._objRef.position0=Ft(this._objRef.position0,t))}set target0(t){this._objRef&&(this._objRef.target0=Ft(this._objRef.target0,t))}set up0(t){this._objRef&&(this._objRef.up0=Ft(this._objRef.up0,t))}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-trackballControls"]],inputs:{object:"object",domElement:"domElement",enabled:"enabled",screen:"screen",rotateSpeed:"rotateSpeed",zoomSpeed:"zoomSpeed",panSpeed:"panSpeed",noRotate:"noRotate",noZoom:"noZoom",noPan:"noPan",noRoll:"noRoll",staticMoving:"staticMoving",dynamicDampingFactor:"dynamicDampingFactor",minDistance:"minDistance",maxDistance:"maxDistance",keys:"keys",mouseButtons:"mouseButtons",target:"target",position0:"position0",target0:"target0",up0:"up0"},features:[Xe([{provide:vr,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();const jU={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Ce(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};class bd extends Qo{constructor(e,t,n,r){super(),this.strength=void 0!==t?t:1,this.radius=n,this.threshold=r,this.resolution=void 0!==e?new te(e.x,e.y):new te(256,256),this.clearColor=new Ce(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);this.renderTargetBright=new Wn(s,o),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let h=0;h<this.nMips;h++){const d=new Wn(s,o);d.texture.name="UnrealBloomPass.h"+h,d.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(d);const f=new Wn(s,o);f.texture.name="UnrealBloomPass.v"+h,f.texture.generateMipmaps=!1,this.renderTargetsVertical.push(f),s=Math.round(s/2),o=Math.round(o/2)}void 0===jU&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");const a=jU;this.highPassUniforms=Go.clone(a.uniforms),this.highPassUniforms.luminosityThreshold.value=r,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new Zn({uniforms:this.highPassUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const l=[3,5,7,9,11];s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);for(let h=0;h<this.nMips;h++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(l[h])),this.separableBlurMaterials[h].uniforms.texSize.value=new te(s,o),s=Math.round(s/2),o=Math.round(o/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new C(1,1,1),new C(1,1,1),new C(1,1,1),new C(1,1,1),new C(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===pd&&console.error("THREE.UnrealBloomPass relies on CopyShader");const u=pd;this.copyUniforms=Go.clone(u.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new Zn({uniforms:this.copyUniforms,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,blending:ih,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Ce,this.oldClearAlpha=1,this.basic=new tr,this.fsQuad=new md(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()}setSize(e,t){let n=Math.round(e/2),r=Math.round(t/2);this.renderTargetBright.setSize(n,r);for(let s=0;s<this.nMips;s++)this.renderTargetsHorizontal[s].setSize(n,r),this.renderTargetsVertical[s].setSize(n,r),this.separableBlurMaterials[s].uniforms.texSize.value=new te(n,r),n=Math.round(n/2),r=Math.round(r/2)}render(e,t,n,r,s){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),s&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=n.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=n.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let a=this.renderTargetBright;for(let l=0;l<this.nMips;l++)this.fsQuad.material=this.separableBlurMaterials[l],this.separableBlurMaterials[l].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[l].uniforms.direction.value=bd.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[l]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[l].uniforms.colorTexture.value=this.renderTargetsHorizontal[l].texture,this.separableBlurMaterials[l].uniforms.direction.value=bd.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[l]),e.clear(),this.fsQuad.render(e),a=this.renderTargetsVertical[l];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,s&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(n),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}getSeperableBlurMaterial(e){return new Zn({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new te(.5,.5)},direction:{value:new te(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat fSigma = float(SIGMA);\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}getCompositeMaterial(e){return new Zn({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}}bd.BlurDirectionX=new te(1,0),bd.BlurDirectionY=new te(0,1);let zU=(()=>{class i extends Qp{getType(){return bd}set resolution(t){this._objRef&&(this._objRef.resolution=Ft(this._objRef.resolution,t))}set strength(t){this._objRef&&(this._objRef.strength=t)}set radius(t){this._objRef&&(this._objRef.radius=t)}set threshold(t){this._objRef&&(this._objRef.threshold=t)}set clearColor(t){this._objRef&&(this._objRef.clearColor=Ft(this._objRef.clearColor,t))}set renderTargetsHorizontal(t){this._objRef&&(this._objRef.renderTargetsHorizontal=t)}set renderTargetsVertical(t){this._objRef&&(this._objRef.renderTargetsVertical=t)}set nMips(t){this._objRef&&(this._objRef.nMips=t)}set renderTargetBright(t){this._objRef&&(this._objRef.renderTargetBright=t)}set highPassUniforms(t){this._objRef&&(this._objRef.highPassUniforms=t)}set materialHighPassFilter(t){this._objRef&&(this._objRef.materialHighPassFilter=t)}set separableBlurMaterials(t){this._objRef&&(this._objRef.separableBlurMaterials=t)}set compositeMaterial(t){this._objRef&&(this._objRef.compositeMaterial=t)}set bloomTintColors(t){this._objRef&&(this._objRef.bloomTintColors=t)}set copyUniforms(t){this._objRef&&(this._objRef.copyUniforms=t)}set materialCopy(t){this._objRef&&(this._objRef.materialCopy=t)}set oldClearColor(t){this._objRef&&(this._objRef.oldClearColor=Ft(this._objRef.oldClearColor,t))}set oldClearAlpha(t){this._objRef&&(this._objRef.oldClearAlpha=t)}set basic(t){this._objRef&&(this._objRef.basic=t)}set fsQuad(t){this._objRef&&(this._objRef.fsQuad=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-unrealBloomPass"]],inputs:{resolution:"resolution",strength:"strength",radius:"radius",threshold:"threshold",clearColor:"clearColor",renderTargetsHorizontal:"renderTargetsHorizontal",renderTargetsVertical:"renderTargetsVertical",nMips:"nMips",renderTargetBright:"renderTargetBright",highPassUniforms:"highPassUniforms",materialHighPassFilter:"materialHighPassFilter",separableBlurMaterials:"separableBlurMaterials",compositeMaterial:"compositeMaterial",bloomTintColors:"bloomTintColors",copyUniforms:"copyUniforms",materialCopy:"materialCopy",oldClearColor:"oldClearColor",oldClearAlpha:"oldClearAlpha",basic:"basic",fsQuad:"fsQuad"},features:[Xe([{provide:Dl,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();function Xce(i){return[{provide:on,useExisting:qe(()=>i)}]}const Kce=0,qce=1,Zce=2,Yce=3,Qce=0,$ce=0,Jce=2,eue=0,tue=1,nue=160,iue=161,rue=162,sue=163,oue=0,aue=1,lue=0,cue=1,uue=2,hue=3,due=4,fue=5,pue=6,mue=7,gue=8,_ue=9,vue=10,yue=11,bue=12,xue=13,wue=14,Mue=15,Sue=16,Tue=17,Cue=18,Eue=0,Rue=1,Aue=2,Due=3,Pue=4,Iue=5,Fue=6,Lue=7,Oue=8,kue=9,Nue=10,Bue=11,Uue=0,Vue=1,jue=2,zue=13,Hue=14,Gue=15,Wue=128,Xue=64,Kue=32,que=16,Zue=0,Yue=1,Que=2,$ue=3,Jue=4,ehe=5,the=6,nhe=7,ihe=8,rhe=9,she=10,ohe=13,ahe=14,lhe=15,che=16,uhe=17,hhe=20,dhe=21,fhe=22,phe=23,mhe=24,ghe=27,_he=28,vhe=29,yhe=30,bhe=31,xhe=34,whe=35,Mhe=36,She=37,The=38,Che=41,Ehe=42,Rhe=43,Ahe=44,Dhe=45,Phe=48,Ihe=49,Fhe=50,Lhe=58,Ohe=59,khe=62,Nhe=63,Bhe=64,Uhe=65,Vhe=68,jhe=69,zhe=70,Hhe=71,Ghe=74,Whe=75,Xhe=76,Khe=77,qhe=78,Zhe=81,Yhe=82,Qhe=83,$he=84,Jhe=85,ede=88,tde=89,nde=90,ide=91,rde=92,sde=95,ode=96,ade=97,lde=98,cde=99,ude=100,hde=101,dde=102,fde=103,pde=104,mde=105,gde=106,_de=107,vde=108,yde=109,bde=110,xde=111,wde=112,Mde=113,Sde=114,Tde=115,Cde=116,Ede=117,Rde=118,Ade=119,Dde=120,Pde=121,Ide=122,Fde=123,Lde=124,Ode=125,kde=126,Nde=127,Bde=128,Ude=129,Vde=130,jde=131,zde=132,Hde=133,Gde=134,Wde=135,Xde=136,Kde=137,qde=138,Zde=139,Yde=140,Qde=141,$de=142,Jde=143,efe=144,tfe=145,nfe=146,ife=147,rfe=148,sfe=149,ofe=150,afe=151,lfe=152,cfe=153,ufe=154,hfe=155,dfe=156,ffe=157,pfe=158,mfe=159,gfe=160,_fe=161,vfe=162,yfe=163,bfe=164,xfe=165,wfe=166,Mfe=167,Sfe=168,Tfe=169,Cfe=170,Efe=171,Rfe=172,Afe=173,Dfe=174,Pfe=175,Ife=176,Ffe=177,Lfe=178,Ofe=179,kfe=180,Nfe=181,Bfe=182,Ufe=183,Vfe=184,jfe=1000156007,zfe=1000156008,Hfe=1000156009,Gfe=1000156010,Wfe=1000156011,Xfe=1000156017,Kfe=1000156018,qfe=1000156019,Zfe=1000156020,Yfe=1000156021,Qfe=1000054e3,$fe=1000054001,Jfe=1000054002,epe=1000054003,tpe=1000054004,npe=1000054005,ipe=1000054006,rpe=1000054007,spe=1000066e3,ope=1000066001,ape=1000066002,lpe=1000066003,cpe=1000066004,upe=1000066005,hpe=1000066006,dpe=1000066007,fpe=1000066008,ppe=1000066009,mpe=1000066010,gpe=1000066011,_pe=1000066012,vpe=1000066013,ype=100034e4,bpe=1000340001;class HU{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class rm{constructor(e,t,n,r){this._dataView=new DataView(e.buffer,e.byteOffset+t,n),this._littleEndian=r,this._offset=0}_nextUint8(){const e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){const e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){const e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){const e=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,e}_nextInt32(){const e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_skip(e){return this._offset+=e,this}_scan(e,t=0){const n=this._offset;let r=0;for(;this._dataView.getUint8(this._offset)!==t&&r<e;)r++,this._offset++;return r<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+n,r)}}const GU=new Uint8Array([0]),sr=[171,75,84,88,32,50,48,187,13,10,26,10];function WU(i){return typeof TextEncoder<"u"?(new TextEncoder).encode(i):Buffer.from(i)}function XU(i){return typeof TextDecoder<"u"?(new TextDecoder).decode(i):Buffer.from(i).toString("utf8")}function A0(i){let e=0;for(const r of i)e+=r.byteLength;const t=new Uint8Array(e);let n=0;for(const r of i)t.set(new Uint8Array(r),n),n+=r.byteLength;return t}function xpe(i){const e=new Uint8Array(i.buffer,i.byteOffset,sr.length);if(e[0]!==sr[0]||e[1]!==sr[1]||e[2]!==sr[2]||e[3]!==sr[3]||e[4]!==sr[4]||e[5]!==sr[5]||e[6]!==sr[6]||e[7]!==sr[7]||e[8]!==sr[8]||e[9]!==sr[9]||e[10]!==sr[10]||e[11]!==sr[11])throw new Error("Missing KTX 2.0 identifier.");const t=new HU,n=17*Uint32Array.BYTES_PER_ELEMENT,r=new rm(i,sr.length,n,!0);t.vkFormat=r._nextUint32(),t.typeSize=r._nextUint32(),t.pixelWidth=r._nextUint32(),t.pixelHeight=r._nextUint32(),t.pixelDepth=r._nextUint32(),t.layerCount=r._nextUint32(),t.faceCount=r._nextUint32();const s=r._nextUint32();t.supercompressionScheme=r._nextUint32();const o=r._nextUint32(),a=r._nextUint32(),l=r._nextUint32(),c=r._nextUint32(),u=r._nextUint64(),h=r._nextUint64(),d=new rm(i,sr.length+n,3*s*8,!0);for(let V=0;V<s;V++)t.levels.push({levelData:new Uint8Array(i.buffer,i.byteOffset+d._nextUint64(),d._nextUint64()),uncompressedByteLength:d._nextUint64()});const f=new rm(i,o,a,!0),p={vendorId:f._skip(4)._nextUint16(),descriptorType:f._nextUint16(),versionNumber:f._nextUint16(),descriptorBlockSize:f._nextUint16(),colorModel:f._nextUint8(),colorPrimaries:f._nextUint8(),transferFunction:f._nextUint8(),flags:f._nextUint8(),texelBlockDimension:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],bytesPlane:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],samples:[]},m=(p.descriptorBlockSize/4-6)/4;for(let V=0;V<m;V++){const W={bitOffset:f._nextUint16(),bitLength:f._nextUint8(),channelType:f._nextUint8(),samplePosition:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&W.channelType?(W.sampleLower=f._nextInt32(),W.sampleUpper=f._nextInt32()):(W.sampleLower=f._nextUint32(),W.sampleUpper=f._nextUint32()),p.samples[V]=W}t.dataFormatDescriptor.length=0,t.dataFormatDescriptor.push(p);const g=new rm(i,l,c,!0);for(;g._offset<c;){const V=g._nextUint32(),W=g._scan(V),j=XU(W),q=g._scan(V-W.byteLength);t.keyValue[j]=j.match(/^ktx/i)?XU(q):q,g._offset%4&&g._skip(4-g._offset%4)}if(h<=0)return t;const _=new rm(i,u,h,!0),v=_._nextUint16(),y=_._nextUint16(),b=_._nextUint32(),w=_._nextUint32(),M=_._nextUint32(),T=_._nextUint32(),x=[];for(let V=0;V<s;V++)x.push({imageFlags:_._nextUint32(),rgbSliceByteOffset:_._nextUint32(),rgbSliceByteLength:_._nextUint32(),alphaSliceByteOffset:_._nextUint32(),alphaSliceByteLength:_._nextUint32()});const E=u+_._offset,D=E+b,L=D+w,z=L+M,H=new Uint8Array(i.buffer,i.byteOffset+E,b),U=new Uint8Array(i.buffer,i.byteOffset+D,w),X=new Uint8Array(i.buffer,i.byteOffset+L,M),I=new Uint8Array(i.buffer,i.byteOffset+z,T);return t.globalData={endpointCount:v,selectorCount:y,imageDescs:x,endpointsData:H,selectorsData:U,tablesData:X,extendedData:I},t}function OC(){return(OC=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i}).apply(this,arguments)}const wpe={keepWriter:!1};function Mpe(i,e={}){e=OC({},wpe,e);let t=new ArrayBuffer(0);if(i.globalData){const v=new ArrayBuffer(20+5*i.globalData.imageDescs.length*4),y=new DataView(v);y.setUint16(0,i.globalData.endpointCount,!0),y.setUint16(2,i.globalData.selectorCount,!0),y.setUint32(4,i.globalData.endpointsData.byteLength,!0),y.setUint32(8,i.globalData.selectorsData.byteLength,!0),y.setUint32(12,i.globalData.tablesData.byteLength,!0),y.setUint32(16,i.globalData.extendedData.byteLength,!0);for(let b=0;b<i.globalData.imageDescs.length;b++){const w=i.globalData.imageDescs[b];y.setUint32(20+5*b*4+0,w.imageFlags,!0),y.setUint32(20+5*b*4+4,w.rgbSliceByteOffset,!0),y.setUint32(20+5*b*4+8,w.rgbSliceByteLength,!0),y.setUint32(20+5*b*4+12,w.alphaSliceByteOffset,!0),y.setUint32(20+5*b*4+16,w.alphaSliceByteLength,!0)}t=A0([v,i.globalData.endpointsData,i.globalData.selectorsData,i.globalData.tablesData,i.globalData.extendedData])}const n=[];let r=i.keyValue;e.keepWriter||(r=OC({},i.keyValue,{KTXwriter:"KTX-Parse v0.3.1"}));for(const v in r){const y=r[v],b=WU(v),w="string"==typeof y?WU(y):y,M=b.byteLength+1+w.byteLength+1,T=M%4?4-M%4:0;n.push(A0([new Uint32Array([M]),b,GU,w,GU,new Uint8Array(T).fill(0)]))}const s=A0(n);if(1!==i.dataFormatDescriptor.length||0!==i.dataFormatDescriptor[0].descriptorType)throw new Error("Only BASICFORMAT Data Format Descriptor output supported.");const o=i.dataFormatDescriptor[0],a=new ArrayBuffer(28+16*o.samples.length),l=new DataView(a),c=24+16*o.samples.length;if(l.setUint32(0,a.byteLength,!0),l.setUint16(4,o.vendorId,!0),l.setUint16(6,o.descriptorType,!0),l.setUint16(8,o.versionNumber,!0),l.setUint16(10,c,!0),l.setUint8(12,o.colorModel),l.setUint8(13,o.colorPrimaries),l.setUint8(14,o.transferFunction),l.setUint8(15,o.flags),!Array.isArray(o.texelBlockDimension))throw new Error("texelBlockDimension is now an array. For dimensionality `d`, set `d - 1`.");l.setUint8(16,o.texelBlockDimension[0]),l.setUint8(17,o.texelBlockDimension[1]),l.setUint8(18,o.texelBlockDimension[2]),l.setUint8(19,o.texelBlockDimension[3]);for(let v=0;v<8;v++)l.setUint8(20+v,o.bytesPlane[v]);for(let v=0;v<o.samples.length;v++){const y=o.samples[v],b=28+16*v;if(y.channelID)throw new Error("channelID has been renamed to channelType.");l.setUint16(b+0,y.bitOffset,!0),l.setUint8(b+2,y.bitLength),l.setUint8(b+3,y.channelType),l.setUint8(b+4,y.samplePosition[0]),l.setUint8(b+5,y.samplePosition[1]),l.setUint8(b+6,y.samplePosition[2]),l.setUint8(b+7,y.samplePosition[3]),64&y.channelType?(l.setInt32(b+8,y.sampleLower,!0),l.setInt32(b+12,y.sampleUpper,!0)):(l.setUint32(b+8,y.sampleLower,!0),l.setUint32(b+12,y.sampleUpper,!0))}const u=sr.length+68+3*i.levels.length*8,h=u+a.byteLength;let d=t.byteLength>0?h+s.byteLength:0;d%8&&(d+=8-d%8);const f=[],p=new DataView(new ArrayBuffer(3*i.levels.length*8));let m=(d||h+s.byteLength)+t.byteLength;for(let v=0;v<i.levels.length;v++){const y=i.levels[v];f.push(y.levelData),p.setBigUint64(24*v+0,BigInt(m),!0),p.setBigUint64(24*v+8,BigInt(y.levelData.byteLength),!0),p.setBigUint64(24*v+16,BigInt(y.uncompressedByteLength),!0),m+=y.levelData.byteLength}const g=new ArrayBuffer(68),_=new DataView(g);return _.setUint32(0,i.vkFormat,!0),_.setUint32(4,i.typeSize,!0),_.setUint32(8,i.pixelWidth,!0),_.setUint32(12,i.pixelHeight,!0),_.setUint32(16,i.pixelDepth,!0),_.setUint32(20,i.layerCount,!0),_.setUint32(24,i.faceCount,!0),_.setUint32(28,i.levels.length,!0),_.setUint32(32,i.supercompressionScheme,!0),_.setUint32(36,u,!0),_.setUint32(40,a.byteLength,!0),_.setUint32(44,h,!0),_.setUint32(48,s.byteLength,!0),_.setBigUint64(52,BigInt(t.byteLength>0?d:0),!0),_.setBigUint64(60,BigInt(t.byteLength),!0),new Uint8Array(A0([new Uint8Array(sr).buffer,g,p.buffer,a,s,d>0?new ArrayBuffer(d-(h+s.byteLength)):new ArrayBuffer(0),t,...f]))}var e,t,i,Gt={toRGBA8:function(i){var e=i.width,t=i.height;if(null==i.tabs.acTL)return[Gt.toRGBA8.decodeImage(i.data,e,t,i).buffer];var n=[];null==i.frames[0].data&&(i.frames[0].data=i.data);for(var r=e*t*4,s=new Uint8Array(r),o=new Uint8Array(r),a=new Uint8Array(r),l=0;l<i.frames.length;l++){var c=i.frames[l],u=c.rect.x,h=c.rect.y,d=c.rect.width,f=c.rect.height,p=Gt.toRGBA8.decodeImage(c.data,d,f,i);if(0!=l)for(var m=0;m<r;m++)a[m]=s[m];if(0==c.blend?Gt._copyTile(p,d,f,s,e,t,u,h,0):1==c.blend&&Gt._copyTile(p,d,f,s,e,t,u,h,1),n.push(s.buffer.slice(0)),1==c.dispose)Gt._copyTile(o,d,f,s,e,t,u,h,0);else if(2==c.dispose)for(m=0;m<r;m++)s[m]=a[m]}return n}};Gt.toRGBA8.decodeImage=function(i,e,t,n){var r=e*t,s=Gt.decode._getBPP(n),o=Math.ceil(e*s/8),a=new Uint8Array(4*r),l=new Uint32Array(a.buffer),c=n.ctype,u=n.depth,h=Gt._bin.readUshort;if(6==c){var d=r<<2;if(8==u)for(var f=0;f<d;f+=4)a[f]=i[f],a[f+1]=i[f+1],a[f+2]=i[f+2],a[f+3]=i[f+3];if(16==u)for(f=0;f<d;f++)a[f]=i[f<<1]}else if(2==c){var p=n.tabs.tRNS;if(null==p){if(8==u)for(f=0;f<r;f++)l[f]=255<<24|i[2+(m=3*f)]<<16|i[m+1]<<8|i[m];if(16==u)for(f=0;f<r;f++)l[f]=255<<24|i[4+(m=6*f)]<<16|i[m+2]<<8|i[m]}else{var g=p[0],_=p[1],v=p[2];if(8==u)for(f=0;f<r;f++){var y=f<<2;l[f]=255<<24|i[2+(m=3*f)]<<16|i[m+1]<<8|i[m],i[m]==g&&i[m+1]==_&&i[m+2]==v&&(a[y+3]=0)}if(16==u)for(f=0;f<r;f++){var m;y=f<<2,l[f]=255<<24|i[4+(m=6*f)]<<16|i[m+2]<<8|i[m],h(i,m)==g&&h(i,m+2)==_&&h(i,m+4)==v&&(a[y+3]=0)}}}else if(3==c){var b=n.tabs.PLTE,w=n.tabs.tRNS,M=w?w.length:0;if(1==u)for(var T=0;T<t;T++){var x=T*o,E=T*e;for(f=0;f<e;f++)a[y=E+f<<2]=b[L=3*(D=i[x+(f>>3)]>>7-((7&f)<<0)&1)],a[y+1]=b[L+1],a[y+2]=b[L+2],a[y+3]=D<M?w[D]:255}if(2==u)for(T=0;T<t;T++)for(x=T*o,E=T*e,f=0;f<e;f++)a[y=E+f<<2]=b[L=3*(D=i[x+(f>>2)]>>6-((3&f)<<1)&3)],a[y+1]=b[L+1],a[y+2]=b[L+2],a[y+3]=D<M?w[D]:255;if(4==u)for(T=0;T<t;T++)for(x=T*o,E=T*e,f=0;f<e;f++)a[y=E+f<<2]=b[L=3*(D=i[x+(f>>1)]>>4-((1&f)<<2)&15)],a[y+1]=b[L+1],a[y+2]=b[L+2],a[y+3]=D<M?w[D]:255;if(8==u)for(f=0;f<r;f++){var D,L;a[y=f<<2]=b[L=3*(D=i[f])],a[y+1]=b[L+1],a[y+2]=b[L+2],a[y+3]=D<M?w[D]:255}}else if(4==c){if(8==u)for(f=0;f<r;f++)a[y=f<<2]=H=i[z=f<<1],a[y+1]=H,a[y+2]=H,a[y+3]=i[z+1];if(16==u)for(f=0;f<r;f++){var z;a[y=f<<2]=H=i[z=f<<2],a[y+1]=H,a[y+2]=H,a[y+3]=i[z+2]}}else if(0==c)for(g=n.tabs.tRNS?n.tabs.tRNS:-1,T=0;T<t;T++){var U=T*o,X=T*e;if(1==u)for(var I=0;I<e;I++)l[X+I]=(V=(H=255*(i[U+(I>>>3)]>>>7-(7&I)&1))==255*g?0:255)<<24|H<<16|H<<8|H;else if(2==u)for(I=0;I<e;I++)l[X+I]=(V=(H=85*(i[U+(I>>>2)]>>>6-((3&I)<<1)&3))==85*g?0:255)<<24|H<<16|H<<8|H;else if(4==u)for(I=0;I<e;I++)l[X+I]=(V=(H=17*(i[U+(I>>>1)]>>>4-((1&I)<<2)&15))==17*g?0:255)<<24|H<<16|H<<8|H;else if(8==u)for(I=0;I<e;I++)l[X+I]=(V=(H=i[U+I])==g?0:255)<<24|H<<16|H<<8|H;else if(16==u)for(I=0;I<e;I++){var H=i[U+(I<<1)],V=h(i,U+(I<<1))==g?0:255;l[X+I]=V<<24|H<<16|H<<8|H}}return a},Gt.decode=function(i){for(var c,h,d,f,e=new Uint8Array(i),t=8,n=Gt._bin,r=n.readUshort,s=n.readUint,o={tabs:{},frames:[]},a=new Uint8Array(e.length),l=0,u=0,p=[137,80,78,71,13,10,26,10],m=0;m<8;m++)if(e[m]!=p[m])throw new Error("The input is not a PNG file!");for(;t<e.length;){var g=n.readUint(e,t),_=n.readASCII(e,t+=4,4);if(t+=4,"IHDR"==_)Gt.decode._IHDR(e,t,o);else if("CgBI"==_)o.tabs[_]=e.slice(t,t+4);else if("IDAT"==_){for(m=0;m<g;m++)a[l+m]=e[t+m];l+=g}else if("acTL"==_)o.tabs[_]={num_frames:s(e,t),num_plays:s(e,t+4)},c=new Uint8Array(e.length);else if("fcTL"==_){0!=u&&((v=o.frames[o.frames.length-1]).data=Gt.decode._decompress(o,c.slice(0,u),v.rect.width,v.rect.height),u=0);var y={x:s(e,t+12),y:s(e,t+16),width:s(e,t+4),height:s(e,t+8)},b=r(e,t+22);b=r(e,t+20)/(0==b?100:b);var w={rect:y,delay:Math.round(1e3*b),dispose:e[t+24],blend:e[t+25]};o.frames.push(w)}else if("fdAT"==_){for(m=0;m<g-4;m++)c[u+m]=e[t+m+4];u+=g-4}else if("pHYs"==_)o.tabs[_]=[n.readUint(e,t),n.readUint(e,t+4),e[t+8]];else if("cHRM"==_)for(o.tabs[_]=[],m=0;m<8;m++)o.tabs[_].push(n.readUint(e,t+4*m));else if("tEXt"==_||"zTXt"==_){null==o.tabs[_]&&(o.tabs[_]={});var M=n.nextZero(e,t);d=n.readASCII(e,t,M-t);var T=t+g-M-1;"tEXt"==_?h=n.readASCII(e,M+1,T):(f=Gt.decode._inflate(e.slice(M+2,M+2+T)),h=n.readUTF8(f,0,f.length)),o.tabs[_][d]=h}else if("iTXt"==_){null==o.tabs[_]&&(o.tabs[_]={}),M=0;var x=t;M=n.nextZero(e,x),d=n.readASCII(e,x,M-x);var E=e[x=M+1];M=n.nextZero(e,x+=2),n.readASCII(e,x,M-x),M=n.nextZero(e,x=M+1),n.readUTF8(e,x,M-x),T=g-((x=M+1)-t),0==E?h=n.readUTF8(e,x,T):(f=Gt.decode._inflate(e.slice(x,x+T)),h=n.readUTF8(f,0,f.length)),o.tabs[_][d]=h}else if("PLTE"==_)o.tabs[_]=n.readBytes(e,t,g);else if("hIST"==_){var D=o.tabs.PLTE.length/3;for(o.tabs[_]=[],m=0;m<D;m++)o.tabs[_].push(r(e,t+2*m))}else if("tRNS"==_)3==o.ctype?o.tabs[_]=n.readBytes(e,t,g):0==o.ctype?o.tabs[_]=r(e,t):2==o.ctype&&(o.tabs[_]=[r(e,t),r(e,t+2),r(e,t+4)]);else if("gAMA"==_)o.tabs[_]=n.readUint(e,t)/1e5;else if("sRGB"==_)o.tabs[_]=e[t];else if("bKGD"==_)0==o.ctype||4==o.ctype?o.tabs[_]=[r(e,t)]:2==o.ctype||6==o.ctype?o.tabs[_]=[r(e,t),r(e,t+2),r(e,t+4)]:3==o.ctype&&(o.tabs[_]=e[t]);else if("IEND"==_)break;n.readUint(e,t+=g),t+=4}var v;return 0!=u&&((v=o.frames[o.frames.length-1]).data=Gt.decode._decompress(o,c.slice(0,u),v.rect.width,v.rect.height)),o.data=Gt.decode._decompress(o,a,o.width,o.height),delete o.compress,delete o.interlace,delete o.filter,o},Gt.decode._decompress=function(i,e,t,n){var r=Gt.decode._getBPP(i),s=Math.ceil(t*r/8),o=new Uint8Array((s+1+i.interlace)*n);return e=i.tabs.CgBI?Gt.inflateRaw(e,o):Gt.decode._inflate(e,o),0==i.interlace?e=Gt.decode._filterZero(e,i,0,t,n):1==i.interlace&&(e=Gt.decode._readInterlace(e,i)),e},Gt.decode._inflate=function(i,e){return Gt.inflateRaw(new Uint8Array(i.buffer,2,i.length-6),e)},Gt.inflateRaw=((i={H:{}}).H.N=function(e,t){var f,p,n=Uint8Array,r=0,s=0,o=0,a=0,l=0,c=0,u=0,h=0,d=0;if(3==e[0]&&0==e[1])return t||new n(0);var m=i.H,g=m.b,_=m.e,v=m.R,y=m.n,b=m.A,w=m.Z,M=m.m,T=null==t;for(T&&(t=new n(e.length>>>2<<5));0==r;)if(r=g(e,d,1),s=g(e,d+1,2),d+=3,0!=s){if(T&&(t=i.H.W(t,h+(1<<17))),1==s&&(f=M.J,p=M.h,c=511,u=31),2==s){o=_(e,d,5)+257,a=_(e,d+5,5)+1,l=_(e,d+10,4)+4,d+=14;for(var D=1,L=0;L<38;L+=2)M.Q[L]=0,M.Q[L+1]=0;for(L=0;L<l;L++){var z=_(e,d+3*L,3);M.Q[1+(M.X[L]<<1)]=z,z>D&&(D=z)}d+=3*l,y(M.Q,D),b(M.Q,D,M.u),f=M.w,p=M.d,d=v(M.u,(1<<D)-1,o+a,e,d,M.v);var H=m.V(M.v,0,o,M.C);c=(1<<H)-1;var U=m.V(M.v,o,a,M.D);u=(1<<U)-1,y(M.C,H),b(M.C,H,f),y(M.D,U),b(M.D,U,p)}for(;;){var X=f[w(e,d)&c];d+=15&X;var I=X>>>4;if(I>>>8==0)t[h++]=I;else{if(256==I)break;var V=h+I-254;if(I>264){var W=M.q[I-257];V=h+(W>>>3)+_(e,d,7&W),d+=7&W}var j=p[w(e,d)&u],oe=M.c[j>>>4],J=(oe>>>4)+g(e,d+=15&j,15&oe);for(d+=15&oe;h<V;)t[h]=t[h++-J],t[h]=t[h++-J],t[h]=t[h++-J],t[h]=t[h++-J];h=V}}}else{0!=(7&d)&&(d+=8-(7&d));var x=4+(d>>>3),E=e[x-4]|e[x-3]<<8;T&&(t=i.H.W(t,h+E)),t.set(new n(e.buffer,e.byteOffset+x,E),h),d=x+E<<3,h+=E}return t.length==h?t:t.slice(0,h)},i.H.W=function(e,t){var n=e.length;if(t<=n)return e;var r=new Uint8Array(n<<1);return r.set(e,0),r},i.H.R=function(e,t,n,r,s,o){for(var a=i.H.e,l=i.H.Z,c=0;c<n;){var u=e[l(r,s)&t];s+=15&u;var h=u>>>4;if(h<=15)o[c]=h,c++;else{var d=0,f=0;16==h?(f=3+a(r,s,2),s+=2,d=o[c-1]):17==h?(f=3+a(r,s,3),s+=3):18==h&&(f=11+a(r,s,7),s+=7);for(var p=c+f;c<p;)o[c]=d,c++}}return s},i.H.V=function(e,t,n,r){for(var s=0,o=0,a=r.length>>>1;o<n;){var l=e[o+t];r[o<<1]=0,r[1+(o<<1)]=l,l>s&&(s=l),o++}for(;o<a;)r[o<<1]=0,r[1+(o<<1)]=0,o++;return s},i.H.n=function(e,t){for(var s,o,a,c,n=i.H.m,r=e.length,u=n.j,l=0;l<=t;l++)u[l]=0;for(l=1;l<r;l+=2)u[e[l]]++;var h=n.K;for(s=0,u[0]=0,o=1;o<=t;o++)h[o]=s=s+u[o-1]<<1;for(a=0;a<r;a+=2)0!=(c=e[a+1])&&(e[a]=h[c],h[c]++)},i.H.A=function(e,t,n){for(var r=e.length,o=i.H.m.r,a=0;a<r;a+=2)if(0!=e[a+1])for(var c=e[a+1],u=a>>1<<4|c,h=t-c,d=e[a]<<h,f=d+(1<<h);d!=f;)n[o[d]>>>15-t]=u,d++},i.H.l=function(e,t){for(var n=i.H.m.r,r=15-t,s=0;s<e.length;s+=2)e[s]=n[e[s]<<t-e[s+1]]>>>r},i.H.M=function(e,t,n){var r=t>>>3;e[r]|=n<<=7&t,e[r+1]|=n>>>8},i.H.I=function(e,t,n){var r=t>>>3;e[r]|=n<<=7&t,e[r+1]|=n>>>8,e[r+2]|=n>>>16},i.H.e=function(e,t,n){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<n)-1},i.H.b=function(e,t,n){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<n)-1},i.H.Z=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},i.H.i=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},i.H.m=(e=Uint16Array,t=Uint32Array,{K:new e(16),j:new e(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new e(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new t(32),J:new e(512),_:[],h:new e(32),$:[],w:new e(32768),C:[],v:[],d:new e(32768),D:[],u:new e(512),Q:[],r:new e(32768),s:new t(286),Y:new t(30),a:new t(19),t:new t(15e3),k:new e(65536),g:new e(32768)}),function(){for(var e=i.H.m,n=0;n<32768;n++){var r=n;e.r[n]=((r=(4278255360&(r=(4042322160&(r=(3435973836&(r=(2863311530&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8)>>>16|r<<16)>>>17}function s(o,a,l){for(;0!=a--;)o.push(0,l)}for(n=0;n<32;n++)e.q[n]=e.S[n]<<3|e.T[n],e.c[n]=e.p[n]<<4|e.z[n];s(e._,144,8),s(e._,112,9),s(e._,24,7),s(e._,8,8),i.H.n(e._,9),i.H.A(e._,9,e.J),i.H.l(e._,9),s(e.$,32,5),i.H.n(e.$,5),i.H.A(e.$,5,e.h),i.H.l(e.$,5),s(e.Q,19,0),s(e.C,286,0),s(e.D,30,0),s(e.v,320,0)}(),i.H.N),Gt.decode._readInterlace=function(i,e){for(var t=e.width,n=e.height,r=Gt.decode._getBPP(e),s=r>>3,o=Math.ceil(t*r/8),a=new Uint8Array(n*o),l=0,c=[0,0,4,0,2,0,1],u=[0,4,0,2,0,1,0],h=[8,8,8,4,4,2,2],d=[8,8,4,4,2,2,1],f=0;f<7;){for(var p=h[f],m=d[f],g=0,_=0,v=c[f];v<n;)v+=p,_++;for(var y=u[f];y<t;)y+=m,g++;var b=Math.ceil(g*r/8);Gt.decode._filterZero(i,e,l,g,_);for(var w=0,M=c[f];M<n;){for(var x=u[f],E=l+w*b<<3;x<t;){if(1==r&&(a[M*o+(x>>3)]|=(i[E>>3]>>7-(7&E)&1)<<7-((7&x)<<0)),2==r&&(a[M*o+(x>>2)]|=(i[E>>3]>>6-(7&E)&3)<<6-((3&x)<<1)),4==r&&(a[M*o+(x>>1)]|=(i[E>>3]>>4-(7&E)&15)<<4-((1&x)<<2)),r>=8)for(var D=M*o+x*s,L=0;L<s;L++)a[D+L]=i[(E>>3)+L];E+=r,x+=m}w++,M+=p}g*_!=0&&(l+=_*(1+b)),f+=1}return a},Gt.decode._getBPP=function(i){return[1,null,3,1,2,null,4][i.ctype]*i.depth},Gt.decode._filterZero=function(i,e,t,n,r){var s=Gt.decode._getBPP(e),o=Math.ceil(n*s/8),a=Gt.decode._paeth;s=Math.ceil(s/8);var l,c,u=i[t],h=0;if(u>1&&(i[t]=[0,0,1][u-2]),3==u)for(h=s;h<o;h++)i[h+1]=i[h+1]+(i[h+1-s]>>>1)&255;for(var d=0;d<r;d++)if(h=0,0==(u=i[(c=(l=t+d*o)+d+1)-1]))for(;h<o;h++)i[l+h]=i[c+h];else if(1==u){for(;h<s;h++)i[l+h]=i[c+h];for(;h<o;h++)i[l+h]=i[c+h]+i[l+h-s]}else if(2==u)for(;h<o;h++)i[l+h]=i[c+h]+i[l+h-o];else if(3==u){for(;h<s;h++)i[l+h]=i[c+h]+(i[l+h-o]>>>1);for(;h<o;h++)i[l+h]=i[c+h]+(i[l+h-o]+i[l+h-s]>>>1)}else{for(;h<s;h++)i[l+h]=i[c+h]+a(0,i[l+h-o],0);for(;h<o;h++)i[l+h]=i[c+h]+a(i[l+h-s],i[l+h-o],i[l+h-s-o])}return i},Gt.decode._paeth=function(i,e,t){var n=i+e-t,r=n-i,s=n-e,o=n-t;return r*r<=s*s&&r*r<=o*o?i:s*s<=o*o?e:t},Gt.decode._IHDR=function(i,e,t){var n=Gt._bin;t.width=n.readUint(i,e),t.height=n.readUint(i,e+=4),t.depth=i[e+=4],e++,t.ctype=i[e],e++,t.compress=i[e],e++,t.filter=i[e],e++,t.interlace=i[e],e++},Gt._bin={nextZero:function(i,e){for(;0!=i[e];)e++;return e},readUshort:function(i,e){return i[e]<<8|i[e+1]},writeUshort:function(i,e,t){i[e]=t>>8&255,i[e+1]=255&t},readUint:function(i,e){return 16777216*i[e]+(i[e+1]<<16|i[e+2]<<8|i[e+3])},writeUint:function(i,e,t){i[e]=t>>24&255,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=255&t},readASCII:function(i,e,t){for(var n="",r=0;r<t;r++)n+=String.fromCharCode(i[e+r]);return n},writeASCII:function(i,e,t){for(var n=0;n<t.length;n++)i[e+n]=t.charCodeAt(n)},readBytes:function(i,e,t){for(var n=[],r=0;r<t;r++)n.push(i[e+r]);return n},pad:function(i){return i.length<2?"0"+i:i},readUTF8:function(i,e,t){for(var r,n="",s=0;s<t;s++)n+="%"+Gt._bin.pad(i[e+s].toString(16));try{r=decodeURIComponent(n)}catch{return Gt._bin.readASCII(i,e,t)}return r}},Gt._copyTile=function(i,e,t,n,r,s,o,a,l){for(var c=Math.min(e,r),u=Math.min(t,s),h=0,d=0,f=0;f<u;f++)for(var p=0;p<c;p++)if(o>=0&&a>=0?(h=f*e+p<<2,d=(a+f)*r+o+p<<2):(h=(-a+f)*e-o+p<<2,d=f*r+p<<2),0==l)n[d]=i[h],n[d+1]=i[h+1],n[d+2]=i[h+2],n[d+3]=i[h+3];else if(1==l){var g=i[h]*(m=.00392156862745098*i[h+3]),_=i[h+1]*m,v=i[h+2]*m,b=n[d]*(y=n[d+3]*(1/255)),w=n[d+1]*y,M=n[d+2]*y,T=1-m,x=m+y*T,E=0==x?0:1/x;n[d+3]=255*x,n[d+0]=(g+b*T)*E,n[d+1]=(_+w*T)*E,n[d+2]=(v+M*T)*E}else if(2==l)g=i[h],_=i[h+1],v=i[h+2],b=n[d],w=n[d+1],M=n[d+2],(m=i[h+3])==(y=n[d+3])&&g==b&&_==w&&v==M?(n[d]=0,n[d+1]=0,n[d+2]=0,n[d+3]=0):(n[d]=g,n[d+1]=_,n[d+2]=v,n[d+3]=m);else if(3==l){var m,y;if(g=i[h],_=i[h+1],v=i[h+2],b=n[d],w=n[d+1],M=n[d+2],(m=i[h+3])==(y=n[d+3])&&g==b&&_==w&&v==M)continue;if(m<220&&y>20)return!1}return!0};const at={decode:function(i,e){null==e&&(e={parseMN:!0,debug:!1});var t=new Uint8Array(i),n=0,s="II"==at._binBE.readASCII(t,n,2)?at._binLE:at._binBE;s.readUshort(t,n+=2);for(var o=s.readUint(t,n+=2),a=[];;){var l=s.readUshort(t,o),c=s.readUshort(t,o+4);if(0!=l&&(c<1||13<c)){console.log("error in TIFF");break}if(at._readIFD(s,t,o,a,0,e),0==(o=s.readUint(t,o+2+12*l)))break}return a},decodeImage:function(i,e,t){if(!e.data){var n=new Uint8Array(i),r=at._binBE.readASCII(n,0,2);if(null!=e.t256){e.isLE="II"==r,e.width=e.t256[0],e.height=e.t257[0];var a,s=e.t259?e.t259[0]:1,o=e.t266?e.t266[0]:1;e.t284&&2==e.t284[0]&&console.log("PlanarConfiguration 2 should not be used!"),7==s&&e.t258&&e.t258.length>3&&(e.t258=e.t258.slice(0,3)),a=e.t258?Math.min(32,e.t258[0])*e.t258.length:e.t277?e.t277[0]:1,1==s&&null!=e.t279&&e.t278&&32803==e.t262[0]&&(a=Math.round(8*e.t279[0]/(e.width*e.t278[0])));var l=8*Math.ceil(e.width*a/8),c=e.t273;null==c&&(c=e.t324);var u=e.t279;1==s&&1==c.length&&(u=[e.height*(l>>>3)]),null==u&&(u=e.t325);var h=new Uint8Array(e.height*(l>>>3)),d=0;if(null!=e.t322){for(var f=e.t322[0],p=e.t323[0],m=Math.floor((e.width+f-1)/f),g=Math.floor((e.height+p-1)/p),_=new Uint8Array(0|Math.ceil(f*p*a/8)),v=0;v<g;v++)for(var y=0;y<m;y++){for(var b=v*m+y,w=0;w<_.length;w++)_[w]=0;at.decode._decompress(e,t,n,c[b],u[b],s,_,0,o),6==s?h=_:at._copyTile(_,0|Math.ceil(f*a/8),p,h,0|Math.ceil(e.width*a/8),e.height,0|Math.ceil(y*f*a/8),v*p)}d=8*h.length}else{var M=e.t278?e.t278[0]:e.height;for(M=Math.min(M,e.height),b=0;b<c.length;b++)at.decode._decompress(e,t,n,c[b],u[b],s,h,0|Math.ceil(d/8),o),d+=l*M;d=Math.min(d,8*h.length)}e.data=new Uint8Array(h.buffer,0,0|Math.ceil(d/8))}}}};at.decode._decompress=function(i,e,t,n,r,s,o,a){34676==s?at.decode._decodeLogLuv32(i,t,n,r,o,a):console.log("Unsupported compression",s);var l=i.t258?Math.min(32,i.t258[0]):1,c=i.t277?i.t277[0]:1,u=l*c>>>3,h=i.t278?i.t278[0]:i.height,d=Math.ceil(l*c*i.width/8);if(16==l&&!i.isLE&&null==i.t33422)for(var f=0;f<h;f++)for(var p=a+f*d,m=1;m<d;m+=2){var g=o[p+m];o[p+m]=o[p+m-1],o[p+m-1]=g}if(i.t317&&2==i.t317[0])for(f=0;f<h;f++){var _=a+f*d;if(16==l)for(var v=u;v<d;v+=2){var y=(o[_+v+1]<<8|o[_+v])+(o[_+v-u+1]<<8|o[_+v-u]);o[_+v]=255&y,o[_+v+1]=y>>>8&255}else if(3==c)for(v=3;v<d;v+=3)o[_+v]=o[_+v]+o[_+v-3]&255,o[_+v+1]=o[_+v+1]+o[_+v-2]&255,o[_+v+2]=o[_+v+2]+o[_+v-1]&255;else for(v=u;v<d;v++)o[_+v]=o[_+v]+o[_+v-u]&255}},at.decode._decodeLogLuv32=function(i,e,t,n,r,s){for(var o=i.width,a=4*o,l=0,c=new Uint8Array(a);l<n;){for(var u=0;u<a;){var h=e[t+l];if(l++,h<128){for(var d=0;d<h;d++)c[u+d]=e[t+l+d];u+=h,l+=h}else{for(h-=126,d=0;d<h;d++)c[u+d]=e[t+l];u+=h,l++}}for(var f=0;f<o;f++)r[s+0]=c[f],r[s+1]=c[f+o],r[s+2]=c[f+2*o],r[s+4]=c[f+3*o],s+=6}},at.tags={},at._types=function(){var i=new Array(250);return i.fill(0),{basic:{main:i=i.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rest:{33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7}},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}}(),at._readIFD=function(i,e,t,n,r,s){var o=i.readUshort(e,t);t+=2;var a={};s.debug&&console.log("   ".repeat(r),n.length-1,">>>----------------");for(var l=0;l<o;l++){var c=i.readUshort(e,t),u=i.readUshort(e,t+=2),h=i.readUint(e,t+=2),d=i.readUint(e,t+=4);t+=4;var f=[];if((1==u||7==u)&&(f=new Uint8Array(e.buffer,h<5?t-4:d,h)),2==u){var p=h<5?t-4:d,m=e[p],g=Math.max(0,Math.min(h-1,e.length-p));m<128||0==g?f.push(i.readASCII(e,p,g)):f=new Uint8Array(e.buffer,p,g)}if(3==u)for(var _=0;_<h;_++)f.push(i.readUshort(e,(h<3?t-4:d)+2*_));if(4==u||13==u)for(_=0;_<h;_++)f.push(i.readUint(e,(h<2?t-4:d)+4*_));if(5==u||10==u){var v=5==u?i.readUint:i.readInt;for(_=0;_<h;_++)f.push([v(e,d+8*_),v(e,d+8*_+4)])}if(8==u)for(_=0;_<h;_++)f.push(i.readShort(e,(h<3?t-4:d)+2*_));if(9==u)for(_=0;_<h;_++)f.push(i.readInt(e,(h<2?t-4:d)+4*_));if(11==u)for(_=0;_<h;_++)f.push(i.readFloat(e,d+4*_));if(12==u)for(_=0;_<h;_++)f.push(i.readDouble(e,d+8*_));if(0==h||0!=f.length){if(s.debug&&console.log("   ".repeat(r),c,u,at.tags[c],f),a["t"+c]=f,330==c||34665==c||34853==c||50740==c&&i.readUshort(e,i.readUint(f,0))<300||61440==c){var y=50740==c?[i.readUint(f,0)]:f,b=[];for(_=0;_<y.length;_++)at._readIFD(i,e,y[_],b,r+1,s);330==c&&(a.subIFD=b),34665==c&&(a.exifIFD=b[0]),34853==c&&(a.gpsiIFD=b[0]),50740==c&&(a.dngPrvt=b[0]),61440==c&&(a.fujiIFD=b[0])}if(37500==c&&s.parseMN){var w=f;if("Nikon"==i.readASCII(w,0,5))a.makerNote=at.decode(w.slice(10).buffer)[0];else if(i.readUshort(e,d)<300&&i.readUshort(e,d+4)<=12){var M=[];at._readIFD(i,e,d,M,r+1,s),a.makerNote=M[0]}}}else if(console.log(c,"unknown TIFF tag type: ",u,"num:",h),0==l)return}return n.push(a),s.debug&&console.log("   ".repeat(r),"<<<---------------"),t},at.toRGBA=function(i,e){const t=i.width,n=i.height,r=t*n,s=i.data;let o;switch(e){case lo:o=new Uint16Array(4*r);break;case Wr:o=new Float32Array(4*r);break;default:console.error("THREE.LogLuvLoader: Unsupported texture data type:",e)}let a=i.t262?i.t262[0]:2;const l=i.t258?Math.min(32,i.t258[0]):1;if(null==i.t262&&1==l&&(a=0),32845==a)for(let c=0;c<n;c++)for(let u=0;u<t;u++){const h=6*(c*t+u),d=4*(c*t+u);let f=s[h+1]<<8|s[h];f=Math.pow(2,(f+.5)/256-64);const p=(s[h+3]+.5)/410,m=(s[h+5]+.5)/410,g=9*p/(6*p-16*m+12),_=4*m/(6*p-16*m+12),y=g*f/_,w=(1-g-_)*f/_,M=2.69*y-1.276*f-.414*w,T=-1.022*y+1.978*f+.044*w,x=.061*y-.224*f+1.163*w;e===lo?(o[d]=gp.toHalfFloat(Math.min(M,65504)),o[d+1]=gp.toHalfFloat(Math.min(T,65504)),o[d+2]=gp.toHalfFloat(Math.min(x,65504)),o[d+3]=gp.toHalfFloat(1)):(o[d]=M,o[d+1]=T,o[d+2]=x,o[d+3]=1)}else console.log("Unsupported Photometric interpretation: "+a);return o},at._binBE={nextZero:function(i,e){for(;0!=i[e];)e++;return e},readUshort:function(i,e){return i[e]<<8|i[e+1]},readShort:function(i,e){var t=at._binBE.ui8;return t[0]=i[e+1],t[1]=i[e+0],at._binBE.i16[0]},readInt:function(i,e){var t=at._binBE.ui8;return t[0]=i[e+3],t[1]=i[e+2],t[2]=i[e+1],t[3]=i[e+0],at._binBE.i32[0]},readUint:function(i,e){var t=at._binBE.ui8;return t[0]=i[e+3],t[1]=i[e+2],t[2]=i[e+1],t[3]=i[e+0],at._binBE.ui32[0]},readASCII:function(i,e,t){for(var n="",r=0;r<t;r++)n+=String.fromCharCode(i[e+r]);return n},readFloat:function(i,e){for(var t=at._binBE.ui8,n=0;n<4;n++)t[n]=i[e+3-n];return at._binBE.fl32[0]},readDouble:function(i,e){for(var t=at._binBE.ui8,n=0;n<8;n++)t[n]=i[e+7-n];return at._binBE.fl64[0]},writeUshort:function(i,e,t){i[e]=t>>8&255,i[e+1]=255&t},writeInt:function(i,e,t){var n=at._binBE.ui8;at._binBE.i32[0]=t,i[e+3]=n[0],i[e+2]=n[1],i[e+1]=n[2],i[e+0]=n[3]},writeUint:function(i,e,t){i[e]=t>>24&255,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=t>>0&255},writeASCII:function(i,e,t){for(var n=0;n<t.length;n++)i[e+n]=t.charCodeAt(n)},writeDouble:function(i,e,t){at._binBE.fl64[0]=t;for(var n=0;n<8;n++)i[e+n]=at._binBE.ui8[7-n]}},at._binBE.ui8=new Uint8Array(8),at._binBE.i16=new Int16Array(at._binBE.ui8.buffer),at._binBE.i32=new Int32Array(at._binBE.ui8.buffer),at._binBE.ui32=new Uint32Array(at._binBE.ui8.buffer),at._binBE.fl32=new Float32Array(at._binBE.ui8.buffer),at._binBE.fl64=new Float64Array(at._binBE.ui8.buffer),at._binLE={nextZero:at._binBE.nextZero,readUshort:function(i,e){return i[e+1]<<8|i[e]},readShort:function(i,e){var t=at._binBE.ui8;return t[0]=i[e+0],t[1]=i[e+1],at._binBE.i16[0]},readInt:function(i,e){var t=at._binBE.ui8;return t[0]=i[e+0],t[1]=i[e+1],t[2]=i[e+2],t[3]=i[e+3],at._binBE.i32[0]},readUint:function(i,e){var t=at._binBE.ui8;return t[0]=i[e+0],t[1]=i[e+1],t[2]=i[e+2],t[3]=i[e+3],at._binBE.ui32[0]},readASCII:at._binBE.readASCII,readFloat:function(i,e){for(var t=at._binBE.ui8,n=0;n<4;n++)t[n]=i[e+n];return at._binBE.fl32[0]},readDouble:function(i,e){for(var t=at._binBE.ui8,n=0;n<8;n++)t[n]=i[e+n];return at._binBE.fl64[0]},writeUshort:function(i,e,t){i[e]=255&t,i[e+1]=t>>8&255},writeInt:function(i,e,t){var n=at._binBE.ui8;at._binBE.i32[0]=t,i[e+0]=n[0],i[e+1]=n[1],i[e+2]=n[2],i[e+3]=n[3]},writeUint:function(i,e,t){i[e]=t>>>0&255,i[e+1]=t>>>8&255,i[e+2]=t>>>16&255,i[e+3]=t>>>24&255},writeASCII:at._binBE.writeASCII},at._copyTile=function(i,e,t,n,r,s,o,a){for(var l=Math.min(e,r-o),c=Math.min(t,s-a),u=0;u<c;u++)for(var h=(a+u)*r+o,d=u*e,f=0;f<l;f++)n[h+f]=i[d+f]};const D0=new Ce;class Tpe extends Fr{constructor(e){super(e),this.propertyNameMapping={}}load(e,t,n,r){const s=this,o=new Ds(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(a))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}setPropertyNameMapping(e){this.propertyNameMapping=e}parse(e){function t(f){let m="",g=0;const _=/^ply([\s\S]*)end_header(\r\n|\r|\n)/.exec(f);null!==_&&(m=_[1],g=new Blob([_[0]]).size);const v={comments:[],elements:[],headerLength:g,objInfo:""},y=m.split(/\r\n|\r|\n/);let b;function w(M,T){const x={type:M[0]};return"list"===x.type?(x.name=M[3],x.countType=M[1],x.itemType=M[2]):x.name=M[1],x.name in T&&(x.name=T[x.name]),x}for(let M=0;M<y.length;M++){let T=y[M];if(T=T.trim(),""===T)continue;const x=T.split(/\s+/),E=x.shift();switch(T=x.join(" "),E){case"format":v.format=x[0],v.version=x[1];break;case"comment":v.comments.push(T);break;case"element":void 0!==b&&v.elements.push(b),b={},b.name=x[0],b.count=parseInt(x[1]),b.properties=[];break;case"property":b.properties.push(w(x,d.propertyNameMapping));break;case"obj_info":v.objInfo=T;break;default:console.log("unhandled",E,x)}}return void 0!==b&&v.elements.push(b),v}function n(f,p){switch(p){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(f);case"float":case"double":case"float32":case"float64":return parseFloat(f)}}function r(f,p){const m=p.split(/\s+/),g={};for(let _=0;_<f.length;_++)if("list"===f[_].type){const v=[],y=n(m.shift(),f[_].countType);for(let b=0;b<y;b++)v.push(n(m.shift(),f[_].itemType));g[f[_].name]=v}else g[f[_].name]=n(m.shift(),f[_].type);return g}function s(f,p){const m={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]};let g,v="";null!==(g=/end_header\s([\s\S]*)$/.exec(f))&&(v=g[1]);const y=v.split(/\r\n|\r|\n/);let b=0,w=0;for(let M=0;M<y.length;M++){let T=y[M];if(T=T.trim(),""===T)continue;w>=p.elements[b].count&&(b++,w=0);const x=r(p.elements[b].properties,T);a(m,p.elements[b].name,x),w++}return o(m)}function o(f){let p=new wt;return f.indices.length>0&&p.setIndex(f.indices),p.setAttribute("position",new $e(f.vertices,3)),f.normals.length>0&&p.setAttribute("normal",new $e(f.normals,3)),f.uvs.length>0&&p.setAttribute("uv",new $e(f.uvs,2)),f.colors.length>0&&p.setAttribute("color",new $e(f.colors,3)),f.faceVertexUvs.length>0&&(p=p.toNonIndexed(),p.setAttribute("uv",new $e(f.faceVertexUvs,2))),p.computeBoundingSphere(),p}function a(f,p,m){function g(z){for(let H=0,U=z.length;H<U;H++){const X=z[H];if(X in m)return X}return null}const _=g(["x","px","posx"])||"x",v=g(["y","py","posy"])||"y",y=g(["z","pz","posz"])||"z",b=g(["nx","normalx"]),w=g(["ny","normaly"]),M=g(["nz","normalz"]),T=g(["s","u","texture_u","tx"]),x=g(["t","v","texture_v","ty"]),E=g(["red","diffuse_red","r","diffuse_r"]),D=g(["green","diffuse_green","g","diffuse_g"]),L=g(["blue","diffuse_blue","b","diffuse_b"]);if("vertex"===p)f.vertices.push(m[_],m[v],m[y]),null!==b&&null!==w&&null!==M&&f.normals.push(m[b],m[w],m[M]),null!==T&&null!==x&&f.uvs.push(m[T],m[x]),null!==E&&null!==D&&null!==L&&(D0.setRGB(m[E]/255,m[D]/255,m[L]/255).convertSRGBToLinear(),f.colors.push(D0.r,D0.g,D0.b));else if("face"===p){const z=m.vertex_indices||m.vertex_index,H=m.texcoord;3===z.length?(f.indices.push(z[0],z[1],z[2]),H&&6===H.length&&(f.faceVertexUvs.push(H[0],H[1]),f.faceVertexUvs.push(H[2],H[3]),f.faceVertexUvs.push(H[4],H[5]))):4===z.length&&(f.indices.push(z[0],z[1],z[3]),f.indices.push(z[1],z[2],z[3]))}}function l(f,p,m,g){switch(m){case"int8":case"char":return[f.getInt8(p),1];case"uint8":case"uchar":return[f.getUint8(p),1];case"int16":case"short":return[f.getInt16(p,g),2];case"uint16":case"ushort":return[f.getUint16(p,g),2];case"int32":case"int":return[f.getInt32(p,g),4];case"uint32":case"uint":return[f.getUint32(p,g),4];case"float32":case"float":return[f.getFloat32(p,g),4];case"float64":case"double":return[f.getFloat64(p,g),8]}}function c(f,p,m,g){const _={};let v,y=0;for(let b=0;b<m.length;b++)if("list"===m[b].type){const w=[];v=l(f,p+y,m[b].countType,g);const M=v[0];y+=v[1];for(let T=0;T<M;T++)v=l(f,p+y,m[b].itemType,g),w.push(v[0]),y+=v[1];_[m[b].name]=w}else v=l(f,p+y,m[b].type,g),_[m[b].name]=v[0],y+=v[1];return[_,y]}let h;const d=this;if(e instanceof ArrayBuffer){const f=bo.decodeText(new Uint8Array(e)),p=t(f);h="ascii"===p.format?s(f,p):function u(f,p){const m={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},g="binary_little_endian"===p.format,_=new DataView(f,p.headerLength);let v,y=0;for(let b=0;b<p.elements.length;b++)for(let w=0;w<p.elements[b].count;w++)v=c(_,y,p.elements[b].properties,g),y+=v[1],a(m,p.elements[b].name,v[0]);return o(m)}(e,p)}else h=s(e,t(e));return h}}let Cpe=(()=>{class i extends NN{constructor(){super(...arguments),this.clazz=Tpe}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Epe=(()=>{class i extends BN{constructor(t,n,r){super(t,n),this.host=t,this.zone=n,this.service=r}getRefFromResponse(t){return t.computeVertexNormals(),t}load(){var t=this;return so(function*(){if(!t.initialized)return;if(void 0===t._url)throw new Error("missing url");const n=t._url,r=mT(t.onProgress$)?o=>{t.onProgress$?.next(o)}:void 0,s=yield t.zone.runOutsideAngular(()=>t.service.load(n,r));t.host.objRef=t.getRefFromResponse(s),t.onLoaded$&&void 0!==s&&t.onLoaded$?.next(s)})()}}return i.\u0275fac=function(t){return new(t||i)(N(xo,1),N(Pt),N(Cpe))},i.\u0275dir=tt({type:i,selectors:[["","loadPLY",""]],features:[Se]}),i})(),iV=(()=>{class i extends qh{getType(){return vo}set type(t){this._objRef&&(this._objRef.type=t)}set defines(t){this._objRef&&(this._objRef.defines=t)}set color(t){this._objRef&&(this._objRef.color=Ft(this._objRef.color,t))}set roughness(t){this._objRef&&(this._objRef.roughness=t)}set metalness(t){this._objRef&&(this._objRef.metalness=t)}set map(t){this._objRef&&(this._objRef.map=t)}set lightMap(t){this._objRef&&(this._objRef.lightMap=t)}set lightMapIntensity(t){this._objRef&&(this._objRef.lightMapIntensity=t)}set aoMap(t){this._objRef&&(this._objRef.aoMap=t)}set aoMapIntensity(t){this._objRef&&(this._objRef.aoMapIntensity=t)}set emissive(t){this._objRef&&(this._objRef.emissive=Ft(this._objRef.emissive,t))}set emissiveIntensity(t){this._objRef&&(this._objRef.emissiveIntensity=t)}set emissiveMap(t){this._objRef&&(this._objRef.emissiveMap=t)}set bumpMap(t){this._objRef&&(this._objRef.bumpMap=t)}set bumpScale(t){this._objRef&&(this._objRef.bumpScale=t)}set normalMap(t){this._objRef&&(this._objRef.normalMap=t)}set normalMapType(t){this._objRef&&(this._objRef.normalMapType=t)}set normalScale(t){this._objRef&&(this._objRef.normalScale=Ft(this._objRef.normalScale,t))}set displacementMap(t){this._objRef&&(this._objRef.displacementMap=t)}set displacementScale(t){this._objRef&&(this._objRef.displacementScale=t)}set displacementBias(t){this._objRef&&(this._objRef.displacementBias=t)}set roughnessMap(t){this._objRef&&(this._objRef.roughnessMap=t)}set metalnessMap(t){this._objRef&&(this._objRef.metalnessMap=t)}set alphaMap(t){this._objRef&&(this._objRef.alphaMap=t)}set envMap(t){this._objRef&&(this._objRef.envMap=t)}set envMapIntensity(t){this._objRef&&(this._objRef.envMapIntensity=t)}set wireframe(t){this._objRef&&(this._objRef.wireframe=t)}set wireframeLinewidth(t){this._objRef&&(this._objRef.wireframeLinewidth=t)}set wireframeLinecap(t){this._objRef&&(this._objRef.wireframeLinecap=t)}set wireframeLinejoin(t){this._objRef&&(this._objRef.wireframeLinejoin=t)}set flatShading(t){this._objRef&&(this._objRef.flatShading=t)}set fog(t){this._objRef&&(this._objRef.fog=t)}set isMeshStandardMaterial(t){this._objRef&&(this._objRef.isMeshStandardMaterial=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-meshStandardMaterial"]],inputs:{type:"type",defines:"defines",color:"color",roughness:"roughness",metalness:"metalness",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",emissive:"emissive",emissiveIntensity:"emissiveIntensity",emissiveMap:"emissiveMap",bumpMap:"bumpMap",bumpScale:"bumpScale",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",roughnessMap:"roughnessMap",metalnessMap:"metalnessMap",alphaMap:"alphaMap",envMap:"envMap",envMapIntensity:"envMapIntensity",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",flatShading:"flatShading",fog:"fog",isMeshStandardMaterial:"isMeshStandardMaterial"},features:[Xe([{provide:qh,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),Rpe=(()=>{class i extends xo{getType(){return mo}set type(t){this._objRef&&(this._objRef.type=t)}set parameters(t){this._objRef&&(this._objRef.parameters=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-polyhedronGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[Xe([{provide:xo,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),Ape=(()=>{class i extends Rpe{getType(){return Fc}set type(t){this._objRef&&(this._objRef.type=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-icosahedronGeometry"]],inputs:{type:"type"},features:[Xe([{provide:xo,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();const Dpe=["slider"],Ppe=function(){return[35,2,.1,100]},Ipe=function(){return[0,0,6]},Fpe=function(i,e){return{x:0,y:0,width:i,height:e}},Lpe=function(){return["#ffffff","#444444",1]},Ope=function(i){return[i,2,2]},kpe=function(){return[1,3]},Npe=function(i,e,t){return{x:i,y:0,width:e,height:t}};let Bpe=(()=>{class i{constructor(){this.sliderPos=0,this.controlsEnabled=!0,this.colorLeft=new Ce(12375183),this.colorRight=new Ce(9419988)}ngOnInit(){!this.slider||!this.canvas||(this.slider.nativeElement.style.touchAction="none",this.sliderPos=(this.canvas.rendererCanvas?.nativeElement.clientWidth||0)/2)}onPointerMove(t){if(this.controlsEnabled||!this.canvas||!this.canvas.rendererCanvas||!this.slider||!1===t.isPrimary)return;const r=this.canvas.rendererCanvas.nativeElement.getBoundingClientRect();this.sliderPos=Math.max(r.left,Math.min(r.right,t.pageX))-r.left,this.slider.nativeElement.style.left=this.sliderPos-this.slider.nativeElement.offsetWidth/2+"px"}onPointerUp(){this.controlsEnabled=!0}onSliderPointerDown(t){!1!==t.isPrimary&&(this.controlsEnabled=!1)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["app-multi-scene-example"]],viewQuery:function(t,n){if(1&t&&(Pn(Dpe,7),Pn(nr,7)),2&t){let r;Et(r=Rt())&&(n.slider=r.first),Et(r=Rt())&&(n.canvas=r.first)}},hostBindings:function(t,n){1&t&&gt("pointermove",function(s){return n.onPointerMove(s)},!1,Rb)("pointerup",function(){return n.onPointerUp()},!1,Rb)},decls:20,vars:32,consts:[[1,"slider",3,"pointerdown"],["slider",""],[3,"disableDefaultView"],["thecanvas",""],[3,"args","position"],["cam",""],[3,"scissor","scissorTest","clearColor","camera"],[3,"background"],["light",""],[3,"args"],["geo",""],[3,"objRef"],[3,"geometry"],[3,"wireframe"]],template:function(t,n){if(1&t&&(me(0,"div",0,1),gt("pointerdown",function(s){return n.onSliderPointerDown(s)}),Te(),me(2,"th-canvas",2,3)(4,"th-perspectiveCamera",4,5),Ze(6,"th-orbitControls"),Te(),me(7,"th-view",6)(8,"th-scene",7),Ze(9,"th-hemisphereLight",4,8),me(11,"th-mesh"),Ze(12,"th-meshStandardMaterial")(13,"th-icosahedronGeometry",9,10),Te()()(),me(15,"th-view",6)(16,"th-scene",7),Ze(17,"th-light",11),me(18,"th-mesh",12),Ze(19,"th-meshStandardMaterial",13),Te()()()()),2&t){const r=yn(3),s=yn(5),o=yn(10),a=yn(14);se(2),Q("disableDefaultView",!0),se(2),Q("args",Ee(19,Ppe))("position",Ee(20,Ipe)),se(3),Q("scissor",ic(21,Fpe,n.sliderPos,(null==r.rendererCanvas||null==r.rendererCanvas.nativeElement?null:r.rendererCanvas.nativeElement.height)||0))("scissorTest",!0)("clearColor",n.colorLeft)("camera",s),se(1),Q("background",n.colorLeft),se(1),Q("args",Ee(24,Lpe))("position",Tn(25,Ope,-2)),se(4),Q("args",Ee(27,kpe)),se(2),Q("scissor",xg(28,Npe,n.sliderPos,(null==r.rendererCanvas||null==r.rendererCanvas.nativeElement?null:r.rendererCanvas.nativeElement.width)||0,(null==r.rendererCanvas||null==r.rendererCanvas.nativeElement?null:r.rendererCanvas.nativeElement.height)||0))("scissorTest",!0)("clearColor",n.colorRight)("camera",s),se(1),Q("background",n.colorRight),se(1),Q("objRef",null==o.objRef?null:o.objRef.clone()),se(1),Q("geometry",a.objRef),se(1),Q("wireframe",!0)}},dependencies:[Cp,Lr,yT,_p,Ps,_r,iV,Ape,nr,xl],styles:[".container[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.slider[_ngcontent-%COMP%]{position:absolute;cursor:ew-resize;width:40px;height:40px;background-color:#f32196;opacity:.7;border-radius:50%;top:calc(50% - 20px);left:calc(50% - 20px)}"],changeDetection:0}),i})();const rV={uniforms:{tDiffuse:{value:null},amount:{value:.005},angle:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float amount;\n\t\tuniform float angle;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec2 offset = amount * vec2( cos(angle), sin(angle));\n\t\t\tvec4 cr = texture2D(tDiffuse, vUv + offset);\n\t\t\tvec4 cga = texture2D(tDiffuse, vUv);\n\t\t\tvec4 cb = texture2D(tDiffuse, vUv - offset);\n\t\t\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);\n\n\t\t}"};let VC=(()=>{class i extends xo{getType(){return Ea}set type(t){this._objRef&&(this._objRef.type=t)}set parameters(t){this._objRef&&(this._objRef.parameters=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-sphereGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[Xe([{provide:xo,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();const Upe=["thecanvas"],Vpe=function(i,e){return{x:0,y:0,width:i,height:e}},jpe=function(){return[0,0,1]},zpe=function(){return["#ffffff"]},Hpe=function(){return[0,0,0]},P0=function(i){return[i,0,0]},Gpe=function(){return[200,32,16]},Wpe=function(){return["#fac400"]},Xpe=function(){return["#f83f0d"]},Kpe=function(){return[400,0,0]},jC=function(i,e,t,n){return{x:i,y:e,width:t,height:n}},qpe=function(i){return[i]},Zpe=function(){return{value:.055}},Ype=function(i){return{amount:i}},Qpe=function(){return[.35,.5,2048,!0]};let $pe=(()=>{class i{constructor(){this.Math=Math,this.RGBShiftShader=rV,this.DotScreenShader=DU,this.canvasWidth=128,this.canvasHeight=128,this.mouseX=0,this.mouseY=0,this.view1={left:0,bottom:0,width:.5,height:1,background:new Ce(.5,.5,.7),eye:[0,300,1800],up:[0,1,0],fov:30,updateCamera:(t,n)=>{this.updateSize(),t.position.x+=.05*this.mouseX,t.position.x=Math.max(Math.min(t.position.x,2e3),-2e3),t.lookAt(n.position),t.updateProjectionMatrix()}},this.view2={left:.5,bottom:0,width:.5,height:.5,background:new Ce(.7,.5,.5),eye:[0,1800,0],up:[0,0,1],fov:45,updateCamera:(t,n)=>{this.updateSize(),t.position.x-=.05*this.mouseX,t.position.x=Math.max(Math.min(t.position.x,2e3),-2e3),t.lookAt(t.position.clone().setY(0)),t.updateProjectionMatrix()}},this.view3={left:.5,bottom:.5,width:.5,height:.5,background:new Ce(.5,.7,.7),eye:[1400,800,1400],up:[0,1,0],fov:60,updateCamera:(t,n)=>{this.updateSize(),t.position.y-=.05*this.mouseX,t.position.y=Math.max(Math.min(t.position.y,1600),-1600),t.lookAt(n.position),t.updateProjectionMatrix()}}}ngOnInit(){!this.canvas||!this.canvas.rendererCanvas||(this.shadowTexture=new US(this.canvas.rendererCanvas.nativeElement))}updateSize(){!this.canvas||!this.canvas.rendererCanvas||(this.canvasWidth=this.canvas.rendererCanvas.nativeElement.width,this.canvasHeight=this.canvas.rendererCanvas.nativeElement.height)}onMouseMove(t){if(!this.canvas||!this.canvas.rendererCanvas)return;const n=this.canvas.rendererCanvas.nativeElement.getBoundingClientRect();this.mouseX=t.clientX-n.left-n.width/2,this.mouseY=t.clientY-n.right-n.height/2}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["app-multi-view-postprocessing-example"]],viewQuery:function(t,n){if(1&t&&Pn(Upe,7),2&t){let r;Et(r=Rt())&&(n.canvas=r.first)}},hostBindings:function(t,n){1&t&&gt("mousemove",function(s){return n.onMouseMove(s)},!1,$m)},decls:32,vars:95,consts:[[3,"disableDefaultView","viewPort"],["thecanvas",""],["scene",""],[3,"position","args"],[3,"position","rotation"],[3,"args"],["geo",""],[3,"flatShading","shininess","specular","color"],["mat",""],[3,"position","rotation","geometry","material"],[3,"scene","viewPort","scissor","scissorTest","onRender"],["thview1",""],[3,"position","up","fov","aspect","near","far"],["camera1",""],[3,"clearColor"],[3,"strength"],[3,"args","uniforms"],[3,"scene","viewPort","scissor","scissorTest","clearColor","onRender"],["thview2",""],["camera2",""],["thview3",""],["camera3",""]],template:function(t,n){if(1&t){const r=Fo();me(0,"th-canvas",0,1)(2,"th-scene",null,2),Ze(4,"th-directionalLight",3),me(5,"th-mesh",4),Ze(6,"th-sphereGeometry",5,6)(8,"th-meshPhongMaterial",7,8),Te(),Ze(10,"th-mesh",9)(11,"th-mesh",9),Te(),me(12,"th-view",10,11),gt("onRender",function(){Vr(r);const o=yn(15),a=yn(3);return jr(n.view1.updateCamera(o.objRef,a.objRef))}),Ze(14,"th-perspectiveCamera",12,13),me(16,"th-effectComposer"),Ze(17,"th-renderPass",14)(18,"th-unrealBloomPass",15)(19,"th-shaderPass",16)(20,"th-glitchPass"),Te()(),me(21,"th-view",17,18),gt("onRender",function(){Vr(r);const o=yn(24),a=yn(3);return jr(n.view2.updateCamera(o.objRef,a.objRef))}),Ze(23,"th-perspectiveCamera",12,19),me(25,"th-effectComposer"),Ze(26,"th-renderPass")(27,"th-filmPass",5),Te()(),me(28,"th-view",17,20),gt("onRender",function(){Vr(r);const o=yn(31),a=yn(3);return jr(n.view3.updateCamera(o.objRef,a.objRef))}),Ze(30,"th-perspectiveCamera",12,21),Te()()}if(2&t){const r=yn(3),s=yn(7),o=yn(9),a=yn(13),l=yn(22),c=yn(29);Q("disableDefaultView",!0)("viewPort",ic(56,Vpe,.5*n.canvasWidth,n.canvasHeight)),se(4),Q("position",Ee(59,jpe))("args",Ee(60,zpe)),se(1),Q("position",Ee(61,Hpe))("rotation",Tn(62,P0,-n.Math.PI/2)),se(1),Q("args",Ee(64,Gpe)),se(2),Q("flatShading",!1)("shininess",30)("specular",Ee(65,Wpe))("color",Ee(66,Xpe)),se(2),Q("position",Tn(67,P0,-400))("rotation",Tn(69,P0,-n.Math.PI/2))("geometry",s.objRef)("material",o.objRef),se(1),Q("position",Ee(71,Kpe))("rotation",Tn(72,P0,-n.Math.PI/2))("geometry",s.objRef)("material",o.objRef),se(1),Q("scene",r)("viewPort",df(74,jC,n.view1.left*n.canvasWidth,n.view1.bottom*n.canvasHeight,n.view1.width*n.canvasWidth,n.view1.height*n.canvasHeight))("scissor",a.viewPort)("scissorTest",!0),se(2),Q("position",n.view1.eye)("up",n.view1.up)("fov",n.view1.fov)("aspect",n.view1.width*n.canvasWidth/(n.view1.height*n.canvasHeight))("near",1)("far",1e4),se(3),Q("clearColor",n.view1.background),se(1),Q("strength",.2),se(1),Q("args",Tn(79,qpe,n.RGBShiftShader))("uniforms",Tn(82,Ype,Ee(81,Zpe))),se(2),Q("scene",r)("viewPort",df(84,jC,n.view2.left*n.canvasWidth,n.view2.bottom*n.canvasHeight,n.view2.width*n.canvasWidth,n.view2.height*n.canvasHeight))("scissor",l.viewPort)("scissorTest",!0)("clearColor",n.view2.background),se(2),Q("position",n.view2.eye)("up",n.view2.up)("fov",n.view2.fov)("aspect",n.view2.width*n.canvasWidth/(n.view2.height*n.canvasHeight))("near",1)("far",1e4),se(4),Q("args",Ee(89,Qpe)),se(1),Q("scene",r)("viewPort",df(90,jC,n.view3.left*n.canvasWidth,n.view3.bottom*n.canvasHeight,n.view3.width*n.canvasWidth,n.view3.height*n.canvasHeight))("scissor",c.viewPort)("scissorTest",!0)("clearColor",n.view3.background),se(2),Q("position",n.view3.eye)("up",n.view3.up)("fov",n.view3.fov)("aspect",n.view3.width*n.canvasWidth/(n.view3.height*n.canvasHeight))("near",1)("far",1e4)}},dependencies:[Lr,vp,Ps,_r,Zh,VC,x0,Rce,Oce,gU,BU,zU,nr,xl],encapsulation:2,changeDetection:0}),i})(),sV=(()=>{class i{constructor(t,n){this._renderer=t,this._elementRef=n,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,n){this._renderer.setProperty(this._elementRef.nativeElement,t,n)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return i.\u0275fac=function(t){return new(t||i)(N(ha),N(Kt))},i.\u0275dir=tt({type:i}),i})(),tu=(()=>{class i extends sV{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275dir=tt({type:i,features:[Se]}),i})();const Ns=new He("NgValueAccessor"),Jpe={provide:Ns,useExisting:qe(()=>zC),multi:!0};let zC=(()=>{class i extends tu{writeValue(t){this.setProperty("checked",t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275dir=tt({type:i,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,n){1&t&&gt("change",function(s){return n.onChange(s.target.checked)})("blur",function(){return n.onTouched()})},features:[Xe([Jpe]),Se]}),i})();const eme={provide:Ns,useExisting:qe(()=>I0),multi:!0},nme=new He("CompositionEventMode");let I0=(()=>{class i extends sV{constructor(t,n,r){super(t,n),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function tme(){const i=Bo()?Bo().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return i.\u0275fac=function(t){return new(t||i)(N(ha),N(Kt),N(nme,8))},i.\u0275dir=tt({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,n){1&t&&gt("input",function(s){return n._handleInput(s.target.value)})("blur",function(){return n.onTouched()})("compositionstart",function(){return n._compositionStart()})("compositionend",function(s){return n._compositionEnd(s.target.value)})},features:[Xe([eme]),Se]}),i})();const br=new He("NgValidators"),Ll=new He("NgAsyncValidators");function mV(i){return null!=i}function gV(i){const e=ef(i)?_i(i):i;return Dx(e),e}function _V(i){let e={};return i.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function vV(i,e){return e.map(t=>t(i))}function yV(i){return i.map(e=>function rme(i){return!i.validate}(e)?e:t=>e.validate(t))}function HC(i){return null!=i?function bV(i){if(!i)return null;const e=i.filter(mV);return 0==e.length?null:function(t){return _V(vV(t,e))}}(yV(i)):null}function GC(i){return null!=i?function xV(i){if(!i)return null;const e=i.filter(mV);return 0==e.length?null:function(t){return B3(vV(t,e).map(gV)).pipe(xt(_V))}}(yV(i)):null}function wV(i,e){return null===i?[e]:Array.isArray(i)?[...i,e]:[i,e]}function WC(i){return i?Array.isArray(i)?i:[i]:[]}function L0(i,e){return Array.isArray(i)?i.includes(e):i===e}function TV(i,e){const t=WC(e);return WC(i).forEach(r=>{L0(t,r)||t.push(r)}),t}function CV(i,e){return WC(e).filter(t=>!L0(i,t))}class EV{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=HC(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=GC(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class kr extends EV{get formDirective(){return null}get path(){return null}}class Ol extends EV{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}let XC=(()=>{class i extends class RV{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}{constructor(t){super(t)}}return i.\u0275fac=function(t){return new(t||i)(N(Ol,2))},i.\u0275dir=tt({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,n){2&t&&mn("ng-untouched",n.isUntouched)("ng-touched",n.isTouched)("ng-pristine",n.isPristine)("ng-dirty",n.isDirty)("ng-valid",n.isValid)("ng-invalid",n.isInvalid)("ng-pending",n.isPending)},features:[Se]}),i})();const sm="VALID",k0="INVALID",xd="PENDING",om="DISABLED";function DV(i){return Array.isArray(i)?HC(i):i||null}function PV(i){return Array.isArray(i)?GC(i):i||null}function N0(i){return null!=i&&!Array.isArray(i)&&"object"==typeof i}function am(i,e){(function JC(i,e){const t=function MV(i){return i._rawValidators}(i);null!==e.validator?i.setValidators(wV(t,e.validator)):"function"==typeof t&&i.setValidators([t]);const n=function SV(i){return i._rawAsyncValidators}(i);null!==e.asyncValidator?i.setAsyncValidators(wV(n,e.asyncValidator)):"function"==typeof n&&i.setAsyncValidators([n]);const r=()=>i.updateValueAndValidity();V0(e._rawValidators,r),V0(e._rawAsyncValidators,r)})(i,e),e.valueAccessor.writeValue(i.value),i.disabled&&e.valueAccessor.setDisabledState?.(!0),function pme(i,e){e.valueAccessor.registerOnChange(t=>{i._pendingValue=t,i._pendingChange=!0,i._pendingDirty=!0,"change"===i.updateOn&&OV(i,e)})}(i,e),function gme(i,e){const t=(n,r)=>{e.valueAccessor.writeValue(n),r&&e.viewToModelUpdate(n)};i.registerOnChange(t),e._registerOnDestroy(()=>{i._unregisterOnChange(t)})}(i,e),function mme(i,e){e.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,"blur"===i.updateOn&&i._pendingChange&&OV(i,e),"submit"!==i.updateOn&&i.markAsTouched()})}(i,e),function fme(i,e){if(e.valueAccessor.setDisabledState){const t=n=>{e.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(t),e._registerOnDestroy(()=>{i._unregisterOnDisabledChange(t)})}}(i,e)}function V0(i,e){i.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function OV(i,e){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function UV(i,e){const t=i.indexOf(e);t>-1&&i.splice(t,1)}function VV(i){return"object"==typeof i&&null!==i&&2===Object.keys(i).length&&"value"in i&&"disabled"in i}const Sme={provide:Ol,useExisting:qe(()=>z0)},GV=(()=>Promise.resolve(null))();let z0=(()=>{class i extends Ol{constructor(t,n,r,s,o){super(),this._changeDetectorRef=o,this.control=new class extends class LV{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=DV(this._rawValidators),this._composedAsyncValidatorFn=PV(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===sm}get invalid(){return this.status===k0}get pending(){return this.status==xd}get disabled(){return this.status===om}get enabled(){return this.status!==om}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=DV(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=PV(e)}addValidators(e){this.setValidators(TV(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(TV(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(CV(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(CV(e,this._rawAsyncValidators))}hasValidator(e){return L0(this._rawValidators,e)}hasAsyncValidator(e){return L0(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=xd,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=om,this.errors=null,this._forEachChild(n=>{n.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=sm,this._forEachChild(n=>{n.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===sm||this.status===xd)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?om:sm}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=xd,this._hasOwnPendingAsyncValidator=!0;const t=gV(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((n,r)=>n&&n._find(r),this)}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new yt,this.statusChanges=new yt}_calculateStatus(){return this._allControlsDisabled()?om:this.errors?k0:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(xd)?xd:this._anyControlsHaveStatus(k0)?k0:sm}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){N0(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}}{constructor(e=null,t,n){super(function YC(i){return(N0(i)?i.validators:i)||null}(t),function QC(i,e){return(N0(e)?e.asyncValidators:i)||null}(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),N0(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=VV(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){UV(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){UV(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){VV(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},this._registered=!1,this.update=new yt,this._parent=t,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=function t1(i,e){if(!e)return null;let t,n,r;return Array.isArray(e),e.forEach(s=>{s.constructor===I0?t=s:function yme(i){return Object.getPrototypeOf(i.constructor)===tu}(s)?n=s:r=s}),r||n||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const n=t.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function e1(i,e){if(!i.hasOwnProperty("model"))return!1;const t=i.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){am(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){GV.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const n=t.isDisabled.currentValue,r=0!==n&&da(n);GV.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function B0(i,e){return[...e.path,i]}(t,this._parent):[t]}}return i.\u0275fac=function(t){return new(t||i)(N(kr,9),N(br,10),N(Ll,10),N(Ns,10),N(Ci,8))},i.\u0275dir=tt({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Xe([Sme]),Se,$i]}),i})(),XV=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({}),i})();const Ame={provide:Ns,useExisting:qe(()=>r1),multi:!0};let r1=(()=>{class i extends tu{writeValue(t){this.setProperty("value",parseFloat(t))}registerOnChange(t){this.onChange=n=>{t(""==n?null:parseFloat(n))}}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275dir=tt({type:i,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,n){1&t&&gt("change",function(s){return n.onChange(s.target.value)})("input",function(s){return n.onChange(s.target.value)})("blur",function(){return n.onTouched()})},features:[Xe([Ame]),Se]}),i})();const Ome={provide:Ns,useExisting:qe(()=>H0),multi:!0};function $V(i,e){return null==i?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${i}: ${e}`.slice(0,50))}let H0=(()=>{class i extends tu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const r=$V(this._getOptionId(t),t);this.setProperty("value",r)}registerOnChange(t){this.onChange=n=>{this.value=this._getOptionValue(n),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const n of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(n),t))return n;return null}_getOptionValue(t){const n=function kme(i){return i.split(":")[0]}(t);return this._optionMap.has(n)?this._optionMap.get(n):t}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275dir=tt({type:i,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,n){1&t&&gt("change",function(s){return n.onChange(s.target.value)})("blur",function(){return n.onTouched()})},inputs:{compareWith:"compareWith"},features:[Xe([Ome]),Se]}),i})(),JV=(()=>{class i{constructor(t,n,r){this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue($V(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(ha),N(H0,9))},i.\u0275dir=tt({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),i})();const Nme={provide:Ns,useExisting:qe(()=>l1),multi:!0};function ej(i,e){return null==i?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${i}: ${e}`.slice(0,50))}let l1=(()=>{class i extends tu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let n;if(this.value=t,Array.isArray(t)){const r=t.map(s=>this._getOptionId(s));n=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else n=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(n)}registerOnChange(t){this.onChange=n=>{const r=[],s=n.selectedOptions;if(void 0!==s){const o=s;for(let a=0;a<o.length;a++){const c=this._getOptionValue(o[a].value);r.push(c)}}else{const o=n.options;for(let a=0;a<o.length;a++){const l=o[a];if(l.selected){const c=this._getOptionValue(l.value);r.push(c)}}}this.value=r,t(r)}}_registerOption(t){const n=(this._idCounter++).toString();return this._optionMap.set(n,t),n}_getOptionId(t){for(const n of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(n)._value,t))return n;return null}_getOptionValue(t){const n=function Bme(i){return i.split(":")[0]}(t);return this._optionMap.has(n)?this._optionMap.get(n)._value:t}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275dir=tt({type:i,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,n){1&t&&gt("change",function(s){return n.onChange(s.target)})("blur",function(){return n.onTouched()})},inputs:{compareWith:"compareWith"},features:[Xe([Nme]),Se]}),i})(),tj=(()=>{class i{constructor(t,n,r){this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(ej(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(ej(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(ha),N(l1,9))},i.\u0275dir=tt({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),i})(),Kme=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[XV]}),i})(),qme=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[Kme]}),i})();function Qme(i,e){1&i&&Ze(0,"th-orbitControls")}function $me(i,e){1&i&&Ze(0,"th-mapControls")}function Jme(i,e){1&i&&Ze(0,"th-arcballControls")}function ege(i,e){1&i&&Ze(0,"th-transformControls",17),2&i&&(ii(),Q("object",yn(26).objRef))}const tge=function(i){return[i]},nge=function(i,e,t){return[i,e,t]};function ige(i,e){if(1&i&&Ze(0,"th-dragControls",10),2&i){ii();const t=yn(26),n=yn(30),r=yn(22);Q("args",xg(3,nge,Tn(1,tge,t.objRef),n.objRef,null==r.rendererCanvas?null:r.rendererCanvas.nativeElement))}}function rge(i,e){1&i&&Ze(0,"th-flyControls")}function sge(i,e){1&i&&Ze(0,"th-trackballControls")}function oge(i,e){1&i&&Ze(0,"th-firstPersonControls")}const age=function(){return[2,2,2]},lge=function(){return[1,1,1]},cge=function(){return[10,10]},hj=function(){return[10,10,10]},uge=function(){return[45,2,.1,100]},hge=function(){return[0,0,0]};let dge=(()=>{class i{constructor(){this.controlType="orbit",this.renderOnDemand=!0,this.selected=!1,this.glbPath=`${Pa}DamagedHelmet.glb`}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["app-on-demand-example"]],decls:39,vars:27,consts:[[1,"control-panel"],["id","ondemand","type","checkbox",3,"ngModel","ngModelChange"],["for","ondemand"],[1,"form-control",3,"ngModel","ngModelChange"],[1,"works-on-demand"],[1,"needs-loop"],[3,"thStats","renderOnDemand"],["canvas",""],["loadGLTF","",3,"url","scale","onClick"],["model",""],[3,"args"],[3,"position"],[3,"ngSwitch","args","position","lookAt"],["camera",""],[4,"ngSwitchCase"],[3,"object",4,"ngSwitchCase"],[3,"args",4,"ngSwitchCase"],[3,"object"]],template:function(t,n){1&t&&(me(0,"div",0)(1,"input",1),gt("ngModelChange",function(s){return n.renderOnDemand=s}),Te(),me(2,"label",2),Cn(3,"Render On-Demand"),Te(),me(4,"select",3),gt("ngModelChange",function(s){return n.controlType=s}),me(5,"option",4),Cn(6,"orbit"),Te(),me(7,"option",4),Cn(8,"map"),Te(),me(9,"option",4),Cn(10,"arcball"),Te(),me(11,"option",4),Cn(12,"transform"),Te(),me(13,"option",4),Cn(14,"drag"),Te(),me(15,"option",5),Cn(16,"fly"),Te(),me(17,"option",5),Cn(18,"trackball"),Te(),me(19,"option",5),Cn(20,"firstpersion"),Te()()(),me(21,"th-canvas",6,7)(23,"th-scene"),Ze(24,"th-ambientLight"),me(25,"th-object3D",8,9),gt("onClick",function(){return n.selected=!n.selected}),Te(),Ze(27,"th-gridHelper",10)(28,"th-pointLight",11),me(29,"th-perspectiveCamera",12,13),Sn(31,Qme,1,0,"th-orbitControls",14),Sn(32,$me,1,0,"th-mapControls",14),Sn(33,Jme,1,0,"th-arcballControls",14),Sn(34,ege,1,1,"th-transformControls",15),Sn(35,ige,1,7,"th-dragControls",16),Sn(36,rge,1,0,"th-flyControls",14),Sn(37,sge,1,0,"th-trackballControls",14),Sn(38,oge,1,0,"th-firstPersonControls",14),Te()()()),2&t&&(se(1),Q("ngModel",n.renderOnDemand),se(3),Q("ngModel",n.controlType),se(17),Q("thStats",!0)("renderOnDemand",n.renderOnDemand),se(4),Q("url",n.glbPath)("scale",n.selected?Ee(20,age):Ee(21,lge)),se(2),Q("args",Ee(22,cge)),se(1),Q("position",Ee(23,hj)),se(1),Q("ngSwitch",n.controlType)("args",Ee(24,uge))("position",Ee(25,hj))("lookAt",Ee(26,hge)),se(2),Q("ngSwitchCase","orbit"),se(1),Q("ngSwitchCase","map"),se(1),Q("ngSwitchCase","arcball"),se(1),Q("ngSwitchCase","transform"),se(1),Q("ngSwitchCase","drag"),se(1),Q("ngSwitchCase","fly"),se(1),Q("ngSwitchCase","trackball"),se(1),Q("ngSwitchCase","firstpersion"))},dependencies:[zg,M2,_ce,bce,Cce,Dce,Fce,Cp,Nce,Wce,Lr,on,zc,Wc,qo,_r,nr,Qh,Lv,UN,wp,JV,tj,zC,H0,XC,z0],styles:[".needs-loop[_ngcontent-%COMP%]{color:red}.works-on-demand[_ngcontent-%COMP%]{color:green}.control-panel[_ngcontent-%COMP%]{display:flex;gap:1em;margin:1em}"],changeDetection:0}),i})(),fge=(()=>{class i{transform(t){return Array.isArray(t)?new Ce(...t):new Ce(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275pipe=Qi({name:"color",type:i,pure:!0}),i})();const pge=["camera"],mge=function(){return["#72645b",2,15]},gge=function(i){return[0,i,0]},dj=function(i){return[i,0,0]},_ge=function(){return[40,40]},vge=function(){return{color:"#999999",specular:"#101010"}},yge=function(i){return[0,i,.3]},bge=function(){return[.001,.001,.001]},xge=function(){return{color:"#0055ff",flatShading:!0}},wge=function(){return["#443333","#111122"]},Mge=function(){return[1,1,1]},Sge=function(i){return[.5,1,i]},Tge=function(){return[35,2,1,15]};let Cge=(()=>{class i{constructor(){this.Math=Math,this.cameraPosition=new C(3,.15,3),this.assetPath=`${Pa}dolphins.ply`}onBeforeRender(){const t=5e-4*Date.now();this.camera&&(this.camera.position=new C(2.5*Math.sin(t),.15,2.5*Math.cos(t)),this.camera.lookAt=[0,.1,0])}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["app-plyloader-example"]],viewQuery:function(t,n){if(1&t&&Pn(pge,5),2&t){let r;Et(r=Rt())&&(n.camera=r.first)}},decls:17,vars:55,consts:[[3,"shadow","onRender"],[3,"background","fog"],[3,"position","rotation","receiveShadow"],[3,"args"],[3,"rotation","position","scale","castShadow","receiveShadow"],["loadPLY","",3,"url"],[3,"castShadow","position","color","intensity","shadowMapHeight","shadowMapWidth"],["camera",""]],template:function(t,n){1&t&&(me(0,"th-canvas",0),gt("onRender",function(){return n.onBeforeRender()}),me(1,"th-scene",1),xs(2,"color"),xs(3,"fog"),me(4,"th-mesh",2),Ze(5,"th-planeGeometry",3)(6,"th-meshPhongMaterial",3),Te(),me(7,"th-mesh",4),Ze(8,"th-bufferGeometry",5)(9,"th-meshStandardMaterial",3),Te(),Ze(10,"th-hemisphereLight",3)(11,"th-directionalLight",6),xs(12,"color"),Ze(13,"th-directionalLight",6),xs(14,"color"),Ze(15,"th-perspectiveCamera",3,7),Te()()),2&t&&(Q("shadow",!0),se(1),Q("background",ws(2,29,"#72645b"))("fog",ws(3,31,Ee(37,mge))),se(3),Q("position",Tn(38,gge,-.5))("rotation",Tn(40,dj,-n.Math.PI/2))("receiveShadow",!0),se(1),Q("args",Ee(42,_ge)),se(1),Q("args",Ee(43,vge)),se(1),Q("rotation",Tn(44,dj,-n.Math.PI/2))("position",Tn(46,yge,-.2))("scale",Ee(48,bge))("castShadow",!0)("receiveShadow",!0),se(1),Q("url",n.assetPath),se(1),Q("args",Ee(49,xge)),se(1),Q("args",Ee(50,wge)),se(1),Q("castShadow",!0)("position",Ee(51,Mge))("color",ws(12,33,"#ffffff"))("intensity",1.35)("shadowMapHeight",1024)("shadowMapWidth",1024),se(2),Q("castShadow",!0)("position",Tn(52,Sge,-1))("color",ws(14,35,"#ffaa00"))("intensity",1)("shadowMapHeight",1024)("shadowMapWidth",1024),se(2),Q("args",Ee(54,Tge)))},dependencies:[Lr,yT,vp,Ps,_r,iV,Zh,xo,bT,nr,Epe,fge,VN],encapsulation:2,changeDetection:0}),i})();const Ege=["object"],Rge=["light"];function Age(i,e){if(1&i&&(me(0,"th-mesh",14),Ze(1,"th-meshPhongMaterial",15),Te()),2&i){const t=e.$implicit;ii(),Q("geometry",yn(15).objRef)("position",t.pos)("rotation",t.rotation)("scale",t.scale),se(1),Q("flatShading",!0)("color",t.color)}}const Dge=function(i){return[i]},Pge=function(i){return{value:i}},Ige=function(i){return{amount:i}},Fge=function(){return["#ffffff"]},Lge=function(i){return[0,0,i]},Oge=function(){return["0x222222"]},kge=function(){return["0xffffff"]},Nge=function(){return[1,4,4]};let Bge=(()=>{class i{constructor(){this.DotScreenShader=DU,this.RGBShiftShader=rV,this.shiftAmount=.0015,this.zDist=400,this.meshData=[],this.initMeshData()}ngOnInit(){this.light?.position?.set(1,1,1)}initMeshData(){for(let t=0;t<100;t++){const n=50*Math.random();this.meshData.push({pos:new C(Math.random()-.5,Math.random()-.5,Math.random()-.5).normalize().multiplyScalar(Math.random()*this.zDist),rotation:new ph(2*Math.random(),2*Math.random(),2*Math.random()),scale:new C(n,n,n),color:new Ce(16777215*Math.random())})}}animate(){this.object?.objRef?.rotation&&(this.object.objRef.rotation.x+=.005,this.object.objRef.rotation.y+=.01)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["app-post-processing-example"]],viewQuery:function(t,n){if(1&t&&(Pn(Ege,7),Pn(Rge,7)),2&t){let r;Et(r=Rt())&&(n.object=r.first),Et(r=Rt())&&(n.light=r.first)}},decls:19,vars:30,consts:[["for","shift"],["id","shift","type","range",3,"ngModel","min","max","step","ngModelChange"],[3,"shadow","thStats","onRender"],["thecanvas",""],[3,"strength"],[3,"args","uniforms"],[3,"background"],[3,"position","fov","near","far"],[3,"color"],["light",""],[3,"args"],["geometry",""],["object",""],[3,"geometry","position","rotation","scale",4,"ngFor","ngForOf"],[3,"geometry","position","rotation","scale"],[3,"flatShading","color"]],template:function(t,n){1&t&&(me(0,"label",0),Cn(1,"Shift Amount"),Te(),me(2,"input",1),gt("ngModelChange",function(s){return n.shiftAmount=s}),Te(),me(3,"th-canvas",2,3),gt("onRender",function(){return n.animate()}),me(5,"th-effectComposer"),Ze(6,"th-renderPass")(7,"th-unrealBloomPass",4)(8,"th-shaderPass",5),Te(),me(9,"th-scene",6),Ze(10,"th-perspectiveCamera",7)(11,"th-ambientLight",8)(12,"th-directionalLight",8,9)(14,"th-sphereGeometry",10,11),me(16,"th-object3D",null,12),Sn(18,Age,2,6,"th-mesh",13),Te()()()),2&t&&(se(2),Q("ngModel",n.shiftAmount)("min",.0015)("max",.2)("step",.005),se(1),Q("shadow",!0)("thStats",!0),se(4),Q("strength",1),se(1),Q("args",Tn(18,Dge,n.RGBShiftShader))("uniforms",Tn(22,Ige,Tn(20,Pge,n.shiftAmount))),se(1),Q("background",Ee(24,Fge)),se(1),Q("position",Tn(25,Lge,n.zDist))("fov",70)("near",1)("far",1e3),se(1),Q("color",Ee(27,Oge)),se(1),Q("color",Ee(28,kge)),se(2),Q("args",Ee(29,Nge)),se(4),Q("ngForOf",n.meshData))},dependencies:[oc,Lr,on,vp,qo,Ps,_r,Zh,VC,x0,gU,BU,zU,nr,wp,I0,r1,XC,z0],styles:["label[_ngcontent-%COMP%]{margin-right:.5em}"],changeDetection:0}),i})(),Uge=(()=>{class i extends SN{getType(){return vN}set type(t){this._objRef&&(this._objRef.type=t)}set box(t){this._objRef&&(this._objRef.box=Ft(this._objRef.box,t))}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["th-box3Helper"]],inputs:{type:"type",box:"box"},features:[Xe([{provide:on,useExisting:qe(()=>i)}]),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();const u1=function(){return[0,0,0]},Vge=function(){return[2,2,2]},jge=function(){return[1,1,1]},zge=function(i,e){return[i,e]},Hge=function(){return[10,10]},fj=function(){return[10,10,10]},Gge=function(){return[45,2,.1,100]};let Wge=(()=>{class i extends Ps{constructor(t){super(t)}ngOnInit(){super.ngOnInit(),this.objRef&&(this.objRef.material=new vo({color:"green"}),this.objRef.geometry=new Xn(1,1,1))}}return i.\u0275fac=function(t){return new(t||i)(N(on,4))},i.\u0275cmp=De({type:i,selectors:[["th-box"]],features:[Xe(Xce(i)),Se],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),Xge=(()=>{class i{constructor(){this.THREE=Td,this.box=new Ho(new C(0,0,0),new C(1.5,1.5,1.5)),this.color=new Ce(1,0,0),this.rotation=[0,0,0],this.material=new vo,this.selected=!1,this.material.color.set("green"),setInterval(()=>{0!==this.material.color.r?(this.material=new vo,this.material.color.set("green")):(this.material=new vo,this.material.color.set("red"))},200)}onBeforeRender(){this.rotation=[0,this.rotation[2]+.01,this.rotation[2]+.01]}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["app-simple-example"]],decls:8,vars:24,consts:[[3,"onRender"],[3,"position","material","rotation","scale","onClick"],[3,"args","material","position"],[3,"args"],[3,"position"],[3,"args","position","lookAt"]],template:function(t,n){1&t&&(me(0,"th-canvas",0),gt("onRender",function(){return n.onBeforeRender()}),me(1,"th-scene"),Ze(2,"th-ambientLight"),me(3,"th-box",1),gt("onClick",function(){return n.selected=!n.selected}),Te(),Ze(4,"th-box3Helper",2)(5,"th-gridHelper",3)(6,"th-pointLight",4)(7,"th-perspectiveCamera",5),Te()()),2&t&&(se(3),Q("position",Ee(12,u1))("material",n.material)("rotation",n.rotation)("scale",n.selected?Ee(13,Vge):Ee(14,jge)),se(1),Q("args",ic(15,zge,n.box,n.color))("material",n.material)("position",Ee(18,u1)),se(1),Q("args",Ee(19,Hge)),se(1),Q("position",Ee(20,fj)),se(1),Q("args",Ee(21,Gge))("position",Ee(22,fj))("lookAt",Ee(23,u1)))},dependencies:[Lr,zc,Uge,Wc,qo,_r,nr,Lv,Wge],encapsulation:2,changeDetection:0}),i})();const Kge=["thecanvas"],qge=function(i,e,t,n){return{x:i,y:e,width:t,height:n}};function Zge(i,e){if(1&i){const t=Fo();me(0,"th-view",11,12),gt("onRender",function(){const s=Vr(t).$implicit,o=yn(3);ii();const a=yn(3);return jr(s.updateCamera(o.objRef,a.objRef))}),Ze(2,"th-perspectiveCamera",13,14),Te()}if(2&i){const t=e.$implicit,n=yn(1),r=ii();Q("scene",yn(3))("viewPort",df(11,qge,t.left*r.canvasWidth,t.bottom*r.canvasHeight,t.width*r.canvasWidth,t.height*r.canvasHeight))("scissor",n.viewPort)("scissorTest",!0)("clearColor",t.background),se(2),Q("position",t.eye)("up",t.up)("fov",t.fov)("aspect",t.width*r.canvasWidth/(t.height*r.canvasHeight))("near",1)("far",1e4)}}const Yge=function(i,e){return{x:0,y:0,width:i,height:e}},Qge=function(){return[0,0,1]},$ge=function(){return["#ffffff"]},Jge=function(){return[0,0,0]},G0=function(i){return[i,0,0]},e_e=function(){return[200,32,16]},t_e=function(){return["#fac400"]},n_e=function(){return["#f83f0d"]},i_e=function(){return[400,0,0]},W0=[{path:"basic-example",data:{title:"Basic Example",exampleComponent:Jie,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/basic-example/basic-example.component.ts"]}},{path:"simple-example",data:{title:"Simple Example",exampleComponent:Xge,declarations:["SimpleExampleComponent","Box"],codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/simple-example/simple-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/simple-example/simple-example.component.ts"]}},{path:"introductory-example",data:{title:"Introductory Example",exampleComponent:vle,declarations:["IntroductoryExampleComponent","Box"],codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/introductory-example/introductory-example.component.ts"]}},{path:"controls-example",data:{title:"Controls Example",exampleComponent:ore,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/controls-example/controls-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/controls-example/controls-example.component.ts"]}},{path:"loader-example",data:{title:"Loader Example",exampleComponent:Tle,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/loader-example/loader-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/loader-example/loader-example.component.ts"]}},{path:"dynamic loader-example",data:{title:"Dynamic Loader Example",exampleComponent:hre,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/dynamic-loader-example/dynamic-loader-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/dynamic-loader-example/dynamic-loader-example.component.ts"]}},{path:"events-example",data:{title:"Events Example",exampleComponent:gre,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/events-example/events-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/events-example/events-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/events-example/events-example.component.scss"]}},{path:"instanced-mesh-example",data:{title:"Instanced Mesh Example",exampleComponent:cle,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/instanced-mesh-example/instanced-mesh-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/instanced-mesh-example/instanced-mesh-example.component.ts"]}},{path:"post-processing-example",data:{title:"Post Processing Example",exampleComponent:Bge,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/post-processing-example/post-processing-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/post-processing-example/post-processing-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/post-processing-example/post-processing-example.component.scss"]}},{path:"views-example",data:{title:"Multiple Views Example",exampleComponent:(()=>{class i{constructor(){this.Math=Math,this.canvasWidth=128,this.canvasHeight=128,this.mouseX=0,this.mouseY=0,this.views=[{left:0,bottom:0,width:.5,height:1,background:new Ce(.5,.5,.7),eye:[0,300,1800],up:[0,1,0],fov:30,updateCamera:(t,n)=>{this.updateSize(),t.position.x+=.05*this.mouseX,t.position.x=Math.max(Math.min(t.position.x,2e3),-2e3),t.lookAt(n.position),t.updateProjectionMatrix()}},{left:.5,bottom:0,width:.5,height:.5,background:new Ce(.7,.5,.5),eye:[0,1800,0],up:[0,0,1],fov:45,updateCamera:(t,n)=>{this.updateSize(),t.position.x-=.05*this.mouseX,t.position.x=Math.max(Math.min(t.position.x,2e3),-2e3),t.lookAt(t.position.clone().setY(0)),t.updateProjectionMatrix()}},{left:.5,bottom:.5,width:.5,height:.5,background:new Ce(.5,.7,.7),eye:[1400,800,1400],up:[0,1,0],fov:60,updateCamera:(t,n)=>{this.updateSize(),t.position.y-=.05*this.mouseX,t.position.y=Math.max(Math.min(t.position.y,1600),-1600),t.lookAt(n.position),t.updateProjectionMatrix()}}]}ngOnInit(){!this.canvas||!this.canvas.rendererCanvas||(this.shadowTexture=new US(this.canvas.rendererCanvas.nativeElement))}animate(t){}updateSize(){!this.canvas||!this.canvas.rendererCanvas||(this.canvasWidth=this.canvas.rendererCanvas.nativeElement.width,this.canvasHeight=this.canvas.rendererCanvas.nativeElement.height)}onMouseMove(t){if(!this.canvas||!this.canvas.rendererCanvas)return;const n=this.canvas.rendererCanvas.nativeElement.getBoundingClientRect();this.mouseX=t.clientX-n.left-n.width/2,this.mouseY=t.clientY-n.right-n.height/2}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["app-views-example"]],viewQuery:function(t,n){if(1&t&&Pn(Kge,7),2&t){let r;Et(r=Rt())&&(n.canvas=r.first)}},hostBindings:function(t,n){1&t&&gt("mousemove",function(s){return n.onMouseMove(s)},!1,$m)},decls:13,vars:38,consts:[[3,"disableDefaultView","viewPort"],["thecanvas",""],["scene",""],[3,"position","args"],[3,"position","rotation"],[3,"args"],["geo",""],[3,"flatShading","shininess","specular","color"],["mat",""],[3,"position","rotation","geometry","material"],[3,"scene","viewPort","scissor","scissorTest","clearColor","onRender",4,"ngFor","ngForOf"],[3,"scene","viewPort","scissor","scissorTest","clearColor","onRender"],["thview",""],[3,"position","up","fov","aspect","near","far"],["camera",""]],template:function(t,n){if(1&t&&(me(0,"th-canvas",0,1)(2,"th-scene",null,2),Ze(4,"th-directionalLight",3),me(5,"th-mesh",4),Ze(6,"th-sphereGeometry",5,6)(8,"th-meshPhongMaterial",7,8),Te(),Ze(10,"th-mesh",9)(11,"th-mesh",9),Te(),Sn(12,Zge,4,16,"th-view",10),Te()),2&t){const r=yn(7),s=yn(9);Q("disableDefaultView",!0)("viewPort",ic(20,Yge,.5*n.canvasWidth,n.canvasHeight)),se(4),Q("position",Ee(23,Qge))("args",Ee(24,$ge)),se(1),Q("position",Ee(25,Jge))("rotation",Tn(26,G0,-n.Math.PI/2)),se(1),Q("args",Ee(28,e_e)),se(2),Q("flatShading",!1)("shininess",30)("specular",Ee(29,t_e))("color",Ee(30,n_e)),se(2),Q("position",Tn(31,G0,-400))("rotation",Tn(33,G0,-n.Math.PI/2))("geometry",r.objRef)("material",s.objRef),se(1),Q("position",Ee(35,i_e))("rotation",Tn(36,G0,-n.Math.PI/2))("geometry",r.objRef)("material",s.objRef),se(1),Q("ngForOf",n.views)}},dependencies:[oc,Lr,vp,Ps,_r,Zh,VC,nr,xl],changeDetection:0}),i})(),codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/views-example/views-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/views-example/views-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/views-example/views-example.component.scss"]}},{path:"multi-scene-example",data:{title:"Multiple Scenes Example",codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-scene-example/multi-scene-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-scene-example/multi-scene-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-scene-example/multi-scene-example.component.scss"],exampleComponent:Bpe}},{path:"multi-view-postprocessing-example",data:{title:"Multiple View Post Processing Example",exampleComponent:$pe,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-view-postprocessing-example/multi-view-postprocessing-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-view-postprocessing-example/multi-view-postprocessing-example.component.ts"]}},{path:"animation-example",data:{title:"Animation Example",exampleComponent:Zie,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/animation-example/animation-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/animation-example/animation-example.component.ts"]}},{path:"plyloader-example",data:{title:"PLY Loader Example",exampleComponent:Cge,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/plyloader-example/plyloader-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/plyloader-example/plyloader-example.component.ts"]}},{path:"on-demand-example",data:{title:"On-Demand Rendering Example",exampleComponent:dge,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/on-demand-example/on-demand-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/on-demand-example/on-demand-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/on-demand-example/on-demand-example.component.scss"]}}];W0.forEach(i=>i.component=Hae);const r_e=[];W0.forEach(i=>{r_e.push(i.component)});let s_e=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[nL.forRoot(W0),nL]}),i})();const a_e=["mat-button",""],l_e=["*"],u_e=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],h_e=Op(Lp(sd(class{constructor(i){this._elementRef=i}})));let d_e=(()=>{class i extends h_e{constructor(t,n,r){super(t),this._focusMonitor=n,this._animationMode=r,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const s of u_e)this._hasHostAttributes(s)&&this._getHostElement().classList.add(s);t.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t,n){t?this._focusMonitor.focusVia(this._getHostElement(),t,n):this._getHostElement().focus(n)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...t){return t.some(n=>this._getHostElement().hasAttribute(n))}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(Ip),N(Ar,8))},i.\u0275cmp=De({type:i,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(t,n){if(1&t&&Pn(od,5),2&t){let r;Et(r=Rt())&&(n.ripple=r.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(t,n){2&t&&(vi("disabled",n.disabled||null),mn("_mat-animation-noopable","NoopAnimations"===n._animationMode)("mat-button-disabled",n.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Se],attrs:a_e,ngContentSelectors:l_e,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(t,n){1&t&&(Ji(),me(0,"span",0),zn(1),Te(),Ze(2,"span",1)(3,"span",2)),2&t&&(se(2),mn("mat-button-ripple-round",n.isRoundButton||n.isIconButton),Q("matRippleDisabled",n._isRippleDisabled())("matRippleCentered",n.isIconButton)("matRippleTrigger",n._getHostElement()))},dependencies:[od],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}.mat-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}.cdk-high-contrast-active .mat-button-base.cdk-keyboard-focused,.cdk-high-contrast-active .mat-button-base.cdk-program-focused{outline:solid 3px}"],encapsulation:2,changeDetection:0}),i})(),h1=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[Gv,In,In]}),i})(),f_e=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[In,In]}),i})();const mj=["*"],m_e=[[["","mat-list-avatar",""],["","mat-list-icon",""],["","matListAvatar",""],["","matListIcon",""]],[["","mat-line",""],["","matLine",""]],"*"],g_e=["[mat-list-avatar], [mat-list-icon], [matListAvatar], [matListIcon]","[mat-line], [matLine]","*"],x_e=Lp(sd(class{})),w_e=sd(class{}),M_e=new He("MatList"),gj=new He("MatNavList");let S_e=(()=>{class i extends x_e{constructor(){super(...arguments),this._stateChanges=new Lt}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["mat-nav-list"]],hostAttrs:["role","navigation",1,"mat-nav-list","mat-list-base"],inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matNavList"],features:[Xe([{provide:gj,useExisting:i}]),Se,$i],ngContentSelectors:mj,decls:1,vars:0,template:function(t,n){1&t&&(Ji(),zn(0))},styles:['.mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}button.mat-list-item,button.mat-list-option{padding:0;width:100%;background:none;color:inherit;border:none;outline:inherit;-webkit-tap-highlight-color:rgba(0,0,0,0);text-align:left}[dir=rtl] button.mat-list-item,[dir=rtl] button.mat-list-option{text-align:right}button.mat-list-item::-moz-focus-inner,button.mat-list-option::-moz-focus-inner{border:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:rgba(0,0,0,0);width:100%;padding:0}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{display:block;top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:rgba(0,0,0,0);width:100%;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{display:block;top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:none}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:none}.mat-list-item-disabled{pointer-events:none}.cdk-high-contrast-active .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active :host .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active .mat-selection-list:focus{outline-style:dotted}.cdk-high-contrast-active .mat-list-option:hover,.cdk-high-contrast-active .mat-list-option:focus,.cdk-high-contrast-active .mat-nav-list .mat-list-item:hover,.cdk-high-contrast-active .mat-nav-list .mat-list-item:focus,.cdk-high-contrast-active mat-action-list .mat-list-item:hover,.cdk-high-contrast-active mat-action-list .mat-list-item:focus{outline:dotted 1px;z-index:1}.cdk-high-contrast-active .mat-list-single-selected-option::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active [dir=rtl] .mat-list-single-selected-option::after{right:auto;left:16px}@media(hover: none){.mat-list-option:not(.mat-list-single-selected-option):not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover{background:none}}'],encapsulation:2,changeDetection:0}),i})(),_j=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=tt({type:i,selectors:[["","mat-list-avatar",""],["","matListAvatar",""]],hostAttrs:[1,"mat-list-avatar"]}),i})(),vj=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=tt({type:i,selectors:[["","mat-list-icon",""],["","matListIcon",""]],hostAttrs:[1,"mat-list-icon"]}),i})(),T_e=(()=>{class i extends w_e{constructor(t,n,r,s){super(),this._element=t,this._isInteractiveList=!1,this._destroyed=new Lt,this._disabled=!1,this._isInteractiveList=!!(r||s&&"action-list"===s._getListType()),this._list=r||s;const o=this._getHostElement();"button"===o.nodeName.toLowerCase()&&!o.hasAttribute("type")&&o.setAttribute("type","button"),this._list&&this._list._stateChanges.pipe(Bn(this._destroyed)).subscribe(()=>{n.markForCheck()})}get disabled(){return this._disabled||!(!this._list||!this._list.disabled)}set disabled(t){this._disabled=ai(t)}ngAfterContentInit(){!function I3(i,e,t="mat"){i.changes.pipe(ma(i)).subscribe(({length:n})=>{kp(e,`${t}-2-line`,!1),kp(e,`${t}-3-line`,!1),kp(e,`${t}-multi-line`,!1),2===n||3===n?kp(e,`${t}-${n}-line`,!0):n>3&&kp(e,`${t}-multi-line`,!0)})}(this._lines,this._element)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_isRippleDisabled(){return!this._isInteractiveList||this.disableRipple||!(!this._list||!this._list.disableRipple)}_getHostElement(){return this._element.nativeElement}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(Ci),N(gj,8),N(M_e,8))},i.\u0275cmp=De({type:i,selectors:[["mat-list-item"],["a","mat-list-item",""],["button","mat-list-item",""]],contentQueries:function(t,n,r){if(1&t&&(pi(r,_j,5),pi(r,vj,5),pi(r,P3,5)),2&t){let s;Et(s=Rt())&&(n._avatar=s.first),Et(s=Rt())&&(n._icon=s.first),Et(s=Rt())&&(n._lines=s)}},hostAttrs:[1,"mat-list-item","mat-focus-indicator"],hostVars:4,hostBindings:function(t,n){2&t&&mn("mat-list-item-disabled",n.disabled)("mat-list-item-with-avatar",n._avatar||n._icon)},inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matListItem"],features:[Se],ngContentSelectors:g_e,decls:6,vars:2,consts:[[1,"mat-list-item-content"],["mat-ripple","",1,"mat-list-item-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-list-text"]],template:function(t,n){1&t&&(Ji(m_e),me(0,"span",0),Ze(1,"span",1),zn(2),me(3,"span",2),zn(4,1),Te(),zn(5,2),Te()),2&t&&(se(1),Q("matRippleTrigger",n._getHostElement())("matRippleDisabled",n._isRippleDisabled()))},dependencies:[od],encapsulation:2,changeDetection:0}),i})(),d1=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[F3,Gv,In,WT,Qa,F3,In,WT,f_e]}),i})();const P_e=["*",[["mat-toolbar-row"]]],I_e=["*","mat-toolbar-row"],F_e=Op(class{constructor(i){this._elementRef=i}});let L_e=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=tt({type:i,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),i})(),O_e=(()=>{class i extends F_e{constructor(t,n,r){super(t),this._platform=n,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(yr),N(Vt))},i.\u0275cmp=De({type:i,selectors:[["mat-toolbar"]],contentQueries:function(t,n,r){if(1&t&&pi(r,L_e,5),2&t){let s;Et(s=Rt())&&(n._toolbarRows=s)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(t,n){2&t&&mn("mat-toolbar-multiple-rows",n._toolbarRows.length>0)("mat-toolbar-single-row",0===n._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[Se],ngContentSelectors:I_e,decls:2,vars:0,template:function(t,n){1&t&&(Ji(P_e),zn(0),zn(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}"],encapsulation:2,changeDetection:0}),i})(),f1=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[In,In]}),i})();const X0=["*"],k_e=["content"];function N_e(i,e){if(1&i){const t=Fo();me(0,"div",2),gt("click",function(){return Vr(t),jr(ii()._onBackdropClicked())}),Te()}2&i&&mn("mat-drawer-shown",ii()._isShowingBackdrop())}function B_e(i,e){1&i&&(me(0,"mat-drawer-content"),zn(1,2),Te())}const U_e=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],V_e=["mat-drawer","mat-drawer-content","*"];function j_e(i,e){if(1&i){const t=Fo();me(0,"div",2),gt("click",function(){return Vr(t),jr(ii()._onBackdropClicked())}),Te()}2&i&&mn("mat-drawer-shown",ii()._isShowingBackdrop())}function z_e(i,e){1&i&&(me(0,"mat-sidenav-content"),zn(1,2),Te())}const H_e=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],G_e=["mat-sidenav","mat-sidenav-content","*"],bj={transformDrawer:Up("transform",[Na("open, open-instant",Or({transform:"none",visibility:"visible"})),Na("void",Or({"box-shadow":"none",visibility:"hidden"})),Ba("void => open-instant",Sl("0ms")),Ba("void <=> open, open-instant => void",Sl("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},X_e=new He("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function K_e(){return!1}}),p1=new He("MAT_DRAWER_CONTAINER");let K0=(()=>{class i extends zp{constructor(t,n,r,s,o){super(r,s,o),this._changeDetectorRef=t,this._container=n}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return i.\u0275fac=function(t){return new(t||i)(N(Ci),N(qe(()=>wj)),N(Kt),N(e0),N(Pt))},i.\u0275cmp=De({type:i,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(t,n){2&t&&tf("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[Xe([{provide:zp,useExisting:i}]),Se],ngContentSelectors:X0,decls:1,vars:0,template:function(t,n){1&t&&(Ji(),zn(0))},encapsulation:2,changeDetection:0}),i})(),xj=(()=>{class i{constructor(t,n,r,s,o,a,l,c){this._elementRef=t,this._focusTrapFactory=n,this._focusMonitor=r,this._platform=s,this._ngZone=o,this._interactivityChecker=a,this._doc=l,this._container=c,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new Lt,this._animationEnd=new Lt,this._animationState="void",this.openedChange=new yt(!0),this._openedStream=this.openedChange.pipe(Vi(u=>u),xt(()=>{})),this.openedStart=this._animationStarted.pipe(Vi(u=>u.fromState!==u.toState&&0===u.toState.indexOf("open")),Gw(void 0)),this._closedStream=this.openedChange.pipe(Vi(u=>!u),xt(()=>{})),this.closedStart=this._animationStarted.pipe(Vi(u=>u.fromState!==u.toState&&"void"===u.toState),Gw(void 0)),this._destroyed=new Lt,this.onPositionChanged=new yt,this._modeChanged=new Lt,this.openedChange.subscribe(u=>{u?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{Ml(this._elementRef.nativeElement,"keydown").pipe(Vi(u=>27===u.keyCode&&!this.disableClose&&!nd(u)),Bn(this._destroyed)).subscribe(u=>this._ngZone.run(()=>{this.close(),u.stopPropagation(),u.preventDefault()}))}),this._animationEnd.pipe(jT((u,h)=>u.fromState===h.fromState&&u.toState===h.toState)).subscribe(u=>{const{fromState:h,toState:d}=u;(0===d.indexOf("open")&&"void"===h||"void"===d&&0===h.indexOf("open"))&&this.openedChange.emit(this._opened)})}get position(){return this._position}set position(t){(t="end"===t?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(t),this._position=t,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(t){this._disableClose=ai(t)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(t){("true"===t||"false"===t||null==t)&&(t=ai(t)),this._autoFocus=t}get opened(){return this._opened}set opened(t){this.toggle(ai(t))}_forceFocus(t,n){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{t.removeEventListener("blur",r),t.removeEventListener("mousedown",r),t.removeAttribute("tabindex")};t.addEventListener("blur",r),t.addEventListener("mousedown",r)})),t.focus(n)}_focusByCssSelector(t,n){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,n)}_takeFocus(){if(!this._focusTrap)return;const t=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(n=>{!n&&"function"==typeof this._elementRef.nativeElement.focus&&t.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(t){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,t):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const t=this._doc.activeElement;return!!t&&this._elementRef.nativeElement.contains(t)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(t){return this.toggle(!0,t)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(t=!this.opened,n){t&&n&&(this._openedVia=n);const r=this._setOpen(t,!t&&this._isFocusWithinDrawer(),this._openedVia||"program");return t||(this._openedVia=null),r}_setOpen(t,n,r){return this._opened=t,t?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",n&&this._restoreFocus(r)),this._updateFocusTrapState(),new Promise(s=>{this.openedChange.pipe(Br(1)).subscribe(o=>s(o?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_updatePositionInParent(t){const n=this._elementRef.nativeElement,r=n.parentNode;"end"===t?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),r.insertBefore(this._anchor,n)),r.appendChild(n)):this._anchor&&this._anchor.parentNode.insertBefore(n,this._anchor)}}return i.\u0275fac=function(t){return new(t||i)(N(Kt),N(yse),N(Ip),N(yr),N(Pt),N(b3),N(Vt,8),N(p1,8))},i.\u0275cmp=De({type:i,selectors:[["mat-drawer"]],viewQuery:function(t,n){if(1&t&&Pn(k_e,5),2&t){let r;Et(r=Rt())&&(n._content=r.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(t,n){1&t&&Px("@transform.start",function(s){return n._animationStarted.next(s)})("@transform.done",function(s){return n._animationEnd.next(s)}),2&t&&(vi("align",null),kx("@transform",n._animationState),mn("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:X0,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,n){1&t&&(Ji(),me(0,"div",0,1),zn(2),Te())},dependencies:[zp],encapsulation:2,data:{animation:[bj.transformDrawer]},changeDetection:0}),i})(),wj=(()=>{class i{constructor(t,n,r,s,o,a=!1,l){this._dir=t,this._element=n,this._ngZone=r,this._changeDetectorRef=s,this._animationMode=l,this._drawers=new rc,this.backdropClick=new yt,this._destroyed=new Lt,this._doCheckSubject=new Lt,this._contentMargins={left:null,right:null},this._contentMarginChanges=new Lt,t&&t.change.pipe(Bn(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),o.change().pipe(Bn(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=a}get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(t){this._autosize=ai(t)}get hasBackdrop(){return this._backdropOverride??(!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode)}set hasBackdrop(t){this._backdropOverride=null==t?null:ai(t)}get scrollable(){return this._userContent||this._content}ngAfterContentInit(){this._allDrawers.changes.pipe(ma(this._allDrawers),Bn(this._destroyed)).subscribe(t=>{this._drawers.reset(t.filter(n=>!n._container||n._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(ma(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(t=>{this._watchDrawerToggle(t),this._watchDrawerPosition(t),this._watchDrawerMode(t)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(jv(10),Bn(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(t=>t.open())}close(){this._drawers.forEach(t=>t.close())}updateContentMargins(){let t=0,n=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._getWidth();else if("push"==this._left.mode){const r=this._left._getWidth();t+=r,n-=r}if(this._right&&this._right.opened)if("side"==this._right.mode)n+=this._right._getWidth();else if("push"==this._right.mode){const r=this._right._getWidth();n+=r,t-=r}t=t||null,n=n||null,(t!==this._contentMargins.left||n!==this._contentMargins.right)&&(this._contentMargins={left:t,right:n},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(t){t._animationStarted.pipe(Vi(n=>n.fromState!==n.toState),Bn(this._drawers.changes)).subscribe(n=>{"open-instant"!==n.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==t.mode&&t.openedChange.pipe(Bn(this._drawers.changes)).subscribe(()=>this._setContainerClass(t.opened))}_watchDrawerPosition(t){!t||t.onPositionChanged.pipe(Bn(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(Br(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(t){t&&t._modeChanged.pipe(Bn(lu(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(t){const n=this._element.nativeElement.classList,r="mat-drawer-container-has-open";t?n.add(r):n.remove(r)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(t=>{"end"==t.position?this._end=t:this._start=t}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(t=>t&&!t.disableClose&&this._canHaveBackdrop(t)).forEach(t=>t._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(t){return"side"!==t.mode||!!this._backdropOverride}_isDrawerOpen(t){return null!=t&&t.opened}}return i.\u0275fac=function(t){return new(t||i)(N(Fa,8),N(Kt),N(Pt),N(Ci),N(ad),N(X_e),N(Ar,8))},i.\u0275cmp=De({type:i,selectors:[["mat-drawer-container"]],contentQueries:function(t,n,r){if(1&t&&(pi(r,K0,5),pi(r,xj,5)),2&t){let s;Et(s=Rt())&&(n._content=s.first),Et(s=Rt())&&(n._allDrawers=s)}},viewQuery:function(t,n){if(1&t&&Pn(K0,5),2&t){let r;Et(r=Rt())&&(n._userContent=r.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,n){2&t&&mn("mat-drawer-container-explicit-backdrop",n._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[Xe([{provide:p1,useExisting:i}])],ngContentSelectors:V_e,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,n){1&t&&(Ji(U_e),Sn(0,N_e,1,2,"div",0),zn(1),zn(2,1),Sn(3,B_e,2,0,"mat-drawer-content",1)),2&t&&(Q("ngIf",n.hasBackdrop),se(3),Q("ngIf",!n._content))},dependencies:[$u,K0],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),i})(),m1=(()=>{class i extends K0{constructor(t,n,r,s,o){super(t,n,r,s,o)}}return i.\u0275fac=function(t){return new(t||i)(N(Ci),N(qe(()=>Sj)),N(Kt),N(e0),N(Pt))},i.\u0275cmp=De({type:i,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(t,n){2&t&&tf("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[Xe([{provide:zp,useExisting:i}]),Se],ngContentSelectors:X0,decls:1,vars:0,template:function(t,n){1&t&&(Ji(),zn(0))},encapsulation:2,changeDetection:0}),i})(),Mj=(()=>{class i extends xj{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(t){this._fixedInViewport=ai(t)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(t){this._fixedTopGap=Is(t)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(t){this._fixedBottomGap=Is(t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(t,n){2&t&&(vi("align",null),tf("top",n.fixedInViewport?n.fixedTopGap:null,"px")("bottom",n.fixedInViewport?n.fixedBottomGap:null,"px"),mn("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened)("mat-sidenav-fixed",n.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[Se],ngContentSelectors:X0,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,n){1&t&&(Ji(),me(0,"div",0,1),zn(2),Te())},dependencies:[zp],encapsulation:2,data:{animation:[bj.transformDrawer]},changeDetection:0}),i})(),Sj=(()=>{class i extends wj{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=pt(i)))(n||i)}}(),i.\u0275cmp=De({type:i,selectors:[["mat-sidenav-container"]],contentQueries:function(t,n,r){if(1&t&&(pi(r,m1,5),pi(r,Mj,5)),2&t){let s;Et(s=Rt())&&(n._content=s.first),Et(s=Rt())&&(n._allDrawers=s)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(t,n){2&t&&mn("mat-drawer-container-explicit-backdrop",n._backdropOverride)},exportAs:["matSidenavContainer"],features:[Xe([{provide:p1,useExisting:i}]),Se],ngContentSelectors:G_e,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,n){1&t&&(Ji(H_e),Sn(0,j_e,1,2,"div",0),zn(1),zn(2,1),Sn(3,z_e,2,0,"mat-sidenav-content",1)),2&t&&(Q("ngIf",n.hasBackdrop),se(3),Q("ngIf",!n._content))},dependencies:[$u,m1],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),i})(),q_e=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[Qa,In,Hp,Hp,In]}),i})();function Z_e(i,e){if(1&i&&(me(0,"a",10),Cn(1),Te()),2&i){const t=e.$implicit;Q("routerLink",t.path),se(1),rf(null==t.data?null:t.data.title)}}function Y_e(i,e){if(1&i){const t=Fo();me(0,"button",11),gt("click",function(){return Vr(t),ii(),jr(yn(2).toggle())}),me(1,"mat-icon",12),Cn(2,"menu"),Te()()}}function Q_e(i,e){if(1&i){const t=Fo();me(0,"button",13),gt("click",function(r){return Vr(t),jr(ii().editorService.toCodeSandbox(r))}),me(1,"mat-icon"),Cn(2,"crop_din"),Te(),Cn(3," CodeSandbox "),Te()}}function $_e(i,e){if(1&i){const t=Fo();me(0,"button",13),gt("click",function(r){return Vr(t),jr(ii().editorService.toStackblitz(r))}),me(1,"mat-icon"),Cn(2,"bolt"),Te(),Cn(3," Stackblitz "),Te()}}let J_e=(()=>{class i{constructor(t,n){this.breakpointObserver=t,this.editorService=n,this.routes=W0,this.isHandset$=this.breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)").pipe(xt(r=>r.matches),function o_e(i,e,t){let n,r=!1;return i&&"object"==typeof i?({bufferSize:n=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=i):n=i??1/0,Ay({connector:()=>new _T(n,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}())}}return i.\u0275fac=function(t){return new(t||i)(N(m3),N(Bv))},i.\u0275cmp=De({type:i,selectors:[["app-navigation-shell"]],decls:21,vars:15,consts:[[1,"sidenav-container"],["fixedInViewport","",1,"sidenav",3,"mode","opened"],["drawer",""],["mat-list-item","",3,"routerLink",4,"ngFor","ngForOf"],[1,"content"],["color","primary"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click",4,"ngIf"],[1,"toolbar-spacer"],["mat-button","","href","#",3,"click",4,"ngIf"],[1,"main-route-content"],["mat-list-item","",3,"routerLink"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click"],["aria-label","Side nav toggle icon"],["mat-button","","href","#",3,"click"]],template:function(t,n){1&t&&(me(0,"mat-sidenav-container",0)(1,"mat-sidenav",1,2),xs(3,"async"),xs(4,"async"),xs(5,"async"),me(6,"mat-toolbar"),Cn(7,"ngx-three"),Te(),me(8,"mat-nav-list"),Sn(9,Z_e,2,2,"a",3),Te()(),me(10,"mat-sidenav-content",4)(11,"mat-toolbar",5),Sn(12,Y_e,3,0,"button",6),xs(13,"async"),me(14,"span"),Cn(15,"ngx-three-demo"),Te(),Ze(16,"span",7),Sn(17,Q_e,4,0,"button",8),Sn(18,$_e,4,0,"button",8),Te(),me(19,"div",9),Ze(20,"router-outlet"),Te()()()),2&t&&(se(1),Q("mode",ws(4,9,n.isHandset$)?"over":"side")("opened",!1===ws(5,11,n.isHandset$)),vi("role",ws(3,7,n.isHandset$)?"dialog":"navigation"),se(8),Q("ngForOf",n.routes),se(3),Q("ngIf",ws(13,13,n.isHandset$)),se(5),Q("ngIf",n.editorService.urls.length),se(1),Q("ngIf",n.editorService.urls.length))},dependencies:[oc,$u,nM,d_,d_e,S_e,T_e,tB,O_e,Mj,Sj,m1,Dw],styles:[".sidenav-container[_ngcontent-%COMP%]{height:100%}.sidenav[_ngcontent-%COMP%]{width:200px}.sidenav[_ngcontent-%COMP%]   .mat-toolbar[_ngcontent-%COMP%]{background:inherit}.mat-toolbar.mat-primary[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1}.content[_ngcontent-%COMP%]{height:100vh}.main-route-content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:last-child{display:block;height:100%}.toolbar-spacer[_ngcontent-%COMP%]{flex:1 1 auto}"],changeDetection:0}),i})(),eve=(()=>{class i{constructor(){this.title="ngx-three-demo"}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=De({type:i,selectors:[["app-root"]],decls:1,vars:0,template:function(t,n){1&t&&Ze(0,"app-navigation-shell")},dependencies:[J_e]}),i})();const Tj=s3();class tve{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=Ii(-this._previousScrollPosition.left),e.style.top=Ii(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,n=e.style,r=this._document.body.style,s=n.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,n.left=this._previousHTMLStyles.left,n.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),Tj&&(n.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),Tj&&(n.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,n=this._viewportRuler.getViewportSize();return t.scrollHeight>n.height||t.scrollWidth>n.width}}class nve{constructor(e,t,n,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=n,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class Cj{enable(){}disable(){}attach(){}}function g1(i,e){return e.some(t=>i.bottom<t.top||i.top>t.bottom||i.right<t.left||i.left>t.right)}function Ej(i,e){return e.some(t=>i.top<t.top||i.bottom>t.bottom||i.left<t.left||i.right>t.right)}class ive{constructor(e,t,n,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=n,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:n,height:r}=this._viewportRuler.getViewportSize();g1(t,[{width:n,height:r,bottom:r,right:n,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let rve=(()=>{class i{constructor(t,n,r,s){this._scrollDispatcher=t,this._viewportRuler=n,this._ngZone=r,this.noop=()=>new Cj,this.close=o=>new nve(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new tve(this._viewportRuler,this._document),this.reposition=o=>new ive(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}}return i.\u0275fac=function(t){return new(t||i)(re(e0),re(ad),re(Pt),re(Vt))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class sve{constructor(e){if(this.scrollStrategy=new Cj,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const n of t)void 0!==e[n]&&(this[n]=e[n])}}}class ove{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let Rj=(()=>{class i{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const n=this._attachedOverlays.indexOf(t);n>-1&&this._attachedOverlays.splice(n,1),0===this._attachedOverlays.length&&this.detach()}}return i.\u0275fac=function(t){return new(t||i)(re(Vt))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),ave=(()=>{class i extends Rj{constructor(t,n){super(t),this._ngZone=n,this._keydownListener=r=>{const s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){const a=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>a.next(r)):a.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return i.\u0275fac=function(t){return new(t||i)(re(Vt),re(Pt,8))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),lve=(()=>{class i extends Rj{constructor(t,n,r){super(t),this._platform=n,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=qc(s)},this._clickListener=s=>{const o=qc(s),a="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;const l=this._attachedOverlays.slice();for(let c=l.length-1;c>-1;c--){const u=l[c];if(u._outsidePointerEvents.observers.length<1||!u.hasAttached())continue;if(u.overlayElement.contains(o)||u.overlayElement.contains(a))break;const h=u._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>h.next(s)):h.next(s)}}}add(t){if(super.add(t),!this._isAttached){const n=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(n)):this._addEventListeners(n),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=n.style.cursor,n.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}}return i.\u0275fac=function(t){return new(t||i)(re(Vt),re(yr),re(Pt,8))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Aj=(()=>{class i{constructor(t,n){this._platform=n,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||LT()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const n=this._document.createElement("div");n.classList.add(t),LT()?n.setAttribute("platform","test"):this._platform.isBrowser||n.setAttribute("platform","server"),this._document.body.appendChild(n),this._containerElement=n}}return i.\u0275fac=function(t){return new(t||i)(re(Vt),re(yr))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class cve{constructor(e,t,n,r,s,o,a,l,c,u=!1){this._portalOutlet=e,this._host=t,this._pane=n,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=l,this._outsideClickDispatcher=c,this._animationsDisabled=u,this._backdropElement=null,this._backdropClick=new Lt,this._attachments=new Lt,this._detachments=new Lt,this._locationChanges=$n.EMPTY,this._backdropClickHandler=h=>this._backdropClick.next(h),this._backdropTransitionendHandler=h=>{this._disposeBackdrop(h.target)},this._keydownEvents=new Lt,this._outsidePointerEvents=new Lt,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Br(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=Ii(this._config.width),e.height=Ii(this._config.height),e.minWidth=Ii(this._config.minWidth),e.minHeight=Ii(this._config.minHeight),e.maxWidth=Ii(this._config.maxWidth),e.maxHeight=Ii(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,n){const r=zv(t||[]).filter(s=>!!s);r.length&&(n?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(Bn(lu(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const Dj="cdk-overlay-connected-position-bounding-box",uve=/([A-Za-z%]+)$/;class hve{constructor(e,t,n,r,s){this._viewportRuler=t,this._document=n,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Lt,this._resizeSubscription=$n.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}get positions(){return this._preferredPositions}attach(e){this._validatePositions(),e.hostElement.classList.add(Dj),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,n=this._viewportRect,r=this._containerRect,s=[];let o;for(let a of this._preferredPositions){let l=this._getOriginPoint(e,r,a),c=this._getOverlayPoint(l,t,a),u=this._getOverlayFit(c,t,n,a);if(u.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(a,l);this._canFitWithFlexibleDimensions(u,c,n)?s.push({position:a,origin:l,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(l,a)}):(!o||o.overlayFit.visibleArea<u.visibleArea)&&(o={overlayFit:u,overlayPoint:c,originPoint:l,position:a,overlayRect:t})}if(s.length){let a=null,l=-1;for(const c of s){const u=c.boundingBoxRect.width*c.boundingBoxRect.height*(c.position.weight||1);u>l&&(l=u,a=c)}return this._isPushed=!1,void this._applyPosition(a.position,a.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&iu(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(Dj),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,n){let r,s;if("center"==n.originX)r=e.left+e.width/2;else{const o=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;r="start"==n.originX?o:a}return t.left<0&&(r-=t.left),s="center"==n.originY?e.top+e.height/2:"top"==n.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,n){let r,s;return r="center"==n.overlayX?-t.width/2:"start"===n.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==n.overlayY?-t.height/2:"top"==n.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,n,r){const s=Ij(t);let{x:o,y:a}=e,l=this._getOffset(r,"x"),c=this._getOffset(r,"y");l&&(o+=l),c&&(a+=c);let d=0-a,f=a+s.height-n.height,p=this._subtractOverflows(s.width,0-o,o+s.width-n.width),m=this._subtractOverflows(s.height,d,f),g=p*m;return{visibleArea:g,isCompletelyWithinViewport:s.width*s.height===g,fitsInViewportVertically:m===s.height,fitsInViewportHorizontally:p==s.width}}_canFitWithFlexibleDimensions(e,t,n){if(this._hasFlexibleDimensions){const r=n.bottom-t.y,s=n.right-t.x,o=Pj(this._overlayRef.getConfig().minHeight),a=Pj(this._overlayRef.getConfig().minWidth),c=e.fitsInViewportHorizontally||null!=a&&a<=s;return(e.fitsInViewportVertically||null!=o&&o<=r)&&c}return!1}_pushOverlayOnScreen(e,t,n){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=Ij(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),a=Math.max(e.y+r.height-s.height,0),l=Math.max(s.top-n.top-e.y,0),c=Math.max(s.left-n.left-e.x,0);let u=0,h=0;return u=r.width<=s.width?c||-o:e.x<this._viewportMargin?s.left-n.left-e.x:0,h=r.height<=s.height?l||-a:e.y<this._viewportMargin?s.top-n.top-e.y:0,this._previousPushAmount={x:u,y:h},{x:e.x+u,y:e.y+h}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const n=this._getScrollVisibility(),r=new ove(e,n);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let n,r=e.overlayY;n="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${n} ${r}`}_calculateBoundingBoxRect(e,t){const n=this._viewportRect,r=this._isRtl();let s,o,a,u,h,d;if("top"===t.overlayY)o=e.y,s=n.height-o+this._viewportMargin;else if("bottom"===t.overlayY)a=n.height-e.y+2*this._viewportMargin,s=n.height-a+this._viewportMargin;else{const f=Math.min(n.bottom-e.y+n.top,e.y),p=this._lastBoundingBoxSize.height;s=2*f,o=e.y-f,s>p&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-p/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)d=n.width-e.x+this._viewportMargin,u=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)h=e.x,u=n.right-e.x;else{const f=Math.min(n.right-e.x+n.left,e.x),p=this._lastBoundingBoxSize.width;u=2*f,h=e.x-f,u>p&&!this._isInitialRender&&!this._growAfterOpen&&(h=e.x-p/2)}return{top:o,left:h,bottom:a,right:d,width:u,height:s}}_setBoundingBoxStyles(e,t){const n=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=Ii(n.height),r.top=Ii(n.top),r.bottom=Ii(n.bottom),r.width=Ii(n.width),r.left=Ii(n.left),r.right=Ii(n.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=Ii(s)),o&&(r.maxWidth=Ii(o))}this._lastBoundingBoxSize=n,iu(this._boundingBox.style,r)}_resetBoundingBoxStyles(){iu(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){iu(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const n={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const u=this._viewportRuler.getViewportScrollPosition();iu(n,this._getExactOverlayY(t,e,u)),iu(n,this._getExactOverlayX(t,e,u))}else n.position="static";let a="",l=this._getOffset(t,"x"),c=this._getOffset(t,"y");l&&(a+=`translateX(${l}px) `),c&&(a+=`translateY(${c}px)`),n.transform=a.trim(),o.maxHeight&&(r?n.maxHeight=Ii(o.maxHeight):s&&(n.maxHeight="")),o.maxWidth&&(r?n.maxWidth=Ii(o.maxWidth):s&&(n.maxWidth="")),iu(this._pane.style,n)}_getExactOverlayY(e,t,n){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,n)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=Ii(s.y),r}_getExactOverlayX(e,t,n){let o,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,n)),o=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===o?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=Ii(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),n=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Ej(e,n),isOriginOutsideView:g1(e,n),isOverlayClipped:Ej(t,n),isOverlayOutsideView:g1(t,n)}}_subtractOverflows(e,...t){return t.reduce((n,r)=>n-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+e-this._viewportMargin,bottom:n.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?e.offsetX??this._offsetX:e.offsetY??this._offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&zv(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof Kt)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,n=e.height||0;return{top:e.y,bottom:e.y+n,left:e.x,right:e.x+t,height:n,width:t}}}function iu(i,e){for(let t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}function Pj(i){if("number"!=typeof i&&null!=i){const[e,t]=i.split(uve);return t&&"px"!==t?null:parseFloat(e)}return i||null}function Ij(i){return{top:Math.floor(i.top),right:Math.floor(i.right),bottom:Math.floor(i.bottom),left:Math.floor(i.left),width:Math.floor(i.width),height:Math.floor(i.height)}}const Fj="cdk-global-overlay-wrapper";class dve{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(Fj),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:a}=n,l=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),c=!("100%"!==s&&"100vh"!==s||a&&"100%"!==a&&"100vh"!==a),u=this._xPosition,h=this._xOffset,d="rtl"===this._overlayRef.getConfig().direction;let f="",p="",m="";l?m="flex-start":"center"===u?(m="center",d?p=h:f=h):d?"left"===u||"end"===u?(m="flex-end",f=h):("right"===u||"start"===u)&&(m="flex-start",p=h):"left"===u||"start"===u?(m="flex-start",f=h):("right"===u||"end"===u)&&(m="flex-end",p=h),e.position=this._cssPosition,e.marginLeft=l?"0":f,e.marginTop=c?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=l?"0":p,t.justifyContent=m,t.alignItems=c?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,n=t.style;t.classList.remove(Fj),n.justifyContent=n.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let fve=(()=>{class i{constructor(t,n,r,s){this._viewportRuler=t,this._document=n,this._platform=r,this._overlayContainer=s}global(){return new dve}flexibleConnectedTo(t){return new hve(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return i.\u0275fac=function(t){return new(t||i)(re(ad),re(Vt),re(yr),re(Aj))},i.\u0275prov=We({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),pve=0,_1=(()=>{class i{constructor(t,n,r,s,o,a,l,c,u,h,d,f){this.scrollStrategies=t,this._overlayContainer=n,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=a,this._ngZone=l,this._document=c,this._directionality=u,this._location=h,this._outsideClickDispatcher=d,this._animationsModuleType=f}create(t){const n=this._createHostElement(),r=this._createPaneElement(n),s=this._createPortalOutlet(r),o=new sve(t);return o.direction=o.direction||this._directionality.value,new cve(s,n,r,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const n=this._document.createElement("div");return n.id="cdk-overlay-"+pve++,n.classList.add("cdk-overlay-pane"),t.appendChild(n),n}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(vf)),new yoe(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return i.\u0275fac=function(t){return new(t||i)(re(rve),re(Aj),re(qa),re(fve),re(ave),re(Xi),re(Pt),re(Vt),re(Fa),re(Ig),re(lve),re(Ar,8))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();const _ve={provide:new He("cdk-connected-overlay-scroll-strategy"),deps:[_1],useFactory:function gve(i){return()=>i.scrollStrategies.reposition()}};let vve=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({providers:[_1,_ve],imports:[Fp,sB,pB,pB]}),i})(),Mve=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[Qa,In,zT,In]}),i})();const Rve={provide:new He("mat-select-scroll-strategy"),deps:[_1],useFactory:function Eve(i){return()=>i.scrollStrategies.reposition()}};let Oj=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({providers:[Rve],imports:[Qa,vve,N3,In,Hp,Mve,N3,In]}),i})(),Bj=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[Qa,In,In]}),i})();const Uve=[h1,d1,$T,nB,f1,Oj,SB,Bj];let Vve=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({imports:[Uve,h1,d1,$T,nB,f1,Oj,SB,Bj]}),i})();const an=!1;function Uj(i){return new et(3e3,an)}function x0e(){return typeof window<"u"&&typeof window.document<"u"}function y1(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function kl(i){switch(i.length){case 0:return new Vp;case 1:return i[0];default:return new hB(i)}}function Vj(i,e,t,n,r=new Map,s=new Map){const o=[],a=[];let l=-1,c=null;if(n.forEach(u=>{const h=u.get("offset"),d=h==l,f=d&&c||new Map;u.forEach((p,m)=>{let g=m,_=p;if("offset"!==m)switch(g=e.normalizePropertyName(g,o),_){case"!":_=r.get(m);break;case ka:_=s.get(m);break;default:_=e.normalizeStyleValue(m,g,_,o)}f.set(g,_)}),d||a.push(f),c=f,l=h}),o.length)throw function c0e(i){return new et(3502,an)}();return a}function b1(i,e,t,n){switch(e){case"start":i.onStart(()=>n(t&&x1(t,"start",i)));break;case"done":i.onDone(()=>n(t&&x1(t,"done",i)));break;case"destroy":i.onDestroy(()=>n(t&&x1(t,"destroy",i)))}}function x1(i,e,t){const s=w1(i.element,i.triggerName,i.fromState,i.toState,e||i.phaseName,t.totalTime??i.totalTime,!!t.disabled),o=i._data;return null!=o&&(s._data=o),s}function w1(i,e,t,n,r="",s=0,o){return{element:i,triggerName:e,fromState:t,toState:n,phaseName:r,totalTime:s,disabled:!!o}}function ps(i,e,t){let n=i.get(e);return n||i.set(e,n=t),n}function jj(i){const e=i.indexOf(":");return[i.substring(1,e),i.slice(e+1)]}let M1=(i,e)=>!1,zj=(i,e,t)=>[],Hj=null;function S1(i){const e=i.parentNode||i.host;return e===Hj?null:e}(y1()||typeof Element<"u")&&(x0e()?(Hj=(()=>document.documentElement)(),M1=(i,e)=>{for(;e;){if(e===i)return!0;e=S1(e)}return!1}):M1=(i,e)=>i.contains(e),zj=(i,e,t)=>{if(t)return Array.from(i.querySelectorAll(e));const n=i.querySelector(e);return n?[n]:[]});let ru=null,Gj=!1;const Wj=M1,Xj=zj;let Kj=(()=>{class i{validateStyleProperty(t){return function M0e(i){ru||(ru=function S0e(){return typeof document<"u"?document.body:null}()||{},Gj=!!ru.style&&"WebkitAppearance"in ru.style);let e=!0;return ru.style&&!function w0e(i){return"ebkit"==i.substring(1,6)}(i)&&(e=i in ru.style,!e&&Gj&&(e="Webkit"+i.charAt(0).toUpperCase()+i.slice(1)in ru.style)),e}(t)}matchesElement(t,n){return!1}containsElement(t,n){return Wj(t,n)}getParentElement(t){return S1(t)}query(t,n,r){return Xj(t,n,r)}computeStyle(t,n,r){return r||""}animate(t,n,r,s,o,a=[],l){return new Vp(r,s)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})(),T1=(()=>{class i{}return i.NOOP=new Kj,i})();const C1="ng-enter",Z0="ng-leave",Y0="ng-trigger",Q0=".ng-trigger",Zj="ng-animating",E1=".ng-animating";function Nl(i){if("number"==typeof i)return i;const e=i.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:R1(parseFloat(e[1]),e[2])}function R1(i,e){return"s"===e?1e3*i:i}function $0(i,e,t){return i.hasOwnProperty("duration")?i:function E0e(i,e,t){let r,s=0,o="";if("string"==typeof i){const a=i.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(Uj()),{duration:0,delay:0,easing:""};r=R1(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=R1(parseFloat(l),a[4]));const c=a[5];c&&(o=c)}else r=i;if(!t){let a=!1,l=e.length;r<0&&(e.push(function jve(){return new et(3100,an)}()),a=!0),s<0&&(e.push(function zve(){return new et(3101,an)}()),a=!0),a&&e.splice(l,0,Uj())}return{duration:r,delay:s,easing:o}}(i,e,t)}function um(i,e={}){return Object.keys(i).forEach(t=>{e[t]=i[t]}),e}function Yj(i){const e=new Map;return Object.keys(i).forEach(t=>{e.set(t,i[t])}),e}function Bl(i,e=new Map,t){if(t)for(let[n,r]of t)e.set(n,r);for(let[n,r]of i)e.set(n,r);return e}function $j(i,e,t){return t?e+":"+t+";":""}function Jj(i){let e="";for(let t=0;t<i.style.length;t++){const n=i.style.item(t);e+=$j(0,n,i.style.getPropertyValue(n))}for(const t in i.style)i.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=$j(0,P0e(t),i.style[t]));i.setAttribute("style",e)}function Jo(i,e,t){i.style&&(e.forEach((n,r)=>{const s=D1(r);t&&!t.has(r)&&t.set(r,i.style[s]),i.style[s]=n}),y1()&&Jj(i))}function su(i,e){i.style&&(e.forEach((t,n)=>{const r=D1(n);i.style[r]=""}),y1()&&Jj(i))}function hm(i){return Array.isArray(i)?1==i.length?i[0]:cB(i):i}const A1=new RegExp("{{\\s*(.+?)\\s*}}","g");function e4(i){let e=[];if("string"==typeof i){let t;for(;t=A1.exec(i);)e.push(t[1]);A1.lastIndex=0}return e}function J0(i,e,t){const n=i.toString(),r=n.replace(A1,(s,o)=>{let a=e[o];return null==a&&(t.push(function Gve(i){return new et(3003,an)}()),a=""),a.toString()});return r==n?i:r}function ey(i){const e=[];let t=i.next();for(;!t.done;)e.push(t.value),t=i.next();return e}const D0e=/-+([a-z0-9])/g;function D1(i){return i.replace(D0e,(...e)=>e[1].toUpperCase())}function P0e(i){return i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function ms(i,e,t){switch(e.type){case 7:return i.visitTrigger(e,t);case 0:return i.visitState(e,t);case 1:return i.visitTransition(e,t);case 2:return i.visitSequence(e,t);case 3:return i.visitGroup(e,t);case 4:return i.visitAnimate(e,t);case 5:return i.visitKeyframes(e,t);case 6:return i.visitStyle(e,t);case 8:return i.visitReference(e,t);case 9:return i.visitAnimateChild(e,t);case 10:return i.visitAnimateRef(e,t);case 11:return i.visitQuery(e,t);case 12:return i.visitStagger(e,t);default:throw function Wve(i){return new et(3004,an)}()}}function t4(i,e){return window.getComputedStyle(i)[e]}function N0e(i,e){const t=[];return"string"==typeof i?i.split(/\s*,\s*/).forEach(n=>function B0e(i,e,t){if(":"==i[0]){const l=function U0e(i,e){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function s0e(i){return new et(3016,an)}()),"* => *"}}(i,t);if("function"==typeof l)return void e.push(l);i=l}const n=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function r0e(i){return new et(3015,an)}()),e;const r=n[1],s=n[2],o=n[3];e.push(n4(r,o));"<"==s[0]&&!("*"==r&&"*"==o)&&e.push(n4(o,r))}(n,t,e)):t.push(i),t}const ry=new Set(["true","1"]),sy=new Set(["false","0"]);function n4(i,e){const t=ry.has(i)||sy.has(i),n=ry.has(e)||sy.has(e);return(r,s)=>{let o="*"==i||i==r,a="*"==e||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?ry.has(i):sy.has(i)),!a&&n&&"boolean"==typeof s&&(a=s?ry.has(e):sy.has(e)),o&&a}}const V0e=new RegExp("s*:selfs*,?","g");function P1(i,e,t,n){return new j0e(i).build(e,t,n)}class j0e{constructor(e){this._driver=e}build(e,t,n){const r=new G0e(t);return this._resetContextStyleTimingState(r),ms(this,hm(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function Kve(){return new et(3006,an)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,s.push(this.visitState(l,t))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,t);n+=l.queryCount,r+=l.depCount,o.push(l)}else t.errors.push(function qve(){return new et(3007,an)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:n,depCount:r,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){const s=new Set,o=r||{};n.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{e4(l).forEach(c=>{o.hasOwnProperty(c)||s.add(c)})})}),s.size&&(ey(s.values()),t.errors.push(function Zve(i,e){return new et(3008,an)}()))}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=ms(this,hm(e.animation),t);return{type:1,matchers:N0e(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:ou(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>ms(this,n,t)),options:ou(e.options)}}visitGroup(e,t){const n=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=n;const a=ms(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:3,steps:s,options:ou(e.options)}}visitAnimate(e,t){const n=function X0e(i,e){if(i.hasOwnProperty("duration"))return i;if("number"==typeof i)return I1($0(i,e).duration,0,"");const t=i;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=I1(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=$0(t,e);return I1(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let r,s=e.styles?e.styles:Or({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const c={};n.easing&&(c.easing=n.easing),o=Or(c)}t.currentTime+=n.duration+n.delay;const l=this.visitStyle(o,t);l.isEmptyStep=a,r=l}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of r)"string"==typeof a?a===ka?n.push(a):t.errors.push(new et(3002,an)):n.push(Yj(a));let s=!1,o=null;return n.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let l of a.values())if(l.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:n,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;n&&s>0&&(s-=n.duration+n.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,l)=>{const c=t.collectedStyles.get(t.currentQuerySelector),u=c.get(l);let h=!0;u&&(s!=r&&s>=u.startTime&&r<=u.endTime&&(t.errors.push(function Qve(i,e,t,n,r){return new et(3010,an)}()),h=!1),s=u.startTime),h&&c.set(l,{startTime:s,endTime:r}),t.options&&function A0e(i,e,t){const n=e.params||{},r=e4(i);r.length&&r.forEach(s=>{n.hasOwnProperty(s)||t.push(function Hve(i){return new et(3001,an)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function $ve(){return new et(3011,an)}()),n;let s=0;const o=[];let a=!1,l=!1,c=0;const u=e.steps.map(_=>{const v=this._makeStyleAst(_,t);let y=null!=v.offset?v.offset:function W0e(i){if("string"==typeof i)return null;let e=null;if(Array.isArray(i))i.forEach(t=>{if(t instanceof Map&&t.has("offset")){const n=t;e=parseFloat(n.get("offset")),n.delete("offset")}});else if(i instanceof Map&&i.has("offset")){const t=i;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(v.styles),b=0;return null!=y&&(s++,b=v.offset=y),l=l||b<0||b>1,a=a||b<c,c=b,o.push(b),v});l&&t.errors.push(function Jve(){return new et(3012,an)}()),a&&t.errors.push(function e0e(){return new et(3200,an)}());const h=e.steps.length;let d=0;s>0&&s<h?t.errors.push(function t0e(){return new et(3202,an)}()):0==s&&(d=1/(h-1));const f=h-1,p=t.currentTime,m=t.currentAnimateTimings,g=m.duration;return u.forEach((_,v)=>{const y=d>0?v==f?1:d*v:o[v],b=y*g;t.currentTime=p+m.delay+b,m.duration=b,this._validateStyleAst(_,t),_.offset=y,n.styles.push(_)}),n}visitReference(e,t){return{type:8,animation:ms(this,hm(e.animation),t),options:ou(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:ou(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:ou(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function z0e(i){const e=!!i.split(/\s*,\s*/).find(t=>":self"==t);return e&&(i=i.replace(V0e,"")),i=i.replace(/@\*/g,Q0).replace(/@\w+/g,t=>Q0+"-"+t.slice(1)).replace(/:animating/g,E1),[i,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+s:s,ps(t.collectedStyles,t.currentQuerySelector,new Map);const a=ms(this,hm(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:ou(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function n0e(){return new et(3013,an)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:$0(e.timings,t.errors,!0);return{type:12,animation:ms(this,hm(e.animation),t),timings:n,options:null}}}class G0e{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set,this.nonAnimatableCSSPropertiesFound=new Set}}function ou(i){return i?(i=um(i)).params&&(i.params=function H0e(i){return i?um(i):null}(i.params)):i={},i}function I1(i,e,t){return{duration:i,delay:e,easing:t}}function F1(i,e,t,n,r,s,o=null,a=!1){return{type:1,element:i,keyframes:e,preStyleProps:t,postStyleProps:n,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class oy{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const Z0e=new RegExp(":enter","g"),Q0e=new RegExp(":leave","g");function L1(i,e,t,n,r,s=new Map,o=new Map,a,l,c=[]){return(new $0e).buildKeyframes(i,e,t,n,r,s,o,a,l,c)}class $0e{buildKeyframes(e,t,n,r,s,o,a,l,c,u=[]){c=c||new oy;const h=new O1(e,t,c,r,s,u,[]);h.options=l;const d=l.delay?Nl(l.delay):0;h.currentTimeline.delayNextStep(d),h.currentTimeline.setStyles([o],null,h.errors,l),ms(this,n,h);const f=h.timelines.filter(p=>p.containsAnimation());if(f.length&&a.size){let p;for(let m=f.length-1;m>=0;m--){const g=f[m];if(g.element===t){p=g;break}}p&&!p.allowOnlyTimelineStyles()&&p.setStyles([a],null,h.errors,l)}return f.length?f.map(p=>p.buildKeyframes()):[F1(t,[],[],[],0,d,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(n,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_visitSubInstructions(e,t,n){let s=t.currentTimeline.currentTime;const o=null!=n.duration?Nl(n.duration):null,a=null!=n.delay?Nl(n.delay):null;return 0!==o&&e.forEach(l=>{const c=t.appendInstructionToTimeline(l,o,a);s=Math.max(s,c.duration+c.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),ms(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=ay);const o=Nl(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>ms(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?Nl(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),ms(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return $0(t.params?J0(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(n.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.hasCurrentStyleProperties()&&n.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(s):n.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,r=t.currentTimeline.duration,s=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?Nl(r.delay):0;s&&(6===t.previousNode.type||0==n&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=ay);let o=n;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{t.currentQueryIndex=u;const h=t.createSubContext(e.options,c);s&&h.delayNextStep(s),c===t.element&&(l=h.currentTimeline),ms(this,e.animation,h),h.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,h.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let l=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=n.currentStaggerTime}const u=t.currentTimeline;l&&u.delayNextStep(l);const h=u.currentTime;ms(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-h+(r.startTime-n.currentTimeline.startTime)}}const ay={};class O1{constructor(e,t,n,r,s,o,a,l){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=ay,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new ly(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let r=this.options;null!=n.duration&&(r.duration=Nl(n.duration)),null!=n.delay&&(r.delay=Nl(n.delay));const s=n.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=J0(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(r=>{n[r]=t[r]})}}return e}createSubContext(e=null,t,n){const r=t||this.element,s=new O1(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=ay,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},s=new J0e(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(Z0e,"."+this._enterClassName)).replace(Q0e,"."+this._leaveClassName);let c=this._driver.query(this.element,e,1!=n);0!==n&&(c=n<0?c.slice(c.length+n,c.length):c.slice(0,n)),a.push(...c)}return!s&&0==a.length&&o.push(function i0e(i){return new et(3014,an)}()),a}}class ly{constructor(e,t,n,r){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new ly(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,n]of this._globalTimelineStyles)this._backFill.set(t,n||ka),this._currentKeyframe.set(t,ka);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function eye(i,e){const t=new Map;let n;return i.forEach(r=>{if("*"===r){n=n||e.keys();for(let s of n)t.set(s,ka)}else Bl(r,t)}),t}(e,this._globalTimelineStyles);for(let[a,l]of o){const c=J0(l,s,n);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)||ka),this._updateStyle(a,c)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,n)=>{const r=this._styleSummary.get(n);(!r||t.time>r.time)&&this._updateStyle(n,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const c=Bl(a,new Map,this._backFill);c.forEach((u,h)=>{"!"===u?e.add(h):u===ka&&t.add(h)}),n||c.set("offset",l/this.duration),r.push(c)});const s=e.size?ey(e.values()):[],o=t.size?ey(t.values()):[];if(n){const a=r[0],l=new Map(a);a.set("offset",0),l.set("offset",1),r=[a,l]}return F1(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class J0e extends ly{constructor(e,t,n,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=n,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=n+t,a=t/o,l=Bl(e[0]);l.set("offset",0),s.push(l);const c=Bl(e[0]);c.set("offset",o4(a)),s.push(c);const u=e.length-1;for(let h=1;h<=u;h++){let d=Bl(e[h]);const f=d.get("offset");d.set("offset",o4((t+f*n)/o)),s.push(d)}n=o,t=0,r="",e=s}return F1(this.element,e,this.preStyleProps,this.postStyleProps,n,t,r,!0)}}function o4(i,e=3){const t=Math.pow(10,e-1);return Math.round(i*t)/t}class k1{}const tye=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class nye extends k1{normalizePropertyName(e,t){return D1(e)}normalizeStyleValue(e,t,n,r){let s="";const o=n.toString().trim();if(tye.has(t)&&0!==n&&"0"!==n)if("number"==typeof n)s="px";else{const a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function Xve(i,e){return new et(3005,an)}())}return o+s}}function a4(i,e,t,n,r,s,o,a,l,c,u,h,d){return{type:0,element:i,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:n,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:h,errors:d}}const N1={};class l4{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,r){return function iye(i,e,t,n,r){return i.some(s=>s(e,t,n,r))}(this.ast.matchers,e,t,n,r)}buildStyles(e,t,n){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,n):new Map}build(e,t,n,r,s,o,a,l,c,u){const h=[],d=this.ast.options&&this.ast.options.params||N1,p=this.buildStyles(n,a&&a.params||N1,h),m=l&&l.params||N1,g=this.buildStyles(r,m,h),_=new Set,v=new Map,y=new Map,b="void"===r,w={params:rye(m,d),delay:this.ast.options?.delay},M=u?[]:L1(e,t,this.ast.animation,s,o,p,g,w,c,h);let T=0;if(M.forEach(E=>{T=Math.max(E.duration+E.delay,T)}),h.length)return a4(t,this._triggerName,n,r,b,p,g,[],[],v,y,T,h);M.forEach(E=>{const D=E.element,L=ps(v,D,new Set);E.preStyleProps.forEach(H=>L.add(H));const z=ps(y,D,new Set);E.postStyleProps.forEach(H=>z.add(H)),D!==t&&_.add(D)});const x=ey(_.values());return a4(t,this._triggerName,n,r,b,p,g,M,x,v,y,T)}}function rye(i,e){const t=um(e);for(const n in i)i.hasOwnProperty(n)&&null!=i[n]&&(t[n]=i[n]);return t}class sye{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n=new Map,r=um(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(r[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=J0(o,r,t));const l=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,l,o,t),n.set(l,o)})}),n}}class aye{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new sye(r.style,r.options&&r.options.params||{},n))}),c4(this.states,"true","1"),c4(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new l4(e,r,this.states))}),this.fallbackTransition=function lye(i,e,t){return new l4(i,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,r){return this.transitionFactories.find(o=>o.match(e,t,n,r))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function c4(i,e,t){i.has(e)?i.has(t)||i.set(t,i.get(e)):i.has(t)&&i.set(e,i.get(t))}const cye=new oy;class uye{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const n=[],s=P1(this._driver,t,n,[]);if(n.length)throw function u0e(i){return new et(3503,an)}();this._animations.set(e,s)}_buildPlayer(e,t,n){const r=e.element,s=Vj(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const r=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=L1(this._driver,t,s,C1,Z0,new Map,new Map,n,cye,r),o.forEach(u=>{const h=ps(a,u.element,new Map);u.postStyleProps.forEach(d=>h.set(d,null))})):(r.push(function h0e(){return new et(3300,an)}()),o=[]),r.length)throw function d0e(i){return new et(3504,an)}();a.forEach((u,h)=>{u.forEach((d,f)=>{u.set(f,this._driver.computeStyle(h,f,ka))})});const c=kl(o.map(u=>{const h=a.get(u.element);return this._buildPlayer(u,new Map,h)}));return this._playersById.set(e,c),c.onDestroy(()=>this.destroy(e)),this.players.push(c),c}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function f0e(i){return new et(3301,an)}();return t}listen(e,t,n,r){const s=w1(t,"","","");return b1(this._getPlayer(e),n,s,r),()=>{}}command(e,t,n,r){if("register"==n)return void this.register(e,r[0]);if("create"==n)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(n){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const u4="ng-animate-queued",B1="ng-animate-disabled",mye=[],h4={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},gye={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Us="__ng_removed";class U1{constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function bye(i){return i??null}(n?e.value:e),n){const s=um(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(r=>{null==n[r]&&(n[r]=t[r])})}}}const dm="void",V1=new U1(dm);class _ye{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Vs(t,this._hostClassName)}listen(e,t,n,r){if(!this._triggers.has(t))throw function p0e(i,e){return new et(3302,an)}();if(null==n||0==n.length)throw function m0e(i){return new et(3303,an)}();if(!function xye(i){return"start"==i||"done"==i}(n))throw function g0e(i,e){return new et(3400,an)}();const s=ps(this._elementListeners,e,[]),o={name:t,phase:n,callback:r};s.push(o);const a=ps(this._engine.statesByElement,e,new Map);return a.has(t)||(Vs(e,Y0),Vs(e,Y0+"-"+t),a.set(t,V1)),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function _0e(i){return new et(3401,an)}();return t}trigger(e,t,n,r=!0){const s=this._getTrigger(t),o=new j1(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(Vs(e,Y0),Vs(e,Y0+"-"+t),this._engine.statesByElement.set(e,a=new Map));let l=a.get(t);const c=new U1(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(t,c),l||(l=V1),c.value!==dm&&l.value===c.value){if(!function Sye(i,e){const t=Object.keys(i),n=Object.keys(e);if(t.length!=n.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||i[s]!==e[s])return!1}return!0}(l.params,c.params)){const m=[],g=s.matchStyles(l.value,l.params,m),_=s.matchStyles(c.value,c.params,m);m.length?this._engine.reportError(m):this._engine.afterFlush(()=>{su(e,g),Jo(e,_)})}return}const d=ps(this._engine.playersByElement,e,[]);d.forEach(m=>{m.namespaceId==this.id&&m.triggerName==t&&m.queued&&m.destroy()});let f=s.matchTransition(l.value,c.value,e,c.params),p=!1;if(!f){if(!r)return;f=s.fallbackTransition,p=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:l,toState:c,player:o,isFallbackTransition:p}),p||(Vs(e,u4),o.onStart(()=>{wd(e,u4)})),o.onDone(()=>{let m=this.players.indexOf(o);m>=0&&this.players.splice(m,1);const g=this._engine.playersByElement.get(e);if(g){let _=g.indexOf(o);_>=0&&g.splice(_,1)}}),this.players.push(o),d.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,Q0,!0);n.forEach(r=>{if(r[Us])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,n,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((l,c)=>{if(o.set(c,l.value),this._triggers.has(c)){const u=this.trigger(e,c,dm,r);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),n&&kl(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const l=this._triggers.get(o).fallbackTransition,c=n.get(o)||V1,u=new U1(dm),h=new j1(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:l,fromState:c,toState:u,player:h,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(n.totalAnimations){const s=n.players.length?n.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(n.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)n.markElementAsRemoved(this.id,e,!1,t);else{const s=e[Us];(!s||s===h4)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){Vs(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const s=n.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==n.triggerName){const l=w1(s,n.triggerName,n.fromState.value,n.toState.value);l._data=e,b1(n.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(n)}),this._queue=[],t.sort((n,r)=>{const s=n.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(n.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(n=>n.element===e)||t,t}}class vye{constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new _ye(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,r=this.namespacesByHostElement;if(n.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const l=r.get(a);if(l){const c=n.indexOf(l);n.splice(c+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||n.unshift(e)}else n.push(e);return r.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}destroy(e,t){if(!e)return;const n=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(n);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>n.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n)for(let r of n.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,n,r){if(cy(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,n,r),!0}return!1}insertNode(e,t,n,r){if(!cy(t))return;const s=t[Us];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Vs(e,B1)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),wd(e,B1))}removeNode(e,t,n,r){if(cy(t)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,n,r,s){this.collectedLeaveElements.push(t),t[Us]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,n,r,s){return cy(t)?this._fetchNamespace(e).listen(t,n,r,s):()=>{}}_buildInstruction(e,t,n,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,Q0,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,E1,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return kl(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[Us];if(t&&t.setForRemoval){if(e[Us]=h4,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(B1)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,r)=>this._balanceNamespaceList(n,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Vs(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let r=0;r<n.length;r++)n[r]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?kl(t).onDone(()=>{n.forEach(r=>r())}):n.forEach(r=>r())}}reportError(e){throw function v0e(i){return new et(3402,an)}()}_flushAnimations(e,t){const n=new oy,r=[],s=new Map,o=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(I=>{u.add(I);const V=this.driver.query(I,".ng-animate-queued",!0);for(let W=0;W<V.length;W++)u.add(V[W])});const h=this.bodyNode,d=Array.from(this.statesByElement.keys()),f=p4(d,this.collectedEnterElements),p=new Map;let m=0;f.forEach((I,V)=>{const W=C1+m++;p.set(V,W),I.forEach(j=>Vs(j,W))});const g=[],_=new Set,v=new Set;for(let I=0;I<this.collectedLeaveElements.length;I++){const V=this.collectedLeaveElements[I],W=V[Us];W&&W.setForRemoval&&(g.push(V),_.add(V),W.hasAnimation?this.driver.query(V,".ng-star-inserted",!0).forEach(j=>_.add(j)):v.add(V))}const y=new Map,b=p4(d,Array.from(_));b.forEach((I,V)=>{const W=Z0+m++;y.set(V,W),I.forEach(j=>Vs(j,W))}),e.push(()=>{f.forEach((I,V)=>{const W=p.get(V);I.forEach(j=>wd(j,W))}),b.forEach((I,V)=>{const W=y.get(V);I.forEach(j=>wd(j,W))}),g.forEach(I=>{this.processLeaveNode(I)})});const w=[],M=[];for(let I=this._namespaceList.length-1;I>=0;I--)this._namespaceList[I].drainQueuedTransitions(t).forEach(W=>{const j=W.player,q=W.element;if(w.push(j),this.collectedEnterElements.length){const K=q[Us];if(K&&K.setForMove){if(K.previousTriggersValues&&K.previousTriggersValues.has(W.triggerName)){const pe=K.previousTriggersValues.get(W.triggerName),Fe=this.statesByElement.get(W.element);if(Fe&&Fe.has(W.triggerName)){const _e=Fe.get(W.triggerName);_e.value=pe,Fe.set(W.triggerName,_e)}}return void j.destroy()}}const oe=!h||!this.driver.containsElement(h,q),J=y.get(q),fe=p.get(q),he=this._buildInstruction(W,n,fe,J,oe);if(he.errors&&he.errors.length)return void M.push(he);if(oe)return j.onStart(()=>su(q,he.fromStyles)),j.onDestroy(()=>Jo(q,he.toStyles)),void r.push(j);if(W.isFallbackTransition)return j.onStart(()=>su(q,he.fromStyles)),j.onDestroy(()=>Jo(q,he.toStyles)),void r.push(j);const Re=[];he.timelines.forEach(K=>{K.stretchStartingKeyframe=!0,this.disabledNodes.has(K.element)||Re.push(K)}),he.timelines=Re,n.append(q,he.timelines),o.push({instruction:he,player:j,element:q}),he.queriedElements.forEach(K=>ps(a,K,[]).push(j)),he.preStyleProps.forEach((K,pe)=>{if(K.size){let Fe=l.get(pe);Fe||l.set(pe,Fe=new Set),K.forEach((_e,ot)=>Fe.add(ot))}}),he.postStyleProps.forEach((K,pe)=>{let Fe=c.get(pe);Fe||c.set(pe,Fe=new Set),K.forEach((_e,ot)=>Fe.add(ot))})});if(M.length){const I=[];M.forEach(V=>{I.push(function y0e(i,e){return new et(3505,an)}())}),w.forEach(V=>V.destroy()),this.reportError(I)}const T=new Map,x=new Map;o.forEach(I=>{const V=I.element;n.has(V)&&(x.set(V,V),this._beforeAnimationBuild(I.player.namespaceId,I.instruction,T))}),r.forEach(I=>{const V=I.element;this._getPreviousPlayers(V,!1,I.namespaceId,I.triggerName,null).forEach(j=>{ps(T,V,[]).push(j),j.destroy()})});const E=g.filter(I=>g4(I,l,c)),D=new Map;f4(D,this.driver,v,c,ka).forEach(I=>{g4(I,l,c)&&E.push(I)});const z=new Map;f.forEach((I,V)=>{f4(z,this.driver,new Set(I),l,"!")}),E.forEach(I=>{const V=D.get(I),W=z.get(I);D.set(I,new Map([...Array.from(V?.entries()??[]),...Array.from(W?.entries()??[])]))});const H=[],U=[],X={};o.forEach(I=>{const{element:V,player:W,instruction:j}=I;if(n.has(V)){if(u.has(V))return W.onDestroy(()=>Jo(V,j.toStyles)),W.disabled=!0,W.overrideTotalTime(j.totalTime),void r.push(W);let q=X;if(x.size>1){let J=V;const fe=[];for(;J=J.parentNode;){const he=x.get(J);if(he){q=he;break}fe.push(J)}fe.forEach(he=>x.set(he,q))}const oe=this._buildAnimation(W.namespaceId,j,T,s,z,D);if(W.setRealPlayer(oe),q===X)H.push(W);else{const J=this.playersByElement.get(q);J&&J.length&&(W.parentPlayer=kl(J)),r.push(W)}}else su(V,j.fromStyles),W.onDestroy(()=>Jo(V,j.toStyles)),U.push(W),u.has(V)&&r.push(W)}),U.forEach(I=>{const V=s.get(I.element);if(V&&V.length){const W=kl(V);I.setRealPlayer(W)}}),r.forEach(I=>{I.parentPlayer?I.syncPlayerEvents(I.parentPlayer):I.destroy()});for(let I=0;I<g.length;I++){const V=g[I],W=V[Us];if(wd(V,Z0),W&&W.hasAnimation)continue;let j=[];if(a.size){let oe=a.get(V);oe&&oe.length&&j.push(...oe);let J=this.driver.query(V,E1,!0);for(let fe=0;fe<J.length;fe++){let he=a.get(J[fe]);he&&he.length&&j.push(...he)}}const q=j.filter(oe=>!oe.destroyed);q.length?wye(this,V,q):this.processLeaveNode(V)}return g.length=0,H.forEach(I=>{this.players.push(I),I.onDone(()=>{I.destroy();const V=this.players.indexOf(I);this.players.splice(V,1)}),I.play()}),H}elementContainsData(e,t){let n=!1;const r=t[Us];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,r,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const l=!s||s==dm;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||o.push(c)})}}return(n||r)&&(o=o.filter(a=>!(n&&n!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,n){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const l of t.timelines){const c=l.element,u=c!==s,h=ps(n,c,[]);this._getPreviousPlayers(c,u,o,a,t.toState).forEach(f=>{const p=f.getRealPlayer();p.beforeDestroy&&p.beforeDestroy(),f.destroy(),h.push(f)})}su(s,t.fromStyles)}_buildAnimation(e,t,n,r,s,o){const a=t.triggerName,l=t.element,c=[],u=new Set,h=new Set,d=t.timelines.map(p=>{const m=p.element;u.add(m);const g=m[Us];if(g&&g.removedBeforeQueried)return new Vp(p.duration,p.delay);const _=m!==l,v=function Mye(i){const e=[];return m4(i,e),e}((n.get(m)||mye).map(T=>T.getRealPlayer())).filter(T=>!!T.element&&T.element===m),y=s.get(m),b=o.get(m),w=Vj(0,this._normalizer,0,p.keyframes,y,b),M=this._buildPlayer(p,w,v);if(p.subTimeline&&r&&h.add(m),_){const T=new j1(e,a,m);T.setRealPlayer(M),c.push(T)}return M});c.forEach(p=>{ps(this.playersByQueriedElement,p.element,[]).push(p),p.onDone(()=>function yye(i,e,t){let n=i.get(e);if(n){if(n.length){const r=n.indexOf(t);n.splice(r,1)}0==n.length&&i.delete(e)}return n}(this.playersByQueriedElement,p.element,p))}),u.forEach(p=>Vs(p,Zj));const f=kl(d);return f.onDestroy(()=>{u.forEach(p=>wd(p,Zj)),Jo(l,t.toStyles)}),h.forEach(p=>{ps(r,p,[]).push(f)}),f}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new Vp(e.duration,e.delay)}}class j1{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new Vp,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,n)=>{t.forEach(r=>b1(e,n,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){ps(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function cy(i){return i&&1===i.nodeType}function d4(i,e){const t=i.style.display;return i.style.display=e??"none",t}function f4(i,e,t,n,r){const s=[];t.forEach(l=>s.push(d4(l)));const o=[];n.forEach((l,c)=>{const u=new Map;l.forEach(h=>{const d=e.computeStyle(c,h,r);u.set(h,d),(!d||0==d.length)&&(c[Us]=gye,o.push(c))}),i.set(c,u)});let a=0;return t.forEach(l=>d4(l,s[a++])),o}function p4(i,e){const t=new Map;if(i.forEach(a=>t.set(a,[])),0==e.length)return t;const r=new Set(e),s=new Map;function o(a){if(!a)return 1;let l=s.get(a);if(l)return l;const c=a.parentNode;return l=t.has(c)?c:r.has(c)?1:o(c),s.set(a,l),l}return e.forEach(a=>{const l=o(a);1!==l&&t.get(l).push(a)}),t}function Vs(i,e){i.classList?.add(e)}function wd(i,e){i.classList?.remove(e)}function wye(i,e,t){kl(t).onDone(()=>i.processLeaveNode(e))}function m4(i,e){for(let t=0;t<i.length;t++){const n=i[t];n instanceof hB?m4(n.players,e):e.push(n)}}function g4(i,e,t){const n=t.get(i);if(!n)return!1;let r=e.get(i);return r?n.forEach(s=>r.add(s)):e.set(i,n),t.delete(i),!0}class uy{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new vye(e,t,n),this._timelineEngine=new uye(e,t,n),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,n,r,s){const o=e+"-"+r;let a=this._triggerCache[o];if(!a){const l=[],u=P1(this._driver,s,l,[]);if(l.length)throw function l0e(i,e){return new et(3404,an)}();a=function oye(i,e,t){return new aye(i,e,t)}(r,u,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}onRemove(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,r){if("@"==n.charAt(0)){const[s,o]=jj(n);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}listen(e,t,n,r,s){if("@"==n.charAt(0)){const[o,a]=jj(n);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,n,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let Cye=(()=>{class i{constructor(t,n,r){this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;let s=i.initialStylesByElement.get(t);s||i.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&Jo(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Jo(this._element,this._initialStyles),this._endStyles&&(Jo(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(i.initialStylesByElement.delete(this._element),this._startStyles&&(su(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(su(this._element,this._endStyles),this._endStyles=null),Jo(this._element,this._initialStyles),this._state=3)}}return i.initialStylesByElement=new WeakMap,i})();function z1(i){let e=null;return i.forEach((t,n)=>{(function Eye(i){return"display"===i||"position"===i})(n)&&(e=e||new Map,e.set(n,t))}),e}class _4{constructor(e,t,n,r){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(n=>{t.push(Object.fromEntries(n))}),t}_triggerWebAnimation(e,t,n){return e.animate(this._convertKeyframesToObject(t),n)}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,r)=>{"offset"!==r&&e.set(r,this._finished?n:t4(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class Rye{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return Wj(e,t)}getParentElement(e){return S1(e)}query(e,t,n){return Xj(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,r,s,o=[]){const l={duration:n,delay:r,fill:0==r?"both":"forwards"};s&&(l.easing=s);const c=new Map,u=o.filter(f=>f instanceof _4);(function I0e(i,e){return 0===i||0===e})(n,r)&&u.forEach(f=>{f.currentSnapshot.forEach((p,m)=>c.set(m,p))});let h=function R0e(i){return i.length?i[0]instanceof Map?i:i.map(e=>Yj(e)):[]}(t).map(f=>Bl(f));h=function F0e(i,e,t){if(t.size&&e.length){let n=e[0],r=[];if(t.forEach((s,o)=>{n.has(o)||r.push(o),n.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(a=>o.set(a,t4(i,a)))}}return e}(e,h,c);const d=function Tye(i,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=z1(e[0]),e.length>1&&(n=z1(e[e.length-1]))):e instanceof Map&&(t=z1(e)),t||n?new Cye(i,t,n):null}(e,h);return new _4(e,h,l,d)}}let Aye=(()=>{class i extends lB{constructor(t,n){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(n.body,{id:"0",encapsulation:Gs.None,styles:[],data:{animation:[]}})}build(t){const n=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?cB(t):t;return v4(this._renderer,null,n,"register",[r]),new Dye(n,this._renderer)}}return i.\u0275fac=function(t){return new(t||i)(re(uf),re(Vt))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();class Dye extends class Eoe{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new Pye(this._id,e,t||{},this._renderer)}}class Pye{constructor(e,t,n,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return v4(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function v4(i,e,t,n,r){return i.setProperty(e,`@@${t}:${n}`,r)}const y4="@.disabled";let Iye=(()=>{class i{constructor(t,n,r){this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=(s,o)=>{const a=o?.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,n){const s=this.delegate.createRenderer(t,n);if(!(t&&n&&n.data&&n.data.animation)){let u=this._rendererCache.get(s);return u||(u=new b4("",s,this.engine),this._rendererCache.set(s,u)),u}const o=n.id,a=n.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const l=u=>{Array.isArray(u)?u.forEach(l):this.engine.registerTrigger(o,a,t,u.name,u)};return n.data.animation.forEach(l),new Fye(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,n,r){t>=0&&t<this._microtaskId?this._zone.run(()=>n(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return i.\u0275fac=function(t){return new(t||i)(re(uf),re(uy),re(Pt))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();class b4{constructor(e,t,n){this.namespaceId=e,this.delegate=t,this.engine=n,this.destroyNode=this.delegate.destroyNode?r=>t.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,r=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,r){this.delegate.setStyle(e,t,n,r)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==y4?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Fye extends b4{constructor(e,t,n,r){super(t,n,r),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==y4?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.slice(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const r=function Lye(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function Oye(i){const e=i.indexOf(".");return[i.substring(0,e),i.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,n,a)})}return this.delegate.listen(e,t,n)}}let kye=(()=>{class i extends uy{constructor(t,n,r){super(t.body,n,r)}ngOnDestroy(){this.flush()}}return i.\u0275fac=function(t){return new(t||i)(re(Vt),re(T1),re(k1))},i.\u0275prov=We({token:i,factory:i.\u0275fac}),i})();const x4=[{provide:lB,useClass:Aye},{provide:k1,useFactory:function Nye(){return new nye}},{provide:uy,useClass:kye},{provide:uf,useFactory:function Bye(i,e,t){return new Iye(i,e,t)},deps:[Kg,uy,Pt]}],w4=[{provide:T1,useFactory:()=>new Rye},{provide:Ar,useValue:"BrowserAnimations"},...x4],Uye=[{provide:T1,useClass:Kj},{provide:Ar,useValue:"NoopAnimations"},...x4];let Vye=(()=>{class i{static withConfig(t){return{ngModule:i,providers:t.disableAnimations?Uye:w4}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i}),i.\u0275inj=Ut({providers:w4,imports:[X2]}),i})(),jye=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=jt({type:i,bootstrap:[eve]}),i.\u0275inj=Ut({providers:[{provide:t0,useValue:{fullLibraryLoader:()=>Va.e(225).then(Va.bind(Va,7225))}},Bv],imports:[X2,s_e,Cle,Vve,qme,Uae,Vye,ese,f1,h1,q_e,$T,d1]}),i})();(function l9(){XI=!1})(),_K().bootstrapModule(jye).catch(i=>console.error(i))}},my=>{my(my.s=7650)}]);