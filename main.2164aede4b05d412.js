"use strict";(self.webpackChunkngx_three_demo=self.webpackChunkngx_three_demo||[]).push([[179],{4210:(pM,K2,xh)=>{var wh={};function Ti(i){return"function"==typeof i}function mM(i){const t=i(n=>{Error.call(n),n.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}xh.r(wh),xh.d(wh,{ACESFilmicToneMapping:()=>Nj,AddEquation:()=>ws,AddOperation:()=>Bj,AdditiveAnimationBlendMode:()=>ET,AdditiveBlending:()=>xf,AlphaFormat:()=>Qj,AlwaysDepth:()=>Sj,AlwaysStencilFunc:()=>iU,AmbientLight:()=>Lx,AmbientLightProbe:()=>Y4,AnimationAction:()=>s5,AnimationClip:()=>gu,AnimationLoader:()=>Tle,AnimationMixer:()=>o5,AnimationObjectGroup:()=>qle,AnimationUtils:()=>Cle,ArcCurve:()=>v4,ArrayCamera:()=>nR,ArrowHelper:()=>T5,Audio:()=>GR,AudioAnalyser:()=>Ole,AudioContext:()=>zR,AudioListener:()=>e5,AudioLoader:()=>Ble,AxesHelper:()=>R5,BackSide:()=>Hr,BasicDepthPacking:()=>eU,BasicShadowMap:()=>Bie,Bone:()=>ru,BooleanKeyframeTrack:()=>hu,Box2:()=>ece,Box3:()=>io,Box3Helper:()=>M5,BoxBufferGeometry:()=>nce,BoxGeometry:()=>tn,BoxHelper:()=>C5,BufferAttribute:()=>Mi,BufferGeometry:()=>Mt,BufferGeometryLoader:()=>G4,ByteType:()=>Uj,Cache:()=>_u,Camera:()=>ix,CameraHelper:()=>w5,CanvasTexture:()=>wx,CapsuleBufferGeometry:()=>rce,CapsuleGeometry:()=>fp,CatmullRomCurve3:()=>A4,CineonToneMapping:()=>Oj,CircleBufferGeometry:()=>sce,CircleGeometry:()=>pp,ClampToEdgeWrapping:()=>_r,Clock:()=>Au,Color:()=>Le,ColorKeyframeTrack:()=>BR,ColorManagement:()=>Cs,CompressedArrayTexture:()=>dR,CompressedTexture:()=>Eb,CompressedTextureLoader:()=>kx,ConeBufferGeometry:()=>oce,ConeGeometry:()=>mp,CubeCamera:()=>XT,CubeReflectionMapping:()=>cc,CubeRefractionMapping:()=>dc,CubeTexture:()=>Jd,CubeTextureLoader:()=>N4,CubeUVReflectionMapping:()=>Sf,CubicBezierCurve:()=>mR,CubicBezierCurve3:()=>x4,CubicInterpolant:()=>B4,CullFaceBack:()=>nT,CullFaceFront:()=>_j,CullFaceFrontBack:()=>kie,CullFaceNone:()=>gj,Curve:()=>Ro,CurvePath:()=>C4,CustomBlending:()=>wf,CustomToneMapping:()=>jj,CylinderBufferGeometry:()=>ace,CylinderGeometry:()=>Hn,Cylindrical:()=>Jle,Data3DTexture:()=>cb,DataArrayTexture:()=>lb,DataTexture:()=>Fa,DataTextureLoader:()=>Ep,DataUtils:()=>cs,DecrementStencilOp:()=>Hie,DecrementWrapStencilOp:()=>Wie,DefaultLoadingManager:()=>O4,DepthFormat:()=>fc,DepthStencilFormat:()=>pc,DepthTexture:()=>rp,DirectionalLight:()=>Fb,DirectionalLightHelper:()=>x5,DiscreteInterpolant:()=>L4,DisplayP3ColorSpace:()=>TT,DodecahedronBufferGeometry:()=>lce,DodecahedronGeometry:()=>gp,DoubleSide:()=>os,DstAlphaFactor:()=>vy,DstColorFactor:()=>Ay,DynamicCopyUsage:()=>one,DynamicDrawUsage:()=>By,DynamicReadUsage:()=>nne,EdgesGeometry:()=>yR,EllipseCurve:()=>xc,EqualDepth:()=>Rj,EqualStencilFunc:()=>Zie,EquirectangularReflectionMapping:()=>Ef,EquirectangularRefractionMapping:()=>Z_,Euler:()=>ro,EventDispatcher:()=>as,ExtrudeBufferGeometry:()=>cce,ExtrudeGeometry:()=>cu,FileLoader:()=>yr,Float16BufferAttribute:()=>qne,Float32BufferAttribute:()=>Ke,Float64BufferAttribute:()=>Yne,FloatType:()=>Un,Fog:()=>bb,FogExp2:()=>dx,FramebufferTexture:()=>b4,FrontSide:()=>Da,Frustum:()=>rx,GLBufferAttribute:()=>$le,GLSL1:()=>lne,GLSL3:()=>RT,GreaterDepth:()=>Dj,GreaterEqualDepth:()=>Ij,GreaterEqualStencilFunc:()=>ene,GreaterStencilFunc:()=>$ie,GridHelper:()=>XR,Group:()=>Es,HalfFloatType:()=>mn,HemisphereLight:()=>FR,HemisphereLightHelper:()=>b5,HemisphereLightProbe:()=>q4,IcosahedronBufferGeometry:()=>dce,IcosahedronGeometry:()=>bp,ImageBitmapLoader:()=>W4,ImageLoader:()=>kb,ImageUtils:()=>BT,IncrementStencilOp:()=>Gie,IncrementWrapStencilOp:()=>Qie,InstancedBufferAttribute:()=>up,InstancedBufferGeometry:()=>VR,InstancedInterleavedBuffer:()=>Kle,InstancedMesh:()=>bx,Int16BufferAttribute:()=>Qne,Int32BufferAttribute:()=>Wne,Int8BufferAttribute:()=>zne,IntType:()=>zj,InterleavedBuffer:()=>vb,InterleavedBufferAttribute:()=>yc,Interpolant:()=>Mp,InterpolateDiscrete:()=>Lf,InterpolateLinear:()=>Qd,InterpolateSmooth:()=>Iy,InvertStencilOp:()=>qie,KeepStencilOp:()=>ky,KeyframeTrack:()=>ca,LOD:()=>aR,LatheBufferGeometry:()=>uce,LatheGeometry:()=>ou,Layers:()=>Vy,LessDepth:()=>Tj,LessEqualDepth:()=>yy,LessEqualStencilFunc:()=>Kie,LessStencilFunc:()=>Xie,Light:()=>Cc,LightProbe:()=>Ob,Line:()=>Gn,Line3:()=>d5,LineBasicMaterial:()=>gn,LineCurve:()=>Mx,LineCurve3:()=>w4,LineDashedMaterial:()=>RR,LineLoop:()=>Ax,LineSegments:()=>Ss,LinearEncoding:()=>$s,LinearFilter:()=>Ui,LinearInterpolant:()=>kR,LinearMipMapLinearFilter:()=>jie,LinearMipMapNearestFilter:()=>Nie,LinearMipmapLinearFilter:()=>Ks,LinearMipmapNearestFilter:()=>wy,LinearSRGBColorSpace:()=>Yd,LinearToneMapping:()=>Lj,Loader:()=>Ar,LoaderUtils:()=>bu,LoadingManager:()=>LR,LoopOnce:()=>MT,LoopPingPong:()=>$j,LoopRepeat:()=>Kj,LuminanceAlphaFormat:()=>Wj,LuminanceFormat:()=>Cy,MOUSE:()=>Zs,Material:()=>zn,MaterialLoader:()=>Fx,MathUtils:()=>ft,Matrix3:()=>Ai,Matrix4:()=>Qe,MaxEquation:()=>lT,Mesh:()=>nt,MeshBasicMaterial:()=>$n,MeshDepthMaterial:()=>nu,MeshDistanceMaterial:()=>cx,MeshLambertMaterial:()=>Px,MeshMatcapMaterial:()=>TR,MeshNormalMaterial:()=>Cp,MeshPhongMaterial:()=>du,MeshPhysicalMaterial:()=>Ua,MeshStandardMaterial:()=>ja,MeshToonMaterial:()=>SR,MinEquation:()=>aT,MirroredRepeatWrapping:()=>Tf,MixOperation:()=>kj,MultiplyBlending:()=>oT,MultiplyOperation:()=>X_,NearestFilter:()=>$t,NearestMipMapLinearFilter:()=>Oie,NearestMipMapNearestFilter:()=>Fie,NearestMipmapLinearFilter:()=>Rf,NearestMipmapNearestFilter:()=>K_,NeverDepth:()=>Ej,NeverStencilFunc:()=>Yie,NoBlending:()=>Kt,NoColorSpace:()=>Uie,NoToneMapping:()=>ka,NormalAnimationBlendMode:()=>Dy,NormalBlending:()=>Pa,NotEqualDepth:()=>Pj,NotEqualStencilFunc:()=>Jie,NumberKeyframeTrack:()=>fu,Object3D:()=>Qt,ObjectLoader:()=>Ple,ObjectSpaceNormalMap:()=>tU,OctahedronBufferGeometry:()=>hce,OctahedronGeometry:()=>aa,OneFactor:()=>q_,OneMinusDstAlphaFactor:()=>wj,OneMinusDstColorFactor:()=>Cj,OneMinusSrcAlphaFactor:()=>Y_,OneMinusSrcColorFactor:()=>xj,OrthographicCamera:()=>La,PCFShadowMap:()=>rT,PCFSoftShadowMap:()=>bj,PMREMGenerator:()=>JT,Path:()=>Rb,PerspectiveCamera:()=>In,Plane:()=>oo,PlaneBufferGeometry:()=>fce,PlaneGeometry:()=>Ac,PlaneHelper:()=>E5,PointLight:()=>Sp,PointLightHelper:()=>m5,Points:()=>su,PointsMaterial:()=>Pl,PolarGridHelper:()=>v5,PolyhedronBufferGeometry:()=>pce,PolyhedronGeometry:()=>Oa,PositionalAudio:()=>n5,PropertyBinding:()=>Vi,PropertyMixer:()=>r5,QuadraticBezierCurve:()=>gR,QuadraticBezierCurve3:()=>_R,Quaternion:()=>xi,QuaternionKeyframeTrack:()=>kl,QuaternionLinearInterpolant:()=>F4,RED_GREEN_RGTC2_Format:()=>wT,RED_RGTC1_Format:()=>Zj,REVISION:()=>by,RGBADepthPacking:()=>rb,RGBAFormat:()=>Rn,RGBAIntegerFormat:()=>Xj,RGBA_ASTC_10x10_Format:()=>vT,RGBA_ASTC_10x5_Format:()=>gT,RGBA_ASTC_10x6_Format:()=>_T,RGBA_ASTC_10x8_Format:()=>bT,RGBA_ASTC_12x10_Format:()=>AT,RGBA_ASTC_12x12_Format:()=>yT,RGBA_ASTC_4x4_Format:()=>Ry,RGBA_ASTC_5x4_Format:()=>cT,RGBA_ASTC_5x5_Format:()=>dT,RGBA_ASTC_6x5_Format:()=>uT,RGBA_ASTC_6x6_Format:()=>hT,RGBA_ASTC_8x5_Format:()=>fT,RGBA_ASTC_8x6_Format:()=>pT,RGBA_ASTC_8x8_Format:()=>mT,RGBA_BPTC_Format:()=>ib,RGBA_ETC2_EAC_Format:()=>Ty,RGBA_PVRTC_2BPPV1_Format:()=>tb,RGBA_PVRTC_4BPPV1_Format:()=>Bf,RGBA_S3TC_DXT1_Format:()=>My,RGBA_S3TC_DXT3_Format:()=>J_,RGBA_S3TC_DXT5_Format:()=>Pf,RGB_ETC1_Format:()=>Ey,RGB_ETC2_Format:()=>Sy,RGB_PVRTC_2BPPV1_Format:()=>eb,RGB_PVRTC_4BPPV1_Format:()=>kf,RGB_S3TC_DXT1_Format:()=>Df,RGFormat:()=>If,RGIntegerFormat:()=>Yj,RawShaderMaterial:()=>ER,Ray:()=>hb,Raycaster:()=>Mu,RectAreaLight:()=>UR,RedFormat:()=>Cl,RedIntegerFormat:()=>qj,ReinhardToneMapping:()=>Fj,RepeatWrapping:()=>Mo,ReplaceStencilOp:()=>zie,ReverseSubtractEquation:()=>Aj,RingBufferGeometry:()=>mce,RingGeometry:()=>vp,SIGNED_RED_GREEN_RGTC2_Format:()=>CT,SIGNED_RED_RGTC1_Format:()=>xT,SRGBColorSpace:()=>Js,Scene:()=>ux,ShaderChunk:()=>fi,ShaderLib:()=>To,ShaderMaterial:()=>Pt,ShadowMaterial:()=>MR,Shape:()=>au,ShapeBufferGeometry:()=>gce,ShapeGeometry:()=>Ap,ShapePath:()=>ice,ShapeUtils:()=>Na,ShortType:()=>Vj,Skeleton:()=>dp,SkeletonHelper:()=>f5,SkinnedMesh:()=>wb,Source:()=>Zd,Sphere:()=>Eo,SphereBufferGeometry:()=>_ce,SphereGeometry:()=>wc,Spherical:()=>Nx,SphericalHarmonics3:()=>z4,SplineCurve:()=>bR,SpotLight:()=>Bb,SpotLightHelper:()=>h5,Sprite:()=>oR,SpriteMaterial:()=>hx,SrcAlphaFactor:()=>Mf,SrcAlphaSaturateFactor:()=>Mj,SrcColorFactor:()=>yj,StaticCopyUsage:()=>sne,StaticDrawUsage:()=>sb,StaticReadUsage:()=>ine,StereoCamera:()=>K4,StreamCopyUsage:()=>ane,StreamDrawUsage:()=>tne,StreamReadUsage:()=>rne,StringKeyframeTrack:()=>pu,SubtractEquation:()=>vj,SubtractiveBlending:()=>sT,TOUCH:()=>wl,TangentSpaceNormalMap:()=>mc,TetrahedronBufferGeometry:()=>bce,TetrahedronGeometry:()=>yp,Texture:()=>An,TextureLoader:()=>Bx,TorusBufferGeometry:()=>vce,TorusGeometry:()=>la,TorusKnotBufferGeometry:()=>Ace,TorusKnotGeometry:()=>xp,Triangle:()=>ls,TriangleFanDrawMode:()=>Py,TriangleStripDrawMode:()=>ST,TrianglesDrawMode:()=>Jj,TubeBufferGeometry:()=>yce,TubeGeometry:()=>wp,TwoPassDoubleSide:()=>Lie,UVMapping:()=>xy,Uint16BufferAttribute:()=>Wy,Uint32BufferAttribute:()=>qy,Uint8BufferAttribute:()=>Gne,Uint8ClampedBufferAttribute:()=>Hne,Uniform:()=>WR,UniformsGroup:()=>Zle,UniformsLib:()=>ot,UniformsUtils:()=>gi,UnsignedByteType:()=>Qr,UnsignedInt248Type:()=>hc,UnsignedIntType:()=>uc,UnsignedShort4444Type:()=>Gj,UnsignedShort5551Type:()=>Hj,UnsignedShortType:()=>$_,VSMShadowMap:()=>yf,Vector2:()=>fe,Vector3:()=>R,Vector4:()=>ii,VectorKeyframeTrack:()=>mu,VideoTexture:()=>_4,WebGL1Renderer:()=>KU,WebGL3DRenderTarget:()=>Dne,WebGLArrayRenderTarget:()=>Ine,WebGLCubeRenderTarget:()=>wU,WebGLMultipleRenderTargets:()=>Pne,WebGLRenderTarget:()=>Gt,WebGLRenderer:()=>_b,WebGLUtils:()=>ZU,WireframeGeometry:()=>CR,WrapAroundEnding:()=>nb,ZeroCurvatureEnding:()=>Wd,ZeroFactor:()=>Cf,ZeroSlopeEnding:()=>qd,ZeroStencilOp:()=>Vie,_SRGBAFormat:()=>Ly,sRGBEncoding:()=>ui});const gM=mM(i=>function(t){i(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((n,r)=>`${r+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function hv(i,e){if(i){const t=i.indexOf(e);0<=t&&i.splice(t,1)}}class un{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:n}=this;if(Ti(n))try{n()}catch(s){e=s instanceof gM?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{eP(s)}catch(o){e=e??[],o instanceof gM?e=[...e,...o.errors]:e.push(o)}}if(e)throw new gM(e)}}add(e){var t;if(e&&e!==this)if(this.closed)eP(e);else{if(e instanceof un){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&hv(t,e)}remove(e){const{_finalizers:t}=this;t&&hv(t,e),e instanceof un&&e._removeParent(this)}}un.EMPTY=(()=>{const i=new un;return i.closed=!0,i})();const $2=un.EMPTY;function J2(i){return i instanceof un||i&&"closed"in i&&Ti(i.remove)&&Ti(i.add)&&Ti(i.unsubscribe)}function eP(i){Ti(i)?i():i.unsubscribe()}const md={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},fv={setTimeout(i,e,...t){const{delegate:n}=fv;return n?.setTimeout?n.setTimeout(i,e,...t):setTimeout(i,e,...t)},clearTimeout(i){const{delegate:e}=fv;return(e?.clearTimeout||clearTimeout)(i)},delegate:void 0};function tP(i){fv.setTimeout(()=>{const{onUnhandledError:e}=md;if(!e)throw i;e(i)})}function _M(){}const GQ=bM("C",void 0,void 0);function bM(i,e,t){return{kind:i,value:e,error:t}}let gd=null;function pv(i){if(md.useDeprecatedSynchronousErrorHandling){const e=!gd;if(e&&(gd={errorThrown:!1,error:null}),i(),e){const{errorThrown:t,error:n}=gd;if(gd=null,t)throw n}}else i()}class vM extends un{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,J2(e)&&e.add(this)):this.destination=ZQ}static create(e,t,n){return new mv(e,t,n)}next(e){this.isStopped?yM(function QQ(i){return bM("N",i,void 0)}(e),this):this._next(e)}error(e){this.isStopped?yM(function HQ(i){return bM("E",void 0,i)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?yM(GQ,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const qQ=Function.prototype.bind;function AM(i,e){return qQ.call(i,e)}class YQ{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){gv(n)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){gv(n)}else gv(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){gv(t)}}}class mv extends vM{constructor(e,t,n){let r;if(super(),Ti(e)||!e)r={next:e??void 0,error:t??void 0,complete:n??void 0};else{let s;this&&md.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&AM(e.next,s),error:e.error&&AM(e.error,s),complete:e.complete&&AM(e.complete,s)}):r=e}this.destination=new YQ(r)}}function gv(i){md.useDeprecatedSynchronousErrorHandling?function WQ(i){md.useDeprecatedSynchronousErrorHandling&&gd&&(gd.errorThrown=!0,gd.error=i)}(i):tP(i)}function yM(i,e){const{onStoppedNotification:t}=md;t&&fv.setTimeout(()=>t(i,e))}const ZQ={closed:!0,next:_M,error:function XQ(i){throw i},complete:_M},xM="function"==typeof Symbol&&Symbol.observable||"@@observable";function Xl(i){return i}function iP(i){return 0===i.length?Xl:1===i.length?i[0]:function(t){return i.reduce((n,r)=>r(n),t)}}let Oi=(()=>{class i{constructor(t){t&&(this._subscribe=t)}lift(t){const n=new i;return n.source=this,n.operator=t,n}subscribe(t,n,r){const s=function JQ(i){return i&&i instanceof vM||function $Q(i){return i&&Ti(i.next)&&Ti(i.error)&&Ti(i.complete)}(i)&&J2(i)}(t)?t:new mv(t,n,r);return pv(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return new(n=nP(n))((r,s)=>{const o=new mv({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(t)}[xM](){return this}pipe(...t){return iP(t)(this)}toPromise(t){return new(t=nP(t))((n,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>n(s))})}}return i.create=e=>new i(e),i})();function nP(i){var e;return null!==(e=i??md.Promise)&&void 0!==e?e:Promise}const e6=mM(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Wt=(()=>{class i extends Oi{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const n=new rP(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new e6}next(t){pv(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(t)}})}error(t){pv(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){pv(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:n,isStopped:r,observers:s}=this;return n||r?$2:(this.currentObservers=null,s.push(t),new un(()=>{this.currentObservers=null,hv(s,t)}))}_checkFinalizedStatuses(t){const{hasError:n,thrownError:r,isStopped:s}=this;n?t.error(r):s&&t.complete()}asObservable(){const t=new Oi;return t.source=this,t}}return i.create=(e,t)=>new rP(e,t),i})();class rP extends Wt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:$2}}function sP(i){return Ti(i?.lift)}function Mn(i){return e=>{if(sP(e))return e.lift(function(t){try{return i(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function hn(i,e,t,n,r){return new t6(i,e,t,n,r)}class t6 extends vM{constructor(e,t,n,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function wt(i,e){return Mn((t,n)=>{let r=0;t.subscribe(hn(n,s=>{n.next(i.call(e,s,r++))}))})}function _d(i){return this instanceof _d?(this.v=i,this):new _d(i)}function r6(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,n=t.apply(i,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(h){n[h]&&(r[h]=function(f){return new Promise(function(m,_){s.push([h,f,m,_])>1||a(h,f)})})}function a(h,f){try{!function l(h){h.value instanceof _d?Promise.resolve(h.value.v).then(c,d):u(s[0][2],h)}(n[h](f))}catch(m){u(s[0][3],m)}}function c(h){a("next",h)}function d(h){a("throw",h)}function u(h,f){h(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}function s6(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=i[Symbol.asyncIterator];return e?e.call(i):(i=function lP(i){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=i[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=i[s](o)).done,o.value)})}}}const CM=i=>i&&"number"==typeof i.length&&"function"!=typeof i;function cP(i){return Ti(i?.then)}function dP(i){return Ti(i[xM])}function uP(i){return Symbol.asyncIterator&&Ti(i?.[Symbol.asyncIterator])}function hP(i){return new TypeError(`You provided ${null!==i&&"object"==typeof i?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const fP=function a6(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function pP(i){return Ti(i?.[fP])}function mP(i){return r6(this,arguments,function*(){const t=i.getReader();try{for(;;){const{value:n,done:r}=yield _d(t.read());if(r)return yield _d(void 0);yield yield _d(n)}}finally{t.releaseLock()}})}function gP(i){return Ti(i?.getReader)}function _s(i){if(i instanceof Oi)return i;if(null!=i){if(dP(i))return function l6(i){return new Oi(e=>{const t=i[xM]();if(Ti(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(i);if(CM(i))return function c6(i){return new Oi(e=>{for(let t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}(i);if(cP(i))return function d6(i){return new Oi(e=>{i.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,tP)})}(i);if(uP(i))return _P(i);if(pP(i))return function u6(i){return new Oi(e=>{for(const t of i)if(e.next(t),e.closed)return;e.complete()})}(i);if(gP(i))return function h6(i){return _P(mP(i))}(i)}throw hP(i)}function _P(i){return new Oi(e=>{(function f6(i,e){var t,n,r,s;return function i6(i,e,t,n){return new(t||(t=Promise))(function(s,o){function a(d){try{c(n.next(d))}catch(u){o(u)}}function l(d){try{c(n.throw(d))}catch(u){o(u)}}function c(d){d.done?s(d.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(d.value).then(a,l)}c((n=n.apply(i,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=s6(i);!(n=yield t.next()).done;)if(e.next(n.value),e.closed)return}catch(o){r={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(i,e).catch(t=>e.error(t))})}function ol(i,e,t,n=0,r=!1){const s=e.schedule(function(){t(),r?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(s),!r)return s}function wr(i,e,t=1/0){return Ti(e)?wr((n,r)=>wt((s,o)=>e(n,s,r,o))(_s(i(n,r))),t):("number"==typeof e&&(t=e),Mn((n,r)=>function p6(i,e,t,n,r,s,o,a){const l=[];let c=0,d=0,u=!1;const h=()=>{u&&!l.length&&!c&&e.complete()},f=_=>c<n?m(_):l.push(_),m=_=>{s&&e.next(_),c++;let g=!1;_s(t(_,d++)).subscribe(hn(e,p=>{r?.(p),s?f(p):e.next(p)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;l.length&&c<n;){const p=l.shift();o?ol(e,o,()=>m(p)):m(p)}h()}catch(p){e.error(p)}}))};return i.subscribe(hn(e,f,()=>{u=!0,h()})),()=>{a?.()}}(n,r,i,t)))}function Ch(i=1/0){return wr(Xl,i)}const Or=new Oi(i=>i.complete());function bP(i){return i&&Ti(i.schedule)}function MM(i){return i[i.length-1]}function EM(i){return Ti(MM(i))?i.pop():void 0}function Fg(i){return bP(MM(i))?i.pop():void 0}function vP(i,e=0){return Mn((t,n)=>{t.subscribe(hn(n,r=>ol(n,i,()=>n.next(r),e),()=>ol(n,i,()=>n.complete(),e),r=>ol(n,i,()=>n.error(r),e)))})}function AP(i,e=0){return Mn((t,n)=>{n.add(i.schedule(()=>t.subscribe(n),e))})}function yP(i,e){if(!i)throw new Error("Iterable cannot be null");return new Oi(t=>{ol(t,e,()=>{const n=i[Symbol.asyncIterator]();ol(t,e,()=>{n.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function En(i,e){return e?function x6(i,e){if(null!=i){if(dP(i))return function _6(i,e){return _s(i).pipe(AP(e),vP(e))}(i,e);if(CM(i))return function v6(i,e){return new Oi(t=>{let n=0;return e.schedule(function(){n===i.length?t.complete():(t.next(i[n++]),t.closed||this.schedule())})})}(i,e);if(cP(i))return function b6(i,e){return _s(i).pipe(AP(e),vP(e))}(i,e);if(uP(i))return yP(i,e);if(pP(i))return function A6(i,e){return new Oi(t=>{let n;return ol(t,e,()=>{n=i[fP](),ol(t,e,()=>{let r,s;try{({value:r,done:s}=n.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>Ti(n?.return)&&n.return()})}(i,e);if(gP(i))return function y6(i,e){return yP(mP(i),e)}(i,e)}throw hP(i)}(i,e):_s(i)}function bd(...i){const e=Fg(i),t=function g6(i,e){return"number"==typeof MM(i)?i.pop():e}(i,1/0),n=i;return n.length?1===n.length?_s(n[0]):Ch(t)(En(n,e)):Or}function bs(i){return i<=0?()=>Or:Mn((e,t)=>{let n=0;e.subscribe(hn(t,r=>{++n<=i&&(t.next(r),i<=n&&t.complete())}))})}function SM(i={}){const{connector:e=(()=>new Wt),resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:r=!0}=i;return s=>{let o=null,a=null,l=null,c=0,d=!1,u=!1;const h=()=>{a?.unsubscribe(),a=null},f=()=>{h(),o=l=null,d=u=!1},m=()=>{const _=o;f(),_?.unsubscribe()};return Mn((_,g)=>{c++,!u&&!d&&h();const p=l=l??e();g.add(()=>{c--,0===c&&!u&&!d&&(a=TM(m,r))}),p.subscribe(g),o||(o=new mv({next:v=>p.next(v),error:v=>{u=!0,h(),a=TM(f,t,v),p.error(v)},complete:()=>{d=!0,h(),a=TM(f,n),p.complete()}}),En(_).subscribe(o))})(s)}}function TM(i,e,...t){return!0===e?(i(),null):!1===e?null:e(...t).pipe(bs(1)).subscribe(()=>i())}function en(i){for(let e in i)if(i[e]===en)return e;throw Error("Could not find renamed property on target object.")}function RM(i,e){for(const t in e)e.hasOwnProperty(t)&&!i.hasOwnProperty(t)&&(i[t]=e[t])}function sn(i){if("string"==typeof i)return i;if(Array.isArray(i))return"["+i.map(sn).join(", ")+"]";if(null==i)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;const e=i.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function IM(i,e){return null==i||""===i?null===e?"":e:null==e||""===e?i:i+" "+e}const w6=en({__forward_ref__:en});function ae(i){return i.__forward_ref__=ae,i.toString=function(){return sn(this())},i}function Ut(i){return DM(i)?i():i}function DM(i){return"function"==typeof i&&i.hasOwnProperty(w6)&&i.__forward_ref__===ae}function PM(i){return i&&!!i.\u0275providers}const _v="https://g.co/ng/security#xss";class Pe extends Error{constructor(e,t){super(function bv(i,e){return`NG0${Math.abs(i)}${e?": "+e.trim():""}`}(e,t)),this.code=e}}function Yt(i){return"string"==typeof i?i:null==i?"":String(i)}function vv(i,e){throw new Pe(-201,!1)}function go(i,e){null==i&&function Gi(i,e,t,n){throw new Error(`ASSERTION ERROR: ${i}`+(null==n?"":` [Expected=> ${t} ${n} ${e} <=Actual]`))}(e,i,null,"!=")}function He(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function si(i){return{providers:i.providers||[],imports:i.imports||[]}}function Av(i){return xP(i,yv)||xP(i,CP)}function xP(i,e){return i.hasOwnProperty(e)?i[e]:null}function wP(i){return i&&(i.hasOwnProperty(kM)||i.hasOwnProperty(P6))?i[kM]:null}const yv=en({\u0275prov:en}),kM=en({\u0275inj:en}),CP=en({ngInjectableDef:en}),P6=en({ngInjectorDef:en});var Vt=(()=>((Vt=Vt||{})[Vt.Default=0]="Default",Vt[Vt.Host=1]="Host",Vt[Vt.Self=2]="Self",Vt[Vt.SkipSelf=4]="SkipSelf",Vt[Vt.Optional=8]="Optional",Vt))();let BM;function _o(i){const e=BM;return BM=i,e}function MP(i,e,t){const n=Av(i);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:t&Vt.Optional?null:void 0!==e?e:void vv(sn(i))}const on=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Og={},LM="__NG_DI_FLAG__",xv="ngTempTokenPath",L6=/\n/gm,EP="__source";let Ng;function Mh(i){const e=Ng;return Ng=i,e}function O6(i,e=Vt.Default){if(void 0===Ng)throw new Pe(-203,!1);return null===Ng?MP(i,void 0,e):Ng.get(i,e&Vt.Optional?null:void 0,e)}function xe(i,e=Vt.Default){return(function k6(){return BM}()||O6)(Ut(i),e)}function Et(i,e=Vt.Default){return xe(i,wv(e))}function wv(i){return typeof i>"u"||"number"==typeof i?i:0|(i.optional&&8)|(i.host&&1)|(i.self&&2)|(i.skipSelf&&4)}function FM(i){const e=[];for(let t=0;t<i.length;t++){const n=Ut(i[t]);if(Array.isArray(n)){if(0===n.length)throw new Pe(900,!1);let r,s=Vt.Default;for(let o=0;o<n.length;o++){const a=n[o],l=N6(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(xe(r,s))}else e.push(xe(n))}return e}function jg(i,e){return i[LM]=e,i.prototype[LM]=e,i}function N6(i){return i[LM]}function Kl(i){return{toString:i}.toString()}var Ho=(()=>((Ho=Ho||{})[Ho.OnPush=0]="OnPush",Ho[Ho.Default=1]="Default",Ho))(),Qo=(()=>{return(i=Qo||(Qo={}))[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",Qo;var i})();const al={},Ni=[],Cv=en({\u0275cmp:en}),OM=en({\u0275dir:en}),NM=en({\u0275pipe:en}),TP=en({\u0275mod:en}),ll=en({\u0275fac:en}),Ug=en({__NG_ELEMENT_ID__:en});let V6=0;function $(i){return Kl(()=>{const t=!0===i.standalone,n={},r={type:i.type,providersResolver:null,decls:i.decls,vars:i.vars,factory:null,template:i.template||null,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:i.exportAs||null,onPush:i.changeDetection===Ho.OnPush,directiveDefs:null,pipeDefs:null,standalone:t,dependencies:t&&i.dependencies||null,getStandaloneInjector:null,selectors:i.selectors||Ni,viewQuery:i.viewQuery||null,features:i.features||null,data:i.data||{},encapsulation:i.encapsulation||Qo.Emulated,id:"c"+V6++,styles:i.styles||Ni,_:null,setInput:null,schemas:i.schemas||null,tView:null,findHostDirectiveDefs:null,hostDirectives:null},s=i.dependencies,o=i.features;return r.inputs=DP(i.inputs,n),r.outputs=DP(i.outputs),o&&o.forEach(a=>a(r)),r.directiveDefs=s?()=>("function"==typeof s?s():s).map(RP).filter(IP):null,r.pipeDefs=s?()=>("function"==typeof s?s():s).map(Kr).filter(IP):null,r})}function RP(i){return Hi(i)||Nr(i)}function IP(i){return null!==i}function li(i){return Kl(()=>({type:i.type,bootstrap:i.bootstrap||Ni,declarations:i.declarations||Ni,imports:i.imports||Ni,exports:i.exports||Ni,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null}))}function DP(i,e){if(null==i)return al;const t={};for(const n in i)if(i.hasOwnProperty(n)){let r=i[n],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=n,e&&(e[r]=s)}return t}const Ne=$;function _i(i){return{type:i.type,name:i.name,factory:null,pure:!1!==i.pure,standalone:!0===i.standalone,onDestroy:i.type.prototype.ngOnDestroy||null}}function Hi(i){return i[Cv]||null}function Nr(i){return i[OM]||null}function Kr(i){return i[NM]||null}function Us(i,e){const t=i[TP]||null;if(!t&&!0===e)throw new Error(`Type ${sn(i)} does not have '\u0275mod' property.`);return t}function Vs(i){return Array.isArray(i)&&"object"==typeof i[1]}function qo(i){return Array.isArray(i)&&!0===i[1]}function VM(i){return 0!=(4&i.flags)}function Hg(i){return i.componentOffset>-1}function Rv(i){return 1==(1&i.flags)}function Yo(i){return null!==i.template}function H6(i){return 0!=(256&i[2])}function Ad(i,e){return i.hasOwnProperty(ll)?i[ll]:null}class q6{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function Cr(){return OP}function OP(i){return i.type.prototype.ngOnChanges&&(i.setInput=X6),Y6}function Y6(){const i=jP(this),e=i?.current;if(e){const t=i.previous;if(t===al)i.previous=e;else for(let n in e)t[n]=e[n];i.current=null,this.ngOnChanges(e)}}function X6(i,e,t,n){const r=this.declaredInputs[t],s=jP(i)||function Z6(i,e){return i[NP]=e}(i,{previous:al,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[r];o[r]=new q6(l&&l.currentValue,e,a===al),i[n]=e}Cr.ngInherit=!0;const NP="__ngSimpleChanges__";function jP(i){return i[NP]||null}function Tr(i){for(;Array.isArray(i);)i=i[0];return i}function Iv(i,e){return Tr(e[i])}function zs(i,e){return Tr(e[i.index])}function zP(i,e){return i.data[e]}function Dh(i,e){return i[e]}function Gs(i,e){const t=e[i];return Vs(t)?t:t[0]}function Dv(i){return 64==(64&i[2])}function $l(i,e){return null==e?null:i[e]}function GP(i){i[18]=0}function GM(i,e){i[5]+=e;let t=i,n=i[3];for(;null!==n&&(1===e&&1===t[5]||-1===e&&0===t[5]);)n[5]+=e,t=n,n=n[3]}const Xt={lFrame:JP(null),bindingsEnabled:!0};function QP(){return Xt.bindingsEnabled}function ze(){return Xt.lFrame.lView}function Ri(){return Xt.lFrame.tView}function nr(i){return Xt.lFrame.contextLView=i,i[8]}function rr(i){return Xt.lFrame.contextLView=null,i}function Rr(){let i=WP();for(;null!==i&&64===i.type;)i=i.parent;return i}function WP(){return Xt.lFrame.currentTNode}function va(i,e){const t=Xt.lFrame;t.currentTNode=i,t.isParent=e}function HM(){return Xt.lFrame.isParent}function QM(){Xt.lFrame.isParent=!1}function Jr(){const i=Xt.lFrame;let e=i.bindingRootIndex;return-1===e&&(e=i.bindingRootIndex=i.tView.bindingStartIndex),e}function Ph(){return Xt.lFrame.bindingIndex++}function ul(i){const e=Xt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+i,t}function cW(i,e){const t=Xt.lFrame;t.bindingIndex=t.bindingRootIndex=i,WM(e)}function WM(i){Xt.lFrame.currentDirectiveIndex=i}function qM(i){const e=Xt.lFrame.currentDirectiveIndex;return-1===e?null:i[e]}function ZP(){return Xt.lFrame.currentQueryIndex}function YM(i){Xt.lFrame.currentQueryIndex=i}function uW(i){const e=i[1];return 2===e.type?e.declTNode:1===e.type?i[6]:null}function KP(i,e,t){if(t&Vt.SkipSelf){let r=e,s=i;for(;!(r=r.parent,null!==r||t&Vt.Host||(r=uW(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,i=s}const n=Xt.lFrame=$P();return n.currentTNode=e,n.lView=i,!0}function XM(i){const e=$P(),t=i[1];Xt.lFrame=e,e.currentTNode=t.firstChild,e.lView=i,e.tView=t,e.contextLView=i,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function $P(){const i=Xt.lFrame,e=null===i?null:i.child;return null===e?JP(i):e}function JP(i){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return null!==i&&(i.child=e),e}function ek(){const i=Xt.lFrame;return Xt.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}const tk=ek;function ZM(){const i=ek();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function es(){return Xt.lFrame.selectedIndex}function yd(i){Xt.lFrame.selectedIndex=i}function Sn(){const i=Xt.lFrame;return zP(i.tView,i.selectedIndex)}function Pv(i,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){const s=i.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:d}=s;o&&(i.contentHooks||(i.contentHooks=[])).push(-t,o),a&&((i.contentHooks||(i.contentHooks=[])).push(t,a),(i.contentCheckHooks||(i.contentCheckHooks=[])).push(t,a)),l&&(i.viewHooks||(i.viewHooks=[])).push(-t,l),c&&((i.viewHooks||(i.viewHooks=[])).push(t,c),(i.viewCheckHooks||(i.viewCheckHooks=[])).push(t,c)),null!=d&&(i.destroyHooks||(i.destroyHooks=[])).push(t,d)}}function kv(i,e,t){rk(i,e,3,t)}function Bv(i,e,t,n){(3&i[2])===t&&rk(i,e,t,n)}function KM(i,e){let t=i[2];(3&t)===e&&(t&=2047,t+=1,i[2]=t)}function rk(i,e,t,n){const s=n??-1,o=e.length-1;let a=0;for(let l=void 0!==n?65535&i[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=n&&a>=n)break}else e[l]<0&&(i[18]+=65536),(a<s||-1==s)&&(bW(i,t,e,l),i[18]=(4294901760&i[18])+l+2),l++}function bW(i,e,t,n){const r=t[n]<0,s=t[n+1],a=i[r?-t[n]:t[n]];if(r){if(i[2]>>11<i[18]>>16&&(3&i[2])===e){i[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class Wg{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function JM(i,e,t){let n=0;for(;n<t.length;){const r=t[n];if("number"==typeof r){if(0!==r)break;n++;const s=t[n++],o=t[n++],a=t[n++];i.setAttribute(e,o,a,s)}else{const s=r,o=t[++n];ok(s)?i.setProperty(e,s,o):i.setAttribute(e,s,o),n++}}return n}function sk(i){return 3===i||4===i||6===i}function ok(i){return 64===i.charCodeAt(0)}function qg(i,e){if(null!==e&&0!==e.length)if(null===i||0===i.length)i=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){const r=e[n];"number"==typeof r?t=r:0===t||ak(i,t,r,null,-1===t||2===t?e[++n]:null)}}return i}function ak(i,e,t,n,r){let s=0,o=i.length;if(-1===e)o=-1;else for(;s<i.length;){const a=i[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<i.length;){const a=i[s];if("number"==typeof a)break;if(a===t){if(null===n)return void(null!==r&&(i[s+1]=r));if(n===i[s+1])return void(i[s+2]=r)}s++,null!==n&&s++,null!==r&&s++}-1!==o&&(i.splice(o,0,e),s=o+1),i.splice(s++,0,t),null!==n&&i.splice(s++,0,n),null!==r&&i.splice(s++,0,r)}function lk(i){return-1!==i}function Lv(i){return 32767&i}function Fv(i,e){let t=function xW(i){return i>>16}(i),n=e;for(;t>0;)n=n[15],t--;return n}let e1=!0;function Ov(i){const e=e1;return e1=i,e}let wW=0;const Aa={};function Nv(i,e){const t=uk(i,e);if(-1!==t)return t;const n=e[1];n.firstCreatePass&&(i.injectorIndex=e.length,t1(n.data,i),t1(e,null),t1(n.blueprint,null));const r=n1(i,e),s=i.injectorIndex;if(lk(r)){const o=Lv(r),a=Fv(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function t1(i,e){i.push(0,0,0,0,0,0,0,0,e)}function uk(i,e){return-1===i.injectorIndex||i.parent&&i.parent.injectorIndex===i.injectorIndex||null===e[i.injectorIndex+8]?-1:i.injectorIndex}function n1(i,e){if(i.parent&&-1!==i.parent.injectorIndex)return i.parent.injectorIndex;let t=0,n=null,r=e;for(;null!==r;){if(n=bk(r),null===n)return-1;if(t++,r=r[15],-1!==n.injectorIndex)return n.injectorIndex|t<<16}return-1}function r1(i,e,t){!function CW(i,e,t){let n;"string"==typeof t?n=t.charCodeAt(0)||0:t.hasOwnProperty(Ug)&&(n=t[Ug]),null==n&&(n=t[Ug]=wW++);const r=255&n;e.data[i+(r>>5)]|=1<<r}(i,e,t)}function hk(i,e,t){if(t&Vt.Optional||void 0!==i)return i;vv()}function fk(i,e,t,n){if(t&Vt.Optional&&void 0===n&&(n=null),!(t&(Vt.Self|Vt.Host))){const r=i[9],s=_o(void 0);try{return r?r.get(e,n,t&Vt.Optional):MP(e,n,t&Vt.Optional)}finally{_o(s)}}return hk(n,0,t)}function pk(i,e,t,n=Vt.Default,r){if(null!==i){if(1024&e[2]){const o=function RW(i,e,t,n,r){let s=i,o=e;for(;null!==s&&null!==o&&1024&o[2]&&!(256&o[2]);){const a=mk(s,o,t,n|Vt.Self,Aa);if(a!==Aa)return a;let l=s.parent;if(!l){const c=o[21];if(c){const d=c.get(t,Aa,n);if(d!==Aa)return d}l=bk(o),o=o[15]}s=l}return r}(i,e,t,n,Aa);if(o!==Aa)return o}const s=mk(i,e,t,n,Aa);if(s!==Aa)return s}return fk(e,t,n,r)}function mk(i,e,t,n,r){const s=function SW(i){if("string"==typeof i)return i.charCodeAt(0)||0;const e=i.hasOwnProperty(Ug)?i[Ug]:void 0;return"number"==typeof e?e>=0?255&e:TW:e}(t);if("function"==typeof s){if(!KP(e,i,n))return n&Vt.Host?hk(r,0,n):fk(e,t,n,r);try{const o=s(n);if(null!=o||n&Vt.Optional)return o;vv()}finally{tk()}}else if("number"==typeof s){let o=null,a=uk(i,e),l=-1,c=n&Vt.Host?e[16][6]:null;for((-1===a||n&Vt.SkipSelf)&&(l=-1===a?n1(i,e):e[a+8],-1!==l&&_k(n,!1)?(o=e[1],a=Lv(l),e=Fv(l,e)):a=-1);-1!==a;){const d=e[1];if(gk(s,a,d.data)){const u=EW(a,e,t,o,n,c);if(u!==Aa)return u}l=e[a+8],-1!==l&&_k(n,e[1].data[a+8]===c)&&gk(s,a,e)?(o=d,a=Lv(l),e=Fv(l,e)):a=-1}}return r}function EW(i,e,t,n,r,s){const o=e[1],a=o.data[i+8],d=jv(a,o,t,null==n?Hg(a)&&e1:n!=o&&0!=(3&a.type),r&Vt.Host&&s===a);return null!==d?xd(e,o,d,a):Aa}function jv(i,e,t,n,r){const s=i.providerIndexes,o=e.data,a=1048575&s,l=i.directiveStart,d=s>>20,h=r?a+d:i.directiveEnd;for(let f=n?a:a+d;f<h;f++){const m=o[f];if(f<l&&t===m||f>=l&&m.type===t)return f}if(r){const f=o[l];if(f&&Yo(f)&&f.type===t)return l}return null}function xd(i,e,t,n){let r=i[t];const s=e.data;if(function vW(i){return i instanceof Wg}(r)){const o=r;o.resolving&&function C6(i,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${i}`:"";throw new Pe(-200,`Circular dependency in DI detected for ${i}${t}`)}(function zi(i){return"function"==typeof i?i.name||i.toString():"object"==typeof i&&null!=i&&"function"==typeof i.type?i.type.name||i.type.toString():Yt(i)}(s[t]));const a=Ov(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?_o(o.injectImpl):null;KP(i,n,Vt.Default);try{r=i[t]=o.factory(void 0,s,i,n),e.firstCreatePass&&t>=n.directiveStart&&function _W(i,e,t){const{ngOnChanges:n,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(n){const o=OP(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(i,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(i,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-i,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(i,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(i,s))}(t,s[t],e)}finally{null!==l&&_o(l),Ov(a),o.resolving=!1,tk()}}return r}function gk(i,e,t){return!!(t[e+(i>>5)]&1<<i)}function _k(i,e){return!(i&Vt.Self||i&Vt.Host&&e)}class Bh{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return pk(this._tNode,this._lView,e,wv(n),t)}}function TW(){return new Bh(Rr(),ze())}function le(i){return Kl(()=>{const e=i.prototype.constructor,t=e[ll]||s1(e),n=Object.prototype;let r=Object.getPrototypeOf(i.prototype).constructor;for(;r&&r!==n;){const s=r[ll]||s1(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function s1(i){return DM(i)?()=>{const e=s1(Ut(i));return e&&e()}:Ad(i)}function bk(i){const e=i[1],t=e.type;return 2===t?e.declTNode:1===t?i[6]:null}function Yg(i){return function MW(i,e){if("class"===e)return i.classes;if("style"===e)return i.styles;const t=i.attrs;if(t){const n=t.length;let r=0;for(;r<n;){const s=t[r];if(sk(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<n&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(Rr(),i)}const Fh="__parameters__";function Nh(i,e,t){return Kl(()=>{const n=function o1(i){return function(...t){if(i){const n=i(...t);for(const r in n)this[r]=n[r]}}}(e);function r(...s){if(this instanceof r)return n.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,d){const u=l.hasOwnProperty(Fh)?l[Fh]:Object.defineProperty(l,Fh,{value:[]})[Fh];for(;u.length<=d;)u.push(null);return(u[d]=u[d]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=i,r.annotationCls=r,r})}class Oe{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=He({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function wd(i,e){i.forEach(t=>Array.isArray(t)?wd(t,e):e(t))}function Ak(i,e,t){e>=i.length?i.push(t):i.splice(e,0,t)}function Uv(i,e){return e>=i.length-1?i.pop():i.splice(e,1)[0]}function Kg(i,e){const t=[];for(let n=0;n<i;n++)t.push(e);return t}function Hs(i,e,t){let n=jh(i,e);return n>=0?i[1|n]=t:(n=~n,function kW(i,e,t,n){let r=i.length;if(r==e)i.push(t,n);else if(1===r)i.push(n,i[0]),i[0]=t;else{for(r--,i.push(i[r-1],i[r]);r>e;)i[r]=i[r-2],r--;i[e]=t,i[e+1]=n}}(i,n,e,t)),n}function l1(i,e){const t=jh(i,e);if(t>=0)return i[1|t]}function jh(i,e){return function yk(i,e,t){let n=0,r=i.length>>t;for(;r!==n;){const s=n+(r-n>>1),o=i[s<<t];if(e===o)return s<<t;o>e?r=s:n=s+1}return~(r<<t)}(i,e,1)}const zv=jg(Nh("Inject",i=>({token:i})),-1),hl=jg(Nh("Optional"),8),Uh=jg(Nh("SkipSelf"),4);var vs=(()=>((vs=vs||{})[vs.Important=1]="Important",vs[vs.DashCase=2]="DashCase",vs))();const f1=new Map;let t7=0;const m1="__ngContext__";function Vr(i,e){Vs(e)?(i[m1]=e[20],function r7(i){f1.set(i[20],i)}(e)):i[m1]=e}function _1(i,e){return undefined(i,e)}function t_(i){const e=i[3];return qo(e)?e[3]:e}function b1(i){return Vk(i[13])}function v1(i){return Vk(i[4])}function Vk(i){for(;null!==i&&!qo(i);)i=i[4];return i}function zh(i,e,t,n,r){if(null!=n){let s,o=!1;qo(n)?s=n:Vs(n)&&(o=!0,n=n[0]);const a=Tr(n);0===i&&null!==t?null==r?qk(e,t,a):Cd(e,t,a,r||null,!0):1===i&&null!==t?Cd(e,t,a,r||null,!0):2===i?function E1(i,e,t){const n=Qv(i,e);n&&function C7(i,e,t,n){i.removeChild(e,t,n)}(i,n,e,t)}(e,a,o):3===i&&e.destroyNode(a),null!=s&&function S7(i,e,t,n,r){const s=t[7];s!==Tr(t)&&zh(e,i,n,s,r);for(let a=10;a<t.length;a++){const l=t[a];i_(l[1],l,i,e,n,s)}}(e,i,s,t,r)}}function y1(i,e,t){return i.createElement(e,t)}function Gk(i,e){const t=i[9],n=t.indexOf(e),r=e[3];512&e[2]&&(e[2]&=-513,GM(r,-1)),t.splice(n,1)}function x1(i,e){if(i.length<=10)return;const t=10+e,n=i[t];if(n){const r=n[17];null!==r&&r!==i&&Gk(r,n),e>0&&(i[t-1][4]=n[4]);const s=Uv(i,10+e);!function g7(i,e){i_(i,e,e[11],2,null,null),e[0]=null,e[6]=null}(n[1],n);const o=s[19];null!==o&&o.detachView(s[1]),n[3]=null,n[4]=null,n[2]&=-65}return n}function Hk(i,e){if(!(128&e[2])){const t=e[11];t.destroyNode&&i_(i,e,t,3,null,null),function v7(i){let e=i[13];if(!e)return w1(i[1],i);for(;e;){let t=null;if(Vs(e))t=e[13];else{const n=e[10];n&&(t=n)}if(!t){for(;e&&!e[4]&&e!==i;)Vs(e)&&w1(e[1],e),e=e[3];null===e&&(e=i),Vs(e)&&w1(e[1],e),t=e&&e[4]}e=t}}(e)}}function w1(i,e){if(!(128&e[2])){e[2]&=-65,e[2]|=128,function w7(i,e){let t;if(null!=i&&null!=(t=i.destroyHooks))for(let n=0;n<t.length;n+=2){const r=e[t[n]];if(!(r instanceof Wg)){const s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(i,e),function x7(i,e){const t=i.cleanup,n=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?n[r=o]():n[r=-o].unsubscribe(),s+=2}else{const o=n[r=t[s+1]];t[s].call(o)}if(null!==n){for(let s=r+1;s<n.length;s++)(0,n[s])();e[7]=null}}(i,e),1===e[1].type&&e[11].destroy();const t=e[17];if(null!==t&&qo(e[3])){t!==e[3]&&Gk(t,e);const n=e[19];null!==n&&n.detachView(i)}!function s7(i){f1.delete(i[20])}(e)}}function Qk(i,e,t){return function Wk(i,e,t){let n=e;for(;null!==n&&40&n.type;)n=(e=n).parent;if(null===n)return t[0];{const{componentOffset:r}=n;if(r>-1){const{encapsulation:s}=i.data[n.directiveStart+r];if(s===Qo.None||s===Qo.Emulated)return null}return zs(n,t)}}(i,e.parent,t)}function Cd(i,e,t,n,r){i.insertBefore(e,t,n,r)}function qk(i,e,t){i.appendChild(e,t)}function Yk(i,e,t,n,r){null!==n?Cd(i,e,t,n,r):qk(i,e,t)}function Qv(i,e){return i.parentNode(e)}function Xk(i,e,t){return Kk(i,e,t)}let Yv,R1,Xv,Kk=function Zk(i,e,t){return 40&i.type?zs(i,t):null};function Wv(i,e,t,n){const r=Qk(i,n,e),s=e[11],a=Xk(n.parent||e[6],n,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)Yk(s,r,t[l],a,!1);else Yk(s,r,t,a,!1)}function qv(i,e){if(null!==e){const t=e.type;if(3&t)return zs(e,i);if(4&t)return M1(-1,i[e.index]);if(8&t){const n=e.child;if(null!==n)return qv(i,n);{const r=i[e.index];return qo(r)?M1(-1,r):Tr(r)}}if(32&t)return _1(e,i)()||Tr(i[e.index]);{const n=Jk(i,e);return null!==n?Array.isArray(n)?n[0]:qv(t_(i[16]),n):qv(i,e.next)}}return null}function Jk(i,e){return null!==e?i[16][6].projection[e.projection]:null}function M1(i,e){const t=10+i+1;if(t<e.length){const n=e[t],r=n[1].firstChild;if(null!==r)return qv(n,r)}return e[7]}function S1(i,e,t,n,r,s,o){for(;null!=t;){const a=n[t.index],l=t.type;if(o&&0===e&&(a&&Vr(Tr(a),n),t.flags|=2),32!=(32&t.flags))if(8&l)S1(i,e,t.child,n,r,s,!1),zh(e,i,r,a,s);else if(32&l){const c=_1(t,n);let d;for(;d=c();)zh(e,i,r,d,s);zh(e,i,r,a,s)}else 16&l?eB(i,e,n,t,r,s):zh(e,i,r,a,s);t=o?t.projectionNext:t.next}}function i_(i,e,t,n,r,s){S1(t,n,i.firstChild,e,r,s,!1)}function eB(i,e,t,n,r,s){const o=t[16],l=o[6].projection[n.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)zh(e,i,r,l[c],s);else S1(i,e,l,o[3],r,s,!0)}function tB(i,e,t){""===t?i.removeAttribute(e,"class"):i.setAttribute(e,"class",t)}function iB(i,e,t){const{mergedAttrs:n,classes:r,styles:s}=t;null!==n&&JM(i,e,n),null!==r&&tB(i,e,r),null!==s&&function R7(i,e,t){i.setAttribute(e,"style",t)}(i,e,s)}function Md(i){return function T1(){if(void 0===Yv&&(Yv=null,on.trustedTypes))try{Yv=on.trustedTypes.createPolicy("angular",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch{}return Yv}()?.createHTML(i)||i}function oB(i){return function I1(){if(void 0===Xv&&(Xv=null,on.trustedTypes))try{Xv=on.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch{}return Xv}()?.createScriptURL(i)||i}class Ed{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${_v})`}}class B7 extends Ed{getTypeName(){return"HTML"}}class L7 extends Ed{getTypeName(){return"Style"}}class F7 extends Ed{getTypeName(){return"Script"}}class O7 extends Ed{getTypeName(){return"URL"}}class N7 extends Ed{getTypeName(){return"ResourceURL"}}function Qs(i){return i instanceof Ed?i.changingThisBreaksApplicationSecurity:i}function ya(i,e){const t=function j7(i){return i instanceof Ed&&i.getTypeName()||null}(i);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${_v})`)}return t===e}class Q7{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(Md(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class W7{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const n=this.inertDocument.createElement("body");t.appendChild(n)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=Md(e),t;const n=this.inertDocument.createElement("body");return n.innerHTML=Md(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(e){const t=e.attributes;for(let r=t.length-1;0<r;r--){const o=t.item(r).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&e.removeAttribute(o)}let n=e.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const Y7=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function Zv(i){return(i=String(i)).match(Y7)?i:"unsafe:"+i}function fl(i){const e={};for(const t of i.split(","))e[t]=!0;return e}function n_(...i){const e={};for(const t of i)for(const n in t)t.hasOwnProperty(n)&&(e[n]=!0);return e}const lB=fl("area,br,col,hr,img,wbr"),cB=fl("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),dB=fl("rp,rt"),D1=n_(lB,n_(cB,fl("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),n_(dB,fl("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),n_(dB,cB)),P1=fl("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),uB=n_(P1,fl("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),fl("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),X7=fl("script,style,template");class Z7{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!D1.hasOwnProperty(t))return this.sanitizedSomething=!0,!X7.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let r=0;r<n.length;r++){const s=n.item(r),o=s.name,a=o.toLowerCase();if(!uB.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;P1[a]&&(l=Zv(l)),this.buf.push(" ",o,'="',hB(l),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();D1.hasOwnProperty(t)&&!lB.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(hB(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const K7=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,$7=/([^\#-~ |!])/g;function hB(i){return i.replace(/&/g,"&amp;").replace(K7,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace($7,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Kv;function fB(i,e){let t=null;try{Kv=Kv||function aB(i){const e=new W7(i);return function q7(){try{return!!(new window.DOMParser).parseFromString(Md(""),"text/html")}catch{return!1}}()?new Q7(e):e}(i);let n=e?String(e):"";t=Kv.getInertBodyElement(n);let r=5,s=n;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,n=s,s=t.innerHTML,t=Kv.getInertBodyElement(n)}while(n!==s);return Md((new Z7).sanitizeChildren(k1(t)||t))}finally{if(t){const n=k1(t)||t;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function k1(i){return"content"in i&&function J7(i){return i.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===i.nodeName}(i)?i.content:null}var Bi=(()=>((Bi=Bi||{})[Bi.NONE=0]="NONE",Bi[Bi.HTML=1]="HTML",Bi[Bi.STYLE=2]="STYLE",Bi[Bi.SCRIPT=3]="SCRIPT",Bi[Bi.URL=4]="URL",Bi[Bi.RESOURCE_URL=5]="RESOURCE_URL",Bi))();function pB(i){const e=r_();return e?e.sanitize(Bi.URL,i)||"":ya(i,"URL")?Qs(i):Zv(Yt(i))}function mB(i){const e=r_();if(e)return oB(e.sanitize(Bi.RESOURCE_URL,i)||"");if(ya(i,"ResourceURL"))return oB(Qs(i));throw new Pe(904,!1)}function r_(){const i=ze();return i&&i[12]}const $v=new Oe("ENVIRONMENT_INITIALIZER"),_B=new Oe("INJECTOR",-1),bB=new Oe("INJECTOR_DEF_TYPES");class vB{get(e,t=Og){if(t===Og){const n=new Error(`NullInjectorError: No provider for ${sn(e)}!`);throw n.name="NullInjectorError",n}return t}}function a9(...i){return{\u0275providers:AB(0,i),\u0275fromNgModule:!0}}function AB(i,...e){const t=[],n=new Set;let r;return wd(e,s=>{const o=s;B1(o,t,[],n)&&(r||(r=[]),r.push(o))}),void 0!==r&&yB(r,t),t}function yB(i,e){for(let t=0;t<i.length;t++){const{providers:r}=i[t];L1(r,s=>{e.push(s)})}}function B1(i,e,t,n){if(!(i=Ut(i)))return!1;let r=null,s=wP(i);const o=!s&&Hi(i);if(s||o){if(o&&!o.standalone)return!1;r=i}else{const l=i.ngModule;if(s=wP(l),!s)return!1;r=l}const a=n.has(r);if(o){if(a)return!1;if(n.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)B1(c,e,t,n)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;n.add(r);try{wd(s.imports,d=>{B1(d,e,t,n)&&(c||(c=[]),c.push(d))})}finally{}void 0!==c&&yB(c,e)}if(!a){const c=Ad(r)||(()=>new r);e.push({provide:r,useFactory:c,deps:Ni},{provide:bB,useValue:r,multi:!0},{provide:$v,useValue:()=>xe(r),multi:!0})}const l=s.providers;null==l||a||L1(l,d=>{e.push(d)})}}return r!==i&&void 0!==i.providers}function L1(i,e){for(let t of i)PM(t)&&(t=t.\u0275providers),Array.isArray(t)?L1(t,e):e(t)}const l9=en({provide:String,useValue:en});function F1(i){return null!==i&&"object"==typeof i&&l9 in i}function Sd(i){return"function"==typeof i}const O1=new Oe("Set Injector scope."),Jv={},d9={};let N1;function eA(){return void 0===N1&&(N1=new vB),N1}class xa{}class CB extends xa{get destroyed(){return this._destroyed}constructor(e,t,n,r){super(),this.parent=t,this.source=n,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,U1(e,o=>this.processProvider(o)),this.records.set(_B,Gh(void 0,this)),r.has("environment")&&this.records.set(xa,Gh(void 0,this));const s=this.records.get(O1);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(bB.multi,Ni,Vt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}runInContext(e){this.assertNotDestroyed();const t=Mh(this),n=_o(void 0);try{return e()}finally{Mh(t),_o(n)}}get(e,t=Og,n=Vt.Default){this.assertNotDestroyed(),n=wv(n);const r=Mh(this),s=_o(void 0);try{if(!(n&Vt.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function m9(i){return"function"==typeof i||"object"==typeof i&&i instanceof Oe}(e)&&Av(e);a=l&&this.injectableDefInScope(l)?Gh(j1(e),Jv):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(n&Vt.Self?eA():this.parent).get(e,t=n&Vt.Optional&&t===Og?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[xv]=o[xv]||[]).unshift(sn(e)),r)throw o;return function j6(i,e,t,n){const r=i[xv];throw e[EP]&&r.unshift(e[EP]),i.message=function U6(i,e,t,n=null){i=i&&"\n"===i.charAt(0)&&"\u0275"==i.charAt(1)?i.slice(2):i;let r=sn(e);if(Array.isArray(e))r=e.map(sn).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):sn(a)))}r=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${r}]: ${i.replace(L6,"\n  ")}`}("\n"+i.message,r,t,n),i.ngTokenPath=r,i[xv]=null,i}(o,e,"R3InjectorError",this.source)}throw o}finally{_o(s),Mh(r)}}resolveInjectorInitializers(){const e=Mh(this),t=_o(void 0);try{const n=this.get($v.multi,Ni,Vt.Self);for(const r of n)r()}finally{Mh(e),_o(t)}}toString(){const e=[],t=this.records;for(const n of t.keys())e.push(sn(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Pe(205,!1)}processProvider(e){let t=Sd(e=Ut(e))?e:Ut(e&&e.provide);const n=function h9(i){return F1(i)?Gh(void 0,i.useValue):Gh(MB(i),Jv)}(e);if(Sd(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=Gh(void 0,Jv,!0),r.factory=()=>FM(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,n)}hydrate(e,t){return t.value===Jv&&(t.value=d9,t.value=t.factory()),"object"==typeof t.value&&t.value&&function p9(i){return null!==i&&"object"==typeof i&&"function"==typeof i.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Ut(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}}function j1(i){const e=Av(i),t=null!==e?e.factory:Ad(i);if(null!==t)return t;if(i instanceof Oe)throw new Pe(204,!1);if(i instanceof Function)return function u9(i){const e=i.length;if(e>0)throw Kg(e,"?"),new Pe(204,!1);const t=function I6(i){const e=i&&(i[yv]||i[CP]);if(e){const t=function D6(i){if(i.hasOwnProperty("name"))return i.name;const e=(""+i).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(i);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(i);return null!==t?()=>t.factory(i):()=>new i}(i);throw new Pe(204,!1)}function MB(i,e,t){let n;if(Sd(i)){const r=Ut(i);return Ad(r)||j1(r)}if(F1(i))n=()=>Ut(i.useValue);else if(function wB(i){return!(!i||!i.useFactory)}(i))n=()=>i.useFactory(...FM(i.deps||[]));else if(function xB(i){return!(!i||!i.useExisting)}(i))n=()=>xe(Ut(i.useExisting));else{const r=Ut(i&&(i.useClass||i.provide));if(!function f9(i){return!!i.deps}(i))return Ad(r)||j1(r);n=()=>new r(...FM(i.deps))}return n}function Gh(i,e,t=!1){return{factory:i,value:e,multi:t?[]:void 0}}function U1(i,e){for(const t of i)Array.isArray(t)?U1(t,e):t&&PM(t)?U1(t.\u0275providers,e):e(t)}class g9{}class EB{}class b9{resolveComponentFactory(e){throw function _9(i){const e=Error(`No component factory found for ${sn(i)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=i,e}(e)}}let Jl=(()=>{class i{}return i.NULL=new b9,i})();function v9(){return Hh(Rr(),ze())}function Hh(i,e){return new Ft(zs(i,e))}let Ft=(()=>{class i{constructor(t){this.nativeElement=t}}return i.__NG_ELEMENT_ID__=v9,i})();function A9(i){return i instanceof Ft?i.nativeElement:i}class s_{}let pl=(()=>{class i{}return i.__NG_ELEMENT_ID__=()=>function y9(){const i=ze(),t=Gs(Rr().index,i);return(Vs(t)?t:i)[11]}(),i})(),x9=(()=>{class i{}return i.\u0275prov=He({token:i,providedIn:"root",factory:()=>null}),i})();class Td{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const w9=new Td("15.1.1"),V1={};function G1(i){return i.ngOriginalError}class ml{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&G1(e);for(;t&&G1(t);)t=G1(t);return t||null}}function H1(i){return i.ownerDocument.defaultView}function tA(i){return i.ownerDocument}function gl(i){return i instanceof Function?i():i}function RB(i,e,t){let n=i.length;for(;;){const r=i.indexOf(e,t);if(-1===r)return r;if(0===r||i.charCodeAt(r-1)<=32){const s=e.length;if(r+s===n||i.charCodeAt(r+s)<=32)return r}t=r+1}}const IB="ng-template";function P9(i,e,t){let n=0;for(;n<i.length;){let r=i[n++];if(t&&"class"===r){if(r=i[n],-1!==RB(r.toLowerCase(),e,0))return!0}else if(1===r){for(;n<i.length&&"string"==typeof(r=i[n++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function DB(i){return 4===i.type&&i.value!==IB}function k9(i,e,t){return e===(4!==i.type||t?i.value:IB)}function B9(i,e,t){let n=4;const r=i.attrs||[],s=function O9(i){for(let e=0;e<i.length;e++)if(sk(i[e]))return e;return i.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&n){if(n=2|1&n,""!==l&&!k9(i,l,t)||""===l&&1===e.length){if(Xo(n))return!1;o=!0}}else{const c=8&n?l:e[++a];if(8&n&&null!==i.attrs){if(!P9(i.attrs,c,t)){if(Xo(n))return!1;o=!0}continue}const u=L9(8&n?"class":l,r,DB(i),t);if(-1===u){if(Xo(n))return!1;o=!0;continue}if(""!==c){let h;h=u>s?"":r[u+1].toLowerCase();const f=8&n?h:null;if(f&&-1!==RB(f,c,0)||2&n&&c!==h){if(Xo(n))return!1;o=!0}}}}else{if(!o&&!Xo(n)&&!Xo(l))return!1;if(o&&Xo(l))continue;o=!1,n=l|1&n}}return Xo(n)||o}function Xo(i){return 0==(1&i)}function L9(i,e,t,n){if(null===e)return-1;let r=0;if(n||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===i)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function N9(i,e){let t=i.indexOf(4);if(t>-1)for(t++;t<i.length;){const n=i[t];if("number"==typeof n)return-1;if(n===e)return t;t++}return-1}(e,i)}function PB(i,e,t=!1){for(let n=0;n<e.length;n++)if(B9(i,e[n],t))return!0;return!1}function j9(i,e){e:for(let t=0;t<e.length;t++){const n=e[t];if(i.length===n.length){for(let r=0;r<i.length;r++)if(i[r]!==n[r])continue e;return!0}}return!1}function kB(i,e){return i?":not("+e.trim()+")":e}function U9(i){let e=i[0],t=1,n=2,r="",s=!1;for(;t<i.length;){let o=i[t];if("string"==typeof o)if(2&n){const a=i[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&n?r+="."+o:4&n&&(r+=" "+o);else""!==r&&!Xo(o)&&(e+=kB(s,r),r=""),n=o,s=s||!Xo(n);t++}return""!==r&&(e+=kB(s,r)),e}const Zt={};function K(i){BB(Ri(),ze(),es()+i,!1)}function BB(i,e,t,n){if(!n)if(3==(3&e[2])){const s=i.preOrderCheckHooks;null!==s&&kv(e,s,t)}else{const s=i.preOrderHooks;null!==s&&Bv(e,s,0,t)}yd(t)}function NB(i,e=null,t=null,n){const r=jB(i,e,t,n);return r.resolveInjectorInitializers(),r}function jB(i,e=null,t=null,n,r=new Set){const s=[t||Ni,a9(i)];return n=n||("object"==typeof i?void 0:sn(i)),new CB(s,e||eA(),n||null,r)}let zr=(()=>{class i{static create(t,n){if(Array.isArray(t))return NB({name:""},n,t,"");{const r=t.name??"";return NB({name:r},t.parent,t.providers,r)}}}return i.THROW_IF_NOT_FOUND=Og,i.NULL=new vB,i.\u0275prov=He({token:i,providedIn:"any",factory:()=>xe(_B)}),i.__NG_ELEMENT_ID__=-1,i})();function I(i,e=Vt.Default){const t=ze();return null===t?xe(i,e):pk(Rr(),t,Ut(i),e)}function o_(){throw new Error("invalid")}function WB(i,e){const t=i.contentQueries;if(null!==t)for(let n=0;n<t.length;n+=2){const s=t[n+1];if(-1!==s){const o=i.data[s];YM(t[n]),o.contentQueries(2,e[s],s)}}}function nA(i,e,t,n,r,s,o,a,l,c,d){const u=e.blueprint.slice();return u[0]=r,u[2]=76|n,(null!==d||i&&1024&i[2])&&(u[2]|=1024),GP(u),u[3]=u[15]=i,u[8]=t,u[10]=o||i&&i[10],u[11]=a||i&&i[11],u[12]=l||i&&i[12]||null,u[9]=c||i&&i[9]||null,u[6]=s,u[20]=function n7(){return t7++}(),u[21]=d,u[16]=2==e.type?i[16]:u,u}function qh(i,e,t,n,r){let s=i.data[e];if(null===s)s=function X1(i,e,t,n,r){const s=WP(),o=HM(),l=i.data[e]=function hq(i,e,t,n,r,s){return{type:t,index:n,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,n,r);return null===i.firstChild&&(i.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(i,e,t,n,r),function lW(){return Xt.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=n,s.attrs=r;const o=function Qg(){const i=Xt.lFrame,e=i.currentTNode;return i.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return va(s,!0),s}function a_(i,e,t,n){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(n),i.blueprint.push(n),i.data.push(null);return r}function Z1(i,e,t){XM(e);try{const n=i.viewQuery;null!==n&&oE(1,n,t);const r=i.template;null!==r&&qB(i,e,r,1,t),i.firstCreatePass&&(i.firstCreatePass=!1),i.staticContentQueries&&WB(i,e),i.staticViewQueries&&oE(2,i.viewQuery,t);const s=i.components;null!==s&&function cq(i,e){for(let t=0;t<e.length;t++)Dq(i,e[t])}(e,s)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{e[2]&=-5,ZM()}}function rA(i,e,t,n){const r=e[2];if(128!=(128&r)){XM(e);try{GP(e),function YP(i){return Xt.lFrame.bindingIndex=i}(i.bindingStartIndex),null!==t&&qB(i,e,t,2,n);const o=3==(3&r);if(o){const c=i.preOrderCheckHooks;null!==c&&kv(e,c,null)}else{const c=i.preOrderHooks;null!==c&&Bv(e,c,0,null),KM(e,0)}if(function Rq(i){for(let e=b1(i);null!==e;e=v1(e)){if(!e[2])continue;const t=e[9];for(let n=0;n<t.length;n++){const r=t[n];512&r[2]||GM(r[3],1),r[2]|=512}}}(e),function Tq(i){for(let e=b1(i);null!==e;e=v1(e))for(let t=10;t<e.length;t++){const n=e[t],r=n[1];Dv(n)&&rA(r,n,r.template,n[8])}}(e),null!==i.contentQueries&&WB(i,e),o){const c=i.contentCheckHooks;null!==c&&kv(e,c)}else{const c=i.contentHooks;null!==c&&Bv(e,c,1),KM(e,1)}!function aq(i,e){const t=i.hostBindingOpCodes;if(null!==t)try{for(let n=0;n<t.length;n++){const r=t[n];if(r<0)yd(~r);else{const s=r,o=t[++n],a=t[++n];cW(o,s),a(2,e[s])}}}finally{yd(-1)}}(i,e);const a=i.components;null!==a&&function lq(i,e){for(let t=0;t<e.length;t++)Iq(i,e[t])}(e,a);const l=i.viewQuery;if(null!==l&&oE(2,l,n),o){const c=i.viewCheckHooks;null!==c&&kv(e,c)}else{const c=i.viewHooks;null!==c&&Bv(e,c,2),KM(e,2)}!0===i.firstUpdatePass&&(i.firstUpdatePass=!1),e[2]&=-41,512&e[2]&&(e[2]&=-513,GM(e[3],-1))}finally{ZM()}}}function qB(i,e,t,n,r){const s=es(),o=2&n;try{yd(-1),o&&e.length>22&&BB(i,e,22,!1),t(n,r)}finally{yd(s)}}function K1(i,e,t){if(VM(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=i.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}function $1(i,e,t){QP()&&(function bq(i,e,t,n){const r=t.directiveStart,s=t.directiveEnd;Hg(t)&&function Mq(i,e,t){const n=zs(e,i),r=YB(t),s=i[10],o=sA(i,nA(i,r,null,t.onPush?32:16,n,e,s,s.createRenderer(n,t),null,null,null));i[e.index]=o}(e,t,i.data[r+t.componentOffset]),i.firstCreatePass||Nv(t,e),Vr(n,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=i.data[a],c=xd(e,i,a,t);Vr(c,e),null!==o&&Eq(0,a-r,c,l,0,o),Yo(l)&&(Gs(t.index,e)[8]=xd(e,i,a,t))}}(i,e,t,zs(t,e)),64==(64&t.flags)&&eL(i,e,t))}function J1(i,e,t=zs){const n=e.localNames;if(null!==n){let r=e.index+1;for(let s=0;s<n.length;s+=2){const o=n[s+1],a=-1===o?t(e,i):i[o];i[r++]=a}}}function YB(i){const e=i.tView;return null===e||e.incompleteFirstPass?i.tView=eE(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts):e}function eE(i,e,t,n,r,s,o,a,l,c){const d=22+n,u=d+r,h=function dq(i,e){const t=[];for(let n=0;n<e;n++)t.push(n<i?null:Zt);return t}(d,u),f="function"==typeof c?c():c;return h[1]={type:i,blueprint:h,template:t,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:u,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function XB(i,e,t,n){const r=iL(e);null===t?r.push(n):(r.push(t),i.firstCreatePass&&nL(i).push(n,r.length-1))}function ZB(i,e,t,n){for(let r in i)if(i.hasOwnProperty(r)){t=null===t?{}:t;const s=i[r];null===n?KB(t,e,r,s):n.hasOwnProperty(r)&&KB(t,e,n[r],s)}return t}function KB(i,e,t,n){i.hasOwnProperty(t)?i[t].push(e,n):i[t]=[e,n]}function Ws(i,e,t,n,r,s,o,a){const l=zs(e,t);let d,c=e.inputs;!a&&null!=c&&(d=c[n])?(aE(i,t,d,n,r),Hg(e)&&$B(t,e.index)):3&e.type&&(n=function pq(i){return"class"===i?"className":"for"===i?"htmlFor":"formaction"===i?"formAction":"innerHtml"===i?"innerHTML":"readonly"===i?"readOnly":"tabindex"===i?"tabIndex":i}(n),r=null!=o?o(r,e.value||"",n):r,s.setProperty(l,n,r))}function $B(i,e){const t=Gs(e,i);16&t[2]||(t[2]|=32)}function tE(i,e,t,n){let r=!1;if(QP()){const s=null===n?null:{"":-1},o=function Aq(i,e){const t=i.directiveRegistry;let n=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(PB(e,o.selectors,!1))if(n||(n=[]),Yo(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),n.unshift(...a,o),iE(i,e,a.length)}else n.unshift(o),iE(i,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,n,r),n.push(o)}return null===n?null:[n,r]}(i,t);let a,l;null===o?a=l=null:[a,l]=o,null!==a&&(r=!0,JB(i,e,t,a,s,l)),s&&function yq(i,e,t){if(e){const n=i.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new Pe(-301,!1);n.push(e[r],s)}}}(t,n,s)}return t.mergedAttrs=qg(t.mergedAttrs,t.attrs),r}function JB(i,e,t,n,r,s){for(let c=0;c<n.length;c++)r1(Nv(t,e),i,n[c].type);!function wq(i,e,t){i.flags|=1,i.directiveStart=e,i.directiveEnd=e+t,i.providerIndexes=e}(t,i.data.length,n.length);for(let c=0;c<n.length;c++){const d=n[c];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,l=a_(i,e,n.length,null);for(let c=0;c<n.length;c++){const d=n[c];t.mergedAttrs=qg(t.mergedAttrs,d.hostAttrs),Cq(i,t,e,l,d),xq(l,d,r),null!==d.contentQueries&&(t.flags|=4),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(t.flags|=64);const u=d.type.prototype;!o&&(u.ngOnChanges||u.ngOnInit||u.ngDoCheck)&&((i.preOrderHooks||(i.preOrderHooks=[])).push(t.index),o=!0),!a&&(u.ngOnChanges||u.ngDoCheck)&&((i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(t.index),a=!0),l++}!function fq(i,e,t){const r=e.directiveEnd,s=i.data,o=e.attrs,a=[];let l=null,c=null;for(let d=e.directiveStart;d<r;d++){const u=s[d],h=t?t.get(u):null,m=h?h.outputs:null;l=ZB(u.inputs,d,l,h?h.inputs:null),c=ZB(u.outputs,d,c,m);const _=null===l||null===o||DB(e)?null:Sq(l,d,o);a.push(_)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}(i,t,s)}function eL(i,e,t){const n=t.directiveStart,r=t.directiveEnd,s=t.index,o=function dW(){return Xt.lFrame.currentDirectiveIndex}();try{yd(s);for(let a=n;a<r;a++){const l=i.data[a],c=e[a];WM(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&vq(l,c)}}finally{yd(-1),WM(o)}}function vq(i,e){null!==i.hostBindings&&i.hostBindings(1,e)}function iE(i,e,t){e.componentOffset=t,(i.components||(i.components=[])).push(e.index)}function xq(i,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=i;Yo(e)&&(t[""]=i)}}function Cq(i,e,t,n,r){i.data[n]=r;const s=r.factory||(r.factory=Ad(r.type)),o=new Wg(s,Yo(r),I);i.blueprint[n]=o,t[n]=o,function gq(i,e,t,n,r){const s=r.hostBindings;if(s){let o=i.hostBindingOpCodes;null===o&&(o=i.hostBindingOpCodes=[]);const a=~e.index;(function _q(i){let e=i.length;for(;e>0;){const t=i[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,n,s)}}(i,e,n,a_(i,t,r.hostVars,Zt),r)}function wa(i,e,t,n,r,s){const o=zs(i,e);!function nE(i,e,t,n,r,s,o){if(null==s)i.removeAttribute(e,r,t);else{const a=null==o?Yt(s):o(s,n||"",r);i.setAttribute(e,r,a,t)}}(e[11],o,s,i.value,t,n,r)}function Eq(i,e,t,n,r,s){const o=s[e];if(null!==o){const a=n.setInput;for(let l=0;l<o.length;){const c=o[l++],d=o[l++],u=o[l++];null!==a?n.setInput(t,u,c,d):t[d]=u}}}function Sq(i,e,t){let n=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(i.hasOwnProperty(s)){null===n&&(n=[]);const o=i[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){n.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return n}function tL(i,e,t,n){return[i,!0,!1,e,null,0,n,t,null,null]}function Iq(i,e){const t=Gs(e,i);if(Dv(t)){const n=t[1];48&t[2]?rA(n,t,n.template,t[8]):t[5]>0&&rE(t)}}function rE(i){for(let n=b1(i);null!==n;n=v1(n))for(let r=10;r<n.length;r++){const s=n[r];if(Dv(s))if(512&s[2]){const o=s[1];rA(o,s,o.template,s[8])}else s[5]>0&&rE(s)}const t=i[1].components;if(null!==t)for(let n=0;n<t.length;n++){const r=Gs(t[n],i);Dv(r)&&r[5]>0&&rE(r)}}function Dq(i,e){const t=Gs(e,i),n=t[1];(function Pq(i,e){for(let t=e.length;t<i.blueprint.length;t++)e.push(i.blueprint[t])})(n,t),Z1(n,t,t[8])}function sA(i,e){return i[13]?i[14][4]=e:i[13]=e,i[14]=e,e}function sE(i){for(;i;){i[2]|=32;const e=t_(i);if(H6(i)&&!e)return i;i=e}return null}function oA(i,e,t,n=!0){const r=e[10];r.begin&&r.begin();try{rA(i,e,i.template,t)}catch(o){throw n&&sL(e,o),o}finally{r.end&&r.end()}}function oE(i,e,t){YM(0),e(i,t)}function iL(i){return i[7]||(i[7]=[])}function nL(i){return i.cleanup||(i.cleanup=[])}function rL(i,e,t){return(null===i||Yo(i))&&(t=function $6(i){for(;Array.isArray(i);){if("object"==typeof i[1])return i;i=i[0]}return null}(t[e.index])),t[11]}function sL(i,e){const t=i[9],n=t?t.get(ml,null):null;n&&n.handleError(e)}function aE(i,e,t,n,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=i.data[o];null!==c.setInput?c.setInput(l,r,n,a):l[a]=r}}function aA(i,e,t){let n=t?i.styles:null,r=t?i.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=IM(r,a):2==s&&(n=IM(n,a+": "+e[++o]+";"))}t?i.styles=n:i.stylesWithoutHost=n,t?i.classes=r:i.classesWithoutHost=r}function lA(i,e,t,n,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&n.push(Tr(s)),qo(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&lA(l[1],l,c,n)}const o=t.type;if(8&o)lA(i,e,t.child,n);else if(32&o){const a=_1(t,e);let l;for(;l=a();)n.push(l)}else if(16&o){const a=Jk(e,t);if(Array.isArray(a))n.push(...a);else{const l=t_(e[16]);lA(l[1],l,a,n,!0)}}t=r?t.projectionNext:t.next}return n}class l_{get rootNodes(){const e=this._lView,t=e[1];return lA(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(qo(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(x1(e,n),Uv(t,n))}this._attachedToViewContainer=!1}Hk(this._lView[1],this._lView)}onDestroy(e){XB(this._lView[1],this._lView,null,e)}markForCheck(){sE(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){oA(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Pe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function b7(i,e){i_(i,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Pe(902,!1);this._appRef=e}}class kq extends l_{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;oA(e[1],e,e[8],!1)}checkNoChanges(){}get context(){return null}}class oL extends Jl{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Hi(e);return new c_(t,this.ngModule)}}function aL(i){const e=[];for(let t in i)i.hasOwnProperty(t)&&e.push({propName:i[t],templateName:t});return e}class Lq{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=wv(n);const r=this.injector.get(e,V1,n);return r!==V1||t===V1?r:this.parentInjector.get(e,t,n)}}class c_ extends EB{get inputs(){return aL(this.componentDef.inputs)}get outputs(){return aL(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function V9(i){return i.map(U9).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,n,r){let s=(r=r||this.ngModule)instanceof xa?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new Lq(e,s):e,a=o.get(s_,null);if(null===a)throw new Pe(407,!1);const l=o.get(x9,null),c=a.createRenderer(null,this.componentDef),d=this.componentDef.selectors[0][0]||"div",u=n?function uq(i,e,t){return i.selectRootElement(e,t===Qo.ShadowDom)}(c,n,this.componentDef.encapsulation):y1(c,d,function Bq(i){const e=i.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(d)),h=this.componentDef.onPush?288:272,f=eE(0,null,null,1,0,null,null,null,null,null),m=nA(null,f,null,h,null,null,a,c,l,o,null);let _,g;XM(m);try{const p=this.componentDef;let v,b=null;p.findHostDirectiveDefs?(v=[],b=new Map,p.findHostDirectiveDefs(p,v,b),v.push(p)):v=[p];const y=function Oq(i,e){const t=i[1];return i[22]=e,qh(t,22,2,"#host",null)}(m,u),x=function Nq(i,e,t,n,r,s,o,a){const l=r[1];!function jq(i,e,t,n){for(const r of i)e.mergedAttrs=qg(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(aA(e,e.mergedAttrs,!0),null!==t&&iB(n,t,e))}(n,i,e,o);const c=s.createRenderer(e,t),d=nA(r,YB(t),null,t.onPush?32:16,r[i.index],i,s,c,a||null,null,null);return l.firstCreatePass&&iE(l,i,n.length-1),sA(r,d),r[i.index]=d}(y,u,p,v,m,a,c);g=zP(f,22),u&&function Vq(i,e,t,n){if(n)JM(i,t,["ng-version",w9.full]);else{const{attrs:r,classes:s}=function z9(i){const e=[],t=[];let n=1,r=2;for(;n<i.length;){let s=i[n];if("string"==typeof s)2===r?""!==s&&e.push(s,i[++n]):8===r&&t.push(s);else{if(!Xo(r))break;r=s}n++}return{attrs:e,classes:t}}(e.selectors[0]);r&&JM(i,t,r),s&&s.length>0&&tB(i,t,s.join(" "))}}(c,p,u,n),void 0!==t&&function zq(i,e,t){const n=i.projection=[];for(let r=0;r<e.length;r++){const s=t[r];n.push(null!=s?Array.from(s):null)}}(g,this.ngContentSelectors,t),_=function Uq(i,e,t,n,r,s){const o=Rr(),a=r[1],l=zs(o,r);JB(a,r,o,t,null,n);for(let d=0;d<t.length;d++)Vr(xd(r,a,o.directiveStart+d,o),r);eL(a,r,o),l&&Vr(l,r);const c=xd(r,a,o.directiveStart+o.componentOffset,o);if(i[8]=r[8]=c,null!==s)for(const d of s)d(c,e);return K1(a,o,i),c}(x,p,v,b,m,[Gq]),Z1(f,m,null)}finally{ZM()}return new Fq(this.componentType,_,Hh(g,m),m,g)}}class Fq extends g9{constructor(e,t,n,r,s){super(),this.location=n,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new kq(r),this.componentType=e}setInput(e,t){const n=this._tNode.inputs;let r;if(null!==n&&(r=n[e])){const s=this._rootLView;aE(s[1],s,r,e,t),$B(s,this._tNode.index)}}get injector(){return new Bh(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function Gq(){const i=Rr();Pv(ze()[1],i)}function q(i){let e=function lL(i){return Object.getPrototypeOf(i.prototype).constructor}(i.type),t=!0;const n=[i];for(;e;){let r;if(Yo(i))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Pe(903,!1);r=e.\u0275dir}if(r){if(t){n.push(r);const o=i;o.inputs=lE(i.inputs),o.declaredInputs=lE(i.declaredInputs),o.outputs=lE(i.outputs);const a=r.hostBindings;a&&qq(i,a);const l=r.viewQuery,c=r.contentQueries;if(l&&Qq(i,l),c&&Wq(i,c),RM(i.inputs,r.inputs),RM(i.declaredInputs,r.declaredInputs),RM(i.outputs,r.outputs),Yo(r)&&r.data.animation){const d=i.data;d.animation=(d.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(i),a===q&&(t=!1)}}e=Object.getPrototypeOf(e)}!function Hq(i){let e=0,t=null;for(let n=i.length-1;n>=0;n--){const r=i[n];r.hostVars=e+=r.hostVars,r.hostAttrs=qg(r.hostAttrs,t=qg(t,r.hostAttrs))}}(n)}function lE(i){return i===al?{}:i===Ni?[]:i}function Qq(i,e){const t=i.viewQuery;i.viewQuery=t?(n,r)=>{e(n,r),t(n,r)}:e}function Wq(i,e){const t=i.contentQueries;i.contentQueries=t?(n,r,s)=>{e(n,r,s),t(n,r,s)}:e}function qq(i,e){const t=i.hostBindings;i.hostBindings=t?(n,r)=>{e(n,r),t(n,r)}:e}let cA=null;function Rd(){if(!cA){const i=on.Symbol;if(i&&i.iterator)cA=i.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const n=e[t];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(cA=n)}}}return cA}function dA(i){return!!cE(i)&&(Array.isArray(i)||!(i instanceof Map)&&Rd()in i)}function cE(i){return null!==i&&("function"==typeof i||"object"==typeof i)}function Ca(i,e,t){return i[e]=t}function Gr(i,e,t){return!Object.is(i[e],t)&&(i[e]=t,!0)}function Id(i,e,t,n){const r=Gr(i,e,t);return Gr(i,e+1,n)||r}function pn(i,e,t,n){const r=ze();return Gr(r,Ph(),e)&&(Ri(),wa(Sn(),r,i,e,t,n)),pn}function Bt(i,e,t,n,r,s,o,a){const l=ze(),c=Ri(),d=i+22,u=c.firstCreatePass?function nY(i,e,t,n,r,s,o,a,l){const c=e.consts,d=qh(e,i,4,o||null,$l(c,a));tE(e,t,d,$l(c,l)),Pv(e,d);const u=d.tViews=eE(2,d,n,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,d),u.queries=e.queries.embeddedTView(d)),d}(d,c,l,e,t,n,r,s,o):c.data[d];va(u,!1);const h=l[11].createComment("");Wv(c,l,h,u),Vr(h,l),sA(l,l[d]=tL(h,l,h,u)),Rv(u)&&$1(c,l,u),null!=o&&J1(l,u,a)}function qt(i){return Dh(function aW(){return Xt.lFrame.contextLView}(),22+i)}function W(i,e,t){const n=ze();return Gr(n,Ph(),e)&&Ws(Ri(),Sn(),n,i,e,n[11],t,!1),W}function dE(i,e,t,n,r){const o=r?"class":"style";aE(i,t,e.inputs[o],o,n)}function ge(i,e,t,n){const r=ze(),s=Ri(),o=22+i,a=r[11],l=r[o]=y1(a,e,function gW(){return Xt.lFrame.currentNamespace}()),c=s.firstCreatePass?function sY(i,e,t,n,r,s,o){const a=e.consts,c=qh(e,i,2,r,$l(a,s));return tE(e,t,c,$l(a,o)),null!==c.attrs&&aA(c,c.attrs,!1),null!==c.mergedAttrs&&aA(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,n):s.data[o];return va(c,!0),iB(a,l,c),32!=(32&c.flags)&&Wv(s,r,l,c),0===function iW(){return Xt.lFrame.elementDepthCount}()&&Vr(l,r),function nW(){Xt.lFrame.elementDepthCount++}(),Rv(c)&&($1(s,r,c),K1(s,c,r)),null!==n&&J1(r,c),ge}function Re(){let i=Rr();HM()?QM():(i=i.parent,va(i,!1));const e=i;!function rW(){Xt.lFrame.elementDepthCount--}();const t=Ri();return t.firstCreatePass&&(Pv(t,i),VM(i)&&t.queries.elementEnd(i)),null!=e.classesWithoutHost&&function AW(i){return 0!=(8&i.flags)}(e)&&dE(t,e,ze(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function yW(i){return 0!=(16&i.flags)}(e)&&dE(t,e,ze(),e.stylesWithoutHost,!1),Re}function je(i,e,t,n){return ge(i,e,t,n),Re(),je}function uE(i,e,t){const n=ze(),r=Ri(),s=i+22,o=r.firstCreatePass?function oY(i,e,t,n,r){const s=e.consts,o=$l(s,n),a=qh(e,i,8,"ng-container",o);return null!==o&&aA(a,o,!0),tE(e,t,a,$l(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,n,e,t):r.data[s];va(o,!0);const a=n[s]=n[11].createComment("");return Wv(r,n,a,o),Vr(a,n),Rv(o)&&($1(r,n,o),K1(r,o,n)),null!=t&&J1(n,o),uE}function hE(){let i=Rr();const e=Ri();return HM()?QM():(i=i.parent,va(i,!1)),e.firstCreatePass&&(Pv(e,i),VM(i)&&e.queries.elementEnd(i)),hE}function u_(i,e,t){return uE(i,e,t),hE(),u_}function ys(){return ze()}function h_(i){return!!i&&"function"==typeof i.then}function yL(i){return!!i&&"function"==typeof i.subscribe}const fE=yL;function ut(i,e,t,n){const r=ze(),s=Ri(),o=Rr();return xL(s,r,r[11],o,i,e,n),ut}function pE(i,e){const t=Rr(),n=ze(),r=Ri();return xL(r,n,rL(qM(r.data),t,n),t,i,e),pE}function xL(i,e,t,n,r,s,o){const a=Rv(n),c=i.firstCreatePass&&nL(i),d=e[8],u=iL(e);let h=!0;if(3&n.type||o){const _=zs(n,e),g=o?o(_):_,p=u.length,v=o?y=>o(Tr(y[n.index])):n.index;let b=null;if(!o&&a&&(b=function aY(i,e,t,n){const r=i.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===n){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(i,e,r,n.index)),null!==b)(b.__ngLastListenerFn__||b).__ngNextListenerFn__=s,b.__ngLastListenerFn__=s,h=!1;else{s=CL(n,e,d,s,!1);const y=t.listen(g,r,s);u.push(s,y),c&&c.push(r,v,p,p+1)}}else s=CL(n,e,d,s,!1);const f=n.outputs;let m;if(h&&null!==f&&(m=f[r])){const _=m.length;if(_)for(let g=0;g<_;g+=2){const x=e[m[g]][m[g+1]].subscribe(s),w=u.length;u.push(s,x),c&&c.push(r,n.index,w,-(w+1))}}}function wL(i,e,t,n){try{return!1!==t(n)}catch(r){return sL(i,r),!1}}function CL(i,e,t,n,r){return function s(o){if(o===Function)return n;sE(i.componentOffset>-1?Gs(i.index,e):e);let l=wL(e,0,n,o),c=s.__ngNextListenerFn__;for(;c;)l=wL(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function di(i=1){return function hW(i){return(Xt.lFrame.contextLView=function fW(i,e){for(;i>0;)e=e[15],i--;return e}(i,Xt.lFrame.contextLView))[8]}(i)}function lY(i,e){let t=null;const n=function F9(i){const e=i.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(i);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===n?PB(i,s,!0):j9(n,s))return r}else t=r}return t}function he(i){const e=ze()[16][6];if(!e.projection){const n=e.projection=Kg(i?i.length:1,null),r=n.slice();let s=e.child;for(;null!==s;){const o=i?lY(s,i):0;null!==o&&(r[o]?r[o].projectionNext=s:n[o]=s,r[o]=s),s=s.next}}}function ie(i,e=0,t){const n=ze(),r=Ri(),s=qh(r,22+i,16,null,t||null);null===s.projection&&(s.projection=e),QM(),32!=(32&s.flags)&&function E7(i,e,t){eB(e[11],0,e,t,Qk(i,t,e),Xk(t.parent||e[6],t,e))}(r,n,s)}function hA(i,e){return i<<17|e<<2}function ec(i){return i>>17&32767}function gE(i){return 2|i}function Dd(i){return(131068&i)>>2}function _E(i,e){return-131069&i|e<<2}function bE(i){return 1|i}function BL(i,e,t,n,r){const s=i[t+1],o=null===e;let a=n?ec(s):Dd(s),l=!1;for(;0!==a&&(!1===l||o);){const d=i[a+1];pY(i[a],e)&&(l=!0,i[a+1]=n?bE(d):gE(d)),a=n?ec(d):Dd(d)}l&&(i[t+1]=n?gE(s):bE(s))}function pY(i,e){return null===i||null==e||(Array.isArray(i)?i[1]:i)===e||!(!Array.isArray(i)||"string"!=typeof e)&&jh(i,e)>=0}const pr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function LL(i){return i.substring(pr.key,pr.keyEnd)}function mY(i){return i.substring(pr.value,pr.valueEnd)}function OL(i,e){const t=pr.textEnd;let n=pr.key=rf(i,e,t);return t===n?-1:(n=pr.keyEnd=function vY(i,e,t){let n;for(;e<t&&(45===(n=i.charCodeAt(e))||95===n||(-33&n)>=65&&(-33&n)<=90||n>=48&&n<=57);)e++;return e}(i,n,t),n=jL(i,n,t),n=pr.value=rf(i,n,t),n=pr.valueEnd=function AY(i,e,t){let n=-1,r=-1,s=-1,o=e,a=o;for(;o<t;){const l=i.charCodeAt(o++);if(59===l)return a;34===l||39===l?a=o=UL(i,l,o,t):e===o-4&&85===s&&82===r&&76===n&&40===l?a=o=UL(i,41,o,t):l>32&&(a=o),s=r,r=n,n=-33&l}return a}(i,n,t),jL(i,n,t))}function rf(i,e,t){for(;e<t&&i.charCodeAt(e)<=32;)e++;return e}function jL(i,e,t,n){return(e=rf(i,e,t))<t&&e++,e}function UL(i,e,t,n){let r=-1,s=t;for(;s<n;){const o=i.charCodeAt(s++);if(o==e&&92!==r)return s;r=92==o&&92===r?0:o}throw new Error}function Pd(i,e,t){return Zo(i,e,t,!1),Pd}function Ei(i,e){return Zo(i,e,null,!0),Ei}function yo(i){!function Ko(i,e,t,n){const r=Ri(),s=ul(2);r.firstUpdatePass&&zL(r,null,s,n);const o=ze();if(t!==Zt&&Gr(o,s,t)){const a=r.data[es()];if(WL(a,n)&&!VL(r,s)){let l=n?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=IM(l,t||"")),dE(r,a,o,t,n)}else!function TY(i,e,t,n,r,s,o,a){r===Zt&&(r=Ni);let l=0,c=0,d=0<r.length?r[0]:null,u=0<s.length?s[0]:null;for(;null!==d||null!==u;){const h=l<r.length?r[l+1]:void 0,f=c<s.length?s[c+1]:void 0;let _,m=null;d===u?(l+=2,c+=2,h!==f&&(m=u,_=f)):null===u||null!==d&&d<u?(l+=2,m=d):(c+=2,m=u,_=f),null!==m&&HL(i,e,t,n,m,_,o,a),d=l<r.length?r[l]:null,u=c<s.length?s[c]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function SY(i,e,t){if(null==t||""===t)return Ni;const n=[],r=Qs(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)i(n,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&i(n,s,r[s]);else"string"==typeof r&&e(n,r);return n}(i,e,t),n,s)}}(GL,yY,i,!1)}function yY(i,e){for(let t=function _Y(i){return function NL(i){pr.key=0,pr.keyEnd=0,pr.value=0,pr.valueEnd=0,pr.textEnd=i.length}(i),OL(i,rf(i,0,pr.textEnd))}(e);t>=0;t=OL(e,t))GL(i,LL(e),mY(e))}function Zo(i,e,t,n){const r=ze(),s=Ri(),o=ul(2);s.firstUpdatePass&&zL(s,i,o,n),e!==Zt&&Gr(r,o,e)&&HL(s,s.data[es()],r,r[11],i,r[o+1]=function RY(i,e){return null==i||("string"==typeof e?i+=e:"object"==typeof i&&(i=sn(Qs(i)))),i}(e,t),n,o)}function VL(i,e){return e>=i.expandoStartIndex}function zL(i,e,t,n){const r=i.data;if(null===r[t+1]){const s=r[es()],o=VL(i,t);WL(s,n)&&null===e&&!o&&(e=!1),e=function wY(i,e,t,n){const r=qM(i);let s=n?e.residualClasses:e.residualStyles;if(null===r)0===(n?e.classBindings:e.styleBindings)&&(t=f_(t=vE(null,i,e,t,n),e.attrs,n),s=null);else{const o=e.directiveStylingLast;if(-1===o||i[o]!==r)if(t=vE(r,i,e,t,n),null===s){let l=function CY(i,e,t){const n=t?e.classBindings:e.styleBindings;if(0!==Dd(n))return i[ec(n)]}(i,e,n);void 0!==l&&Array.isArray(l)&&(l=vE(null,i,e,l[1],n),l=f_(l,e.attrs,n),function MY(i,e,t,n){i[ec(t?e.classBindings:e.styleBindings)]=n}(i,e,n,l))}else s=function EY(i,e,t){let n;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)n=f_(n,i[s].hostAttrs,t);return f_(n,e.attrs,t)}(i,e,n)}return void 0!==s&&(n?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,n),function hY(i,e,t,n,r,s){let o=s?e.classBindings:e.styleBindings,a=ec(o),l=Dd(o);i[n]=t;let d,c=!1;if(Array.isArray(t)?(d=t[1],(null===d||jh(t,d)>0)&&(c=!0)):d=t,r)if(0!==l){const h=ec(i[a+1]);i[n+1]=hA(h,a),0!==h&&(i[h+1]=_E(i[h+1],n)),i[a+1]=function dY(i,e){return 131071&i|e<<17}(i[a+1],n)}else i[n+1]=hA(a,0),0!==a&&(i[a+1]=_E(i[a+1],n)),a=n;else i[n+1]=hA(l,0),0===a?a=n:i[l+1]=_E(i[l+1],n),l=n;c&&(i[n+1]=gE(i[n+1])),BL(i,d,n,!0),BL(i,d,n,!1),function fY(i,e,t,n,r){const s=r?i.residualClasses:i.residualStyles;null!=s&&"string"==typeof e&&jh(s,e)>=0&&(t[n+1]=bE(t[n+1]))}(e,d,i,n,s),o=hA(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,n)}}function vE(i,e,t,n,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],n=f_(n,s.hostAttrs,r),s!==i);)a++;return null!==i&&(t.directiveStylingLast=a),n}function f_(i,e,t){const n=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===n&&(Array.isArray(i)||(i=void 0===i?[]:["",i]),Hs(i,o,!!t||e[++s]))}return void 0===i?null:i}function GL(i,e,t){Hs(i,e,Qs(t))}function HL(i,e,t,n,r,s,o,a){if(!(3&e.type))return;const l=i.data,c=l[a+1],d=function uY(i){return 1==(1&i)}(c)?QL(l,e,t,r,Dd(c),o):void 0;fA(d)||(fA(s)||function cY(i){return 2==(2&i)}(c)&&(s=QL(l,null,t,r,a,o)),function T7(i,e,t,n,r){if(e)r?i.addClass(t,n):i.removeClass(t,n);else{let s=-1===n.indexOf("-")?void 0:vs.DashCase;null==r?i.removeStyle(t,n,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=vs.Important),i.setStyle(t,n,r,s))}}(n,o,Iv(es(),t),r,s))}function QL(i,e,t,n,r,s){const o=null===e;let a;for(;r>0;){const l=i[r],c=Array.isArray(l),d=c?l[1]:l,u=null===d;let h=t[r+1];h===Zt&&(h=u?Ni:void 0);let f=u?l1(h,n):d===n?h:void 0;if(c&&!fA(f)&&(f=l1(l,n)),fA(f)&&(a=f,o))return a;const m=i[r+1];r=o?ec(m):Dd(m)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=l1(l,n))}return a}function fA(i){return void 0!==i}function WL(i,e){return 0!=(i.flags&(e?8:16))}function bi(i,e=""){const t=ze(),n=Ri(),r=i+22,s=n.firstCreatePass?qh(n,r,1,e,null):n.data[r],o=t[r]=function A1(i,e){return i.createText(e)}(t[11],e);Wv(n,t,o,s),va(s,!1)}function pA(i){return tc("",i,""),pA}function tc(i,e,t){const n=ze(),r=function Xh(i,e,t,n){return Gr(i,Ph(),t)?e+Yt(t)+n:Zt}(n,i,e,t);return r!==Zt&&function _l(i,e,t){const n=Iv(e,i);!function zk(i,e,t){i.setValue(e,t)}(i[11],n,t)}(n,es(),r),tc}function AE(i,e,t){const n=ze();if(Gr(n,Ph(),e)){const s=Ri(),o=Sn();Ws(s,o,n,i,e,rL(qM(s.data),o,n),t,!0)}return AE}const af="en-US";let fF=af;function wE(i,e,t,n,r){if(i=Ut(i),Array.isArray(i))for(let s=0;s<i.length;s++)wE(i[s],e,t,n,r);else{const s=Ri(),o=ze();let a=Sd(i)?i:Ut(i.provide),l=MB(i);const c=Rr(),d=1048575&c.providerIndexes,u=c.directiveStart,h=c.providerIndexes>>20;if(Sd(i)||!i.multi){const f=new Wg(l,r,I),m=ME(a,e,r?d:d+h,u);-1===m?(r1(Nv(c,o),s,a),CE(s,i,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(f),o.push(f)):(t[m]=f,o[m]=f)}else{const f=ME(a,e,d+h,u),m=ME(a,e,d,d+h),g=m>=0&&t[m];if(r&&!g||!r&&!(f>=0&&t[f])){r1(Nv(c,o),s,a);const p=function qX(i,e,t,n,r){const s=new Wg(i,t,I);return s.multi=[],s.index=e,s.componentProviders=0,NF(s,r,n&&!t),s}(r?WX:QX,t.length,r,n,l);!r&&g&&(t[m].providerFactory=p),CE(s,i,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(p),o.push(p)}else CE(s,i,f>-1?f:m,NF(t[r?m:f],l,!r&&n));!r&&n&&g&&t[m].componentProviders++}}}function CE(i,e,t,n){const r=Sd(e),s=function c9(i){return!!i.useClass}(e);if(r||s){const l=(s?Ut(e.useClass):e).prototype.ngOnDestroy;if(l){const c=i.destroyHooks||(i.destroyHooks=[]);if(!r&&e.multi){const d=c.indexOf(t);-1===d?c.push(t,[n,l]):c[d+1].push(n,l)}else c.push(t,l)}}}function NF(i,e,t){return t&&i.componentProviders++,i.multi.push(e)-1}function ME(i,e,t,n){for(let r=t;r<n;r++)if(e[r]===i)return r;return-1}function QX(i,e,t,n){return EE(this.multi,[])}function WX(i,e,t,n){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=xd(t,t[1],this.providerFactory.index,n);s=a.slice(0,o),EE(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],EE(r,s);return s}function EE(i,e){for(let t=0;t<i.length;t++)e.push((0,i[t])());return e}function ne(i,e=[]){return t=>{t.providersResolver=(n,r)=>function HX(i,e,t){const n=Ri();if(n.firstCreatePass){const r=Yo(i);wE(t,n.data,n.blueprint,r,!0),wE(e,n.data,n.blueprint,r,!1)}}(n,r?r(i):i,e)}}class lf{}class jF{}class UF extends lf{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new oL(this);const n=Us(e);this._bootstrapComponents=gl(n.bootstrap),this._r3Injector=jB(e,t,[{provide:lf,useValue:this},{provide:Jl,useValue:this.componentFactoryResolver}],sn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class SE extends jF{constructor(e){super(),this.moduleType=e}create(e){return new UF(this.moduleType,e)}}class XX extends lf{constructor(e,t,n){super(),this.componentFactoryResolver=new oL(this),this.instance=null;const r=new CB([...e,{provide:lf,useValue:this},{provide:Jl,useValue:this.componentFactoryResolver}],t||eA(),n,new Set(["environment"]));this.injector=r,r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function vA(i,e,t=null){return new XX(i,e,t).injector}let ZX=(()=>{class i{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t.id)){const n=AB(0,t.type),r=n.length>0?vA([n],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t.id,r)}return this.cachedInjectors.get(t.id)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}}return i.\u0275prov=He({token:i,providedIn:"environment",factory:()=>new i(xe(xa))}),i})();function TE(i){i.getStandaloneInjector=e=>e.get(ZX).getOrCreateStandaloneInjector(i)}function Ce(i,e,t){const n=Jr()+i,r=ze();return r[n]===Zt?Ca(r,n,t?e.call(t):e()):function d_(i,e){return i[e]}(r,n)}function Ht(i,e,t,n){return qF(ze(),Jr(),i,e,t,n)}function $o(i,e,t,n,r){return YF(ze(),Jr(),i,e,t,n,r)}function Bd(i,e,t,n,r,s){return function XF(i,e,t,n,r,s,o,a){const l=e+t;return function uA(i,e,t,n,r){const s=Id(i,e,t,n);return Gr(i,e+2,r)||s}(i,l,r,s,o)?Ca(i,l+3,a?n.call(a,r,s,o):n(r,s,o)):A_(i,l+3)}(ze(),Jr(),i,e,t,n,r,s)}function v_(i,e,t,n,r,s,o){return function ZF(i,e,t,n,r,s,o,a,l){const c=e+t;return function Ao(i,e,t,n,r,s){const o=Id(i,e,t,n);return Id(i,e+2,r,s)||o}(i,c,r,s,o,a)?Ca(i,c+4,l?n.call(l,r,s,o,a):n(r,s,o,a)):A_(i,c+4)}(ze(),Jr(),i,e,t,n,r,s,o)}function A_(i,e){const t=i[e];return t===Zt?void 0:t}function qF(i,e,t,n,r,s){const o=e+t;return Gr(i,o,r)?Ca(i,o+1,s?n.call(s,r):n(r)):A_(i,o+1)}function YF(i,e,t,n,r,s,o){const a=e+t;return Id(i,a,r,s)?Ca(i,a+2,o?n.call(o,r,s):n(r,s)):A_(i,a+2)}function On(i,e){const t=Ri();let n;const r=i+22;t.firstCreatePass?(n=function dZ(i,e){if(e)for(let t=e.length-1;t>=0;t--){const n=e[t];if(i===n.name)return n}}(e,t.pipeRegistry),t.data[r]=n,n.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(r,n.onDestroy)):n=t.data[r];const s=n.factory||(n.factory=Ad(n.type)),o=_o(I);try{const a=Ov(!1),l=s();return Ov(a),function rY(i,e,t,n){t>=i.data.length&&(i.data[t]=null,i.blueprint[t]=null),e[t]=n}(t,ze(),r,l),l}finally{_o(o)}}function Zn(i,e,t){const n=i+22,r=ze(),s=Dh(r,n);return y_(r,n)?qF(r,Jr(),e,s.transform,t,s):s.transform(t)}function y_(i,e){return i[1].data[e].pure}function IE(i){return e=>{setTimeout(i,void 0,e)}}const Tt=class pZ extends Wt{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){let r=e,s=t||(()=>null),o=n;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=IE(s),r&&(r=IE(r)),o&&(o=IE(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof un&&e.add(a),a}};function mZ(){return this._results[Rd()]()}class Ld{get changes(){return this._changes||(this._changes=new Tt)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Rd(),n=Ld.prototype;n[t]||(n[t]=mZ)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const n=this;n.dirty=!1;const r=function vo(i){return i.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function DW(i,e,t){if(i.length!==e.length)return!1;for(let n=0;n<i.length;n++){let r=i[n],s=e[n];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let is=(()=>{class i{}return i.__NG_ELEMENT_ID__=bZ,i})();const gZ=is,_Z=class extends gZ{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}createEmbeddedView(e,t){const n=this._declarationTContainer.tViews,r=nA(this._declarationLView,n,e,16,null,n.declTNode,null,null,null,null,t||null);r[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(r[19]=o.createEmbeddedView(n)),Z1(n,r,e),new l_(r)}};function bZ(){return AA(Rr(),ze())}function AA(i,e){return 4&i.type?new _Z(e,i,Hh(i,e)):null}let Ir=(()=>{class i{}return i.__NG_ELEMENT_ID__=vZ,i})();function vZ(){return tO(Rr(),ze())}const AZ=Ir,JF=class extends AZ{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return Hh(this._hostTNode,this._hostLView)}get injector(){return new Bh(this._hostTNode,this._hostLView)}get parentInjector(){const e=n1(this._hostTNode,this._hostLView);if(lk(e)){const t=Fv(e,this._hostLView),n=Lv(e);return new Bh(t[1].data[n+8],t)}return new Bh(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=eO(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,n){let r,s;"number"==typeof n?r=n:null!=n&&(r=n.index,s=n.injector);const o=e.createEmbeddedView(t||{},s);return this.insert(o,r),o}createComponent(e,t,n,r,s){const o=e&&!function Zg(i){return"function"==typeof i}(e);let a;if(o)a=t;else{const u=t||{};a=u.index,n=u.injector,r=u.projectableNodes,s=u.environmentInjector||u.ngModuleRef}const l=o?e:new c_(Hi(e)),c=n||this.parentInjector;if(!s&&null==l.ngModule){const h=(o?c:this.parentInjector).get(xa,null);h&&(s=h)}const d=l.create(c,r,void 0,s);return this.insert(d.hostView,a),d}insert(e,t){const n=e._lView,r=n[1];if(function tW(i){return qo(i[3])}(n)){const d=this.indexOf(e);if(-1!==d)this.detach(d);else{const u=n[3],h=new JF(u,u[6],u[3]);h.detach(h.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function A7(i,e,t,n){const r=10+n,s=t.length;n>0&&(t[r-1][4]=e),n<s-10?(e[4]=t[r],Ak(t,10+n,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function y7(i,e){const t=i[9];e[16]!==e[3][3][16]&&(i[2]=!0),null===t?i[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(i),e[2]|=64}(r,n,o,s);const a=M1(s,o),l=n[11],c=Qv(l,o[7]);return null!==c&&function _7(i,e,t,n,r,s){n[0]=r,n[6]=e,i_(i,n,t,1,r,s)}(r,o[6],l,n,c,a),e.attachToViewContainerRef(),Ak(DE(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=eO(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=x1(this._lContainer,t);n&&(Uv(DE(this._lContainer),t),Hk(n[1],n))}detach(e){const t=this._adjustIndex(e,-1),n=x1(this._lContainer,t);return n&&null!=Uv(DE(this._lContainer),t)?new l_(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function eO(i){return i[8]}function DE(i){return i[8]||(i[8]=[])}function tO(i,e){let t;const n=e[i.index];if(qo(n))t=n;else{let r;if(8&i.type)r=Tr(n);else{const s=e[11];r=s.createComment("");const o=zs(i,e);Cd(s,Qv(s,o),r,function M7(i,e){return i.nextSibling(e)}(s,o),!1)}e[i.index]=t=tL(n,e,r,i),sA(e,t)}return new JF(t,i,e)}class PE{constructor(e){this.queryList=e,this.matches=null}clone(){return new PE(this.queryList)}setDirty(){this.queryList.setDirty()}}class kE{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<n;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new kE(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==oO(e,t).matches&&this.queries[t].setDirty()}}class iO{constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class BE{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const r=null!==t?t.length:0,s=this.getByIndex(n).embeddedTView(e,r);s&&(s.indexInDeclarationView=n,null!==t?t.push(s):t=[s])}return null!==t?new BE(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class LE{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new LE(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){const s=n[r];this.matchTNodeWithReadOption(e,t,yZ(t,s)),this.matchTNodeWithReadOption(e,t,jv(t,e,s,!1,!1))}else n===is?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,jv(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===Ft||r===Ir||r===is&&4&t.type)this.addMatch(t.index,-2);else{const s=jv(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function yZ(i,e){const t=i.localNames;if(null!==t)for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1];return null}function wZ(i,e,t,n){return-1===t?function xZ(i,e){return 11&i.type?Hh(i,e):4&i.type?AA(i,e):null}(e,i):-2===t?function CZ(i,e,t){return t===Ft?Hh(e,i):t===is?AA(e,i):t===Ir?tO(e,i):void 0}(i,e,n):xd(i,i[1],t,e)}function nO(i,e,t,n){const r=e[19].queries[n];if(null===r.matches){const s=i.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:wZ(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function FE(i,e,t,n){const r=i.queries.getByIndex(t),s=r.matches;if(null!==s){const o=nO(i,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)n.push(o[a/2]);else{const c=s[a+1],d=e[-l];for(let u=10;u<d.length;u++){const h=d[u];h[17]===h[3]&&FE(h[1],h,c,n)}if(null!==d[9]){const u=d[9];for(let h=0;h<u.length;h++){const f=u[h];FE(f[1],f,c,n)}}}}}return n}function Ot(i){const e=ze(),t=Ri(),n=ZP();YM(n+1);const r=oO(t,n);if(i.dirty&&function eW(i){return 4==(4&i[2])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)i.reset([]);else{const s=r.crossesNgTemplate?FE(t,e,n,[]):nO(t,e,r,n);i.reset(s,A9),i.notifyOnChanges()}return!0}return!1}function ji(i,e,t){const n=Ri();n.firstCreatePass&&(sO(n,new iO(i,e,t),-1),2==(2&e)&&(n.staticViewQueries=!0)),rO(n,ze(),e)}function Nn(i,e,t,n){const r=Ri();if(r.firstCreatePass){const s=Rr();sO(r,new iO(e,t,n),s.index),function EZ(i,e){const t=i.contentQueries||(i.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(i.queries.length-1,e)}(r,i),2==(2&t)&&(r.staticContentQueries=!0)}rO(r,ze(),t)}function Nt(){return function MZ(i,e){return i[19].queries[e].queryList}(ze(),ZP())}function rO(i,e,t){const n=new Ld(4==(4&t));XB(i,e,n,n.destroy),null===e[19]&&(e[19]=new kE),e[19].queries.push(new PE(n))}function sO(i,e,t){null===i.queries&&(i.queries=new BE),i.queries.track(new LE(e,t))}function oO(i,e){return i.queries.getByIndex(e)}function Fd(i,e){return AA(i,e)}function xA(...i){}const wA=new Oe("Application Initializer");let CA=(()=>{class i{constructor(t){this.appInits=t,this.resolve=xA,this.reject=xA,this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],n=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(h_(s))t.push(s);else if(fE(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{n()}).catch(r=>{this.reject(r)}),0===t.length&&n(),this.initialized=!0}}return i.\u0275fac=function(t){return new(t||i)(xe(wA,8))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const w_=new Oe("AppId",{providedIn:"root",factory:function MO(){return`${VE()}${VE()}${VE()}`}});function VE(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const EO=new Oe("Platform Initializer"),C_=new Oe("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),SO=new Oe("appBootstrapListener"),rs=new Oe("AnimationModuleType");let WZ=(()=>{class i{log(t){console.log(t)}warn(t){console.warn(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();const Ea=new Oe("LocaleId",{providedIn:"root",factory:()=>Et(Ea,Vt.Optional|Vt.SkipSelf)||function qZ(){return typeof $localize<"u"&&$localize.locale||af}()});class XZ{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let TO=(()=>{class i{compileModuleSync(t){return new SE(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const n=this.compileModuleSync(t),s=gl(Us(t).declarations).reduce((o,a)=>{const l=Hi(a);return l&&o.push(new c_(l)),o},[]);return new XZ(n,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const $Z=(()=>Promise.resolve(0))();function zE(i){typeof Zone>"u"?$Z.then(()=>{i&&i.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",i)}class gt{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Tt(!1),this.onMicrotaskEmpty=new Tt(!1),this.onStable=new Tt(!1),this.onError=new Tt(!1),typeof Zone>"u")throw new Pe(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&t,r.shouldCoalesceRunChangeDetection=n,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function JZ(){let i=on.requestAnimationFrame,e=on.cancelAnimationFrame;if(typeof Zone<"u"&&i&&e){const t=i[Zone.__symbol__("OriginalDelegate")];t&&(i=t);const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function iK(i){const e=()=>{!function tK(i){i.isCheckStableRunning||-1!==i.lastRequestAnimationFrameId||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(on,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,HE(i),i.isCheckStableRunning=!0,GE(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),HE(i))}(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,r,s,o,a)=>{try{return DO(i),t.invokeTask(r,s,o,a)}finally{(i.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||i.shouldCoalesceRunChangeDetection)&&e(),PO(i)}},onInvoke:(t,n,r,s,o,a,l)=>{try{return DO(i),t.invoke(r,s,o,a,l)}finally{i.shouldCoalesceRunChangeDetection&&e(),PO(i)}},onHasTask:(t,n,r,s)=>{t.hasTask(r,s),n===r&&("microTask"==s.change?(i._hasPendingMicrotasks=s.microTask,HE(i),GE(i)):"macroTask"==s.change&&(i.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,n,r,s)=>(t.handleError(r,s),i.runOutsideAngular(()=>i.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!gt.isInAngularZone())throw new Pe(909,!1)}static assertNotInAngularZone(){if(gt.isInAngularZone())throw new Pe(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,eK,xA,xA);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const eK={};function GE(i){if(0==i._nesting&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function HE(i){i.hasPendingMicrotasks=!!(i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&-1!==i.lastRequestAnimationFrameId)}function DO(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function PO(i){i._nesting--,GE(i)}class nK{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Tt,this.onMicrotaskEmpty=new Tt,this.onStable=new Tt,this.onError=new Tt}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,r){return e.apply(t,n)}}const kO=new Oe(""),MA=new Oe("");let qE,QE=(()=>{class i{constructor(t,n,r){this._ngZone=t,this.registry=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,qE||(function rK(i){qE=i}(r),r.addToWindow(n)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{gt.assertNotInAngularZone(),zE(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())zE(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(n=>!n.updateCb||!n.updateCb(t)||(clearTimeout(n.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,n,r){let s=-1;n&&n>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},n)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,n,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,n,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,n,r){return[]}}return i.\u0275fac=function(t){return new(t||i)(xe(gt),xe(WE),xe(MA))},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})(),WE=(()=>{class i{constructor(){this._applications=new Map}registerApplication(t,n){this._applications.set(t,n)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,n=!0){return qE?.findTestabilityInTree(this,t,n)??null}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})(),ic=null;const BO=new Oe("AllowMultipleToken"),YE=new Oe("PlatformDestroyListeners");class LO{constructor(e,t){this.name=e,this.token=t}}function OO(i,e,t=[]){const n=`Platform: ${e}`,r=new Oe(n);return(s=[])=>{let o=XE();if(!o||o.injector.get(BO,!1)){const a=[...t,...s,{provide:r,useValue:!0}];i?i(a):function aK(i){if(ic&&!ic.get(BO,!1))throw new Pe(400,!1);ic=i;const e=i.get(jO);(function FO(i){const e=i.get(EO,null);e&&e.forEach(t=>t())})(i)}(function NO(i=[],e){return zr.create({name:e,providers:[{provide:O1,useValue:"platform"},{provide:YE,useValue:new Set([()=>ic=null])},...i]})}(a,n))}return function cK(i){const e=XE();if(!e)throw new Pe(401,!1);return e}()}}function XE(){return ic?.get(jO)??null}let jO=(()=>{class i{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,n){const r=function VO(i,e){let t;return t="noop"===i?new nK:("zone.js"===i?void 0:i)||new gt(e),t}(n?.ngZone,function UO(i){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!i||!i.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!i||!i.ngZoneRunCoalescing)||!1}}(n)),s=[{provide:gt,useValue:r}];return r.run(()=>{const o=zr.create({providers:s,parent:this.injector,name:t.moduleType.name}),a=t.create(o),l=a.injector.get(ml,null);if(!l)throw new Pe(402,!1);return r.runOutsideAngular(()=>{const c=r.onError.subscribe({next:d=>{l.handleError(d)}});a.onDestroy(()=>{EA(this._modules,a),c.unsubscribe()})}),function zO(i,e,t){try{const n=t();return h_(n)?n.catch(r=>{throw e.runOutsideAngular(()=>i.handleError(r)),r}):n}catch(n){throw e.runOutsideAngular(()=>i.handleError(n)),n}}(l,r,()=>{const c=a.injector.get(CA);return c.runInitializers(),c.donePromise.then(()=>(function pF(i){go(i,"Expected localeId to be defined"),"string"==typeof i&&(fF=i.toLowerCase().replace(/_/g,"-"))}(a.injector.get(Ea,af)||af),this._moduleDoBootstrap(a),a))})})}bootstrapModule(t,n=[]){const r=GO({},n);return function sK(i,e,t){const n=new SE(t);return Promise.resolve(n)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const n=t.injector.get(uf);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>n.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Pe(-403,!1);t.instance.ngDoBootstrap(n)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Pe(404,!1);this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n());const t=this._injector.get(YE,null);t&&(t.forEach(n=>n()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return i.\u0275fac=function(t){return new(t||i)(xe(zr))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();function GO(i,e){return Array.isArray(e)?e.reduce(GO,i):{...i,...e}}let uf=(()=>{class i{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(t,n,r){this._zone=t,this._injector=n,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new Oi(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),o=new Oi(a=>{let l;this._zone.runOutsideAngular(()=>{l=this._zone.onStable.subscribe(()=>{gt.assertNotInAngularZone(),zE(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const c=this._zone.onUnstable.subscribe(()=>{gt.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{l.unsubscribe(),c.unsubscribe()}});this.isStable=bd(s,o.pipe(SM()))}bootstrap(t,n){const r=t instanceof EB;if(!this._injector.get(CA).done)throw!r&&function Eh(i){const e=Hi(i)||Nr(i)||Kr(i);return null!==e&&e.standalone}(t),new Pe(405,false);let o;o=r?t:this._injector.get(Jl).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function oK(i){return i.isBoundToModule}(o)?void 0:this._injector.get(lf),c=o.create(zr.NULL,[],n||o.selector,a),d=c.location.nativeElement,u=c.injector.get(kO,null);return u?.registerApplication(d),c.onDestroy(()=>{this.detachView(c.hostView),EA(this.components,c),u?.unregisterApplication(d)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new Pe(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const n=t;this._views.push(n),n.attachToAppRef(this)}detachView(t){const n=t;EA(this._views,n),n.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const n=this._injector.get(SO,[]);n.push(...this._bootstrapListeners),n.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>EA(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Pe(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return i.\u0275fac=function(t){return new(t||i)(xe(gt),xe(xa),xe(ml))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function EA(i,e){const t=i.indexOf(e);t>-1&&i.splice(t,1)}function uK(){return!1}let sr=(()=>{class i{}return i.__NG_ELEMENT_ID__=hK,i})();function hK(i){return function fK(i,e,t){if(Hg(i)&&!t){const n=Gs(i.index,e);return new l_(n,n)}return 47&i.type?new l_(e[16],e):null}(Rr(),ze(),16==(16&i))}class YO{constructor(){}supports(e){return dA(e)}create(e){return new vK(e)}}const bK=(i,e)=>e;class vK{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||bK}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,r=0,s=null;for(;t||n;){const o=!n||t&&t.currentIndex<ZO(n,r,s)?t:n,a=ZO(o,r,s),l=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,d=l-r;if(c!=d){for(let h=0;h<c;h++){const f=h<s.length?s[h]:s[h]=0,m=f+h;d<=m&&m<c&&(s[h]=f+1)}s[o.previousIndex]=d-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!dA(e))throw new Pe(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,n=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),n=!0),t=t._next}else r=0,function eY(i,e){if(Array.isArray(i))for(let t=0;t<i.length;t++)e(i[t]);else{const t=i[Rd()]();let n;for(;!(n=t.next()).done;)e(n.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),n=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new AK(t,n),s,r),e}_verifyReinsertion(e,t,n,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new XO),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new XO),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class AK{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class yK{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class XO{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new yK,this.map.set(t,n)),n.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function ZO(i,e,t){const n=i.previousIndex;if(null===n)return n;let r=0;return t&&n<t.length&&(r=t[n]),n+e+r}class KO{constructor(){}supports(e){return e instanceof Map||cE(e)}create(){return new xK}}class xK{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||cE(e)))throw new Pe(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(n,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,n),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,n);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let n=t;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const n=new wK(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}}class wK{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function $O(){return new RA([new YO])}let RA=(()=>{class i{constructor(t){this.factories=t}static create(t,n){if(null!=n){const r=n.factories.slice();t=t.concat(r)}return new i(t)}static extend(t){return{provide:i,useFactory:n=>i.create(t,n||$O()),deps:[[i,new Uh,new hl]]}}find(t){const n=this.factories.find(r=>r.supports(t));if(null!=n)return n;throw new Pe(901,!1)}}return i.\u0275prov=He({token:i,providedIn:"root",factory:$O}),i})();function JO(){return new M_([new KO])}let M_=(()=>{class i{constructor(t){this.factories=t}static create(t,n){if(n){const r=n.factories.slice();t=t.concat(r)}return new i(t)}static extend(t){return{provide:i,useFactory:n=>i.create(t,n||JO()),deps:[[i,new Uh,new hl]]}}find(t){const n=this.factories.find(r=>r.supports(t));if(n)return n;throw new Pe(901,!1)}}return i.\u0275prov=He({token:i,providedIn:"root",factory:JO}),i})();const EK=OO(null,"core",[]);let SK=(()=>{class i{constructor(t){}}return i.\u0275fac=function(t){return new(t||i)(xe(uf))},i.\u0275mod=li({type:i}),i.\u0275inj=si({}),i})();function hf(i){return"boolean"==typeof i?i:null!=i&&"false"!==i}let eS=null;function Sa(){return eS}class IK{}const ti=new Oe("DocumentToken");let tS=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:function(){return function DK(){return xe(e3)}()},providedIn:"platform"}),i})();const PK=new Oe("Location Initialized");let e3=(()=>{class i extends tS{constructor(t){super(),this._doc=t,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Sa().getBaseHref(this._doc)}onPopState(t){const n=Sa().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",t,!1),()=>n.removeEventListener("popstate",t)}onHashChange(t){const n=Sa().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",t,!1),()=>n.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,n,r){t3()?this._history.pushState(t,n,r):this._location.hash=r}replaceState(t,n,r){t3()?this._history.replaceState(t,n,r):this._location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return i.\u0275fac=function(t){return new(t||i)(xe(ti))},i.\u0275prov=He({token:i,factory:function(){return function kK(){return new e3(xe(ti))}()},providedIn:"platform"}),i})();function t3(){return!!window.history.pushState}function iS(i,e){if(0==i.length)return e;if(0==e.length)return i;let t=0;return i.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?i+e.substring(1):1==t?i+e:i+"/"+e}function n3(i){const e=i.match(/#|\?|$/),t=e&&e.index||i.length;return i.slice(0,t-("/"===i[t-1]?1:0))+i.slice(t)}function vl(i){return i&&"?"!==i[0]?"?"+i:i}let Nd=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:function(){return Et(s3)},providedIn:"root"}),i})();const r3=new Oe("appBaseHref");let s3=(()=>{class i extends Nd{constructor(t,n){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??Et(ti).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return iS(this._baseHref,t)}path(t=!1){const n=this._platformLocation.pathname+vl(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${n}${r}`:n}pushState(t,n,r,s){const o=this.prepareExternalUrl(r+vl(s));this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){const o=this.prepareExternalUrl(r+vl(s));this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return i.\u0275fac=function(t){return new(t||i)(xe(tS),xe(r3,8))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),BK=(()=>{class i extends Nd{constructor(t,n){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let n=this._platformLocation.hash;return null==n&&(n="#"),n.length>0?n.substring(1):n}prepareExternalUrl(t){const n=iS(this._baseHref,t);return n.length>0?"#"+n:n}pushState(t,n,r,s){let o=this.prepareExternalUrl(r+vl(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){let o=this.prepareExternalUrl(r+vl(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return i.\u0275fac=function(t){return new(t||i)(xe(tS),xe(r3,8))},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})(),IA=(()=>{class i{constructor(t){this._subject=new Tt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const n=this._locationStrategy.getBaseHref();this._basePath=function OK(i){if(new RegExp("^(https?:)?//").test(i)){const[,t]=i.split(/\/\/[^\/]+/);return t}return i}(n3(o3(n))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,n=""){return this.path()==this.normalize(t+vl(n))}normalize(t){return i.stripTrailingSlash(function FK(i,e){return i&&new RegExp(`^${i}([/;?#]|$)`).test(e)?e.substring(i.length):e}(this._basePath,o3(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,n="",r=null){this._locationStrategy.pushState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+vl(n)),r)}replaceState(t,n="",r=null){this._locationStrategy.replaceState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+vl(n)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)})),()=>{const n=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(n,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",n){this._urlChangeListeners.forEach(r=>r(t,n))}subscribe(t,n,r){return this._subject.subscribe({next:t,error:n,complete:r})}}return i.normalizeQueryParams=vl,i.joinWithSlash=iS,i.stripTrailingSlash=n3,i.\u0275fac=function(t){return new(t||i)(xe(Nd))},i.\u0275prov=He({token:i,factory:function(){return function LK(){return new IA(xe(Nd))}()},providedIn:"root"}),i})();function o3(i){return i.replace(/\/index.html$/,"")}function m3(i,e){e=encodeURIComponent(e);for(const t of i.split(";")){const n=t.indexOf("="),[r,s]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}const hS=/\s+/,g3=[];let _3=(()=>{class i{constructor(t,n,r,s){this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=s,this.initialClasses=g3,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(hS):g3}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(hS):t}ngDoCheck(){for(const n of this.initialClasses)this._updateState(n,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const n of t)this._updateState(n,!0);else if(null!=t)for(const n of Object.keys(t))this._updateState(n,Boolean(t[n]));this._applyStateDiff()}_updateState(t,n){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==n&&(r.changed=!0,r.enabled=n),r.touched=!0):this.stateMap.set(t,{enabled:n,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const n=t[0],r=t[1];r.changed?(this._toggleClass(n,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(n,!1),this.stateMap.delete(n)),r.touched=!1}}_toggleClass(t,n){(t=t.trim()).length>0&&t.split(hS).forEach(r=>{n?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return i.\u0275fac=function(t){return new(t||i)(I(RA),I(M_),I(Ft),I(pl))},i.\u0275dir=Ne({type:i,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),i})(),b3=(()=>{class i{constructor(t){this._viewContainerRef=t,this.ngComponentOutlet=null}ngOnChanges(t){const{_viewContainerRef:n,ngComponentOutletNgModule:r,ngComponentOutletNgModuleFactory:s}=this;if(n.clear(),this._componentRef=void 0,this.ngComponentOutlet){const o=this.ngComponentOutletInjector||n.parentInjector;(t.ngComponentOutletNgModule||t.ngComponentOutletNgModuleFactory)&&(this._moduleRef&&this._moduleRef.destroy(),this._moduleRef=r?function YX(i,e){return new UF(i,e??null)}(r,v3(o)):s?s.create(v3(o)):void 0),this._componentRef=n.createComponent(this.ngComponentOutlet,{index:n.length,injector:o,ngModuleRef:this._moduleRef,projectableNodes:this.ngComponentOutletContent})}}ngOnDestroy(){this._moduleRef&&this._moduleRef.destroy()}}return i.\u0275fac=function(t){return new(t||i)(I(Ir))},i.\u0275dir=Ne({type:i,selectors:[["","ngComponentOutlet",""]],inputs:{ngComponentOutlet:"ngComponentOutlet",ngComponentOutletInjector:"ngComponentOutletInjector",ngComponentOutletContent:"ngComponentOutletContent",ngComponentOutletNgModule:"ngComponentOutletNgModule",ngComponentOutletNgModuleFactory:"ngComponentOutletNgModuleFactory"},standalone:!0,features:[Cr]}),i})();function v3(i){return i.get(lf).injector}class A${constructor(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let yl=(()=>{class i{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,n,r){this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const n=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)n.createEmbeddedView(this._template,new A$(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)n.remove(null===s?void 0:s);else if(null!==s){const a=n.get(s);n.move(a,o),y3(a,r)}});for(let r=0,s=n.length;r<s;r++){const a=n.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{y3(n.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(I(Ir),I(is),I(RA))},i.\u0275dir=Ne({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),i})();function y3(i,e){i.context.$implicit=e.item}let nc=(()=>{class i{constructor(t,n){this._viewContainer=t,this._context=new x$,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){x3("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){x3("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(I(Ir),I(is))},i.\u0275dir=Ne({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),i})();class x${constructor(){this.$implicit=null,this.ngIf=null}}function x3(i,e){if(e&&!e.createEmbeddedView)throw new Error(`${i} must be a TemplateRef, but received '${sn(e)}'.`)}class fS{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let UA=(()=>{class i{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews.push(t)}_matchCase(t){const n=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||n,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),n}_updateDefaultCases(t){if(this._defaultViews.length>0&&t!==this._defaultUsed){this._defaultUsed=t;for(const n of this._defaultViews)n.enforceState(t)}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=Ne({type:i,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),i})(),w3=(()=>{class i{constructor(t,n,r){this.ngSwitch=r,r._addCase(),this._view=new fS(t,n)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return i.\u0275fac=function(t){return new(t||i)(I(Ir),I(is),I(UA,9))},i.\u0275dir=Ne({type:i,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),i})(),M3=(()=>{class i{constructor(t,n,r){this._ngEl=t,this._differs=n,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,n){const[r,s]=t.split("."),o=-1===r.indexOf("-")?void 0:vs.DashCase;null!=n?this._renderer.setStyle(this._ngEl.nativeElement,r,s?`${n}${s}`:n,o):this._renderer.removeStyle(this._ngEl.nativeElement,r,o)}_applyChanges(t){t.forEachRemovedItem(n=>this._setStyle(n.key,null)),t.forEachAddedItem(n=>this._setStyle(n.key,n.currentValue)),t.forEachChangedItem(n=>this._setStyle(n.key,n.currentValue))}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(M_),I(pl))},i.\u0275dir=Ne({type:i,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),i})(),pS=(()=>{class i{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(t){if(t.ngTemplateOutlet||t.ngTemplateOutletInjector){const n=this._viewContainerRef;if(this._viewRef&&n.remove(n.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:s,ngTemplateOutletInjector:o}=this;this._viewRef=n.createEmbeddedView(r,s,o?{injector:o}:void 0)}else this._viewRef=null}else this._viewRef&&t.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return i.\u0275fac=function(t){return new(t||i)(I(Ir))},i.\u0275dir=Ne({type:i,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Cr]}),i})();class M${createSubscription(e,t){return e.subscribe({next:t,error:n=>{throw n}})}dispose(e){e.unsubscribe()}}class E${createSubscription(e,t){return e.then(t,n=>{throw n})}dispose(e){}}const S$=new E$,T$=new M$;let mS=(()=>{class i{constructor(t){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,n=>this._updateLatestValue(t,n))}_selectStrategy(t){if(h_(t))return S$;if(yL(t))return T$;throw function ta(i,e){return new Pe(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,n){t===this._obj&&(this._latestValue=n,this._ref.markForCheck())}}return i.\u0275fac=function(t){return new(t||i)(I(sr,16))},i.\u0275pipe=_i({name:"async",type:i,pure:!1,standalone:!0}),i})(),Ta=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({}),i})();const S3="browser";function T3(i){return i===S3}let X$=(()=>{class i{}return i.\u0275prov=He({token:i,providedIn:"root",factory:()=>new Z$(xe(ti),window)}),i})();class Z${constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function K$(i,e){const t=i.getElementById(e)||i.getElementsByName(e)[0];if(t)return t;if("function"==typeof i.createTreeWalker&&i.body&&(i.body.createShadowRoot||i.body.attachShadow)){const n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT);let r=n.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=R3(this.window.history)||R3(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function R3(i){return Object.getOwnPropertyDescriptor(i,"scrollRestoration")}class I3{}class CJ extends IK{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class AS extends CJ{static makeCurrent(){!function RK(i){eS||(eS=i)}(new AS)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function MJ(){return R_=R_||document.querySelector("base"),R_?R_.getAttribute("href"):null}();return null==t?null:function EJ(i){zA=zA||document.createElement("a"),zA.setAttribute("href",i);const e=zA.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){R_=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return m3(document.cookie,e)}}let zA,R_=null;const F3=new Oe("TRANSITION_ID"),TJ=[{provide:wA,useFactory:function SJ(i,e,t){return()=>{t.get(CA).donePromise.then(()=>{const n=Sa(),r=e.querySelectorAll(`style[ng-transition="${i}"]`);for(let s=0;s<r.length;s++)n.remove(r[s])})}},deps:[F3,ti,zr],multi:!0}];let IJ=(()=>{class i{build(){return new XMLHttpRequest}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})();const GA=new Oe("EventManagerPlugins");let HA=(()=>{class i{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,n,r){return this._findPluginFor(n).addEventListener(t,n,r)}addGlobalEventListener(t,n,r){return this._findPluginFor(n).addGlobalEventListener(t,n,r)}getZone(){return this._zone}_findPluginFor(t){const n=this._eventNameToPlugin.get(t);if(n)return n;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return i.\u0275fac=function(t){return new(t||i)(xe(GA),xe(gt))},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})();class O3{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const r=Sa().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,n)}}let N3=(()=>{class i{constructor(){this._stylesSet=new Set}addStyles(t){const n=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),n.add(r))}),this.onStylesAdded(n)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})(),I_=(()=>{class i extends N3{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,n,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(n.appendChild(o))})}addHost(t){const n=[];this._addStylesToHost(this._stylesSet,t,n),this._hostNodes.set(t,n)}removeHost(t){const n=this._hostNodes.get(t);n&&n.forEach(j3),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((n,r)=>{this._addStylesToHost(t,r,n)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(j3))}}return i.\u0275fac=function(t){return new(t||i)(xe(ti))},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})();function j3(i){Sa().remove(i)}const yS={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},xS=/%COMP%/g;function wS(i,e){return e.flat(100).map(t=>t.replace(xS,i))}function z3(i){return e=>{if("__ngUnwrap__"===e)return i;!1===i(e)&&(e.preventDefault(),e.returnValue=!1)}}let QA=(()=>{class i{constructor(t,n,r){this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new CS(t)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;switch(n.encapsulation){case Qo.Emulated:{let r=this.rendererByCompId.get(n.id);return r||(r=new FJ(this.eventManager,this.sharedStylesHost,n,this.appId),this.rendererByCompId.set(n.id,r)),r.applyToHost(t),r}case Qo.ShadowDom:return new OJ(this.eventManager,this.sharedStylesHost,t,n);default:if(!this.rendererByCompId.has(n.id)){const r=wS(n.id,n.styles);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(n.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return i.\u0275fac=function(t){return new(t||i)(xe(HA),xe(I_),xe(w_))},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})();class CS{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(yS[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(H3(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(H3(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;const s=yS[r];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const r=yS[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(vs.DashCase|vs.Important)?e.style.setProperty(t,n,r&vs.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&vs.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,z3(n)):this.eventManager.addEventListener(e,t,z3(n))}}function H3(i){return"TEMPLATE"===i.tagName&&void 0!==i.content}class FJ extends CS{constructor(e,t,n,r){super(e),this.component=n;const s=wS(r+"-"+n.id,n.styles);t.addStyles(s),this.contentAttr=function kJ(i){return"_ngcontent-%COMP%".replace(xS,i)}(r+"-"+n.id),this.hostAttr=function BJ(i){return"_nghost-%COMP%".replace(xS,i)}(r+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class OJ extends CS{constructor(e,t,n,r){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=wS(r.id,r.styles);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let NJ=(()=>{class i extends O3{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,r){return t.addEventListener(n,r,!1),()=>this.removeEventListener(t,n,r)}removeEventListener(t,n,r){return t.removeEventListener(n,r)}}return i.\u0275fac=function(t){return new(t||i)(xe(ti))},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})();const Q3=["alt","control","meta","shift"],jJ={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},UJ={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let VJ=(()=>{class i extends O3{constructor(t){super(t)}supports(t){return null!=i.parseEventName(t)}addEventListener(t,n,r){const s=i.parseEventName(n),o=i.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Sa().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const n=t.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const s=i._normalizeKey(n.pop());let o="",a=n.indexOf("code");if(a>-1&&(n.splice(a,1),o="code."),Q3.forEach(c=>{const d=n.indexOf(c);d>-1&&(n.splice(d,1),o+=c+".")}),o+=s,0!=n.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,n){let r=jJ[t.key]||t.key,s="";return n.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),Q3.forEach(o=>{o!==r&&(0,UJ[o])(t)&&(s+=o+".")}),s+=r,s===n)}static eventCallback(t,n,r){return s=>{i.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>n(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return i.\u0275fac=function(t){return new(t||i)(xe(ti))},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})();const q3=[{provide:C_,useValue:S3},{provide:EO,useValue:function zJ(){AS.makeCurrent()},multi:!0},{provide:ti,useFactory:function HJ(){return function k7(i){R1=i}(document),document},deps:[]}],QJ=OO(EK,"browser",q3),Y3=new Oe(""),X3=[{provide:MA,useClass:class RJ{addToWindow(e){on.getAngularTestability=(n,r=!0)=>{const s=e.findTestabilityInTree(n,r);if(null==s)throw new Error("Could not find testability for element.");return s},on.getAllAngularTestabilities=()=>e.getAllTestabilities(),on.getAllAngularRootElements=()=>e.getAllRootElements(),on.frameworkStabilizers||(on.frameworkStabilizers=[]),on.frameworkStabilizers.push(n=>{const r=on.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&n(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,n){return null==t?null:e.getTestability(t)??(n?Sa().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:kO,useClass:QE,deps:[gt,WE,MA]},{provide:QE,useClass:QE,deps:[gt,WE,MA]}],Z3=[{provide:O1,useValue:"root"},{provide:ml,useFactory:function GJ(){return new ml},deps:[]},{provide:GA,useClass:NJ,multi:!0,deps:[ti,gt,C_]},{provide:GA,useClass:VJ,multi:!0,deps:[ti]},{provide:QA,useClass:QA,deps:[HA,I_,w_]},{provide:s_,useExisting:QA},{provide:N3,useExisting:I_},{provide:I_,useClass:I_,deps:[ti]},{provide:HA,useClass:HA,deps:[GA,gt]},{provide:I3,useClass:IJ,deps:[]},[]];let K3=(()=>{class i{constructor(t){}static withServerTransition(t){return{ngModule:i,providers:[{provide:w_,useValue:t.appId},{provide:F3,useExisting:w_},TJ]}}}return i.\u0275fac=function(t){return new(t||i)(xe(Y3,12))},i.\u0275mod=li({type:i}),i.\u0275inj=si({providers:[...Z3,...X3],imports:[Ta,SK]}),i})(),$3=(()=>{class i{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return i.\u0275fac=function(t){return new(t||i)(xe(ti))},i.\u0275prov=He({token:i,factory:function(t){let n=null;return n=t?new t:function qJ(){return new $3(xe(ti))}(),n},providedIn:"root"}),i})();typeof window<"u"&&window;let WA=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:function(t){let n=null;return n=t?new(t||i):xe(tN),n},providedIn:"root"}),i})(),tN=(()=>{class i extends WA{constructor(t){super(),this._doc=t}sanitize(t,n){if(null==n)return null;switch(t){case Bi.NONE:return n;case Bi.HTML:return ya(n,"HTML")?Qs(n):fB(this._doc,String(n)).toString();case Bi.STYLE:return ya(n,"Style")?Qs(n):n;case Bi.SCRIPT:if(ya(n,"Script"))return Qs(n);throw new Error("unsafe value used in a script context");case Bi.URL:return ya(n,"URL")?Qs(n):Zv(String(n));case Bi.RESOURCE_URL:if(ya(n,"ResourceURL"))return Qs(n);throw new Error(`unsafe value used in a resource URL context (see ${_v})`);default:throw new Error(`Unexpected SecurityContext ${t} (see ${_v})`)}}bypassSecurityTrustHtml(t){return function U7(i){return new B7(i)}(t)}bypassSecurityTrustStyle(t){return function V7(i){return new L7(i)}(t)}bypassSecurityTrustScript(t){return function z7(i){return new F7(i)}(t)}bypassSecurityTrustUrl(t){return function G7(i){return new O7(i)}(t)}bypassSecurityTrustResourceUrl(t){return function H7(i){return new N7(i)}(t)}}return i.\u0275fac=function(t){return new(t||i)(xe(ti))},i.\u0275prov=He({token:i,factory:function(t){let n=null;return n=t?new t:function eee(i){return new tN(i.get(ti))}(xe(zr)),n},providedIn:"root"}),i})();function St(...i){return En(i,Fg(i))}class qs extends Wt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}const qA=mM(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:tee}=Array,{getPrototypeOf:iee,prototype:nee,keys:ree}=Object;function iN(i){if(1===i.length){const e=i[0];if(tee(e))return{args:e,keys:null};if(function see(i){return i&&"object"==typeof i&&iee(i)===nee}(e)){const t=ree(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}const{isArray:oee}=Array;function SS(i){return wt(e=>function aee(i,e){return oee(e)?i(...e):i(e)}(i,e))}function nN(i,e){return i.reduce((t,n,r)=>(t[n]=e[r],t),{})}function TS(...i){const e=Fg(i),t=EM(i),{args:n,keys:r}=iN(i);if(0===n.length)return En([],e);const s=new Oi(function lee(i,e,t=Xl){return n=>{rN(e,()=>{const{length:r}=i,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)rN(e,()=>{const c=En(i[l],e);let d=!1;c.subscribe(hn(n,u=>{s[l]=u,d||(d=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}(n,e,r?o=>nN(r,o):Xl));return t?s.pipe(SS(t)):s}function rN(i,e,t){i?ol(t,i,e):e()}function YA(...i){return function cee(){return Ch(1)}()(En(i,Fg(i)))}function sN(i){return new Oi(e=>{_s(i()).subscribe(e)})}function ia(i,e){const t=Ti(i)?i:()=>i,n=r=>r.error(t());return new Oi(e?r=>e.schedule(n,0,r):n)}function XA(){return Mn((i,e)=>{let t=null;i._refCount++;const n=hn(e,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(t=null);const r=i._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});i.subscribe(n),n.closed||(t=i.connect())})}class RS extends Oi{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,sP(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new un;const t=this.getSubject();e.add(this.source.subscribe(hn(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=un.EMPTY)}return e}refCount(){return XA()(this)}}function Ys(i,e){return Mn((t,n)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&n.complete();t.subscribe(hn(n,l=>{r?.unsubscribe();let c=0;const d=s++;_s(i(l,d)).subscribe(r=hn(n,u=>n.next(e?e(l,u,d,c++):u),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function sc(...i){const e=Fg(i);return Mn((t,n)=>{(e?YA(i,t,e):YA(i,t)).subscribe(n)})}function jn(i,e){return Mn((t,n)=>{let r=0;t.subscribe(hn(n,s=>i.call(e,s,r++)&&n.next(s)))})}function ZA(i){return Mn((e,t)=>{let n=!1;e.subscribe(hn(t,r=>{n=!0,t.next(r)},()=>{n||t.next(i),t.complete()}))})}function oN(i=dee){return Mn((e,t)=>{let n=!1;e.subscribe(hn(t,r=>{n=!0,t.next(r)},()=>n?t.complete():t.error(i())))})}function dee(){return new qA}function oc(i,e){const t=arguments.length>=2;return n=>n.pipe(i?jn((r,s)=>i(r,s,n)):Xl,bs(1),t?ZA(e):oN(()=>new qA))}function ac(i,e){return Ti(e)?wr(i,e,1):wr(i,1)}function ln(i,e,t){const n=Ti(i)||e||t?{next:i,error:e,complete:t}:i;return n?Mn((r,s)=>{var o;null===(o=n.subscribe)||void 0===o||o.call(n);let a=!0;r.subscribe(hn(s,l=>{var c;null===(c=n.next)||void 0===c||c.call(n,l),s.next(l)},()=>{var l;a=!1,null===(l=n.complete)||void 0===l||l.call(n),s.complete()},l=>{var c;a=!1,null===(c=n.error)||void 0===c||c.call(n,l),s.error(l)},()=>{var l,c;a&&(null===(l=n.unsubscribe)||void 0===l||l.call(n)),null===(c=n.finalize)||void 0===c||c.call(n)}))}):Xl}function na(i){return Mn((e,t)=>{let s,n=null,r=!1;n=e.subscribe(hn(t,void 0,void 0,o=>{s=_s(i(o,na(i)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):r=!0})),r&&(n.unsubscribe(),n=null,s.subscribe(t))})}function uee(i,e,t,n,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(hn(o,d=>{const u=c++;l=a?i(l,d,u):(a=!0,d),n&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function aN(i,e){return Mn(uee(i,e,arguments.length>=2,!0))}function IS(i){return i<=0?()=>Or:Mn((e,t)=>{let n=[];e.subscribe(hn(t,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(const r of n)t.next(r);t.complete()},void 0,()=>{n=null}))})}function lN(i,e){const t=arguments.length>=2;return n=>n.pipe(i?jn((r,s)=>i(r,s,n)):Xl,IS(1),t?ZA(e):oN(()=>new qA))}function DS(i){return wt(()=>i)}function KA(i){return Mn((e,t)=>{try{e.subscribe(t)}finally{t.add(i)}})}const mi="primary",D_=Symbol("RouteTitle");class fee{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function ff(i){return new fee(i)}function pee(i,e,t){const n=t.path.split("/");if(n.length>i.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<i.length))return null;const r={};for(let s=0;s<n.length;s++){const o=n[s],a=i[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function Ra(i,e){const t=i?Object.keys(i):void 0,n=e?Object.keys(e):void 0;if(!t||!n||t.length!=n.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!cN(i[r],e[r]))return!1;return!0}function cN(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;const t=[...i].sort(),n=[...e].sort();return t.every((r,s)=>n[s]===r)}return i===e}function dN(i){return Array.prototype.concat.apply([],i)}function uN(i){return i.length>0?i[i.length-1]:null}function Dr(i,e){for(const t in i)i.hasOwnProperty(t)&&e(i[t],t)}function lc(i){return fE(i)?i:h_(i)?En(Promise.resolve(i)):St(i)}const $A=!1,gee={exact:function pN(i,e,t){if(!Ud(i.segments,e.segments)||!JA(i.segments,e.segments,t)||i.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!i.children[n]||!pN(i.children[n],e.children[n],t))return!1;return!0},subset:mN},hN={exact:function _ee(i,e){return Ra(i,e)},subset:function bee(i,e){return Object.keys(e).length<=Object.keys(i).length&&Object.keys(e).every(t=>cN(i[t],e[t]))},ignored:()=>!0};function fN(i,e,t){return gee[t.paths](i.root,e.root,t.matrixParams)&&hN[t.queryParams](i.queryParams,e.queryParams)&&!("exact"===t.fragment&&i.fragment!==e.fragment)}function mN(i,e,t){return gN(i,e,e.segments,t)}function gN(i,e,t,n){if(i.segments.length>t.length){const r=i.segments.slice(0,t.length);return!(!Ud(r,t)||e.hasChildren()||!JA(r,t,n))}if(i.segments.length===t.length){if(!Ud(i.segments,t)||!JA(i.segments,t,n))return!1;for(const r in e.children)if(!i.children[r]||!mN(i.children[r],e.children[r],n))return!1;return!0}{const r=t.slice(0,i.segments.length),s=t.slice(i.segments.length);return!!(Ud(i.segments,r)&&JA(i.segments,r,n)&&i.children[mi])&&gN(i.children[mi],e,s,n)}}function JA(i,e,t){return e.every((n,r)=>hN[t](i[r].parameters,n.parameters))}class jd{constructor(e=new vi([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ff(this.queryParams)),this._queryParamMap}toString(){return yee.serialize(this)}}class vi{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Dr(t,(n,r)=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ey(this)}}class P_{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=ff(this.parameters)),this._parameterMap}toString(){return vN(this)}}function Ud(i,e){return i.length===e.length&&i.every((t,n)=>t.path===e[n].path)}let k_=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:function(){return new PS},providedIn:"root"}),i})();class PS{parse(e){const t=new Iee(e);return new jd(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${B_(e.root,!0)}`,n=function Cee(i){const e=Object.keys(i).map(t=>{const n=i[t];return Array.isArray(n)?n.map(r=>`${ty(t)}=${ty(r)}`).join("&"):`${ty(t)}=${ty(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${n}${"string"==typeof e.fragment?`#${function xee(i){return encodeURI(i)}(e.fragment)}`:""}`}}const yee=new PS;function ey(i){return i.segments.map(e=>vN(e)).join("/")}function B_(i,e){if(!i.hasChildren())return ey(i);if(e){const t=i.children[mi]?B_(i.children[mi],!1):"",n=[];return Dr(i.children,(r,s)=>{s!==mi&&n.push(`${s}:${B_(r,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function Aee(i,e){let t=[];return Dr(i.children,(n,r)=>{r===mi&&(t=t.concat(e(n,r)))}),Dr(i.children,(n,r)=>{r!==mi&&(t=t.concat(e(n,r)))}),t}(i,(n,r)=>r===mi?[B_(i.children[mi],!1)]:[`${r}:${B_(n,!1)}`]);return 1===Object.keys(i.children).length&&null!=i.children[mi]?`${ey(i)}/${t[0]}`:`${ey(i)}/(${t.join("//")})`}}function _N(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ty(i){return _N(i).replace(/%3B/gi,";")}function kS(i){return _N(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function iy(i){return decodeURIComponent(i)}function bN(i){return iy(i.replace(/\+/g,"%20"))}function vN(i){return`${kS(i.path)}${function wee(i){return Object.keys(i).map(e=>`;${kS(e)}=${kS(i[e])}`).join("")}(i.parameters)}`}const Mee=/^[^\/()?;=#]+/;function ny(i){const e=i.match(Mee);return e?e[0]:""}const Eee=/^[^=?&#]+/,Tee=/^[^&#]+/;class Iee{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new vi([],{}):new vi([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[mi]=new vi(e,t)),n}parseSegment(){const e=ny(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Pe(4009,$A);return this.capture(e),new P_(iy(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=ny(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const r=ny(this.remaining);r&&(n=r,this.capture(n))}e[iy(t)]=iy(n)}parseQueryParam(e){const t=function See(i){const e=i.match(Eee);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const o=function Ree(i){const e=i.match(Tee);return e?e[0]:""}(this.remaining);o&&(n=o,this.capture(n))}const r=bN(t),s=bN(n);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=ny(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Pe(4010,$A);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=mi);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[mi]:new vi([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Pe(4011,$A)}}function BS(i){return i.segments.length>0?new vi([],{[mi]:i}):i}function ry(i){const e={};for(const n of Object.keys(i.children)){const s=ry(i.children[n]);(s.segments.length>0||s.hasChildren())&&(e[n]=s)}return function Dee(i){if(1===i.numberOfChildren&&i.children[mi]){const e=i.children[mi];return new vi(i.segments.concat(e.segments),e.children)}return i}(new vi(i.segments,e))}function Vd(i){return i instanceof jd}function Bee(i,e,t,n,r){if(0===t.length)return pf(e.root,e.root,e.root,n,r);const s=function xN(i){if("string"==typeof i[0]&&1===i.length&&"/"===i[0])return new yN(!0,0,i);let e=0,t=!1;const n=i.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Dr(s.outlets,(l,c)=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new yN(t,e,n)}(t);return s.toRoot()?pf(e.root,e.root,new vi([],{}),n,r):function o(l){const c=function Fee(i,e,t,n){if(i.isAbsolute)return new mf(e.root,!0,0);if(-1===n)return new mf(t,t===e.root,0);return function wN(i,e,t){let n=i,r=e,s=t;for(;s>r;){if(s-=r,n=n.parent,!n)throw new Pe(4005,!1);r=n.segments.length}return new mf(n,!1,r-s)}(t,n+(L_(i.commands[0])?0:1),i.numberOfDoubleDots)}(s,e,i.snapshot?._urlSegment,l),d=c.processChildren?O_(c.segmentGroup,c.index,s.commands):FS(c.segmentGroup,c.index,s.commands);return pf(e.root,c.segmentGroup,d,n,r)}(i.snapshot?._lastPathIndex)}function L_(i){return"object"==typeof i&&null!=i&&!i.outlets&&!i.segmentPath}function F_(i){return"object"==typeof i&&null!=i&&i.outlets}function pf(i,e,t,n,r){let o,s={};n&&Dr(n,(l,c)=>{s[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`}),o=i===e?t:AN(i,e,t);const a=BS(ry(o));return new jd(a,s,r)}function AN(i,e,t){const n={};return Dr(i.children,(r,s)=>{n[s]=r===e?t:AN(r,e,t)}),new vi(i.segments,n)}class yN{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&L_(n[0]))throw new Pe(4003,!1);const r=n.find(F_);if(r&&r!==uN(n))throw new Pe(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class mf{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function FS(i,e,t){if(i||(i=new vi([],{})),0===i.segments.length&&i.hasChildren())return O_(i,e,t);const n=function Nee(i,e,t){let n=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=t.length)return s;const o=i.segments[r],a=t[n];if(F_(a))break;const l=`${a}`,c=n<t.length-1?t[n+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!MN(l,c,o))return s;n+=2}else{if(!MN(l,{},o))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}(i,e,t),r=t.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){const s=new vi(i.segments.slice(0,n.pathIndex),{});return s.children[mi]=new vi(i.segments.slice(n.pathIndex),i.children),O_(s,0,r)}return n.match&&0===r.length?new vi(i.segments,{}):n.match&&!i.hasChildren()?OS(i,e,t):n.match?O_(i,0,r):OS(i,e,t)}function O_(i,e,t){if(0===t.length)return new vi(i.segments,{});{const n=function Oee(i){return F_(i[0])?i[0].outlets:{[mi]:i}}(t),r={};return Dr(n,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=FS(i.children[o],e,s))}),Dr(i.children,(s,o)=>{void 0===n[o]&&(r[o]=s)}),new vi(i.segments,r)}}function OS(i,e,t){const n=i.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(F_(s)){const l=jee(s.outlets);return new vi(n,l)}if(0===r&&L_(t[0])){n.push(new P_(i.segments[e].path,CN(t[0]))),r++;continue}const o=F_(s)?s.outlets[mi]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&L_(a)?(n.push(new P_(o,CN(a))),r+=2):(n.push(new P_(o,{})),r++)}return new vi(n,{})}function jee(i){const e={};return Dr(i,(t,n)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[n]=OS(new vi([],{}),0,t))}),e}function CN(i){const e={};return Dr(i,(t,n)=>e[n]=`${t}`),e}function MN(i,e,t){return i==t.path&&Ra(e,t.parameters)}const N_="imperative";class Ia{constructor(e,t){this.id=e,this.url=t}}class NS extends Ia{constructor(e,t,n="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class zd extends Ia{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class sy extends Ia{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class EN extends Ia{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=16}}class SN extends Ia{constructor(e,t,n,r){super(e,t),this.error=n,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Uee extends Ia{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Vee extends Ia{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class zee extends Ia{constructor(e,t,n,r,s){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Gee extends Ia{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Hee extends Ia{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Qee{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Wee{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class qee{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Yee{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Xee{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Zee{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class TN{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let $ee=(()=>{class i{createUrlTree(t,n,r,s,o,a){return Bee(t||n.root,r,s,o,a)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})(),Jee=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:function(e){return $ee.\u0275fac(e)},providedIn:"root"}),i})();class RN{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=jS(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=jS(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=US(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return US(e,this._root).map(t=>t.value)}}function jS(i,e){if(i===e.value)return e;for(const t of e.children){const n=jS(i,t);if(n)return n}return null}function US(i,e){if(i===e.value)return[e];for(const t of e.children){const n=US(i,t);if(n.length)return n.unshift(e),n}return[]}class xl{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function gf(i){const e={};return i&&i.children.forEach(t=>e[t.value.outlet]=t),e}class IN extends RN{constructor(e,t){super(e),this.snapshot=t,VS(this,e)}toString(){return this.snapshot.toString()}}function DN(i,e){const t=function ete(i,e){const o=new oy([],{},{},"",{},mi,e,null,i.root,-1,{});return new kN("",new xl(o,[]))}(i,e),n=new qs([new P_("",{})]),r=new qs({}),s=new qs({}),o=new qs({}),a=new qs(""),l=new Gd(n,r,o,a,s,mi,e,t.root);return l.snapshot=t.root,new IN(new xl(l,[]),t)}class Gd{constructor(e,t,n,r,s,o,a,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.title=this.data?.pipe(wt(c=>c[D_]))??St(void 0),this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(wt(e=>ff(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(wt(e=>ff(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function PN(i,e="emptyOnly"){const t=i.pathFromRoot;let n=0;if("always"!==e)for(n=t.length-1;n>=1;){const r=t[n],s=t[n-1];if(r.routeConfig&&""===r.routeConfig.path)n--;else{if(s.component)break;n--}}return function tte(i){return i.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(n))}class oy{get title(){return this.data?.[D_]}constructor(e,t,n,r,s,o,a,l,c,d,u){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=d,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ff(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ff(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class kN extends RN{constructor(e,t){super(t),this.url=e,VS(this,t)}toString(){return BN(this._root)}}function VS(i,e){e.value._routerState=i,e.children.forEach(t=>VS(i,t))}function BN(i){const e=i.children.length>0?` { ${i.children.map(BN).join(", ")} } `:"";return`${i.value}${e}`}function zS(i){if(i.snapshot){const e=i.snapshot,t=i._futureSnapshot;i.snapshot=t,Ra(e.queryParams,t.queryParams)||i.queryParams.next(t.queryParams),e.fragment!==t.fragment&&i.fragment.next(t.fragment),Ra(e.params,t.params)||i.params.next(t.params),function mee(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;++t)if(!Ra(i[t],e[t]))return!1;return!0}(e.url,t.url)||i.url.next(t.url),Ra(e.data,t.data)||i.data.next(t.data)}else i.snapshot=i._futureSnapshot,i.data.next(i._futureSnapshot.data)}function GS(i,e){const t=Ra(i.params,e.params)&&function vee(i,e){return Ud(i,e)&&i.every((t,n)=>Ra(t.parameters,e[n].parameters))}(i.url,e.url);return t&&!(!i.parent!=!e.parent)&&(!i.parent||GS(i.parent,e.parent))}function j_(i,e,t){if(t&&i.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const r=function nte(i,e,t){return e.children.map(n=>{for(const r of t.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return j_(i,n,r);return j_(i,n)})}(i,e,t);return new xl(n,r)}{if(i.shouldAttach(e.value)){const s=i.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>j_(i,a)),o}}const n=function rte(i){return new Gd(new qs(i.url),new qs(i.params),new qs(i.queryParams),new qs(i.fragment),new qs(i.data),i.outlet,i.component,i)}(e.value),r=e.children.map(s=>j_(i,s));return new xl(n,r)}}const HS="ngNavigationCancelingError";function LN(i,e){const{redirectTo:t,navigationBehaviorOptions:n}=Vd(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=FN(!1,0,e);return r.url=t,r.navigationBehaviorOptions=n,r}function FN(i,e,t){const n=new Error("NavigationCancelingError: "+(i||""));return n[HS]=!0,n.cancellationCode=e,t&&(n.url=t),n}function ON(i){return NN(i)&&Vd(i.url)}function NN(i){return i&&i[HS]}class ste{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new U_,this.attachRef=null}}let U_=(()=>{class i{constructor(){this.contexts=new Map}onChildOutletCreated(t,n){const r=this.getOrCreateContext(t);r.outlet=n,this.contexts.set(t,r)}onChildOutletDestroyed(t){const n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new ste,this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const ay=!1;let QS=(()=>{class i{constructor(){this.activated=null,this._activatedRoute=null,this.name=mi,this.activateEvents=new Tt,this.deactivateEvents=new Tt,this.attachEvents=new Tt,this.detachEvents=new Tt,this.parentContexts=Et(U_),this.location=Et(Ir),this.changeDetector=Et(sr),this.environmentInjector=Et(xa)}ngOnChanges(t){if(t.name){const{firstChange:n,previousValue:r}=t.name;if(n)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Pe(4012,ay);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Pe(4012,ay);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Pe(4012,ay);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new Pe(4013,ay);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new ote(t,a,r.injector);if(n&&function ate(i){return!!i.resolveComponentFactory}(n)){const c=n.resolveComponentFactory(o);this.activated=r.createComponent(c,r.length,l)}else this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:n??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=Ne({type:i,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Cr]}),i})();class ote{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===Gd?this.route:e===U_?this.childContexts:this.parent.get(e,t)}}let WS=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=$({type:i,selectors:[["ng-component"]],standalone:!0,features:[TE],decls:1,vars:0,template:function(t,n){1&t&&je(0,"router-outlet")},dependencies:[QS],encapsulation:2}),i})();function jN(i,e){return i.providers&&!i._injector&&(i._injector=vA(i.providers,e,`Route: ${i.path}`)),i._injector??e}function YS(i){const e=i.children&&i.children.map(YS),t=e?{...i,children:e}:{...i};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==mi&&(t.component=WS),t}function Co(i){return i.outlet||mi}function UN(i,e){const t=i.filter(n=>Co(n)===e);return t.push(...i.filter(n=>Co(n)!==e)),t}function V_(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let e=i.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class hte{constructor(e,t,n,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),zS(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const r=gf(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],n),delete r[o]}),Dr(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=gf(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(n&&n.outlet){const o=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=gf(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(e,t,n){const r=gf(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],n),this.forwardEvent(new Zee(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Yee(e.value.snapshot))}activateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(zS(r),r===s)if(r.component){const o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(r.component){const o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),zS(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=V_(r.snapshot),l=a?.get(Jl)??null;o.attachRef=null,o.route=r,o.resolver=l,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}class VN{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class ly{constructor(e,t){this.component=e,this.route=t}}function fte(i,e,t){const n=i._root;return z_(n,e?e._root:null,t,[n.value])}function _f(i,e){const t=Symbol(),n=e.get(i,t);return n===t?"function"!=typeof i||function R6(i){return null!==Av(i)}(i)?e.get(i):i:n}function z_(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=gf(e);return i.children.forEach(o=>{(function mte(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=i.value,o=e?e.value:null,a=t?t.getContext(i.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function gte(i,e,t){if("function"==typeof t)return t(i,e);switch(t){case"pathParamsChange":return!Ud(i.url,e.url);case"pathParamsOrQueryParamsChange":return!Ud(i.url,e.url)||!Ra(i.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!GS(i,e)||!Ra(i.queryParams,e.queryParams);default:return!GS(i,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new VN(n)):(s.data=o.data,s._resolvedData=o._resolvedData),z_(i,e,s.component?a?a.children:null:t,n,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new ly(a.outlet.component,o))}else o&&G_(e,a,r),r.canActivateChecks.push(new VN(n)),z_(i,null,s.component?a?a.children:null:t,n,r)})(o,s[o.value.outlet],t,n.concat([o.value]),r),delete s[o.value.outlet]}),Dr(s,(o,a)=>G_(o,t.getContext(a),r)),r}function G_(i,e,t){const n=gf(i),r=i.value;Dr(n,(s,o)=>{G_(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new ly(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function H_(i){return"function"==typeof i}function XS(i){return i instanceof qA||"EmptyError"===i?.name}const cy=Symbol("INITIAL_VALUE");function bf(){return Ys(i=>TS(i.map(e=>e.pipe(bs(1),sc(cy)))).pipe(wt(e=>{for(const t of e)if(!0!==t){if(t===cy)return cy;if(!1===t||t instanceof jd)return t}return!0}),jn(e=>e!==cy),bs(1)))}function zN(i){return function KQ(...i){return iP(i)}(ln(e=>{if(Vd(e))throw LN(0,e)}),wt(e=>!0===e))}const ZS={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function GN(i,e,t,n,r){const s=KS(i,e,t);return s.matched?function kte(i,e,t,n){const r=e.canMatch;return r&&0!==r.length?St(r.map(o=>{const a=_f(o,i);return lc(function xte(i){return i&&H_(i.canMatch)}(a)?a.canMatch(e,t):i.runInContext(()=>a(e,t)))})).pipe(bf(),zN()):St(!0)}(n=jN(e,n),e,t).pipe(wt(o=>!0===o?s:{...ZS})):St(s)}function KS(i,e,t){if(""===e.path)return"full"===e.pathMatch&&(i.hasChildren()||t.length>0)?{...ZS}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||pee)(t,i,e);if(!r)return{...ZS};const s={};Dr(r.posParams,(a,l)=>{s[l]=a.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function dy(i,e,t,n){if(t.length>0&&function Fte(i,e,t){return t.some(n=>uy(i,e,n)&&Co(n)!==mi)}(i,t,n)){const s=new vi(e,function Lte(i,e,t,n){const r={};r[mi]=n,n._sourceSegment=i,n._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&Co(s)!==mi){const o=new vi([],{});o._sourceSegment=i,o._segmentIndexShift=e.length,r[Co(s)]=o}return r}(i,e,n,new vi(t,i.children)));return s._sourceSegment=i,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===t.length&&function Ote(i,e,t){return t.some(n=>uy(i,e,n))}(i,t,n)){const s=new vi(i.segments,function Bte(i,e,t,n,r){const s={};for(const o of n)if(uy(i,t,o)&&!r[Co(o)]){const a=new vi([],{});a._sourceSegment=i,a._segmentIndexShift=e.length,s[Co(o)]=a}return{...r,...s}}(i,e,t,n,i.children));return s._sourceSegment=i,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}const r=new vi(i.segments,i.children);return r._sourceSegment=i,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:t}}function uy(i,e,t){return(!(i.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function HN(i,e,t,n){return!!(Co(i)===n||n!==mi&&uy(e,t,i))&&("**"===i.path||KS(e,i,t).matched)}function QN(i,e,t){return 0===e.length&&!i.children[t]}const hy=!1;class fy{constructor(e){this.segmentGroup=e||null}}class WN{constructor(e){this.urlTree=e}}function Q_(i){return ia(new fy(i))}function qN(i){return ia(new WN(i))}class Vte{constructor(e,t,n,r,s){this.injector=e,this.configLoader=t,this.urlSerializer=n,this.urlTree=r,this.config=s,this.allowRedirects=!0}apply(){const e=dy(this.urlTree.root,[],[],this.config).segmentGroup,t=new vi(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,mi).pipe(wt(s=>this.createUrlTree(ry(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(na(s=>{if(s instanceof WN)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof fy?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,mi).pipe(wt(r=>this.createUrlTree(ry(r),e.queryParams,e.fragment))).pipe(na(r=>{throw r instanceof fy?this.noMatchError(r):r}))}noMatchError(e){return new Pe(4002,hy)}createUrlTree(e,t,n){const r=BS(e);return new jd(r,t,n)}expandSegmentGroup(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(wt(s=>new vi([],s))):this.expandSegment(e,n,t,n.segments,r,!0)}expandChildren(e,t,n){const r=[];for(const s of Object.keys(n.children))"primary"===s?r.unshift(s):r.push(s);return En(r).pipe(ac(s=>{const o=n.children[s],a=UN(t,s);return this.expandSegmentGroup(e,a,o,s).pipe(wt(l=>({segment:l,outlet:s})))}),aN((s,o)=>(s[o.outlet]=o.segment,s),{}),lN())}expandSegment(e,t,n,r,s,o){return En(n).pipe(ac(a=>this.expandSegmentAgainstRoute(e,t,n,a,r,s,o).pipe(na(c=>{if(c instanceof fy)return St(null);throw c}))),oc(a=>!!a),na((a,l)=>{if(XS(a))return QN(t,r,s)?St(new vi([],{})):Q_(t);throw a}))}expandSegmentAgainstRoute(e,t,n,r,s,o,a){return HN(r,t,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o):Q_(t):Q_(t)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,r){const s=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?qN(s):this.lineralizeSegments(n,s).pipe(wr(o=>{const a=new vi(o,{});return this.expandSegment(e,a,t,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:d}=KS(t,r,s);if(!a)return Q_(t);const u=this.applyRedirectCommands(l,r.redirectTo,d);return r.redirectTo.startsWith("/")?qN(u):this.lineralizeSegments(r,u).pipe(wr(h=>this.expandSegment(e,t,n,h.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,n,r,s){return"**"===n.path?(e=jN(n,e),n.loadChildren?(n._loadedRoutes?St({routes:n._loadedRoutes,injector:n._loadedInjector}):this.configLoader.loadChildren(e,n)).pipe(wt(a=>(n._loadedRoutes=a.routes,n._loadedInjector=a.injector,new vi(r,{})))):St(new vi(r,{}))):GN(t,n,r,e).pipe(Ys(({matched:o,consumedSegments:a,remainingSegments:l})=>o?this.getChildConfig(e=n._injector??e,n,r).pipe(wr(d=>{const u=d.injector??e,h=d.routes,{segmentGroup:f,slicedSegments:m}=dy(t,a,l,h),_=new vi(f.segments,f.children);if(0===m.length&&_.hasChildren())return this.expandChildren(u,h,_).pipe(wt(b=>new vi(a,b)));if(0===h.length&&0===m.length)return St(new vi(a,{}));const g=Co(n)===s;return this.expandSegment(u,_,h,m,g?mi:s,!0).pipe(wt(v=>new vi(a.concat(v.segments),v.children)))})):Q_(t)))}getChildConfig(e,t,n){return t.children?St({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?St({routes:t._loadedRoutes,injector:t._loadedInjector}):function Pte(i,e,t,n){const r=e.canLoad;return void 0===r||0===r.length?St(!0):St(r.map(o=>{const a=_f(o,i);return lc(function bte(i){return i&&H_(i.canLoad)}(a)?a.canLoad(e,t):i.runInContext(()=>a(e,t)))})).pipe(bf(),zN())}(e,t,n).pipe(wr(r=>r?this.configLoader.loadChildren(e,t).pipe(ln(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function jte(i){return ia(FN(hy,3))}())):St({routes:[],injector:e})}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return St(n);if(r.numberOfChildren>1||!r.children[mi])return ia(new Pe(4e3,hy));r=r.children[mi]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreateUrlTree(e,t,n,r){const s=this.createSegmentGroup(e,t.root,n,r);return new jd(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return Dr(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);n[s]=t[a]}else n[s]=r}),n}createSegmentGroup(e,t,n,r){const s=this.createSegments(e,t.segments,n,r);let o={};return Dr(t.children,(a,l)=>{o[l]=this.createSegmentGroup(e,a,n,r)}),new vi(s,o)}createSegments(e,t,n,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,n))}findPosParam(e,t,n){const r=n[t.path.substring(1)];if(!r)throw new Pe(4001,hy);return r}findOrReturn(e,t){let n=0;for(const r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}}class Gte{}class Wte{constructor(e,t,n,r,s,o,a){this.injector=e,this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a}recognize(){const e=dy(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,mi).pipe(wt(t=>{if(null===t)return null;const n=new oy([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},mi,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new xl(n,t),s=new kN(this.url,r);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(e){const t=e.value,n=PN(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.processChildren(e,t,n):this.processSegment(e,t,n,n.segments,r)}processChildren(e,t,n){return En(Object.keys(n.children)).pipe(ac(r=>{const s=n.children[r],o=UN(t,r);return this.processSegmentGroup(e,o,s,r)}),aN((r,s)=>r&&s?(r.push(...s),r):null),function hee(i,e=!1){return Mn((t,n)=>{let r=0;t.subscribe(hn(n,s=>{const o=i(s,r++);(o||e)&&n.next(s),!o&&n.complete()}))})}(r=>null!==r),ZA(null),lN(),wt(r=>{if(null===r)return null;const s=XN(r);return function qte(i){i.sort((e,t)=>e.value.outlet===mi?-1:t.value.outlet===mi?1:e.value.outlet.localeCompare(t.value.outlet))}(s),s}))}processSegment(e,t,n,r,s){return En(t).pipe(ac(o=>this.processSegmentAgainstRoute(o._injector??e,o,n,r,s)),oc(o=>!!o),na(o=>{if(XS(o))return QN(n,r,s)?St([]):St(null);throw o}))}processSegmentAgainstRoute(e,t,n,r,s){if(t.redirectTo||!HN(t,n,r,s))return St(null);let o;if("**"===t.path){const a=r.length>0?uN(r).parameters:{},l=KN(n)+r.length;o=St({snapshot:new oy(r,a,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,$N(t),Co(t),t.component??t._loadedComponent??null,t,ZN(n),l,JN(t)),consumedSegments:[],remainingSegments:[]})}else o=GN(n,t,r,e).pipe(wt(({matched:a,consumedSegments:l,remainingSegments:c,parameters:d})=>{if(!a)return null;const u=KN(n)+l.length;return{snapshot:new oy(l,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,$N(t),Co(t),t.component??t._loadedComponent??null,t,ZN(n),u,JN(t)),consumedSegments:l,remainingSegments:c}}));return o.pipe(Ys(a=>{if(null===a)return St(null);const{snapshot:l,consumedSegments:c,remainingSegments:d}=a;e=t._injector??e;const u=t._loadedInjector??e,h=function Yte(i){return i.children?i.children:i.loadChildren?i._loadedRoutes:[]}(t),{segmentGroup:f,slicedSegments:m}=dy(n,c,d,h.filter(g=>void 0===g.redirectTo));if(0===m.length&&f.hasChildren())return this.processChildren(u,h,f).pipe(wt(g=>null===g?null:[new xl(l,g)]));if(0===h.length&&0===m.length)return St([new xl(l,[])]);const _=Co(t)===s;return this.processSegment(u,h,f,m,_?mi:s).pipe(wt(g=>null===g?null:[new xl(l,g)]))}))}}function Xte(i){const e=i.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function XN(i){const e=[],t=new Set;for(const n of i){if(!Xte(n)){e.push(n);continue}const r=e.find(s=>n.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...n.children),t.add(r)):e.push(n)}for(const n of t){const r=XN(n.children);e.push(new xl(n.value,r))}return e.filter(n=>!t.has(n))}function ZN(i){let e=i;for(;e._sourceSegment;)e=e._sourceSegment;return e}function KN(i){let e=i,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function $N(i){return i.data||{}}function JN(i){return i.resolve||{}}function ej(i){return"string"==typeof i.title||null===i.title}function $S(i){return Ys(e=>{const t=i(e);return t?En(t).pipe(wt(()=>e)):St(e)})}const vf=new Oe("ROUTES");let JS=(()=>{class i{constructor(t,n){this.injector=t,this.compiler=n,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return St(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const n=lc(t.loadComponent()).pipe(wt(ij),ln(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),KA(()=>{this.componentLoaders.delete(t)})),r=new RS(n,()=>new Wt).pipe(XA());return this.componentLoaders.set(t,r),r}loadChildren(t,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return St({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);const s=this.loadModuleFactoryOrRoutes(n.loadChildren).pipe(wt(a=>{this.onLoadEndListener&&this.onLoadEndListener(n);let l,c,d=!1;Array.isArray(a)?c=a:(l=a.create(t).injector,c=dN(l.get(vf,[],Vt.Self|Vt.Optional)));return{routes:c.map(YS),injector:l}}),KA(()=>{this.childrenLoaders.delete(n)})),o=new RS(s,()=>new Wt).pipe(XA());return this.childrenLoaders.set(n,o),o}loadModuleFactoryOrRoutes(t){return lc(t()).pipe(wt(ij),wr(r=>r instanceof jF||Array.isArray(r)?St(r):En(this.compiler.compileModuleAsync(r))))}}return i.\u0275fac=function(t){return new(t||i)(xe(zr),xe(TO))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function ij(i){return function rie(i){return i&&"object"==typeof i&&"default"in i}(i)?i.default:i}let my=(()=>{class i{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Wt,this.configLoader=Et(JS),this.environmentInjector=Et(xa),this.urlSerializer=Et(k_),this.rootContexts=Et(U_),this.navigationId=0,this.afterPreactivation=()=>St(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new Wee(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new Qee(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const n=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:n})}setupNavigations(t){return this.transitions=new qs({id:0,targetPageId:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:N_,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(jn(n=>0!==n.id),wt(n=>({...n,extractedUrl:t.urlHandlingStrategy.extract(n.rawUrl)})),Ys(n=>{let r=!1,s=!1;return St(n).pipe(ln(o=>{this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Ys(o=>{const a=t.browserUrlTree.toString(),l=!t.navigated||o.extractedUrl.toString()!==a||a!==t.currentUrlTree.toString();if(!l&&"reload"!==(o.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const d="";return this.events.next(new EN(o.id,t.serializeUrl(n.rawUrl),d,0)),t.rawUrlTree=o.rawUrl,o.resolve(null),Or}if(t.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return nj(o.source)&&(t.browserUrlTree=o.extractedUrl),St(o).pipe(Ys(d=>{const u=this.transitions?.getValue();return this.events.next(new NS(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),u!==this.transitions?.getValue()?Or:Promise.resolve(d)}),function zte(i,e,t,n){return Ys(r=>function Ute(i,e,t,n,r){return new Vte(i,e,t,n,r).apply()}(i,e,t,r.extractedUrl,n).pipe(wt(s=>({...r,urlAfterRedirects:s}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,t.config),ln(d=>{this.currentNavigation={...this.currentNavigation,finalUrl:d.urlAfterRedirects},n.urlAfterRedirects=d.urlAfterRedirects}),function Kte(i,e,t,n,r){return wr(s=>function Qte(i,e,t,n,r,s,o="emptyOnly"){return new Wte(i,e,t,n,r,o,s).recognize().pipe(Ys(a=>null===a?function Hte(i){return new Oi(e=>e.error(i))}(new Gte):St(a)))}(i,e,t,s.urlAfterRedirects,n.serialize(s.urlAfterRedirects),n,r).pipe(wt(o=>({...s,targetSnapshot:o}))))}(this.environmentInjector,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),ln(d=>{if(n.targetSnapshot=d.targetSnapshot,"eager"===t.urlUpdateStrategy){if(!d.extras.skipLocationChange){const h=t.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl);t.setBrowserUrl(h,d)}t.browserUrlTree=d.urlAfterRedirects}const u=new Uee(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(u)}));if(l&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:d,extractedUrl:u,source:h,restoredState:f,extras:m}=o,_=new NS(d,this.urlSerializer.serialize(u),h,f);this.events.next(_);const g=DN(u,this.rootComponentType).snapshot;return St(n={...o,targetSnapshot:g,urlAfterRedirects:u,extras:{...m,skipLocationChange:!1,replaceUrl:!1}})}{const d="";return this.events.next(new EN(o.id,t.serializeUrl(n.extractedUrl),d,1)),t.rawUrlTree=o.rawUrl,o.resolve(null),Or}}),ln(o=>{const a=new Vee(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),wt(o=>n={...o,guards:fte(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),function Cte(i,e){return wr(t=>{const{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?St({...t,guardsResult:!0}):function Mte(i,e,t,n){return En(i).pipe(wr(r=>function Dte(i,e,t,n,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?St(s.map(a=>{const l=V_(e)??r,c=_f(a,l);return lc(function yte(i){return i&&H_(i.canDeactivate)}(c)?c.canDeactivate(i,e,t,n):l.runInContext(()=>c(i,e,t,n))).pipe(oc())})).pipe(bf()):St(!0)}(r.component,r.route,t,e,n)),oc(r=>!0!==r,!0))}(o,n,r,i).pipe(wr(a=>a&&function _te(i){return"boolean"==typeof i}(a)?function Ete(i,e,t,n){return En(e).pipe(ac(r=>YA(function Tte(i,e){return null!==i&&e&&e(new qee(i)),St(!0)}(r.route.parent,n),function Ste(i,e){return null!==i&&e&&e(new Xee(i)),St(!0)}(r.route,n),function Ite(i,e,t){const n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function pte(i){const e=i.routeConfig?i.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:i,guards:e}:null}(o)).filter(o=>null!==o).map(o=>sN(()=>St(o.guards.map(l=>{const c=V_(o.node)??t,d=_f(l,c);return lc(function Ate(i){return i&&H_(i.canActivateChild)}(d)?d.canActivateChild(n,i):c.runInContext(()=>d(n,i))).pipe(oc())})).pipe(bf())));return St(s).pipe(bf())}(i,r.path,t),function Rte(i,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return St(!0);const r=n.map(s=>sN(()=>{const o=V_(e)??t,a=_f(s,o);return lc(function vte(i){return i&&H_(i.canActivate)}(a)?a.canActivate(e,i):o.runInContext(()=>a(e,i))).pipe(oc())}));return St(r).pipe(bf())}(i,r.route,t))),oc(r=>!0!==r,!0))}(n,s,i,e):St(a)),wt(a=>({...t,guardsResult:a})))})}(this.environmentInjector,o=>this.events.next(o)),ln(o=>{if(n.guardsResult=o.guardsResult,Vd(o.guardsResult))throw LN(0,o.guardsResult);const a=new zee(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),jn(o=>!!o.guardsResult||(t.restoreHistory(o),this.cancelNavigationTransition(o,"",3),!1)),$S(o=>{if(o.guards.canActivateChecks.length)return St(o).pipe(ln(a=>{const l=new Gee(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}),Ys(a=>{let l=!1;return St(a).pipe(function $te(i,e){return wr(t=>{const{targetSnapshot:n,guards:{canActivateChecks:r}}=t;if(!r.length)return St(t);let s=0;return En(r).pipe(ac(o=>function Jte(i,e,t,n){const r=i.routeConfig,s=i._resolve;return void 0!==r?.title&&!ej(r)&&(s[D_]=r.title),function eie(i,e,t,n){const r=function tie(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}(i);if(0===r.length)return St({});const s={};return En(r).pipe(wr(o=>function iie(i,e,t,n){const r=V_(e)??n,s=_f(i,r);return lc(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(i[o],e,t,n).pipe(oc(),ln(a=>{s[o]=a}))),IS(1),DS(s),na(o=>XS(o)?Or:ia(o)))}(s,i,e,n).pipe(wt(o=>(i._resolvedData=o,i.data=PN(i,t).resolve,r&&ej(r)&&(i.data[D_]=r.title),null)))}(o.route,n,i,e)),ln(()=>s++),IS(1),wr(o=>s===r.length?St(t):Or))})}(t.paramsInheritanceStrategy,this.environmentInjector),ln({next:()=>l=!0,complete:()=>{l||(t.restoreHistory(a),this.cancelNavigationTransition(a,"",2))}}))}),ln(a=>{const l=new Hee(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}))}),$S(o=>{const a=l=>{const c=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&c.push(this.configLoader.loadComponent(l.routeConfig).pipe(ln(d=>{l.component=d}),wt(()=>{})));for(const d of l.children)c.push(...a(d));return c};return TS(a(o.targetSnapshot.root)).pipe(ZA(),bs(1))}),$S(()=>this.afterPreactivation()),wt(o=>{const a=function ite(i,e,t){const n=j_(i,e._root,t?t._root:void 0);return new IN(n,e)}(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return n={...o,targetRouterState:a}}),ln(o=>{t.currentUrlTree=o.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(o.urlAfterRedirects,o.rawUrl),t.routerState=o.targetRouterState,"deferred"===t.urlUpdateStrategy&&(o.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,o),t.browserUrlTree=o.urlAfterRedirects)}),((i,e,t)=>wt(n=>(new hte(e,n.targetRouterState,n.currentRouterState,t).activate(i),n)))(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o)),ln({next:o=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new zd(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{r=!0}}),KA(()=>{r||s||this.cancelNavigationTransition(n,"",1),this.currentNavigation?.id===n.id&&(this.currentNavigation=null)}),na(o=>{if(s=!0,NN(o)){ON(o)||(t.navigated=!0,t.restoreHistory(n,!0));const a=new sy(n.id,this.urlSerializer.serialize(n.extractedUrl),o.message,o.cancellationCode);if(this.events.next(a),ON(o)){const l=t.urlHandlingStrategy.merge(o.url,t.rawUrlTree),c={skipLocationChange:n.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||nj(n.source)};t.scheduleNavigation(l,N_,null,c,{resolve:n.resolve,reject:n.reject,promise:n.promise})}else n.resolve(!1)}else{t.restoreHistory(n,!0);const a=new SN(n.id,this.urlSerializer.serialize(n.extractedUrl),o,n.targetSnapshot??void 0);this.events.next(a);try{n.resolve(t.errorHandler(o))}catch(l){n.reject(l)}}return Or}))}))}cancelNavigationTransition(t,n,r){const s=new sy(t.id,this.urlSerializer.serialize(t.extractedUrl),n,r);this.events.next(s),t.resolve(!1)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function nj(i){return i!==N_}let rj=(()=>{class i{buildTitle(t){let n,r=t.root;for(;void 0!==r;)n=this.getResolvedTitleForRoute(r)??n,r=r.children.find(s=>s.outlet===mi);return n}getResolvedTitleForRoute(t){return t.data[D_]}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:function(){return Et(sie)},providedIn:"root"}),i})(),sie=(()=>{class i extends rj{constructor(t){super(),this.title=t}updateTitle(t){const n=this.buildTitle(t);void 0!==n&&this.title.setTitle(n)}}return i.\u0275fac=function(t){return new(t||i)(xe($3))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),oie=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:function(){return Et(lie)},providedIn:"root"}),i})();class aie{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let lie=(()=>{class i extends aie{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=le(i)))(n||i)}}(),i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const gy=new Oe("",{providedIn:"root",factory:()=>({})});let die=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:function(){return Et(uie)},providedIn:"root"}),i})(),uie=(()=>{class i{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function hie(i){throw i}function fie(i,e,t){return e.parse("/")}const pie={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},mie={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Xs=(()=>{class i{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=Et(WZ),this.isNgZoneEnabled=!1,this.options=Et(gy,{optional:!0})||{},this.errorHandler=this.options.errorHandler||hie,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||fie,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=Et(die),this.routeReuseStrategy=Et(oie),this.urlCreationStrategy=Et(Jee),this.titleStrategy=Et(rj),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=dN(Et(vf,{optional:!0})??[]),this.navigationTransitions=Et(my),this.urlSerializer=Et(k_),this.location=Et(IA),this.isNgZoneEnabled=Et(gt)instanceof gt&&gt.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new jd,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=DN(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),N_,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const n="popstate"===t.type?"popstate":"hashchange";"popstate"===n&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,n,t.state)},0)}))}navigateToSyncWithBrowser(t,n,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const l={...r};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t);this.scheduleNavigation(a,n,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(t){this.config=t.map(YS),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,n={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=n,c=l?this.currentUrlTree.fragment:o;let d=null;switch(a){case"merge":d={...this.currentUrlTree.queryParams,...s};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}return null!==d&&(d=this.removeEmptyProps(d)),this.urlCreationStrategy.createUrlTree(r,this.routerState,this.currentUrlTree,t,d,c??null)}navigateByUrl(t,n={skipLocationChange:!1}){const r=Vd(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,N_,null,n)}navigate(t,n={skipLocationChange:!1}){return function gie(i){for(let e=0;e<i.length;e++){if(null==i[e])throw new Pe(4008,!1)}}(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let n;try{n=this.urlSerializer.parse(t)}catch(r){n=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return n}isActive(t,n){let r;if(r=!0===n?{...pie}:!1===n?{...mie}:n,Vd(t))return fN(this.currentUrlTree,t,r);const s=this.parseUrl(t);return fN(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((n,r)=>{const s=t[r];return null!=s&&(n[r]=s),n},{})}scheduleNavigation(t,n,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c,d;return o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((u,h)=>{a=u,l=h}),d="computed"===this.canceledNavigationResolution?r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:d,source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(u=>Promise.reject(u))}setBrowserUrl(t,n){const r=this.urlSerializer.serialize(t),s={...n.extras.state,...this.generateNgRouterState(n.id,n.targetPageId)};this.location.isCurrentPathEqualTo(r)||n.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,n=!1){if("computed"===this.canceledNavigationResolution){const r=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===r?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===r&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(r)}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,n){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),_y=(()=>{class i{constructor(t,n,r,s,o,a){this.router=t,this.route=n,this.tabIndexAttribute=r,this.renderer=s,this.el=o,this.locationStrategy=a,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new Wt;const l=o.nativeElement.tagName;this.isAnchorElement="A"===l||"AREA"===l,this.isAnchorElement?this.subscription=t.events.subscribe(c=>{c instanceof zd&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(t){this._preserveFragment=hf(t)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(t){this._skipLocationChange=hf(t)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(t){this._replaceUrl=hf(t)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,n,r,s,o){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||n||r||s||o||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:function gB(i,e,t){return function s9(i,e){return"src"===e&&("embed"===i||"frame"===i||"iframe"===i||"media"===i||"script"===i)||"href"===e&&("base"===i||"link"===i)?mB:pB}(e,t)(i)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,n){const r=this.renderer,s=this.el.nativeElement;null!==n?r.setAttribute(s,t,n):r.removeAttribute(s,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return i.\u0275fac=function(t){return new(t||i)(I(Xs),I(Gd),Yg("tabindex"),I(pl),I(Ft),I(Nd))},i.\u0275dir=Ne({type:i,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(t,n){1&t&&ut("click",function(s){return n.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&t&&pn("target",n.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[Cr]}),i})();class oj{}let vie=(()=>{class i{constructor(t,n,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(jn(t=>t instanceof zd),ac(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,n){const r=[];for(const s of n){s.providers&&!s._injector&&(s._injector=vA(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent?r.push(this.preloadConfig(o,s)):(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return En(r).pipe(Ch())}preloadConfig(t,n){return this.preloadingStrategy.preload(n,()=>{let r;r=n.loadChildren&&void 0===n.canLoad?this.loader.loadChildren(t,n):St(null);const s=r.pipe(wr(o=>null===o?St(void 0):(n._loadedRoutes=o.routes,n._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return n.loadComponent&&!n._loadedComponent?En([s,this.loader.loadComponent(n)]).pipe(Ch()):s})}}return i.\u0275fac=function(t){return new(t||i)(xe(Xs),xe(TO),xe(xa),xe(oj),xe(JS))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const eT=new Oe("");let aj=(()=>{class i{constructor(t,n,r,s,o={}){this.urlSerializer=t,this.transitions=n,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof NS?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof zd&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof TN&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,n){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new TN(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return i.\u0275fac=function(t){o_()},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})();function Hd(i,e){return{\u0275kind:i,\u0275providers:e}}function cj(){const i=Et(zr);return e=>{const t=i.get(uf);if(e!==t.components[0])return;const n=i.get(Xs),r=i.get(dj);1===i.get(iT)&&n.initialNavigation(),i.get(uj,null,Vt.Optional)?.setUpPreloading(),i.get(eT,null,Vt.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.unsubscribe())}}const dj=new Oe("",{factory:()=>new Wt}),iT=new Oe("",{providedIn:"root",factory:()=>1});const uj=new Oe("");function Cie(i){return Hd(0,[{provide:uj,useExisting:vie},{provide:oj,useExisting:i}])}const hj=new Oe("ROUTER_FORROOT_GUARD"),Mie=[IA,{provide:k_,useClass:PS},Xs,U_,{provide:Gd,useFactory:function lj(i){return i.routerState.root},deps:[Xs]},JS,[]];function Eie(){return new LO("Router",Xs)}let fj=(()=>{class i{constructor(t){}static forRoot(t,n){return{ngModule:i,providers:[Mie,[],{provide:vf,multi:!0,useValue:t},{provide:hj,useFactory:Iie,deps:[[Xs,new hl,new Uh]]},{provide:gy,useValue:n||{}},n?.useHash?{provide:Nd,useClass:BK}:{provide:Nd,useClass:s3},{provide:eT,useFactory:()=>{const i=Et(X$),e=Et(gt),t=Et(gy),n=Et(my),r=Et(k_);return t.scrollOffset&&i.setOffset(t.scrollOffset),new aj(r,n,i,e,t)}},n?.preloadingStrategy?Cie(n.preloadingStrategy).\u0275providers:[],{provide:LO,multi:!0,useFactory:Eie},n?.initialNavigation?Die(n):[],[{provide:pj,useFactory:cj},{provide:SO,multi:!0,useExisting:pj}]]}}static forChild(t){return{ngModule:i,providers:[{provide:vf,multi:!0,useValue:t}]}}}return i.\u0275fac=function(t){return new(t||i)(xe(hj,8))},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[WS]}),i})();function Iie(i){return"guarded"}function Die(i){return["disabled"===i.initialNavigation?Hd(3,[{provide:wA,multi:!0,useFactory:()=>{const e=Et(Xs);return()=>{e.setUpLocationChangeListener()}}},{provide:iT,useValue:2}]).\u0275providers:[],"enabledBlocking"===i.initialNavigation?Hd(2,[{provide:iT,useValue:0},{provide:wA,multi:!0,deps:[zr],useFactory:e=>{const t=e.get(PK,Promise.resolve());return()=>t.then(()=>new Promise(r=>{const s=e.get(Xs),o=e.get(dj);(function n(r){e.get(Xs).events.pipe(jn(o=>o instanceof zd||o instanceof sy||o instanceof SN),wt(o=>o instanceof zd||o instanceof sy&&(0===o.code||1===o.code)&&null),jn(o=>null!==o),bs(1)).subscribe(()=>{r()})})(()=>{r(!0)}),e.get(my).afterPreactivation=()=>(r(!0),o.closed?St(void 0):o),s.initialNavigation()}))}}]).\u0275providers:[]]}const pj=new Oe("");function mj(i,e,t,n,r,s,o){try{var a=i[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(n,r)}function ss(i){return function(){var e=this,t=arguments;return new Promise(function(n,r){var s=i.apply(e,t);function o(l){mj(s,n,r,o,a,"next",l)}function a(l){mj(s,n,r,o,a,"throw",l)}o(void 0)})}}const by="151",Zs={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},wl={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},gj=0,nT=1,_j=2,kie=3,Bie=0,rT=1,bj=2,yf=3,Da=0,Hr=1,os=2,Lie=2,Kt=0,Pa=1,xf=2,sT=3,oT=4,wf=5,ws=100,vj=101,Aj=102,aT=103,lT=104,Cf=200,q_=201,yj=202,xj=203,Mf=204,Y_=205,vy=206,wj=207,Ay=208,Cj=209,Mj=210,Ej=0,Sj=1,Tj=2,yy=3,Rj=4,Ij=5,Dj=6,Pj=7,X_=0,kj=1,Bj=2,ka=0,Lj=1,Fj=2,Oj=3,Nj=4,jj=5,xy=300,cc=301,dc=302,Ef=303,Z_=304,Sf=306,Mo=1e3,_r=1001,Tf=1002,$t=1003,K_=1004,Fie=1004,Rf=1005,Oie=1005,Ui=1006,wy=1007,Nie=1007,Ks=1008,jie=1008,Qr=1009,Uj=1010,Vj=1011,$_=1012,zj=1013,uc=1014,Un=1015,mn=1016,Gj=1017,Hj=1018,hc=1020,Qj=1021,Rn=1023,Cy=1024,Wj=1025,fc=1026,pc=1027,Cl=1028,qj=1029,If=1030,Yj=1031,Xj=1033,Df=33776,My=33777,J_=33778,Pf=33779,kf=35840,eb=35841,Bf=35842,tb=35843,Ey=36196,Sy=37492,Ty=37496,Ry=37808,cT=37809,dT=37810,uT=37811,hT=37812,fT=37813,pT=37814,mT=37815,gT=37816,_T=37817,bT=37818,vT=37819,AT=37820,yT=37821,ib=36492,Zj=36283,xT=36284,wT=36285,CT=36286,MT=2200,Kj=2201,$j=2202,Lf=2300,Qd=2301,Iy=2302,Wd=2400,qd=2401,nb=2402,Dy=2500,ET=2501,Jj=0,ST=1,Py=2,$s=3e3,ui=3001,eU=3200,rb=3201,mc=0,tU=1,Uie="",Js="srgb",Yd="srgb-linear",TT="display-p3",Vie=0,ky=7680,zie=7681,Gie=7682,Hie=7683,Qie=34055,Wie=34056,qie=5386,Yie=512,Xie=513,Zie=514,Kie=515,$ie=516,Jie=517,ene=518,iU=519,sb=35044,By=35048,tne=35040,ine=35045,nne=35049,rne=35041,sne=35046,one=35050,ane=35042,lne="100",RT="300 es",Ly=1035;class as{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const n=this._listeners[e.type];if(void 0!==n){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Wr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let nU=1234567;const Xd=Math.PI/180,Ff=180/Math.PI;function eo(){const i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Wr[255&i]+Wr[i>>8&255]+Wr[i>>16&255]+Wr[i>>24&255]+"-"+Wr[255&e]+Wr[e>>8&255]+"-"+Wr[e>>16&15|64]+Wr[e>>24&255]+"-"+Wr[63&t|128]+Wr[t>>8&255]+"-"+Wr[t>>16&255]+Wr[t>>24&255]+Wr[255&n]+Wr[n>>8&255]+Wr[n>>16&255]+Wr[n>>24&255]).toLowerCase()}function Vn(i,e,t){return Math.max(e,Math.min(t,i))}function IT(i,e){return(i%e+e)%e}function ob(i,e,t){return(1-t)*i+t*e}function DT(i){return 0==(i&i-1)&&0!==i}function rU(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function sU(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function to(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function hi(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return Math.round(65535*i);case Uint8Array:return Math.round(255*i);case Int16Array:return Math.round(32767*i);case Int8Array:return Math.round(127*i);default:throw new Error("Invalid component type.")}}const ft={DEG2RAD:Xd,RAD2DEG:Ff,generateUUID:eo,clamp:Vn,euclideanModulo:IT,mapLinear:function cne(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)},inverseLerp:function dne(i,e,t){return i!==e?(t-i)/(e-i):0},lerp:ob,damp:function une(i,e,t,n){return ob(i,e,1-Math.exp(-t*n))},pingpong:function hne(i,e=1){return e-Math.abs(IT(i,2*e)-e)},smoothstep:function fne(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e))*i*(3-2*i)},smootherstep:function pne(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e))*i*i*(i*(6*i-15)+10)},randInt:function mne(i,e){return i+Math.floor(Math.random()*(e-i+1))},randFloat:function gne(i,e){return i+Math.random()*(e-i)},randFloatSpread:function _ne(i){return i*(.5-Math.random())},seededRandom:function bne(i){void 0!==i&&(nU=i);let e=nU+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function vne(i){return i*Xd},radToDeg:function Ane(i){return i*Ff},isPowerOfTwo:DT,ceilPowerOfTwo:rU,floorPowerOfTwo:sU,setQuaternionFromProperEuler:function yne(i,e,t,n,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+n)/2),d=o((e+n)/2),u=s((e-n)/2),h=o((e-n)/2),f=s((n-e)/2),m=o((n-e)/2);switch(r){case"XYX":i.set(a*d,l*u,l*h,a*c);break;case"YZY":i.set(l*h,a*d,l*u,a*c);break;case"ZXZ":i.set(l*u,l*h,a*d,a*c);break;case"XZX":i.set(a*d,l*m,l*f,a*c);break;case"YXY":i.set(l*f,a*d,l*m,a*c);break;case"ZYZ":i.set(l*m,l*f,a*d,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:hi,denormalize:to};class fe{constructor(e=0,t=0){fe.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Vn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ai{constructor(){Ai.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,n,r,s,o,a,l,c){const d=this.elements;return d[0]=e,d[1]=r,d[2]=a,d[3]=t,d[4]=s,d[5]=l,d[6]=n,d[7]=o,d[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[3],l=n[6],c=n[1],d=n[4],u=n[7],h=n[2],f=n[5],m=n[8],_=r[0],g=r[3],p=r[6],v=r[1],b=r[4],y=r[7],x=r[2],w=r[5],E=r[8];return s[0]=o*_+a*v+l*x,s[3]=o*g+a*b+l*w,s[6]=o*p+a*y+l*E,s[1]=c*_+d*v+u*x,s[4]=c*g+d*b+u*w,s[7]=c*p+d*y+u*E,s[2]=h*_+f*v+m*x,s[5]=h*g+f*b+m*w,s[8]=h*p+f*y+m*E,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8];return t*o*d-t*a*c-n*s*d+n*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],u=d*o-a*c,h=a*l-d*s,f=c*s-o*l,m=t*u+n*h+r*f;if(0===m)return this.set(0,0,0,0,0,0,0,0,0);const _=1/m;return e[0]=u*_,e[1]=(r*c-d*n)*_,e[2]=(a*n-r*o)*_,e[3]=h*_,e[4]=(d*t-r*l)*_,e[5]=(r*s-a*t)*_,e[6]=f*_,e[7]=(n*l-c*t)*_,e[8]=(o*t-n*s)*_,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(PT.makeScale(e,t)),this}rotate(e){return this.premultiply(PT.makeRotation(-e)),this}translate(e,t){return this.premultiply(PT.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const PT=new Ai;function oU(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const xne={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Of(i,e){return new xne[i](e)}function ab(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function Nf(i){return i<.04045?.0773993808*i:Math.pow(.9478672986*i+.0521327014,2.4)}function kT(i){return i<.0031308?12.92*i:1.055*Math.pow(i,.41666)-.055}const wne=(new Ai).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),Cne=(new Ai).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),Sne={[Yd]:i=>i,[Js]:i=>i.convertSRGBToLinear(),[TT]:function Mne(i){return i.convertSRGBToLinear().applyMatrix3(Cne)}},Tne={[Yd]:i=>i,[Js]:i=>i.convertLinearToSRGB(),[TT]:function Ene(i){return i.applyMatrix3(wne).convertLinearToSRGB()}},Cs={enabled:!1,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(i){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!i},get workingColorSpace(){return Yd},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,e,t){if(!1===this.enabled||e===t||!e||!t)return i;const n=Sne[e],r=Tne[t];if(void 0===n||void 0===r)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return r(n(i))},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)}};let jf;class BT{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===jf&&(jf=ab("canvas")),jf.width=e.width,jf.height=e.height;const n=jf.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=jf}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=ab("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*Nf(s[o]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t[n]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Nf(t[n]/255)):Nf(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Zd{constructor(e=null){this.isSource=!0,this.uuid=eo(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(LT(r[o].isDataTexture?r[o].image:r[o]))}else s=LT(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function LT(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?BT.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Rne=0,An=(()=>{class i extends as{constructor(t=i.DEFAULT_IMAGE,n=i.DEFAULT_MAPPING,r=_r,s=_r,o=Ui,a=Ks,l=Rn,c=Qr,d=i.DEFAULT_ANISOTROPY,u=$s){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Rne++}),this.uuid=eo(),this.name="",this.source=new Zd(t),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=d,this.format=l,this.internalFormat=null,this.type=c,this.offset=new fe(0,0),this.repeat=new fe(1,1),this.center=new fe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ai,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=u,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const n=void 0===t||"string"==typeof t;if(!n&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==xy)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Mo:t.x=t.x-Math.floor(t.x);break;case _r:t.x=t.x<0?0:1;break;case Tf:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Mo:t.y=t.y-Math.floor(t.y);break;case _r:t.y=t.y<0?0:1;break;case Tf:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return i.DEFAULT_IMAGE=null,i.DEFAULT_MAPPING=xy,i.DEFAULT_ANISOTROPY=1,i})();class ii{constructor(e=0,t=0,n=0,r=1){ii.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const l=e.elements,c=l[0],d=l[4],u=l[8],h=l[1],f=l[5],m=l[9],_=l[2],g=l[6],p=l[10];if(Math.abs(d-h)<.01&&Math.abs(u-_)<.01&&Math.abs(m-g)<.01){if(Math.abs(d+h)<.1&&Math.abs(u+_)<.1&&Math.abs(m+g)<.1&&Math.abs(c+f+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const b=(c+1)/2,y=(f+1)/2,x=(p+1)/2,w=(d+h)/4,E=(u+_)/4,S=(m+g)/4;return b>y&&b>x?b<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(b),r=w/n,s=E/n):y>x?y<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(y),n=w/r,s=S/r):x<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(x),n=E/s,r=S/s),this.set(n,r,s,t),this}let v=Math.sqrt((g-m)*(g-m)+(u-_)*(u-_)+(h-d)*(h-d));return Math.abs(v)<.001&&(v=1),this.x=(g-m)/v,this.y=(u-_)/v,this.z=(h-d)/v,this.w=Math.acos((c+f+p-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Gt extends as{constructor(e=1,t=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new ii(0,0,e,t),this.scissorTest=!1,this.viewport=new ii(0,0,e,t),this.texture=new An({width:e,height:t,depth:1},n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Ui,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Zd(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class lb extends An{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=$t,this.minFilter=$t,this.wrapR=_r,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Ine extends Gt{constructor(e=1,t=1,n=1){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new lb(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class cb extends An{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=$t,this.minFilter=$t,this.wrapR=_r,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Dne extends Gt{constructor(e=1,t=1,n=1){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new cb(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Pne extends Gt{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<n;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class xi{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,o,a){let l=n[r+0],c=n[r+1],d=n[r+2],u=n[r+3];const h=s[o+0],f=s[o+1],m=s[o+2],_=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=d,void(e[t+3]=u);if(1===a)return e[t+0]=h,e[t+1]=f,e[t+2]=m,void(e[t+3]=_);if(u!==_||l!==h||c!==f||d!==m){let g=1-a;const p=l*h+c*f+d*m+u*_,v=p>=0?1:-1,b=1-p*p;if(b>Number.EPSILON){const x=Math.sqrt(b),w=Math.atan2(x,p*v);g=Math.sin(g*w)/x,a=Math.sin(a*w)/x}const y=a*v;if(l=l*g+h*y,c=c*g+f*y,d=d*g+m*y,u=u*g+_*y,g===1-a){const x=1/Math.sqrt(l*l+c*c+d*d+u*u);l*=x,c*=x,d*=x,u*=x}}e[t]=l,e[t+1]=c,e[t+2]=d,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,r,s,o){const a=n[r],l=n[r+1],c=n[r+2],d=n[r+3],u=s[o],h=s[o+1],f=s[o+2],m=s[o+3];return e[t]=a*m+d*u+l*f-c*h,e[t+1]=l*m+d*h+c*u-a*f,e[t+2]=c*m+d*f+a*h-l*u,e[t+3]=d*m-a*u-l*h-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(n/2),d=a(r/2),u=a(s/2),h=l(n/2),f=l(r/2),m=l(s/2);switch(o){case"XYZ":this._x=h*d*u+c*f*m,this._y=c*f*u-h*d*m,this._z=c*d*m+h*f*u,this._w=c*d*u-h*f*m;break;case"YXZ":this._x=h*d*u+c*f*m,this._y=c*f*u-h*d*m,this._z=c*d*m-h*f*u,this._w=c*d*u+h*f*m;break;case"ZXY":this._x=h*d*u-c*f*m,this._y=c*f*u+h*d*m,this._z=c*d*m+h*f*u,this._w=c*d*u-h*f*m;break;case"ZYX":this._x=h*d*u-c*f*m,this._y=c*f*u+h*d*m,this._z=c*d*m-h*f*u,this._w=c*d*u+h*f*m;break;case"YZX":this._x=h*d*u+c*f*m,this._y=c*f*u+h*d*m,this._z=c*d*m-h*f*u,this._w=c*d*u-h*f*m;break;case"XZY":this._x=h*d*u-c*f*m,this._y=c*f*u-h*d*m,this._z=c*d*m+h*f*u,this._w=c*d*u+h*f*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],d=t[6],u=t[10],h=n+a+u;if(h>0){const f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(d-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(n>a&&n>u){const f=2*Math.sqrt(1+n-a-u);this._w=(d-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>u){const f=2*Math.sqrt(1+a-n-u);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+d)/f}else{const f=2*Math.sqrt(1+u-n-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+d)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Vn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,d=t._w;return this._x=n*d+o*a+r*c-s*l,this._y=r*d+o*l+s*a-n*c,this._z=s*d+o*c+n*l-r*a,this._w=o*d-n*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*n+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),d=Math.atan2(c,a),u=Math.sin((1-t)*d)/c,h=Math.sin(t*d)/c;return this._w=o*u+this._w*h,this._x=n*u+this._x*h,this._y=r*u+this._y*h,this._z=s*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(s),n*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class R{constructor(e=0,t=0,n=0){R.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(aU.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(aU.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*n,d=l*n+a*t-s*r,u=l*r+s*n-o*t,h=-s*t-o*n-a*r;return this.x=c*l+h*-s+d*-a-u*-o,this.y=d*l+h*-o+u*-s-c*-a,this.z=u*l+h*-a+c*-o-d*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return FT.copy(this).projectOnVector(e),this.sub(FT)}reflect(e){return this.sub(FT.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Vn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const FT=new R,aU=new xi;class io{constructor(e=new R(1/0,1/0,1/0),t=new R(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(El.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(El.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=El.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),Uf.copy(e.boundingBox),Uf.applyMatrix4(e.matrixWorld),this.union(Uf);else{const r=e.geometry;if(void 0!==r)if(t&&void 0!==r.attributes&&void 0!==r.attributes.position){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)El.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(El)}else null===r.boundingBox&&r.computeBoundingBox(),Uf.copy(r.boundingBox),Uf.applyMatrix4(e.matrixWorld),this.union(Uf)}const n=e.children;for(let r=0,s=n.length;r<s;r++)this.expandByObject(n[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,El),El.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(db),Fy.subVectors(this.max,db),Vf.subVectors(e.a,db),zf.subVectors(e.b,db),Gf.subVectors(e.c,db),gc.subVectors(zf,Vf),_c.subVectors(Gf,zf),Kd.subVectors(Vf,Gf);let t=[0,-gc.z,gc.y,0,-_c.z,_c.y,0,-Kd.z,Kd.y,gc.z,0,-gc.x,_c.z,0,-_c.x,Kd.z,0,-Kd.x,-gc.y,gc.x,0,-_c.y,_c.x,0,-Kd.y,Kd.x,0];return!(!OT(t,Vf,zf,Gf,Fy)||(t=[1,0,0,0,1,0,0,0,1],!OT(t,Vf,zf,Gf,Fy)))&&(Oy.crossVectors(gc,_c),t=[Oy.x,Oy.y,Oy.z],OT(t,Vf,zf,Gf,Fy))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,El).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(El).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Ml[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ml[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ml[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ml[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ml[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ml[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ml[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ml[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ml)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Ml=[new R,new R,new R,new R,new R,new R,new R,new R],El=new R,Uf=new io,Vf=new R,zf=new R,Gf=new R,gc=new R,_c=new R,Kd=new R,db=new R,Fy=new R,Oy=new R,$d=new R;function OT(i,e,t,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){$d.fromArray(i,s);const a=r.x*Math.abs($d.x)+r.y*Math.abs($d.y)+r.z*Math.abs($d.z),l=e.dot($d),c=t.dot($d),d=n.dot($d);if(Math.max(-Math.max(l,c,d),Math.min(l,c,d))>a)return!1}return!0}const kne=new io,ub=new R,NT=new R;class Eo{constructor(e=new R,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):kne.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;ub.subVectors(e,this.center);const t=ub.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=.5*(n-this.radius);this.center.addScaledVector(ub,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(NT.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(ub.copy(e.center).add(NT)),this.expandByPoint(ub.copy(e.center).sub(NT))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Sl=new R,jT=new R,Ny=new R,bc=new R,UT=new R,jy=new R,VT=new R;class hb{constructor(e=new R,t=new R(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Sl)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Sl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Sl.copy(this.origin).addScaledVector(this.direction,t),Sl.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){jT.copy(e).add(t).multiplyScalar(.5),Ny.copy(t).sub(e).normalize(),bc.copy(this.origin).sub(jT);const s=.5*e.distanceTo(t),o=-this.direction.dot(Ny),a=bc.dot(this.direction),l=-bc.dot(Ny),c=bc.lengthSq(),d=Math.abs(1-o*o);let u,h,f,m;if(d>0)if(u=o*l-a,h=o*a-l,m=s*d,u>=0)if(h>=-m)if(h<=m){const _=1/d;u*=_,h*=_,f=u*(u+o*h+2*a)+h*(o*u+h+2*l)+c}else h=s,u=Math.max(0,-(o*h+a)),f=-u*u+h*(h+2*l)+c;else h=-s,u=Math.max(0,-(o*h+a)),f=-u*u+h*(h+2*l)+c;else h<=-m?(u=Math.max(0,-(-o*s+a)),h=u>0?-s:Math.min(Math.max(-s,-l),s),f=-u*u+h*(h+2*l)+c):h<=m?(u=0,h=Math.min(Math.max(-s,-l),s),f=h*(h+2*l)+c):(u=Math.max(0,-(o*s+a)),h=u>0?s:Math.min(Math.max(-s,-l),s),f=-u*u+h*(h+2*l)+c);else h=o>0?-s:s,u=Math.max(0,-(o*h+a)),f=-u*u+h*(h+2*l)+c;return n&&n.copy(this.origin).addScaledVector(this.direction,u),r&&r.copy(jT).addScaledVector(Ny,h),f}intersectSphere(e,t){Sl.subVectors(e.center,this.origin);const n=Sl.dot(this.direction),r=Sl.dot(Sl)-n*n,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,l=n+o;return l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,o,a,l;const c=1/this.direction.x,d=1/this.direction.y,u=1/this.direction.z,h=this.origin;return c>=0?(n=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(n=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),d>=0?(s=(e.min.y-h.y)*d,o=(e.max.y-h.y)*d):(s=(e.max.y-h.y)*d,o=(e.min.y-h.y)*d),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),u>=0?(a=(e.min.z-h.z)*u,l=(e.max.z-h.z)*u):(a=(e.max.z-h.z)*u,l=(e.min.z-h.z)*u),n>l||a>r)||((a>n||n!=n)&&(n=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return null!==this.intersectBox(e,Sl)}intersectTriangle(e,t,n,r,s){UT.subVectors(t,e),jy.subVectors(n,e),VT.crossVectors(UT,jy);let a,o=this.direction.dot(VT);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}bc.subVectors(this.origin,e);const l=a*this.direction.dot(jy.crossVectors(bc,jy));if(l<0)return null;const c=a*this.direction.dot(UT.cross(bc));if(c<0||l+c>o)return null;const d=-a*bc.dot(VT);return d<0?null:this.at(d/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Qe{constructor(){Qe.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,n,r,s,o,a,l,c,d,u,h,f,m,_,g){const p=this.elements;return p[0]=e,p[4]=t,p[8]=n,p[12]=r,p[1]=s,p[5]=o,p[9]=a,p[13]=l,p[2]=c,p[6]=d,p[10]=u,p[14]=h,p[3]=f,p[7]=m,p[11]=_,p[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Qe).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/Hf.setFromMatrixColumn(e,0).length(),s=1/Hf.setFromMatrixColumn(e,1).length(),o=1/Hf.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),c=Math.sin(r),d=Math.cos(s),u=Math.sin(s);if("XYZ"===e.order){const h=o*d,f=o*u,m=a*d,_=a*u;t[0]=l*d,t[4]=-l*u,t[8]=c,t[1]=f+m*c,t[5]=h-_*c,t[9]=-a*l,t[2]=_-h*c,t[6]=m+f*c,t[10]=o*l}else if("YXZ"===e.order){const h=l*d,f=l*u,m=c*d,_=c*u;t[0]=h+_*a,t[4]=m*a-f,t[8]=o*c,t[1]=o*u,t[5]=o*d,t[9]=-a,t[2]=f*a-m,t[6]=_+h*a,t[10]=o*l}else if("ZXY"===e.order){const h=l*d,f=l*u,m=c*d,_=c*u;t[0]=h-_*a,t[4]=-o*u,t[8]=m+f*a,t[1]=f+m*a,t[5]=o*d,t[9]=_-h*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const h=o*d,f=o*u,m=a*d,_=a*u;t[0]=l*d,t[4]=m*c-f,t[8]=h*c+_,t[1]=l*u,t[5]=_*c+h,t[9]=f*c-m,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const h=o*l,f=o*c,m=a*l,_=a*c;t[0]=l*d,t[4]=_-h*u,t[8]=m*u+f,t[1]=u,t[5]=o*d,t[9]=-a*d,t[2]=-c*d,t[6]=f*u+m,t[10]=h-_*u}else if("XZY"===e.order){const h=o*l,f=o*c,m=a*l,_=a*c;t[0]=l*d,t[4]=-u,t[8]=c*d,t[1]=h*u+_,t[5]=o*d,t[9]=f*u-m,t[2]=m*u-f,t[6]=a*d,t[10]=_*u+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Bne,e,Lne)}lookAt(e,t,n){const r=this.elements;return no.subVectors(e,t),0===no.lengthSq()&&(no.z=1),no.normalize(),vc.crossVectors(n,no),0===vc.lengthSq()&&(1===Math.abs(n.z)?no.x+=1e-4:no.z+=1e-4,no.normalize(),vc.crossVectors(n,no)),vc.normalize(),Uy.crossVectors(no,vc),r[0]=vc.x,r[4]=Uy.x,r[8]=no.x,r[1]=vc.y,r[5]=Uy.y,r[9]=no.y,r[2]=vc.z,r[6]=Uy.z,r[10]=no.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[4],l=n[8],c=n[12],d=n[1],u=n[5],h=n[9],f=n[13],m=n[2],_=n[6],g=n[10],p=n[14],v=n[3],b=n[7],y=n[11],x=n[15],w=r[0],E=r[4],S=r[8],C=r[12],T=r[1],k=r[5],U=r[9],L=r[13],j=r[2],H=r[6],B=r[10],V=r[14],O=r[3],Q=r[7],oe=r[11],be=r[15];return s[0]=o*w+a*T+l*j+c*O,s[4]=o*E+a*k+l*H+c*Q,s[8]=o*S+a*U+l*B+c*oe,s[12]=o*C+a*L+l*V+c*be,s[1]=d*w+u*T+h*j+f*O,s[5]=d*E+u*k+h*H+f*Q,s[9]=d*S+u*U+h*B+f*oe,s[13]=d*C+u*L+h*V+f*be,s[2]=m*w+_*T+g*j+p*O,s[6]=m*E+_*k+g*H+p*Q,s[10]=m*S+_*U+g*B+p*oe,s[14]=m*C+_*L+g*V+p*be,s[3]=v*w+b*T+y*j+x*O,s[7]=v*E+b*k+y*H+x*Q,s[11]=v*S+b*U+y*B+x*oe,s[15]=v*C+b*L+y*V+x*be,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],d=e[2],u=e[6],h=e[10],f=e[14];return e[3]*(+s*l*u-r*c*u-s*a*h+n*c*h+r*a*f-n*l*f)+e[7]*(+t*l*f-t*c*h+s*o*h-r*o*f+r*c*d-s*l*d)+e[11]*(+t*c*u-t*a*f-s*o*u+n*o*f+s*a*d-n*c*d)+e[15]*(-r*a*d-t*l*u+t*a*h+r*o*u-n*o*h+n*l*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],u=e[9],h=e[10],f=e[11],m=e[12],_=e[13],g=e[14],p=e[15],v=u*g*c-_*h*c+_*l*f-a*g*f-u*l*p+a*h*p,b=m*h*c-d*g*c-m*l*f+o*g*f+d*l*p-o*h*p,y=d*_*c-m*u*c+m*a*f-o*_*f-d*a*p+o*u*p,x=m*u*l-d*_*l-m*a*h+o*_*h+d*a*g-o*u*g,w=t*v+n*b+r*y+s*x;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const E=1/w;return e[0]=v*E,e[1]=(_*h*s-u*g*s-_*r*f+n*g*f+u*r*p-n*h*p)*E,e[2]=(a*g*s-_*l*s+_*r*c-n*g*c-a*r*p+n*l*p)*E,e[3]=(u*l*s-a*h*s-u*r*c+n*h*c+a*r*f-n*l*f)*E,e[4]=b*E,e[5]=(d*g*s-m*h*s+m*r*f-t*g*f-d*r*p+t*h*p)*E,e[6]=(m*l*s-o*g*s-m*r*c+t*g*c+o*r*p-t*l*p)*E,e[7]=(o*h*s-d*l*s+d*r*c-t*h*c-o*r*f+t*l*f)*E,e[8]=y*E,e[9]=(m*u*s-d*_*s-m*n*f+t*_*f+d*n*p-t*u*p)*E,e[10]=(o*_*s-m*a*s+m*n*c-t*_*c-o*n*p+t*a*p)*E,e[11]=(d*a*s-o*u*s-d*n*c+t*u*c+o*n*f-t*a*f)*E,e[12]=x*E,e[13]=(d*_*r-m*u*r+m*n*h-t*_*h-d*n*g+t*u*g)*E,e[14]=(m*a*r-o*_*r-m*n*l+t*_*l+o*n*g-t*a*g)*E,e[15]=(o*u*r-d*a*r+d*n*l-t*u*l-o*n*h+t*a*h)*E,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,o=e.x,a=e.y,l=e.z,c=s*o,d=s*a;return this.set(c*o+n,c*a-r*l,c*l+r*a,0,c*a+r*l,d*a+n,d*l-r*o,0,c*l-r*a,d*l+r*o,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,d=o+o,u=a+a,h=s*c,f=s*d,m=s*u,_=o*d,g=o*u,p=a*u,v=l*c,b=l*d,y=l*u,x=n.x,w=n.y,E=n.z;return r[0]=(1-(_+p))*x,r[1]=(f+y)*x,r[2]=(m-b)*x,r[3]=0,r[4]=(f-y)*w,r[5]=(1-(h+p))*w,r[6]=(g+v)*w,r[7]=0,r[8]=(m+b)*E,r[9]=(g-v)*E,r[10]=(1-(h+_))*E,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let s=Hf.set(r[0],r[1],r[2]).length();const o=Hf.set(r[4],r[5],r[6]).length(),a=Hf.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],ra.copy(this);const c=1/s,d=1/o,u=1/a;return ra.elements[0]*=c,ra.elements[1]*=c,ra.elements[2]*=c,ra.elements[4]*=d,ra.elements[5]*=d,ra.elements[6]*=d,ra.elements[8]*=u,ra.elements[9]*=u,ra.elements[10]*=u,t.setFromRotationMatrix(ra),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,r,s,o){const a=this.elements,c=2*s/(n-r),d=(t+e)/(t-e),u=(n+r)/(n-r),h=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=2*s/(t-e),a[4]=0,a[8]=d,a[12]=0,a[1]=0,a[5]=c,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,r,s,o){const a=this.elements,l=1/(t-e),c=1/(n-r),d=1/(o-s),u=(t+e)*l,h=(n+r)*c,f=(o+s)*d;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*d,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Hf=new R,ra=new Qe,Bne=new R(0,0,0),Lne=new R(1,1,1),vc=new R,Uy=new R,no=new R,lU=new Qe,cU=new xi;let ro=(()=>{class i{constructor(t=0,n=0,r=0,s=i.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,s=this._order){return this._x=t,this._y=n,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],d=s[5],u=s[9],h=s[2],f=s[6],m=s[10];switch(n){case"XYZ":this._y=Math.asin(Vn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,m),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,d),this._z=0);break;case"YXZ":this._x=Math.asin(-Vn(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(l,m),this._z=Math.atan2(c,d)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(Vn(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,m),this._z=Math.atan2(-a,d)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-Vn(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,m),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,d));break;case"YZX":this._z=Math.asin(Vn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-u,d),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(l,m));break;case"XZY":this._z=Math.asin(-Vn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,d),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-u,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return lU.makeRotationFromQuaternion(t),this.setFromRotationMatrix(lU,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return cU.setFromEuler(this),this.setFromQuaternion(cU,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return i.DEFAULT_ORDER="XYZ",i})();class Vy{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Fne=0;const dU=new R,Qf=new xi,Tl=new Qe,zy=new R,fb=new R,One=new R,Nne=new xi,uU=new R(1,0,0),hU=new R(0,1,0),fU=new R(0,0,1),jne={type:"added"},pU={type:"removed"};let Qt=(()=>{class i extends as{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Fne++}),this.uuid=eo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=i.DEFAULT_UP.clone();const t=new R,n=new ro,r=new xi,s=new R(1,1,1);n._onChange(function o(){r.setFromEuler(n,!1)}),r._onChange(function a(){n.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Qe},normalMatrix:{value:new Ai}}),this.matrix=new Qe,this.matrixWorld=new Qe,this.matrixAutoUpdate=i.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Vy,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return Qf.setFromAxisAngle(t,n),this.quaternion.multiply(Qf),this}rotateOnWorldAxis(t,n){return Qf.setFromAxisAngle(t,n),this.quaternion.premultiply(Qf),this}rotateX(t){return this.rotateOnAxis(uU,t)}rotateY(t){return this.rotateOnAxis(hU,t)}rotateZ(t){return this.rotateOnAxis(fU,t)}translateOnAxis(t,n){return dU.copy(t).applyQuaternion(this.quaternion),this.position.add(dU.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis(uU,t)}translateY(t){return this.translateOnAxis(hU,t)}translateZ(t){return this.translateOnAxis(fU,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Tl.copy(this.matrixWorld).invert())}lookAt(t,n,r){t.isVector3?zy.copy(t):zy.set(t,n,r);const s=this.parent;this.updateWorldMatrix(!0,!1),fb.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Tl.lookAt(fb,zy,this.up):Tl.lookAt(zy,fb,this.up),this.quaternion.setFromRotationMatrix(Tl),s&&(Tl.extractRotation(s.matrixWorld),Qf.setFromRotationMatrix(Tl),this.quaternion.premultiply(Qf.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(jne)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(pU)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const n=this.children[t];n.parent=null,n.dispatchEvent(pU)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Tl.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Tl.multiply(t.parent.matrixWorld)),t.applyMatrix4(Tl),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,n);if(void 0!==a)return a}}getObjectsByProperty(t,n){let r=[];this[t]===n&&r.push(this);for(let s=0,o=this.children.length;s<o;s++){const a=this.children[s].getObjectsByProperty(t,n);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fb,t,One),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fb,Nne,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverseVisible(t)}traverseAncestors(t){const n=this.parent;null!==n&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const n=this.children;for(let r=0,s=n.length;r<s;r++){const o=n[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,n){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===n){const s=this.children;for(let o=0,a=s.length;o<a;o++){const l=s[o];!0===l.matrixWorldAutoUpdate&&l.updateWorldMatrix(!1,!0)}}}toJSON(t){const n=void 0===t||"string"==typeof t,r={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const s={};function o(l,c){return void 0===l[c.uuid]&&(l[c.uuid]=c.toJSON(t)),c.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const c=l.shapes;if(Array.isArray(c))for(let d=0,u=c.length;d<u;d++)o(t.shapes,c[d]);else o(t.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let c=0,d=this.material.length;c<d;c++)l.push(o(t.materials,this.material[c]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++)s.animations.push(o(t.animations,this.animations[l]))}if(n){const l=a(t.geometries),c=a(t.materials),d=a(t.textures),u=a(t.images),h=a(t.shapes),f=a(t.skeletons),m=a(t.animations),_=a(t.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),d.length>0&&(r.textures=d),u.length>0&&(r.images=u),h.length>0&&(r.shapes=h),f.length>0&&(r.skeletons=f),m.length>0&&(r.animations=m),_.length>0&&(r.nodes=_)}return r.object=s,r;function a(l){const c=[];for(const d in l){const u=l[d];delete u.metadata,c.push(u)}return c}}clone(t){return(new this.constructor).copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===n)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return i.DEFAULT_UP=new R(0,1,0),i.DEFAULT_MATRIX_AUTO_UPDATE=!0,i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,i})();const sa=new R,Rl=new R,zT=new R,Il=new R,Wf=new R,qf=new R,mU=new R,GT=new R,HT=new R,QT=new R;let Gy=!1;class ls{constructor(e=new R,t=new R,n=new R){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),sa.subVectors(e,t),r.cross(sa);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){sa.subVectors(r,t),Rl.subVectors(n,t),zT.subVectors(e,t);const o=sa.dot(sa),a=sa.dot(Rl),l=sa.dot(zT),c=Rl.dot(Rl),d=Rl.dot(zT),u=o*c-a*a;if(0===u)return s.set(-2,-1,-1);const h=1/u,f=(c*l-a*d)*h,m=(o*d-a*l)*h;return s.set(1-f-m,m,f)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Il),Il.x>=0&&Il.y>=0&&Il.x+Il.y<=1}static getUV(e,t,n,r,s,o,a,l){return!1===Gy&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Gy=!0),this.getInterpolation(e,t,n,r,s,o,a,l)}static getInterpolation(e,t,n,r,s,o,a,l){return this.getBarycoord(e,t,n,r,Il),l.setScalar(0),l.addScaledVector(s,Il.x),l.addScaledVector(o,Il.y),l.addScaledVector(a,Il.z),l}static isFrontFacing(e,t,n,r){return sa.subVectors(n,t),Rl.subVectors(e,t),sa.cross(Rl).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return sa.subVectors(this.c,this.b),Rl.subVectors(this.a,this.b),.5*sa.cross(Rl).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ls.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ls.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,s){return!1===Gy&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Gy=!0),ls.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}getInterpolation(e,t,n,r,s){return ls.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return ls.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ls.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let o,a;Wf.subVectors(r,n),qf.subVectors(s,n),GT.subVectors(e,n);const l=Wf.dot(GT),c=qf.dot(GT);if(l<=0&&c<=0)return t.copy(n);HT.subVectors(e,r);const d=Wf.dot(HT),u=qf.dot(HT);if(d>=0&&u<=d)return t.copy(r);const h=l*u-d*c;if(h<=0&&l>=0&&d<=0)return o=l/(l-d),t.copy(n).addScaledVector(Wf,o);QT.subVectors(e,s);const f=Wf.dot(QT),m=qf.dot(QT);if(m>=0&&f<=m)return t.copy(s);const _=f*c-l*m;if(_<=0&&c>=0&&m<=0)return a=c/(c-m),t.copy(n).addScaledVector(qf,a);const g=d*m-f*u;if(g<=0&&u-d>=0&&f-m>=0)return mU.subVectors(s,r),a=(u-d)/(u-d+(f-m)),t.copy(r).addScaledVector(mU,a);const p=1/(g+_+h);return o=_*p,a=h*p,t.copy(n).addScaledVector(Wf,o).addScaledVector(qf,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Une=0;class zn extends as{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Une++}),this.uuid=eo(),this.name="",this.type="Material",this.blending=Pa,this.side=Da,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Mf,this.blendDst=Y_,this.blendEquation=ws,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=yy,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=iU,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ky,this.stencilZFail=ky,this.stencilZPass=ky,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Pa&&(n.blending=this.blending),this.side!==Da&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(n.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const gU={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},oa={h:0,s:0,l:0},Hy={h:0,s:0,l:0};function WT(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+6*(e-i)*t:t<.5?e:t<2/3?i+6*(e-i)*(2/3-t):i}class Le{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Js){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Cs.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=Cs.workingColorSpace){return this.r=e,this.g=t,this.b=n,Cs.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=Cs.workingColorSpace){if(e=IT(e,1),t=Vn(t,0,1),n=Vn(n,0,1),0===t)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+t):n+t-n*t,o=2*n-s;this.r=WT(o,s,e+1/3),this.g=WT(o,s,e),this.b=WT(o,s,e-1/3)}return Cs.toWorkingColorSpace(this,r),this}setStyle(e,t=Js){function n(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,Cs.toWorkingColorSpace(this,t),n(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,Cs.toWorkingColorSpace(this,t),n(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const l=parseFloat(s[1])/360,c=parseFloat(s[2])/100,d=parseFloat(s[3])/100;return n(s[4]),this.setHSL(l,c,d,t)}break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(3===o)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(6===o)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Js){const n=gU[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Nf(e.r),this.g=Nf(e.g),this.b=Nf(e.b),this}copyLinearToSRGB(e){return this.r=kT(e.r),this.g=kT(e.g),this.b=kT(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Js){return Cs.fromWorkingColorSpace(qr.copy(this),e),Vn(255*qr.r,0,255)<<16^Vn(255*qr.g,0,255)<<8^Vn(255*qr.b,0,255)<<0}getHexString(e=Js){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Cs.workingColorSpace){Cs.fromWorkingColorSpace(qr.copy(this),t);const n=qr.r,r=qr.g,s=qr.b,o=Math.max(n,r,s),a=Math.min(n,r,s);let l,c;const d=(a+o)/2;if(a===o)l=0,c=0;else{const u=o-a;switch(c=d<=.5?u/(o+a):u/(2-o-a),o){case n:l=(r-s)/u+(r<s?6:0);break;case r:l=(s-n)/u+2;break;case s:l=(n-r)/u+4}l/=6}return e.h=l,e.s=c,e.l=d,e}getRGB(e,t=Cs.workingColorSpace){return Cs.fromWorkingColorSpace(qr.copy(this),t),e.r=qr.r,e.g=qr.g,e.b=qr.b,e}getStyle(e=Js){Cs.fromWorkingColorSpace(qr.copy(this),e);const t=qr.r,n=qr.g,r=qr.b;return e!==Js?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${255*t|0},${255*n|0},${255*r|0})`}offsetHSL(e,t,n){return this.getHSL(oa),oa.h+=e,oa.s+=t,oa.l+=n,this.setHSL(oa.h,oa.s,oa.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(oa),e.getHSL(Hy);const n=ob(oa.h,Hy.h,t),r=ob(oa.s,Hy.s,t),s=ob(oa.l,Hy.l,t);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*r,this.g=s[1]*t+s[4]*n+s[7]*r,this.b=s[2]*t+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const qr=new Le;Le.NAMES=gU;class $n extends zn{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Le(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=X_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Dl=Vne();function Vne(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(n[l]=0,n[256|l]=32768,r[l]=24,r[256|l]=24):c<-14?(n[l]=1024>>-c-14,n[256|l]=1024>>-c-14|32768,r[l]=-c-1,r[256|l]=-c-1):c<=15?(n[l]=c+15<<10,n[256|l]=c+15<<10|32768,r[l]=13,r[256|l]=13):c<128?(n[l]=31744,n[256|l]=64512,r[l]=24,r[256|l]=24):(n[l]=31744,n[256|l]=64512,r[l]=13,r[256|l]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,d=0;for(;!(8388608&c);)c<<=1,d-=8388608;c&=-8388609,d+=947912704,s[l]=c|d}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function Ms(i){Math.abs(i)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),i=Vn(i,-65504,65504),Dl.floatView[0]=i;const e=Dl.uint32View[0],t=e>>23&511;return Dl.baseTable[t]+((8388607&e)>>Dl.shiftTable[t])}function pb(i){const e=i>>10;return Dl.uint32View[0]=Dl.mantissaTable[Dl.offsetTable[e]+(1023&i)]+Dl.exponentTable[e],Dl.floatView[0]}const cs={toHalfFloat:Ms,fromHalfFloat:pb},lr=new R,Qy=new fe;class Mi{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=sb,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)Qy.fromBufferAttribute(this,t),Qy.applyMatrix3(e),this.setXY(t,Qy.x,Qy.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)lr.fromBufferAttribute(this,t),lr.applyMatrix3(e),this.setXYZ(t,lr.x,lr.y,lr.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)lr.fromBufferAttribute(this,t),lr.applyMatrix4(e),this.setXYZ(t,lr.x,lr.y,lr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)lr.fromBufferAttribute(this,t),lr.applyNormalMatrix(e),this.setXYZ(t,lr.x,lr.y,lr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)lr.fromBufferAttribute(this,t),lr.transformDirection(e),this.setXYZ(t,lr.x,lr.y,lr.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=to(t,this.array)),t}setX(e,t){return this.normalized&&(t=hi(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=to(t,this.array)),t}setY(e,t){return this.normalized&&(t=hi(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=to(t,this.array)),t}setZ(e,t){return this.normalized&&(t=hi(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=to(t,this.array)),t}setW(e,t){return this.normalized&&(t=hi(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=hi(t,this.array),n=hi(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=hi(t,this.array),n=hi(n,this.array),r=hi(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=hi(t,this.array),n=hi(n,this.array),r=hi(r,this.array),s=hi(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==sb&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class zne extends Mi{constructor(e,t,n){super(new Int8Array(e),t,n)}}class Gne extends Mi{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class Hne extends Mi{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class Qne extends Mi{constructor(e,t,n){super(new Int16Array(e),t,n)}}class Wy extends Mi{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class Wne extends Mi{constructor(e,t,n){super(new Int32Array(e),t,n)}}class qy extends Mi{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class qne extends Mi{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=pb(this.array[e*this.itemSize]);return this.normalized&&(t=to(t,this.array)),t}setX(e,t){return this.normalized&&(t=hi(t,this.array)),this.array[e*this.itemSize]=Ms(t),this}getY(e){let t=pb(this.array[e*this.itemSize+1]);return this.normalized&&(t=to(t,this.array)),t}setY(e,t){return this.normalized&&(t=hi(t,this.array)),this.array[e*this.itemSize+1]=Ms(t),this}getZ(e){let t=pb(this.array[e*this.itemSize+2]);return this.normalized&&(t=to(t,this.array)),t}setZ(e,t){return this.normalized&&(t=hi(t,this.array)),this.array[e*this.itemSize+2]=Ms(t),this}getW(e){let t=pb(this.array[e*this.itemSize+3]);return this.normalized&&(t=to(t,this.array)),t}setW(e,t){return this.normalized&&(t=hi(t,this.array)),this.array[e*this.itemSize+3]=Ms(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=hi(t,this.array),n=hi(n,this.array)),this.array[e+0]=Ms(t),this.array[e+1]=Ms(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=hi(t,this.array),n=hi(n,this.array),r=hi(r,this.array)),this.array[e+0]=Ms(t),this.array[e+1]=Ms(n),this.array[e+2]=Ms(r),this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=hi(t,this.array),n=hi(n,this.array),r=hi(r,this.array),s=hi(s,this.array)),this.array[e+0]=Ms(t),this.array[e+1]=Ms(n),this.array[e+2]=Ms(r),this.array[e+3]=Ms(s),this}}class Ke extends Mi{constructor(e,t,n){super(new Float32Array(e),t,n)}}class Yne extends Mi{constructor(e,t,n){super(new Float64Array(e),t,n)}}let Xne=0;const So=new Qe,qT=new Qt,Yf=new R,so=new io,mb=new io,Mr=new R;class Mt extends as{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Xne++}),this.uuid=eo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(oU(e)?qy:Wy)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const s=(new Ai).getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return So.makeRotationFromQuaternion(e),this.applyMatrix4(So),this}rotateX(e){return So.makeRotationX(e),this.applyMatrix4(So),this}rotateY(e){return So.makeRotationY(e),this.applyMatrix4(So),this}rotateZ(e){return So.makeRotationZ(e),this.applyMatrix4(So),this}translate(e,t,n){return So.makeTranslation(e,t,n),this.applyMatrix4(So),this}scale(e,t,n){return So.makeScale(e,t,n),this.applyMatrix4(So),this}lookAt(e){return qT.lookAt(e),qT.updateMatrix(),this.applyMatrix4(qT.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Yf).negate(),this.translate(Yf.x,Yf.y,Yf.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ke(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new io);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new R(-1/0,-1/0,-1/0),new R(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++)so.setFromBufferAttribute(t[n]),this.morphTargetsRelative?(Mr.addVectors(this.boundingBox.min,so.min),this.boundingBox.expandByPoint(Mr),Mr.addVectors(this.boundingBox.max,so.max),this.boundingBox.expandByPoint(Mr)):(this.boundingBox.expandByPoint(so.min),this.boundingBox.expandByPoint(so.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Eo);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new R,1/0);if(e){const n=this.boundingSphere.center;if(so.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)mb.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(Mr.addVectors(so.min,mb.min),so.expandByPoint(Mr),Mr.addVectors(so.max,mb.max),so.expandByPoint(Mr)):(so.expandByPoint(mb.min),so.expandByPoint(mb.max));so.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)Mr.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(Mr));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,d=a.count;c<d;c++)Mr.fromBufferAttribute(a,c),l&&(Yf.fromBufferAttribute(e,c),Mr.add(Yf)),r=Math.max(r,n.distanceToSquared(Mr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Mi(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],d=[];for(let T=0;T<a;T++)c[T]=new R,d[T]=new R;const u=new R,h=new R,f=new R,m=new fe,_=new fe,g=new fe,p=new R,v=new R;function b(T,k,U){u.fromArray(r,3*T),h.fromArray(r,3*k),f.fromArray(r,3*U),m.fromArray(o,2*T),_.fromArray(o,2*k),g.fromArray(o,2*U),h.sub(u),f.sub(u),_.sub(m),g.sub(m);const L=1/(_.x*g.y-g.x*_.y);isFinite(L)&&(p.copy(h).multiplyScalar(g.y).addScaledVector(f,-_.y).multiplyScalar(L),v.copy(f).multiplyScalar(_.x).addScaledVector(h,-g.x).multiplyScalar(L),c[T].add(p),c[k].add(p),c[U].add(p),d[T].add(v),d[k].add(v),d[U].add(v))}let y=this.groups;0===y.length&&(y=[{start:0,count:n.length}]);for(let T=0,k=y.length;T<k;++T){const U=y[T],L=U.start;for(let H=L,B=L+U.count;H<B;H+=3)b(n[H+0],n[H+1],n[H+2])}const x=new R,w=new R,E=new R,S=new R;function C(T){E.fromArray(s,3*T),S.copy(E);const k=c[T];x.copy(k),x.sub(E.multiplyScalar(E.dot(k))).normalize(),w.crossVectors(S,k);const L=w.dot(d[T])<0?-1:1;l[4*T]=x.x,l[4*T+1]=x.y,l[4*T+2]=x.z,l[4*T+3]=L}for(let T=0,k=y.length;T<k;++T){const U=y[T],L=U.start;for(let H=L,B=L+U.count;H<B;H+=3)C(n[H+0]),C(n[H+1]),C(n[H+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new Mi(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let h=0,f=n.count;h<f;h++)n.setXYZ(h,0,0,0);const r=new R,s=new R,o=new R,a=new R,l=new R,c=new R,d=new R,u=new R;if(e)for(let h=0,f=e.count;h<f;h+=3){const m=e.getX(h+0),_=e.getX(h+1),g=e.getX(h+2);r.fromBufferAttribute(t,m),s.fromBufferAttribute(t,_),o.fromBufferAttribute(t,g),d.subVectors(o,s),u.subVectors(r,s),d.cross(u),a.fromBufferAttribute(n,m),l.fromBufferAttribute(n,_),c.fromBufferAttribute(n,g),a.add(d),l.add(d),c.add(d),n.setXYZ(m,a.x,a.y,a.z),n.setXYZ(_,l.x,l.y,l.z),n.setXYZ(g,c.x,c.y,c.z)}else for(let h=0,f=t.count;h<f;h+=3)r.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),d.subVectors(o,s),u.subVectors(r,s),d.cross(u),n.setXYZ(h+0,d.x,d.y,d.z),n.setXYZ(h+1,d.x,d.y,d.z),n.setXYZ(h+2,d.x,d.y,d.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Mr.fromBufferAttribute(e,t),Mr.normalize(),e.setXYZ(t,Mr.x,Mr.y,Mr.z)}toNonIndexed(){function e(a,l){const c=a.array,d=a.itemSize,u=a.normalized,h=new c.constructor(l.length*d);let f=0,m=0;for(let _=0,g=l.length;_<g;_++){f=a.isInterleavedBufferAttribute?l[_]*a.data.stride+a.offset:l[_]*d;for(let p=0;p<d;p++)h[m++]=c[f++]}return new Mi(h,d,u)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Mt,n=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],n);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let d=0,u=c.length;d<u;d++){const f=e(c[d],n);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n)e.data.attributes[l]=n[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],d=[];for(let u=0,h=c.length;u<h;u++)d.push(c[u].toJSON(e.data));d.length>0&&(r[l]=d,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const d=[],u=s[c];for(let h=0,f=u.length;h<f;h++)d.push(u[h].clone(t));this.morphAttributes[c]=d}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,d=o.length;c<d;c++){const u=o[c];this.addGroup(u.start,u.count,u.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const _U=new Qe,Ba=new hb,Yy=new Eo,bU=new R,Xf=new R,Zf=new R,Kf=new R,YT=new R,Xy=new R,Zy=new fe,Ky=new fe,$y=new fe,vU=new R,AU=new R,yU=new R,Jy=new R,ex=new R;class nt extends Qt{constructor(e=new Mt,t=new $n){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const n=this.geometry,s=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(n.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){Xy.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const d=a[l];0!==d&&(YT.fromBufferAttribute(s[l],e),Xy.addScaledVector(o?YT:YT.sub(t),d))}t.add(Xy)}return this.isSkinnedMesh&&this.applyBoneTransform(e,t),t}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===n.boundingSphere&&n.computeBoundingSphere(),Yy.copy(n.boundingSphere),Yy.applyMatrix4(s),Ba.copy(e.ray).recast(e.near),!1===Yy.containsPoint(Ba.origin)&&(null===Ba.intersectSphere(Yy,bU)||Ba.origin.distanceToSquared(bU)>(e.far-e.near)**2))||(_U.copy(s).invert(),Ba.copy(e.ray).applyMatrix4(_U),null!==n.boundingBox&&!1===Ba.intersectsBox(n.boundingBox)))return;let o;const a=n.index,l=n.attributes.position,c=n.attributes.uv,d=n.attributes.uv2,u=n.attributes.normal,h=n.groups,f=n.drawRange;if(null!==a)if(Array.isArray(r))for(let m=0,_=h.length;m<_;m++){const g=h[m],p=r[g.materialIndex];for(let y=Math.max(g.start,f.start),x=Math.min(a.count,Math.min(g.start+g.count,f.start+f.count));y<x;y+=3){const w=a.getX(y),E=a.getX(y+1),S=a.getX(y+2);o=tx(this,p,e,Ba,c,d,u,w,E,S),o&&(o.faceIndex=Math.floor(y/3),o.face.materialIndex=g.materialIndex,t.push(o))}}else for(let g=Math.max(0,f.start),p=Math.min(a.count,f.start+f.count);g<p;g+=3){const v=a.getX(g),b=a.getX(g+1),y=a.getX(g+2);o=tx(this,r,e,Ba,c,d,u,v,b,y),o&&(o.faceIndex=Math.floor(g/3),t.push(o))}else if(void 0!==l)if(Array.isArray(r))for(let m=0,_=h.length;m<_;m++){const g=h[m],p=r[g.materialIndex];for(let y=Math.max(g.start,f.start),x=Math.min(l.count,Math.min(g.start+g.count,f.start+f.count));y<x;y+=3)o=tx(this,p,e,Ba,c,d,u,y,y+1,y+2),o&&(o.faceIndex=Math.floor(y/3),o.face.materialIndex=g.materialIndex,t.push(o))}else for(let g=Math.max(0,f.start),p=Math.min(l.count,f.start+f.count);g<p;g+=3)o=tx(this,r,e,Ba,c,d,u,g,g+1,g+2),o&&(o.faceIndex=Math.floor(g/3),t.push(o))}}function tx(i,e,t,n,r,s,o,a,l,c){i.getVertexPosition(a,Xf),i.getVertexPosition(l,Zf),i.getVertexPosition(c,Kf);const d=function Zne(i,e,t,n,r,s,o,a){let l;if(l=e.side===Hr?n.intersectTriangle(o,s,r,!0,a):n.intersectTriangle(r,s,o,e.side===Da,a),null===l)return null;ex.copy(a),ex.applyMatrix4(i.matrixWorld);const c=t.ray.origin.distanceTo(ex);return c<t.near||c>t.far?null:{distance:c,point:ex.clone(),object:i}}(i,e,t,n,Xf,Zf,Kf,Jy);if(d){r&&(Zy.fromBufferAttribute(r,a),Ky.fromBufferAttribute(r,l),$y.fromBufferAttribute(r,c),d.uv=ls.getInterpolation(Jy,Xf,Zf,Kf,Zy,Ky,$y,new fe)),s&&(Zy.fromBufferAttribute(s,a),Ky.fromBufferAttribute(s,l),$y.fromBufferAttribute(s,c),d.uv2=ls.getInterpolation(Jy,Xf,Zf,Kf,Zy,Ky,$y,new fe)),o&&(vU.fromBufferAttribute(o,a),AU.fromBufferAttribute(o,l),yU.fromBufferAttribute(o,c),d.normal=ls.getInterpolation(Jy,Xf,Zf,Kf,vU,AU,yU,new R),d.normal.dot(n.direction)>0&&d.normal.multiplyScalar(-1));const u={a,b:l,c,normal:new R,materialIndex:0};ls.getNormal(Xf,Zf,Kf,u.normal),d.face=u}return d}class tn extends Mt{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],d=[],u=[];let h=0,f=0;function m(_,g,p,v,b,y,x,w,E,S,C){const T=y/E,k=x/S,U=y/2,L=x/2,j=w/2,H=E+1,B=S+1;let V=0,O=0;const Q=new R;for(let oe=0;oe<B;oe++){const be=oe*k-L;for(let de=0;de<H;de++)Q[_]=(de*T-U)*v,Q[g]=be*b,Q[p]=j,c.push(Q.x,Q.y,Q.z),Q[_]=0,Q[g]=0,Q[p]=w>0?1:-1,d.push(Q.x,Q.y,Q.z),u.push(de/E),u.push(1-oe/S),V+=1}for(let oe=0;oe<S;oe++)for(let be=0;be<E;be++){const X=h+be+H*(oe+1),Y=h+(be+1)+H*(oe+1),re=h+(be+1)+H*oe;l.push(h+be+H*oe,X,re),l.push(X,Y,re),O+=6}a.addGroup(f,O,C),f+=O,h+=V}m("z","y","x",-1,-1,n,t,e,o,s,0),m("z","y","x",1,-1,n,t,-e,o,s,1),m("x","z","y",1,1,e,n,t,r,o,2),m("x","z","y",1,-1,e,n,-t,r,o,3),m("x","y","z",1,-1,e,t,n,r,s,4),m("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new Ke(c,3)),this.setAttribute("normal",new Ke(d,3)),this.setAttribute("uv",new Ke(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new tn(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function $f(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():e[t][n]=Array.isArray(r)?r.slice():r}}return e}function ds(i){const e={};for(let t=0;t<i.length;t++){const n=$f(i[t]);for(const r in n)e[r]=n[r]}return e}function xU(i){return null===i.getRenderTarget()&&i.outputEncoding===ui?Js:Yd}const gi={clone:$f,merge:ds};class Pt extends zn{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=$f(e.uniforms),this.uniformsGroups=function Kne(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class ix extends Qt{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Qe,this.projectionMatrix=new Qe,this.projectionMatrixInverse=new Qe}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class In extends ix{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Ff*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Xd*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Ff*Math.atan(Math.tan(.5*Xd*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Xd*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*n/c,r*=o.width/l,n*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class XT extends Qt{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n;const r=new In(-90,1,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);const s=new In(-90,1,e,t);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),this.add(s);const o=new In(-90,1,e,t);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(0,1,0),this.add(o);const a=new In(-90,1,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);const l=new In(-90,1,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,1),this.add(l);const c=new In(-90,1,e,t);c.layers=this.layers,c.up.set(0,1,0),c.lookAt(0,0,-1),this.add(c)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[r,s,o,a,l,c]=this.children,d=e.getRenderTarget(),u=e.toneMapping,h=e.xr.enabled;e.toneMapping=ka,e.xr.enabled=!1;const f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,s),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,a),e.setRenderTarget(n,4),e.render(t,l),n.texture.generateMipmaps=f,e.setRenderTarget(n,5),e.render(t,c),e.setRenderTarget(d),e.toneMapping=u,e.xr.enabled=h,n.texture.needsPMREMUpdate=!0}}class Jd extends An{constructor(e,t,n,r,s,o,a,l,c,d){super(e=void 0!==e?e:[],t=void 0!==t?t:cc,n,r,s,o,a,l,c,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class wU extends Gt{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1};this.texture=new Jd([n,n,n,n,n,n],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Ui}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n_uniforms={tEquirect:{value:null}},n_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",n_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new tn(5,5,5),s=new Pt({name:"CubemapFromEquirect",uniforms:$f(n_uniforms),vertexShader:n_vertexShader,fragmentShader:n_fragmentShader,side:Hr,blending:Kt});s.uniforms.tEquirect.value=t;const o=new nt(r,s),a=t.minFilter;return t.minFilter===Ks&&(t.minFilter=Ui),new XT(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(s)}}const ZT=new R,ere=new R,tre=new Ai;class oo{constructor(e=new R(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=ZT.subVectors(n,t).cross(ere.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(ZT),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||tre.getNormalMatrix(e),r=this.coplanarPoint(ZT).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const eu=new Eo,nx=new R;class rx{constructor(e=new oo,t=new oo,n=new oo,r=new oo,s=new oo,o=new oo){this.planes=[e,t,n,r,s,o]}set(e,t,n,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,r=n[0],s=n[1],o=n[2],a=n[3],l=n[4],c=n[5],d=n[6],u=n[7],h=n[8],f=n[9],m=n[10],_=n[11],g=n[12],p=n[13],v=n[14],b=n[15];return t[0].setComponents(a-r,u-l,_-h,b-g).normalize(),t[1].setComponents(a+r,u+l,_+h,b+g).normalize(),t[2].setComponents(a+s,u+c,_+f,b+p).normalize(),t[3].setComponents(a-s,u-c,_-f,b-p).normalize(),t[4].setComponents(a-o,u-d,_-m,b-v).normalize(),t[5].setComponents(a+o,u+d,_+m,b+v).normalize(),this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),eu.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),eu.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(eu)}intersectsSprite(e){return eu.center.set(0,0,0),eu.radius=.7071067811865476,eu.applyMatrix4(e.matrixWorld),this.intersectsSphere(eu)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(nx.x=r.normal.x>0?e.max.x:e.min.x,nx.y=r.normal.y>0?e.max.y:e.min.y,nx.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(nx)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function CU(){let i=null,e=!1,t=null,n=null;function r(s,o){t(s,o),n=i.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function ire(i,e){const t=e.isWebGL2,n=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),n.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const d=n.get(c);d&&(i.deleteBuffer(d.buffer),n.delete(c))},update:function l(c,d){if(c.isGLBufferAttribute){const h=n.get(c);return void((!h||h.version<c.version)&&n.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const u=n.get(c);void 0===u?n.set(c,function r(c,d){const u=c.array,h=c.usage,f=i.createBuffer();let m;if(i.bindBuffer(d,f),i.bufferData(d,u,h),c.onUploadCallback(),u instanceof Float32Array)m=5126;else if(u instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");m=5131}else m=5123;else if(u instanceof Int16Array)m=5122;else if(u instanceof Uint32Array)m=5125;else if(u instanceof Int32Array)m=5124;else if(u instanceof Int8Array)m=5120;else if(u instanceof Uint8Array)m=5121;else{if(!(u instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);m=5121}return{buffer:f,type:m,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version}}(c,d)):u.version<c.version&&(function s(c,d,u){const h=d.array,f=d.updateRange;i.bindBuffer(u,c),-1===f.count?i.bufferSubData(u,0,h):(t?i.bufferSubData(u,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):i.bufferSubData(u,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1),d.onUploadCallback()}(u.buffer,c,d),u.version=c.version)}}}class Ac extends Mt{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(n),l=Math.floor(r),c=a+1,d=l+1,u=e/a,h=t/l,f=[],m=[],_=[],g=[];for(let p=0;p<d;p++){const v=p*h-o;for(let b=0;b<c;b++)m.push(b*u-s,-v,0),_.push(0,0,1),g.push(b/a),g.push(1-p/l)}for(let p=0;p<l;p++)for(let v=0;v<a;v++){const y=v+c*(p+1),x=v+1+c*(p+1),w=v+1+c*p;f.push(v+c*p,y,w),f.push(y,x,w)}this.setIndex(f),this.setAttribute("position",new Ke(m,3)),this.setAttribute("normal",new Ke(_,3)),this.setAttribute("uv",new Ke(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ac(e.width,e.height,e.widthSegments,e.heightSegments)}}const fi={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_NORMALMAP_TANGENTSPACE\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal, vNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, vec2 fullSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\t\n\t\tvec2 lodFudge = pow( 1.95, lod ) / fullSize;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec2 fullSize = vec2( textureSize( sampler, 0 ) );\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), fullSize, floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), fullSize, ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#ifdef USE_UV\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_UV2\n\tattribute vec2 uv2;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},ot={common:{diffuse:{value:new Le(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ai},alphaMap:{value:null},alphaMapTransform:{value:new Ai},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ai}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ai}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ai}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ai},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ai},normalScale:{value:new fe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ai},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ai}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ai}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ai}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Le(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Le(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ai}},sprite:{diffuse:{value:new Le(16777215)},opacity:{value:1},center:{value:new fe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ai},alphaMap:{value:null},alphaTest:{value:0}}},To={basic:{uniforms:ds([ot.common,ot.specularmap,ot.envmap,ot.aomap,ot.lightmap,ot.fog]),vertexShader:fi.meshbasic_vert,fragmentShader:fi.meshbasic_frag},lambert:{uniforms:ds([ot.common,ot.specularmap,ot.envmap,ot.aomap,ot.lightmap,ot.emissivemap,ot.bumpmap,ot.normalmap,ot.displacementmap,ot.fog,ot.lights,{emissive:{value:new Le(0)}}]),vertexShader:fi.meshlambert_vert,fragmentShader:fi.meshlambert_frag},phong:{uniforms:ds([ot.common,ot.specularmap,ot.envmap,ot.aomap,ot.lightmap,ot.emissivemap,ot.bumpmap,ot.normalmap,ot.displacementmap,ot.fog,ot.lights,{emissive:{value:new Le(0)},specular:{value:new Le(1118481)},shininess:{value:30}}]),vertexShader:fi.meshphong_vert,fragmentShader:fi.meshphong_frag},standard:{uniforms:ds([ot.common,ot.envmap,ot.aomap,ot.lightmap,ot.emissivemap,ot.bumpmap,ot.normalmap,ot.displacementmap,ot.roughnessmap,ot.metalnessmap,ot.fog,ot.lights,{emissive:{value:new Le(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:fi.meshphysical_vert,fragmentShader:fi.meshphysical_frag},toon:{uniforms:ds([ot.common,ot.aomap,ot.lightmap,ot.emissivemap,ot.bumpmap,ot.normalmap,ot.displacementmap,ot.gradientmap,ot.fog,ot.lights,{emissive:{value:new Le(0)}}]),vertexShader:fi.meshtoon_vert,fragmentShader:fi.meshtoon_frag},matcap:{uniforms:ds([ot.common,ot.bumpmap,ot.normalmap,ot.displacementmap,ot.fog,{matcap:{value:null}}]),vertexShader:fi.meshmatcap_vert,fragmentShader:fi.meshmatcap_frag},points:{uniforms:ds([ot.points,ot.fog]),vertexShader:fi.points_vert,fragmentShader:fi.points_frag},dashed:{uniforms:ds([ot.common,ot.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:fi.linedashed_vert,fragmentShader:fi.linedashed_frag},depth:{uniforms:ds([ot.common,ot.displacementmap]),vertexShader:fi.depth_vert,fragmentShader:fi.depth_frag},normal:{uniforms:ds([ot.common,ot.bumpmap,ot.normalmap,ot.displacementmap,{opacity:{value:1}}]),vertexShader:fi.meshnormal_vert,fragmentShader:fi.meshnormal_frag},sprite:{uniforms:ds([ot.sprite,ot.fog]),vertexShader:fi.sprite_vert,fragmentShader:fi.sprite_frag},background:{uniforms:{uvTransform:{value:new Ai},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:fi.background_vert,fragmentShader:fi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:fi.backgroundCube_vert,fragmentShader:fi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:fi.cube_vert,fragmentShader:fi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:fi.equirect_vert,fragmentShader:fi.equirect_frag},distanceRGBA:{uniforms:ds([ot.common,ot.displacementmap,{referencePosition:{value:new R},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:fi.distanceRGBA_vert,fragmentShader:fi.distanceRGBA_frag},shadow:{uniforms:ds([ot.lights,ot.fog,{color:{value:new Le(0)},opacity:{value:1}}]),vertexShader:fi.shadow_vert,fragmentShader:fi.shadow_frag}};To.physical={uniforms:ds([To.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ai},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ai},clearcoatNormalScale:{value:new fe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ai},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ai},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ai},sheen:{value:0},sheenColor:{value:new Le(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ai},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ai},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ai},transmissionSamplerSize:{value:new fe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ai},attenuationDistance:{value:0},attenuationColor:{value:new Le(0)},specularColor:{value:new Le(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ai},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ai}}]),vertexShader:fi.meshphysical_vert,fragmentShader:fi.meshphysical_frag};const sx={r:0,b:0,g:0};function $se(i,e,t,n,r,s,o){const a=new Le(0);let c,d,l=!0===s?0:1,u=null,h=0,f=null;function _(g,p){g.getRGB(sx,xU(i)),n.buffers.color.setClear(sx.r,sx.g,sx.b,p,o)}return{getClearColor:function(){return a},setClearColor:function(g,p=1){a.set(g),l=p,_(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,_(a,l)},render:function m(g,p){let v=!1,b=!0===p.isScene?p.background:null;b&&b.isTexture&&(b=(p.backgroundBlurriness>0?t:e).get(b));const y=i.xr,x=y.getSession&&y.getSession();x&&"additive"===x.environmentBlendMode&&(b=null),null===b?_(a,l):b&&b.isColor&&(_(b,1),v=!0),(i.autoClear||v)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),b&&(b.isCubeTexture||b.mapping===Sf)?(void 0===d&&(d=new nt(new tn(1,1,1),new Pt({name:"BackgroundCubeMaterial",uniforms:$f(To.backgroundCube.uniforms),vertexShader:To.backgroundCube.vertexShader,fragmentShader:To.backgroundCube.fragmentShader,side:Hr,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(w,E,S){this.matrixWorld.copyPosition(S.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(d)),d.material.uniforms.envMap.value=b,d.material.uniforms.flipEnvMap.value=b.isCubeTexture&&!1===b.isRenderTargetTexture?-1:1,d.material.uniforms.backgroundBlurriness.value=p.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=p.backgroundIntensity,d.material.toneMapped=b.encoding!==ui,(u!==b||h!==b.version||f!==i.toneMapping)&&(d.material.needsUpdate=!0,u=b,h=b.version,f=i.toneMapping),d.layers.enableAll(),g.unshift(d,d.geometry,d.material,0,0,null)):b&&b.isTexture&&(void 0===c&&(c=new nt(new Ac(2,2),new Pt({name:"BackgroundMaterial",uniforms:$f(To.background.uniforms),vertexShader:To.background.vertexShader,fragmentShader:To.background.fragmentShader,side:Da,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=b,c.material.uniforms.backgroundIntensity.value=p.backgroundIntensity,c.material.toneMapped=b.encoding!==ui,!0===b.matrixAutoUpdate&&b.updateMatrix(),c.material.uniforms.uvTransform.value.copy(b.matrix),(u!==b||h!==b.version||f!==i.toneMapping)&&(c.material.needsUpdate=!0,u=b,h=b.version,f=i.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}}}function Jse(i,e,t,n){const r=i.getParameter(34921),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),o=n.isWebGL2||null!==s,a={},l=g(null);let c=l,d=!1;function f(j){return n.isWebGL2?i.bindVertexArray(j):s.bindVertexArrayOES(j)}function m(j){return n.isWebGL2?i.deleteVertexArray(j):s.deleteVertexArrayOES(j)}function g(j){const H=[],B=[],V=[];for(let O=0;O<r;O++)H[O]=0,B[O]=0,V[O]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:H,enabledAttributes:B,attributeDivisors:V,object:j,attributes:{},index:null}}function b(){const j=c.newAttributes;for(let H=0,B=j.length;H<B;H++)j[H]=0}function y(j){x(j,0)}function x(j,H){const V=c.enabledAttributes,O=c.attributeDivisors;c.newAttributes[j]=1,0===V[j]&&(i.enableVertexAttribArray(j),V[j]=1),O[j]!==H&&((n.isWebGL2?i:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](j,H),O[j]=H)}function w(){const j=c.newAttributes,H=c.enabledAttributes;for(let B=0,V=H.length;B<V;B++)H[B]!==j[B]&&(i.disableVertexAttribArray(B),H[B]=0)}function E(j,H,B,V,O,Q){!0!==n.isWebGL2||5124!==B&&5125!==B?i.vertexAttribPointer(j,H,B,V,O,Q):i.vertexAttribIPointer(j,H,B,O,Q)}function U(){L(),d=!0,c!==l&&(c=l,f(c.object))}function L(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function u(j,H,B,V,O){let Q=!1;if(o){const oe=function _(j,H,B){const V=!0===B.wireframe;let O=a[j.id];void 0===O&&(O={},a[j.id]=O);let Q=O[H.id];void 0===Q&&(Q={},O[H.id]=Q);let oe=Q[V];return void 0===oe&&(oe=g(function h(){return n.isWebGL2?i.createVertexArray():s.createVertexArrayOES()}()),Q[V]=oe),oe}(V,B,H);c!==oe&&(c=oe,f(c.object)),Q=function p(j,H,B,V){const O=c.attributes,Q=H.attributes;let oe=0;const be=B.getAttributes();for(const de in be)if(be[de].location>=0){const Y=O[de];let re=Q[de];if(void 0===re&&("instanceMatrix"===de&&j.instanceMatrix&&(re=j.instanceMatrix),"instanceColor"===de&&j.instanceColor&&(re=j.instanceColor)),void 0===Y||Y.attribute!==re||re&&Y.data!==re.data)return!0;oe++}return c.attributesNum!==oe||c.index!==V}(j,V,B,O),Q&&function v(j,H,B,V){const O={},Q=H.attributes;let oe=0;const be=B.getAttributes();for(const de in be)if(be[de].location>=0){let Y=Q[de];void 0===Y&&("instanceMatrix"===de&&j.instanceMatrix&&(Y=j.instanceMatrix),"instanceColor"===de&&j.instanceColor&&(Y=j.instanceColor));const re={};re.attribute=Y,Y&&Y.data&&(re.data=Y.data),O[de]=re,oe++}c.attributes=O,c.attributesNum=oe,c.index=V}(j,V,B,O)}else{const oe=!0===H.wireframe;(c.geometry!==V.id||c.program!==B.id||c.wireframe!==oe)&&(c.geometry=V.id,c.program=B.id,c.wireframe=oe,Q=!0)}null!==O&&t.update(O,34963),(Q||d)&&(d=!1,function S(j,H,B,V){if(!1===n.isWebGL2&&(j.isInstancedMesh||V.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;b();const O=V.attributes,Q=B.getAttributes(),oe=H.defaultAttributeValues;for(const be in Q){const de=Q[be];if(de.location>=0){let X=O[be];if(void 0===X&&("instanceMatrix"===be&&j.instanceMatrix&&(X=j.instanceMatrix),"instanceColor"===be&&j.instanceColor&&(X=j.instanceColor)),void 0!==X){const Y=X.normalized,re=X.itemSize,J=t.get(X);if(void 0===J)continue;const D=J.buffer,ue=J.type,Ee=J.bytesPerElement;if(X.isInterleavedBufferAttribute){const me=X.data,qe=me.stride,Me=X.offset;if(me.isInstancedInterleavedBuffer){for(let we=0;we<de.locationSize;we++)x(de.location+we,me.meshPerAttribute);!0!==j.isInstancedMesh&&void 0===V._maxInstanceCount&&(V._maxInstanceCount=me.meshPerAttribute*me.count)}else for(let we=0;we<de.locationSize;we++)y(de.location+we);i.bindBuffer(34962,D);for(let we=0;we<de.locationSize;we++)E(de.location+we,re/de.locationSize,ue,Y,qe*Ee,(Me+re/de.locationSize*we)*Ee)}else{if(X.isInstancedBufferAttribute){for(let me=0;me<de.locationSize;me++)x(de.location+me,X.meshPerAttribute);!0!==j.isInstancedMesh&&void 0===V._maxInstanceCount&&(V._maxInstanceCount=X.meshPerAttribute*X.count)}else for(let me=0;me<de.locationSize;me++)y(de.location+me);i.bindBuffer(34962,D);for(let me=0;me<de.locationSize;me++)E(de.location+me,re/de.locationSize,ue,Y,re*Ee,re/de.locationSize*me*Ee)}}else if(void 0!==oe){const Y=oe[be];if(void 0!==Y)switch(Y.length){case 2:i.vertexAttrib2fv(de.location,Y);break;case 3:i.vertexAttrib3fv(de.location,Y);break;case 4:i.vertexAttrib4fv(de.location,Y);break;default:i.vertexAttrib1fv(de.location,Y)}}}}w()}(j,H,B,V),null!==O&&i.bindBuffer(34963,t.get(O).buffer))},reset:U,resetDefaultState:L,dispose:function C(){U();for(const j in a){const H=a[j];for(const B in H){const V=H[B];for(const O in V)m(V[O].object),delete V[O];delete H[B]}delete a[j]}},releaseStatesOfGeometry:function T(j){if(void 0===a[j.id])return;const H=a[j.id];for(const B in H){const V=H[B];for(const O in V)m(V[O].object),delete V[O];delete H[B]}delete a[j.id]},releaseStatesOfProgram:function k(j){for(const H in a){const B=a[H];if(void 0===B[j.id])continue;const V=B[j.id];for(const O in V)m(V[O].object),delete V[O];delete B[j.id]}},initAttributes:b,enableAttribute:y,disableUnusedAttributes:w}}function eoe(i,e,t,n){const r=n.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,d){i.drawArrays(s,c,d),t.update(d,s,1)},this.renderInstances=function l(c,d,u){if(0===u)return;let h,f;if(r)h=i,f="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===h)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[f](s,c,d,u),t.update(d,s,u)}}function toe(i,e,t){let n;function s(E){if("highp"===E){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";E="mediump"}return"mediump"===E&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===i.constructor.name;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),d=!0===t.logarithmicDepthBuffer,u=i.getParameter(34930),h=i.getParameter(35660),f=i.getParameter(3379),m=i.getParameter(34076),_=i.getParameter(34921),g=i.getParameter(36347),p=i.getParameter(36348),v=i.getParameter(36349),b=h>0,y=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==n)return n;if(!0===e.has("EXT_texture_filter_anisotropic")){const E=e.get("EXT_texture_filter_anisotropic");n=i.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:d,maxTextures:u,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:m,maxAttributes:_,maxVertexUniforms:g,maxVaryings:p,maxFragmentUniforms:v,vertexTextures:b,floatFragmentTextures:y,floatVertexTextures:b&&y,maxSamples:o?i.getParameter(36183):0}}function ioe(i){const e=this;let t=null,n=0,r=!1,s=!1;const o=new oo,a=new Ai,l={value:null,needsUpdate:!1};function d(u,h,f,m){const _=null!==u?u.length:0;let g=null;if(0!==_){if(g=l.value,!0!==m||null===g){const p=f+4*_,v=h.matrixWorldInverse;a.getNormalMatrix(v),(null===g||g.length<p)&&(g=new Float32Array(p));for(let b=0,y=f;b!==_;++b,y+=4)o.copy(u[b]).applyMatrix4(v,a),o.normal.toArray(g,y),g[y+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,g}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,h){const f=0!==u.length||h||0!==n||r;return r=h,n=u.length,f},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(u,h){t=d(u,h,0)},this.setState=function(u,h,f){const m=u.clippingPlanes,_=u.clipIntersection,g=u.clipShadows,p=i.get(u);if(!r||null===m||0===m.length||s&&!g)s?d(null):function c(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}();else{const v=s?0:n,b=4*v;let y=p.clippingState||null;l.value=y,y=d(m,h,b,f);for(let x=0;x!==b;++x)y[x]=t[x];p.clippingState=y,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=v}}}function noe(i){let e=new WeakMap;function t(o,a){return a===Ef?o.mapping=cc:a===Z_&&(o.mapping=dc),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function n(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(a===Ef||a===Z_){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new wU(l.height/2);return c.fromEquirectangularTexture(i,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class La extends ix{constructor(e=-1,t=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,o=n+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=d*this.view.offsetY,l=a-d*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const MU=[.125,.215,.35,.446,.526,.582],KT=new La,EU=new Le;let $T=null;const iu=(1+Math.sqrt(5))/2,ip=1/iu,SU=[new R(1,1,1),new R(-1,1,1),new R(1,1,-1),new R(-1,1,-1),new R(0,iu,ip),new R(0,iu,-ip),new R(ip,0,iu),new R(-ip,0,iu),new R(iu,ip,0),new R(-iu,ip,0)];class JT{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){$T=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=IU(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=RU(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget($T),e.scissorTest=!1,ox(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===cc||e.mapping===dc?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),$T=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Ui,minFilter:Ui,generateMipmaps:!1,type:mn,format:Rn,encoding:$s,depthBuffer:!1},r=TU(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=TU(e,t,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function roe(i){const e=[],t=[],n=[];let r=i;const s=i-4+1+MU.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>i-4?l=MU[o-i+4-1]:0===o&&(l=0),n.push(l);const c=1/(a-2),d=-c,u=1+c,h=[d,d,u,d,u,u,d,d,u,u,d,u],f=6,m=6,_=3,g=2,p=1,v=new Float32Array(_*m*f),b=new Float32Array(g*m*f),y=new Float32Array(p*m*f);for(let w=0;w<f;w++){const E=w%3*2/3-1,S=w>2?0:-1;v.set([E,S,0,E+2/3,S,0,E+2/3,S+1,0,E,S,0,E+2/3,S+1,0,E,S+1,0],_*m*w),b.set(h,g*m*w),y.set([w,w,w,w,w,w],p*m*w)}const x=new Mt;x.setAttribute("position",new Mi(v,_)),x.setAttribute("uv",new Mi(b,g)),x.setAttribute("faceIndex",new Mi(y,p)),e.push(x),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}(s)),this._blurMaterial=function soe(i,e,t){const n=new Float32Array(20),r=new R(0,1,0);return new Pt({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:Kt,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new nt(this._lodPlanes[0],e);this._renderer.compile(t,KT)}_sceneToCubeUV(e,t,n,r){const a=new In(90,1,t,n),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],d=this._renderer,u=d.autoClear,h=d.toneMapping;d.getClearColor(EU),d.toneMapping=ka,d.autoClear=!1;const f=new $n({name:"PMREM.Background",side:Hr,depthWrite:!1,depthTest:!1}),m=new nt(new tn,f);let _=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,_=!0):(f.color.copy(EU),_=!0);for(let p=0;p<6;p++){const v=p%3;0===v?(a.up.set(0,l[p],0),a.lookAt(c[p],0,0)):1===v?(a.up.set(0,0,l[p]),a.lookAt(0,c[p],0)):(a.up.set(0,l[p],0),a.lookAt(0,0,c[p]));const b=this._cubeSize;ox(r,v*b,p>2?b:0,b,b),d.setRenderTarget(r),_&&d.render(m,a),d.render(e,a)}m.geometry.dispose(),m.material.dispose(),d.toneMapping=h,d.autoClear=u,e.background=g}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===cc||e.mapping===dc;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=IU()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=RU());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new nt(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;ox(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(o,KT)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,SU[(r-1)%SU.length])}t.autoClear=n}_blur(e,t,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const u=new nt(this._lodPlanes[r],c),h=c.uniforms,f=this._sizeLods[n]-1,m=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,_=s/m,g=isFinite(s)?1+Math.floor(3*_):20;g>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const p=[];let v=0;for(let E=0;E<20;++E){const S=E/_,C=Math.exp(-S*S/2);p.push(C),0===E?v+=C:E<g&&(v+=2*C)}for(let E=0;E<p.length;E++)p[E]=p[E]/v;h.envMap.value=e.texture,h.samples.value=g,h.weights.value=p,h.latitudinal.value="latitudinal"===o,a&&(h.poleAxis.value=a);const{_lodMax:b}=this;h.dTheta.value=m,h.mipInt.value=b-n;const y=this._sizeLods[r];ox(t,3*y*(r>b-4?r-b+4:0),4*(this._cubeSize-y),3*y,2*y),l.setRenderTarget(t),l.render(u,KT)}}function TU(i,e,t){const n=new Gt(i,e,t);return n.texture.mapping=Sf,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function ox(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function RU(){return new Pt({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:Kt,depthTest:!1,depthWrite:!1})}function IU(){return new Pt({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:Kt,depthTest:!1,depthWrite:!1})}function ooe(i){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function n(a){if(a&&a.isTexture){const l=a.mapping,c=l===Ef||l===Z_,d=l===cc||l===dc;if(c||d){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let u=e.get(a);return null===t&&(t=new JT(i)),u=c?t.fromEquirectangular(a,u):t.fromCubemap(a,u),e.set(a,u),u.texture}if(e.has(a))return e.get(a).texture;{const u=a.image;if(c&&u&&u.height>0||d&&u&&function r(a){let l=0;for(let d=0;d<6;d++)void 0!==a[d]&&l++;return 6===l}(u)){null===t&&(t=new JT(i));const h=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function aoe(i){const e={};function t(n){if(void 0!==e[n])return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return{has:function(n){return null!==t(n)},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const r=t(n);return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function loe(i,e,t,n){const r={},s=new WeakMap;function o(u){const h=u.target;null!==h.index&&e.remove(h.index);for(const m in h.attributes)e.remove(h.attributes[m]);h.removeEventListener("dispose",o),delete r[h.id];const f=s.get(h);f&&(e.remove(f),s.delete(h)),n.releaseStatesOfGeometry(h),!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount,t.memory.geometries--}function c(u){const h=[],f=u.index,m=u.attributes.position;let _=0;if(null!==f){const v=f.array;_=f.version;for(let b=0,y=v.length;b<y;b+=3){const x=v[b+0],w=v[b+1],E=v[b+2];h.push(x,w,w,E,E,x)}}else{_=m.version;for(let b=0,y=m.array.length/3-1;b<y;b+=3){const x=b+0,w=b+1,E=b+2;h.push(x,w,w,E,E,x)}}const g=new(oU(h)?qy:Wy)(h,1);g.version=_;const p=s.get(u);p&&e.remove(p),s.set(u,g)}return{get:function a(u,h){return!0===r[h.id]||(h.addEventListener("dispose",o),r[h.id]=!0,t.memory.geometries++),h},update:function l(u){const h=u.attributes;for(const m in h)e.update(h[m],34962);const f=u.morphAttributes;for(const m in f){const _=f[m];for(let g=0,p=_.length;g<p;g++)e.update(_[g],34962)}},getWireframeAttribute:function d(u){const h=s.get(u);if(h){const f=u.index;null!==f&&h.version<f.version&&c(u)}else c(u);return s.get(u)}}}function coe(i,e,t,n){const r=n.isWebGL2;let s,a,l;this.setMode=function o(h){s=h},this.setIndex=function c(h){a=h.type,l=h.bytesPerElement},this.render=function d(h,f){i.drawElements(s,f,a,h*l),t.update(f,s,1)},this.renderInstances=function u(h,f,m){if(0===m)return;let _,g;if(r)_=i,g="drawElementsInstanced";else if(_=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",null===_)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");_[g](s,f,a,h*l,m),t.update(f,s,m)}}function doe(i){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function n(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function uoe(i,e){return i[0]-e[0]}function hoe(i,e){return Math.abs(e[1])-Math.abs(i[1])}function foe(i,e,t){const n={},r=new Float32Array(8),s=new WeakMap,o=new ii,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,d,u){const h=c.morphTargetInfluences;if(!0===e.isWebGL2){const f=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,m=void 0!==f?f.length:0;let _=s.get(d);if(void 0===_||_.count!==m){let j=function(){U.dispose(),s.delete(d),d.removeEventListener("dispose",j)};void 0!==_&&_.texture.dispose();const v=void 0!==d.morphAttributes.position,b=void 0!==d.morphAttributes.normal,y=void 0!==d.morphAttributes.color,x=d.morphAttributes.position||[],w=d.morphAttributes.normal||[],E=d.morphAttributes.color||[];let S=0;!0===v&&(S=1),!0===b&&(S=2),!0===y&&(S=3);let C=d.attributes.position.count*S,T=1;C>e.maxTextureSize&&(T=Math.ceil(C/e.maxTextureSize),C=e.maxTextureSize);const k=new Float32Array(C*T*4*m),U=new lb(k,C,T,m);U.type=Un,U.needsUpdate=!0;const L=4*S;for(let H=0;H<m;H++){const B=x[H],V=w[H],O=E[H],Q=C*T*4*H;for(let oe=0;oe<B.count;oe++){const be=oe*L;!0===v&&(o.fromBufferAttribute(B,oe),k[Q+be+0]=o.x,k[Q+be+1]=o.y,k[Q+be+2]=o.z,k[Q+be+3]=0),!0===b&&(o.fromBufferAttribute(V,oe),k[Q+be+4]=o.x,k[Q+be+5]=o.y,k[Q+be+6]=o.z,k[Q+be+7]=0),!0===y&&(o.fromBufferAttribute(O,oe),k[Q+be+8]=o.x,k[Q+be+9]=o.y,k[Q+be+10]=o.z,k[Q+be+11]=4===O.itemSize?o.w:1)}}_={count:m,texture:U,size:new fe(C,T)},s.set(d,_),d.addEventListener("dispose",j)}let g=0;for(let v=0;v<h.length;v++)g+=h[v];const p=d.morphTargetsRelative?1:1-g;u.getUniforms().setValue(i,"morphTargetBaseInfluence",p),u.getUniforms().setValue(i,"morphTargetInfluences",h),u.getUniforms().setValue(i,"morphTargetsTexture",_.texture,t),u.getUniforms().setValue(i,"morphTargetsTextureSize",_.size)}else{const f=void 0===h?0:h.length;let m=n[d.id];if(void 0===m||m.length!==f){m=[];for(let b=0;b<f;b++)m[b]=[b,0];n[d.id]=m}for(let b=0;b<f;b++){const y=m[b];y[0]=b,y[1]=h[b]}m.sort(hoe);for(let b=0;b<8;b++)b<f&&m[b][1]?(a[b][0]=m[b][0],a[b][1]=m[b][1]):(a[b][0]=Number.MAX_SAFE_INTEGER,a[b][1]=0);a.sort(uoe);const _=d.morphAttributes.position,g=d.morphAttributes.normal;let p=0;for(let b=0;b<8;b++){const y=a[b],x=y[0],w=y[1];x!==Number.MAX_SAFE_INTEGER&&w?(_&&d.getAttribute("morphTarget"+b)!==_[x]&&d.setAttribute("morphTarget"+b,_[x]),g&&d.getAttribute("morphNormal"+b)!==g[x]&&d.setAttribute("morphNormal"+b,g[x]),r[b]=w,p+=w):(_&&!0===d.hasAttribute("morphTarget"+b)&&d.deleteAttribute("morphTarget"+b),g&&!0===d.hasAttribute("morphNormal"+b)&&d.deleteAttribute("morphNormal"+b),r[b]=0)}const v=d.morphTargetsRelative?1:1-p;u.getUniforms().setValue(i,"morphTargetBaseInfluence",v),u.getUniforms().setValue(i,"morphTargetInfluences",r)}}}}function poe(i,e,t,n){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=n.render.frame,u=e.get(l,l.geometry);return r.get(u)!==c&&(e.update(u),r.set(u,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),null!==l.instanceColor&&t.update(l.instanceColor,34962)),u},dispose:function o(){r=new WeakMap}}}const DU=new An,PU=new lb,kU=new cb,BU=new Jd,LU=[],FU=[],OU=new Float32Array(16),NU=new Float32Array(9),jU=new Float32Array(4);function np(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=LU[r];if(void 0===s&&(s=new Float32Array(r),LU[r]=s),0!==e){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,i[o].toArray(s,a)}return s}function br(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function vr(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function ax(i,e){let t=FU[e];void 0===t&&(t=new Int32Array(e),FU[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function moe(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function goe(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(br(t,e))return;i.uniform2fv(this.addr,e),vr(t,e)}}function _oe(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(br(t,e))return;i.uniform3fv(this.addr,e),vr(t,e)}}function boe(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(br(t,e))return;i.uniform4fv(this.addr,e),vr(t,e)}}function voe(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(br(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),vr(t,e)}else{if(br(t,n))return;jU.set(n),i.uniformMatrix2fv(this.addr,!1,jU),vr(t,n)}}function Aoe(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(br(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),vr(t,e)}else{if(br(t,n))return;NU.set(n),i.uniformMatrix3fv(this.addr,!1,NU),vr(t,n)}}function yoe(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(br(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),vr(t,e)}else{if(br(t,n))return;OU.set(n),i.uniformMatrix4fv(this.addr,!1,OU),vr(t,n)}}function xoe(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function woe(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(br(t,e))return;i.uniform2iv(this.addr,e),vr(t,e)}}function Coe(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(br(t,e))return;i.uniform3iv(this.addr,e),vr(t,e)}}function Moe(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(br(t,e))return;i.uniform4iv(this.addr,e),vr(t,e)}}function Eoe(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function Soe(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(br(t,e))return;i.uniform2uiv(this.addr,e),vr(t,e)}}function Toe(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(br(t,e))return;i.uniform3uiv(this.addr,e),vr(t,e)}}function Roe(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(br(t,e))return;i.uniform4uiv(this.addr,e),vr(t,e)}}function Ioe(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2D(e||DU,r)}function Doe(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||kU,r)}function Poe(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||BU,r)}function koe(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||PU,r)}function Loe(i,e){i.uniform1fv(this.addr,e)}function Foe(i,e){const t=np(e,this.size,2);i.uniform2fv(this.addr,t)}function Ooe(i,e){const t=np(e,this.size,3);i.uniform3fv(this.addr,t)}function Noe(i,e){const t=np(e,this.size,4);i.uniform4fv(this.addr,t)}function joe(i,e){const t=np(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function Uoe(i,e){const t=np(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function Voe(i,e){const t=np(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function zoe(i,e){i.uniform1iv(this.addr,e)}function Goe(i,e){i.uniform2iv(this.addr,e)}function Hoe(i,e){i.uniform3iv(this.addr,e)}function Qoe(i,e){i.uniform4iv(this.addr,e)}function Woe(i,e){i.uniform1uiv(this.addr,e)}function qoe(i,e){i.uniform2uiv(this.addr,e)}function Yoe(i,e){i.uniform3uiv(this.addr,e)}function Xoe(i,e){i.uniform4uiv(this.addr,e)}function Zoe(i,e,t){const n=this.cache,r=e.length,s=ax(t,r);br(n,s)||(i.uniform1iv(this.addr,s),vr(n,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||DU,s[o])}function Koe(i,e,t){const n=this.cache,r=e.length,s=ax(t,r);br(n,s)||(i.uniform1iv(this.addr,s),vr(n,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||kU,s[o])}function $oe(i,e,t){const n=this.cache,r=e.length,s=ax(t,r);br(n,s)||(i.uniform1iv(this.addr,s),vr(n,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||BU,s[o])}function Joe(i,e,t){const n=this.cache,r=e.length,s=ax(t,r);br(n,s)||(i.uniform1iv(this.addr,s),vr(n,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||PU,s[o])}class tae{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function Boe(i){switch(i){case 5126:return moe;case 35664:return goe;case 35665:return _oe;case 35666:return boe;case 35674:return voe;case 35675:return Aoe;case 35676:return yoe;case 5124:case 35670:return xoe;case 35667:case 35671:return woe;case 35668:case 35672:return Coe;case 35669:case 35673:return Moe;case 5125:return Eoe;case 36294:return Soe;case 36295:return Toe;case 36296:return Roe;case 35678:case 36198:case 36298:case 36306:case 35682:return Ioe;case 35679:case 36299:case 36307:return Doe;case 35680:case 36300:case 36308:case 36293:return Poe;case 36289:case 36303:case 36311:case 36292:return koe}}(t.type)}}class iae{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function eae(i){switch(i){case 5126:return Loe;case 35664:return Foe;case 35665:return Ooe;case 35666:return Noe;case 35674:return joe;case 35675:return Uoe;case 35676:return Voe;case 5124:case 35670:return zoe;case 35667:case 35671:return Goe;case 35668:case 35672:return Hoe;case 35669:case 35673:return Qoe;case 5125:return Woe;case 36294:return qoe;case 36295:return Yoe;case 36296:return Xoe;case 35678:case 36198:case 36298:case 36306:case 35682:return Zoe;case 35679:case 36299:case 36307:return Koe;case 35680:case 36300:case 36308:case 36293:return $oe;case 36289:case 36303:case 36311:case 36292:return Joe}}(t.type)}}class nae{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],n)}}}const tR=/(\w+)(\])?(\[|\.)?/g;function UU(i,e){i.seq.push(e),i.map[e.id]=e}function rae(i,e,t){const n=i.name,r=n.length;for(tR.lastIndex=0;;){const s=tR.exec(n);let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&tR.lastIndex+2===r){UU(t,void 0===c?new tae(a,i,e):new iae(a,i,e));break}{let u=t.map[a];void 0===u&&(u=new nae(a),UU(t,u)),t=u}}}class lx{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,35718);for(let r=0;r<n;++r){const s=e.getActiveUniform(t,r);rae(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,n,r){const s=this.map[t];void 0!==s&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=n[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&n.push(o)}return n}}function VU(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}let sae=0;function zU(i,e,t){const n=i.getShaderParameter(e,35713),r=i.getShaderInfoLog(e).trim();if(n&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function oae(i,e){const t=i.split("\n"),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;n.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return n.join("\n")}(i.getShaderSource(e),o)}return r}function lae(i,e){const t=function aae(i){switch(i){case $s:return["Linear","( value )"];case ui:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}(e);return"vec4 "+i+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function cae(i,e){let t;switch(e){case Lj:t="Linear";break;case Fj:t="Reinhard";break;case Oj:t="OptimizedCineon";break;case Nj:t="ACESFilmic";break;case jj:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function gb(i){return""!==i}function GU(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function HU(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const fae=/^[ \t]*#include +<([\w\d./]+)>/gm;function iR(i){return i.replace(fae,pae)}function pae(i,e){const t=fi[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return iR(t)}const mae=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function QU(i){return i.replace(mae,gae)}function gae(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function WU(i){let e="precision "+i.precision+" float;\nprecision "+i.precision+" int;";return"highp"===i.precision?e+="\n#define HIGH_PRECISION":"mediump"===i.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===i.precision&&(e+="\n#define LOW_PRECISION"),e}function xae(i,e,t,n){const r=i.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function _ae(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===rT?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===bj?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===yf&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function bae(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case cc:case dc:e="ENVMAP_TYPE_CUBE";break;case Sf:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),d=function vae(i){let e="ENVMAP_MODE_REFLECTION";return i.envMap&&i.envMapMode===dc&&(e="ENVMAP_MODE_REFRACTION"),e}(t),u=function Aae(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case X_:e="ENVMAP_BLENDING_MULTIPLY";break;case kj:e="ENVMAP_BLENDING_MIX";break;case Bj:e="ENVMAP_BLENDING_ADD"}return e}(t),h=function yae(i){const e=i.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}(t),f=t.isWebGL2?"":function dae(i){return[i.extensionDerivatives||i.envMapCubeUVHeight||i.bumpMap||i.normalMapTangentSpace||i.clearcoatNormalMap||i.flatShading||"physical"===i.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(gb).join("\n")}(t),m=function uae(i){const e=[];for(const t in i){const n=i[t];!1!==n&&e.push("#define "+t+" "+n)}return e.join("\n")}(s),_=r.createProgram();let g,p,v=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(g=[m].filter(gb).join("\n"),g.length>0&&(g+="\n"),p=[f,m].filter(gb).join("\n"),p.length>0&&(p+="\n")):(g=[WU(t),"#define SHADER_NAME "+t.shaderName,m,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs2?"#define USE_UV2":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(gb).join("\n"),p=[f,WU(t),"#define SHADER_NAME "+t.shaderName,m,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+d:"",t.envMap?"#define "+u:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs2?"#define USE_UV2":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ka?"#define TONE_MAPPING":"",t.toneMapping!==ka?fi.tonemapping_pars_fragment:"",t.toneMapping!==ka?cae("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",fi.encodings_pars_fragment,lae("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(gb).join("\n")),o=iR(o),o=GU(o,t),o=HU(o,t),a=iR(a),a=GU(a,t),a=HU(a,t),o=QU(o),a=QU(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(v="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,p=["#define varying in",t.glslVersion===RT?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===RT?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+p);const y=v+p+a,x=VU(r,35633,v+g+o),w=VU(r,35632,y);if(r.attachShader(_,x),r.attachShader(_,w),void 0!==t.index0AttributeName?r.bindAttribLocation(_,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(_,0,"position"),r.linkProgram(_),i.debug.checkShaderErrors){const C=r.getProgramInfoLog(_).trim(),T=r.getShaderInfoLog(x).trim(),k=r.getShaderInfoLog(w).trim();let U=!0,L=!0;if(!1===r.getProgramParameter(_,35714))if(U=!1,"function"==typeof i.debug.onShaderError)i.debug.onShaderError(r,_,x,w);else{const j=zU(r,x,"vertex"),H=zU(r,w,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(_,35715)+"\n\nProgram Info Log: "+C+"\n"+j+"\n"+H)}else""!==C?console.warn("THREE.WebGLProgram: Program Info Log:",C):(""===T||""===k)&&(L=!1);L&&(this.diagnostics={runnable:U,programLog:C,vertexShader:{log:T,prefix:g},fragmentShader:{log:k,prefix:p}})}let E,S;return r.deleteShader(x),r.deleteShader(w),this.getUniforms=function(){return void 0===E&&(E=new lx(r,_)),E},this.getAttributes=function(){return void 0===S&&(S=function hae(i,e){const t={},n=i.getProgramParameter(e,35721);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),o=s.name;let a=1;35674===s.type&&(a=2),35675===s.type&&(a=3),35676===s.type&&(a=4),t[o]={type:s.type,location:i.getAttribLocation(e,o),locationSize:a}}return t}(r,_)),S},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(_),this.program=void 0},this.name=t.shaderName,this.id=sae++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=x,this.fragmentShader=w,this}let wae=0;class Cae{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new Mae(e),t.set(e,n)),n}}class Mae{constructor(e){this.id=wae++,this.code=e,this.usedTimes=0}}function Eae(i,e,t,n,r,s,o){const a=new Vy,l=new Cae,c=[],d=r.isWebGL2,u=r.logarithmicDepthBuffer,h=r.vertexTextures;let f=r.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(C){return 1===C?"uv2":"uv"}return{getParameters:function g(C,T,k,U,L){const j=U.fog,H=L.geometry,V=(C.isMeshStandardMaterial?t:e).get(C.envMap||(C.isMeshStandardMaterial?U.environment:null)),O=V&&V.mapping===Sf?V.image.height:null,Q=m[C.type];null!==C.precision&&(f=r.getMaxPrecision(C.precision),f!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",f,"instead."));const oe=H.morphAttributes.position||H.morphAttributes.normal||H.morphAttributes.color,be=void 0!==oe?oe.length:0;let X,Y,re,J,de=0;if(void 0!==H.morphAttributes.position&&(de=1),void 0!==H.morphAttributes.normal&&(de=2),void 0!==H.morphAttributes.color&&(de=3),Q){const mt=To[Q];X=mt.vertexShader,Y=mt.fragmentShader}else X=C.vertexShader,Y=C.fragmentShader,l.update(C),re=l.getVertexShaderID(C),J=l.getFragmentShaderID(C);const D=i.getRenderTarget(),ue=!0===L.isInstancedMesh,Ee=!!C.map,qe=!!V,Me=!!C.aoMap,we=!!C.lightMap,Se=!!C.bumpMap,it=!!C.normalMap,Xe=!!C.displacementMap,At=!!C.emissiveMap,yt=!!C.metalnessMap,lt=!!C.roughnessMap,ht=C.clearcoat>0,xt=C.iridescence>0,N=C.sheen>0,F=C.transmission>0,Ae=ht&&!!C.clearcoatMap,ke=ht&&!!C.clearcoatNormalMap,Ue=ht&&!!C.clearcoatRoughnessMap,et=xt&&!!C.iridescenceMap,Z=xt&&!!C.iridescenceThicknessMap,Ie=N&&!!C.sheenColorMap,ye=N&&!!C.sheenRoughnessMap,Je=!!C.specularMap,ct=!!C.specularColorMap,pt=!!C.specularIntensityMap,$e=F&&!!C.transmissionMap,tt=F&&!!C.thicknessMap,It=!!C.alphaMap,se=!!C.extensions,te=!!H.attributes.uv2;return{isWebGL2:d,shaderID:Q,shaderName:C.type,vertexShader:X,fragmentShader:Y,defines:C.defines,customVertexShaderID:re,customFragmentShaderID:J,isRawShaderMaterial:!0===C.isRawShaderMaterial,glslVersion:C.glslVersion,precision:f,instancing:ue,instancingColor:ue&&null!==L.instanceColor,supportsVertexTextures:h,outputEncoding:null===D?i.outputEncoding:!0===D.isXRRenderTarget?D.texture.encoding:$s,map:Ee,matcap:!!C.matcap,envMap:qe,envMapMode:qe&&V.mapping,envMapCubeUVHeight:O,aoMap:Me,lightMap:we,bumpMap:Se,normalMap:it,displacementMap:h&&Xe,emissiveMap:At,normalMapObjectSpace:it&&C.normalMapType===tU,normalMapTangentSpace:it&&C.normalMapType===mc,decodeVideoTexture:Ee&&!0===C.map.isVideoTexture&&C.map.encoding===ui,metalnessMap:yt,roughnessMap:lt,clearcoat:ht,clearcoatMap:Ae,clearcoatNormalMap:ke,clearcoatRoughnessMap:Ue,iridescence:xt,iridescenceMap:et,iridescenceThicknessMap:Z,sheen:N,sheenColorMap:Ie,sheenRoughnessMap:ye,specularMap:Je,specularColorMap:ct,specularIntensityMap:pt,transmission:F,transmissionMap:$e,thicknessMap:tt,gradientMap:!!C.gradientMap,opaque:!1===C.transparent&&C.blending===Pa,alphaMap:It,alphaTest:C.alphaTest>0,combine:C.combine,mapUv:Ee&&_(C.map.channel),aoMapUv:Me&&_(C.aoMap.channel),lightMapUv:we&&_(C.lightMap.channel),bumpMapUv:Se&&_(C.bumpMap.channel),normalMapUv:it&&_(C.normalMap.channel),displacementMapUv:Xe&&_(C.displacementMap.channel),emissiveMapUv:At&&_(C.emissiveMap.channel),metalnessMapUv:yt&&_(C.metalnessMap.channel),roughnessMapUv:lt&&_(C.roughnessMap.channel),clearcoatMapUv:Ae&&_(C.clearcoatMap.channel),clearcoatNormalMapUv:ke&&_(C.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ue&&_(C.clearcoatRoughnessMap.channel),iridescenceMapUv:et&&_(C.iridescenceMap.channel),iridescenceThicknessMapUv:Z&&_(C.iridescenceThicknessMap.channel),sheenColorMapUv:Ie&&_(C.sheenColorMap.channel),sheenRoughnessMapUv:ye&&_(C.sheenRoughnessMap.channel),specularMapUv:Je&&_(C.specularMap.channel),specularColorMapUv:ct&&_(C.specularColorMap.channel),specularIntensityMapUv:pt&&_(C.specularIntensityMap.channel),transmissionMapUv:$e&&_(C.transmissionMap.channel),thicknessMapUv:tt&&_(C.thicknessMap.channel),alphaMapUv:It&&_(C.alphaMap.channel),vertexTangents:it&&!!H.attributes.tangent,vertexColors:C.vertexColors,vertexAlphas:!0===C.vertexColors&&!!H.attributes.color&&4===H.attributes.color.itemSize,vertexUvs2:te,pointsUvs:!0===L.isPoints&&!!H.attributes.uv&&(Ee||It),fog:!!j,useFog:!0===C.fog,fogExp2:j&&j.isFogExp2,flatShading:!0===C.flatShading,sizeAttenuation:!0===C.sizeAttenuation,logarithmicDepthBuffer:u,skinning:!0===L.isSkinnedMesh,morphTargets:void 0!==H.morphAttributes.position,morphNormals:void 0!==H.morphAttributes.normal,morphColors:void 0!==H.morphAttributes.color,morphTargetsCount:be,morphTextureStride:de,numDirLights:T.directional.length,numPointLights:T.point.length,numSpotLights:T.spot.length,numSpotLightMaps:T.spotLightMap.length,numRectAreaLights:T.rectArea.length,numHemiLights:T.hemi.length,numDirLightShadows:T.directionalShadowMap.length,numPointLightShadows:T.pointShadowMap.length,numSpotLightShadows:T.spotShadowMap.length,numSpotLightShadowsWithMaps:T.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:C.dithering,shadowMapEnabled:i.shadowMap.enabled&&k.length>0,shadowMapType:i.shadowMap.type,toneMapping:C.toneMapped?i.toneMapping:ka,useLegacyLights:i.useLegacyLights,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===os,flipSided:C.side===Hr,useDepthPacking:C.depthPacking>=0,depthPacking:C.depthPacking||0,index0AttributeName:C.index0AttributeName,extensionDerivatives:se&&!0===C.extensions.derivatives,extensionFragDepth:se&&!0===C.extensions.fragDepth,extensionDrawBuffers:se&&!0===C.extensions.drawBuffers,extensionShaderTextureLOD:se&&!0===C.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||n.has("EXT_shader_texture_lod"),customProgramCacheKey:C.customProgramCacheKey()}},getProgramCacheKey:function p(C){const T=[];if(C.shaderID?T.push(C.shaderID):(T.push(C.customVertexShaderID),T.push(C.customFragmentShaderID)),void 0!==C.defines)for(const k in C.defines)T.push(k),T.push(C.defines[k]);return!1===C.isRawShaderMaterial&&(function v(C,T){C.push(T.precision),C.push(T.outputEncoding),C.push(T.envMapMode),C.push(T.envMapCubeUVHeight),C.push(T.mapUv),C.push(T.alphaMapUv),C.push(T.lightMapUv),C.push(T.aoMapUv),C.push(T.bumpMapUv),C.push(T.normalMapUv),C.push(T.displacementMapUv),C.push(T.emissiveMapUv),C.push(T.metalnessMapUv),C.push(T.roughnessMapUv),C.push(T.clearcoatMapUv),C.push(T.clearcoatNormalMapUv),C.push(T.clearcoatRoughnessMapUv),C.push(T.iridescenceMapUv),C.push(T.iridescenceThicknessMapUv),C.push(T.sheenColorMapUv),C.push(T.sheenRoughnessMapUv),C.push(T.specularMapUv),C.push(T.specularColorMapUv),C.push(T.specularIntensityMapUv),C.push(T.transmissionMapUv),C.push(T.thicknessMapUv),C.push(T.combine),C.push(T.fogExp2),C.push(T.sizeAttenuation),C.push(T.morphTargetsCount),C.push(T.morphAttributeCount),C.push(T.numDirLights),C.push(T.numPointLights),C.push(T.numSpotLights),C.push(T.numSpotLightMaps),C.push(T.numHemiLights),C.push(T.numRectAreaLights),C.push(T.numDirLightShadows),C.push(T.numPointLightShadows),C.push(T.numSpotLightShadows),C.push(T.numSpotLightShadowsWithMaps),C.push(T.shadowMapType),C.push(T.toneMapping),C.push(T.numClippingPlanes),C.push(T.numClipIntersection),C.push(T.depthPacking)}(T,C),function b(C,T){a.disableAll(),T.isWebGL2&&a.enable(0),T.supportsVertexTextures&&a.enable(1),T.instancing&&a.enable(2),T.instancingColor&&a.enable(3),T.matcap&&a.enable(4),T.envMap&&a.enable(5),T.normalMapObjectSpace&&a.enable(6),T.normalMapTangentSpace&&a.enable(7),T.clearcoat&&a.enable(8),T.iridescence&&a.enable(9),T.alphaTest&&a.enable(10),T.vertexColors&&a.enable(11),T.vertexAlphas&&a.enable(12),T.vertexUvs2&&a.enable(13),T.vertexTangents&&a.enable(14),C.push(a.mask),a.disableAll(),T.fog&&a.enable(0),T.useFog&&a.enable(1),T.flatShading&&a.enable(2),T.logarithmicDepthBuffer&&a.enable(3),T.skinning&&a.enable(4),T.morphTargets&&a.enable(5),T.morphNormals&&a.enable(6),T.morphColors&&a.enable(7),T.premultipliedAlpha&&a.enable(8),T.shadowMapEnabled&&a.enable(9),T.useLegacyLights&&a.enable(10),T.doubleSided&&a.enable(11),T.flipSided&&a.enable(12),T.useDepthPacking&&a.enable(13),T.dithering&&a.enable(14),T.transmission&&a.enable(15),T.sheen&&a.enable(16),T.decodeVideoTexture&&a.enable(17),T.opaque&&a.enable(18),T.pointsUvs&&a.enable(19),C.push(a.mask)}(T,C),T.push(i.outputEncoding)),T.push(C.customProgramCacheKey),T.join()},getUniforms:function y(C){const T=m[C.type];let k;return k=T?gi.clone(To[T].uniforms):C.uniforms,k},acquireProgram:function x(C,T){let k;for(let U=0,L=c.length;U<L;U++){const j=c[U];if(j.cacheKey===T){k=j,++k.usedTimes;break}}return void 0===k&&(k=new xae(i,T,C,s),c.push(k)),k},releaseProgram:function w(C){if(0==--C.usedTimes){const T=c.indexOf(C);c[T]=c[c.length-1],c.pop(),C.destroy()}},releaseShaderCache:function E(C){l.remove(C)},programs:c,dispose:function S(){l.dispose()}}}function Sae(){let i=new WeakMap;return{get:function e(s){let o=i.get(s);return void 0===o&&(o={},i.set(s,o)),o},remove:function t(s){i.delete(s)},update:function n(s,o,a){i.get(s)[o]=a},dispose:function r(){i=new WeakMap}}}function Tae(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function qU(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function YU(){const i=[];let e=0;const t=[],n=[],r=[];function o(u,h,f,m,_,g){let p=i[e];return void 0===p?(p={id:u.id,object:u,geometry:h,material:f,groupOrder:m,renderOrder:u.renderOrder,z:_,group:g},i[e]=p):(p.id=u.id,p.object=u,p.geometry=h,p.material=f,p.groupOrder=m,p.renderOrder=u.renderOrder,p.z=_,p.group=g),e++,p}return{opaque:t,transmissive:n,transparent:r,init:function s(){e=0,t.length=0,n.length=0,r.length=0},push:function a(u,h,f,m,_,g){const p=o(u,h,f,m,_,g);f.transmission>0?n.push(p):!0===f.transparent?r.push(p):t.push(p)},unshift:function l(u,h,f,m,_,g){const p=o(u,h,f,m,_,g);f.transmission>0?n.unshift(p):!0===f.transparent?r.unshift(p):t.unshift(p)},finish:function d(){for(let u=e,h=i.length;u<h;u++){const f=i[u];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function c(u,h){t.length>1&&t.sort(u||Tae),n.length>1&&n.sort(h||qU),r.length>1&&r.sort(h||qU)}}}function Rae(){let i=new WeakMap;return{get:function e(n,r){const s=i.get(n);let o;return void 0===s?(o=new YU,i.set(n,[o])):r>=s.length?(o=new YU,s.push(o)):o=s[r],o},dispose:function t(){i=new WeakMap}}}function Iae(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new R,color:new Le};break;case"SpotLight":t={position:new R,direction:new R,color:new Le,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new R,color:new Le,distance:0,decay:0};break;case"HemisphereLight":t={direction:new R,skyColor:new Le,groundColor:new Le};break;case"RectAreaLight":t={color:new Le,position:new R,halfWidth:new R,halfHeight:new R}}return i[e.id]=t,t}}}let Pae=0;function kae(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function Bae(i,e){const t=new Iae,n=function Dae(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new fe};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new fe,shadowCameraNear:1,shadowCameraFar:1e3}}return i[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let d=0;d<9;d++)r.probe.push(new R);const s=new R,o=new Qe,a=new Qe;return{setup:function l(d,u){let h=0,f=0,m=0;for(let k=0;k<9;k++)r.probe[k].set(0,0,0);let _=0,g=0,p=0,v=0,b=0,y=0,x=0,w=0,E=0,S=0;d.sort(kae);const C=!0===u?Math.PI:1;for(let k=0,U=d.length;k<U;k++){const L=d[k],j=L.color,H=L.intensity,B=L.distance,V=L.shadow&&L.shadow.map?L.shadow.map.texture:null;if(L.isAmbientLight)h+=j.r*H*C,f+=j.g*H*C,m+=j.b*H*C;else if(L.isLightProbe)for(let O=0;O<9;O++)r.probe[O].addScaledVector(L.sh.coefficients[O],H);else if(L.isDirectionalLight){const O=t.get(L);if(O.color.copy(L.color).multiplyScalar(L.intensity*C),L.castShadow){const Q=L.shadow,oe=n.get(L);oe.shadowBias=Q.bias,oe.shadowNormalBias=Q.normalBias,oe.shadowRadius=Q.radius,oe.shadowMapSize=Q.mapSize,r.directionalShadow[_]=oe,r.directionalShadowMap[_]=V,r.directionalShadowMatrix[_]=L.shadow.matrix,y++}r.directional[_]=O,_++}else if(L.isSpotLight){const O=t.get(L);O.position.setFromMatrixPosition(L.matrixWorld),O.color.copy(j).multiplyScalar(H*C),O.distance=B,O.coneCos=Math.cos(L.angle),O.penumbraCos=Math.cos(L.angle*(1-L.penumbra)),O.decay=L.decay,r.spot[p]=O;const Q=L.shadow;if(L.map&&(r.spotLightMap[E]=L.map,E++,Q.updateMatrices(L),L.castShadow&&S++),r.spotLightMatrix[p]=Q.matrix,L.castShadow){const oe=n.get(L);oe.shadowBias=Q.bias,oe.shadowNormalBias=Q.normalBias,oe.shadowRadius=Q.radius,oe.shadowMapSize=Q.mapSize,r.spotShadow[p]=oe,r.spotShadowMap[p]=V,w++}p++}else if(L.isRectAreaLight){const O=t.get(L);O.color.copy(j).multiplyScalar(H),O.halfWidth.set(.5*L.width,0,0),O.halfHeight.set(0,.5*L.height,0),r.rectArea[v]=O,v++}else if(L.isPointLight){const O=t.get(L);if(O.color.copy(L.color).multiplyScalar(L.intensity*C),O.distance=L.distance,O.decay=L.decay,L.castShadow){const Q=L.shadow,oe=n.get(L);oe.shadowBias=Q.bias,oe.shadowNormalBias=Q.normalBias,oe.shadowRadius=Q.radius,oe.shadowMapSize=Q.mapSize,oe.shadowCameraNear=Q.camera.near,oe.shadowCameraFar=Q.camera.far,r.pointShadow[g]=oe,r.pointShadowMap[g]=V,r.pointShadowMatrix[g]=L.shadow.matrix,x++}r.point[g]=O,g++}else if(L.isHemisphereLight){const O=t.get(L);O.skyColor.copy(L.color).multiplyScalar(H*C),O.groundColor.copy(L.groundColor).multiplyScalar(H*C),r.hemi[b]=O,b++}}v>0&&(e.isWebGL2||!0===i.has("OES_texture_float_linear")?(r.rectAreaLTC1=ot.LTC_FLOAT_1,r.rectAreaLTC2=ot.LTC_FLOAT_2):!0===i.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=ot.LTC_HALF_1,r.rectAreaLTC2=ot.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=f,r.ambient[2]=m;const T=r.hash;(T.directionalLength!==_||T.pointLength!==g||T.spotLength!==p||T.rectAreaLength!==v||T.hemiLength!==b||T.numDirectionalShadows!==y||T.numPointShadows!==x||T.numSpotShadows!==w||T.numSpotMaps!==E)&&(r.directional.length=_,r.spot.length=p,r.rectArea.length=v,r.point.length=g,r.hemi.length=b,r.directionalShadow.length=y,r.directionalShadowMap.length=y,r.pointShadow.length=x,r.pointShadowMap.length=x,r.spotShadow.length=w,r.spotShadowMap.length=w,r.directionalShadowMatrix.length=y,r.pointShadowMatrix.length=x,r.spotLightMatrix.length=w+E-S,r.spotLightMap.length=E,r.numSpotLightShadowsWithMaps=S,T.directionalLength=_,T.pointLength=g,T.spotLength=p,T.rectAreaLength=v,T.hemiLength=b,T.numDirectionalShadows=y,T.numPointShadows=x,T.numSpotShadows=w,T.numSpotMaps=E,r.version=Pae++)},setupView:function c(d,u){let h=0,f=0,m=0,_=0,g=0;const p=u.matrixWorldInverse;for(let v=0,b=d.length;v<b;v++){const y=d[v];if(y.isDirectionalLight){const x=r.directional[h];x.direction.setFromMatrixPosition(y.matrixWorld),s.setFromMatrixPosition(y.target.matrixWorld),x.direction.sub(s),x.direction.transformDirection(p),h++}else if(y.isSpotLight){const x=r.spot[m];x.position.setFromMatrixPosition(y.matrixWorld),x.position.applyMatrix4(p),x.direction.setFromMatrixPosition(y.matrixWorld),s.setFromMatrixPosition(y.target.matrixWorld),x.direction.sub(s),x.direction.transformDirection(p),m++}else if(y.isRectAreaLight){const x=r.rectArea[_];x.position.setFromMatrixPosition(y.matrixWorld),x.position.applyMatrix4(p),a.identity(),o.copy(y.matrixWorld),o.premultiply(p),a.extractRotation(o),x.halfWidth.set(.5*y.width,0,0),x.halfHeight.set(0,.5*y.height,0),x.halfWidth.applyMatrix4(a),x.halfHeight.applyMatrix4(a),_++}else if(y.isPointLight){const x=r.point[f];x.position.setFromMatrixPosition(y.matrixWorld),x.position.applyMatrix4(p),f++}else if(y.isHemisphereLight){const x=r.hemi[g];x.direction.setFromMatrixPosition(y.matrixWorld),x.direction.transformDirection(p),g++}}},state:r}}function XU(i,e){const t=new Bae(i,e),n=[],r=[];return{init:function s(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:t},setupLights:function l(u){t.setup(n,u)},setupLightsView:function c(u){t.setupView(n,u)},pushLight:function o(u){n.push(u)},pushShadow:function a(u){r.push(u)}}}function Lae(i,e){let t=new WeakMap;return{get:function n(s,o=0){const a=t.get(s);let l;return void 0===a?(l=new XU(i,e),t.set(s,[l])):o>=a.length?(l=new XU(i,e),a.push(l)):l=a[o],l},dispose:function r(){t=new WeakMap}}}class nu extends zn{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=eU,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class cx extends zn{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Nae(i,e,t){let n=new rx;const r=new fe,s=new fe,o=new ii,a=new nu({depthPacking:rb}),l=new cx,c={},d=t.maxTextureSize,u={[Da]:Hr,[Hr]:Da,[os]:os},h=new Pt({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new fe},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const m=new Mt;m.setAttribute("position",new Mi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new nt(m,h),g=this;function p(y,x){const w=e.update(_);h.defines.VSM_SAMPLES!==y.blurSamples&&(h.defines.VSM_SAMPLES=y.blurSamples,f.defines.VSM_SAMPLES=y.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),null===y.mapPass&&(y.mapPass=new Gt(r.x,r.y)),h.uniforms.shadow_pass.value=y.map.texture,h.uniforms.resolution.value=y.mapSize,h.uniforms.radius.value=y.radius,i.setRenderTarget(y.mapPass),i.clear(),i.renderBufferDirect(x,null,w,h,_,null),f.uniforms.shadow_pass.value=y.mapPass.texture,f.uniforms.resolution.value=y.mapSize,f.uniforms.radius.value=y.radius,i.setRenderTarget(y.map),i.clear(),i.renderBufferDirect(x,null,w,f,_,null)}function v(y,x,w,E){let S=null;const C=!0===w.isPointLight?y.customDistanceMaterial:y.customDepthMaterial;if(void 0!==C)S=C;else if(S=!0===w.isPointLight?l:a,i.localClippingEnabled&&!0===x.clipShadows&&Array.isArray(x.clippingPlanes)&&0!==x.clippingPlanes.length||x.displacementMap&&0!==x.displacementScale||x.alphaMap&&x.alphaTest>0||x.map&&x.alphaTest>0){const T=S.uuid,k=x.uuid;let U=c[T];void 0===U&&(U={},c[T]=U);let L=U[k];void 0===L&&(L=S.clone(),U[k]=L),S=L}return S.visible=x.visible,S.wireframe=x.wireframe,S.side=E===yf?null!==x.shadowSide?x.shadowSide:x.side:null!==x.shadowSide?x.shadowSide:u[x.side],S.alphaMap=x.alphaMap,S.alphaTest=x.alphaTest,S.map=x.map,S.clipShadows=x.clipShadows,S.clippingPlanes=x.clippingPlanes,S.clipIntersection=x.clipIntersection,S.displacementMap=x.displacementMap,S.displacementScale=x.displacementScale,S.displacementBias=x.displacementBias,S.wireframeLinewidth=x.wireframeLinewidth,S.linewidth=x.linewidth,!0===w.isPointLight&&!0===S.isMeshDistanceMaterial&&(i.properties.get(S).light=w),S}function b(y,x,w,E,S){if(!1===y.visible)return;if(y.layers.test(x.layers)&&(y.isMesh||y.isLine||y.isPoints)&&(y.castShadow||y.receiveShadow&&S===yf)&&(!y.frustumCulled||n.intersectsObject(y))){y.modelViewMatrix.multiplyMatrices(w.matrixWorldInverse,y.matrixWorld);const k=e.update(y),U=y.material;if(Array.isArray(U)){const L=k.groups;for(let j=0,H=L.length;j<H;j++){const B=L[j],V=U[B.materialIndex];if(V&&V.visible){const O=v(y,V,E,S);i.renderBufferDirect(w,null,k,O,y,B)}}}else if(U.visible){const L=v(y,U,E,S);i.renderBufferDirect(w,null,k,L,y,null)}}const T=y.children;for(let k=0,U=T.length;k<U;k++)b(T[k],x,w,E,S)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=rT,this.render=function(y,x,w){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===y.length)return;const E=i.getRenderTarget(),S=i.getActiveCubeFace(),C=i.getActiveMipmapLevel(),T=i.state;T.setBlending(Kt),T.buffers.color.setClear(1,1,1,1),T.buffers.depth.setTest(!0),T.setScissorTest(!1);for(let k=0,U=y.length;k<U;k++){const L=y[k],j=L.shadow;if(void 0===j){console.warn("THREE.WebGLShadowMap:",L,"has no shadow.");continue}if(!1===j.autoUpdate&&!1===j.needsUpdate)continue;r.copy(j.mapSize);const H=j.getFrameExtents();r.multiply(H),s.copy(j.mapSize),(r.x>d||r.y>d)&&(r.x>d&&(s.x=Math.floor(d/H.x),r.x=s.x*H.x,j.mapSize.x=s.x),r.y>d&&(s.y=Math.floor(d/H.y),r.y=s.y*H.y,j.mapSize.y=s.y)),null===j.map&&(j.map=new Gt(r.x,r.y,this.type!==yf?{minFilter:$t,magFilter:$t}:{}),j.map.texture.name=L.name+".shadowMap",j.camera.updateProjectionMatrix()),i.setRenderTarget(j.map),i.clear();const B=j.getViewportCount();for(let V=0;V<B;V++){const O=j.getViewport(V);o.set(s.x*O.x,s.y*O.y,s.x*O.z,s.y*O.w),T.viewport(o),j.updateMatrices(L,V),n=j.getFrustum(),b(x,w,j.camera,L,this.type)}!0!==j.isPointLightShadow&&this.type===yf&&p(j,w),j.needsUpdate=!1}g.needsUpdate=!1,i.setRenderTarget(E,S,C)}}function jae(i,e,t){const n=t.isWebGL2,a=new function r(){let se=!1;const te=new ii;let Ge=null;const mt=new ii(0,0,0,0);return{setMask:function(Dt){Ge!==Dt&&!se&&(i.colorMask(Dt,Dt,Dt,Dt),Ge=Dt)},setLocked:function(Dt){se=Dt},setClear:function(Dt,rn,bn,Sr,rl){!0===rl&&(Dt*=Sr,rn*=Sr,bn*=Sr),te.set(Dt,rn,bn,Sr),!1===mt.equals(te)&&(i.clearColor(Dt,rn,bn,Sr),mt.copy(te))},reset:function(){se=!1,Ge=null,mt.set(-1,0,0,0)}}},l=new function s(){let se=!1,te=null,Ge=null,mt=null;return{setTest:function(Dt){Dt?D(2929):ue(2929)},setMask:function(Dt){te!==Dt&&!se&&(i.depthMask(Dt),te=Dt)},setFunc:function(Dt){if(Ge!==Dt){switch(Dt){case Ej:i.depthFunc(512);break;case Sj:i.depthFunc(519);break;case Tj:i.depthFunc(513);break;case yy:i.depthFunc(515);break;case Rj:i.depthFunc(514);break;case Ij:i.depthFunc(518);break;case Dj:i.depthFunc(516);break;case Pj:i.depthFunc(517);break;default:i.depthFunc(515)}Ge=Dt}},setLocked:function(Dt){se=Dt},setClear:function(Dt){mt!==Dt&&(i.clearDepth(Dt),mt=Dt)},reset:function(){se=!1,te=null,Ge=null,mt=null}}},c=new function o(){let se=!1,te=null,Ge=null,mt=null,Dt=null,rn=null,bn=null,Sr=null,rl=null;return{setTest:function(Bn){se||(Bn?D(2960):ue(2960))},setMask:function(Bn){te!==Bn&&!se&&(i.stencilMask(Bn),te=Bn)},setFunc:function(Bn,Ns,Go){(Ge!==Bn||mt!==Ns||Dt!==Go)&&(i.stencilFunc(Bn,Ns,Go),Ge=Bn,mt=Ns,Dt=Go)},setOp:function(Bn,Ns,Go){(rn!==Bn||bn!==Ns||Sr!==Go)&&(i.stencilOp(Bn,Ns,Go),rn=Bn,bn=Ns,Sr=Go)},setLocked:function(Bn){se=Bn},setClear:function(Bn){rl!==Bn&&(i.clearStencil(Bn),rl=Bn)},reset:function(){se=!1,te=null,Ge=null,mt=null,Dt=null,rn=null,bn=null,Sr=null,rl=null}}},d=new WeakMap,u=new WeakMap;let h={},f={},m=new WeakMap,_=[],g=null,p=!1,v=null,b=null,y=null,x=null,w=null,E=null,S=null,C=!1,T=null,k=null,U=null,L=null,j=null;const H=i.getParameter(35661);let B=!1,V=0;const O=i.getParameter(7938);-1!==O.indexOf("WebGL")?(V=parseFloat(/^WebGL (\d)/.exec(O)[1]),B=V>=1):-1!==O.indexOf("OpenGL ES")&&(V=parseFloat(/^OpenGL ES (\d)/.exec(O)[1]),B=V>=2);let Q=null,oe={};const be=i.getParameter(3088),de=i.getParameter(2978),X=(new ii).fromArray(be),Y=(new ii).fromArray(de);function re(se,te,Ge){const mt=new Uint8Array(4),Dt=i.createTexture();i.bindTexture(se,Dt),i.texParameteri(se,10241,9728),i.texParameteri(se,10240,9728);for(let rn=0;rn<Ge;rn++)i.texImage2D(te+rn,0,6408,1,1,0,6408,5121,mt);return Dt}const J={};function D(se){!0!==h[se]&&(i.enable(se),h[se]=!0)}function ue(se){!1!==h[se]&&(i.disable(se),h[se]=!1)}J[3553]=re(3553,3553,1),J[34067]=re(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),D(2929),l.setFunc(yy),Xe(!1),At(nT),D(2884),Se(Kt);const Me={[ws]:32774,[vj]:32778,[Aj]:32779};if(n)Me[aT]=32775,Me[lT]=32776;else{const se=e.get("EXT_blend_minmax");null!==se&&(Me[aT]=se.MIN_EXT,Me[lT]=se.MAX_EXT)}const we={[Cf]:0,[q_]:1,[yj]:768,[Mf]:770,[Mj]:776,[Ay]:774,[vy]:772,[xj]:769,[Y_]:771,[Cj]:775,[wj]:773};function Se(se,te,Ge,mt,Dt,rn,bn,Sr){if(se!==Kt){if(!1===p&&(D(3042),p=!0),se===wf)Dt=Dt||te,rn=rn||Ge,bn=bn||mt,(te!==b||Dt!==w)&&(i.blendEquationSeparate(Me[te],Me[Dt]),b=te,w=Dt),(Ge!==y||mt!==x||rn!==E||bn!==S)&&(i.blendFuncSeparate(we[Ge],we[mt],we[rn],we[bn]),y=Ge,x=mt,E=rn,S=bn),v=se,C=!1;else if(se!==v||Sr!==C){if((b!==ws||w!==ws)&&(i.blendEquation(32774),b=ws,w=ws),Sr)switch(se){case Pa:i.blendFuncSeparate(1,771,1,771);break;case xf:i.blendFunc(1,1);break;case sT:i.blendFuncSeparate(0,769,0,1);break;case oT:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",se)}else switch(se){case Pa:i.blendFuncSeparate(770,771,1,771);break;case xf:i.blendFunc(770,1);break;case sT:i.blendFuncSeparate(0,769,0,1);break;case oT:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",se)}y=null,x=null,E=null,S=null,v=se,C=Sr}}else!0===p&&(ue(3042),p=!1)}function Xe(se){T!==se&&(i.frontFace(se?2304:2305),T=se)}function At(se){se!==gj?(D(2884),se!==k&&i.cullFace(se===nT?1029:se===_j?1028:1032)):ue(2884),k=se}function lt(se,te,Ge){se?(D(32823),(L!==te||j!==Ge)&&(i.polygonOffset(te,Ge),L=te,j=Ge)):ue(32823)}return{buffers:{color:a,depth:l,stencil:c},enable:D,disable:ue,bindFramebuffer:function Ee(se,te){return f[se]!==te&&(i.bindFramebuffer(se,te),f[se]=te,n&&(36009===se&&(f[36160]=te),36160===se&&(f[36009]=te)),!0)},drawBuffers:function me(se,te){let Ge=_,mt=!1;if(se)if(Ge=m.get(te),void 0===Ge&&(Ge=[],m.set(te,Ge)),se.isWebGLMultipleRenderTargets){const Dt=se.texture;if(Ge.length!==Dt.length||36064!==Ge[0]){for(let rn=0,bn=Dt.length;rn<bn;rn++)Ge[rn]=36064+rn;Ge.length=Dt.length,mt=!0}}else 36064!==Ge[0]&&(Ge[0]=36064,mt=!0);else 1029!==Ge[0]&&(Ge[0]=1029,mt=!0);mt&&(t.isWebGL2?i.drawBuffers(Ge):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ge))},useProgram:function qe(se){return g!==se&&(i.useProgram(se),g=se,!0)},setBlending:Se,setMaterial:function it(se,te){se.side===os?ue(2884):D(2884);let Ge=se.side===Hr;te&&(Ge=!Ge),Xe(Ge),se.blending===Pa&&!1===se.transparent?Se(Kt):Se(se.blending,se.blendEquation,se.blendSrc,se.blendDst,se.blendEquationAlpha,se.blendSrcAlpha,se.blendDstAlpha,se.premultipliedAlpha),l.setFunc(se.depthFunc),l.setTest(se.depthTest),l.setMask(se.depthWrite),a.setMask(se.colorWrite);const mt=se.stencilWrite;c.setTest(mt),mt&&(c.setMask(se.stencilWriteMask),c.setFunc(se.stencilFunc,se.stencilRef,se.stencilFuncMask),c.setOp(se.stencilFail,se.stencilZFail,se.stencilZPass)),lt(se.polygonOffset,se.polygonOffsetFactor,se.polygonOffsetUnits),!0===se.alphaToCoverage?D(32926):ue(32926)},setFlipSided:Xe,setCullFace:At,setLineWidth:function yt(se){se!==U&&(B&&i.lineWidth(se),U=se)},setPolygonOffset:lt,setScissorTest:function ht(se){se?D(3089):ue(3089)},activeTexture:function xt(se){void 0===se&&(se=33984+H-1),Q!==se&&(i.activeTexture(se),Q=se)},bindTexture:function N(se,te,Ge){void 0===Ge&&(Ge=null===Q?33984+H-1:Q);let mt=oe[Ge];void 0===mt&&(mt={type:void 0,texture:void 0},oe[Ge]=mt),(mt.type!==se||mt.texture!==te)&&(Q!==Ge&&(i.activeTexture(Ge),Q=Ge),i.bindTexture(se,te||J[se]),mt.type=se,mt.texture=te)},unbindTexture:function F(){const se=oe[Q];void 0!==se&&void 0!==se.type&&(i.bindTexture(se.type,null),se.type=void 0,se.texture=void 0)},compressedTexImage2D:function Ae(){try{i.compressedTexImage2D.apply(i,arguments)}catch(se){console.error("THREE.WebGLState:",se)}},compressedTexImage3D:function ke(){try{i.compressedTexImage3D.apply(i,arguments)}catch(se){console.error("THREE.WebGLState:",se)}},texImage2D:function ct(){try{i.texImage2D.apply(i,arguments)}catch(se){console.error("THREE.WebGLState:",se)}},texImage3D:function pt(){try{i.texImage3D.apply(i,arguments)}catch(se){console.error("THREE.WebGLState:",se)}},updateUBOMapping:function Lt(se,te){let Ge=u.get(te);void 0===Ge&&(Ge=new WeakMap,u.set(te,Ge));let mt=Ge.get(se);void 0===mt&&(mt=i.getUniformBlockIndex(te,se.name),Ge.set(se,mt))},uniformBlockBinding:function It(se,te){const mt=u.get(te).get(se);d.get(te)!==mt&&(i.uniformBlockBinding(te,mt,se.__bindingPointIndex),d.set(te,mt))},texStorage2D:function ye(){try{i.texStorage2D.apply(i,arguments)}catch(se){console.error("THREE.WebGLState:",se)}},texStorage3D:function Je(){try{i.texStorage3D.apply(i,arguments)}catch(se){console.error("THREE.WebGLState:",se)}},texSubImage2D:function Ue(){try{i.texSubImage2D.apply(i,arguments)}catch(se){console.error("THREE.WebGLState:",se)}},texSubImage3D:function et(){try{i.texSubImage3D.apply(i,arguments)}catch(se){console.error("THREE.WebGLState:",se)}},compressedTexSubImage2D:function Z(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(se){console.error("THREE.WebGLState:",se)}},compressedTexSubImage3D:function Ie(){try{i.compressedTexSubImage3D.apply(i,arguments)}catch(se){console.error("THREE.WebGLState:",se)}},scissor:function $e(se){!1===X.equals(se)&&(i.scissor(se.x,se.y,se.z,se.w),X.copy(se))},viewport:function tt(se){!1===Y.equals(se)&&(i.viewport(se.x,se.y,se.z,se.w),Y.copy(se))},reset:function Jt(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),!0===n&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),h={},Q=null,oe={},f={},m=new WeakMap,_=[],g=null,p=!1,v=null,b=null,y=null,x=null,w=null,E=null,S=null,C=!1,T=null,k=null,U=null,L=null,j=null,X.set(0,0,i.canvas.width,i.canvas.height),Y.set(0,0,i.canvas.width,i.canvas.height),a.reset(),l.reset(),c.reset()}}}function Uae(i,e,t,n,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,d=r.maxTextureSize,u=r.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),m=new WeakMap;let _;const g=new WeakMap;let p=!1;try{p=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function v(N,F){return p?new OffscreenCanvas(N,F):ab("canvas")}function b(N,F,Ae,ke){let Ue=1;if((N.width>ke||N.height>ke)&&(Ue=ke/Math.max(N.width,N.height)),Ue<1||!0===F){if(typeof HTMLImageElement<"u"&&N instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&N instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&N instanceof ImageBitmap){const et=F?sU:Math.floor,Z=et(Ue*N.width),Ie=et(Ue*N.height);void 0===_&&(_=v(Z,Ie));const ye=Ae?v(Z,Ie):_;return ye.width=Z,ye.height=Ie,ye.getContext("2d").drawImage(N,0,0,Z,Ie),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+N.width+"x"+N.height+") to ("+Z+"x"+Ie+")."),ye}return"data"in N&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+N.width+"x"+N.height+")."),N}return N}function y(N){return DT(N.width)&&DT(N.height)}function w(N,F){return N.generateMipmaps&&F&&N.minFilter!==$t&&N.minFilter!==Ui}function E(N){i.generateMipmap(N)}function S(N,F,Ae,ke,Ue=!1){if(!1===a)return F;if(null!==N){if(void 0!==i[N])return i[N];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+N+"'")}let et=F;return 6403===F&&(5126===Ae&&(et=33326),5131===Ae&&(et=33325),5121===Ae&&(et=33321)),33319===F&&(5126===Ae&&(et=33328),5131===Ae&&(et=33327),5121===Ae&&(et=33323)),6408===F&&(5126===Ae&&(et=34836),5131===Ae&&(et=34842),5121===Ae&&(et=ke===ui&&!1===Ue?35907:32856),32819===Ae&&(et=32854),32820===Ae&&(et=32855)),(33325===et||33326===et||33327===et||33328===et||34842===et||34836===et)&&e.get("EXT_color_buffer_float"),et}function C(N,F,Ae){return!0===w(N,Ae)||N.isFramebufferTexture&&N.minFilter!==$t&&N.minFilter!==Ui?Math.log2(Math.max(F.width,F.height))+1:void 0!==N.mipmaps&&N.mipmaps.length>0?N.mipmaps.length:N.isCompressedTexture&&Array.isArray(N.image)?F.mipmaps.length:1}function T(N){return N===$t||N===K_||N===Rf?9728:9729}function k(N){const F=N.target;F.removeEventListener("dispose",k),function L(N){const F=n.get(N);if(void 0===F.__webglInit)return;const Ae=N.source,ke=g.get(Ae);if(ke){const Ue=ke[F.__cacheKey];Ue.usedTimes--,0===Ue.usedTimes&&j(N),0===Object.keys(ke).length&&g.delete(Ae)}n.remove(N)}(F),F.isVideoTexture&&m.delete(F)}function U(N){const F=N.target;F.removeEventListener("dispose",U),function H(N){const F=N.texture,Ae=n.get(N),ke=n.get(F);if(void 0!==ke.__webglTexture&&(i.deleteTexture(ke.__webglTexture),o.memory.textures--),N.depthTexture&&N.depthTexture.dispose(),N.isWebGLCubeRenderTarget)for(let Ue=0;Ue<6;Ue++)i.deleteFramebuffer(Ae.__webglFramebuffer[Ue]),Ae.__webglDepthbuffer&&i.deleteRenderbuffer(Ae.__webglDepthbuffer[Ue]);else{if(i.deleteFramebuffer(Ae.__webglFramebuffer),Ae.__webglDepthbuffer&&i.deleteRenderbuffer(Ae.__webglDepthbuffer),Ae.__webglMultisampledFramebuffer&&i.deleteFramebuffer(Ae.__webglMultisampledFramebuffer),Ae.__webglColorRenderbuffer)for(let Ue=0;Ue<Ae.__webglColorRenderbuffer.length;Ue++)Ae.__webglColorRenderbuffer[Ue]&&i.deleteRenderbuffer(Ae.__webglColorRenderbuffer[Ue]);Ae.__webglDepthRenderbuffer&&i.deleteRenderbuffer(Ae.__webglDepthRenderbuffer)}if(N.isWebGLMultipleRenderTargets)for(let Ue=0,et=F.length;Ue<et;Ue++){const Z=n.get(F[Ue]);Z.__webglTexture&&(i.deleteTexture(Z.__webglTexture),o.memory.textures--),n.remove(F[Ue])}n.remove(F),n.remove(N)}(F)}function j(N){const F=n.get(N);i.deleteTexture(F.__webglTexture),delete g.get(N.source)[F.__cacheKey],o.memory.textures--}let B=0;function oe(N,F){const Ae=n.get(N);if(N.isVideoTexture&&function ht(N){const F=o.render.frame;m.get(N)!==F&&(m.set(N,F),N.update())}(N),!1===N.isRenderTargetTexture&&N.version>0&&Ae.__version!==N.version){const ke=N.image;if(null===ke)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==ke.complete)return void ue(Ae,N,F);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(3553,Ae.__webglTexture,33984+F)}const Y={[Mo]:10497,[_r]:33071,[Tf]:33648},re={[$t]:9728,[K_]:9984,[Rf]:9986,[Ui]:9729,[wy]:9985,[Ks]:9987};function J(N,F,Ae){if(Ae?(i.texParameteri(N,10242,Y[F.wrapS]),i.texParameteri(N,10243,Y[F.wrapT]),(32879===N||35866===N)&&i.texParameteri(N,32882,Y[F.wrapR]),i.texParameteri(N,10240,re[F.magFilter]),i.texParameteri(N,10241,re[F.minFilter])):(i.texParameteri(N,10242,33071),i.texParameteri(N,10243,33071),(32879===N||35866===N)&&i.texParameteri(N,32882,33071),(F.wrapS!==_r||F.wrapT!==_r)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(N,10240,T(F.magFilter)),i.texParameteri(N,10241,T(F.minFilter)),F.minFilter!==$t&&F.minFilter!==Ui&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const ke=e.get("EXT_texture_filter_anisotropic");if(F.magFilter===$t||F.minFilter!==Rf&&F.minFilter!==Ks||F.type===Un&&!1===e.has("OES_texture_float_linear")||!1===a&&F.type===mn&&!1===e.has("OES_texture_half_float_linear"))return;(F.anisotropy>1||n.get(F).__currentAnisotropy)&&(i.texParameterf(N,ke.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(F.anisotropy,r.getMaxAnisotropy())),n.get(F).__currentAnisotropy=F.anisotropy)}}function D(N,F){let Ae=!1;void 0===N.__webglInit&&(N.__webglInit=!0,F.addEventListener("dispose",k));const ke=F.source;let Ue=g.get(ke);void 0===Ue&&(Ue={},g.set(ke,Ue));const et=function Q(N){const F=[];return F.push(N.wrapS),F.push(N.wrapT),F.push(N.wrapR||0),F.push(N.magFilter),F.push(N.minFilter),F.push(N.anisotropy),F.push(N.internalFormat),F.push(N.format),F.push(N.type),F.push(N.generateMipmaps),F.push(N.premultiplyAlpha),F.push(N.flipY),F.push(N.unpackAlignment),F.push(N.encoding),F.join()}(F);if(et!==N.__cacheKey){void 0===Ue[et]&&(Ue[et]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,Ae=!0),Ue[et].usedTimes++;const Z=Ue[N.__cacheKey];void 0!==Z&&(Ue[N.__cacheKey].usedTimes--,0===Z.usedTimes&&j(F)),N.__cacheKey=et,N.__webglTexture=Ue[et].texture}return Ae}function ue(N,F,Ae){let ke=3553;(F.isDataArrayTexture||F.isCompressedArrayTexture)&&(ke=35866),F.isData3DTexture&&(ke=32879);const Ue=D(N,F),et=F.source;t.bindTexture(ke,N.__webglTexture,33984+Ae);const Z=n.get(et);if(et.version!==Z.__version||!0===Ue){t.activeTexture(33984+Ae),i.pixelStorei(37440,F.flipY),i.pixelStorei(37441,F.premultiplyAlpha),i.pixelStorei(3317,F.unpackAlignment),i.pixelStorei(37443,0);const Ie=function x(N){return!a&&(N.wrapS!==_r||N.wrapT!==_r||N.minFilter!==$t&&N.minFilter!==Ui)}(F)&&!1===y(F.image);let ye=b(F.image,Ie,!1,d);ye=xt(F,ye);const Je=y(ye)||a,ct=s.convert(F.format,F.encoding);let tt,pt=s.convert(F.type),$e=S(F.internalFormat,ct,pt,F.encoding,F.isVideoTexture);J(ke,F,Je);const Lt=F.mipmaps,It=a&&!0!==F.isVideoTexture,Jt=void 0===Z.__version||!0===Ue,se=C(F,ye,Je);if(F.isDepthTexture)$e=6402,a?$e=F.type===Un?36012:F.type===uc?33190:F.type===hc?35056:33189:F.type===Un&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),F.format===fc&&6402===$e&&F.type!==$_&&F.type!==uc&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),F.type=uc,pt=s.convert(F.type)),F.format===pc&&6402===$e&&($e=34041,F.type!==hc&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),F.type=hc,pt=s.convert(F.type))),Jt&&(It?t.texStorage2D(3553,1,$e,ye.width,ye.height):t.texImage2D(3553,0,$e,ye.width,ye.height,0,ct,pt,null));else if(F.isDataTexture)if(Lt.length>0&&Je){It&&Jt&&t.texStorage2D(3553,se,$e,Lt[0].width,Lt[0].height);for(let te=0,Ge=Lt.length;te<Ge;te++)tt=Lt[te],It?t.texSubImage2D(3553,te,0,0,tt.width,tt.height,ct,pt,tt.data):t.texImage2D(3553,te,$e,tt.width,tt.height,0,ct,pt,tt.data);F.generateMipmaps=!1}else It?(Jt&&t.texStorage2D(3553,se,$e,ye.width,ye.height),t.texSubImage2D(3553,0,0,0,ye.width,ye.height,ct,pt,ye.data)):t.texImage2D(3553,0,$e,ye.width,ye.height,0,ct,pt,ye.data);else if(F.isCompressedTexture)if(F.isCompressedArrayTexture){It&&Jt&&t.texStorage3D(35866,se,$e,Lt[0].width,Lt[0].height,ye.depth);for(let te=0,Ge=Lt.length;te<Ge;te++)tt=Lt[te],F.format!==Rn?null!==ct?It?t.compressedTexSubImage3D(35866,te,0,0,0,tt.width,tt.height,ye.depth,ct,tt.data,0,0):t.compressedTexImage3D(35866,te,$e,tt.width,tt.height,ye.depth,0,tt.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):It?t.texSubImage3D(35866,te,0,0,0,tt.width,tt.height,ye.depth,ct,pt,tt.data):t.texImage3D(35866,te,$e,tt.width,tt.height,ye.depth,0,ct,pt,tt.data)}else{It&&Jt&&t.texStorage2D(3553,se,$e,Lt[0].width,Lt[0].height);for(let te=0,Ge=Lt.length;te<Ge;te++)tt=Lt[te],F.format!==Rn?null!==ct?It?t.compressedTexSubImage2D(3553,te,0,0,tt.width,tt.height,ct,tt.data):t.compressedTexImage2D(3553,te,$e,tt.width,tt.height,0,tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):It?t.texSubImage2D(3553,te,0,0,tt.width,tt.height,ct,pt,tt.data):t.texImage2D(3553,te,$e,tt.width,tt.height,0,ct,pt,tt.data)}else if(F.isDataArrayTexture)It?(Jt&&t.texStorage3D(35866,se,$e,ye.width,ye.height,ye.depth),t.texSubImage3D(35866,0,0,0,0,ye.width,ye.height,ye.depth,ct,pt,ye.data)):t.texImage3D(35866,0,$e,ye.width,ye.height,ye.depth,0,ct,pt,ye.data);else if(F.isData3DTexture)It?(Jt&&t.texStorage3D(32879,se,$e,ye.width,ye.height,ye.depth),t.texSubImage3D(32879,0,0,0,0,ye.width,ye.height,ye.depth,ct,pt,ye.data)):t.texImage3D(32879,0,$e,ye.width,ye.height,ye.depth,0,ct,pt,ye.data);else if(F.isFramebufferTexture){if(Jt)if(It)t.texStorage2D(3553,se,$e,ye.width,ye.height);else{let te=ye.width,Ge=ye.height;for(let mt=0;mt<se;mt++)t.texImage2D(3553,mt,$e,te,Ge,0,ct,pt,null),te>>=1,Ge>>=1}}else if(Lt.length>0&&Je){It&&Jt&&t.texStorage2D(3553,se,$e,Lt[0].width,Lt[0].height);for(let te=0,Ge=Lt.length;te<Ge;te++)tt=Lt[te],It?t.texSubImage2D(3553,te,0,0,ct,pt,tt):t.texImage2D(3553,te,$e,ct,pt,tt);F.generateMipmaps=!1}else It?(Jt&&t.texStorage2D(3553,se,$e,ye.width,ye.height),t.texSubImage2D(3553,0,0,0,ct,pt,ye)):t.texImage2D(3553,0,$e,ct,pt,ye);w(F,Je)&&E(ke),Z.__version=et.version,F.onUpdate&&F.onUpdate(F)}N.__version=F.version}function me(N,F,Ae,ke,Ue){const et=s.convert(Ae.format,Ae.encoding),Z=s.convert(Ae.type),Ie=S(Ae.internalFormat,et,Z,Ae.encoding);n.get(F).__hasExternalTextures||(32879===Ue||35866===Ue?t.texImage3D(Ue,0,Ie,F.width,F.height,F.depth,0,et,Z,null):t.texImage2D(Ue,0,Ie,F.width,F.height,0,et,Z,null)),t.bindFramebuffer(36160,N),lt(F)?h.framebufferTexture2DMultisampleEXT(36160,ke,Ue,n.get(Ae).__webglTexture,0,yt(F)):(3553===Ue||Ue>=34069&&Ue<=34074)&&i.framebufferTexture2D(36160,ke,Ue,n.get(Ae).__webglTexture,0),t.bindFramebuffer(36160,null)}function qe(N,F,Ae){if(i.bindRenderbuffer(36161,N),F.depthBuffer&&!F.stencilBuffer){let ke=33189;if(Ae||lt(F)){const Ue=F.depthTexture;Ue&&Ue.isDepthTexture&&(Ue.type===Un?ke=36012:Ue.type===uc&&(ke=33190));const et=yt(F);lt(F)?h.renderbufferStorageMultisampleEXT(36161,et,ke,F.width,F.height):i.renderbufferStorageMultisample(36161,et,ke,F.width,F.height)}else i.renderbufferStorage(36161,ke,F.width,F.height);i.framebufferRenderbuffer(36160,36096,36161,N)}else if(F.depthBuffer&&F.stencilBuffer){const ke=yt(F);Ae&&!1===lt(F)?i.renderbufferStorageMultisample(36161,ke,35056,F.width,F.height):lt(F)?h.renderbufferStorageMultisampleEXT(36161,ke,35056,F.width,F.height):i.renderbufferStorage(36161,34041,F.width,F.height),i.framebufferRenderbuffer(36160,33306,36161,N)}else{const ke=!0===F.isWebGLMultipleRenderTargets?F.texture:[F.texture];for(let Ue=0;Ue<ke.length;Ue++){const et=ke[Ue],Z=s.convert(et.format,et.encoding),Ie=s.convert(et.type),ye=S(et.internalFormat,Z,Ie,et.encoding),Je=yt(F);Ae&&!1===lt(F)?i.renderbufferStorageMultisample(36161,Je,ye,F.width,F.height):lt(F)?h.renderbufferStorageMultisampleEXT(36161,Je,ye,F.width,F.height):i.renderbufferStorage(36161,ye,F.width,F.height)}}i.bindRenderbuffer(36161,null)}function we(N){const F=n.get(N),Ae=!0===N.isWebGLCubeRenderTarget;if(N.depthTexture&&!F.__autoAllocateDepthBuffer){if(Ae)throw new Error("target.depthTexture not supported in Cube render targets");!function Me(N,F){if(F&&F.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,N),!F.depthTexture||!F.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(F.depthTexture).__webglTexture||F.depthTexture.image.width!==F.width||F.depthTexture.image.height!==F.height)&&(F.depthTexture.image.width=F.width,F.depthTexture.image.height=F.height,F.depthTexture.needsUpdate=!0),oe(F.depthTexture,0);const ke=n.get(F.depthTexture).__webglTexture,Ue=yt(F);if(F.depthTexture.format===fc)lt(F)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,ke,0,Ue):i.framebufferTexture2D(36160,36096,3553,ke,0);else{if(F.depthTexture.format!==pc)throw new Error("Unknown depthTexture format");lt(F)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,ke,0,Ue):i.framebufferTexture2D(36160,33306,3553,ke,0)}}(F.__webglFramebuffer,N)}else if(Ae){F.__webglDepthbuffer=[];for(let ke=0;ke<6;ke++)t.bindFramebuffer(36160,F.__webglFramebuffer[ke]),F.__webglDepthbuffer[ke]=i.createRenderbuffer(),qe(F.__webglDepthbuffer[ke],N,!1)}else t.bindFramebuffer(36160,F.__webglFramebuffer),F.__webglDepthbuffer=i.createRenderbuffer(),qe(F.__webglDepthbuffer,N,!1);t.bindFramebuffer(36160,null)}function yt(N){return Math.min(u,N.samples)}function lt(N){const F=n.get(N);return a&&N.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==F.__useRenderToTexture}function xt(N,F){const Ae=N.encoding,ke=N.format,Ue=N.type;return!0===N.isCompressedTexture||!0===N.isVideoTexture||N.format===Ly||Ae!==$s&&(Ae===ui?!1===a?!0===e.has("EXT_sRGB")&&ke===Rn?(N.format=Ly,N.minFilter=Ui,N.generateMipmaps=!1):F=BT.sRGBToLinear(F):(ke!==Rn||Ue!==Qr)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",Ae)),F}this.allocateTextureUnit=function O(){const N=B;return N>=l&&console.warn("THREE.WebGLTextures: Trying to use "+N+" texture units while this GPU supports only "+l),B+=1,N},this.resetTextureUnits=function V(){B=0},this.setTexture2D=oe,this.setTexture2DArray=function be(N,F){const Ae=n.get(N);N.version>0&&Ae.__version!==N.version?ue(Ae,N,F):t.bindTexture(35866,Ae.__webglTexture,33984+F)},this.setTexture3D=function de(N,F){const Ae=n.get(N);N.version>0&&Ae.__version!==N.version?ue(Ae,N,F):t.bindTexture(32879,Ae.__webglTexture,33984+F)},this.setTextureCube=function X(N,F){const Ae=n.get(N);N.version>0&&Ae.__version!==N.version?function Ee(N,F,Ae){if(6!==F.image.length)return;const ke=D(N,F),Ue=F.source;t.bindTexture(34067,N.__webglTexture,33984+Ae);const et=n.get(Ue);if(Ue.version!==et.__version||!0===ke){t.activeTexture(33984+Ae),i.pixelStorei(37440,F.flipY),i.pixelStorei(37441,F.premultiplyAlpha),i.pixelStorei(3317,F.unpackAlignment),i.pixelStorei(37443,0);const Z=F.isCompressedTexture||F.image[0].isCompressedTexture,Ie=F.image[0]&&F.image[0].isDataTexture,ye=[];for(let te=0;te<6;te++)ye[te]=Z||Ie?Ie?F.image[te].image:F.image[te]:b(F.image[te],!1,!0,c),ye[te]=xt(F,ye[te]);const Je=ye[0],ct=y(Je)||a,pt=s.convert(F.format,F.encoding),$e=s.convert(F.type),tt=S(F.internalFormat,pt,$e,F.encoding),Lt=a&&!0!==F.isVideoTexture,It=void 0===et.__version||!0===ke;let se,Jt=C(F,Je,ct);if(J(34067,F,ct),Z){Lt&&It&&t.texStorage2D(34067,Jt,tt,Je.width,Je.height);for(let te=0;te<6;te++){se=ye[te].mipmaps;for(let Ge=0;Ge<se.length;Ge++){const mt=se[Ge];F.format!==Rn?null!==pt?Lt?t.compressedTexSubImage2D(34069+te,Ge,0,0,mt.width,mt.height,pt,mt.data):t.compressedTexImage2D(34069+te,Ge,tt,mt.width,mt.height,0,mt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Lt?t.texSubImage2D(34069+te,Ge,0,0,mt.width,mt.height,pt,$e,mt.data):t.texImage2D(34069+te,Ge,tt,mt.width,mt.height,0,pt,$e,mt.data)}}}else{se=F.mipmaps,Lt&&It&&(se.length>0&&Jt++,t.texStorage2D(34067,Jt,tt,ye[0].width,ye[0].height));for(let te=0;te<6;te++)if(Ie){Lt?t.texSubImage2D(34069+te,0,0,0,ye[te].width,ye[te].height,pt,$e,ye[te].data):t.texImage2D(34069+te,0,tt,ye[te].width,ye[te].height,0,pt,$e,ye[te].data);for(let Ge=0;Ge<se.length;Ge++){const Dt=se[Ge].image[te].image;Lt?t.texSubImage2D(34069+te,Ge+1,0,0,Dt.width,Dt.height,pt,$e,Dt.data):t.texImage2D(34069+te,Ge+1,tt,Dt.width,Dt.height,0,pt,$e,Dt.data)}}else{Lt?t.texSubImage2D(34069+te,0,0,0,pt,$e,ye[te]):t.texImage2D(34069+te,0,tt,pt,$e,ye[te]);for(let Ge=0;Ge<se.length;Ge++){const mt=se[Ge];Lt?t.texSubImage2D(34069+te,Ge+1,0,0,pt,$e,mt.image[te]):t.texImage2D(34069+te,Ge+1,tt,pt,$e,mt.image[te])}}}w(F,ct)&&E(34067),et.__version=Ue.version,F.onUpdate&&F.onUpdate(F)}N.__version=F.version}(Ae,N,F):t.bindTexture(34067,Ae.__webglTexture,33984+F)},this.rebindTextures=function Se(N,F,Ae){const ke=n.get(N);void 0!==F&&me(ke.__webglFramebuffer,N,N.texture,36064,3553),void 0!==Ae&&we(N)},this.setupRenderTarget=function it(N){const F=N.texture,Ae=n.get(N),ke=n.get(F);N.addEventListener("dispose",U),!0!==N.isWebGLMultipleRenderTargets&&(void 0===ke.__webglTexture&&(ke.__webglTexture=i.createTexture()),ke.__version=F.version,o.memory.textures++);const Ue=!0===N.isWebGLCubeRenderTarget,et=!0===N.isWebGLMultipleRenderTargets,Z=y(N)||a;if(Ue){Ae.__webglFramebuffer=[];for(let Ie=0;Ie<6;Ie++)Ae.__webglFramebuffer[Ie]=i.createFramebuffer()}else{if(Ae.__webglFramebuffer=i.createFramebuffer(),et)if(r.drawBuffers){const Ie=N.texture;for(let ye=0,Je=Ie.length;ye<Je;ye++){const ct=n.get(Ie[ye]);void 0===ct.__webglTexture&&(ct.__webglTexture=i.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&N.samples>0&&!1===lt(N)){const Ie=et?F:[F];Ae.__webglMultisampledFramebuffer=i.createFramebuffer(),Ae.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,Ae.__webglMultisampledFramebuffer);for(let ye=0;ye<Ie.length;ye++){const Je=Ie[ye];Ae.__webglColorRenderbuffer[ye]=i.createRenderbuffer(),i.bindRenderbuffer(36161,Ae.__webglColorRenderbuffer[ye]);const ct=s.convert(Je.format,Je.encoding),pt=s.convert(Je.type),$e=S(Je.internalFormat,ct,pt,Je.encoding,!0===N.isXRRenderTarget),tt=yt(N);i.renderbufferStorageMultisample(36161,tt,$e,N.width,N.height),i.framebufferRenderbuffer(36160,36064+ye,36161,Ae.__webglColorRenderbuffer[ye])}i.bindRenderbuffer(36161,null),N.depthBuffer&&(Ae.__webglDepthRenderbuffer=i.createRenderbuffer(),qe(Ae.__webglDepthRenderbuffer,N,!0)),t.bindFramebuffer(36160,null)}}if(Ue){t.bindTexture(34067,ke.__webglTexture),J(34067,F,Z);for(let Ie=0;Ie<6;Ie++)me(Ae.__webglFramebuffer[Ie],N,F,36064,34069+Ie);w(F,Z)&&E(34067),t.unbindTexture()}else if(et){const Ie=N.texture;for(let ye=0,Je=Ie.length;ye<Je;ye++){const ct=Ie[ye],pt=n.get(ct);t.bindTexture(3553,pt.__webglTexture),J(3553,ct,Z),me(Ae.__webglFramebuffer,N,ct,36064+ye,3553),w(ct,Z)&&E(3553)}t.unbindTexture()}else{let Ie=3553;(N.isWebGL3DRenderTarget||N.isWebGLArrayRenderTarget)&&(a?Ie=N.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Ie,ke.__webglTexture),J(Ie,F,Z),me(Ae.__webglFramebuffer,N,F,36064,Ie),w(F,Z)&&E(Ie),t.unbindTexture()}N.depthBuffer&&we(N)},this.updateRenderTargetMipmap=function Xe(N){const F=y(N)||a,Ae=!0===N.isWebGLMultipleRenderTargets?N.texture:[N.texture];for(let ke=0,Ue=Ae.length;ke<Ue;ke++){const et=Ae[ke];if(w(et,F)){const Z=N.isWebGLCubeRenderTarget?34067:3553,Ie=n.get(et).__webglTexture;t.bindTexture(Z,Ie),E(Z),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function At(N){if(a&&N.samples>0&&!1===lt(N)){const F=N.isWebGLMultipleRenderTargets?N.texture:[N.texture],Ae=N.width,ke=N.height;let Ue=16384;const et=[],Z=N.stencilBuffer?33306:36096,Ie=n.get(N),ye=!0===N.isWebGLMultipleRenderTargets;if(ye)for(let Je=0;Je<F.length;Je++)t.bindFramebuffer(36160,Ie.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+Je,36161,null),t.bindFramebuffer(36160,Ie.__webglFramebuffer),i.framebufferTexture2D(36009,36064+Je,3553,null,0);t.bindFramebuffer(36008,Ie.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,Ie.__webglFramebuffer);for(let Je=0;Je<F.length;Je++){et.push(36064+Je),N.depthBuffer&&et.push(Z);const ct=void 0!==Ie.__ignoreDepthValues&&Ie.__ignoreDepthValues;if(!1===ct&&(N.depthBuffer&&(Ue|=256),N.stencilBuffer&&(Ue|=1024)),ye&&i.framebufferRenderbuffer(36008,36064,36161,Ie.__webglColorRenderbuffer[Je]),!0===ct&&(i.invalidateFramebuffer(36008,[Z]),i.invalidateFramebuffer(36009,[Z])),ye){const pt=n.get(F[Je]).__webglTexture;i.framebufferTexture2D(36009,36064,3553,pt,0)}i.blitFramebuffer(0,0,Ae,ke,0,0,Ae,ke,Ue,9728),f&&i.invalidateFramebuffer(36008,et)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),ye)for(let Je=0;Je<F.length;Je++){t.bindFramebuffer(36160,Ie.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+Je,36161,Ie.__webglColorRenderbuffer[Je]);const ct=n.get(F[Je]).__webglTexture;t.bindFramebuffer(36160,Ie.__webglFramebuffer),i.framebufferTexture2D(36009,36064+Je,3553,ct,0)}t.bindFramebuffer(36009,Ie.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=we,this.setupFrameBufferTexture=me,this.useMultisampledRTT=lt}function ZU(i,e,t){const n=t.isWebGL2;return{convert:function r(s,o=null){let a;if(s===Qr)return 5121;if(s===Gj)return 32819;if(s===Hj)return 32820;if(s===Uj)return 5120;if(s===Vj)return 5122;if(s===$_)return 5123;if(s===zj)return 5124;if(s===uc)return 5125;if(s===Un)return 5126;if(s===mn)return n?5131:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(s===Qj)return 6406;if(s===Rn)return 6408;if(s===Cy)return 6409;if(s===Wj)return 6410;if(s===fc)return 6402;if(s===pc)return 34041;if(s===Ly)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(s===Cl)return 6403;if(s===qj)return 36244;if(s===If)return 33319;if(s===Yj)return 33320;if(s===Xj)return 36249;if(s===Df||s===My||s===J_||s===Pf)if(o===ui){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(s===Df)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===My)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===J_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===Pf)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(s===Df)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===My)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===J_)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===Pf)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(s===kf||s===eb||s===Bf||s===tb){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(s===kf)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===eb)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===Bf)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===tb)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(s===Ey)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===Sy||s===Ty){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(s===Sy)return o===ui?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===Ty)return o===ui?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(s===Ry||s===cT||s===dT||s===uT||s===hT||s===fT||s===pT||s===mT||s===gT||s===_T||s===bT||s===vT||s===AT||s===yT){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(s===Ry)return o===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===cT)return o===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===dT)return o===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===uT)return o===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===hT)return o===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===fT)return o===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===pT)return o===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===mT)return o===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===gT)return o===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===_T)return o===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===bT)return o===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===vT)return o===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===AT)return o===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===yT)return o===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(s===ib){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(s===ib)return o===ui?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(s===Zj||s===xT||s===wT||s===CT){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(s===ib)return a.COMPRESSED_RED_RGTC1_EXT;if(s===xT)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===wT)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===CT)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===hc?n?34042:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==i[s]?i[s]:null}}}class nR extends In{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Es extends Qt{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Vae={type:"move"};class rR{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Es,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Es,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new R,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new R),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Es,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new R,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new R),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(c&&e.hand){o=!0;for(const _ of e.hand.values()){const g=t.getJointPose(_,n),p=this._getHandJoint(c,_);null!==g&&(p.matrix.fromArray(g.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.jointRadius=g.radius),p.visible=null!==g}const h=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),f=.02,m=.005;c.inputState.pinching&&h>f+m?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=f-m&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Vae)))}return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new Es;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class rp extends An{constructor(e,t,n,r,s,o,a,l,c,d){if((d=void 0!==d?d:fc)!==fc&&d!==pc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&d===fc&&(n=uc),void 0===n&&d===pc&&(n=hc),super(null,r,s,o,a,l,d,n,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:$t,this.minFilter=void 0!==l?l:$t,this.flipY=!1,this.generateMipmaps=!1}}class zae extends as{constructor(e,t){super();const n=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,d=null,u=null,h=null,f=null,m=null;const _=t.getContextAttributes();let g=null,p=null;const v=[],b=[],y=new Set,x=new Map,w=new In;w.layers.enable(1),w.viewport=new ii;const E=new In;E.layers.enable(2),E.viewport=new ii;const S=[w,E],C=new nR;C.layers.enable(1),C.layers.enable(2);let T=null,k=null;function U(X){const Y=b.indexOf(X.inputSource);if(-1===Y)return;const re=v[Y];void 0!==re&&re.dispatchEvent({type:X.type,data:X.inputSource})}function L(){r.removeEventListener("select",U),r.removeEventListener("selectstart",U),r.removeEventListener("selectend",U),r.removeEventListener("squeeze",U),r.removeEventListener("squeezestart",U),r.removeEventListener("squeezeend",U),r.removeEventListener("end",L),r.removeEventListener("inputsourceschange",j);for(let X=0;X<v.length;X++){const Y=b[X];null!==Y&&(b[X]=null,v[X].disconnect(Y))}T=null,k=null,e.setRenderTarget(g),f=null,h=null,u=null,r=null,p=null,de.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function j(X){for(let Y=0;Y<X.removed.length;Y++){const re=X.removed[Y],J=b.indexOf(re);J>=0&&(b[J]=null,v[J].disconnect(re))}for(let Y=0;Y<X.added.length;Y++){const re=X.added[Y];let J=b.indexOf(re);if(-1===J){for(let ue=0;ue<v.length;ue++){if(ue>=b.length){b.push(re),J=ue;break}if(null===b[ue]){b[ue]=re,J=ue;break}}if(-1===J)break}const D=v[J];D&&D.connect(re)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(X){let Y=v[X];return void 0===Y&&(Y=new rR,v[X]=Y),Y.getTargetRaySpace()},this.getControllerGrip=function(X){let Y=v[X];return void 0===Y&&(Y=new rR,v[X]=Y),Y.getGripSpace()},this.getHand=function(X){let Y=v[X];return void 0===Y&&(Y=new rR,v[X]=Y),Y.getHandSpace()},this.setFramebufferScaleFactor=function(X){s=X,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(X){a=X,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(X){c=X},this.getBaseLayer=function(){return null!==h?h:f},this.getBinding=function(){return u},this.getFrame=function(){return m},this.getSession=function(){return r},this.setSession=function(){var X=ss(function*(Y){if(r=Y,null!==r){if(g=e.getRenderTarget(),r.addEventListener("select",U),r.addEventListener("selectstart",U),r.addEventListener("selectend",U),r.addEventListener("squeeze",U),r.addEventListener("squeezestart",U),r.addEventListener("squeezeend",U),r.addEventListener("end",L),r.addEventListener("inputsourceschange",j),!0!==_.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)f=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||_.antialias,alpha:_.alpha,depth:_.depth,stencil:_.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:f}),p=new Gt(f.framebufferWidth,f.framebufferHeight,{format:Rn,type:Qr,encoding:e.outputEncoding,stencilBuffer:_.stencil});else{let re=null,J=null,D=null;_.depth&&(D=_.stencil?35056:33190,re=_.stencil?pc:fc,J=_.stencil?hc:uc);const ue={colorFormat:32856,depthFormat:D,scaleFactor:s};u=new XRWebGLBinding(r,t),h=u.createProjectionLayer(ue),r.updateRenderState({layers:[h]}),p=new Gt(h.textureWidth,h.textureHeight,{format:Rn,type:Qr,depthTexture:new rp(h.textureWidth,h.textureHeight,J,void 0,void 0,void 0,void 0,void 0,void 0,re),stencilBuffer:_.stencil,encoding:e.outputEncoding,samples:_.antialias?4:0}),e.properties.get(p).__ignoreDepthValues=h.ignoreDepthValues}p.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=yield r.requestReferenceSpace(a),de.setContext(r),de.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(Y){return X.apply(this,arguments)}}();const H=new R,B=new R;function O(X,Y){null===Y?X.matrixWorld.copy(X.matrix):X.matrixWorld.multiplyMatrices(Y.matrixWorld,X.matrix),X.matrixWorldInverse.copy(X.matrixWorld).invert()}this.updateCamera=function(X){if(null===r)return;C.near=E.near=w.near=X.near,C.far=E.far=w.far=X.far,(T!==C.near||k!==C.far)&&(r.updateRenderState({depthNear:C.near,depthFar:C.far}),T=C.near,k=C.far);const Y=X.parent,re=C.cameras;O(C,Y);for(let J=0;J<re.length;J++)O(re[J],Y);2===re.length?function V(X,Y,re){H.setFromMatrixPosition(Y.matrixWorld),B.setFromMatrixPosition(re.matrixWorld);const J=H.distanceTo(B),D=Y.projectionMatrix.elements,ue=re.projectionMatrix.elements,Ee=D[14]/(D[10]-1),me=D[14]/(D[10]+1),qe=(D[9]+1)/D[5],Me=(D[9]-1)/D[5],we=(D[8]-1)/D[0],Se=(ue[8]+1)/ue[0],it=Ee*we,Xe=Ee*Se,At=J/(-we+Se),yt=At*-we;Y.matrixWorld.decompose(X.position,X.quaternion,X.scale),X.translateX(yt),X.translateZ(At),X.matrixWorld.compose(X.position,X.quaternion,X.scale),X.matrixWorldInverse.copy(X.matrixWorld).invert();const lt=Ee+At,ht=me+At;X.projectionMatrix.makePerspective(it-yt,Xe+(J-yt),qe*me/ht*lt,Me*me/ht*lt,lt,ht),X.projectionMatrixInverse.copy(X.projectionMatrix).invert()}(C,w,E):C.projectionMatrix.copy(w.projectionMatrix),function Q(X,Y,re){null===re?X.matrix.copy(Y.matrixWorld):(X.matrix.copy(re.matrixWorld),X.matrix.invert(),X.matrix.multiply(Y.matrixWorld)),X.matrix.decompose(X.position,X.quaternion,X.scale),X.updateMatrixWorld(!0);const J=X.children;for(let D=0,ue=J.length;D<ue;D++)J[D].updateMatrixWorld(!0);X.projectionMatrix.copy(Y.projectionMatrix),X.projectionMatrixInverse.copy(Y.projectionMatrixInverse),X.isPerspectiveCamera&&(X.fov=2*Ff*Math.atan(1/X.projectionMatrix.elements[5]),X.zoom=1)}(X,C,Y)},this.getCamera=function(){return C},this.getFoveation=function(){if(null!==h||null!==f)return l},this.setFoveation=function(X){l=X,null!==h&&(h.fixedFoveation=X),null!==f&&void 0!==f.fixedFoveation&&(f.fixedFoveation=X)},this.getPlanes=function(){return y};let oe=null;const de=new CU;de.setAnimationLoop(function be(X,Y){if(d=Y.getViewerPose(c||o),m=Y,null!==d){const re=d.views;null!==f&&(e.setRenderTargetFramebuffer(p,f.framebuffer),e.setRenderTarget(p));let J=!1;re.length!==C.cameras.length&&(C.cameras.length=0,J=!0);for(let D=0;D<re.length;D++){const ue=re[D];let Ee=null;if(null!==f)Ee=f.getViewport(ue);else{const qe=u.getViewSubImage(h,ue);Ee=qe.viewport,0===D&&(e.setRenderTargetTextures(p,qe.colorTexture,h.ignoreDepthValues?void 0:qe.depthStencilTexture),e.setRenderTarget(p))}let me=S[D];void 0===me&&(me=new In,me.layers.enable(D),me.viewport=new ii,S[D]=me),me.matrix.fromArray(ue.transform.matrix),me.matrix.decompose(me.position,me.quaternion,me.scale),me.projectionMatrix.fromArray(ue.projectionMatrix),me.projectionMatrixInverse.copy(me.projectionMatrix).invert(),me.viewport.set(Ee.x,Ee.y,Ee.width,Ee.height),0===D&&(C.matrix.copy(me.matrix),C.matrix.decompose(C.position,C.quaternion,C.scale)),!0===J&&C.cameras.push(me)}}for(let re=0;re<v.length;re++){const J=b[re],D=v[re];null!==J&&void 0!==D&&D.update(J,Y,c||o)}if(oe&&oe(X,Y),Y.detectedPlanes){n.dispatchEvent({type:"planesdetected",data:Y.detectedPlanes});let re=null;for(const J of y)Y.detectedPlanes.has(J)||(null===re&&(re=[]),re.push(J));if(null!==re)for(const J of re)y.delete(J),x.delete(J),n.dispatchEvent({type:"planeremoved",data:J});for(const J of Y.detectedPlanes)if(y.has(J)){const D=x.get(J);J.lastChangedTime>D&&(x.set(J,J.lastChangedTime),n.dispatchEvent({type:"planechanged",data:J}))}else y.add(J),x.set(J,Y.lastChangedTime),n.dispatchEvent({type:"planeadded",data:J})}m=null}),this.setAnimationLoop=function(X){oe=X},this.dispose=function(){}}}function Gae(i,e){function t(g,p){!0===g.matrixAutoUpdate&&g.updateMatrix(),p.value.copy(g.matrix)}function s(g,p){g.opacity.value=p.opacity,p.color&&g.diffuse.value.copy(p.color),p.emissive&&g.emissive.value.copy(p.emissive).multiplyScalar(p.emissiveIntensity),p.map&&(g.map.value=p.map,t(p.map,g.mapTransform)),p.alphaMap&&(g.alphaMap.value=p.alphaMap,t(p.alphaMap,g.alphaMapTransform)),p.bumpMap&&(g.bumpMap.value=p.bumpMap,t(p.bumpMap,g.bumpMapTransform),g.bumpScale.value=p.bumpScale,p.side===Hr&&(g.bumpScale.value*=-1)),p.normalMap&&(g.normalMap.value=p.normalMap,t(p.normalMap,g.normalMapTransform),g.normalScale.value.copy(p.normalScale),p.side===Hr&&g.normalScale.value.negate()),p.displacementMap&&(g.displacementMap.value=p.displacementMap,t(p.displacementMap,g.displacementMapTransform),g.displacementScale.value=p.displacementScale,g.displacementBias.value=p.displacementBias),p.emissiveMap&&(g.emissiveMap.value=p.emissiveMap,t(p.emissiveMap,g.emissiveMapTransform)),p.specularMap&&(g.specularMap.value=p.specularMap,t(p.specularMap,g.specularMapTransform)),p.alphaTest>0&&(g.alphaTest.value=p.alphaTest);const v=e.get(p).envMap;if(v&&(g.envMap.value=v,g.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,g.reflectivity.value=p.reflectivity,g.ior.value=p.ior,g.refractionRatio.value=p.refractionRatio),p.lightMap){g.lightMap.value=p.lightMap;const b=!0===i.useLegacyLights?Math.PI:1;g.lightMapIntensity.value=p.lightMapIntensity*b,t(p.lightMap,g.lightMapTransform)}p.aoMap&&(g.aoMap.value=p.aoMap,g.aoMapIntensity.value=p.aoMapIntensity,t(p.aoMap,g.aoMapTransform))}return{refreshFogUniforms:function n(g,p){p.color.getRGB(g.fogColor.value,xU(i)),p.isFog?(g.fogNear.value=p.near,g.fogFar.value=p.far):p.isFogExp2&&(g.fogDensity.value=p.density)},refreshMaterialUniforms:function r(g,p,v,b,y){p.isMeshBasicMaterial||p.isMeshLambertMaterial?s(g,p):p.isMeshToonMaterial?(s(g,p),function u(g,p){p.gradientMap&&(g.gradientMap.value=p.gradientMap)}(g,p)):p.isMeshPhongMaterial?(s(g,p),function d(g,p){g.specular.value.copy(p.specular),g.shininess.value=Math.max(p.shininess,1e-4)}(g,p)):p.isMeshStandardMaterial?(s(g,p),function h(g,p){g.metalness.value=p.metalness,p.metalnessMap&&(g.metalnessMap.value=p.metalnessMap,t(p.metalnessMap,g.metalnessMapTransform)),g.roughness.value=p.roughness,p.roughnessMap&&(g.roughnessMap.value=p.roughnessMap,t(p.roughnessMap,g.roughnessMapTransform)),e.get(p).envMap&&(g.envMapIntensity.value=p.envMapIntensity)}(g,p),p.isMeshPhysicalMaterial&&function f(g,p,v){g.ior.value=p.ior,p.sheen>0&&(g.sheenColor.value.copy(p.sheenColor).multiplyScalar(p.sheen),g.sheenRoughness.value=p.sheenRoughness,p.sheenColorMap&&(g.sheenColorMap.value=p.sheenColorMap,t(p.sheenColorMap,g.sheenColorMapTransform)),p.sheenRoughnessMap&&(g.sheenRoughnessMap.value=p.sheenRoughnessMap,t(p.sheenRoughnessMap,g.sheenRoughnessMapTransform))),p.clearcoat>0&&(g.clearcoat.value=p.clearcoat,g.clearcoatRoughness.value=p.clearcoatRoughness,p.clearcoatMap&&(g.clearcoatMap.value=p.clearcoatMap,t(p.clearcoatMap,g.clearcoatMapTransform)),p.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=p.clearcoatRoughnessMap,t(p.clearcoatRoughnessMap,g.clearcoatRoughnessMapTransform)),p.clearcoatNormalMap&&(g.clearcoatNormalMap.value=p.clearcoatNormalMap,t(p.clearcoatNormalMap,g.clearcoatNormalMapTransform),g.clearcoatNormalScale.value.copy(p.clearcoatNormalScale),p.side===Hr&&g.clearcoatNormalScale.value.negate())),p.iridescence>0&&(g.iridescence.value=p.iridescence,g.iridescenceIOR.value=p.iridescenceIOR,g.iridescenceThicknessMinimum.value=p.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=p.iridescenceThicknessRange[1],p.iridescenceMap&&(g.iridescenceMap.value=p.iridescenceMap,t(p.iridescenceMap,g.iridescenceMapTransform)),p.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=p.iridescenceThicknessMap,t(p.iridescenceThicknessMap,g.iridescenceThicknessMapTransform))),p.transmission>0&&(g.transmission.value=p.transmission,g.transmissionSamplerMap.value=v.texture,g.transmissionSamplerSize.value.set(v.width,v.height),p.transmissionMap&&(g.transmissionMap.value=p.transmissionMap,t(p.transmissionMap,g.transmissionMapTransform)),g.thickness.value=p.thickness,p.thicknessMap&&(g.thicknessMap.value=p.thicknessMap,t(p.thicknessMap,g.thicknessMapTransform)),g.attenuationDistance.value=p.attenuationDistance,g.attenuationColor.value.copy(p.attenuationColor)),g.specularIntensity.value=p.specularIntensity,g.specularColor.value.copy(p.specularColor),p.specularColorMap&&(g.specularColorMap.value=p.specularColorMap,t(p.specularColorMap,g.specularColorMapTransform)),p.specularIntensityMap&&(g.specularIntensityMap.value=p.specularIntensityMap,t(p.specularIntensityMap,g.specularIntensityMapTransform))}(g,p,y)):p.isMeshMatcapMaterial?(s(g,p),function m(g,p){p.matcap&&(g.matcap.value=p.matcap)}(g,p)):p.isMeshDepthMaterial?s(g,p):p.isMeshDistanceMaterial?(s(g,p),function _(g,p){const v=e.get(p).light;g.referencePosition.value.setFromMatrixPosition(v.matrixWorld),g.nearDistance.value=v.shadow.camera.near,g.farDistance.value=v.shadow.camera.far}(g,p)):p.isMeshNormalMaterial?s(g,p):p.isLineBasicMaterial?(function o(g,p){g.diffuse.value.copy(p.color),g.opacity.value=p.opacity,p.map&&(g.map.value=p.map,t(p.map,g.mapTransform))}(g,p),p.isLineDashedMaterial&&function a(g,p){g.dashSize.value=p.dashSize,g.totalSize.value=p.dashSize+p.gapSize,g.scale.value=p.scale}(g,p)):p.isPointsMaterial?function l(g,p,v,b){g.diffuse.value.copy(p.color),g.opacity.value=p.opacity,g.size.value=p.size*v,g.scale.value=.5*b,p.map&&(g.map.value=p.map,t(p.map,g.uvTransform)),p.alphaMap&&(g.alphaMap.value=p.alphaMap),p.alphaTest>0&&(g.alphaTest.value=p.alphaTest)}(g,p,v,b):p.isSpriteMaterial?function c(g,p){g.diffuse.value.copy(p.color),g.opacity.value=p.opacity,g.rotation.value=p.rotation,p.map&&(g.map.value=p.map,t(p.map,g.mapTransform)),p.alphaMap&&(g.alphaMap.value=p.alphaMap),p.alphaTest>0&&(g.alphaTest.value=p.alphaTest)}(g,p):p.isShadowMaterial?(g.color.value.copy(p.color),g.opacity.value=p.opacity):p.isShaderMaterial&&(p.uniformsNeedUpdate=!1)}}}function Hae(i,e,t,n){let r={},s={},o=[];const a=t.isWebGL2?i.getParameter(35375):0;function f(v,b,y){const x=v.value;if(void 0===y[b]){if("number"==typeof x)y[b]=x;else{const w=Array.isArray(x)?x:[x],E=[];for(let S=0;S<w.length;S++)E.push(w[S].clone());y[b]=E}return!0}if("number"==typeof x){if(y[b]!==x)return y[b]=x,!0}else{const w=Array.isArray(y[b])?y[b]:[y[b]],E=Array.isArray(x)?x:[x];for(let S=0;S<w.length;S++){const C=w[S];if(!1===C.equals(E[S]))return C.copy(E[S]),!0}}return!1}function _(v){const b={boundary:0,storage:0};return"number"==typeof v?(b.boundary=4,b.storage=4):v.isVector2?(b.boundary=8,b.storage=8):v.isVector3||v.isColor?(b.boundary=16,b.storage=12):v.isVector4?(b.boundary=16,b.storage=16):v.isMatrix3?(b.boundary=48,b.storage=48):v.isMatrix4?(b.boundary=64,b.storage=64):v.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",v),b}function g(v){const b=v.target;b.removeEventListener("dispose",g);const y=o.indexOf(b.__bindingPointIndex);o.splice(y,1),i.deleteBuffer(r[b.id]),delete r[b.id],delete s[b.id]}return{bind:function l(v,b){n.uniformBlockBinding(v,b.program)},update:function c(v,b){let y=r[v.id];void 0===y&&(function m(v){const b=v.uniforms;let y=0;let w=0;for(let E=0,S=b.length;E<S;E++){const C=b[E],T={boundary:0,storage:0},k=Array.isArray(C.value)?C.value:[C.value];for(let U=0,L=k.length;U<L;U++){const H=_(k[U]);T.boundary+=H.boundary,T.storage+=H.storage}C.__data=new Float32Array(T.storage/Float32Array.BYTES_PER_ELEMENT),C.__offset=y,E>0&&(w=y%16,0!==w&&16-w-T.boundary<0&&(y+=16-w,C.__offset=y)),y+=T.storage}w=y%16,w>0&&(y+=16-w),v.__size=y,v.__cache={}}(v),y=function d(v){const b=function u(){for(let v=0;v<a;v++)if(-1===o.indexOf(v))return o.push(v),v;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();v.__bindingPointIndex=b;const y=i.createBuffer(),x=v.__size,w=v.usage;return i.bindBuffer(35345,y),i.bufferData(35345,x,w),i.bindBuffer(35345,null),i.bindBufferBase(35345,b,y),y}(v),r[v.id]=y,v.addEventListener("dispose",g)),n.updateUBOMapping(v,b.program);const w=e.render.frame;s[v.id]!==w&&(function h(v){const y=v.uniforms,x=v.__cache;i.bindBuffer(35345,r[v.id]);for(let w=0,E=y.length;w<E;w++){const S=y[w];if(!0===f(S,w,x)){const C=S.__offset,T=Array.isArray(S.value)?S.value:[S.value];let k=0;for(let U=0;U<T.length;U++){const L=T[U],j=_(L);"number"==typeof L?(S.__data[0]=L,i.bufferSubData(35345,C+k,S.__data)):L.isMatrix3?(S.__data[0]=L.elements[0],S.__data[1]=L.elements[1],S.__data[2]=L.elements[2],S.__data[3]=L.elements[0],S.__data[4]=L.elements[3],S.__data[5]=L.elements[4],S.__data[6]=L.elements[5],S.__data[7]=L.elements[0],S.__data[8]=L.elements[6],S.__data[9]=L.elements[7],S.__data[10]=L.elements[8],S.__data[11]=L.elements[0]):(L.toArray(S.__data,k),k+=j.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(35345,C,S.__data)}}i.bindBuffer(35345,null)}(v),s[v.id]=w)},dispose:function p(){for(const v in r)i.deleteBuffer(r[v]);o=[],r={},s={}}}}function Qae(){const i=ab("canvas");return i.style.display="block",i}class _b{constructor(e={}){const{canvas:t=Qae(),context:n=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:u=!1}=e;let h;this.isWebGLRenderer=!0,h=null!==n?n.getContextAttributes().alpha:o;let f=null,m=null;const _=[],g=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=$s,this.useLegacyLights=!0,this.toneMapping=ka,this.toneMappingExposure=1;const p=this;let v=!1,b=0,y=0,x=null,w=-1,E=null;const S=new ii,C=new ii;let T=null,k=t.width,U=t.height,L=1,j=null,H=null;const B=new ii(0,0,k,U),V=new ii(0,0,k,U);let O=!1;const Q=new rx;let oe=!1,be=!1,de=null;const X=new Qe,Y=new R,re={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function J(){return null===x?L:1}let Ee,me,qe,Me,we,Se,it,Xe,At,yt,lt,ht,xt,N,F,Ae,ke,Ue,et,Z,Ie,ye,Je,ct,D=n;function ue(z,ce){for(let De=0;De<z.length;De++){const M=t.getContext(z[De],ce);if(null!==M)return M}return null}try{const z={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:d,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${by}`),t.addEventListener("webglcontextlost",tt,!1),t.addEventListener("webglcontextrestored",Lt,!1),t.addEventListener("webglcontextcreationerror",It,!1),null===D){const ce=["webgl2","webgl","experimental-webgl"];if(!0===p.isWebGL1Renderer&&ce.shift(),D=ue(ce,z),null===D)throw ue(ce)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===D.getShaderPrecisionFormat&&(D.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(z){throw console.error("THREE.WebGLRenderer: "+z.message),z}function pt(){Ee=new aoe(D),me=new toe(D,Ee,e),Ee.init(me),ye=new ZU(D,Ee,me),qe=new jae(D,Ee,me),Me=new doe,we=new Sae,Se=new Uae(D,Ee,qe,we,me,ye,Me),it=new noe(p),Xe=new ooe(p),At=new ire(D,me),Je=new Jse(D,Ee,At,me),yt=new loe(D,At,Me,Je),lt=new poe(D,yt,At,Me),et=new foe(D,me,Se),Ae=new ioe(we),ht=new Eae(p,it,Xe,Ee,me,Je,Ae),xt=new Gae(p,we),N=new Rae,F=new Lae(Ee,me),Ue=new $se(p,it,Xe,qe,lt,h,l),ke=new Nae(p,lt,me),ct=new Hae(D,Me,me,qe),Z=new eoe(D,Ee,Me,me),Ie=new coe(D,Ee,Me,me),Me.programs=ht.programs,p.capabilities=me,p.extensions=Ee,p.properties=we,p.renderLists=N,p.shadowMap=ke,p.state=qe,p.info=Me}pt();const $e=new zae(p,D);function tt(z){z.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),v=!0}function Lt(){console.log("THREE.WebGLRenderer: Context Restored."),v=!1;const z=Me.autoReset,ce=ke.enabled,De=ke.autoUpdate,_e=ke.needsUpdate,M=ke.type;pt(),Me.autoReset=z,ke.enabled=ce,ke.autoUpdate=De,ke.needsUpdate=_e,ke.type=M}function It(z){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",z.statusMessage)}function Jt(z){const ce=z.target;ce.removeEventListener("dispose",Jt),function se(z){(function te(z){const ce=we.get(z).programs;void 0!==ce&&(ce.forEach(function(De){ht.releaseProgram(De)}),z.isShaderMaterial&&ht.releaseShaderCache(z))})(z),we.remove(z)}(ce)}this.xr=$e,this.getContext=function(){return D},this.getContextAttributes=function(){return D.getContextAttributes()},this.forceContextLoss=function(){const z=Ee.get("WEBGL_lose_context");z&&z.loseContext()},this.forceContextRestore=function(){const z=Ee.get("WEBGL_lose_context");z&&z.restoreContext()},this.getPixelRatio=function(){return L},this.setPixelRatio=function(z){void 0!==z&&(L=z,this.setSize(k,U,!1))},this.getSize=function(z){return z.set(k,U)},this.setSize=function(z,ce,De=!0){$e.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(k=z,U=ce,t.width=Math.floor(z*L),t.height=Math.floor(ce*L),!0===De&&(t.style.width=z+"px",t.style.height=ce+"px"),this.setViewport(0,0,z,ce))},this.getDrawingBufferSize=function(z){return z.set(k*L,U*L).floor()},this.setDrawingBufferSize=function(z,ce,De){k=z,U=ce,L=De,t.width=Math.floor(z*De),t.height=Math.floor(ce*De),this.setViewport(0,0,z,ce)},this.getCurrentViewport=function(z){return z.copy(S)},this.getViewport=function(z){return z.copy(B)},this.setViewport=function(z,ce,De,_e){z.isVector4?B.set(z.x,z.y,z.z,z.w):B.set(z,ce,De,_e),qe.viewport(S.copy(B).multiplyScalar(L).floor())},this.getScissor=function(z){return z.copy(V)},this.setScissor=function(z,ce,De,_e){z.isVector4?V.set(z.x,z.y,z.z,z.w):V.set(z,ce,De,_e),qe.scissor(C.copy(V).multiplyScalar(L).floor())},this.getScissorTest=function(){return O},this.setScissorTest=function(z){qe.setScissorTest(O=z)},this.setOpaqueSort=function(z){j=z},this.setTransparentSort=function(z){H=z},this.getClearColor=function(z){return z.copy(Ue.getClearColor())},this.setClearColor=function(){Ue.setClearColor.apply(Ue,arguments)},this.getClearAlpha=function(){return Ue.getClearAlpha()},this.setClearAlpha=function(){Ue.setClearAlpha.apply(Ue,arguments)},this.clear=function(z=!0,ce=!0,De=!0){let _e=0;z&&(_e|=16384),ce&&(_e|=256),De&&(_e|=1024),D.clear(_e)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",tt,!1),t.removeEventListener("webglcontextrestored",Lt,!1),t.removeEventListener("webglcontextcreationerror",It,!1),N.dispose(),F.dispose(),we.dispose(),it.dispose(),Xe.dispose(),lt.dispose(),Je.dispose(),ct.dispose(),ht.dispose(),$e.dispose(),$e.removeEventListener("sessionstart",Dt),$e.removeEventListener("sessionend",rn),de&&(de.dispose(),de=null),bn.stop()},this.renderBufferDirect=function(z,ce,De,_e,M,P){null===ce&&(ce=re);const G=M.isMesh&&M.matrixWorld.determinant()<0,ee=function Lg(z,ce,De,_e,M){!0!==ce.isScene&&(ce=re),Se.resetTextureUnits();const P=ce.fog,ee=null===x?p.outputEncoding:!0===x.isXRRenderTarget?x.texture.encoding:$s,ve=(_e.isMeshStandardMaterial?Xe:it).get(_e.envMap||(_e.isMeshStandardMaterial?ce.environment:null)),pe=!0===_e.vertexColors&&!!De.attributes.color&&4===De.attributes.color.itemSize,Te=!!_e.normalMap&&!!De.attributes.tangent,Be=!!De.morphAttributes.position,Ve=!!De.morphAttributes.normal,Fe=!!De.morphAttributes.color,Ze=_e.toneMapped?p.toneMapping:ka,bt=De.morphAttributes.position||De.morphAttributes.normal||De.morphAttributes.color,rt=void 0!==bt?bt.length:0,st=we.get(_e),ei=m.state.lights;!0!==oe||!0!==be&&z===E||Ae.setState(_e,z,z===E&&_e.id===w);let at=!1;_e.version===st.__version?(st.needsLights&&st.lightsStateVersion!==ei.state.version||st.outputEncoding!==ee||M.isInstancedMesh&&!1===st.instancing||!M.isInstancedMesh&&!0===st.instancing||M.isSkinnedMesh&&!1===st.skinning||!M.isSkinnedMesh&&!0===st.skinning||st.envMap!==ve||!0===_e.fog&&st.fog!==P||void 0!==st.numClippingPlanes&&(st.numClippingPlanes!==Ae.numPlanes||st.numIntersection!==Ae.numIntersection)||st.vertexAlphas!==pe||st.vertexTangents!==Te||st.morphTargets!==Be||st.morphNormals!==Ve||st.morphColors!==Fe||st.toneMapping!==Ze||!0===me.isWebGL2&&st.morphTargetsCount!==rt)&&(at=!0):(at=!0,st.__version=_e.version);let Ct=st.currentProgram;!0===at&&(Ct=Bg(_e,ce,M));let pi=!1,Ji=!1,vn=!1;const Zi=Ct.getUniforms(),Pi=st.uniforms;if(qe.useProgram(Ct.program)&&(pi=!0,Ji=!0,vn=!0),_e.id!==w&&(w=_e.id,Ji=!0),pi||E!==z){if(Zi.setValue(D,"projectionMatrix",z.projectionMatrix),me.logarithmicDepthBuffer&&Zi.setValue(D,"logDepthBufFC",2/(Math.log(z.far+1)/Math.LN2)),E!==z&&(E=z,Ji=!0,vn=!0),_e.isShaderMaterial||_e.isMeshPhongMaterial||_e.isMeshToonMaterial||_e.isMeshStandardMaterial||_e.envMap){const ki=Zi.map.cameraPosition;void 0!==ki&&ki.setValue(D,Y.setFromMatrixPosition(z.matrixWorld))}(_e.isMeshPhongMaterial||_e.isMeshToonMaterial||_e.isMeshLambertMaterial||_e.isMeshBasicMaterial||_e.isMeshStandardMaterial||_e.isShaderMaterial)&&Zi.setValue(D,"isOrthographic",!0===z.isOrthographicCamera),(_e.isMeshPhongMaterial||_e.isMeshToonMaterial||_e.isMeshLambertMaterial||_e.isMeshBasicMaterial||_e.isMeshStandardMaterial||_e.isShaderMaterial||_e.isShadowMaterial||M.isSkinnedMesh)&&Zi.setValue(D,"viewMatrix",z.matrixWorldInverse)}if(M.isSkinnedMesh){Zi.setOptional(D,M,"bindMatrix"),Zi.setOptional(D,M,"bindMatrixInverse");const ki=M.skeleton;ki&&(me.floatVertexTextures?(null===ki.boneTexture&&ki.computeBoneTexture(),Zi.setValue(D,"boneTexture",ki.boneTexture,Se),Zi.setValue(D,"boneTextureSize",ki.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Ci=De.morphAttributes;if((void 0!==Ci.position||void 0!==Ci.normal||void 0!==Ci.color&&!0===me.isWebGL2)&&et.update(M,De,Ct),(Ji||st.receiveShadow!==M.receiveShadow)&&(st.receiveShadow=M.receiveShadow,Zi.setValue(D,"receiveShadow",M.receiveShadow)),_e.isMeshGouraudMaterial&&null!==_e.envMap&&(Pi.envMap.value=ve,Pi.flipEnvMap.value=ve.isCubeTexture&&!1===ve.isRenderTargetTexture?-1:1),Ji&&(Zi.setValue(D,"toneMappingExposure",p.toneMappingExposure),st.needsLights&&function Z2(z,ce){z.ambientLightColor.needsUpdate=ce,z.lightProbe.needsUpdate=ce,z.directionalLights.needsUpdate=ce,z.directionalLightShadows.needsUpdate=ce,z.pointLights.needsUpdate=ce,z.pointLightShadows.needsUpdate=ce,z.spotLights.needsUpdate=ce,z.spotLightShadows.needsUpdate=ce,z.rectAreaLights.needsUpdate=ce,z.hemisphereLights.needsUpdate=ce}(Pi,vn),P&&!0===_e.fog&&xt.refreshFogUniforms(Pi,P),xt.refreshMaterialUniforms(Pi,_e,L,U,de),lx.upload(D,st.uniformsList,Pi,Se)),_e.isShaderMaterial&&!0===_e.uniformsNeedUpdate&&(lx.upload(D,st.uniformsList,Pi,Se),_e.uniformsNeedUpdate=!1),_e.isSpriteMaterial&&Zi.setValue(D,"center",M.center),Zi.setValue(D,"modelViewMatrix",M.modelViewMatrix),Zi.setValue(D,"normalMatrix",M.normalMatrix),Zi.setValue(D,"modelMatrix",M.matrixWorld),_e.isShaderMaterial||_e.isRawShaderMaterial){const ki=_e.uniformsGroups;for(let Zr=0,hr=ki.length;Zr<hr;Zr++)if(me.isWebGL2){const Fi=ki[Zr];ct.update(Fi,Ct),ct.bind(Fi,Ct)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Ct}(z,ce,De,_e,M);qe.setMaterial(_e,G);let ve=De.index,pe=1;!0===_e.wireframe&&(ve=yt.getWireframeAttribute(De),pe=2);const Te=De.drawRange,Be=De.attributes.position;let Ve=Te.start*pe,Fe=(Te.start+Te.count)*pe;null!==P&&(Ve=Math.max(Ve,P.start*pe),Fe=Math.min(Fe,(P.start+P.count)*pe)),null!==ve?(Ve=Math.max(Ve,0),Fe=Math.min(Fe,ve.count)):null!=Be&&(Ve=Math.max(Ve,0),Fe=Math.min(Fe,Be.count));const Ze=Fe-Ve;if(Ze<0||Ze===1/0)return;Je.setup(M,_e,ee,De,ve);let bt,rt=Z;if(null!==ve&&(bt=At.get(ve),rt=Ie,rt.setIndex(bt)),M.isMesh)!0===_e.wireframe?(qe.setLineWidth(_e.wireframeLinewidth*J()),rt.setMode(1)):rt.setMode(4);else if(M.isLine){let st=_e.linewidth;void 0===st&&(st=1),qe.setLineWidth(st*J()),rt.setMode(M.isLineSegments?1:M.isLineLoop?2:3)}else M.isPoints?rt.setMode(0):M.isSprite&&rt.setMode(4);if(M.isInstancedMesh)rt.renderInstances(Ve,Ze,M.count);else if(De.isInstancedBufferGeometry){const ei=Math.min(De.instanceCount,void 0!==De._maxInstanceCount?De._maxInstanceCount:1/0);rt.renderInstances(Ve,Ze,ei)}else rt.render(Ve,Ze)},this.compile=function(z,ce){function De(_e,M,P){!0===_e.transparent&&_e.side===os&&!1===_e.forceSinglePass?(_e.side=Hr,_e.needsUpdate=!0,Bg(_e,M,P),_e.side=Da,_e.needsUpdate=!0,Bg(_e,M,P),_e.side=os):Bg(_e,M,P)}m=F.get(z),m.init(),g.push(m),z.traverseVisible(function(_e){_e.isLight&&_e.layers.test(ce.layers)&&(m.pushLight(_e),_e.castShadow&&m.pushShadow(_e))}),m.setupLights(p.useLegacyLights),z.traverse(function(_e){const M=_e.material;if(M)if(Array.isArray(M))for(let P=0;P<M.length;P++)De(M[P],z,_e);else De(M,z,_e)}),g.pop(),m=null};let Ge=null;function Dt(){bn.stop()}function rn(){bn.start()}const bn=new CU;function Sr(z,ce,De,_e){if(!1===z.visible)return;if(z.layers.test(ce.layers))if(z.isGroup)De=z.renderOrder;else if(z.isLOD)!0===z.autoUpdate&&z.update(ce);else if(z.isLight)m.pushLight(z),z.castShadow&&m.pushShadow(z);else if(z.isSprite){if(!z.frustumCulled||Q.intersectsSprite(z)){_e&&Y.setFromMatrixPosition(z.matrixWorld).applyMatrix4(X);const G=lt.update(z),ee=z.material;ee.visible&&f.push(z,G,ee,De,Y.z,null)}}else if((z.isMesh||z.isLine||z.isPoints)&&(z.isSkinnedMesh&&z.skeleton.frame!==Me.render.frame&&(z.skeleton.update(),z.skeleton.frame=Me.render.frame),!z.frustumCulled||Q.intersectsObject(z))){_e&&Y.setFromMatrixPosition(z.matrixWorld).applyMatrix4(X);const G=lt.update(z),ee=z.material;if(Array.isArray(ee)){const ve=G.groups;for(let pe=0,Te=ve.length;pe<Te;pe++){const Be=ve[pe],Ve=ee[Be.materialIndex];Ve&&Ve.visible&&f.push(z,G,Ve,De,Y.z,Be)}}else ee.visible&&f.push(z,G,ee,De,Y.z,null)}const P=z.children;for(let G=0,ee=P.length;G<ee;G++)Sr(P[G],ce,De,_e)}function rl(z,ce,De,_e){const M=z.opaque,P=z.transmissive,G=z.transparent;m.setupLightsView(De),!0===oe&&Ae.setGlobalState(p.clippingPlanes,De),P.length>0&&function Bn(z,ce,De,_e){if(null===de){const ee=me.isWebGL2;de=new Gt(1024,1024,{generateMipmaps:!0,type:Ee.has("EXT_color_buffer_half_float")?mn:Qr,minFilter:Ks,samples:ee&&!0===a?4:0})}const M=p.getRenderTarget();p.setRenderTarget(de),p.clear();const P=p.toneMapping;p.toneMapping=ka,Ns(z,De,_e),Se.updateMultisampleRenderTarget(de),Se.updateRenderTargetMipmap(de);let G=!1;for(let ee=0,ve=ce.length;ee<ve;ee++){const pe=ce[ee],Te=pe.object,Be=pe.geometry,Ve=pe.material,Fe=pe.group;if(Ve.side===os&&Te.layers.test(_e.layers)){const Ze=Ve.side;Ve.side=Hr,Ve.needsUpdate=!0,Go(Te,De,_e,Be,Ve,Fe),Ve.side=Ze,Ve.needsUpdate=!0,G=!0}}!0===G&&(Se.updateMultisampleRenderTarget(de),Se.updateRenderTargetMipmap(de)),p.setRenderTarget(M),p.toneMapping=P}(M,P,ce,De),_e&&qe.viewport(S.copy(_e)),M.length>0&&Ns(M,ce,De),P.length>0&&Ns(P,ce,De),G.length>0&&Ns(G,ce,De),qe.buffers.depth.setTest(!0),qe.buffers.depth.setMask(!0),qe.buffers.color.setMask(!0),qe.setPolygonOffset(!1)}function Ns(z,ce,De){const _e=!0===ce.isScene?ce.overrideMaterial:null;for(let M=0,P=z.length;M<P;M++){const G=z[M],ee=G.object,ve=G.geometry,pe=null===_e?G.material:_e,Te=G.group;ee.layers.test(De.layers)&&Go(ee,ce,De,ve,pe,Te)}}function Go(z,ce,De,_e,M,P){z.onBeforeRender(p,ce,De,_e,M,P),z.modelViewMatrix.multiplyMatrices(De.matrixWorldInverse,z.matrixWorld),z.normalMatrix.getNormalMatrix(z.modelViewMatrix),M.onBeforeRender(p,ce,De,_e,z,P),!0===M.transparent&&M.side===os&&!1===M.forceSinglePass?(M.side=Hr,M.needsUpdate=!0,p.renderBufferDirect(De,ce,_e,M,z,P),M.side=Da,M.needsUpdate=!0,p.renderBufferDirect(De,ce,_e,M,z,P),M.side=os):p.renderBufferDirect(De,ce,_e,M,z,P),z.onAfterRender(p,ce,De,_e,M,P)}function Bg(z,ce,De){!0!==ce.isScene&&(ce=re);const _e=we.get(z),M=m.state.lights,G=M.state.version,ee=ht.getParameters(z,M.state,m.state.shadowsArray,ce,De),ve=ht.getProgramCacheKey(ee);let pe=_e.programs;_e.environment=z.isMeshStandardMaterial?ce.environment:null,_e.fog=ce.fog,_e.envMap=(z.isMeshStandardMaterial?Xe:it).get(z.envMap||_e.environment),void 0===pe&&(z.addEventListener("dispose",Jt),pe=new Map,_e.programs=pe);let Te=pe.get(ve);if(void 0!==Te){if(_e.currentProgram===Te&&_e.lightsStateVersion===G)return hM(z,ee),Te}else ee.uniforms=ht.getUniforms(z),z.onBuild(De,ee,p),z.onBeforeCompile(ee,p),Te=ht.acquireProgram(ee,ve),pe.set(ve,Te),_e.uniforms=ee.uniforms;const Be=_e.uniforms;(!z.isShaderMaterial&&!z.isRawShaderMaterial||!0===z.clipping)&&(Be.clippingPlanes=Ae.uniform),hM(z,ee),_e.needsLights=function yh(z){return z.isMeshLambertMaterial||z.isMeshToonMaterial||z.isMeshPhongMaterial||z.isMeshStandardMaterial||z.isShadowMaterial||z.isShaderMaterial&&!0===z.lights}(z),_e.lightsStateVersion=G,_e.needsLights&&(Be.ambientLightColor.value=M.state.ambient,Be.lightProbe.value=M.state.probe,Be.directionalLights.value=M.state.directional,Be.directionalLightShadows.value=M.state.directionalShadow,Be.spotLights.value=M.state.spot,Be.spotLightShadows.value=M.state.spotShadow,Be.rectAreaLights.value=M.state.rectArea,Be.ltc_1.value=M.state.rectAreaLTC1,Be.ltc_2.value=M.state.rectAreaLTC2,Be.pointLights.value=M.state.point,Be.pointLightShadows.value=M.state.pointShadow,Be.hemisphereLights.value=M.state.hemi,Be.directionalShadowMap.value=M.state.directionalShadowMap,Be.directionalShadowMatrix.value=M.state.directionalShadowMatrix,Be.spotShadowMap.value=M.state.spotShadowMap,Be.spotLightMatrix.value=M.state.spotLightMatrix,Be.spotLightMap.value=M.state.spotLightMap,Be.pointShadowMap.value=M.state.pointShadowMap,Be.pointShadowMatrix.value=M.state.pointShadowMatrix);const Ve=Te.getUniforms(),Fe=lx.seqWithValue(Ve.seq,Be);return _e.currentProgram=Te,_e.uniformsList=Fe,Te}function hM(z,ce){const De=we.get(z);De.outputEncoding=ce.outputEncoding,De.instancing=ce.instancing,De.skinning=ce.skinning,De.morphTargets=ce.morphTargets,De.morphNormals=ce.morphNormals,De.morphColors=ce.morphColors,De.morphTargetsCount=ce.morphTargetsCount,De.numClippingPlanes=ce.numClippingPlanes,De.numIntersection=ce.numClipIntersection,De.vertexAlphas=ce.vertexAlphas,De.vertexTangents=ce.vertexTangents,De.toneMapping=ce.toneMapping}bn.setAnimationLoop(function mt(z){Ge&&Ge(z)}),typeof self<"u"&&bn.setContext(self),this.setAnimationLoop=function(z){Ge=z,$e.setAnimationLoop(z),null===z?bn.stop():bn.start()},$e.addEventListener("sessionstart",Dt),$e.addEventListener("sessionend",rn),this.render=function(z,ce){if(void 0===ce||!0===ce.isCamera){if(!0!==v){if(!0===z.matrixWorldAutoUpdate&&z.updateMatrixWorld(),null===ce.parent&&!0===ce.matrixWorldAutoUpdate&&ce.updateMatrixWorld(),!0===$e.enabled&&!0===$e.isPresenting&&(!0===$e.cameraAutoUpdate&&$e.updateCamera(ce),ce=$e.getCamera()),!0===z.isScene&&z.onBeforeRender(p,z,ce,x),m=F.get(z,g.length),m.init(),g.push(m),X.multiplyMatrices(ce.projectionMatrix,ce.matrixWorldInverse),Q.setFromProjectionMatrix(X),be=this.localClippingEnabled,oe=Ae.init(this.clippingPlanes,be),f=N.get(z,_.length),f.init(),_.push(f),Sr(z,ce,0,p.sortObjects),f.finish(),!0===p.sortObjects&&f.sort(j,H),!0===oe&&Ae.beginShadows(),ke.render(m.state.shadowsArray,z,ce),!0===oe&&Ae.endShadows(),!0===this.info.autoReset&&this.info.reset(),Ue.render(f,z),m.setupLights(p.useLegacyLights),ce.isArrayCamera){const _e=ce.cameras;for(let M=0,P=_e.length;M<P;M++){const G=_e[M];rl(f,z,G,G.viewport)}}else rl(f,z,ce);null!==x&&(Se.updateMultisampleRenderTarget(x),Se.updateRenderTargetMipmap(x)),!0===z.isScene&&z.onAfterRender(p,z,ce),Je.resetDefaultState(),w=-1,E=null,g.pop(),m=g.length>0?g[g.length-1]:null,_.pop(),f=_.length>0?_[_.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return b},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return x},this.setRenderTargetTextures=function(z,ce,De){we.get(z.texture).__webglTexture=ce,we.get(z.depthTexture).__webglTexture=De;const _e=we.get(z);_e.__hasExternalTextures=!0,_e.__hasExternalTextures&&(_e.__autoAllocateDepthBuffer=void 0===De,_e.__autoAllocateDepthBuffer||!0===Ee.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),_e.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(z,ce){const De=we.get(z);De.__webglFramebuffer=ce,De.__useDefaultFramebuffer=void 0===ce},this.setRenderTarget=function(z,ce=0,De=0){x=z,b=ce,y=De;let _e=!0,M=null,P=!1,G=!1;if(z){const ve=we.get(z);void 0!==ve.__useDefaultFramebuffer?(qe.bindFramebuffer(36160,null),_e=!1):void 0===ve.__webglFramebuffer?Se.setupRenderTarget(z):ve.__hasExternalTextures&&Se.rebindTextures(z,we.get(z.texture).__webglTexture,we.get(z.depthTexture).__webglTexture);const pe=z.texture;(pe.isData3DTexture||pe.isDataArrayTexture||pe.isCompressedArrayTexture)&&(G=!0);const Te=we.get(z).__webglFramebuffer;z.isWebGLCubeRenderTarget?(M=Te[ce],P=!0):M=me.isWebGL2&&z.samples>0&&!1===Se.useMultisampledRTT(z)?we.get(z).__webglMultisampledFramebuffer:Te,S.copy(z.viewport),C.copy(z.scissor),T=z.scissorTest}else S.copy(B).multiplyScalar(L).floor(),C.copy(V).multiplyScalar(L).floor(),T=O;if(qe.bindFramebuffer(36160,M)&&me.drawBuffers&&_e&&qe.drawBuffers(z,M),qe.viewport(S),qe.scissor(C),qe.setScissorTest(T),P){const ve=we.get(z.texture);D.framebufferTexture2D(36160,36064,34069+ce,ve.__webglTexture,De)}else if(G){const ve=we.get(z.texture);D.framebufferTextureLayer(36160,36064,ve.__webglTexture,De||0,ce||0)}w=-1},this.readRenderTargetPixels=function(z,ce,De,_e,M,P,G){if(!z||!z.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ee=we.get(z).__webglFramebuffer;if(z.isWebGLCubeRenderTarget&&void 0!==G&&(ee=ee[G]),ee){qe.bindFramebuffer(36160,ee);try{const ve=z.texture,pe=ve.format,Te=ve.type;if(pe!==Rn&&ye.convert(pe)!==D.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Be=Te===mn&&(Ee.has("EXT_color_buffer_half_float")||me.isWebGL2&&Ee.has("EXT_color_buffer_float"));if(!(Te===Qr||ye.convert(Te)===D.getParameter(35738)||Te===Un&&(me.isWebGL2||Ee.has("OES_texture_float")||Ee.has("WEBGL_color_buffer_float"))||Be))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");ce>=0&&ce<=z.width-_e&&De>=0&&De<=z.height-M&&D.readPixels(ce,De,_e,M,ye.convert(pe),ye.convert(Te),P)}finally{const ve=null!==x?we.get(x).__webglFramebuffer:null;qe.bindFramebuffer(36160,ve)}}},this.copyFramebufferToTexture=function(z,ce,De=0){const _e=Math.pow(2,-De),M=Math.floor(ce.image.width*_e),P=Math.floor(ce.image.height*_e);Se.setTexture2D(ce,0),D.copyTexSubImage2D(3553,De,0,0,z.x,z.y,M,P),qe.unbindTexture()},this.copyTextureToTexture=function(z,ce,De,_e=0){const M=ce.image.width,P=ce.image.height,G=ye.convert(De.format),ee=ye.convert(De.type);Se.setTexture2D(De,0),D.pixelStorei(37440,De.flipY),D.pixelStorei(37441,De.premultiplyAlpha),D.pixelStorei(3317,De.unpackAlignment),ce.isDataTexture?D.texSubImage2D(3553,_e,z.x,z.y,M,P,G,ee,ce.image.data):ce.isCompressedTexture?D.compressedTexSubImage2D(3553,_e,z.x,z.y,ce.mipmaps[0].width,ce.mipmaps[0].height,G,ce.mipmaps[0].data):D.texSubImage2D(3553,_e,z.x,z.y,G,ee,ce.image),0===_e&&De.generateMipmaps&&D.generateMipmap(3553),qe.unbindTexture()},this.copyTextureToTexture3D=function(z,ce,De,_e,M=0){if(p.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const P=z.max.x-z.min.x+1,G=z.max.y-z.min.y+1,ee=z.max.z-z.min.z+1,ve=ye.convert(_e.format),pe=ye.convert(_e.type);let Te;if(_e.isData3DTexture)Se.setTexture3D(_e,0),Te=32879;else{if(!_e.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Se.setTexture2DArray(_e,0),Te=35866}D.pixelStorei(37440,_e.flipY),D.pixelStorei(37441,_e.premultiplyAlpha),D.pixelStorei(3317,_e.unpackAlignment);const Be=D.getParameter(3314),Ve=D.getParameter(32878),Fe=D.getParameter(3316),Ze=D.getParameter(3315),bt=D.getParameter(32877),rt=De.isCompressedTexture?De.mipmaps[0]:De.image;D.pixelStorei(3314,rt.width),D.pixelStorei(32878,rt.height),D.pixelStorei(3316,z.min.x),D.pixelStorei(3315,z.min.y),D.pixelStorei(32877,z.min.z),De.isDataTexture||De.isData3DTexture?D.texSubImage3D(Te,M,ce.x,ce.y,ce.z,P,G,ee,ve,pe,rt.data):De.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),D.compressedTexSubImage3D(Te,M,ce.x,ce.y,ce.z,P,G,ee,ve,rt.data)):D.texSubImage3D(Te,M,ce.x,ce.y,ce.z,P,G,ee,ve,pe,rt),D.pixelStorei(3314,Be),D.pixelStorei(32878,Ve),D.pixelStorei(3316,Fe),D.pixelStorei(3315,Ze),D.pixelStorei(32877,bt),0===M&&_e.generateMipmaps&&D.generateMipmap(Te),qe.unbindTexture()},this.initTexture=function(z){z.isCubeTexture?Se.setTextureCube(z,0):z.isData3DTexture?Se.setTexture3D(z,0):z.isDataArrayTexture||z.isCompressedArrayTexture?Se.setTexture2DArray(z,0):Se.setTexture2D(z,0),qe.unbindTexture()},this.resetState=function(){b=0,y=0,x=null,qe.reset(),Je.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}}class KU extends _b{}KU.prototype.isWebGL1Renderer=!0;class dx{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Le(e),this.density=t}clone(){return new dx(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class bb{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Le(e),this.near=t,this.far=n}clone(){return new bb(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class ux extends Qt{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class vb{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=sb,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=eo()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=eo()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=eo()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const us=new R;class yc{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)us.fromBufferAttribute(this,t),us.applyMatrix4(e),this.setXYZ(t,us.x,us.y,us.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)us.fromBufferAttribute(this,t),us.applyNormalMatrix(e),this.setXYZ(t,us.x,us.y,us.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)us.fromBufferAttribute(this,t),us.transformDirection(e),this.setXYZ(t,us.x,us.y,us.z);return this}setX(e,t){return this.normalized&&(t=hi(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=hi(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=hi(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=hi(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=to(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=to(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=to(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=to(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=hi(t,this.array),n=hi(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=hi(t,this.array),n=hi(n,this.array),r=hi(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=hi(t,this.array),n=hi(n,this.array),r=hi(r,this.array),s=hi(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Mi(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new yc(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class hx extends zn{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Le(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let sp;const Ab=new R,op=new R,ap=new R,lp=new fe,yb=new fe,$U=new Qe,fx=new R,xb=new R,px=new R,JU=new fe,sR=new fe,e4=new fe;class oR extends Qt{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",void 0===sp){sp=new Mt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new vb(t,5);sp.setIndex([0,1,2,0,2,3]),sp.setAttribute("position",new yc(n,3,0,!1)),sp.setAttribute("uv",new yc(n,2,3,!1))}this.geometry=sp,this.material=void 0!==e?e:new hx,this.center=new fe(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),op.setFromMatrixScale(this.matrixWorld),$U.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ap.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&op.multiplyScalar(-ap.z);const n=this.material.rotation;let r,s;0!==n&&(s=Math.cos(n),r=Math.sin(n));const o=this.center;mx(fx.set(-.5,-.5,0),ap,o,op,r,s),mx(xb.set(.5,-.5,0),ap,o,op,r,s),mx(px.set(.5,.5,0),ap,o,op,r,s),JU.set(0,0),sR.set(1,0),e4.set(1,1);let a=e.ray.intersectTriangle(fx,xb,px,!1,Ab);if(null===a&&(mx(xb.set(-.5,.5,0),ap,o,op,r,s),sR.set(0,1),a=e.ray.intersectTriangle(fx,px,xb,!1,Ab),null===a))return;const l=e.ray.origin.distanceTo(Ab);l<e.near||l>e.far||t.push({distance:l,point:Ab.clone(),uv:ls.getInterpolation(Ab,fx,xb,px,JU,sR,e4,new fe),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function mx(i,e,t,n,r,s){lp.subVectors(i,t).addScalar(.5).multiply(n),void 0!==r?(yb.x=s*lp.x-r*lp.y,yb.y=r*lp.x+s*lp.y):yb.copy(lp),i.copy(e),i.x+=yb.x,i.y+=yb.y,i.applyMatrix4($U)}const gx=new R,t4=new R;class aR extends Qt{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const s=t[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let s=t[n].distance;if(t[n].object.visible&&(s-=s*t[n].hysteresis),e<s)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){gx.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(gx);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){gx.setFromMatrixPosition(e.matrixWorld),t4.setFromMatrixPosition(this.matrixWorld);const n=gx.distanceTo(t4)/e.zoom;let r,s;for(t[0].object.visible=!0,r=1,s=t.length;r<s;r++){let o=t[r].distance;if(t[r].object.visible&&(o-=o*t[r].hysteresis),!(n>=o))break;t[r-1].object.visible=!1,t[r].object.visible=!0}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,s=n.length;r<s;r++){const o=n[r];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const n4=new R,r4=new ii,s4=new ii,Wae=new R,o4=new Qe,cp=new R;class wb extends nt{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Qe,this.bindMatrixInverse=new Qe,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new io),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)cp.fromBufferAttribute(t,n),this.applyBoneTransform(n,cp),this.boundingBox.expandByPoint(cp)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new Eo),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)cp.fromBufferAttribute(t,n),this.applyBoneTransform(n,cp),this.boundingSphere.expandByPoint(cp)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new ii,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;r4.fromBufferAttribute(r.attributes.skinIndex,e),s4.fromBufferAttribute(r.attributes.skinWeight,e),n4.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=s4.getComponent(s);if(0!==o){const a=r4.getComponent(s);o4.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(Wae.copy(n4).applyMatrix4(o4),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class ru extends Qt{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Fa extends An{constructor(e=null,t=1,n=1,r,s,o,a,l,c=$t,d=$t,u,h){super(null,o,a,l,c,d,r,s,u,h),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const a4=new Qe,qae=new Qe;class dp{constructor(e=[],t=[]){this.uuid=eo(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Qe)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Qe;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)a4.multiplyMatrices(e[s]?e[s].matrixWorld:qae,t[s]),a4.toArray(n,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new dp(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=rU(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Fa(t,e,e,Rn,Un);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const s=e.bones[n];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new ru),this.bones.push(o),this.boneInverses.push((new Qe).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(n[r].toArray());return e}}class up extends Mi{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const hp=new Qe,l4=new Qe,_x=[],c4=new io,Yae=new Qe,Cb=new nt,Mb=new Eo;class bx extends nt{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new up(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,Yae)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new io),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,hp),c4.copy(e.boundingBox).applyMatrix4(hp),this.boundingBox.union(c4)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new Eo),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,hp),Mb.copy(e.boundingSphere).applyMatrix4(hp),this.boundingSphere.union(Mb)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,r=this.count;if(Cb.geometry=this.geometry,Cb.material=this.material,void 0!==Cb.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),Mb.copy(this.boundingSphere),Mb.applyMatrix4(n),!1!==e.ray.intersectsSphere(Mb)))for(let s=0;s<r;s++){this.getMatrixAt(s,hp),l4.multiplyMatrices(n,hp),Cb.matrixWorld=l4,Cb.raycast(e,_x);for(let o=0,a=_x.length;o<a;o++){const l=_x[o];l.instanceId=s,l.object=this,t.push(l)}_x.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new up(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class gn extends zn{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Le(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const d4=new R,u4=new R,h4=new Qe,lR=new hb,vx=new Eo;class Gn extends Qt{constructor(e=new Mt,t=new gn){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)d4.fromBufferAttribute(t,r-1),u4.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=d4.distanceTo(u4);e.setAttribute("lineDistance",new Ke(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),vx.copy(n.boundingSphere),vx.applyMatrix4(r),vx.radius+=s,!1===e.ray.intersectsSphere(vx))return;h4.copy(r).invert(),lR.copy(e.ray).applyMatrix4(h4);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new R,d=new R,u=new R,h=new R,f=this.isLineSegments?2:1,m=n.index,g=n.attributes.position;if(null!==m)for(let b=Math.max(0,o.start),y=Math.min(m.count,o.start+o.count)-1;b<y;b+=f){const x=m.getX(b),w=m.getX(b+1);if(c.fromBufferAttribute(g,x),d.fromBufferAttribute(g,w),lR.distanceSqToSegment(c,d,h,u)>l)continue;h.applyMatrix4(this.matrixWorld);const S=e.ray.origin.distanceTo(h);S<e.near||S>e.far||t.push({distance:S,point:u.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}else for(let b=Math.max(0,o.start),y=Math.min(g.count,o.start+o.count)-1;b<y;b+=f){if(c.fromBufferAttribute(g,b),d.fromBufferAttribute(g,b+1),lR.distanceSqToSegment(c,d,h,u)>l)continue;h.applyMatrix4(this.matrixWorld);const w=e.ray.origin.distanceTo(h);w<e.near||w>e.far||t.push({distance:w,point:u.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const f4=new R,p4=new R;class Ss extends Gn{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)f4.fromBufferAttribute(t,r),p4.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+f4.distanceTo(p4);e.setAttribute("lineDistance",new Ke(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Ax extends Gn{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Pl extends zn{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Le(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const m4=new Qe,cR=new hb,yx=new Eo,xx=new R;class su extends Qt{constructor(e=new Mt,t=new Pl){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),yx.copy(n.boundingSphere),yx.applyMatrix4(r),yx.radius+=s,!1===e.ray.intersectsSphere(yx))return;m4.copy(r).invert(),cR.copy(e.ray).applyMatrix4(m4);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=n.index,u=n.attributes.position;if(null!==c)for(let m=Math.max(0,o.start),_=Math.min(c.count,o.start+o.count);m<_;m++){const g=c.getX(m);xx.fromBufferAttribute(u,g),g4(xx,g,l,r,e,t,this)}else for(let m=Math.max(0,o.start),_=Math.min(u.count,o.start+o.count);m<_;m++)xx.fromBufferAttribute(u,m),g4(xx,m,l,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function g4(i,e,t,n,r,s,o){const a=cR.distanceSqToPoint(i);if(a<t){const l=new R;cR.closestPointToPoint(i,l),l.applyMatrix4(n);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class _4 extends An{constructor(e,t,n,r,s,o,a,l,c){super(e,t,n,r,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=void 0!==o?o:Ui,this.magFilter=void 0!==s?s:Ui,this.generateMipmaps=!1;const d=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function u(){d.needsUpdate=!0,e.requestVideoFrameCallback(u)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e==0&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class b4 extends An{constructor(e,t,n){super({width:e,height:t}),this.isFramebufferTexture=!0,this.format=n,this.magFilter=$t,this.minFilter=$t,this.generateMipmaps=!1,this.needsUpdate=!0}}class Eb extends An{constructor(e,t,n,r,s,o,a,l,c,d,u,h){super(null,o,a,l,c,d,r,s,u,h),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class dR extends Eb{constructor(e,t,n,r,s,o){super(e,t,n,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=_r}}class wx extends An{constructor(e,t,n,r,s,o,a,l,c){super(e,t,n,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Ro{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let r=0;const s=n.length;let o;o=t||e*n[s-1];let c,a=0,l=s-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=n[r]-o,c<0)a=r+1;else{if(!(c>0)){l=r;break}l=r-1}if(r=l,n[r]===o)return r/(s-1);const d=n[r];return(r+(o-d)/(n[r+1]-d))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new fe:new R);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new R,r=[],s=[],o=[],a=new R,l=new Qe;for(let f=0;f<=e;f++)r[f]=this.getTangentAt(f/e,new R);s[0]=new R,o[0]=new R;let c=Number.MAX_VALUE;const d=Math.abs(r[0].x),u=Math.abs(r[0].y),h=Math.abs(r[0].z);d<=c&&(c=d,n.set(1,0,0)),u<=c&&(c=u,n.set(0,1,0)),h<=c&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const m=Math.acos(Vn(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(a,m))}o[f].crossVectors(r[f],s[f])}if(!0===t){let f=Math.acos(Vn(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let m=1;m<=e;m++)s[m].applyMatrix4(l.makeRotationAxis(r[m],f*m)),o[m].crossVectors(r[m],s[m])}return{tangents:r,normals:s,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class xc extends Ro{constructor(e=0,t=0,n=1,r=1,s=0,o=2*Math.PI,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const n=t||new fe,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=o?0:r),!0===this.aClockwise&&!o&&(s===r?s=-r:s-=r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const d=Math.cos(this.aRotation),u=Math.sin(this.aRotation),h=l-this.aX,f=c-this.aY;l=h*d-f*u+this.aX,c=h*u+f*d+this.aY}return n.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class v4 extends xc{constructor(e,t,n,r,s,o){super(e,t,n,n,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function uR(){let i=0,e=0,t=0,n=0;function r(s,o,a,l){i=s,e=a,t=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,d,u){let h=(o-s)/c-(a-s)/(c+d)+(a-o)/d,f=(a-o)/d-(l-o)/(d+u)+(l-a)/u;h*=d,f*=d,r(o,a,h,f)},calc:function(s){const o=s*s;return i+e*s+t*o+n*(o*s)}}}const Cx=new R,hR=new uR,fR=new uR,pR=new uR;class A4 extends Ro{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new R){const n=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let c,d,a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:0===l&&a===s-1&&(a=s-2,l=1),this.closed||a>0?c=r[(a-1)%s]:(Cx.subVectors(r[0],r[1]).add(r[0]),c=Cx);const u=r[a%s],h=r[(a+1)%s];if(this.closed||a+2<s?d=r[(a+2)%s]:(Cx.subVectors(r[s-1],r[s-2]).add(r[s-1]),d=Cx),"centripetal"===this.curveType||"chordal"===this.curveType){const f="chordal"===this.curveType?.5:.25;let m=Math.pow(c.distanceToSquared(u),f),_=Math.pow(u.distanceToSquared(h),f),g=Math.pow(h.distanceToSquared(d),f);_<1e-4&&(_=1),m<1e-4&&(m=_),g<1e-4&&(g=_),hR.initNonuniformCatmullRom(c.x,u.x,h.x,d.x,m,_,g),fR.initNonuniformCatmullRom(c.y,u.y,h.y,d.y,m,_,g),pR.initNonuniformCatmullRom(c.z,u.z,h.z,d.z,m,_,g)}else"catmullrom"===this.curveType&&(hR.initCatmullRom(c.x,u.x,h.x,d.x,this.tension),fR.initCatmullRom(c.y,u.y,h.y,d.y,this.tension),pR.initCatmullRom(c.z,u.z,h.z,d.z,this.tension));return n.set(hR.calc(l),fR.calc(l),pR.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push((new R).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function y4(i,e,t,n,r){const s=.5*(n-e),o=.5*(r-t),a=i*i;return(2*t-2*n+s+o)*(i*a)+(-3*t+3*n-2*s-o)*a+s*i+t}function Sb(i,e,t,n){return function Xae(i,e){const t=1-i;return t*t*e}(i,e)+function Zae(i,e){return 2*(1-i)*i*e}(i,t)+function Kae(i,e){return i*i*e}(i,n)}function Tb(i,e,t,n,r){return function $ae(i,e){const t=1-i;return t*t*t*e}(i,e)+function Jae(i,e){const t=1-i;return 3*t*t*i*e}(i,t)+function ele(i,e){return 3*(1-i)*i*i*e}(i,n)+function tle(i,e){return i*i*i*e}(i,r)}class mR extends Ro{constructor(e=new fe,t=new fe,n=new fe,r=new fe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new fe){const n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(Tb(e,r.x,s.x,o.x,a.x),Tb(e,r.y,s.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class x4 extends Ro{constructor(e=new R,t=new R,n=new R,r=new R){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new R){const n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(Tb(e,r.x,s.x,o.x,a.x),Tb(e,r.y,s.y,o.y,a.y),Tb(e,r.z,s.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Mx extends Ro{constructor(e=new fe,t=new fe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new fe){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new fe){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class w4 extends Ro{constructor(e=new R,t=new R){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new R){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new R){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class gR extends Ro{constructor(e=new fe,t=new fe,n=new fe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new fe){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(Sb(e,r.x,s.x,o.x),Sb(e,r.y,s.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class _R extends Ro{constructor(e=new R,t=new R,n=new R){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new R){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(Sb(e,r.x,s.x,o.x),Sb(e,r.y,s.y,o.y),Sb(e,r.z,s.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class bR extends Ro{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new fe){const n=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[0===o?o:o-1],c=r[o],d=r[o>r.length-2?r.length-1:o+1],u=r[o>r.length-3?r.length-1:o+2];return n.set(y4(a,l.x,c.x,d.x,u.x),y4(a,l.y,c.y,d.y,u.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push((new fe).fromArray(r))}return this}}var vR=Object.freeze({__proto__:null,ArcCurve:v4,CatmullRomCurve3:A4,CubicBezierCurve:mR,CubicBezierCurve3:x4,EllipseCurve:xc,LineCurve:Mx,LineCurve3:w4,QuadraticBezierCurve:gR,QuadraticBezierCurve3:_R,SplineCurve:bR});class C4 extends Ro{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Mx(t,e))}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const o=r[s]-n,a=this.curves[s],l=a.getLength();return a.getPointAt(0===l?0:1-o/l,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],l=o.getPoints(o.isEllipseCurve?2*e:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e);for(let c=0;c<l.length;c++){const d=l[c];n&&n.equals(d)||(t.push(d),n=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push((new vR[r.type]).fromJSON(r))}return this}}class Rb extends C4{constructor(e){super(),this.type="Path",this.currentPoint=new fe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new Mx(this.currentPoint.clone(),new fe(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const s=new gR(this.currentPoint.clone(),new fe(e,t),new fe(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,s,o){const a=new mR(this.currentPoint.clone(),new fe(e,t),new fe(n,r),new fe(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new bR(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,s,o){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,n,r,s,o),this}absarc(e,t,n,r,s,o){return this.absellipse(e,t,n,n,r,s,o),this}ellipse(e,t,n,r,s,o,a,l){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,n,r,s,o,a,l),this}absellipse(e,t,n,r,s,o,a,l){const c=new xc(e,t,n,r,s,o,a,l);if(this.curves.length>0){const u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);const d=c.getPoint(1);return this.currentPoint.copy(d),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class ou extends Mt{constructor(e=[new fe(0,-.5),new fe(.5,0),new fe(0,.5)],t=12,n=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=Vn(r,0,2*Math.PI);const s=[],o=[],a=[],l=[],c=[],d=1/t,u=new R,h=new fe,f=new R,m=new R,_=new R;let g=0,p=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:g=e[v+1].x-e[v].x,p=e[v+1].y-e[v].y,f.x=1*p,f.y=-g,f.z=0*p,_.copy(f),f.normalize(),l.push(f.x,f.y,f.z);break;case e.length-1:l.push(_.x,_.y,_.z);break;default:g=e[v+1].x-e[v].x,p=e[v+1].y-e[v].y,f.x=1*p,f.y=-g,f.z=0*p,m.copy(f),f.x+=_.x,f.y+=_.y,f.z+=_.z,f.normalize(),l.push(f.x,f.y,f.z),_.copy(m)}for(let v=0;v<=t;v++){const b=n+v*d*r,y=Math.sin(b),x=Math.cos(b);for(let w=0;w<=e.length-1;w++)u.x=e[w].x*y,u.y=e[w].y,u.z=e[w].x*x,o.push(u.x,u.y,u.z),h.x=v/t,h.y=w/(e.length-1),a.push(h.x,h.y),c.push(l[3*w+0]*y,l[3*w+1],l[3*w+0]*x)}for(let v=0;v<t;v++)for(let b=0;b<e.length-1;b++){const y=b+v*e.length,w=y+e.length,E=y+e.length+1,S=y+1;s.push(y,w,S),s.push(E,S,w)}this.setIndex(s),this.setAttribute("position",new Ke(o,3)),this.setAttribute("uv",new Ke(a,2)),this.setAttribute("normal",new Ke(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ou(e.points,e.segments,e.phiStart,e.phiLength)}}class fp extends ou{constructor(e=1,t=1,n=4,r=8){const s=new Rb;s.absarc(0,-t/2,e,1.5*Math.PI,0),s.absarc(0,t/2,e,0,.5*Math.PI),super(s.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r}}static fromJSON(e){return new fp(e.radius,e.length,e.capSegments,e.radialSegments)}}class pp extends Mt{constructor(e=1,t=32,n=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],l=[],c=new R,d=new fe;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let u=0,h=3;u<=t;u++,h+=3){const f=n+u/t*r;c.x=e*Math.cos(f),c.y=e*Math.sin(f),o.push(c.x,c.y,c.z),a.push(0,0,1),d.x=(o[h]/e+1)/2,d.y=(o[h+1]/e+1)/2,l.push(d.x,d.y)}for(let u=1;u<=t;u++)s.push(u,u+1,0);this.setIndex(s),this.setAttribute("position",new Ke(o,3)),this.setAttribute("normal",new Ke(a,3)),this.setAttribute("uv",new Ke(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pp(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Hn extends Mt{constructor(e=1,t=1,n=1,r=32,s=1,o=!1,a=0,l=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const d=[],u=[],h=[],f=[];let m=0;const _=[],g=n/2;let p=0;function b(y){const x=m,w=new fe,E=new R;let S=0;const C=!0===y?e:t,T=!0===y?1:-1;for(let U=1;U<=r;U++)u.push(0,g*T,0),h.push(0,T,0),f.push(.5,.5),m++;const k=m;for(let U=0;U<=r;U++){const j=U/r*l+a,H=Math.cos(j),B=Math.sin(j);E.x=C*B,E.y=g*T,E.z=C*H,u.push(E.x,E.y,E.z),h.push(0,T,0),w.x=.5*H+.5,w.y=.5*B*T+.5,f.push(w.x,w.y),m++}for(let U=0;U<r;U++){const L=x+U,j=k+U;!0===y?d.push(j,j+1,L):d.push(j+1,j,L),S+=3}c.addGroup(p,S,!0===y?1:2),p+=S}(function v(){const y=new R,x=new R;let w=0;const E=(t-e)/n;for(let S=0;S<=s;S++){const C=[],T=S/s,k=T*(t-e)+e;for(let U=0;U<=r;U++){const L=U/r,j=L*l+a,H=Math.sin(j),B=Math.cos(j);x.x=k*H,x.y=-T*n+g,x.z=k*B,u.push(x.x,x.y,x.z),y.set(H,E,B).normalize(),h.push(y.x,y.y,y.z),f.push(L,1-T),C.push(m++)}_.push(C)}for(let S=0;S<r;S++)for(let C=0;C<s;C++){const k=_[C+1][S],U=_[C+1][S+1],L=_[C][S+1];d.push(_[C][S],k,L),d.push(k,U,L),w+=6}c.addGroup(p,w,0),p+=w})(),!1===o&&(e>0&&b(!0),t>0&&b(!1)),this.setIndex(d),this.setAttribute("position",new Ke(u,3)),this.setAttribute("normal",new Ke(h,3)),this.setAttribute("uv",new Ke(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Hn(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class mp extends Hn{constructor(e=1,t=1,n=32,r=1,s=!1,o=0,a=2*Math.PI){super(0,e,t,n,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new mp(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Oa extends Mt{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const s=[],o=[];function l(v,b,y,x){const w=x+1,E=[];for(let S=0;S<=w;S++){E[S]=[];const C=v.clone().lerp(y,S/w),T=b.clone().lerp(y,S/w),k=w-S;for(let U=0;U<=k;U++)E[S][U]=0===U&&S===w?C:C.clone().lerp(T,U/k)}for(let S=0;S<w;S++)for(let C=0;C<2*(w-S)-1;C++){const T=Math.floor(C/2);C%2==0?(h(E[S][T+1]),h(E[S+1][T]),h(E[S][T])):(h(E[S][T+1]),h(E[S+1][T+1]),h(E[S+1][T]))}}function h(v){s.push(v.x,v.y,v.z)}function f(v,b){const y=3*v;b.x=e[y+0],b.y=e[y+1],b.z=e[y+2]}function _(v,b,y,x){x<0&&1===v.x&&(o[b]=v.x-1),0===y.x&&0===y.z&&(o[b]=x/2/Math.PI+.5)}function g(v){return Math.atan2(v.z,-v.x)}function p(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}(function a(v){const b=new R,y=new R,x=new R;for(let w=0;w<t.length;w+=3)f(t[w+0],b),f(t[w+1],y),f(t[w+2],x),l(b,y,x,v)})(r),function c(v){const b=new R;for(let y=0;y<s.length;y+=3)b.x=s[y+0],b.y=s[y+1],b.z=s[y+2],b.normalize().multiplyScalar(v),s[y+0]=b.x,s[y+1]=b.y,s[y+2]=b.z}(n),function d(){const v=new R;for(let b=0;b<s.length;b+=3){v.x=s[b+0],v.y=s[b+1],v.z=s[b+2];const y=g(v)/2/Math.PI+.5,x=p(v)/Math.PI+.5;o.push(y,1-x)}(function m(){const v=new R,b=new R,y=new R,x=new R,w=new fe,E=new fe,S=new fe;for(let C=0,T=0;C<s.length;C+=9,T+=6){v.set(s[C+0],s[C+1],s[C+2]),b.set(s[C+3],s[C+4],s[C+5]),y.set(s[C+6],s[C+7],s[C+8]),w.set(o[T+0],o[T+1]),E.set(o[T+2],o[T+3]),S.set(o[T+4],o[T+5]),x.copy(v).add(b).add(y).divideScalar(3);const k=g(x);_(w,T+0,v,k),_(E,T+2,b,k),_(S,T+4,y,k)}})(),function u(){for(let v=0;v<o.length;v+=6){const b=o[v+0],y=o[v+2],x=o[v+4],w=Math.max(b,y,x),E=Math.min(b,y,x);w>.9&&E<.1&&(b<.2&&(o[v+0]+=1),y<.2&&(o[v+2]+=1),x<.2&&(o[v+4]+=1))}}()}(),this.setAttribute("position",new Ke(s,3)),this.setAttribute("normal",new Ke(s.slice(),3)),this.setAttribute("uv",new Ke(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Oa(e.vertices,e.indices,e.radius,e.details)}}class gp extends Oa{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new gp(e.radius,e.detail)}}const Ex=new R,Sx=new R,AR=new R,Tx=new ls;class yR extends Mt{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const r=Math.pow(10,4),s=Math.cos(Xd*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],d=["a","b","c"],u=new Array(3),h={},f=[];for(let m=0;m<l;m+=3){o?(c[0]=o.getX(m),c[1]=o.getX(m+1),c[2]=o.getX(m+2)):(c[0]=m,c[1]=m+1,c[2]=m+2);const{a:_,b:g,c:p}=Tx;if(_.fromBufferAttribute(a,c[0]),g.fromBufferAttribute(a,c[1]),p.fromBufferAttribute(a,c[2]),Tx.getNormal(AR),u[0]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,u[1]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,u[2]=`${Math.round(p.x*r)},${Math.round(p.y*r)},${Math.round(p.z*r)}`,u[0]!==u[1]&&u[1]!==u[2]&&u[2]!==u[0])for(let v=0;v<3;v++){const b=(v+1)%3,y=u[v],x=u[b],w=Tx[d[v]],E=Tx[d[b]],S=`${y}_${x}`,C=`${x}_${y}`;C in h&&h[C]?(AR.dot(h[C].normal)<=s&&(f.push(w.x,w.y,w.z),f.push(E.x,E.y,E.z)),h[C]=null):S in h||(h[S]={index0:c[v],index1:c[b],normal:AR.clone()})}}for(const m in h)if(h[m]){const{index0:_,index1:g}=h[m];Ex.fromBufferAttribute(a,_),Sx.fromBufferAttribute(a,g),f.push(Ex.x,Ex.y,Ex.z),f.push(Sx.x,Sx.y,Sx.z)}this.setAttribute("position",new Ke(f,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class au extends Rb{constructor(e){super(e),this.uuid=eo(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push((new Rb).fromJSON(r))}return this}}function M4(i,e,t,n,r){let s,o;if(r===function ble(i,e,t,n){let r=0;for(let s=e,o=t-n;s<t;s+=n)r+=(i[o]-i[s])*(i[s+1]+i[o+1]),o=s;return r}(i,e,t,n)>0)for(s=e;s<t;s+=n)o=T4(s,i[s],i[s+1],o);else for(s=t-n;s>=e;s-=n)o=T4(s,i[s],i[s+1],o);return o&&Rx(o,o.next)&&(Pb(o),o=o.next),o}function lu(i,e){if(!i)return i;e||(e=i);let n,t=i;do{if(n=!1,t.steiner||!Rx(t,t.next)&&0!==Dn(t.prev,t,t.next))t=t.next;else{if(Pb(t),t=e=t.prev,t===t.next)break;n=!0}}while(n||t!==e);return e}function Ib(i,e,t,n,r,s,o){if(!i)return;!o&&s&&function hle(i,e,t,n){let r=i;do{0===r.z&&(r.z=xR(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,function fle(i){let e,t,n,r,s,o,a,l,c=1;do{for(t=i,i=null,s=null,o=0;t;){for(o++,n=t,a=0,e=0;e<c&&(a++,n=n.nextZ,n);e++);for(l=c;a>0||l>0&&n;)0!==a&&(0===l||!n||t.z<=n.z)?(r=t,t=t.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;t=n}s.nextZ=null,c*=2}while(o>1)}(r)}(i,n,r,s);let l,c,a=i;for(;i.prev!==i.next;)if(l=i.prev,c=i.next,s?rle(i,n,r,s):nle(i))e.push(l.i/t|0),e.push(i.i/t|0),e.push(c.i/t|0),Pb(i),i=c.next,a=c.next;else if((i=c)===a){o?1===o?Ib(i=sle(lu(i),e,t),e,t,n,r,s,2):2===o&&ole(i,e,t,n,r,s):Ib(lu(i),e,t,n,r,s,1);break}}function nle(i){const e=i.prev,t=i,n=i.next;if(Dn(e,t,n)>=0)return!1;const r=e.x,s=t.x,o=n.x,a=e.y,l=t.y,c=n.y,d=r<s?r<o?r:o:s<o?s:o,u=a<l?a<c?a:c:l<c?l:c,h=r>s?r>o?r:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c;let m=n.next;for(;m!==e;){if(m.x>=d&&m.x<=h&&m.y>=u&&m.y<=f&&_p(r,a,s,l,o,c,m.x,m.y)&&Dn(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function rle(i,e,t,n){const r=i.prev,s=i,o=i.next;if(Dn(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,d=r.y,u=s.y,h=o.y,f=a<l?a<c?a:c:l<c?l:c,m=d<u?d<h?d:h:u<h?u:h,_=a>l?a>c?a:c:l>c?l:c,g=d>u?d>h?d:h:u>h?u:h,p=xR(f,m,e,t,n),v=xR(_,g,e,t,n);let b=i.prevZ,y=i.nextZ;for(;b&&b.z>=p&&y&&y.z<=v;){if(b.x>=f&&b.x<=_&&b.y>=m&&b.y<=g&&b!==r&&b!==o&&_p(a,d,l,u,c,h,b.x,b.y)&&Dn(b.prev,b,b.next)>=0||(b=b.prevZ,y.x>=f&&y.x<=_&&y.y>=m&&y.y<=g&&y!==r&&y!==o&&_p(a,d,l,u,c,h,y.x,y.y)&&Dn(y.prev,y,y.next)>=0))return!1;y=y.nextZ}for(;b&&b.z>=p;){if(b.x>=f&&b.x<=_&&b.y>=m&&b.y<=g&&b!==r&&b!==o&&_p(a,d,l,u,c,h,b.x,b.y)&&Dn(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;y&&y.z<=v;){if(y.x>=f&&y.x<=_&&y.y>=m&&y.y<=g&&y!==r&&y!==o&&_p(a,d,l,u,c,h,y.x,y.y)&&Dn(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function sle(i,e,t){let n=i;do{const r=n.prev,s=n.next.next;!Rx(r,s)&&E4(r,n,n.next,s)&&Db(r,s)&&Db(s,r)&&(e.push(r.i/t|0),e.push(n.i/t|0),e.push(s.i/t|0),Pb(n),Pb(n.next),n=i=s),n=n.next}while(n!==i);return lu(n)}function ole(i,e,t,n,r,s){let o=i;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&mle(o,a)){let l=S4(o,a);return o=lu(o,o.next),l=lu(l,l.next),Ib(o,e,t,n,r,s,0),void Ib(l,e,t,n,r,s,0)}a=a.next}o=o.next}while(o!==i)}function lle(i,e){return i.x-e.x}function cle(i,e){const t=function dle(i,e){let r,t=e,n=-1/0;const s=i.x,o=i.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const h=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(h<=s&&h>n&&(n=h,r=t.x<t.next.x?t:t.next,h===s))return r}t=t.next}while(t!==e);if(!r)return null;const a=r,l=r.x,c=r.y;let u,d=1/0;t=r;do{s>=t.x&&t.x>=l&&s!==t.x&&_p(o<c?s:n,o,l,c,o<c?n:s,o,t.x,t.y)&&(u=Math.abs(o-t.y)/(s-t.x),Db(t,i)&&(u<d||u===d&&(t.x>r.x||t.x===r.x&&ule(r,t)))&&(r=t,d=u)),t=t.next}while(t!==a);return r}(i,e);if(!t)return e;const n=S4(t,i);return lu(n,n.next),lu(t,t.next)}function ule(i,e){return Dn(i.prev,i,e.prev)<0&&Dn(e.next,i,i.next)<0}function xR(i,e,t,n,r){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-t)*r|0)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function ple(i){let e=i,t=i;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==i);return t}function _p(i,e,t,n,r,s,o,a){return(r-o)*(e-a)>=(i-o)*(s-a)&&(i-o)*(n-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(n-a)}function mle(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function gle(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&E4(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}(i,e)&&(Db(i,e)&&Db(e,i)&&function _le(i,e){let t=i,n=!1;const r=(i.x+e.x)/2,s=(i.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next}while(t!==i);return n}(i,e)&&(Dn(i.prev,i,e.prev)||Dn(i,e.prev,e))||Rx(i,e)&&Dn(i.prev,i,i.next)>0&&Dn(e.prev,e,e.next)>0)}function Dn(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function Rx(i,e){return i.x===e.x&&i.y===e.y}function E4(i,e,t,n){const r=Dx(Dn(i,e,t)),s=Dx(Dn(i,e,n)),o=Dx(Dn(t,n,i)),a=Dx(Dn(t,n,e));return!!(r!==s&&o!==a||0===r&&Ix(i,t,e)||0===s&&Ix(i,n,e)||0===o&&Ix(t,i,n)||0===a&&Ix(t,e,n))}function Ix(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function Dx(i){return i>0?1:i<0?-1:0}function Db(i,e){return Dn(i.prev,i,i.next)<0?Dn(i,e,i.next)>=0&&Dn(i,i.prev,e)>=0:Dn(i,e,i.prev)<0||Dn(i,i.next,e)<0}function S4(i,e){const t=new wR(i.i,i.x,i.y),n=new wR(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function T4(i,e,t,n){const r=new wR(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function Pb(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function wR(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Na{static area(e){const t=e.length;let n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*n}static isClockWise(e){return Na.area(e)<0}static triangulateShape(e,t){const n=[],r=[],s=[];R4(e),I4(n,e);let o=e.length;t.forEach(R4);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,I4(n,t[l]);const a=function(i,e,t=2){const n=e&&e.length,r=n?e[0]*t:i.length;let s=M4(i,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,d,u,h,f;if(n&&(s=function ale(i,e,t,n){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:i.length,c=M4(i,a,l,n,!1),c===c.next&&(c.steiner=!0),r.push(ple(c));for(r.sort(lle),s=0;s<r.length;s++)t=cle(r[s],t);return t}(i,e,s,t)),i.length>80*t){a=c=i[0],l=d=i[1];for(let m=t;m<r;m+=t)u=i[m],h=i[m+1],u<a&&(a=u),h<l&&(l=h),u>c&&(c=u),h>d&&(d=h);f=Math.max(c-a,d-l),f=0!==f?32767/f:0}return Ib(s,o,t,a,l,f,0),o}(n,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function R4(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function I4(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class cu extends Mt{constructor(e=new au([new fe(.5,.5),new fe(-.5,.5),new fe(-.5,-.5),new fe(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++)o(e[a]);function o(a){const l=[],c=void 0!==t.curveSegments?t.curveSegments:12,d=void 0!==t.steps?t.steps:1,u=void 0!==t.depth?t.depth:1;let h=void 0===t.bevelEnabled||t.bevelEnabled,f=void 0!==t.bevelThickness?t.bevelThickness:.2,m=void 0!==t.bevelSize?t.bevelSize:f-.1,_=void 0!==t.bevelOffset?t.bevelOffset:0,g=void 0!==t.bevelSegments?t.bevelSegments:3;const p=t.extrudePath,v=void 0!==t.UVGenerator?t.UVGenerator:vle;let b,x,w,E,S,y=!1;p&&(b=p.getSpacedPoints(d),y=!0,h=!1,x=p.computeFrenetFrames(d,!1),w=new R,E=new R,S=new R),h||(g=0,f=0,m=0,_=0);const C=a.extractPoints(c);let T=C.shape;const k=C.holes;if(!Na.isClockWise(T)){T=T.reverse();for(let Me=0,we=k.length;Me<we;Me++){const Se=k[Me];Na.isClockWise(Se)&&(k[Me]=Se.reverse())}}const L=Na.triangulateShape(T,k),j=T;for(let Me=0,we=k.length;Me<we;Me++)T=T.concat(k[Me]);function H(Me,we,Se){return we||console.error("THREE.ExtrudeGeometry: vec does not exist"),Me.clone().addScaledVector(we,Se)}const B=T.length,V=L.length;function O(Me,we,Se){let it,Xe,At;const yt=Me.x-we.x,lt=Me.y-we.y,ht=Se.x-Me.x,xt=Se.y-Me.y,N=yt*yt+lt*lt;if(Math.abs(yt*xt-lt*ht)>Number.EPSILON){const Ae=Math.sqrt(N),ke=Math.sqrt(ht*ht+xt*xt),Ue=we.x-lt/Ae,et=we.y+yt/Ae,ye=((Se.x-xt/ke-Ue)*xt-(Se.y+ht/ke-et)*ht)/(yt*xt-lt*ht);it=Ue+yt*ye-Me.x,Xe=et+lt*ye-Me.y;const Je=it*it+Xe*Xe;if(Je<=2)return new fe(it,Xe);At=Math.sqrt(Je/2)}else{let Ae=!1;yt>Number.EPSILON?ht>Number.EPSILON&&(Ae=!0):yt<-Number.EPSILON?ht<-Number.EPSILON&&(Ae=!0):Math.sign(lt)===Math.sign(xt)&&(Ae=!0),Ae?(it=-lt,Xe=yt,At=Math.sqrt(N)):(it=yt,Xe=lt,At=Math.sqrt(N/2))}return new fe(it/At,Xe/At)}const Q=[];for(let Me=0,we=j.length,Se=we-1,it=Me+1;Me<we;Me++,Se++,it++)Se===we&&(Se=0),it===we&&(it=0),Q[Me]=O(j[Me],j[Se],j[it]);const oe=[];let be,de=Q.concat();for(let Me=0,we=k.length;Me<we;Me++){const Se=k[Me];be=[];for(let it=0,Xe=Se.length,At=Xe-1,yt=it+1;it<Xe;it++,At++,yt++)At===Xe&&(At=0),yt===Xe&&(yt=0),be[it]=O(Se[it],Se[At],Se[yt]);oe.push(be),de=de.concat(be)}for(let Me=0;Me<g;Me++){const we=Me/g,Se=f*Math.cos(we*Math.PI/2),it=m*Math.sin(we*Math.PI/2)+_;for(let Xe=0,At=j.length;Xe<At;Xe++){const yt=H(j[Xe],Q[Xe],it);D(yt.x,yt.y,-Se)}for(let Xe=0,At=k.length;Xe<At;Xe++){const yt=k[Xe];be=oe[Xe];for(let lt=0,ht=yt.length;lt<ht;lt++){const xt=H(yt[lt],be[lt],it);D(xt.x,xt.y,-Se)}}}const X=m+_;for(let Me=0;Me<B;Me++){const we=h?H(T[Me],de[Me],X):T[Me];y?(E.copy(x.normals[0]).multiplyScalar(we.x),w.copy(x.binormals[0]).multiplyScalar(we.y),S.copy(b[0]).add(E).add(w),D(S.x,S.y,S.z)):D(we.x,we.y,0)}for(let Me=1;Me<=d;Me++)for(let we=0;we<B;we++){const Se=h?H(T[we],de[we],X):T[we];y?(E.copy(x.normals[Me]).multiplyScalar(Se.x),w.copy(x.binormals[Me]).multiplyScalar(Se.y),S.copy(b[Me]).add(E).add(w),D(S.x,S.y,S.z)):D(Se.x,Se.y,u/d*Me)}for(let Me=g-1;Me>=0;Me--){const we=Me/g,Se=f*Math.cos(we*Math.PI/2),it=m*Math.sin(we*Math.PI/2)+_;for(let Xe=0,At=j.length;Xe<At;Xe++){const yt=H(j[Xe],Q[Xe],it);D(yt.x,yt.y,u+Se)}for(let Xe=0,At=k.length;Xe<At;Xe++){const yt=k[Xe];be=oe[Xe];for(let lt=0,ht=yt.length;lt<ht;lt++){const xt=H(yt[lt],be[lt],it);y?D(xt.x,xt.y+b[d-1].y,b[d-1].x+Se):D(xt.x,xt.y,u+Se)}}}function J(Me,we){let Se=Me.length;for(;--Se>=0;){const it=Se;let Xe=Se-1;Xe<0&&(Xe=Me.length-1);for(let At=0,yt=d+2*g;At<yt;At++){const lt=B*At,ht=B*(At+1);Ee(we+it+lt,we+Xe+lt,we+Xe+ht,we+it+ht)}}}function D(Me,we,Se){l.push(Me),l.push(we),l.push(Se)}function ue(Me,we,Se){me(Me),me(we),me(Se);const it=r.length/3,Xe=v.generateTopUV(n,r,it-3,it-2,it-1);qe(Xe[0]),qe(Xe[1]),qe(Xe[2])}function Ee(Me,we,Se,it){me(Me),me(we),me(it),me(we),me(Se),me(it);const Xe=r.length/3,At=v.generateSideWallUV(n,r,Xe-6,Xe-3,Xe-2,Xe-1);qe(At[0]),qe(At[1]),qe(At[3]),qe(At[1]),qe(At[2]),qe(At[3])}function me(Me){r.push(l[3*Me+0]),r.push(l[3*Me+1]),r.push(l[3*Me+2])}function qe(Me){s.push(Me.x),s.push(Me.y)}(function Y(){const Me=r.length/3;if(h){let we=0,Se=B*we;for(let it=0;it<V;it++){const Xe=L[it];ue(Xe[2]+Se,Xe[1]+Se,Xe[0]+Se)}we=d+2*g,Se=B*we;for(let it=0;it<V;it++){const Xe=L[it];ue(Xe[0]+Se,Xe[1]+Se,Xe[2]+Se)}}else{for(let we=0;we<V;we++){const Se=L[we];ue(Se[2],Se[1],Se[0])}for(let we=0;we<V;we++){const Se=L[we];ue(Se[0]+B*d,Se[1]+B*d,Se[2]+B*d)}}n.addGroup(Me,r.length/3-Me,0)})(),function re(){const Me=r.length/3;let we=0;J(j,we),we+=j.length;for(let Se=0,it=k.length;Se<it;Se++){const Xe=k[Se];J(Xe,we),we+=Xe.length}n.addGroup(Me,r.length/3-Me,1)}()}this.setAttribute("position",new Ke(r,3)),this.setAttribute("uv",new Ke(s,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function Ale(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++)t.shapes.push(i[n].uuid);else t.shapes.push(i.uuid);return t.options=Object.assign({},e),void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let s=0,o=e.shapes.length;s<o;s++)n.push(t[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new vR[r.type]).fromJSON(r)),new cu(n,e.options)}}const vle={generateTopUV:function(i,e,t,n,r){const a=e[3*n],l=e[3*n+1],c=e[3*r],d=e[3*r+1];return[new fe(e[3*t],e[3*t+1]),new fe(a,l),new fe(c,d)]},generateSideWallUV:function(i,e,t,n,r,s){const o=e[3*t],a=e[3*t+1],l=e[3*t+2],c=e[3*n],d=e[3*n+1],u=e[3*n+2],h=e[3*r],f=e[3*r+1],m=e[3*r+2],_=e[3*s],g=e[3*s+1],p=e[3*s+2];return Math.abs(a-d)<Math.abs(o-c)?[new fe(o,1-l),new fe(c,1-u),new fe(h,1-m),new fe(_,1-p)]:[new fe(a,1-l),new fe(d,1-u),new fe(f,1-m),new fe(g,1-p)]}};class bp extends Oa{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new bp(e.radius,e.detail)}}class aa extends Oa{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new aa(e.radius,e.detail)}}class vp extends Mt{constructor(e=.5,t=1,n=32,r=1,s=0,o=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:o},n=Math.max(3,n);const a=[],l=[],c=[],d=[];let u=e;const h=(t-e)/(r=Math.max(1,r)),f=new R,m=new fe;for(let _=0;_<=r;_++){for(let g=0;g<=n;g++){const p=s+g/n*o;f.x=u*Math.cos(p),f.y=u*Math.sin(p),l.push(f.x,f.y,f.z),c.push(0,0,1),m.x=(f.x/t+1)/2,m.y=(f.y/t+1)/2,d.push(m.x,m.y)}u+=h}for(let _=0;_<r;_++){const g=_*(n+1);for(let p=0;p<n;p++){const v=p+g,y=v+n+1,x=v+n+2,w=v+1;a.push(v,y,w),a.push(y,x,w)}}this.setIndex(a),this.setAttribute("position",new Ke(l,3)),this.setAttribute("normal",new Ke(c,3)),this.setAttribute("uv",new Ke(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vp(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Ap extends Mt{constructor(e=new au([new fe(0,.5),new fe(-.5,-.5),new fe(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],s=[],o=[];let a=0,l=0;if(!1===Array.isArray(e))c(e);else for(let d=0;d<e.length;d++)c(e[d]),this.addGroup(a,l,d),a+=l,l=0;function c(d){const u=r.length/3,h=d.extractPoints(t);let f=h.shape;const m=h.holes;!1===Na.isClockWise(f)&&(f=f.reverse());for(let g=0,p=m.length;g<p;g++){const v=m[g];!0===Na.isClockWise(v)&&(m[g]=v.reverse())}const _=Na.triangulateShape(f,m);for(let g=0,p=m.length;g<p;g++)f=f.concat(m[g]);for(let g=0,p=f.length;g<p;g++){const v=f[g];r.push(v.x,v.y,0),s.push(0,0,1),o.push(v.x,v.y)}for(let g=0,p=_.length;g<p;g++){const v=_[g];n.push(v[0]+u,v[1]+u,v[2]+u),l+=3}}this.setIndex(n),this.setAttribute("position",new Ke(r,3)),this.setAttribute("normal",new Ke(s,3)),this.setAttribute("uv",new Ke(o,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function yle(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++)e.shapes.push(i[t].uuid);else e.shapes.push(i.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++)n.push(t[e.shapes[r]]);return new Ap(n,e.curveSegments)}}class wc extends Mt{constructor(e=1,t=32,n=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const l=Math.min(o+a,Math.PI);let c=0;const d=[],u=new R,h=new R,f=[],m=[],_=[],g=[];for(let p=0;p<=n;p++){const v=[],b=p/n;let y=0;0===p&&0===o?y=.5/t:p===n&&l===Math.PI&&(y=-.5/t);for(let x=0;x<=t;x++){const w=x/t;u.x=-e*Math.cos(r+w*s)*Math.sin(o+b*a),u.y=e*Math.cos(o+b*a),u.z=e*Math.sin(r+w*s)*Math.sin(o+b*a),m.push(u.x,u.y,u.z),h.copy(u).normalize(),_.push(h.x,h.y,h.z),g.push(w+y,1-b),v.push(c++)}d.push(v)}for(let p=0;p<n;p++)for(let v=0;v<t;v++){const y=d[p][v],x=d[p+1][v],w=d[p+1][v+1];(0!==p||o>0)&&f.push(d[p][v+1],y,w),(p!==n-1||l<Math.PI)&&f.push(y,x,w)}this.setIndex(f),this.setAttribute("position",new Ke(m,3)),this.setAttribute("normal",new Ke(_,3)),this.setAttribute("uv",new Ke(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wc(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class yp extends Oa{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new yp(e.radius,e.detail)}}class la extends Mt{constructor(e=1,t=.4,n=12,r=48,s=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:s},n=Math.floor(n),r=Math.floor(r);const o=[],a=[],l=[],c=[],d=new R,u=new R,h=new R;for(let f=0;f<=n;f++)for(let m=0;m<=r;m++){const _=m/r*s,g=f/n*Math.PI*2;u.x=(e+t*Math.cos(g))*Math.cos(_),u.y=(e+t*Math.cos(g))*Math.sin(_),u.z=t*Math.sin(g),a.push(u.x,u.y,u.z),d.x=e*Math.cos(_),d.y=e*Math.sin(_),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(m/r),c.push(f/n)}for(let f=1;f<=n;f++)for(let m=1;m<=r;m++){const g=(r+1)*(f-1)+m-1,p=(r+1)*(f-1)+m,v=(r+1)*f+m;o.push((r+1)*f+m-1,g,v),o.push(g,p,v)}this.setIndex(o),this.setAttribute("position",new Ke(a,3)),this.setAttribute("normal",new Ke(l,3)),this.setAttribute("uv",new Ke(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new la(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class xp extends Mt{constructor(e=1,t=.4,n=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:s,q:o},n=Math.floor(n),r=Math.floor(r);const a=[],l=[],c=[],d=[],u=new R,h=new R,f=new R,m=new R,_=new R,g=new R,p=new R;for(let b=0;b<=n;++b){const y=b/n*s*Math.PI*2;v(y,s,o,e,f),v(y+.01,s,o,e,m),g.subVectors(m,f),p.addVectors(m,f),_.crossVectors(g,p),p.crossVectors(_,g),_.normalize(),p.normalize();for(let x=0;x<=r;++x){const w=x/r*Math.PI*2,E=-t*Math.cos(w),S=t*Math.sin(w);u.x=f.x+(E*p.x+S*_.x),u.y=f.y+(E*p.y+S*_.y),u.z=f.z+(E*p.z+S*_.z),l.push(u.x,u.y,u.z),h.subVectors(u,f).normalize(),c.push(h.x,h.y,h.z),d.push(b/n),d.push(x/r)}}for(let b=1;b<=n;b++)for(let y=1;y<=r;y++){const w=(r+1)*b+(y-1),E=(r+1)*b+y,S=(r+1)*(b-1)+y;a.push((r+1)*(b-1)+(y-1),w,S),a.push(w,E,S)}function v(b,y,x,w,E){const S=Math.cos(b),C=Math.sin(b),T=x/y*b,k=Math.cos(T);E.x=w*(2+k)*.5*S,E.y=w*(2+k)*C*.5,E.z=w*Math.sin(T)*.5}this.setIndex(a),this.setAttribute("position",new Ke(l,3)),this.setAttribute("normal",new Ke(c,3)),this.setAttribute("uv",new Ke(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xp(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class wp extends Mt{constructor(e=new _R(new R(-1,-1,0),new R(-1,1,0),new R(1,1,0)),t=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new R,l=new R,c=new fe;let d=new R;const u=[],h=[],f=[],m=[];function g(b){d=e.getPointAt(b/t,d);const y=o.normals[b],x=o.binormals[b];for(let w=0;w<=r;w++){const E=w/r*Math.PI*2,S=Math.sin(E),C=-Math.cos(E);l.x=C*y.x+S*x.x,l.y=C*y.y+S*x.y,l.z=C*y.z+S*x.z,l.normalize(),h.push(l.x,l.y,l.z),a.x=d.x+n*l.x,a.y=d.y+n*l.y,a.z=d.z+n*l.z,u.push(a.x,a.y,a.z)}}(function _(){for(let b=0;b<t;b++)g(b);g(!1===s?t:0),function v(){for(let b=0;b<=t;b++)for(let y=0;y<=r;y++)c.x=b/t,c.y=y/r,f.push(c.x,c.y)}(),function p(){for(let b=1;b<=t;b++)for(let y=1;y<=r;y++){const w=(r+1)*b+(y-1),E=(r+1)*b+y,S=(r+1)*(b-1)+y;m.push((r+1)*(b-1)+(y-1),w,S),m.push(w,E,S)}}()})(),this.setIndex(m),this.setAttribute("position",new Ke(u,3)),this.setAttribute("normal",new Ke(h,3)),this.setAttribute("uv",new Ke(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new wp((new vR[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class CR extends Mt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,r=new R,s=new R;if(null!==e.index){const o=e.attributes.position,a=e.index;let l=e.groups;0===l.length&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,d=l.length;c<d;++c){const u=l[c],h=u.start;for(let m=h,_=h+u.count;m<_;m+=3)for(let g=0;g<3;g++){const p=a.getX(m+g),v=a.getX(m+(g+1)%3);r.fromBufferAttribute(o,p),s.fromBufferAttribute(o,v),!0===D4(r,s,n)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const u=3*a+(c+1)%3;r.fromBufferAttribute(o,3*a+c),s.fromBufferAttribute(o,u),!0===D4(r,s,n)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Ke(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function D4(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return!0!==t.has(n)&&!0!==t.has(r)&&(t.add(n),t.add(r),!0)}var P4=Object.freeze({__proto__:null,BoxGeometry:tn,CapsuleGeometry:fp,CircleGeometry:pp,ConeGeometry:mp,CylinderGeometry:Hn,DodecahedronGeometry:gp,EdgesGeometry:yR,ExtrudeGeometry:cu,IcosahedronGeometry:bp,LatheGeometry:ou,OctahedronGeometry:aa,PlaneGeometry:Ac,PolyhedronGeometry:Oa,RingGeometry:vp,ShapeGeometry:Ap,SphereGeometry:wc,TetrahedronGeometry:yp,TorusGeometry:la,TorusKnotGeometry:xp,TubeGeometry:wp,WireframeGeometry:CR});class MR extends zn{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Le(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class ER extends Pt{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class ja extends zn{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Le(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Le(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mc,this.normalScale=new fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Ua extends ja{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new fe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Vn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Le(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Le(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Le(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class du extends zn{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Le(16777215),this.specular=new Le(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Le(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mc,this.normalScale=new fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=X_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class SR extends zn{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Le(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Le(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mc,this.normalScale=new fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Cp extends zn{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mc,this.normalScale=new fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class Px extends zn{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Le(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Le(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mc,this.normalScale=new fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=X_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class TR extends zn{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Le(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mc,this.normalScale=new fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class RR extends gn{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Io(i,e,t){return IR(i)?new i.constructor(i.subarray(e,void 0!==t?t:i.length)):i.slice(e,t)}function uu(i,e,t){return!i||!t&&i.constructor===e?i:"number"==typeof e.BYTES_PER_ELEMENT?new e(i):Array.prototype.slice.call(i)}function IR(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function k4(i){const t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(function e(r,s){return i[r]-i[s]}),n}function DR(i,e,t){const n=i.length,r=new i.constructor(n);for(let s=0,o=0;o!==n;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=i[a+l]}return r}function PR(i,e,t,n){let r=1,s=i[0];for(;void 0!==s&&void 0===s[n];)s=i[r++];if(void 0===s)return;let o=s[n];if(void 0!==o)if(Array.isArray(o))do{o=s[n],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=i[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[n],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=i[r++]}while(void 0!==s);else do{o=s[n],void 0!==o&&(e.push(s.time),t.push(o)),s=i[r++]}while(void 0!==s)}const Cle={arraySlice:Io,convertArray:uu,isTypedArray:IR,getKeyframeOrder:k4,sortedArray:DR,flattenJSON:PR,subclip:function xle(i,e,t,n,r=30){const s=i.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],d=c.getValueSize(),u=[],h=[];for(let f=0;f<c.times.length;++f){const m=c.times[f]*r;if(!(m<t||m>=n)){u.push(c.times[f]);for(let _=0;_<d;++_)h.push(c.values[f*d+_])}}0!==u.length&&(c.times=uu(u,c.times.constructor),c.values=uu(h,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function wle(i,e=0,t=i,n=30){n<=0&&(n=30);const r=t.tracks.length,s=e/n;for(let o=0;o<r;++o){const a=t.tracks[o],l=a.ValueTypeName;if("bool"===l||"string"===l)continue;const c=i.tracks.find(function(p){return p.name===a.name&&p.ValueTypeName===l});if(void 0===c)continue;let d=0;const u=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=u/3);let h=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=f/3);const m=a.times.length-1;let _;if(s<=a.times[0])_=Io(a.values,d,u-d);else if(s>=a.times[m]){const p=m*u+d;_=Io(a.values,p,p+u-d)}else{const p=a.createInterpolant(),v=d,b=u-d;p.evaluate(s),_=Io(p.resultBuffer,v,b)}"quaternion"===l&&(new xi).fromArray(_).normalize().conjugate().toArray(_);const g=c.times.length;for(let p=0;p<g;++p){const v=p*f+h;if("quaternion"===l)xi.multiplyQuaternionsFlat(c.values,v,_,0,c.values,v);else{const b=f-2*h;for(let y=0;y<b;++y)c.values[v+y]-=_[y]}}}return i.blendMode=ET,i}};class Mp{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let o;i:{n:if(!(e<r)){for(let a=n+2;;){if(void 0===r){if(e<s)break n;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(s=r,r=t[++n],e<r)break t}o=t.length;break i}if(e>=s)break e;{const a=t[1];e<a&&(n=2,s=a);for(let l=n-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(r=s,s=t[--n-1],e>=s)break t}o=n,n=0}}for(;n<o;){const a=n+o>>>1;e<t[a]?o=a:n=a+1}if(r=t[n],s=t[n-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=n[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class B4 extends Mp{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Wd,endingEnd:Wd}}intervalChanged_(e,t,n){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case qd:s=e,a=2*t-n;break;case nb:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=n}if(void 0===l)switch(this.getSettings_().endingEnd){case qd:o=e,l=2*n-t;break;case nb:o=1,l=n+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(n-t),d=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-n),this._offsetPrev=s*d,this._offsetNext=o*d}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,d=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,f=this._weightNext,m=(n-t)/(r-t),_=m*m,g=_*m,p=-h*g+2*h*_-h*m,v=(1+h)*g+(-1.5-2*h)*_+(-.5+h)*m+1,b=(-1-f)*g+(1.5+f)*_+.5*m,y=f*g-f*_;for(let x=0;x!==a;++x)s[x]=p*o[d+x]+v*o[c+x]+b*o[l+x]+y*o[u+x];return s}}class kR extends Mp{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,d=(n-t)/(r-t),u=1-d;for(let h=0;h!==a;++h)s[h]=o[c+h]*u+o[l+h]*d;return s}}class L4 extends Mp{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class ca{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=uu(t,this.TimeBufferType),this.values=uu(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:uu(e.times,Array),values:uu(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new L4(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new kR(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new B4(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Lf:t=this.InterpolantFactoryMethodDiscrete;break;case Qd:t=this.InterpolantFactoryMethodLinear;break;case Iy:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Lf;case this.InterpolantFactoryMethodLinear:return Qd;case this.InterpolantFactoryMethodSmooth:return Iy}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let s=0,o=r-1;for(;s!==r&&n[s]<e;)++s;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Io(n,s,o),this.values=Io(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=n[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&IR(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=Io(this.times),t=Io(this.values),n=this.getValueSize(),r=this.getInterpolation()===Iy,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const u=a*n,h=u-n,f=u+n;for(let m=0;m!==n;++m){const _=t[u+m];if(_!==t[h+m]||_!==t[f+m]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const u=a*n,h=o*n;for(let f=0;f!==n;++f)t[h+f]=t[u+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*n,l=o*n,c=0;c!==n;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=Io(e,0,o),this.values=Io(t,0,o*n)):(this.times=e,this.values=t),this}clone(){const e=Io(this.times,0),t=Io(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}ca.prototype.TimeBufferType=Float32Array,ca.prototype.ValueBufferType=Float32Array,ca.prototype.DefaultInterpolation=Qd;class hu extends ca{}hu.prototype.ValueTypeName="bool",hu.prototype.ValueBufferType=Array,hu.prototype.DefaultInterpolation=Lf,hu.prototype.InterpolantFactoryMethodLinear=void 0,hu.prototype.InterpolantFactoryMethodSmooth=void 0;class BR extends ca{}BR.prototype.ValueTypeName="color";class fu extends ca{}fu.prototype.ValueTypeName="number";class F4 extends Mp{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(n-t)/(r-t);let c=e*a;for(let d=c+a;c!==d;c+=4)xi.slerpFlat(s,0,o,c-a,o,c,l);return s}}class kl extends ca{InterpolantFactoryMethodLinear(e){return new F4(this.times,this.values,this.getValueSize(),e)}}kl.prototype.ValueTypeName="quaternion",kl.prototype.DefaultInterpolation=Qd,kl.prototype.InterpolantFactoryMethodSmooth=void 0;class pu extends ca{}pu.prototype.ValueTypeName="string",pu.prototype.ValueBufferType=Array,pu.prototype.DefaultInterpolation=Lf,pu.prototype.InterpolantFactoryMethodLinear=void 0,pu.prototype.InterpolantFactoryMethodSmooth=void 0;class mu extends ca{}mu.prototype.ValueTypeName="vector";class gu{constructor(e,t=-1,n,r=Dy){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=eo(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)t.push(Ele(n[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=n.length;s!==o;++s)t.push(ca.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const d=k4(l);l=DR(l,1,d),c=DR(c,1,d),!r&&0===l[0]&&(l.push(s),c.push(c[0])),o.push(new fu(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;Array.isArray(e)||(n=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],d=c.name.match(s);if(d&&d.length>1){const u=d[1];let h=r[u];h||(r[u]=h=[]),h.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(u,h,f,m,_){if(0!==f.length){const g=[],p=[];PR(f,g,p,m),0!==g.length&&_.push(new u(h,g,p))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let u=0;u<c.length;u++){const h=c[u].keys;if(h&&0!==h.length)if(h[0].morphTargets){const f={};let m;for(m=0;m<h.length;m++)if(h[m].morphTargets)for(let _=0;_<h[m].morphTargets.length;_++)f[h[m].morphTargets[_]]=-1;for(const _ in f){const g=[],p=[];for(let v=0;v!==h[m].morphTargets.length;++v){const b=h[m];g.push(b.time),p.push(b.morphTarget===_?1:0)}r.push(new fu(".morphTargetInfluence["+_+"]",g,p))}l=f.length*o}else{const f=".bones["+t[u].name+"]";n(mu,f+".position",h,"pos",r),n(kl,f+".quaternion",h,"rot",r),n(mu,f+".scale",h,"scl",r)}}return 0===r.length?null:new this(s,l,r,a)}resetDuration(){let t=0;for(let n=0,r=this.tracks.length;n!==r;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Ele(i){if(void 0===i.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function Mle(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return fu;case"vector":case"vector2":case"vector3":case"vector4":return mu;case"color":return BR;case"quaternion":return kl;case"bool":case"boolean":return hu;case"string":return pu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}(i.type);if(void 0===i.times){const t=[],n=[];PR(i.keys,t,n,"value"),i.times=t,i.values=n}return void 0!==e.parse?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const _u={enabled:!1,files:{},add:function(i,e){!1!==this.enabled&&(this.files[i]=e)},get:function(i){if(!1!==this.enabled)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class LR{constructor(e,t,n){const r=this;let l,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(d){a++,!1===s&&void 0!==r.onStart&&r.onStart(d,o,a),s=!0},this.itemEnd=function(d){o++,void 0!==r.onProgress&&r.onProgress(d,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(d){void 0!==r.onError&&r.onError(d)},this.resolveURL=function(d){return l?l(d):d},this.setURLModifier=function(d){return l=d,this},this.addHandler=function(d,u){return c.push(d,u),this},this.removeHandler=function(d){const u=c.indexOf(d);return-1!==u&&c.splice(u,2),this},this.getHandler=function(d){for(let u=0,h=c.length;u<h;u+=2){const f=c[u],m=c[u+1];if(f.global&&(f.lastIndex=0),f.test(d))return m}return null}}}const O4=new LR;class Ar{constructor(e){this.manager=void 0!==e?e:O4,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,s){n.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Bl={};class Sle extends Error{constructor(e,t){super(e),this.response=t}}class yr extends Ar{constructor(e){super(e)}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=_u.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==Bl[e])return void Bl[e].push({onLoad:t,onProgress:n,onError:r});Bl[e]=[],Bl[e].push({onLoad:t,onProgress:n,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===c.body||void 0===c.body.getReader)return c;const d=Bl[e],u=c.body.getReader(),h=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),f=h?parseInt(h):0,m=0!==f;let _=0;const g=new ReadableStream({start(p){!function v(){u.read().then(({done:b,value:y})=>{if(b)p.close();else{_+=y.byteLength;const x=new ProgressEvent("progress",{lengthComputable:m,loaded:_,total:f});for(let w=0,E=d.length;w<E;w++){const S=d[w];S.onProgress&&S.onProgress(x)}p.enqueue(y),v()}})}()}});return new Response(g)}throw new Sle(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(d=>(new DOMParser).parseFromString(d,a));case"json":return c.json();default:if(void 0===a)return c.text();{const u=/charset="?([^;"\s]*)"?/i.exec(a),h=u&&u[1]?u[1].toLowerCase():void 0,f=new TextDecoder(h);return c.arrayBuffer().then(m=>f.decode(m))}}}).then(c=>{_u.add(e,c);const d=Bl[e];delete Bl[e];for(let u=0,h=d.length;u<h;u++){const f=d[u];f.onLoad&&f.onLoad(c)}}).catch(c=>{const d=Bl[e];if(void 0===d)throw this.manager.itemError(e),c;delete Bl[e];for(let u=0,h=d.length;u<h;u++){const f=d[u];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Tle extends Ar{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new yr(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=gu.parse(e[n]);t.push(r)}return t}}class kx extends Ar{constructor(e){super(e)}load(e,t,n,r){const s=this,o=[],a=new Eb,l=new yr(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function d(u){l.load(e[u],function(h){const f=s.parse(h,!0);o[u]={width:f.width,height:f.height,format:f.format,mipmaps:f.mipmaps},c+=1,6===c&&(1===f.mipmapCount&&(a.minFilter=Ui),a.image=o,a.format=f.format,a.needsUpdate=!0,t&&t(a))},n,r)}if(Array.isArray(e))for(let u=0,h=e.length;u<h;++u)d(u);else l.load(e,function(u){const h=s.parse(u,!0);if(h.isCubemap){const f=h.mipmaps.length/h.mipmapCount;for(let m=0;m<f;m++){o[m]={mipmaps:[]};for(let _=0;_<h.mipmapCount;_++)o[m].mipmaps.push(h.mipmaps[m*h.mipmapCount+_]),o[m].format=h.format,o[m].width=h.width,o[m].height=h.height}a.image=o}else a.image.width=h.width,a.image.height=h.height,a.mipmaps=h.mipmaps;1===h.mipmapCount&&(a.minFilter=Ui),a.format=h.format,a.needsUpdate=!0,t&&t(a)},n,r);return a}}class kb extends Ar{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=_u.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=ab("img");function l(){d(),_u.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(u){d(),r&&r(u),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class N4 extends Ar{constructor(e){super(e)}load(e,t,n,r){const s=new Jd,o=new kb(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(d){s.images[c]=d,a++,6===a&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class Ep extends Ar{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new Fa,a=new yr(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){const c=s.parse(l);c&&(void 0!==c.image?o.image=c.image:void 0!==c.data&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=void 0!==c.wrapS?c.wrapS:_r,o.wrapT=void 0!==c.wrapT?c.wrapT:_r,o.magFilter=void 0!==c.magFilter?c.magFilter:Ui,o.minFilter=void 0!==c.minFilter?c.minFilter:Ui,o.anisotropy=void 0!==c.anisotropy?c.anisotropy:1,void 0!==c.encoding&&(o.encoding=c.encoding),void 0!==c.flipY&&(o.flipY=c.flipY),void 0!==c.format&&(o.format=c.format),void 0!==c.type&&(o.type=c.type),void 0!==c.mipmaps&&(o.mipmaps=c.mipmaps,o.minFilter=Ks),1===c.mipmapCount&&(o.minFilter=Ui),void 0!==c.generateMipmaps&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,t&&t(o,c))},n,r),o}}class Bx extends Ar{constructor(e){super(e)}load(e,t,n,r){const s=new An,o=new kb(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},n,r),s}}class Cc extends Qt{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Le(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class FR extends Cc{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Qt.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Le(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const OR=new Qe,j4=new R,U4=new R;class NR{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new fe(512,512),this.map=null,this.mapPass=null,this.matrix=new Qe,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new rx,this._frameExtents=new fe(1,1),this._viewportCount=1,this._viewports=[new ii(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;j4.setFromMatrixPosition(e.matrixWorld),t.position.copy(j4),U4.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(U4),t.updateMatrixWorld(),OR.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(OR),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(OR)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Rle extends NR{constructor(){super(new In(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*Ff*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Bb extends Cc{constructor(e,t,n=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Qt.DEFAULT_UP),this.updateMatrix(),this.target=new Qt,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new Rle}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const V4=new Qe,Lb=new R,jR=new R;class Ile extends NR{constructor(){super(new In(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new fe(4,2),this._viewportCount=6,this._viewports=[new ii(2,1,1,1),new ii(0,1,1,1),new ii(3,1,1,1),new ii(1,1,1,1),new ii(3,0,1,1),new ii(1,0,1,1)],this._cubeDirections=[new R(1,0,0),new R(-1,0,0),new R(0,0,1),new R(0,0,-1),new R(0,1,0),new R(0,-1,0)],this._cubeUps=[new R(0,1,0),new R(0,1,0),new R(0,1,0),new R(0,1,0),new R(0,0,1),new R(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),Lb.setFromMatrixPosition(e.matrixWorld),n.position.copy(Lb),jR.copy(n.position),jR.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(jR),n.updateMatrixWorld(),r.makeTranslation(-Lb.x,-Lb.y,-Lb.z),V4.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(V4)}}class Sp extends Cc{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new Ile}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Dle extends NR{constructor(){super(new La(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Fb extends Cc{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Qt.DEFAULT_UP),this.updateMatrix(),this.target=new Qt,this.shadow=new Dle}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Lx extends Cc{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class UR extends Cc{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class z4{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new R)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],n*r*1.092548),t.addScaledVector(o[5],r*s*1.092548),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],n*s*1.092548),t.addScaledVector(o[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*r),t.addScaledVector(o[2],1.023328*s),t.addScaledVector(o[3],1.023328*n),t.addScaledVector(o[4],.858086*n*r),t.addScaledVector(o[5],.858086*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],.858086*n*s),t.addScaledVector(o[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const n=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-r*r)}}class Ob extends Cc{constructor(e=new z4,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class Fx extends Ar{constructor(e){super(e),this.textures={}}load(e,t,n,r){const s=this,o=new yr(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const t=this.textures;function n(s){return void 0===t[s]&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const r=Fx.createMaterialFromType(e.type);if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=(new Le).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.iridescence&&(r.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(r.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(r.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&(r.vertexColors="number"==typeof e.vertexColors?e.vertexColors>0:e.vertexColors),void 0!==e.uniforms)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=n(o.value);break;case"c":r.uniforms[s].value=(new Le).setHex(o.value);break;case"v2":r.uniforms[s].value=(new fe).fromArray(o.value);break;case"v3":r.uniforms[s].value=(new R).fromArray(o.value);break;case"v4":r.uniforms[s].value=(new ii).fromArray(o.value);break;case"m3":r.uniforms[s].value=(new Ai).fromArray(o.value);break;case"m4":r.uniforms[s].value=(new Qe).fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(r.glslVersion=e.glslVersion),void 0!==e.extensions)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new fe).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new fe).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(r.iridescenceMap=n(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=n(e.thicknessMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:MR,SpriteMaterial:hx,RawShaderMaterial:ER,ShaderMaterial:Pt,PointsMaterial:Pl,MeshPhysicalMaterial:Ua,MeshStandardMaterial:ja,MeshPhongMaterial:du,MeshToonMaterial:SR,MeshNormalMaterial:Cp,MeshLambertMaterial:Px,MeshDepthMaterial:nu,MeshDistanceMaterial:cx,MeshBasicMaterial:$n,MeshMatcapMaterial:TR,LineDashedMaterial:RR,LineBasicMaterial:gn,Material:zn}[e]}}class bu{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class VR extends Mt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class G4 extends Ar{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new yr(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const t={},n={};function r(f,m){if(void 0!==t[m])return t[m];const g=f.interleavedBuffers[m],p=function s(f,m){if(void 0!==n[m])return n[m];const p=new Uint32Array(f.arrayBuffers[m]).buffer;return n[m]=p,p}(f,g.buffer),v=Of(g.type,p),b=new vb(v,g.stride);return b.uuid=g.uuid,t[m]=b,b}const o=e.isInstancedBufferGeometry?new VR:new Mt,a=e.data.index;if(void 0!==a){const f=Of(a.type,a.array);o.setIndex(new Mi(f,1))}const l=e.data.attributes;for(const f in l){const m=l[f];let _;if(m.isInterleavedBufferAttribute){const g=r(e.data,m.data);_=new yc(g,m.itemSize,m.offset,m.normalized)}else{const g=Of(m.type,m.array);_=new(m.isInstancedBufferAttribute?up:Mi)(g,m.itemSize,m.normalized)}void 0!==m.name&&(_.name=m.name),void 0!==m.usage&&_.setUsage(m.usage),void 0!==m.updateRange&&(_.updateRange.offset=m.updateRange.offset,_.updateRange.count=m.updateRange.count),o.setAttribute(f,_)}const c=e.data.morphAttributes;if(c)for(const f in c){const m=c[f],_=[];for(let g=0,p=m.length;g<p;g++){const v=m[g];let b;if(v.isInterleavedBufferAttribute){const y=r(e.data,v.data);b=new yc(y,v.itemSize,v.offset,v.normalized)}else{const y=Of(v.type,v.array);b=new Mi(y,v.itemSize,v.normalized)}void 0!==v.name&&(b.name=v.name),_.push(b)}o.morphAttributes[f]=_}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const u=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==u)for(let f=0,m=u.length;f!==m;++f){const _=u[f];o.addGroup(_.start,_.count,_.materialIndex)}const h=e.data.boundingSphere;if(void 0!==h){const f=new R;void 0!==h.center&&f.fromArray(h.center),o.boundingSphere=new Eo(f,h.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Ple extends Ar{constructor(e){super(e)}load(e,t,n,r){const s=this,o=""===this.path?bu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new yr(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(u){return void 0!==r&&r(u),void console.error("THREE:ObjectLoader: Can't parse "+e+".",u.message)}const d=c.metadata;if(void 0===d||void 0===d.type||"geometry"===d.type.toLowerCase())return void 0!==r&&r(new Error("THREE.ObjectLoader: Can't load "+e)),void console.error("THREE.ObjectLoader: Can't load "+e);s.parse(c,t)},n,r)}loadAsync(e,t){var n=this;return ss(function*(){const r=n,s=""===n.path?bu.extractUrlBase(e):n.path;n.resourcePath=n.resourcePath||s;const o=new yr(n.manager);o.setPath(n.path),o.setRequestHeader(n.requestHeader),o.setWithCredentials(n.withCredentials);const a=yield o.loadAsync(e,t),l=JSON.parse(a),c=l.metadata;if(void 0===c||void 0===c.type||"geometry"===c.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return yield r.parseAsync(l)})()}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){void 0!==t&&t(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,n),d=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,d),void 0!==t){let u=!1;for(const h in o)if(o[h].data instanceof HTMLImageElement){u=!0;break}!1===u&&t(c)}return c}parseAsync(e){var t=this;return ss(function*(){const n=t.parseAnimations(e.animations),r=t.parseShapes(e.shapes),s=t.parseGeometries(e.geometries,r),o=yield t.parseImagesAsync(e.images),a=t.parseTextures(e.textures,o),l=t.parseMaterials(e.materials,a),c=t.parseObject(e.object,s,l,a,n),d=t.parseSkeletons(e.skeletons,c);return t.bindSkeletons(c,d),c})()}parseShapes(e){const t={};if(void 0!==e)for(let n=0,r=e.length;n<r;n++){const s=(new au).fromJSON(e[n]);t[s.uuid]=s}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),void 0!==e)for(let s=0,o=e.length;s<o;s++){const a=(new dp).fromJSON(e[s],r);n[a.uuid]=a}return n}parseGeometries(e,t){const n={};if(void 0!==e){const r=new G4;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;default:l.type in P4?a=P4[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,void 0!==l.name&&(a.name=l.name),void 0!==l.userData&&(a.userData=l.userData),n[l.uuid]=a}}return n}parseMaterials(e,t){const n={},r={};if(void 0!==e){const s=new Fx;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const l=e[o];void 0===n[l.uuid]&&(n[l.uuid]=s.parse(l)),r[l.uuid]=n[l.uuid]}}return r}parseAnimations(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const s=gu.parse(e[n]);t[s.uuid]=s}return t}parseImages(e,t){const n=this,r={};let s;function a(l){if("string"==typeof l){const c=l;return function o(l){return n.manager.itemStart(l),s.load(l,function(){n.manager.itemEnd(l)},void 0,function(){n.manager.itemError(l),n.manager.itemEnd(l)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:n.resourcePath+c)}return l.data?{data:Of(l.type,l.data),width:l.width,height:l.height}:null}if(void 0!==e&&e.length>0){const l=new LR(t);s=new kb(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,d=e.length;c<d;c++){const u=e[c],h=u.url;if(Array.isArray(h)){const f=[];for(let m=0,_=h.length;m<_;m++){const p=a(h[m]);null!==p&&(p instanceof HTMLImageElement?f.push(p):f.push(new Fa(p.data,p.width,p.height)))}r[u.uuid]=new Zd(f)}else{const f=a(u.url);r[u.uuid]=new Zd(f)}}}return r}parseImagesAsync(e){var t=this;return ss(function*(){const n=t,r={};let s;function o(l){return a.apply(this,arguments)}function a(){return(a=ss(function*(l){if("string"==typeof l){const c=l,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:n.resourcePath+c;return yield s.loadAsync(d)}return l.data?{data:Of(l.type,l.data),width:l.width,height:l.height}:null})).apply(this,arguments)}if(void 0!==e&&e.length>0){s=new kb(t.manager),s.setCrossOrigin(t.crossOrigin);for(let l=0,c=e.length;l<c;l++){const d=e[l],u=d.url;if(Array.isArray(u)){const h=[];for(let f=0,m=u.length;f<m;f++){const _=u[f],g=yield o(_);null!==g&&(g instanceof HTMLImageElement?h.push(g):h.push(new Fa(g.data,g.width,g.height)))}r[d.uuid]=new Zd(h)}else{const h=yield o(d.url);r[d.uuid]=new Zd(h)}}}return r})()}parseTextures(e,t){function n(s,o){return"number"==typeof s?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(void 0!==e)for(let s=0,o=e.length;s<o;s++){const a=e[s];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=t[a.image],c=l.data;let d;Array.isArray(c)?(d=new Jd,6===c.length&&(d.needsUpdate=!0)):(d=c&&c.data?new Fa:new An,c&&(d.needsUpdate=!0)),d.source=l,d.uuid=a.uuid,void 0!==a.name&&(d.name=a.name),void 0!==a.mapping&&(d.mapping=n(a.mapping,kle)),void 0!==a.channel&&(d.channel=a.channel),void 0!==a.offset&&d.offset.fromArray(a.offset),void 0!==a.repeat&&d.repeat.fromArray(a.repeat),void 0!==a.center&&d.center.fromArray(a.center),void 0!==a.rotation&&(d.rotation=a.rotation),void 0!==a.wrap&&(d.wrapS=n(a.wrap[0],H4),d.wrapT=n(a.wrap[1],H4)),void 0!==a.format&&(d.format=a.format),void 0!==a.internalFormat&&(d.internalFormat=a.internalFormat),void 0!==a.type&&(d.type=a.type),void 0!==a.encoding&&(d.encoding=a.encoding),void 0!==a.minFilter&&(d.minFilter=n(a.minFilter,Q4)),void 0!==a.magFilter&&(d.magFilter=n(a.magFilter,Q4)),void 0!==a.anisotropy&&(d.anisotropy=a.anisotropy),void 0!==a.flipY&&(d.flipY=a.flipY),void 0!==a.generateMipmaps&&(d.generateMipmaps=a.generateMipmaps),void 0!==a.premultiplyAlpha&&(d.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(d.unpackAlignment=a.unpackAlignment),void 0!==a.userData&&(d.userData=a.userData),r[a.uuid]=d}return r}parseObject(e,t,n,r,s){let o,d,u;function a(h){return void 0===t[h]&&console.warn("THREE.ObjectLoader: Undefined geometry",h),t[h]}function l(h){if(void 0!==h){if(Array.isArray(h)){const f=[];for(let m=0,_=h.length;m<_;m++){const g=h[m];void 0===n[g]&&console.warn("THREE.ObjectLoader: Undefined material",g),f.push(n[g])}return f}return void 0===n[h]&&console.warn("THREE.ObjectLoader: Undefined material",h),n[h]}}function c(h){return void 0===r[h]&&console.warn("THREE.ObjectLoader: Undefined texture",h),r[h]}switch(e.type){case"Scene":o=new ux,void 0!==e.background&&(o.background=Number.isInteger(e.background)?new Le(e.background):c(e.background)),void 0!==e.environment&&(o.environment=c(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new bb(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new dx(e.fog.color,e.fog.density))),void 0!==e.backgroundBlurriness&&(o.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new In(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new La(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new Lx(e.color,e.intensity);break;case"DirectionalLight":o=new Fb(e.color,e.intensity);break;case"PointLight":o=new Sp(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new UR(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new Bb(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new FR(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=(new Ob).fromJSON(e);break;case"SkinnedMesh":d=a(e.geometry),u=l(e.material),o=new wb(d,u),void 0!==e.bindMode&&(o.bindMode=e.bindMode),void 0!==e.bindMatrix&&o.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(o.skeleton=e.skeleton);break;case"Mesh":d=a(e.geometry),u=l(e.material),o=new nt(d,u);break;case"InstancedMesh":d=a(e.geometry),u=l(e.material);const f=e.instanceMatrix,m=e.instanceColor;o=new bx(d,u,e.count),o.instanceMatrix=new up(new Float32Array(f.array),16),void 0!==m&&(o.instanceColor=new up(new Float32Array(m.array),m.itemSize));break;case"LOD":o=new aR;break;case"Line":o=new Gn(a(e.geometry),l(e.material));break;case"LineLoop":o=new Ax(a(e.geometry),l(e.material));break;case"LineSegments":o=new Ss(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new su(a(e.geometry),l(e.material));break;case"Sprite":o=new oR(l(e.material));break;case"Group":o=new Es;break;case"Bone":o=new ru;break;default:o=new Qt}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(o.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.up&&o.up.fromArray(e.up),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(o.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.frustumCulled&&(o.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(o.renderOrder=e.renderOrder),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.layers&&(o.layers.mask=e.layers),void 0!==e.children){const h=e.children;for(let f=0;f<h.length;f++)o.add(this.parseObject(h[f],t,n,r,s))}if(void 0!==e.animations){const h=e.animations;for(let f=0;f<h.length;f++)o.animations.push(s[h[f]])}if("LOD"===e.type){void 0!==e.autoUpdate&&(o.autoUpdate=e.autoUpdate);const h=e.levels;for(let f=0;f<h.length;f++){const m=h[f],_=o.getObjectByProperty("uuid",m.object);void 0!==_&&o.addLevel(_,m.distance,m.hysteresis)}}return o}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse(function(n){if(!0===n.isSkinnedMesh&&void 0!==n.skeleton){const r=t[n.skeleton];void 0===r?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}}const kle={UVMapping:xy,CubeReflectionMapping:cc,CubeRefractionMapping:dc,EquirectangularReflectionMapping:Ef,EquirectangularRefractionMapping:Z_,CubeUVReflectionMapping:Sf},H4={RepeatWrapping:Mo,ClampToEdgeWrapping:_r,MirroredRepeatWrapping:Tf},Q4={NearestFilter:$t,NearestMipmapNearestFilter:K_,NearestMipmapLinearFilter:Rf,LinearFilter:Ui,LinearMipmapNearestFilter:wy,LinearMipmapLinearFilter:Ks};class W4 extends Ar{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=_u.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){_u.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let Ox;class zR{static getContext(){return void 0===Ox&&(Ox=new(window.AudioContext||window.webkitAudioContext)),Ox}static setContext(e){Ox=e}}class Ble extends Ar{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new yr(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{const l=a.slice(0);zR.getContext().decodeAudioData(l,function(d){t(d)})}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}}class q4 extends Ob{constructor(e,t,n=1){super(void 0,n),this.isHemisphereLightProbe=!0;const r=(new Le).set(e),s=(new Le).set(t),o=new R(r.r,r.g,r.b),a=new R(s.r,s.g,s.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}}class Y4 extends Ob{constructor(e,t=1){super(void 0,t),this.isAmbientLightProbe=!0;const n=(new Le).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const X4=new Qe,Z4=new Qe,vu=new Qe;class K4{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new In,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new In,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,vu.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,o=t.near*Math.tan(Xd*t.fov*.5)/t.zoom;let a,l;Z4.elements[12]=-r,X4.elements[12]=r,a=-o*t.aspect+s,l=o*t.aspect+s,vu.elements[0]=2*t.near/(l-a),vu.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(vu),a=-o*t.aspect-s,l=o*t.aspect-s,vu.elements[0]=2*t.near/(l-a),vu.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(vu)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Z4),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(X4)}}class Au{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=$4(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=$4();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function $4(){return(typeof performance>"u"?Date:performance).now()}const yu=new R,J4=new xi,Lle=new R,xu=new R;class e5 extends Qt{constructor(){super(),this.type="AudioListener",this.context=zR.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Au}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(yu,J4,Lle),xu.set(0,0,-1).applyQuaternion(J4),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(yu.x,r),t.positionY.linearRampToValueAtTime(yu.y,r),t.positionZ.linearRampToValueAtTime(yu.z,r),t.forwardX.linearRampToValueAtTime(xu.x,r),t.forwardY.linearRampToValueAtTime(xu.y,r),t.forwardZ.linearRampToValueAtTime(xu.z,r),t.upX.linearRampToValueAtTime(n.x,r),t.upY.linearRampToValueAtTime(n.y,r),t.upZ.linearRampToValueAtTime(n.z,r)}else t.setPosition(yu.x,yu.y,yu.z),t.setOrientation(xu.x,xu.y,xu.z,n.x,n.y,n.z)}}class GR extends Qt{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,null!==this.source&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const wu=new R,t5=new xi,Fle=new R,Cu=new R;class n5 extends GR{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(wu,t5,Fle),Cu.set(0,0,1).applyQuaternion(t5);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(wu.x,n),t.positionY.linearRampToValueAtTime(wu.y,n),t.positionZ.linearRampToValueAtTime(wu.z,n),t.orientationX.linearRampToValueAtTime(Cu.x,n),t.orientationY.linearRampToValueAtTime(Cu.y,n),t.orientationZ.linearRampToValueAtTime(Cu.z,n)}else t.setPosition(wu.x,wu.y,wu.z),t.setOrientation(Cu.x,Cu.y,Cu.z)}}class Ole{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class r5{constructor(e,t,n){let r,s,o;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(0===o){for(let a=0;a!==r;++a)n[s+a]=n[a];o=t}else o+=t,this._mixBufferRegion(n,s,0,t/o,r);this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1&&this._mixBufferRegion(n,r,t*this._origIndex,1-s,t),o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(n[l]!==n[l+t]){a.setValue(n,r);break}}saveOriginalState(){const t=this.buffer,n=this.valueSize,r=n*this._origIndex;this.binding.getValue(t,r);for(let s=n,o=r;s!==o;++s)t[s]=t[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[n+o]}_slerp(e,t,n,r){xi.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,s){const o=this._workIndex*s;xi.multiplyQuaternionsFlat(e,o,e,t,e,n),xi.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,n,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[n+a]*r}}_lerpAdditive(e,t,n,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[n+o]*r}}}const HR="\\[\\]\\.:\\/",Nle=new RegExp("["+HR+"]","g"),QR="[^"+HR+"]",jle="[^"+HR.replace("\\.","")+"]",Hle=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",QR)+/(WCOD+)?/.source.replace("WCOD",jle)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",QR)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",QR)+"$"),Qle=["material","materials","bones","map"];class Wle{constructor(e,t,n){const r=n||Vi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}let Vi=(()=>{class i{constructor(t,n,r){this.path=n,this.parsedPath=r||i.parseTrackName(n),this.node=i.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,r){return t&&t.isAnimationObjectGroup?new i.Composite(t,n,r):new i(t,n,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Nle,"")}static parseTrackName(t){const n=Hle.exec(t);if(null===n)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==Qle.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,n){if(void 0===n||""===n||"."===n||-1===n||n===t.name||n===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(n);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===n||l.uuid===n)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[n++]=r[s]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++]}_setValue_array_setNeedsUpdate(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node;const n=this.parsedPath,r=n.objectName,s=n.propertyName;let o=n.propertyIndex;if(t||(t=i.findNode(this.rootNode,n.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let d=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let u=0;u<t.length;u++)if(t[u].name===d){d=u;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==d){if(void 0===t[d])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[d]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return i.Composite=Wle,i})();Vi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Vi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Vi.prototype.GetterByBindingType=[Vi.prototype._getValue_direct,Vi.prototype._getValue_array,Vi.prototype._getValue_arrayElement,Vi.prototype._getValue_toArray],Vi.prototype.SetterByBindingTypeAndVersioning=[[Vi.prototype._setValue_direct,Vi.prototype._setValue_direct_setNeedsUpdate,Vi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Vi.prototype._setValue_array,Vi.prototype._setValue_array_setNeedsUpdate,Vi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Vi.prototype._setValue_arrayElement,Vi.prototype._setValue_arrayElement_setNeedsUpdate,Vi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Vi.prototype._setValue_fromArray,Vi.prototype._setValue_fromArray_setNeedsUpdate,Vi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class qle{constructor(){this.isAnimationObjectGroup=!0,this.uuid=eo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,c=this.nCachedObjects_;for(let d=0,u=arguments.length;d!==u;++d){const h=arguments[d],f=h.uuid;let m=t[f];if(void 0===m){m=l++,t[f]=m,e.push(h);for(let _=0,g=o;_!==g;++_)s[_].push(new Vi(h,n[_],r[_]))}else if(m<c){a=e[m];const _=--c,g=e[_];t[g.uuid]=m,e[m]=g,t[f]=_,e[_]=h;for(let p=0,v=o;p!==v;++p){const b=s[p];let x=b[m];b[m]=b[_],void 0===x&&(x=new Vi(h,n[p],r[p])),b[_]=x}}else e[m]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,d=t[c];if(void 0!==d&&d>=s){const u=s++,h=e[u];t[h.uuid]=d,e[d]=h,t[c]=u,e[u]=l;for(let f=0,m=r;f!==m;++f){const _=n[f],p=_[d];_[d]=_[u],_[u]=p}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const d=arguments[a].uuid,u=t[d];if(void 0!==u)if(delete t[d],u<s){const h=--s,f=e[h],m=--o,_=e[m];t[f.uuid]=u,e[u]=f,t[_.uuid]=h,e[h]=_,e.pop();for(let g=0,p=r;g!==p;++g){const v=n[g],y=v[m];v[u]=v[h],v[h]=y,v.pop()}}else{const h=--o,f=e[h];h>0&&(t[f.uuid]=u),e[u]=f,e.pop();for(let m=0,_=r;m!==_;++m){const g=n[m];g[u]=g[h],g.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const s=this._bindings;if(void 0!==r)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,d=this.nCachedObjects_,u=new Array(l.length);r=s.length,n[e]=r,o.push(e),a.push(t),s.push(u);for(let h=d,f=l.length;h!==f;++h)u[h]=new Vi(l[h],e,t);return u}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a];t[e[a]]=n,o[n]=l,o.pop(),s[n]=s[a],s.pop(),r[n]=r[a],r.pop()}}}class s5{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:Wd,endingEnd:Wd};for(let c=0;c!==o;++c){const d=s[c].createInterpolant(null);a[c]=d,d.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Kj,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const r=this._clip.duration,s=e._clip.duration,a=r/s;e.warp(1,s/r,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+n,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled)return void this._updateWeight(e);const s=this._startTime;if(null!==s){const l=(e-s)*n;l<0||0===n?t=0:(this._startTime=null,t=n*l)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;if(this.blendMode===ET)for(let d=0,u=l.length;d!==u;++d)l[d].evaluate(o),c[d].accumulateAdditive(a);else for(let d=0,u=l.length;d!==u;++d)l[d].evaluate(o),c[d].accumulate(r,a)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;null!==n&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,s=this._loopCount;const o=n===$j;if(0===e)return-1===s?r:o&&1==(1&s)?t-r:r;if(n===MT){-1===s&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===s&&(e>=0?(s=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===l){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&1==(1&s))return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=qd,r.endingEnd=qd):(r.endingStart=e?this.zeroSlopeAtStart?qd:Wd:nb,r.endingEnd=t?this.zeroSlopeAtEnd?qd:Wd:nb)}_scheduleFading(e,t,n){const r=this._mixer,s=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=n,this}}const Yle=new Float32Array(1);class o5 extends as{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=n.uuid,c=this._bindingsByRootAndName;let d=c[l];void 0===d&&(d={},c[l]=d);for(let u=0;u!==s;++u){const h=r[u],f=h.name;let m=d[f];if(void 0!==m)++m.referenceCount,o[u]=m;else{if(m=o[u],void 0!==m){null===m._cacheIndex&&(++m.referenceCount,this._addInactiveBinding(m,l,f));continue}m=new r5(Vi.create(n,f,t&&t._propertyBindings[u].binding.parsedPath),h.ValueTypeName,h.getValueSize()),++m.referenceCount,this._addInactiveBinding(m,l,f),o[u]=m}a[u].resultBuffer=m.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,n)}const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];0==--s.useCount&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,s=this._actionsByClip;let o=s[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],d=e._byClipCacheIndex;c._byClipCacheIndex=d,l[d]=c,l.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===l.length&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];0==--s.referenceCount&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];void 0===o&&(o={},r[t]=o),o[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,s=n.path,o=this._bindingsByRootAndName,a=o[r],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[s],0===Object.keys(a).length&&delete o[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new kR(new Float32Array(2),new Float32Array(2),1,Yle),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const r=t||this._root,s=r.uuid;let o="string"==typeof e?gu.findByName(r,e):e;const a=null!==o?o.uuid:e,l=this._actionsByClip[a];let c=null;if(void 0===n&&(n=null!==o?o.blendMode:Dy),void 0!==l){const u=l.actionByRoot[s];if(void 0!==u&&u.blendMode===n)return u;c=l.knownActions[0],null===o&&(o=c._clip)}if(null===o)return null;const d=new s5(this,o,t,n);return this._bindAction(d,c),this._addInactiveAction(d,a,s),d}existingAction(e,t){const n=t||this._root,r=n.uuid,s="string"==typeof e?gu.findByName(n,e):e,a=this._actionsByClip[s?s.uuid:e];return void 0!==a&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let n=this._nActiveActions-1;n>=0;--n)e[n].stop();return this}update(e){const t=this._actions,n=this._nActiveActions,r=this.time+=e*=this.timeScale,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==n;++c)t[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,s=r[n];if(void 0!==s){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const d=c._cacheIndex,u=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,u._cacheIndex=d,t[d]=u,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const l=n[o].actionByRoot[t];void 0!==l&&(this._deactivateAction(l),this._removeInactiveAction(l))}const s=this._bindingsByRootAndName[t];if(void 0!==s)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class WR{constructor(e){this.value=e}clone(){return new WR(void 0===this.value.clone?this.value:this.value.clone())}}let Xle=0;class Zle extends as{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Xle++}),this.name="",this.usage=sb,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++)this.uniforms.push(t[n].clone());return this}clone(){return(new this.constructor).copy(this)}}class Kle extends vb{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class $le{constructor(e,t,n,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class Mu{constructor(e,t,n=0,r=1/0){this.ray=new hb(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new Vy,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,n=[]){return qR(e,this,n,t),n.sort(a5),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)qR(e[r],this,n,t);return n.sort(a5),n}}function a5(i,e){return i.distance-e.distance}function qR(i,e,t,n){if(i.layers.test(e.layers)&&i.raycast(e,t),!0===n){const r=i.children;for(let s=0,o=r.length;s<o;s++)qR(r[s],e,t,!0)}}class Nx{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Vn(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class Jle{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return(new this.constructor).copy(this)}}const l5=new fe;class ece{constructor(e=new fe(1/0,1/0),t=new fe(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=l5.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,l5).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const c5=new R,jx=new R;class d5{constructor(e=new R,t=new R){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){c5.subVectors(e,this.start),jx.subVectors(this.end,this.start);const n=jx.dot(jx);let s=jx.dot(c5)/n;return t&&(s=Vn(s,0,1)),s}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const u5=new R;class h5 extends Qt{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new Mt,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,d=a/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(d),Math.sin(d),1)}n.setAttribute("position",new Ke(r,3));const s=new gn({fog:!1,toneMapped:!1});this.cone=new Ss(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),u5.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(u5),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Mc=new R,Ux=new Qe,YR=new Qe;class f5 extends Ss{constructor(e){const t=p5(e),n=new Mt,r=[],s=[],o=new Le(0,0,1),a=new Le(0,1,0);for(let c=0;c<t.length;c++){const d=t[c];d.parent&&d.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}n.setAttribute("position",new Ke(r,3)),n.setAttribute("color",new Ke(s,3)),super(n,new gn({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");YR.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(Ux.multiplyMatrices(YR,a.matrixWorld),Mc.setFromMatrixPosition(Ux),r.setXYZ(o,Mc.x,Mc.y,Mc.z),Ux.multiplyMatrices(YR,a.parent.matrixWorld),Mc.setFromMatrixPosition(Ux),r.setXYZ(o+1,Mc.x,Mc.y,Mc.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function p5(i){const e=[];!0===i.isBone&&e.push(i);for(let t=0;t<i.children.length;t++)e.push.apply(e,p5(i.children[t]));return e}class m5 extends nt{constructor(e,t,n){super(new wc(t,4,2),new $n({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const tce=new R,g5=new Le,_5=new Le;class b5 extends Qt{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new aa(t);r.rotateY(.5*Math.PI),this.material=new $n({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(3*s.count);r.setAttribute("color",new Mi(o,3)),this.add(new nt(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");g5.copy(this.light.color),_5.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){const s=n<r/2?g5:_5;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(tce.setFromMatrixPosition(this.light.matrixWorld).negate())}}class XR extends Ss{constructor(e=10,t=10,n=4473924,r=8947848){n=new Le(n),r=new Le(r);const s=t/2,o=e/t,a=e/2,l=[],c=[];for(let h=0,f=0,m=-a;h<=t;h++,m+=o){l.push(-a,0,m,a,0,m),l.push(m,0,-a,m,0,a);const _=h===s?n:r;_.toArray(c,f),f+=3,_.toArray(c,f),f+=3,_.toArray(c,f),f+=3,_.toArray(c,f),f+=3}const d=new Mt;d.setAttribute("position",new Ke(l,3)),d.setAttribute("color",new Ke(c,3)),super(d,new gn({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class v5 extends Ss{constructor(e=10,t=16,n=8,r=64,s=4473924,o=8947848){s=new Le(s),o=new Le(o);const a=[],l=[];if(t>1)for(let u=0;u<t;u++){const h=u/t*(2*Math.PI),f=Math.sin(h)*e,m=Math.cos(h)*e;a.push(0,0,0),a.push(f,0,m);const _=1&u?s:o;l.push(_.r,_.g,_.b),l.push(_.r,_.g,_.b)}for(let u=0;u<n;u++){const h=1&u?s:o,f=e-e/n*u;for(let m=0;m<r;m++){let _=m/r*(2*Math.PI),g=Math.sin(_)*f,p=Math.cos(_)*f;a.push(g,0,p),l.push(h.r,h.g,h.b),_=(m+1)/r*(2*Math.PI),g=Math.sin(_)*f,p=Math.cos(_)*f,a.push(g,0,p),l.push(h.r,h.g,h.b)}}const c=new Mt;c.setAttribute("position",new Ke(a,3)),c.setAttribute("color",new Ke(l,3)),super(c,new gn({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const A5=new R,Vx=new R,y5=new R;class x5 extends Qt{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===t&&(t=1);let r=new Mt;r.setAttribute("position",new Ke([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new gn({fog:!1,toneMapped:!1});this.lightPlane=new Gn(r,s),this.add(this.lightPlane),r=new Mt,r.setAttribute("position",new Ke([0,0,0,0,0,1],3)),this.targetLine=new Gn(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),A5.setFromMatrixPosition(this.light.matrixWorld),Vx.setFromMatrixPosition(this.light.target.matrixWorld),y5.subVectors(Vx,A5),this.lightPlane.lookAt(Vx),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Vx),this.targetLine.scale.z=y5.length()}}const zx=new R,Qn=new ix;class w5 extends Ss{constructor(e){const t=new Mt,n=new gn({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};function a(m,_){l(m),l(_)}function l(m){r.push(0,0,0),s.push(0,0,0),void 0===o[m]&&(o[m]=[]),o[m].push(r.length/3-1)}a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4"),t.setAttribute("position",new Ke(r,3)),t.setAttribute("color",new Ke(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new Le(16755200),d=new Le(16711680),u=new Le(43775),h=new Le(16777215),f=new Le(3355443);this.setColors(c,d,u,h,f)}setColors(e,t,n,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap;Qn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Jn("c",t,e,Qn,0,0,-1),Jn("t",t,e,Qn,0,0,1),Jn("n1",t,e,Qn,-1,-1,-1),Jn("n2",t,e,Qn,1,-1,-1),Jn("n3",t,e,Qn,-1,1,-1),Jn("n4",t,e,Qn,1,1,-1),Jn("f1",t,e,Qn,-1,-1,1),Jn("f2",t,e,Qn,1,-1,1),Jn("f3",t,e,Qn,-1,1,1),Jn("f4",t,e,Qn,1,1,1),Jn("u1",t,e,Qn,.7,1.1,-1),Jn("u2",t,e,Qn,-.7,1.1,-1),Jn("u3",t,e,Qn,0,2,-1),Jn("cf1",t,e,Qn,-1,0,1),Jn("cf2",t,e,Qn,1,0,1),Jn("cf3",t,e,Qn,0,-1,1),Jn("cf4",t,e,Qn,0,1,1),Jn("cn1",t,e,Qn,-1,0,-1),Jn("cn2",t,e,Qn,1,0,-1),Jn("cn3",t,e,Qn,0,-1,-1),Jn("cn4",t,e,Qn,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Jn(i,e,t,n,r,s,o){zx.set(r,s,o).unproject(n);const a=e[i];if(void 0!==a){const l=t.getAttribute("position");for(let c=0,d=a.length;c<d;c++)l.setXYZ(a[c],zx.x,zx.y,zx.z)}}const Gx=new io;class C5 extends Ss{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),s=new Mt;s.setIndex(new Mi(n,1)),s.setAttribute("position",new Mi(r,3)),super(s,new gn({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Gx.setFromObject(this.object),Gx.isEmpty())return;const t=Gx.min,n=Gx.max,r=this.geometry.attributes.position,s=r.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=t.x,s[4]=n.y,s[5]=n.z,s[6]=t.x,s[7]=t.y,s[8]=n.z,s[9]=n.x,s[10]=t.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=t.z,s[15]=t.x,s[16]=n.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=n.x,s[22]=t.y,s[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class M5 extends Ss{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Mt;s.setIndex(new Mi(n,1)),s.setAttribute("position",new Ke([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(s,new gn({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class E5 extends Gn{constructor(e,t=1,n=16776960){const r=n,o=new Mt;o.setAttribute("position",new Ke([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),o.computeBoundingSphere(),super(o,new gn({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const l=new Mt;l.setAttribute("position",new Ke([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),l.computeBoundingSphere(),this.add(new nt(l,new $n({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const S5=new R;let Hx,ZR;class T5 extends Qt{constructor(e=new R(0,0,1),t=new R(0,0,0),n=1,r=16776960,s=.2*n,o=.2*s){super(),this.type="ArrowHelper",void 0===Hx&&(Hx=new Mt,Hx.setAttribute("position",new Ke([0,0,0,0,1,0],3)),ZR=new Hn(0,.5,1,5,1),ZR.translate(0,-.5,0)),this.position.copy(t),this.line=new Gn(Hx,new gn({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new nt(ZR,new $n({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{S5.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(S5,t)}}setLength(e,t=.2*e,n=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class R5 extends Ss{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new Mt;r.setAttribute("position",new Ke(t,3)),r.setAttribute("color",new Ke([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(r,new gn({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const r=new Le,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ice{constructor(){this.type="ShapePath",this.color=new Le,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Rb,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,s,o){return this.currentPath.bezierCurveTo(e,t,n,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(p,v){const b=v.length;let y=!1;for(let x=b-1,w=0;w<b;x=w++){let E=v[x],S=v[w],C=S.x-E.x,T=S.y-E.y;if(Math.abs(T)>Number.EPSILON){if(T<0&&(E=v[w],C=-C,S=v[x],T=-T),p.y<E.y||p.y>S.y)continue;if(p.y===E.y){if(p.x===E.x)return!0}else{const k=T*(p.x-E.x)-C*(p.y-E.y);if(0===k)return!0;if(k<0)continue;y=!y}}else{if(p.y!==E.y)continue;if(S.x<=p.x&&p.x<=E.x||E.x<=p.x&&p.x<=S.x)return!0}}return y}const r=Na.isClockWise,s=this.subPaths;if(0===s.length)return[];let o,a,l;const c=[];if(1===s.length)return a=s[0],l=new au,l.curves=a.curves,c.push(l),c;let d=!r(s[0].getPoints());d=e?!d:d;const u=[],h=[];let _,g,f=[],m=0;h[m]=void 0,f[m]=[];for(let p=0,v=s.length;p<v;p++)a=s[p],_=a.getPoints(),o=r(_),o=e?!o:o,o?(!d&&h[m]&&m++,h[m]={s:new au,p:_},h[m].s.curves=a.curves,d&&m++,f[m]=[]):f[m].push({h:a,p:_[0]});if(!h[0])return function t(p){const v=[];for(let b=0,y=p.length;b<y;b++){const x=p[b],w=new au;w.curves=x.curves,v.push(w)}return v}(s);if(h.length>1){let p=!1,v=0;for(let b=0,y=h.length;b<y;b++)u[b]=[];for(let b=0,y=h.length;b<y;b++){const x=f[b];for(let w=0;w<x.length;w++){const E=x[w];let S=!0;for(let C=0;C<h.length;C++)n(E.p,h[C].p)&&(b!==C&&v++,S?(S=!1,u[C].push(E)):p=!0);S&&u[b].push(E)}}v>0&&!1===p&&(f=u)}for(let p=0,v=h.length;p<v;p++){l=h[p].s,c.push(l),g=f[p];for(let b=0,y=g.length;b<y;b++)l.holes.push(g[b].h)}return c}}class nce extends tn{constructor(e,t,n,r,s,o){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(e,t,n,r,s,o)}}class rce extends fp{constructor(e,t,n,r){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(e,t,n,r)}}class sce extends pp{constructor(e,t,n,r){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(e,t,n,r)}}class oce extends mp{constructor(e,t,n,r,s,o,a){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(e,t,n,r,s,o,a)}}class ace extends Hn{constructor(e,t,n,r,s,o,a,l){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(e,t,n,r,s,o,a,l)}}class lce extends gp{constructor(e,t){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(e,t)}}class cce extends cu{constructor(e,t){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(e,t)}}class dce extends bp{constructor(e,t){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(e,t)}}class uce extends ou{constructor(e,t,n,r){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(e,t,n,r)}}class hce extends aa{constructor(e,t){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(e,t)}}class fce extends Ac{constructor(e,t,n,r){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(e,t,n,r)}}class pce extends Oa{constructor(e,t,n,r){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(e,t,n,r)}}class mce extends vp{constructor(e,t,n,r,s,o){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(e,t,n,r,s,o)}}class gce extends Ap{constructor(e,t){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(e,t)}}class _ce extends wc{constructor(e,t,n,r,s,o,a){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(e,t,n,r,s,o,a)}}class bce extends yp{constructor(e,t){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(e,t)}}class vce extends la{constructor(e,t,n,r,s){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(e,t,n,r,s)}}class Ace extends xp{constructor(e,t,n,r,s,o){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(e,t,n,r,s,o)}}class yce extends wp{constructor(e,t,n,r,s){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(e,t,n,r,s)}}function I5(i){return!(!i||!i.set)}function Ye(i,e){return I5(i)?void 0===e?i:Array.isArray(e)?(i.set(...e),i):i.copy&&e?(i.copy(e),i):void 0!==e?(i.set(e),i):i:e}function Nb(i){return void 0!==i&&(i.observed||i.observers?.length>0)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:by}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=by);const KR={now:()=>(KR.delegate||Date).now(),delegate:void 0};class $R extends Wt{constructor(e=1/0,t=1/0,n=KR){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:n,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:o}=this;t||(n.push(e),!r&&n.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:r}=this,s=r.slice();for(let o=0;o<s.length&&!e.closed;o+=n?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<n.length&&n.splice(0,n.length-s),!r){const o=t.now();let a=0;for(let l=1;l<n.length&&n[l]<=o;l+=2)a=l;a&&n.splice(0,a+1)}}}class wce{constructor(e){this.memberMap=new Map,this.children=[],this.eventListener={},this.loaded=!1,this.add=(...t)=>(this.objRef&&this.objRef.add(...t),this.children.push(...t),this),this.remove=(...t)=>{this.objRef&&this.objRef.remove(...t);for(const n of t){const r=this.children.indexOf(n);r>=0&&(this.children=this.children.splice(r,1))}return this},this.applyToObject3D=t=>{if(this.memberMap.forEach((n,r)=>{const s=t[r];I5(s)?Ye(s,n):t[r]=n}),this.children.forEach(n=>t.add(n)),this.objRef?.parent){const n=this.objRef?.parent;n.remove(this.objRef),n.add(t)}},this.addEventListener=(t,n)=>{let r=this.eventListener[t];r||(r=[],this.eventListener[t]=r),r.push(n),this.objRef&&this.objRef.addEventListener(t,n)},this.removeEventListener=(t,n)=>{const r=this.eventListener[t];if(!r)return;const s=r.indexOf(n);s>=0&&r.splice(s,1)},this.objRef=e}get(e,t,n){switch(t){case"__isProxy":return!0;case"applyToObject3D":return this.applyToObject3D;case"objRef":return this.loaded?this.objRef:void 0;case"add":return this.add;case"remove":return this.remove;case"children":return this.objRef?this.objRef.children:this.children;default:{const s=this.objRef[t];return void 0!==s&&this.memberMap.set(t,s),s}}}set(e,t,n,r){return"objRef"===t?(n&&this.applyToObject3D(n),this.loaded=!0,this.objRef=n):(this.memberMap.set(t,n),this.objRef&&(this.objRef[t]=n)),!0}}function D5(i=new Qt){const e=new wce(i);return new Proxy(e,e)}function JR(i){return!0===i.__isProxy&&void 0===i.objRef}class Do{set objRef(e){this.applyObjRef(e)}get objRef(){return this._objRef}constructor(){this.autoAddToParent=!0,this.autoDispose=!0}addToParent(){}removeFromParent(){}set threeEvents(e){this.removeEvents(),this.eventListeners=e,this.applyEvents()}get threeEvents(){return this.eventListeners}get onUpdate(){return this.updateEmitter||(this.updateEmitter=new Tt),this.updateEmitter}get objRef$(){return this._objRef$||(this._objRef$=new $R(1)),this._objRef$}ngOnInit(){this.objRef||(this.objRef=this.createThreeInstance(this.args))}getType(){throw new Error("derive me")}createThreeInstance(e){return Array.isArray(e)?new(this.getType())(...e):new(this.getType())(e)}ngOnChanges(e){if(!this.objRef||JR(this.objRef)){this.objRef||(this.objRef=this.createThreeInstance(e.args?.currentValue));for(const t in e)this[t]=e[t].currentValue;this.emitPropertyChanges(e)}else this.emitPropertyChanges(e)}disposeObjRef(){(function xce(i){return!(!i||"function"!=typeof i.dispose)})(this.objRef)&&this.objRef.dispose()}ngOnDestroy(){this.removeEvents(),this.removeFromParent(),this.autoDispose&&this.disposeObjRef()}applyObjRef(e){this._objRef!==e&&(this.removeFromParent(),this._objRef=e,this.autoAddToParent&&this.addToParent()),this.emitObjRefChange()}emitObjRefChange(){this._objRef&&!JR(this._objRef)&&(this._objRef.dispatchEvent?.({type:"loaded",object:this._objRef}),this._objRef$&&this._objRef$.next(this._objRef))}emitPropertyChanges(e){this._objRef&&this._objRef.dispatchEvent?.({type:"changes",changes:e}),this.updateEmitter&&this.updateEmitter.next(e)}removeEvents(){if(this.eventListeners&&this._objRef){for(const e of Object.entries(this.eventListeners))this._objRef.removeEventListener(e[0],e[1]);this.eventListeners=void 0}}applyEvents(){if(this.eventListeners&&this._objRef)for(const e of Object.entries(this.eventListeners))this._objRef.addEventListener(e[0],e[1])}}Do.\u0275fac=function(e){return new(e||Do)},Do.\u0275cmp=$({type:Do,selectors:[["th-abs-wrapper"]],inputs:{autoAddToParent:"autoAddToParent",autoDispose:"autoDispose",objRef:"objRef",args:"args",threeEvents:"threeEvents"},outputs:{onUpdate:"onUpdate",objRef$:"objRef$"},features:[Cr],decls:0,vars:0,template:function(e,t){},encapsulation:2});class Tp extends Do{constructor(e){super(),this.parent=e}addToParent(){this._objRef&&this.parent.objRef&&(!this._objRef.parent||this._objRef.parent.uuid!==this.parent.objRef.uuid)&&this.parent.objRef.add(this._objRef)}removeFromParent(){this._objRef?.parent?.remove(this._objRef)}applyObjRef(e){(this._objRef!==e||this._objRef?.parent?.uuid!==this.parent.objRef.uuid)&&(this.removeFromParent(),this._objRef=e,this.autoAddToParent&&this.addToParent()),this.emitObjRefChange()}attachToParent(e,t){!this.parent.objRef||e===t&&t?.parent?.uuid===this.parent.objRef.uuid||(t&&t.parent&&t.parent.remove(t),e&&(!e.parent||e.parent&&e.parent.uuid!==this.parent.objRef.uuid)&&this.parent.objRef.add(e))}set lookAt(e){Promise.resolve().then(()=>{this.objRef&&(Array.isArray(e)?this.objRef.lookAt(...e):this.objRef.lookAt(e))})}}Tp.\u0275fac=function(e){return new(e||Tp)(I(Tp))},Tp.\u0275cmp=$({type:Tp,selectors:[["th-abs-object"]],inputs:{lookAt:"lookAt"},features:[q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2});class We extends Tp{getType(){return Qt}get isObject3D(){return this._objRef?.isObject3D}get id(){return this._objRef?.id}set uuid(e){this._objRef&&(this._objRef.uuid=e)}get uuid(){return this._objRef?.uuid}set name(e){this._objRef&&(this._objRef.name=e)}get name(){return this._objRef?.name}get type(){return this._objRef?.type}set children(e){this._objRef&&(this._objRef.children=e)}get children(){return this._objRef?.children}set up(e){this._objRef&&(this._objRef.up=Ye(this._objRef.up,e))}get up(){return this._objRef?.up}set position(e){this._objRef&&Ye(this._objRef.position,e)}get position(){return this._objRef?.position}set rotation(e){this._objRef&&Ye(this._objRef.rotation,e)}get rotation(){return this._objRef?.rotation}set quaternion(e){this._objRef&&Ye(this._objRef.quaternion,e)}get quaternion(){return this._objRef?.quaternion}set scale(e){this._objRef&&Ye(this._objRef.scale,e)}get scale(){return this._objRef?.scale}set modelViewMatrix(e){this._objRef&&Ye(this._objRef.modelViewMatrix,e)}get modelViewMatrix(){return this._objRef?.modelViewMatrix}set normalMatrix(e){this._objRef&&Ye(this._objRef.normalMatrix,e)}get normalMatrix(){return this._objRef?.normalMatrix}set matrix(e){this._objRef&&(this._objRef.matrix=Ye(this._objRef.matrix,e))}get matrix(){return this._objRef?.matrix}set matrixWorld(e){this._objRef&&(this._objRef.matrixWorld=Ye(this._objRef.matrixWorld,e))}get matrixWorld(){return this._objRef?.matrixWorld}set matrixAutoUpdate(e){this._objRef&&(this._objRef.matrixAutoUpdate=e)}get matrixAutoUpdate(){return this._objRef?.matrixAutoUpdate}set matrixWorldAutoUpdate(e){this._objRef&&(this._objRef.matrixWorldAutoUpdate=e)}get matrixWorldAutoUpdate(){return this._objRef?.matrixWorldAutoUpdate}set matrixWorldNeedsUpdate(e){this._objRef&&(this._objRef.matrixWorldNeedsUpdate=e)}get matrixWorldNeedsUpdate(){return this._objRef?.matrixWorldNeedsUpdate}set layers(e){this._objRef&&(this._objRef.layers=Ye(this._objRef.layers,e))}get layers(){return this._objRef?.layers}set visible(e){this._objRef&&(this._objRef.visible=e)}get visible(){return this._objRef?.visible}set castShadow(e){this._objRef&&(this._objRef.castShadow=e)}get castShadow(){return this._objRef?.castShadow}set receiveShadow(e){this._objRef&&(this._objRef.receiveShadow=e)}get receiveShadow(){return this._objRef?.receiveShadow}set frustumCulled(e){this._objRef&&(this._objRef.frustumCulled=e)}get frustumCulled(){return this._objRef?.frustumCulled}set renderOrder(e){this._objRef&&(this._objRef.renderOrder=e)}get renderOrder(){return this._objRef?.renderOrder}set animations(e){this._objRef&&(this._objRef.animations=e)}get animations(){return this._objRef?.animations}set userData(e){this._objRef&&(this._objRef.userData=e)}get userData(){return this._objRef?.userData}set customDepthMaterial(e){this._objRef&&(this._objRef.customDepthMaterial=e)}get customDepthMaterial(){return this._objRef?.customDepthMaterial}set customDistanceMaterial(e){this._objRef&&(this._objRef.customDistanceMaterial=e)}get customDistanceMaterial(){return this._objRef?.customDistanceMaterial}set onBeforeRender(e){this._objRef&&(this._objRef.onBeforeRender=e)}get onBeforeRender(){return this._objRef?.onBeforeRender}set onAfterRender(e){this._objRef&&(this._objRef.onAfterRender=e)}get onAfterRender(){return this._objRef?.onAfterRender}constructor(e){super(e)}}We.DEFAULT_UP=Qt.DEFAULT_UP,We.DEFAULT_MATRIX_AUTO_UPDATE=Qt.DEFAULT_MATRIX_AUTO_UPDATE,We.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=Qt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,We.\u0275fac=function(e){return new(e||We)(I(We,4))},We.\u0275cmp=$({type:We,selectors:[["th-object3D"]],inputs:{uuid:"uuid",name:"name",children:"children",up:"up",position:"position",rotation:"rotation",quaternion:"quaternion",scale:"scale",modelViewMatrix:"modelViewMatrix",normalMatrix:"normalMatrix",matrix:"matrix",matrixWorld:"matrixWorld",matrixAutoUpdate:"matrixAutoUpdate",matrixWorldAutoUpdate:"matrixWorldAutoUpdate",matrixWorldNeedsUpdate:"matrixWorldNeedsUpdate",layers:"layers",visible:"visible",castShadow:"castShadow",receiveShadow:"receiveShadow",frustumCulled:"frustumCulled",renderOrder:"renderOrder",animations:"animations",userData:"userData",customDepthMaterial:"customDepthMaterial",customDistanceMaterial:"customDistanceMaterial",onBeforeRender:"onBeforeRender",onAfterRender:"onAfterRender"},features:[ne([]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Ts extends We{get isCamera(){return this._objRef?.isCamera}get type(){return this._objRef?.type}set layers(e){this._objRef&&(this._objRef.layers=Ye(this._objRef.layers,e))}get layers(){return this._objRef?.layers}set matrixWorldInverse(e){this._objRef&&(this._objRef.matrixWorldInverse=Ye(this._objRef.matrixWorldInverse,e))}get matrixWorldInverse(){return this._objRef?.matrixWorldInverse}set projectionMatrix(e){this._objRef&&(this._objRef.projectionMatrix=Ye(this._objRef.projectionMatrix,e))}get projectionMatrix(){return this._objRef?.projectionMatrix}set projectionMatrixInverse(e){this._objRef&&(this._objRef.projectionMatrixInverse=Ye(this._objRef.projectionMatrixInverse,e))}get projectionMatrixInverse(){return this._objRef?.projectionMatrixInverse}}Ts.\u0275fac=function(){let i;return function(t){return(i||(i=le(Ts)))(t||Ts)}}(),Ts.\u0275cmp=$({type:Ts,selectors:[["th-camera"]],inputs:{layers:"layers",matrixWorldInverse:"matrixWorldInverse",projectionMatrix:"projectionMatrix",projectionMatrixInverse:"projectionMatrixInverse"},features:[ne([{provide:We,useExisting:ae(()=>Ts)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class qi extends Ts{getType(){return In}get isPerspectiveCamera(){return this._objRef?.isPerspectiveCamera}get type(){return this._objRef?.type}set zoom(e){this._objRef&&(this._objRef.zoom=e)}get zoom(){return this._objRef?.zoom}set fov(e){this._objRef&&(this._objRef.fov=e)}get fov(){return this._objRef?.fov}set aspect(e){this._objRef&&(this._objRef.aspect=e)}get aspect(){return this._objRef?.aspect}set near(e){this._objRef&&(this._objRef.near=e)}get near(){return this._objRef?.near}set far(e){this._objRef&&(this._objRef.far=e)}get far(){return this._objRef?.far}set focus(e){this._objRef&&(this._objRef.focus=e)}get focus(){return this._objRef?.focus}set view(e){this._objRef&&(this._objRef.view=e)}get view(){return this._objRef?.view}set filmGauge(e){this._objRef&&(this._objRef.filmGauge=e)}get filmGauge(){return this._objRef?.filmGauge}set filmOffset(e){this._objRef&&(this._objRef.filmOffset=e)}get filmOffset(){return this._objRef?.filmOffset}}qi.\u0275fac=function(){let i;return function(t){return(i||(i=le(qi)))(t||qi)}}(),qi.\u0275cmp=$({type:qi,selectors:[["th-perspectiveCamera"]],inputs:{zoom:"zoom",fov:"fov",aspect:"aspect",near:"near",far:"far",focus:"focus",view:"view",filmGauge:"filmGauge",filmOffset:"filmOffset"},features:[ne([{provide:We,useExisting:ae(()=>qi)},{provide:Ts,useExisting:ae(()=>qi)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Ec extends We{getType(){return Gn}get isLine(){return this._objRef?.isLine}get type(){return this._objRef?.type}set geometry(e){this._objRef&&(this._objRef.geometry=e)}get geometry(){return this._objRef?.geometry}set material(e){this._objRef&&(this._objRef.material=e)}get material(){return this._objRef?.material}set morphTargetInfluences(e){this._objRef&&(this._objRef.morphTargetInfluences=e)}get morphTargetInfluences(){return this._objRef?.morphTargetInfluences}set morphTargetDictionary(e){this._objRef&&(this._objRef.morphTargetDictionary=e)}get morphTargetDictionary(){return this._objRef?.morphTargetDictionary}}Ec.\u0275fac=function(){let i;return function(t){return(i||(i=le(Ec)))(t||Ec)}}(),Ec.\u0275cmp=$({type:Ec,selectors:[["th-line"]],inputs:{geometry:"geometry",material:"material",morphTargetInfluences:"morphTargetInfluences",morphTargetDictionary:"morphTargetDictionary"},features:[ne([{provide:We,useExisting:ae(()=>Ec)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Rs extends Ec{getType(){return Ss}get isLineSegments(){return this._objRef?.isLineSegments}get type(){return this._objRef?.type}}Rs.\u0275fac=function(){let i;return function(t){return(i||(i=le(Rs)))(t||Rs)}}(),Rs.\u0275cmp=$({type:Rs,selectors:[["th-lineSegments"]],features:[ne([{provide:We,useExisting:ae(()=>Rs)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Is extends Rs{getType(){return XR}get type(){return this._objRef?.type}}Is.\u0275fac=function(){let i;return function(t){return(i||(i=le(Is)))(t||Is)}}(),Is.\u0275cmp=$({type:Is,selectors:[["th-gridHelper"]],features:[ne([{provide:We,useExisting:ae(()=>Is)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class ao extends We{get isLight(){return this._objRef?.isLight}get type(){return this._objRef?.type}set color(e){this._objRef&&(this._objRef.color=Ye(this._objRef.color,e))}get color(){return this._objRef?.color}set intensity(e){this._objRef&&(this._objRef.intensity=e)}get intensity(){return this._objRef?.intensity}set shadow(e){this._objRef&&(this._objRef.shadow=e)}get shadow(){return this._objRef?.shadow}}ao.\u0275fac=function(){let i;return function(t){return(i||(i=le(ao)))(t||ao)}}(),ao.\u0275cmp=$({type:ao,selectors:[["th-light"]],inputs:{color:"color",intensity:"intensity",shadow:"shadow"},features:[ne([{provide:We,useExisting:ae(()=>ao)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Ll extends ao{getType(){return FR}get isHemisphereLight(){return this._objRef?.isHemisphereLight}get type(){return this._objRef?.type}set position(e){this._objRef&&Ye(this._objRef.position,e)}get position(){return this._objRef?.position}set color(e){this._objRef&&(this._objRef.color=Ye(this._objRef.color,e))}get color(){return this._objRef?.color}set groundColor(e){this._objRef&&(this._objRef.groundColor=Ye(this._objRef.groundColor,e))}get groundColor(){return this._objRef?.groundColor}}Ll.\u0275fac=function(){let i;return function(t){return(i||(i=le(Ll)))(t||Ll)}}(),Ll.\u0275cmp=$({type:Ll,selectors:[["th-hemisphereLight"]],inputs:{position:"position",color:"color",groundColor:"groundColor"},features:[ne([{provide:We,useExisting:ae(()=>Ll)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class hs extends ao{getType(){return Fb}get isDirectionalLight(){return this._objRef?.isDirectionalLight}get type(){return this._objRef?.type}set castShadow(e){this._objRef&&(this._objRef.castShadow=e)}get castShadow(){return this._objRef?.castShadow}set position(e){this._objRef&&Ye(this._objRef.position,e)}get position(){return this._objRef?.position}set shadow(e){this._objRef&&(this._objRef.shadow=e)}get shadow(){return this._objRef?.shadow}set target(e){this._objRef&&(this._objRef.target=e)}get target(){return this._objRef?.target}}hs.\u0275fac=function(){let i;return function(t){return(i||(i=le(hs)))(t||hs)}}(),hs.\u0275cmp=$({type:hs,selectors:[["th-directionalLight"]],inputs:{castShadow:"castShadow",position:"position",shadow:"shadow",target:"target"},features:[ne([{provide:We,useExisting:ae(()=>hs)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Pn extends We{getType(){return nt}get isMesh(){return this._objRef?.isMesh}get type(){return this._objRef?.type}set geometry(e){this._objRef&&(this._objRef.geometry=e)}get geometry(){return this._objRef?.geometry}set material(e){this._objRef&&(this._objRef.material=e)}get material(){return this._objRef?.material}set morphTargetInfluences(e){this._objRef&&(this._objRef.morphTargetInfluences=e)}get morphTargetInfluences(){return this._objRef?.morphTargetInfluences}set morphTargetDictionary(e){this._objRef&&(this._objRef.morphTargetDictionary=e)}get morphTargetDictionary(){return this._objRef?.morphTargetDictionary}}Pn.\u0275fac=function(){let i;return function(t){return(i||(i=le(Pn)))(t||Pn)}}(),Pn.\u0275cmp=$({type:Pn,selectors:[["th-mesh"]],inputs:{geometry:"geometry",material:"material",morphTargetInfluences:"morphTargetInfluences",morphTargetDictionary:"morphTargetDictionary"},features:[ne([{provide:We,useExisting:ae(()=>Pn)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Ki extends We{getType(){return ux}get isScene(){return this._objRef?.isScene}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set fog(e){this._objRef&&(this._objRef.fog=e)}get fog(){return this._objRef?.fog}set backgroundBlurriness(e){this._objRef&&(this._objRef.backgroundBlurriness=e)}get backgroundBlurriness(){return this._objRef?.backgroundBlurriness}set backgroundIntensity(e){this._objRef&&(this._objRef.backgroundIntensity=e)}get backgroundIntensity(){return this._objRef?.backgroundIntensity}set overrideMaterial(e){this._objRef&&(this._objRef.overrideMaterial=e)}get overrideMaterial(){return this._objRef?.overrideMaterial}set background(e){this._objRef&&(this._objRef.background=Ye(this._objRef.background,e))}get background(){return this._objRef?.background}set environment(e){this._objRef&&(this._objRef.environment=e)}get environment(){return this._objRef?.environment}}Ki.\u0275fac=function(){let i;return function(t){return(i||(i=le(Ki)))(t||Ki)}}(),Ki.\u0275cmp=$({type:Ki,selectors:[["th-scene"]],inputs:{type:"type",fog:"fog",backgroundBlurriness:"backgroundBlurriness",backgroundIntensity:"backgroundIntensity",overrideMaterial:"overrideMaterial",background:"background",environment:"environment"},features:[ne([{provide:We,useExisting:ae(()=>Ki)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class jb extends Do{constructor(e){super(),this.parent=e}addToParent(){if(!this.parent.objRef)throw new Error("parent object doesn't hold a three js object instance");this.parent.objRef.material=this.objRef}removeFromParent(){this._objRef&&this.parent&&this.parent.objRef&&(this.parent.objRef.material=void 0)}}jb.\u0275fac=function(e){return new(e||jb)(I(We))},jb.\u0275cmp=$({type:jb,selectors:[["th-abs-material"]],features:[q],decls:0,vars:0,template:function(e,t){},encapsulation:2});class Si extends jb{getType(){return zn}set alphaTest(e){this._objRef&&(this._objRef.alphaTest=e)}get alphaTest(){return this._objRef?.alphaTest}set alphaToCoverage(e){this._objRef&&(this._objRef.alphaToCoverage=e)}get alphaToCoverage(){return this._objRef?.alphaToCoverage}set blendDst(e){this._objRef&&(this._objRef.blendDst=e)}get blendDst(){return this._objRef?.blendDst}set blendDstAlpha(e){this._objRef&&(this._objRef.blendDstAlpha=e)}get blendDstAlpha(){return this._objRef?.blendDstAlpha}set blendEquation(e){this._objRef&&(this._objRef.blendEquation=e)}get blendEquation(){return this._objRef?.blendEquation}set blendEquationAlpha(e){this._objRef&&(this._objRef.blendEquationAlpha=e)}get blendEquationAlpha(){return this._objRef?.blendEquationAlpha}set blending(e){this._objRef&&(this._objRef.blending=e)}get blending(){return this._objRef?.blending}set blendSrc(e){this._objRef&&(this._objRef.blendSrc=e)}get blendSrc(){return this._objRef?.blendSrc}set blendSrcAlpha(e){this._objRef&&(this._objRef.blendSrcAlpha=e)}get blendSrcAlpha(){return this._objRef?.blendSrcAlpha}set clipIntersection(e){this._objRef&&(this._objRef.clipIntersection=e)}get clipIntersection(){return this._objRef?.clipIntersection}set clippingPlanes(e){this._objRef&&(this._objRef.clippingPlanes=e)}get clippingPlanes(){return this._objRef?.clippingPlanes}set clipShadows(e){this._objRef&&(this._objRef.clipShadows=e)}get clipShadows(){return this._objRef?.clipShadows}set colorWrite(e){this._objRef&&(this._objRef.colorWrite=e)}get colorWrite(){return this._objRef?.colorWrite}set defines(e){this._objRef&&(this._objRef.defines=e)}get defines(){return this._objRef?.defines}set depthFunc(e){this._objRef&&(this._objRef.depthFunc=e)}get depthFunc(){return this._objRef?.depthFunc}set depthTest(e){this._objRef&&(this._objRef.depthTest=e)}get depthTest(){return this._objRef?.depthTest}set depthWrite(e){this._objRef&&(this._objRef.depthWrite=e)}get depthWrite(){return this._objRef?.depthWrite}set id(e){this._objRef&&(this._objRef.id=e)}get id(){return this._objRef?.id}set stencilWrite(e){this._objRef&&(this._objRef.stencilWrite=e)}get stencilWrite(){return this._objRef?.stencilWrite}set stencilFunc(e){this._objRef&&(this._objRef.stencilFunc=e)}get stencilFunc(){return this._objRef?.stencilFunc}set stencilRef(e){this._objRef&&(this._objRef.stencilRef=e)}get stencilRef(){return this._objRef?.stencilRef}set stencilWriteMask(e){this._objRef&&(this._objRef.stencilWriteMask=e)}get stencilWriteMask(){return this._objRef?.stencilWriteMask}set stencilFuncMask(e){this._objRef&&(this._objRef.stencilFuncMask=e)}get stencilFuncMask(){return this._objRef?.stencilFuncMask}set stencilFail(e){this._objRef&&(this._objRef.stencilFail=e)}get stencilFail(){return this._objRef?.stencilFail}set stencilZFail(e){this._objRef&&(this._objRef.stencilZFail=e)}get stencilZFail(){return this._objRef?.stencilZFail}set stencilZPass(e){this._objRef&&(this._objRef.stencilZPass=e)}get stencilZPass(){return this._objRef?.stencilZPass}get isMaterial(){return this._objRef?.isMaterial}set name(e){this._objRef&&(this._objRef.name=e)}get name(){return this._objRef?.name}set needsUpdate(e){this._objRef&&(this._objRef.needsUpdate=e)}get needsUpdate(){return this._objRef?.needsUpdate}set opacity(e){this._objRef&&(this._objRef.opacity=e)}get opacity(){return this._objRef?.opacity}set polygonOffset(e){this._objRef&&(this._objRef.polygonOffset=e)}get polygonOffset(){return this._objRef?.polygonOffset}set polygonOffsetFactor(e){this._objRef&&(this._objRef.polygonOffsetFactor=e)}get polygonOffsetFactor(){return this._objRef?.polygonOffsetFactor}set polygonOffsetUnits(e){this._objRef&&(this._objRef.polygonOffsetUnits=e)}get polygonOffsetUnits(){return this._objRef?.polygonOffsetUnits}set precision(e){this._objRef&&(this._objRef.precision=e)}get precision(){return this._objRef?.precision}set premultipliedAlpha(e){this._objRef&&(this._objRef.premultipliedAlpha=e)}get premultipliedAlpha(){return this._objRef?.premultipliedAlpha}set forceSinglePass(e){this._objRef&&(this._objRef.forceSinglePass=e)}get forceSinglePass(){return this._objRef?.forceSinglePass}set dithering(e){this._objRef&&(this._objRef.dithering=e)}get dithering(){return this._objRef?.dithering}set side(e){this._objRef&&(this._objRef.side=e)}get side(){return this._objRef?.side}set shadowSide(e){this._objRef&&(this._objRef.shadowSide=e)}get shadowSide(){return this._objRef?.shadowSide}set toneMapped(e){this._objRef&&(this._objRef.toneMapped=e)}get toneMapped(){return this._objRef?.toneMapped}set transparent(e){this._objRef&&(this._objRef.transparent=e)}get transparent(){return this._objRef?.transparent}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set uuid(e){this._objRef&&(this._objRef.uuid=e)}get uuid(){return this._objRef?.uuid}set vertexColors(e){this._objRef&&(this._objRef.vertexColors=e)}get vertexColors(){return this._objRef?.vertexColors}set visible(e){this._objRef&&(this._objRef.visible=e)}get visible(){return this._objRef?.visible}set userData(e){this._objRef&&(this._objRef.userData=e)}get userData(){return this._objRef?.userData}set version(e){this._objRef&&(this._objRef.version=e)}get version(){return this._objRef?.version}constructor(e){super(e)}}Si.\u0275fac=function(e){return new(e||Si)(I(We,4))},Si.\u0275cmp=$({type:Si,selectors:[["th-material"]],inputs:{alphaTest:"alphaTest",alphaToCoverage:"alphaToCoverage",blendDst:"blendDst",blendDstAlpha:"blendDstAlpha",blendEquation:"blendEquation",blendEquationAlpha:"blendEquationAlpha",blending:"blending",blendSrc:"blendSrc",blendSrcAlpha:"blendSrcAlpha",clipIntersection:"clipIntersection",clippingPlanes:"clippingPlanes",clipShadows:"clipShadows",colorWrite:"colorWrite",defines:"defines",depthFunc:"depthFunc",depthTest:"depthTest",depthWrite:"depthWrite",id:"id",stencilWrite:"stencilWrite",stencilFunc:"stencilFunc",stencilRef:"stencilRef",stencilWriteMask:"stencilWriteMask",stencilFuncMask:"stencilFuncMask",stencilFail:"stencilFail",stencilZFail:"stencilZFail",stencilZPass:"stencilZPass",name:"name",needsUpdate:"needsUpdate",opacity:"opacity",polygonOffset:"polygonOffset",polygonOffsetFactor:"polygonOffsetFactor",polygonOffsetUnits:"polygonOffsetUnits",precision:"precision",premultipliedAlpha:"premultipliedAlpha",forceSinglePass:"forceSinglePass",dithering:"dithering",side:"side",shadowSide:"shadowSide",toneMapped:"toneMapped",transparent:"transparent",type:"type",uuid:"uuid",vertexColors:"vertexColors",visible:"visible",userData:"userData",version:"version"},features:[ne([]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class lo extends Si{getType(){return du}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set color(e){this._objRef&&(this._objRef.color=Ye(this._objRef.color,e))}get color(){return this._objRef?.color}set specular(e){this._objRef&&(this._objRef.specular=Ye(this._objRef.specular,e))}get specular(){return this._objRef?.specular}set shininess(e){this._objRef&&(this._objRef.shininess=e)}get shininess(){return this._objRef?.shininess}set map(e){this._objRef&&(this._objRef.map=e)}get map(){return this._objRef?.map}set lightMap(e){this._objRef&&(this._objRef.lightMap=e)}get lightMap(){return this._objRef?.lightMap}set lightMapIntensity(e){this._objRef&&(this._objRef.lightMapIntensity=e)}get lightMapIntensity(){return this._objRef?.lightMapIntensity}set aoMap(e){this._objRef&&(this._objRef.aoMap=e)}get aoMap(){return this._objRef?.aoMap}set aoMapIntensity(e){this._objRef&&(this._objRef.aoMapIntensity=e)}get aoMapIntensity(){return this._objRef?.aoMapIntensity}set emissive(e){this._objRef&&(this._objRef.emissive=Ye(this._objRef.emissive,e))}get emissive(){return this._objRef?.emissive}set emissiveIntensity(e){this._objRef&&(this._objRef.emissiveIntensity=e)}get emissiveIntensity(){return this._objRef?.emissiveIntensity}set emissiveMap(e){this._objRef&&(this._objRef.emissiveMap=e)}get emissiveMap(){return this._objRef?.emissiveMap}set bumpMap(e){this._objRef&&(this._objRef.bumpMap=e)}get bumpMap(){return this._objRef?.bumpMap}set bumpScale(e){this._objRef&&(this._objRef.bumpScale=e)}get bumpScale(){return this._objRef?.bumpScale}set normalMap(e){this._objRef&&(this._objRef.normalMap=e)}get normalMap(){return this._objRef?.normalMap}set normalMapType(e){this._objRef&&(this._objRef.normalMapType=e)}get normalMapType(){return this._objRef?.normalMapType}set normalScale(e){this._objRef&&(this._objRef.normalScale=Ye(this._objRef.normalScale,e))}get normalScale(){return this._objRef?.normalScale}set displacementMap(e){this._objRef&&(this._objRef.displacementMap=e)}get displacementMap(){return this._objRef?.displacementMap}set displacementScale(e){this._objRef&&(this._objRef.displacementScale=e)}get displacementScale(){return this._objRef?.displacementScale}set displacementBias(e){this._objRef&&(this._objRef.displacementBias=e)}get displacementBias(){return this._objRef?.displacementBias}set specularMap(e){this._objRef&&(this._objRef.specularMap=e)}get specularMap(){return this._objRef?.specularMap}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}get alphaMap(){return this._objRef?.alphaMap}set envMap(e){this._objRef&&(this._objRef.envMap=e)}get envMap(){return this._objRef?.envMap}set combine(e){this._objRef&&(this._objRef.combine=e)}get combine(){return this._objRef?.combine}set reflectivity(e){this._objRef&&(this._objRef.reflectivity=e)}get reflectivity(){return this._objRef?.reflectivity}set refractionRatio(e){this._objRef&&(this._objRef.refractionRatio=e)}get refractionRatio(){return this._objRef?.refractionRatio}set wireframe(e){this._objRef&&(this._objRef.wireframe=e)}get wireframe(){return this._objRef?.wireframe}set wireframeLinewidth(e){this._objRef&&(this._objRef.wireframeLinewidth=e)}get wireframeLinewidth(){return this._objRef?.wireframeLinewidth}set wireframeLinecap(e){this._objRef&&(this._objRef.wireframeLinecap=e)}get wireframeLinecap(){return this._objRef?.wireframeLinecap}set wireframeLinejoin(e){this._objRef&&(this._objRef.wireframeLinejoin=e)}get wireframeLinejoin(){return this._objRef?.wireframeLinejoin}set flatShading(e){this._objRef&&(this._objRef.flatShading=e)}get flatShading(){return this._objRef?.flatShading}set metal(e){this._objRef&&(this._objRef.metal=e)}get metal(){return this._objRef?.metal}set fog(e){this._objRef&&(this._objRef.fog=e)}get fog(){return this._objRef?.fog}}lo.\u0275fac=function(){let i;return function(t){return(i||(i=le(lo)))(t||lo)}}(),lo.\u0275cmp=$({type:lo,selectors:[["th-meshPhongMaterial"]],inputs:{type:"type",color:"color",specular:"specular",shininess:"shininess",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",emissive:"emissive",emissiveIntensity:"emissiveIntensity",emissiveMap:"emissiveMap",bumpMap:"bumpMap",bumpScale:"bumpScale",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",specularMap:"specularMap",alphaMap:"alphaMap",envMap:"envMap",combine:"combine",reflectivity:"reflectivity",refractionRatio:"refractionRatio",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",flatShading:"flatShading",metal:"metal",fog:"fog"},features:[ne([{provide:Si,useExisting:ae(()=>lo)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Ub extends Do{constructor(e){super(),this.parent=e}addToParent(){this.parent.objRef&&(this.parent.objRef.geometry=this.objRef,this.parent.objRef.updateMorphTargets&&this.parent.objRef.updateMorphTargets())}removeFromParent(){this._objRef&&this.parent&&this.parent.objRef&&(this.parent.objRef.geometry=void 0)}}Ub.\u0275fac=function(e){return new(e||Ub)(I(We))},Ub.\u0275cmp=$({type:Ub,selectors:[["th-abs-geometry"]],features:[q],decls:0,vars:0,template:function(e,t){},encapsulation:2});class Rt extends Ub{getType(){return Mt}set id(e){this._objRef&&(this._objRef.id=e)}get id(){return this._objRef?.id}set uuid(e){this._objRef&&(this._objRef.uuid=e)}get uuid(){return this._objRef?.uuid}set name(e){this._objRef&&(this._objRef.name=e)}get name(){return this._objRef?.name}get type(){return this._objRef?.type}set index(e){this._objRef&&(this._objRef.index=Ye(this._objRef.index,e))}get index(){return this._objRef?.index}set attributes(e){this._objRef&&(this._objRef.attributes=e)}get attributes(){return this._objRef?.attributes}set morphAttributes(e){this._objRef&&(this._objRef.morphAttributes=e)}get morphAttributes(){return this._objRef?.morphAttributes}set morphTargetsRelative(e){this._objRef&&(this._objRef.morphTargetsRelative=e)}get morphTargetsRelative(){return this._objRef?.morphTargetsRelative}set groups(e){this._objRef&&(this._objRef.groups=e)}get groups(){return this._objRef?.groups}set boundingBox(e){this._objRef&&(this._objRef.boundingBox=Ye(this._objRef.boundingBox,e))}get boundingBox(){return this._objRef?.boundingBox}set boundingSphere(e){this._objRef&&(this._objRef.boundingSphere=Ye(this._objRef.boundingSphere,e))}get boundingSphere(){return this._objRef?.boundingSphere}set drawRange(e){this._objRef&&(this._objRef.drawRange=e)}get drawRange(){return this._objRef?.drawRange}set userData(e){this._objRef&&(this._objRef.userData=e)}get userData(){return this._objRef?.userData}get isBufferGeometry(){return this._objRef?.isBufferGeometry}constructor(e){super(e)}}Rt.\u0275fac=function(e){return new(e||Rt)(I(We,4))},Rt.\u0275cmp=$({type:Rt,selectors:[["th-bufferGeometry"]],inputs:{id:"id",uuid:"uuid",name:"name",index:"index",attributes:"attributes",morphAttributes:"morphAttributes",morphTargetsRelative:"morphTargetsRelative",groups:"groups",boundingBox:"boundingBox",boundingSphere:"boundingSphere",drawRange:"drawRange",userData:"userData"},features:[ne([]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Po extends Rt{getType(){return Ac}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}}Po.\u0275fac=function(){let i;return function(t){return(i||(i=le(Po)))(t||Po)}}(),Po.\u0275cmp=$({type:Po,selectors:[["th-planeGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>Po)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});var co=(()=>{return(i=co||(co={})).mouseEnter="mouseEnter",i.mouseExit="mouseExit",i.click="click",i.pointerDown="pointerDown",i.pointerUp="pointerUp",co;var i})();const Qx=new Oe("A reference to the raycaster object",{factory:()=>new Mu});class uo{constructor(){this.raycaster=Et(Qx),this.selected=null,this.enabled=!0,this.groups=[],this.paused=!1,this.maxClickDistance=23,this.nid=uo.instanceCnt++,this.onPointerMove=this.onPointerMove.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerUp=this.onPointerUp.bind(this)}ngOnDestroy(){this.disable(),this.unsubscribe()}subscribe(){if(!this.canvas)throw new Error("missing canvas");this.canvas.addEventListener("pointermove",this.onPointerMove),this.canvas.addEventListener("pointerdown",this.onPointerDown),this.canvas.addEventListener("pointerup",this.onPointerUp)}unsubscribe(){if(!this.canvas)throw new Error("missing canvas");this.canvas.removeEventListener("pointermove",this.onPointerMove),this.canvas.removeEventListener("pointerdown",this.onPointerDown),this.canvas.removeEventListener("pointerup",this.onPointerUp)}enable(){this.enabled=!0}disable(){this.enabled=!1}pause(){this.paused=!0}resume(){this.paused=!1}get isEnabled(){return this.enabled}init(e,t){this.camera=e,this.canvas=t,this.subscribe()}addEventTarget(e){this.groups.push(e)}removeEventTarget(e){const t=this.groups.indexOf(e);t>=0&&this.groups.splice(t,1)}onPointerMove(e){if(!this.isReady())return;const t=this.getFirstIntersectedGroup(e.layerX,e.layerY,co.mouseEnter);if((!this.selected||this.selected!==t?.target)&&(this.selected&&(this.selected.host.objRef?.dispatchEvent({type:co.mouseExit,component:this.selected.host}),this.selected.emitOnMouseExit(),this.selected=null),t&&t.target)){this.selected=t.target;const n={type:co.mouseEnter,component:t.target.host,...t};this.selected.host.objRef?.dispatchEvent(n),this.selected.emitOnMouseEnter(n)}}onPointerDown(e){if(this.maxClickDistance=e.width,this.pointerDownEvent=e,!this.isReady())return;const t=this.getFirstIntersectedGroup(e.layerX,e.layerY,co.pointerDown);if(t&&t.target&&t.target.host.objRef){const n={type:co.pointerDown,component:t.target.host,...t};t.target.host.objRef.dispatchEvent(n),t.target.emitOnPointerDown(n)}}onPointerUp(e){const t=this.pointerDownEvent;if(this.pointerDownEvent=void 0,!this.isReady())return;let n=this.getFirstIntersectedGroup(e.layerX,e.layerY,co.pointerUp);if(n&&n.target&&n.target.host.objRef){const r={type:co.pointerUp,component:n.target.host,...n};n.target.host.objRef.dispatchEvent(r),n.target.emitOnPointerUp(r)}if(!(this.calcPointerDownUpDinstance(e,t)>this.maxClickDistance)&&(n=this.getFirstIntersectedGroup(e.layerX,e.layerY,co.click),n&&n.target&&n.target.host.objRef)){const r={type:co.click,component:n.target.host,...n};n.target.host.objRef.dispatchEvent(r),n.target.emitOnClick(r)}}isReady(e){return!!(this.enabled&&(e||!this.paused)&&this.camera&&this.camera.objRef&&this.groups&&this.groups.length>0)}calcPointerDownUpDinstance(e,t){if(!t)return Number.MAX_VALUE;const n=e.layerX-t.layerX,r=e.layerY-t.layerY;return Math.sqrt(n*n+r*r)}getFirstIntersectedGroup(e,t,n){if(!this.camera||!this.canvas||!this.camera.objRef)return;const r=new fe(e=e/this.canvas.clientWidth*2-1,t=-t/this.canvas.clientHeight*2+1);let s,o;this.raycaster.setFromCamera(r,this.camera.objRef);for(const a of this.groups){const l=a.host.objRef;if(!a[n]||!l)continue;const c=this.raycaster.intersectObject(l,!0);c.length>0&&(!s||s.distance>c[0].distance)&&(s=c[0],o=a)}return o&&s?{target:o,...s}:void 0}}function yn(i){return Mn((e,t)=>{_s(i).subscribe(hn(t,()=>t.complete(),_M)),!t.closed&&e.subscribe(t)})}uo.instanceCnt=0,uo.\u0275fac=function(e){return new(e||uo)},uo.\u0275prov=He({token:uo,factory:uo.\u0275fac});const eI=new Oe("HOST_ELEMENT");class Ds{constructor(e,t){this.engServ=e,this.raycaster=t,this.hostElement=Et(eI),this.onRender=new Tt}set contentScene(e){e&&(this.scene=e)}set effectComposer(e){this._effectComposer=e,this.configureEffectComposerRenderTarget()}get effectComposer(){return this._effectComposer}set camera(e){this._camera=e,this.initRaycaster()}get camera(){return this._camera}set contentCamera(e){e&&(this.camera=e)}set viewPort(e){this._viewPort=e,this.configureEffectComposerRenderTarget()}get viewPort(){return this._viewPort}ngOnInit(){this.initRaycaster()}initRaycaster(){this.camera&&this.raycaster.init(this.camera,this.hostElement.nativeElement)}add(e){}remove(e){}configureEffectComposerRenderTarget(){if(this.viewPort&&this.effectComposer){let e,t;this.viewPort instanceof ii?(e=this.viewPort.z,t=this.viewPort?.width):(e=this.viewPort.width,t=this.viewPort.height),this.effectComposer.setSize(e,t)}}}Ds.\u0275fac=function(e){return new(e||Ds)(I(ko),I(uo))},Ds.\u0275cmp=$({type:Ds,selectors:[["th-view"]],contentQueries:function(e,t,n){if(1&e&&(Nn(n,Ki,5),Nn(n,Ts,5)),2&e){let r;Ot(r=Nt())&&(t.contentScene=r.first),Ot(r=Nt())&&(t.contentCamera=r.first)}},inputs:{scene:"scene",effectComposer:"effectComposer",camera:"camera",shadow:"shadow",viewPort:"viewPort",scissor:"scissor",scissorTest:"scissorTest",clearColor:"clearColor",clearAlpha:"clearAlpha"},outputs:{onRender:"onRender"},features:[ne([{provide:We,useExisting:ae(()=>Ds)},{provide:Qx,useValue:new Mu},uo])],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2});const P5=new R,Vce=new xi,k5=new R;class B5 extends Qt{constructor(e=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof Element&&null!==t.element.parentNode&&t.element.parentNode.removeChild(t.element)})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}}const Va=new Qe,zce=new Qe;class Gce{constructor(e={}){const t=this;let n,r,s,o;const a={camera:{fov:0,style:""},objects:new WeakMap},l=void 0!==e.element?e.element:document.createElement("div");l.style.overflow="hidden",this.domElement=l;const c=document.createElement("div");c.style.transformOrigin="0 0",c.style.pointerEvents="none",l.appendChild(c);const d=document.createElement("div");function u(_){return Math.abs(_)<1e-10?0:_}function h(_){const g=_.elements;return"matrix3d("+u(g[0])+","+u(-g[1])+","+u(g[2])+","+u(g[3])+","+u(g[4])+","+u(-g[5])+","+u(g[6])+","+u(g[7])+","+u(g[8])+","+u(-g[9])+","+u(g[10])+","+u(g[11])+","+u(g[12])+","+u(-g[13])+","+u(g[14])+","+u(g[15])+")"}function f(_){const g=_.elements;return"translate(-50%,-50%)matrix3d("+u(g[0])+","+u(g[1])+","+u(g[2])+","+u(g[3])+","+u(-g[4])+","+u(-g[5])+","+u(-g[6])+","+u(-g[7])+","+u(g[8])+","+u(g[9])+","+u(g[10])+","+u(g[11])+","+u(g[12])+","+u(g[13])+","+u(g[14])+","+u(g[15])+")"}function m(_,g,p,v){if(_.isCSS3DObject){const b=!0===_.visible&&!0===_.layers.test(p.layers);if(_.element.style.display=!0===b?"":"none",!0===b){let y;_.onBeforeRender(t,g,p),_.isCSS3DSprite?(Va.copy(p.matrixWorldInverse),Va.transpose(),0!==_.rotation2D&&Va.multiply(zce.makeRotationZ(_.rotation2D)),_.matrixWorld.decompose(P5,Vce,k5),Va.setPosition(P5),Va.scale(k5),Va.elements[3]=0,Va.elements[7]=0,Va.elements[11]=0,Va.elements[15]=1,y=f(Va)):y=f(_.matrixWorld);const x=_.element,w=a.objects.get(_);void 0!==w&&w.style===y||(x.style.transform=y,a.objects.set(_,{style:y})),x.parentNode!==d&&d.appendChild(x),_.onAfterRender(t,g,p)}}for(let b=0,y=_.children.length;b<y;b++)m(_.children[b],g,p,v)}d.style.transformStyle="preserve-3d",c.appendChild(d),this.getSize=function(){return{width:n,height:r}},this.render=function(_,g){const p=g.projectionMatrix.elements[5]*o;let v,b;a.camera.fov!==p&&(c.style.perspective=g.isPerspectiveCamera?p+"px":"",a.camera.fov=p),g.view&&g.view.enabled?(c.style.transform=`translate( ${n/g.view.width*-g.view.offsetX}px, ${r/g.view.height*-g.view.offsetY}px )`,c.style.transform+=`scale( ${g.view.fullWidth/g.view.width}, ${g.view.fullHeight/g.view.height} )`):c.style.transform="",!0===_.matrixWorldAutoUpdate&&_.updateMatrixWorld(),null===g.parent&&!0===g.matrixWorldAutoUpdate&&g.updateMatrixWorld(),g.isOrthographicCamera&&(v=-(g.right+g.left)/2,b=(g.top+g.bottom)/2);const y=g.view&&g.view.enabled?g.view.height/g.view.fullHeight:1,x=g.isOrthographicCamera?`scale( ${y} )scale(`+p+")translate("+u(v)+"px,"+u(b)+"px)"+h(g.matrixWorldInverse):`scale( ${y} )translateZ(`+p+"px)"+h(g.matrixWorldInverse),w=x+"translate("+s+"px,"+o+"px)";a.camera.style!==w&&(d.style.transform=w,a.camera.style=w),m(_,_,g,x)},this.setSize=function(_,g){n=_,r=g,s=n/2,o=r/2,l.style.width=_+"px",l.style.height=g+"px",c.style.width=_+"px",c.style.height=g+"px",d.style.width=_+"px",d.style.height=g+"px"}}}class L5 extends Qt{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new fe(.5,.5),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof Element&&null!==t.element.parentNode&&t.element.parentNode.removeChild(t.element)})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}const Rp=new R,F5=new Qe,O5=new Qe,N5=new R,j5=new R;class Hce{constructor(e={}){const t=this;let n,r,s,o;const a={objects:new WeakMap},l=void 0!==e.element?e.element:document.createElement("div");function c(f,m,_){if(f.isCSS2DObject){Rp.setFromMatrixPosition(f.matrixWorld),Rp.applyMatrix4(O5);const g=!0===f.visible&&Rp.z>=-1&&Rp.z<=1&&!0===f.layers.test(_.layers);if(f.element.style.display=!0===g?"":"none",!0===g){f.onBeforeRender(t,m,_);const v=f.element;v.style.transform="translate("+-100*f.center.x+"%,"+-100*f.center.y+"%)translate("+(Rp.x*s+s)+"px,"+(-Rp.y*o+o)+"px)",v.parentNode!==l&&l.appendChild(v),f.onAfterRender(t,m,_)}const p={distanceToCameraSquared:d(_,f)};a.objects.set(f,p)}for(let g=0,p=f.children.length;g<p;g++)c(f.children[g],m,_)}function d(f,m){return N5.setFromMatrixPosition(f.matrixWorld),j5.setFromMatrixPosition(m.matrixWorld),N5.distanceToSquared(j5)}l.style.overflow="hidden",this.domElement=l,this.getSize=function(){return{width:n,height:r}},this.render=function(f,m){!0===f.matrixWorldAutoUpdate&&f.updateMatrixWorld(),null===m.parent&&!0===m.matrixWorldAutoUpdate&&m.updateMatrixWorld(),F5.copy(m.matrixWorldInverse),O5.multiplyMatrices(m.projectionMatrix,F5),c(f,f,m),function h(f){const m=function u(f){const m=[];return f.traverse(function(_){_.isCSS2DObject&&m.push(_)}),m}(f).sort(function(g,p){return g.renderOrder!==p.renderOrder?p.renderOrder-g.renderOrder:a.objects.get(g).distanceToCameraSquared-a.objects.get(p).distanceToCameraSquared}),_=m.length;for(let g=0,p=m.length;g<p;g++)m[g].element.style.zIndex=_-g}(f)},this.setSize=function(f,m){n=f,r=m,s=n/2,o=r/2,l.style.width=f+"px",l.style.height=m+"px"}}}const U5={alpha:!0,antialias:!0,preserveDrawingBuffer:!0},Fl=new Oe("Renderer Providers"),V5=new Oe("CSS3DRenderer"),z5=new Oe("CSS2DRenderer"),Eu=new Oe("WebGLRenderer");class Vb{constructor(e,t,n){this.viewContainer=e,this.templateRef=t,this.parentInjector=n}getInjectedRenderers(){return this.injector?.get(Fl)}ngOnChanges(e){this.createInjector(),this.createView()}createView(){this.view&&this.viewContainer.clear(),this.view=this.viewContainer.createEmbeddedView(this.templateRef,void 0,{injector:this.injector})}createInjector(){const e=[];this.rendererParameters&&e.push(zb(this.rendererParameters)),this.css3DParameters&&e.push(tI(this.css3DParameters)),this.css2DParameters&&e.push(G5(this.css2DParameters)),this.injector=zr.create({parent:this.parentInjector,providers:e})}}function zb(i){const e=new _b({...U5,...i});return Object.assign(e,{...U5,...i}),[{provide:Eu,useValue:e},{provide:Fl,multi:!0,useExisting:Eu}]}function tI(i){return[{provide:V5,useFactory:()=>{const t=new Gce(i),n=t.domElement.style;return n.position="absolute",n.top="0px",n.bottom="0px",n.left="0px",n.right="0px",n.overflow="hidden",t}},{provide:Fl,multi:!0,useExisting:V5}]}function G5(i){return[{provide:z5,useFactory:()=>{const t=new Hce(i),n=t.domElement.style;return n.position="absolute",n.top="0px",n.bottom="0px",n.left="0px",n.right="0px",n.overflow="hidden",t}},{provide:Fl,multi:!0,useExisting:z5}]}Vb.\u0275fac=function(e){return new(e||Vb)(I(Ir),I(is),I(zr))},Vb.\u0275dir=Ne({type:Vb,selectors:[["ng-template","rendererParameters",""],["ng-template","css2dRendererParameters",""],["ng-template","css3dRendererParameters",""],["ng-template","webgpuRendererParameters",""]],inputs:{rendererParameters:"rendererParameters",css3DParameters:"css3DParameters",css2DParameters:"css2DParameters"},features:[Cr]});class ko{constructor(e){this.ngZone=e,this.hostElement=Et(eI),this.clock=new Au,this.destroyed$=new Wt,this.resizeEmitter=new Tt,this.beforeRenderEmitter=new Tt,this.views=[],this.beforeRender$=this.beforeRenderEmitter.pipe(yn(this.destroyed$)),this.resize$=this.resizeEmitter.pipe(yn(this.destroyed$));const t=this.initRenderer();this.renderers=t.renderers,this.canvas=t.canvas,this.wegblRenderer=t.mainRenderer,this.initResizeObserver()}ngOnDestroy(){this.resizeObserver&&this.hostElement&&this.resizeObserver.unobserve(this.hostElement.nativeElement)}initResizeObserver(){this.ngZone.runOutsideAngular(()=>{this.initCanvasSize(),this.resizeObserver||(this.resizeObserver=new ResizeObserver(()=>{this.resize()})),this.resizeObserver.observe(this.hostElement.nativeElement)})}initCanvasSize(){this.canvas?.style.setProperty("width","100%"),this.canvas?.style.setProperty("height","100%")}initRenderer(){const e=Et(Fl);let t,n;for(const r of e)r.domElement instanceof HTMLCanvasElement&&(n=r,t=n.domElement);if(!e||e.length<1)throw new Error("missing Canvas Renderer");return{canvas:t,mainRenderer:n,renderers:e}}setViews(e){this.views=e}addView(e){this.views.push(e);const t=this.calcRendererSize();t&&this.adjustViewDimensions(e,t.width,t.height)}render(){this.beforeRenderEmitter.emit({engine:this,delta:this.clock.getDelta()});for(const e of this.views)this.renderView(e)}renderView(e){const t=e.camera,n=e.scene;if(t&&n&&t.objRef&&n.objRef){Nb(e.onRender)&&this.ngZone.run(()=>e.onRender.emit({renderer:this.renderers,scene:n,camera:t}));for(const r of this.renderers)if(!e.effectComposer||r instanceof _b){if(this.applyRendererParametersFromView(e,r),e.effectComposer)return void e.effectComposer.render();r.render(n.objRef,t.objRef)}}}applyRendererParametersFromView(e,t){e.viewPort&&t.setViewport&&(e.viewPort instanceof ii?t.setViewport(e.viewPort):t.setViewport(e.viewPort.x,e.viewPort.y,e.viewPort.width,e.viewPort.height)),e.scissor&&t.setScissor&&(e.scissor instanceof ii?t.setScissor(e.scissor):t.setScissor(e.scissor.x,e.scissor.y,e.scissor.width,e.scissor.height)),void 0!==e.scissorTest&&t.setScissorTest&&t.setScissorTest(e.scissorTest),e.clearColor&&t.setClearColor&&t.setClearColor(e.clearColor),void 0!==e.clearAlpha&&t.setClearAlpha&&t.setClearAlpha(e.clearAlpha),void 0!==e.shadow&&t.shadowMap&&(t.shadowMap.enabled=!0)}resize(){const{width:e,height:t}=this.calcRendererSize();this.renderers?.forEach(n=>n.setSize(e,t,!1));for(const n of this.views)this.adjustViewDimensions(n,e,t);return this.resizeEmitter.emit({width:e,height:t}),!0}calcRendererSize(){return{width:this.hostElement.nativeElement.clientWidth??0,height:this.hostElement.nativeElement.clientHeight??0}}adjustViewDimensions(e,t,n){e.viewPort||(e.camera&&e.camera.objRef.aspect&&(e.camera.objRef.aspect=t/n,e.camera.objRef.updateProjectionMatrix()),e.effectComposer?.setSize(t,n))}}ko.\u0275fac=function(e){return new(e||ko)(xe(gt))},ko.\u0275prov=He({token:ko,factory:ko.\u0275fac});class da{constructor(e,t){this.engineService=e,this.ngZone=t,this.active=!0,this.destroyed$=new Wt,this.beforeRender$=this.engineService.beforeRender$,this.engineService.resize$.pipe(yn(this.destroyed$)).subscribe(()=>this.requestAnimationFrame())}ngOnDestroy(){this.stop(),this.destroyed$.next(),this.destroyed$.complete()}start(){this.active||(this.active=!0,this.requestAnimationFrame())}stop(){this.active=!1,void 0!==this.frameId&&(cancelAnimationFrame(this.frameId),this.frameId=void 0)}isActive(){return this.active}requestAnimationFrame(){void 0===this.frameId&&this.ngZone.runOutsideAngular(()=>this.frameId=requestAnimationFrame(()=>{this.frameId=void 0,this.engineService.render(),this.active&&this.requestAnimationFrame()}))}}function Qce(i,e){1&i&&ie(0,0,["*ngIf","isDevMode()"])}da.\u0275fac=function(e){return new(e||da)(xe(ko),xe(gt))},da.\u0275prov=He({token:da,factory:da.\u0275fac});class Di extends Ds{get obj(){return this}set views(e){this.setViews(e)}get rendererCanvas(){return this.engServ.canvas}constructor(e,t,n,r){super(e,n),this.engServ=e,this.animationLoop=t,this.raycaster=n,this.elementRef=r,this.isDevMode=uK,this.nid=Di.instanceCnt++,this.disableDefaultView=!1,this.engServ.renderers.forEach(s=>this.elementRef.nativeElement.appendChild(s.domElement))}ngAfterContentChecked(){this.animationLoop.requestAnimationFrame()}ngAfterViewInit(){this.animationLoop.requestAnimationFrame()}ngOnInit(){this.engServ.resize(),super.ngOnInit(),this.setViews()}setViews(e){this.engServ.setViews([]),this.disableDefaultView||this.engServ.addView(this),e?.forEach(t=>this.engServ.addView(t))}}Di.instanceCnt=0,Di.\u0275fac=function(e){return new(e||Di)(I(ko),I(da),I(ae(()=>uo)),I(Ft))},Di.\u0275cmp=$({type:Di,selectors:[["th-canvas"]],contentQueries:function(e,t,n){if(1&e&&Nn(n,Ds,4),2&e){let r;Ot(r=Nt())&&(t.views=r)}},inputs:{disableDefaultView:"disableDefaultView"},features:[ne([{provide:eI,useFactory:()=>Et(Ft)},{provide:We,useExisting:ae(()=>Di)},ko,da,{provide:Qx,useValue:new Mu},ae(()=>uo),{provide:Ds,useExisting:ae(()=>Di)},function qce(){return[{provide:Fl,useFactory:()=>Et(Fl,{skipSelf:!0,optional:!0})||[zb()[0].useValue]},{provide:Eu,useFactory:()=>{const i=Et(Eu,{skipSelf:!0,optional:!0});if(i)return i;const e=Et(Fl),t=e[0];return 1===e.length&&t instanceof _b?t:void 0}}]}()]),q],ngContentSelectors:["*"],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(e,t){1&e&&(he(),Bt(0,Qce,1,0,"ng-content",0)),2&e&&W("ngIf",t.isDevMode())},dependencies:[nc],styles:["[_nghost-%COMP%]{display:flex;flex:auto;line-height:0;height:100%}canvas[_ngcontent-%COMP%]{flex:auto;outline:none;width:100%;height:100%}"],changeDetection:0});var Gb=function(){var i=0,e=document.createElement("div");function t(d){return e.appendChild(d.dom),d}function n(d){for(var u=0;u<e.children.length;u++)e.children[u].style.display=u===d?"block":"none";i=d}e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(d){d.preventDefault(),n(++i%e.children.length)},!1);var r=(performance||Date).now(),s=r,o=0,a=t(new Gb.Panel("FPS","#0ff","#002")),l=t(new Gb.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new Gb.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:e,addPanel:t,showPanel:n,begin:function(){r=(performance||Date).now()},end:function(){o++;var d=(performance||Date).now();if(l.update(d-r,200),d>=s+1e3&&(a.update(1e3*o/(d-s),100),s=d,o=0,c)){var u=performance.memory;c.update(u.usedJSHeapSize/1048576,u.jsHeapSizeLimit/1048576)}return d},update:function(){r=this.end()},domElement:e,setMode:n}};Gb.Panel=function(i,e,t){var n=1/0,r=0,s=Math.round,o=s(window.devicePixelRatio||1),a=80*o,l=48*o,c=3*o,d=2*o,u=3*o,h=15*o,f=74*o,m=30*o,_=document.createElement("canvas");_.width=a,_.height=l,_.style.cssText="width:80px;height:48px";var g=_.getContext("2d");return g.font="bold "+9*o+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=t,g.fillRect(0,0,a,l),g.fillStyle=e,g.fillText(i,c,d),g.fillRect(u,h,f,m),g.fillStyle=t,g.globalAlpha=.9,g.fillRect(u,h,f,m),{dom:_,update:function(p,v){n=Math.min(n,p),r=Math.max(r,p),g.fillStyle=t,g.globalAlpha=1,g.fillRect(0,0,a,h),g.fillStyle=e,g.fillText(s(p)+" "+i+" ("+s(n)+"-"+s(r)+")",c,d),g.drawImage(_,u+o,h,f-o,m,u,h,f-o,m),g.fillRect(u+f-o,h,o,m),g.fillStyle=t,g.globalAlpha=.9,g.fillRect(u+f-o,h,o,s((1-p/v)*m))}}};const Yce=Gb;class fs{constructor(e,t){this.engineService=e,this.canvas=t,this.stats=new Yce}ngOnDestroy(){this.renderSubscription&&this.renderSubscription.unsubscribe()}ngOnInit(){if(!this.canvas.elementRef)throw new Error("No canvas present");const e=this.canvas.elementRef.nativeElement;e&&(e.style.position="relative",this.stats.dom.style.position="absolute",this.stats.showPanel(0),e.appendChild(this.stats.dom),this.renderSubscription=this.engineService.beforeRender$.subscribe(()=>{this.stats.update()}))}set thStats(e){this.stats.dom.style.visibility=e?"visible":"hidden"}}fs.\u0275fac=function(e){return new(e||fs)(I(ko),I(Di))},fs.\u0275dir=Ne({type:fs,selectors:[["","thStats",""]],inputs:{thStats:"thStats"}});const H5="https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/assets/",Ps="assets/";function Q5(i,e){if(e===Jj)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===Py||e===ST){let t=i.getIndex();if(null===t){const o=[],a=i.getAttribute("position");if(void 0===a)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i;for(let l=0;l<a.count;l++)o.push(l);i.setIndex(o),t=i.getIndex()}const n=t.count-2,r=[];if(e===Py)for(let o=1;o<=n;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=i.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}class Zce extends Ar{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new tde(t)}),this.register(function(t){return new lde(t)}),this.register(function(t){return new cde(t)}),this.register(function(t){return new dde(t)}),this.register(function(t){return new nde(t)}),this.register(function(t){return new rde(t)}),this.register(function(t){return new sde(t)}),this.register(function(t){return new ode(t)}),this.register(function(t){return new ede(t)}),this.register(function(t){return new ade(t)}),this.register(function(t){return new ide(t)}),this.register(function(t){return new $ce(t)}),this.register(function(t){return new ude(t)}),this.register(function(t){return new hde(t)})}load(e,t,n,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:bu.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new yr(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(d){t(d),s.manager.itemEnd(e)},a)}catch(d){a(d)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let s;const o={},a={},l=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===W5){try{o[Ii.KHR_BINARY_GLTF]=new fde(e)}catch(u){return void(r&&r(u))}s=JSON.parse(o[Ii.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const c=new Ede(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let d=0;d<this.pluginCallbacks.length;d++){const u=this.pluginCallbacks[d](c);a[u.name]=u,o[u.name]=!0}if(s.extensionsUsed)for(let d=0;d<s.extensionsUsed.length;++d){const u=s.extensionsUsed[d],h=s.extensionsRequired||[];switch(u){case Ii.KHR_MATERIALS_UNLIT:o[u]=new Jce;break;case Ii.KHR_DRACO_MESH_COMPRESSION:o[u]=new pde(s,this.dracoLoader);break;case Ii.KHR_TEXTURE_TRANSFORM:o[u]=new mde;break;case Ii.KHR_MESH_QUANTIZATION:o[u]=new gde;break;default:h.indexOf(u)>=0&&void 0===a[u]&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(n,r)}parseAsync(e,t){const n=this;return new Promise(function(r,s){n.parse(e,t,r,s)})}}function Kce(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const Ii={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class $ce{constructor(e){this.parser=e,this.name=Ii.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const s=t[n];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const d=new Le(16777215);void 0!==l.color&&d.fromArray(l.color);const u=void 0!==l.range?l.range:0;switch(l.type){case"directional":c=new Fb(d),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new Sp(d),c.distance=u;break;case"spot":c=new Bb(d),c.distance=u,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,Tc(c,l),void 0!==l.intensity&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),t.cache.add(n,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,s=n.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(l){return n._getNodeRef(t.cache,a,l)})}}class Jce{constructor(){this.name=Ii.KHR_MATERIALS_UNLIT}getMaterialType(){return $n}extendParams(e,t,n){const r=[];e.color=new Le(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(n.assignTexture(e,"map",s.baseColorTexture,ui))}return Promise.all(r)}}class ede{constructor(e){this.parser=e,this.name=Ii.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class tde{constructor(e){this.parser=e,this.name=Ii.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Ua:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new fe(a,a)}return Promise.all(s)}}class ide{constructor(e){this.parser=e,this.name=Ii.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Ua:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class nde{constructor(e){this.parser=e,this.name=Ii.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Ua:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Le(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];return void 0!==o.sheenColorFactor&&t.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,ui)),void 0!==o.sheenRoughnessTexture&&s.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class rde{constructor(e){this.parser=e,this.name=Ii.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Ua:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class sde{constructor(e){this.parser=e,this.name=Ii.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Ua:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new Le(a[0],a[1],a[2]),Promise.all(s)}}class ode{constructor(e){this.parser=e,this.name=Ii.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Ua:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class ade{constructor(e){this.parser=e,this.name=Ii.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?Ua:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new Le(a[0],a[1],a[2]),void 0!==o.specularColorTexture&&s.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,ui)),Promise.all(s)}}class lde{constructor(e){this.parser=e,this.name=Ii.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class cde{constructor(e){this.parser=e,this.name=Ii.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class dde{constructor(e){this.parser=e,this.name=Ii.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class ude{constructor(e){this.name=Ii.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const d=r.count,u=r.byteStride,h=new Uint8Array(a,r.byteOffset||0,r.byteLength||0);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(d,u,h,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){const f=new ArrayBuffer(d*u);return o.decodeGltfBuffer(new Uint8Array(f),d,u,h,r.mode,r.filter),f})})}return null}}class hde{constructor(e){this.name=Ii.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;const r=t.meshes[n.mesh];for(const c of r.primitives)if(c.mode!==Bo.TRIANGLES&&c.mode!==Bo.TRIANGLE_STRIP&&c.mode!==Bo.TRIANGLE_FAN&&void 0!==c.mode)return null;const o=n.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(d=>(l[c]=d,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const d=c.pop(),u=d.isGroup?d.children:[d],h=c[0].count,f=[];for(const m of u){const _=new Qe,g=new R,p=new xi,v=new R(1,1,1),b=new bx(m.geometry,m.material,h);for(let y=0;y<h;y++)l.TRANSLATION&&g.fromBufferAttribute(l.TRANSLATION,y),l.ROTATION&&p.fromBufferAttribute(l.ROTATION,y),l.SCALE&&v.fromBufferAttribute(l.SCALE,y),b.setMatrixAt(y,_.compose(g,p,v));for(const y in l)"TRANSLATION"!==y&&"ROTATION"!==y&&"SCALE"!==y&&m.geometry.setAttribute(y,l[y]);Qt.prototype.copy.call(b,m),this.parser.assignFinalMaterial(b),f.push(b)}return d.isGroup?(d.clear(),d.add(...f),d):f[0]}))}}const W5="glTF";class fde{constructor(e){this.name=Ii.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==W5)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,s=new DataView(e,12);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const l=s.getUint32(o,!0);if(o+=4,1313821514===l){const c=new Uint8Array(e,12+o,a);this.content=n.decode(c)}else if(5130562===l){const c=12+o;this.body=e.slice(c,c+a)}o+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class pde{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ii.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const d in o){const u=sI[d]||d.toLowerCase();a[u]=o[d]}for(const d in e.attributes){const u=sI[d]||d.toLowerCase();if(void 0!==o[d]){const h=n.accessors[e.attributes[d]];c[u]=Ip[h.componentType].name,l[u]=!0===h.normalized}}return t.getDependency("bufferView",s).then(function(d){return new Promise(function(u){r.decodeDracoFile(d,function(h){for(const f in h.attributes){const _=l[f];void 0!==_&&(h.attributes[f].normalized=_)}u(h)},a,c)})})}}class mde{constructor(){this.name=Ii.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class gde{constructor(){this.name=Ii.KHR_MESH_QUANTIZATION}}class Y5 extends Mp{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=n[s+o];return t}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=2*a,c=3*a,d=r-t,u=(n-t)/d,h=u*u,f=h*u,m=e*c,_=m-c,g=-2*f+3*h,p=f-h,v=1-g,b=p-h+u;for(let y=0;y!==a;y++)s[y]=v*o[_+y+a]+b*(o[_+y+l]*d)+g*o[m+y+a]+p*(o[m+y]*d);return s}}const _de=new xi;class bde extends Y5{interpolate_(e,t,n,r){const s=super.interpolate_(e,t,n,r);return _de.fromArray(s).normalize().toArray(s),s}}const Bo={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Ip={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},X5={9728:$t,9729:Ui,9984:K_,9985:wy,9986:Rf,9987:Ks},Z5={33071:_r,33648:Tf,10497:Mo},rI={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},sI={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Sc={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},vde={CUBICSPLINE:void 0,LINEAR:Qd,STEP:Lf};function Qb(i,e,t){for(const n in t.extensions)void 0===i[n]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function Tc(i,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function xde(i,e){if(i.updateMorphTargets(),void 0!==e.weights)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function wde(i){const e=i.extensions&&i.extensions[Ii.KHR_DRACO_MESH_COMPRESSION];let t;return t=e?"draco:"+e.bufferView+":"+e.indices+":"+K5(e.attributes):i.indices+":"+K5(i.attributes)+":"+i.mode,t}function K5(i){let e="";const t=Object.keys(i).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+i[t[n]]+";";return e}function aI(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const Mde=new Qe;class Ede{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Kce,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=!1,s=-1;typeof navigator<"u"&&(n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||n||r&&s<98?new Bx(this.options.manager):new W4(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new yr(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:n,userData:{}};Qb(s,a,r),Tc(a,r),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(n[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),s=(o,a)=>{const l=this.associations.get(o);null!=l&&this.associations.set(a,l);for(const[c,d]of o.children.entries())s(d,a.children[c])};return s(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&n.push(s)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[Ii.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){n.load(bu.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const s=t.byteOffset||0;return n.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const o=rI[r.type],l=!0===r.normalized,c=new(0,Ip[r.componentType])(r.count*o);return Promise.resolve(new Mi(c,o,l))}const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=rI[r.type],c=Ip[r.componentType],d=c.BYTES_PER_ELEMENT,h=r.byteOffset||0,f=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,m=!0===r.normalized;let _,g;if(f&&f!==d*l){const p=Math.floor(h/f),v="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+p+":"+r.count;let b=t.cache.get(v);b||(_=new c(a,p*f,r.count*f/d),b=new vb(_,f/d),t.cache.add(v,b)),g=new yc(b,l,h%f/d,m)}else _=null===a?new c(r.count*l):new c(a,h,r.count*l),g=new Mi(_,l,m);if(void 0!==r.sparse){const y=r.sparse.values.byteOffset||0,x=new(0,Ip[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*rI.SCALAR),w=new c(o[2],y,r.sparse.count*l);null!==a&&(g=new Mi(g.array.slice(),g.itemSize,g.normalized));for(let E=0,S=x.length;E<S;E++){const C=x[E];if(g.setX(C,w[E*l]),l>=2&&g.setY(C,w[E*l+1]),l>=3&&g.setZ(C,w[E*l+2]),l>=4&&g.setW(C,w[E*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=this.options.manager.getHandler(o.uri);null!==l&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,n){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,n).then(function(d){d.flipY=!1,d.name=o.name||a.name||"",""===d.name&&"string"==typeof a.uri&&!1===a.uri.startsWith("data:image/")&&(d.name=a.uri);const h=(s.samplers||{})[o.sampler]||{};return d.magFilter=X5[h.magFilter]||Ui,d.minFilter=X5[h.minFilter]||Ks,d.wrapS=Z5[h.wrapS]||Mo,d.wrapT=Z5[h.wrapT]||Mo,r.associations.set(d,{textures:e}),d}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(u=>u.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(void 0!==o.bufferView)l=this.getDependency("bufferView",o.bufferView).then(function(u){c=!0;const h=new Blob([u],{type:o.mimeType});return l=a.createObjectURL(h),l});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const d=Promise.resolve(l).then(function(u){return new Promise(function(h,f){let m=h;!0===t.isImageBitmapLoader&&(m=function(_){const g=new An(_);g.needsUpdate=!0,h(g)}),t.load(bu.resolveURL(u,s.path),m,void 0,f)})}).then(function(u){return!0===c&&a.revokeObjectURL(l),u.userData.mimeType=o.mimeType||function Cde(i){return i.search(/\.jpe?g($|\?)/i)>0||0===i.search(/^data\:image\/jpeg/)?"image/jpeg":i.search(/\.webp($|\?)/i)>0||0===i.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),u}).catch(function(u){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),u});return this.sourceCache[e]=d,d}assignTexture(e,t,n,r){const s=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(void 0!==n.texCoord&&n.texCoord>0&&((o=o.clone()).channel=n.texCoord),s.extensions[Ii.KHR_TEXTURE_TRANSFORM]){const a=void 0!==n.extensions?n.extensions[Ii.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[Ii.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return void 0!==r&&(o.encoding=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new Pl,zn.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(a,l)),n=l}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new gn,zn.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,this.cache.add(a,l)),n=l}if(r||s||o){let a="ClonedMaterial:"+n.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=n.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(n))),n=l}e.material=n}getMaterialType(){return ja}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},c=[];if((s.extensions||{})[Ii.KHR_MATERIALS_UNLIT]){const u=r[Ii.KHR_MATERIALS_UNLIT];o=u.getMaterialType(),c.push(u.extendParams(a,s,t))}else{const u=s.pbrMetallicRoughness||{};if(a.color=new Le(1,1,1),a.opacity=1,Array.isArray(u.baseColorFactor)){const h=u.baseColorFactor;a.color.fromArray(h),a.opacity=h[3]}void 0!==u.baseColorTexture&&c.push(t.assignTexture(a,"map",u.baseColorTexture,ui)),a.metalness=void 0!==u.metallicFactor?u.metallicFactor:1,a.roughness=void 0!==u.roughnessFactor?u.roughnessFactor:1,void 0!==u.metallicRoughnessTexture&&(c.push(t.assignTexture(a,"metalnessMap",u.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",u.metallicRoughnessTexture))),o=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=os);const d=s.alphaMode||"OPAQUE";if("BLEND"===d?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===d&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==$n&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new fe(1,1),void 0!==s.normalTexture.scale)){const u=s.normalTexture.scale;a.normalScale.set(u,u)}return void 0!==s.occlusionTexture&&o!==$n&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==$n&&(a.emissive=(new Le).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&o!==$n&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,ui)),Promise.all(c).then(function(){const u=new o(a);return s.name&&(u.name=s.name),Tc(u,s),t.associations.set(u,{materials:e}),s.extensions&&Qb(r,u,s),u})}createUniqueName(e){const t=Vi.sanitizeNodeName(e||"");let n=t;for(let r=1;this.nodeNamesUsed[n];++r)n=t+"_"+r;return this.nodeNamesUsed[n]=!0,n}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function s(a){return n[Ii.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return $5(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],d=wde(c),u=r[d];if(u)o.push(u.promise);else{let h;h=c.extensions&&c.extensions[Ii.KHR_DRACO_MESH_COMPRESSION]?s(c):$5(new Mt,c,t),r[d]={primitive:c,promise:h},o.push(h)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const d=void 0===o[l].material?(void 0===(i=this.cache).DefaultMaterial&&(i.DefaultMaterial=new ja({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Da})),i.DefaultMaterial):this.getDependency("material",o[l].material);a.push(d)}var i;return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),d=l[l.length-1],u=[];for(let f=0,m=d.length;f<m;f++){const _=d[f],g=o[f];let p;const v=c[f];if(g.mode===Bo.TRIANGLES||g.mode===Bo.TRIANGLE_STRIP||g.mode===Bo.TRIANGLE_FAN||void 0===g.mode)p=!0===s.isSkinnedMesh?new wb(_,v):new nt(_,v),!0===p.isSkinnedMesh&&p.normalizeSkinWeights(),g.mode===Bo.TRIANGLE_STRIP?p.geometry=Q5(p.geometry,ST):g.mode===Bo.TRIANGLE_FAN&&(p.geometry=Q5(p.geometry,Py));else if(g.mode===Bo.LINES)p=new Ss(_,v);else if(g.mode===Bo.LINE_STRIP)p=new Gn(_,v);else if(g.mode===Bo.LINE_LOOP)p=new Ax(_,v);else{if(g.mode!==Bo.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);p=new su(_,v)}Object.keys(p.geometry.morphAttributes).length>0&&xde(p,s),p.name=t.createUniqueName(s.name||"mesh_"+e),Tc(p,s),g.extensions&&Qb(r,p,g),t.assignFinalMaterial(p),u.push(p)}for(let f=0,m=u.length;f<m;f++)t.associations.set(u[f],{meshes:e,primitives:f});if(1===u.length)return u[0];const h=new Es;t.associations.set(h,{meshes:e});for(let f=0,m=u.length;f<m;f++)h.add(u[f]);return h})}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new In(ft.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new La(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Tc(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let r=0,s=t.joints.length;r<s;r++)n.push(this._loadNodeShallow(t.joints[r]));return n.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(n).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,d=o.length;c<d;c++){const u=o[c];if(u){a.push(u);const h=new Qe;null!==s&&h.fromArray(s.array,16*c),l.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new dp(a,l)})}loadAnimation(e){const n=this.json.animations[e],r=n.name?n.name:"animation_"+e,s=[],o=[],a=[],l=[],c=[];for(let d=0,u=n.channels.length;d<u;d++){const h=n.channels[d],f=n.samplers[h.sampler],m=h.target,g=void 0!==n.parameters?n.parameters[f.input]:f.input,p=void 0!==n.parameters?n.parameters[f.output]:f.output;void 0!==m.node&&(s.push(this.getDependency("node",m.node)),o.push(this.getDependency("accessor",g)),a.push(this.getDependency("accessor",p)),l.push(f),c.push(m))}return Promise.all([Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c)]).then(function(d){const u=d[0],h=d[1],f=d[2],m=d[3],_=d[4],g=[];for(let p=0,v=u.length;p<v;p++){const b=u[p],y=h[p],x=f[p],w=m[p],E=_[p];if(void 0===b)continue;let S;switch(b.updateMatrix(),Sc[E.path]){case Sc.weights:S=fu;break;case Sc.rotation:S=kl;break;default:S=mu}const C=b.name?b.name:b.uuid,T=void 0!==w.interpolation?vde[w.interpolation]:Qd,k=[];Sc[E.path]===Sc.weights?b.traverse(function(L){L.morphTargetInfluences&&k.push(L.name?L.name:L.uuid)}):k.push(C);let U=x.array;if(x.normalized){const L=aI(U.constructor),j=new Float32Array(U.length);for(let H=0,B=U.length;H<B;H++)j[H]=U[H]*L;U=j}for(let L=0,j=k.length;L<j;L++){const H=new S(k[L]+"."+Sc[E.path],y.array,U,T);"CUBICSPLINE"===w.interpolation&&(H.createInterpolant=function(V){return new(this instanceof kl?bde:Y5)(this.times,this.values,this.getValueSize()/3,V)},H.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),g.push(H)}}return new gu(r,void 0,g)})}createNodeMesh(e){const n=this,r=this.json.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then(function(s){const o=n._getNodeRef(n.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const n=this,r=this.json.nodes[e],s=n._loadNodeShallow(e),o=[],a=r.children||[];for(let c=0,d=a.length;c<d;c++)o.push(n.getDependency("node",a[c]));const l=void 0===r.skin?Promise.resolve(null):n.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const d=c[0],u=c[1],h=c[2];null!==h&&d.traverse(function(f){f.isSkinnedMesh&&f.bind(h,Mde)});for(let f=0,m=u.length;f<m;f++)d.add(u[f]);return d})}_loadNodeShallow(e){const n=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let d;if(d=!0===s.isBone?new ru:c.length>1?new Es:1===c.length?c[0]:new Qt,d!==c[0])for(let u=0,h=c.length;u<h;u++)d.add(c[u]);if(s.name&&(d.userData.name=s.name,d.name=o),Tc(d,s),s.extensions&&Qb(n,d,s),void 0!==s.matrix){const u=new Qe;u.fromArray(s.matrix),d.applyMatrix4(u)}else void 0!==s.translation&&d.position.fromArray(s.translation),void 0!==s.rotation&&d.quaternion.fromArray(s.rotation),void 0!==s.scale&&d.scale.fromArray(s.scale);return r.associations.has(d)||r.associations.set(d,{}),r.associations.get(d).nodes=e,d}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],r=this,s=new Es;n.name&&(s.name=r.createUniqueName(n.name)),Tc(s,n),n.extensions&&Qb(t,s,n);const o=n.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let d=0,u=l.length;d<u;d++)s.add(l[d]);return r.associations=(d=>{const u=new Map;for(const[h,f]of r.associations)(h instanceof zn||h instanceof An)&&u.set(h,f);return d.traverse(h=>{const f=r.associations.get(h);null!=f&&u.set(h,f)}),u})(s),s})}}function $5(i,e,t){const n=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){i.setAttribute(a,l)})}for(const o in n){const a=sI[o]||o.toLowerCase();a in i.attributes||r.push(s(n[o],a))}if(void 0!==e.indices&&!i.index){const o=t.getDependency("accessor",e.indices).then(function(a){i.setIndex(a)});r.push(o)}return Tc(i,e),function Sde(i,e,t){const n=e.attributes,r=new io;if(void 0===n.POSITION)return;{const a=t.json.accessors[n.POSITION],l=a.min,c=a.max;if(void 0===l||void 0===c)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new R(l[0],l[1],l[2]),new R(c[0],c[1],c[2])),a.normalized){const d=aI(Ip[a.componentType]);r.min.multiplyScalar(d),r.max.multiplyScalar(d)}}const s=e.targets;if(void 0!==s){const a=new R,l=new R;for(let c=0,d=s.length;c<d;c++){const u=s[c];if(void 0!==u.POSITION){const h=t.json.accessors[u.POSITION],f=h.min,m=h.max;if(void 0!==f&&void 0!==m){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(m[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(m[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(m[2]))),h.normalized){const _=aI(Ip[h.componentType]);l.multiplyScalar(_)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}i.boundingBox=r;const o=new Eo;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,i.boundingSphere=o}(i,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function yde(i,e,t){let n=!1,r=!1,s=!1;for(let c=0,d=e.length;c<d;c++){const u=e[c];if(void 0!==u.POSITION&&(n=!0),void 0!==u.NORMAL&&(r=!0),void 0!==u.COLOR_0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(i);const o=[],a=[],l=[];for(let c=0,d=e.length;c<d;c++){const u=e[c];if(n){const h=void 0!==u.POSITION?t.getDependency("accessor",u.POSITION):i.attributes.position;o.push(h)}if(r){const h=void 0!==u.NORMAL?t.getDependency("accessor",u.NORMAL):i.attributes.normal;a.push(h)}if(s){const h=void 0!==u.COLOR_0?t.getDependency("accessor",u.COLOR_0):i.attributes.color;l.push(h)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[1],h=c[2];return n&&(i.morphAttributes.position=c[0]),r&&(i.morphAttributes.normal=u),s&&(i.morphAttributes.color=h),i.morphTargetsRelative=!0,i})}(i,e.targets,t):i})}class J5{setCrossOrigin(e){this.crossOrigin=e}setWithCredentials(e){this.withCredentials=e}createLoaderInstance(){const e=new this.clazz;return this.crossOrigin&&e.setCrossOrigin(this.crossOrigin),void 0!==this.withCredentials&&e.setWithCredentials(this.withCredentials),e}}class za extends J5{load(...e){return this.createLoaderInstance().loadAsync(...e)}}za.\u0275fac=function(){let i;return function(t){return(i||(i=le(za)))(t||za)}}(),za.\u0275prov=He({token:za,factory:za.\u0275fac});class Wx{constructor(){this.animationLoop=Et(da)}transform(...e){return this.service.load(...e).then(t=>(this.animationLoop.requestAnimationFrame(),t))}}class Su{set url(e){this._url=e,this.load()}get url(){return this._url}get onLoaded(){return this.onLoaded$||(this.onLoaded$=new Tt),this.onLoaded$}get onProgress(){return this.onProgress$||(this.onProgress$=new Tt),this.onProgress$}constructor(e,t){this.host=e,this.zone=t,this.initialized=!1,this.animationLoop=Et(da),this.proxy=D5(),e.objRef=this.proxy}ngOnInit(){this.initialized=!0,this.load()}load(){var e=this;return ss(function*(){if(!e.initialized)return;if(void 0===e._url)throw new Error("missing url");if(!e.proxy)return;const t=e._url,n=Nb(e.onProgress$)?s=>{e.zone.run(()=>{e.onProgress$?.next(s)})}:void 0,r=yield e.zone.runOutsideAngular(()=>e.service.load(t,n));e.animationLoop.requestAnimationFrame(),e.proxy.objRef=e.getRefFromResponse(r),e.host.objRef=e.proxy,e.onLoaded$&&void 0!==r&&e.zone.run(()=>e.onLoaded$?.next(r))})()}}Su.\u0275fac=function(e){o_()},Su.\u0275dir=Ne({type:Su,inputs:{url:"url"},outputs:{onLoaded:"onLoaded",onProgress:"onProgress"}});const lI=new WeakMap;class Tde extends Ar{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,r){const s=new yr(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{this.parse(o,t,r)},n,r)}parse(e,t,n){this.decodeDracoFile(e,t,null,null,Js).catch(n)}decodeDracoFile(e,t,n,r,s=Yd){return this.decodeGeometry(e,{attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n,vertexColorSpace:s}).then(t)}decodeGeometry(e,t){const n=JSON.stringify(t);if(lI.has(e)){const l=lI.get(e);if(l.key===n)return l.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,a=this._getWorker(s,e.byteLength).then(l=>(r=l,new Promise((c,d)=>{r._callbacks[s]={resolve:c,reject:d},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),lI.set(e,{key:n,promise:a}),a}_createGeometry(e){const t=new Mt;e.index&&t.setIndex(new Mi(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n],s=r.name,l=new Mi(r.array,r.itemSize);"color"===s&&this._assignVertexColorSpace(l,r.vertexColorSpace),t.setAttribute(s,l)}return t}_assignVertexColorSpace(e,t){if(t!==Js)return;const n=new Le;for(let r=0,s=e.count;r<s;r++)n.fromBufferAttribute(e,r).convertSRGBToLinear(),e.setXYZ(r,n.r,n.g,n.b)}_loadLibrary(e,t){const n=new yr(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((r,s)=>{n.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const r=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const s=Rde.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}}function Rde(){let i,e;function r(o,a,l,c,d,u){const h=u.num_components(),m=l.num_points()*h,_=m*d.BYTES_PER_ELEMENT,g=function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}(o,d),p=o._malloc(_);a.GetAttributeDataArrayForAllPoints(l,u,g,_,p);const v=new d(o.HEAPF32.buffer,p,m).slice();return o._free(p),{name:c,array:v,itemSize:h}}onmessage=function(o){const a=o.data;switch(a.type){case"init":i=a.decoderConfig,e=new Promise(function(d){i.onModuleLoaded=function(u){d({draco:u})},DracoDecoderModule(i)});break;case"decode":const l=a.buffer,c=a.taskConfig;e.then(d=>{const u=d.draco,h=new u.Decoder;try{const f=function t(o,a,l,c){const d=c.attributeIDs,u=c.attributeTypes;let h,f;const m=a.GetEncodedGeometryType(l);if(m===o.TRIANGULAR_MESH)h=new o.Mesh,f=a.DecodeArrayToMesh(l,l.byteLength,h);else{if(m!==o.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");h=new o.PointCloud,f=a.DecodeArrayToPointCloud(l,l.byteLength,h)}if(!f.ok()||0===h.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());const _={index:null,attributes:[]};for(const g in d){const p=self[u[g]];let v,b;if(c.useUniqueIDs)b=d[g],v=a.GetAttributeByUniqueId(h,b);else{if(b=a.GetAttributeId(h,o[d[g]]),-1===b)continue;v=a.GetAttribute(h,b)}const y=r(o,a,h,g,p,v);"color"===g&&(y.vertexColorSpace=c.vertexColorSpace),_.attributes.push(y)}return m===o.TRIANGULAR_MESH&&(_.index=function n(o,a,l){const d=3*l.num_faces(),u=4*d,h=o._malloc(u);a.GetTrianglesUInt32Array(l,u,h);const f=new Uint32Array(o.HEAPF32.buffer,h,d).slice();return o._free(h),{array:f,itemSize:1}}(o,a,h)),o.destroy(h),_}(u,h,new Int8Array(l),c),m=f.attributes.map(_=>_.array.buffer);f.index&&m.push(f.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:f},m)}catch(f){console.error(f),self.postMessage({type:"error",id:a.id,error:f.message})}finally{u.destroy(h)}})}}}class Lo extends J5{load(...e){return this.createLoaderInstance().load(...e)}}class ua{transform(...e){return this.service.load(...e)}}class ks{set url(e){this._url=e,this.load()}get url(){return this._url}get onLoaded(){return this.onLoaded$||(this.onLoaded$=new Tt),this.onLoaded$}get onProgress(){return this.onProgress$||(this.onProgress$=new Tt),this.onProgress$}constructor(e,t){this.host=e,this.zone=t,this.initialized=!1}ngOnInit(){this.initialized=!0,this.load()}load(){var e=this;return ss(function*(){if(!e.initialized)return;if(void 0===e._url)throw new Error("missing url");const t=e._url,n=Nb(e.onProgress$)?s=>{e.onProgress$?.next(s)}:void 0,r=Nb(e.onLoaded$)?(...s)=>{e.onLoaded$?.next(s[0])}:void 0;e.host.objRef=e.zone.runOutsideAngular(()=>e.service.load(t,n,r))})()}}ks.\u0275fac=function(e){o_()},ks.\u0275dir=Ne({type:ks,inputs:{url:"url"},outputs:{onLoaded:"onLoaded",onProgress:"onProgress"}});class Ga extends Lo{constructor(){super(...arguments),this.clazz=Tde,this.decoderPath="",this.reuseInstance=!0}setDecoderPath(e){this.decoderPath=e}setDecoderConfig(e){this.decoderConfig=e}setWorkerLimit(e){this.workerLimit=e}setReuseInstance(e){this.reuseInstance=e}createLoaderInstance(){if(this.reuseInstance&&this.instance)return this.instance;const e=super.createLoaderInstance();return e.setDecoderPath(this.decoderPath),this.decoderConfig&&e.setDecoderConfig(this.decoderConfig),this.workerLimit&&e.setWorkerLimit(this.workerLimit),this.reuseInstance&&(this.instance=e),e}}Ga.\u0275fac=function(){let i;return function(t){return(i||(i=le(Ga)))(t||Ga)}}(),Ga.\u0275prov=He({token:Ga,factory:Ga.\u0275fac,providedIn:"root"});class Tu extends za{constructor(e){super(),this.dracoLoaderService=e,this.clazz=Zce}createLoaderInstance(){const e=super.createLoaderInstance();return e.setDRACOLoader(this.dracoLoaderService.createLoaderInstance()),e}}Tu.\u0275fac=function(e){return new(e||Tu)(xe(Ga))},Tu.\u0275prov=He({token:Tu,factory:Tu.\u0275fac,providedIn:"root"});class qx extends Wx{constructor(e){super(),this.service=e}}qx.\u0275fac=function(e){return new(e||qx)(I(Tu,16))},qx.\u0275pipe=_i({name:"loadGLTF",type:qx,pure:!0});class Bs extends Su{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}getRefFromResponse(e){return e.scene}}Bs.\u0275fac=function(e){return new(e||Bs)(I(We,1),I(gt),I(Tu))},Bs.\u0275dir=Ne({type:Bs,selectors:[["","loadGLTF",""]],features:[q]});class Rc{constructor(e,t){this.engineService=e,this.animationLoopService=t}get beforeRender(){return this.engineService.beforeRender$}get onResize(){return this.engineService.resize$}set renderOnDemand(e){e?this.animationLoopService.stop():this.animationLoopService.start()}get renderOnDemand(){return!this.animationLoopService.isActive()}}Rc.\u0275fac=function(e){return new(e||Rc)(I(ko),I(da))},Rc.\u0275dir=Ne({type:Rc,selectors:[["","beforeRender",""],["","onResize",""],["","renderOnDemand",""]],inputs:{renderOnDemand:"renderOnDemand"},outputs:{beforeRender:"beforeRender",onResize:"onResize"}});class Wb{constructor(){this.assetPath=Ps+"RobotExpressive.glb",this.states=["Idle","Walking","Running","Dance","Death","Sitting","Standing"],this.emotes=["Jump","Yes","No","Wave","Punch","ThumbsUp"],this.actions={}}onInit(e){this.animationMixer=new o5(e.scene),e.scene.traverse(t=>{t.isMesh&&(t.castShadow=!0,t.receiveShadow=!0)});for(const t of e.animations){const n=this.animationMixer.clipAction(t);this.actions[t.name]=n,(this.emotes.indexOf(t.name)>=0||this.states.indexOf(t.name)>=4)&&(n.clampWhenFinished=!0,n.loop=MT)}this.activeAction=this.actions.Walking,this.activeAction.play()}beforeRender(e){this.animationMixer&&this.animationMixer.update(e.delta)}fadeToAction(e,t){this.previousAction=this.activeAction,this.activeAction=this.actions[e],this.previousAction&&this.previousAction!==this.activeAction&&this.previousAction.fadeOut(t),this.activeAction.reset().setEffectiveTimeScale(1).setEffectiveWeight(1).fadeIn(t).play()}}Wb.\u0275fac=function(e){return new(e||Wb)},Wb.\u0275cmp=$({type:Wb,selectors:[["app-robot"]],decls:1,vars:2,consts:[["loadGLTF","",3,"url","castShadow","onLoaded","beforeRender"]],template:function(e,t){1&e&&(ge(0,"th-mesh",0),ut("onLoaded",function(r){return t.onInit(r)})("beforeRender",function(r){return t.beforeRender(r)}),Re()),2&e&&W("url",t.assetPath)("castShadow",!0)},dependencies:[Pn,Bs,Rc],encapsulation:2,changeDetection:0});class Dp{transform(e){return new bb(...e)}}Dp.\u0275fac=function(e){return new(e||Dp)},Dp.\u0275pipe=_i({name:"fog",type:Dp,pure:!0});const Ide=["gridHelper"],Dde=function(){return["#e0e0e0"]},Pde=function(){return["#e0e0e0",20,100]},kde=function(){return[45,2,.25,100]},Bde=function(i){return[i,5,10]},Lde=function(){return[0,2,0]},Fde=function(){return["#ffffff","#444444"]},Ode=function(){return[0,20,0]},Nde=function(){return["#ffffff"]},jde=function(){return[0,20,10]},Ude=function(i){return[i,0,0]},Vde=function(){return[2e3,2e3]},zde=function(){return{color:"#999999",depthWrite:!1}},Gde=function(){return[200,40,"#000000","#000000"]};function Hde(i,e){if(1&i){const t=ys();ge(0,"th-canvas",1),ut("onRender",function(){return nr(t),rr(di().onBeforeRender())}),ge(1,"th-scene",2),On(2,"fog"),je(3,"th-perspectiveCamera",3)(4,"th-hemisphereLight",4)(5,"th-directionalLight",5),ge(6,"th-mesh",6),je(7,"th-planeGeometry",7)(8,"th-meshPhongMaterial",7),Re(),je(9,"th-gridHelper",8,9)(11,"app-robot"),Re()()}if(2&i){const t=di();W("thStats",!0)("shadow",!0),K(1),W("background",Ce(20,Dde))("fog",Zn(2,18,Ce(21,Pde))),K(2),W("args",Ce(22,kde))("position",Ht(23,Bde,-5))("lookAt",Ce(25,Lde)),K(1),W("args",Ce(26,Fde))("position",Ce(27,Ode)),K(1),W("args",Ce(28,Nde))("position",Ce(29,jde))("castShadow",!0),K(1),W("rotation",Ht(30,Ude,-.5*t.Math.PI))("receiveShadow",!0),K(1),W("args",Ce(32,Vde)),K(1),W("args",Ce(33,zde)),K(1),W("args",Ce(34,Gde))("receiveShadow",!0)}}const Qde=function(i){return{outputEncoding:i}};class qb{constructor(){this.Math=Math,this.outputEncoding=ui}ngAfterViewInit(){const e=this.gridHelper?.objRef?.material;e&&(e.opacity=.2,e.transparent=!0)}onBeforeRender(){}}qb.\u0275fac=function(e){return new(e||qb)},qb.\u0275cmp=$({type:qb,selectors:[["app-animation-example"]],viewQuery:function(e,t){if(1&e&&ji(Ide,7),2&e){let n;Ot(n=Nt())&&(t.gridHelper=n.first)}},decls:1,vars:3,consts:[[3,"thStats","shadow","onRender",4,"rendererParameters"],[3,"thStats","shadow","onRender"],[3,"background","fog"],[3,"args","position","lookAt"],[3,"args","position"],[3,"args","position","castShadow"],[3,"rotation","receiveShadow"],[3,"args"],[3,"args","receiveShadow"],["gridHelper",""]],template:function(e,t){1&e&&Bt(0,Hde,12,35,"th-canvas",0),2&e&&W("rendererParameters",Ht(1,Qde,t.outputEncoding))},dependencies:[qi,Is,Ll,hs,Pn,Ki,lo,Po,Di,fs,Vb,Wb,Dp],encapsulation:2,changeDetection:0});class Wn extends ao{getType(){return Lx}get isAmbientLight(){return this._objRef?.isAmbientLight}get type(){return this._objRef?.type}}Wn.\u0275fac=function(){let i;return function(t){return(i||(i=le(Wn)))(t||Wn)}}(),Wn.\u0275cmp=$({type:Wn,selectors:[["th-ambientLight"]],features:[ne([{provide:We,useExisting:ae(()=>Wn)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class ha extends Si{getType(){return $n}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set color(e){this._objRef&&(this._objRef.color=Ye(this._objRef.color,e))}get color(){return this._objRef?.color}set map(e){this._objRef&&(this._objRef.map=e)}get map(){return this._objRef?.map}set lightMap(e){this._objRef&&(this._objRef.lightMap=e)}get lightMap(){return this._objRef?.lightMap}set lightMapIntensity(e){this._objRef&&(this._objRef.lightMapIntensity=e)}get lightMapIntensity(){return this._objRef?.lightMapIntensity}set aoMap(e){this._objRef&&(this._objRef.aoMap=e)}get aoMap(){return this._objRef?.aoMap}set aoMapIntensity(e){this._objRef&&(this._objRef.aoMapIntensity=e)}get aoMapIntensity(){return this._objRef?.aoMapIntensity}set specularMap(e){this._objRef&&(this._objRef.specularMap=e)}get specularMap(){return this._objRef?.specularMap}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}get alphaMap(){return this._objRef?.alphaMap}set envMap(e){this._objRef&&(this._objRef.envMap=e)}get envMap(){return this._objRef?.envMap}set combine(e){this._objRef&&(this._objRef.combine=e)}get combine(){return this._objRef?.combine}set reflectivity(e){this._objRef&&(this._objRef.reflectivity=e)}get reflectivity(){return this._objRef?.reflectivity}set refractionRatio(e){this._objRef&&(this._objRef.refractionRatio=e)}get refractionRatio(){return this._objRef?.refractionRatio}set wireframe(e){this._objRef&&(this._objRef.wireframe=e)}get wireframe(){return this._objRef?.wireframe}set wireframeLinewidth(e){this._objRef&&(this._objRef.wireframeLinewidth=e)}get wireframeLinewidth(){return this._objRef?.wireframeLinewidth}set wireframeLinecap(e){this._objRef&&(this._objRef.wireframeLinecap=e)}get wireframeLinecap(){return this._objRef?.wireframeLinecap}set wireframeLinejoin(e){this._objRef&&(this._objRef.wireframeLinejoin=e)}get wireframeLinejoin(){return this._objRef?.wireframeLinejoin}set fog(e){this._objRef&&(this._objRef.fog=e)}get fog(){return this._objRef?.fog}}ha.\u0275fac=function(){let i;return function(t){return(i||(i=le(ha)))(t||ha)}}(),ha.\u0275cmp=$({type:ha,selectors:[["th-meshBasicMaterial"]],inputs:{type:"type",color:"color",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",specularMap:"specularMap",alphaMap:"alphaMap",envMap:"envMap",combine:"combine",reflectivity:"reflectivity",refractionRatio:"refractionRatio",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",fog:"fog"},features:[ne([{provide:Si,useExisting:ae(()=>ha)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Ha extends Rt{getType(){return tn}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}}Ha.\u0275fac=function(){let i;return function(t){return(i||(i=le(Ha)))(t||Ha)}}(),Ha.\u0275cmp=$({type:Ha,selectors:[["th-boxGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>Ha)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const Xde=function(){return{color:"purple"}},Zde=function(){return[75,2,.1,1e3]},Kde=function(){return[1,1,5]};class Yb{}Yb.\u0275fac=function(e){return new(e||Yb)},Yb.\u0275cmp=$({type:Yb,selectors:[["app-basic-example"]],decls:7,vars:6,consts:[[3,"args"],[3,"args","position"]],template:function(e,t){1&e&&(ge(0,"th-canvas")(1,"th-scene")(2,"th-mesh"),je(3,"th-boxGeometry")(4,"th-meshBasicMaterial",0),Re(),je(5,"th-ambientLight")(6,"th-perspectiveCamera",1),Re()()),2&e&&(K(4),W("args",Ce(3,Xde)),K(2),W("args",Ce(4,Zde))("position",Ce(5,Kde)))},dependencies:[qi,Wn,Pn,Ki,ha,Ha,Di],encapsulation:2,changeDetection:0});const eV={type:"change"},cI={type:"start"},tV={type:"end"};class iV extends as{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new R,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Zs.ROTATE,MIDDLE:Zs.DOLLY,RIGHT:Zs.PAN},this.touches={ONE:wl.ROTATE,TWO:wl.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(Z){Z.addEventListener("keydown",ht),this._domElementKeyEvents=Z},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",ht),this._domElementKeyEvents=null},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(eV),n.update(),s=r.NONE},this.update=function(){const Z=new R,Ie=(new xi).setFromUnitVectors(e.up,new R(0,1,0)),ye=Ie.clone().invert(),Je=new R,ct=new xi,pt=2*Math.PI;return function(){const tt=n.object.position;Z.copy(tt).sub(n.target),Z.applyQuaternion(Ie),a.setFromVector3(Z),n.autoRotate&&s===r.NONE&&C(function E(){return 2*Math.PI/60/60*n.autoRotateSpeed}()),n.enableDamping?(a.theta+=l.theta*n.dampingFactor,a.phi+=l.phi*n.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let Lt=n.minAzimuthAngle,It=n.maxAzimuthAngle;return isFinite(Lt)&&isFinite(It)&&(Lt<-Math.PI?Lt+=pt:Lt>Math.PI&&(Lt-=pt),It<-Math.PI?It+=pt:It>Math.PI&&(It-=pt),a.theta=Lt<=It?Math.max(Lt,Math.min(It,a.theta)):a.theta>(Lt+It)/2?Math.max(Lt,a.theta):Math.min(It,a.theta)),a.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=c,a.radius=Math.max(n.minDistance,Math.min(n.maxDistance,a.radius)),!0===n.enableDamping?n.target.addScaledVector(d,n.dampingFactor):n.target.add(d),Z.setFromSpherical(a),Z.applyQuaternion(ye),tt.copy(n.target).add(Z),n.object.lookAt(n.target),!0===n.enableDamping?(l.theta*=1-n.dampingFactor,l.phi*=1-n.dampingFactor,d.multiplyScalar(1-n.dampingFactor)):(l.set(0,0,0),d.set(0,0,0)),c=1,!!(u||Je.distanceToSquared(n.object.position)>o||8*(1-ct.dot(n.object.quaternion))>o)&&(n.dispatchEvent(eV),Je.copy(n.object.position),ct.copy(n.object.quaternion),u=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",F),n.domElement.removeEventListener("pointerdown",Se),n.domElement.removeEventListener("pointercancel",Xe),n.domElement.removeEventListener("wheel",lt),n.domElement.removeEventListener("pointermove",it),n.domElement.removeEventListener("pointerup",Xe),null!==n._domElementKeyEvents&&(n._domElementKeyEvents.removeEventListener("keydown",ht),n._domElementKeyEvents=null)};const n=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new Nx,l=new Nx;let c=1;const d=new R;let u=!1;const h=new fe,f=new fe,m=new fe,_=new fe,g=new fe,p=new fe,v=new fe,b=new fe,y=new fe,x=[],w={};function S(){return Math.pow(.95,n.zoomSpeed)}function C(Z){l.theta-=Z}function T(Z){l.phi-=Z}const k=function(){const Z=new R;return function(ye,Je){Z.setFromMatrixColumn(Je,0),Z.multiplyScalar(-ye),d.add(Z)}}(),U=function(){const Z=new R;return function(ye,Je){!0===n.screenSpacePanning?Z.setFromMatrixColumn(Je,1):(Z.setFromMatrixColumn(Je,0),Z.crossVectors(n.object.up,Z)),Z.multiplyScalar(ye),d.add(Z)}}(),L=function(){const Z=new R;return function(ye,Je){const ct=n.domElement;if(n.object.isPerspectiveCamera){Z.copy(n.object.position).sub(n.target);let $e=Z.length();$e*=Math.tan(n.object.fov/2*Math.PI/180),k(2*ye*$e/ct.clientHeight,n.object.matrix),U(2*Je*$e/ct.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(k(ye*(n.object.right-n.object.left)/n.object.zoom/ct.clientWidth,n.object.matrix),U(Je*(n.object.top-n.object.bottom)/n.object.zoom/ct.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function j(Z){n.object.isPerspectiveCamera?c/=Z:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*Z)),n.object.updateProjectionMatrix(),u=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function H(Z){n.object.isPerspectiveCamera?c*=Z:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/Z)),n.object.updateProjectionMatrix(),u=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function B(Z){h.set(Z.clientX,Z.clientY)}function O(Z){_.set(Z.clientX,Z.clientY)}function Y(){1===x.length?h.set(x[0].pageX,x[0].pageY):h.set(.5*(x[0].pageX+x[1].pageX),.5*(x[0].pageY+x[1].pageY))}function re(){1===x.length?_.set(x[0].pageX,x[0].pageY):_.set(.5*(x[0].pageX+x[1].pageX),.5*(x[0].pageY+x[1].pageY))}function J(){const Z=x[0].pageX-x[1].pageX,Ie=x[0].pageY-x[1].pageY,ye=Math.sqrt(Z*Z+Ie*Ie);v.set(0,ye)}function Ee(Z){if(1==x.length)f.set(Z.pageX,Z.pageY);else{const ye=et(Z);f.set(.5*(Z.pageX+ye.x),.5*(Z.pageY+ye.y))}m.subVectors(f,h).multiplyScalar(n.rotateSpeed);const Ie=n.domElement;C(2*Math.PI*m.x/Ie.clientHeight),T(2*Math.PI*m.y/Ie.clientHeight),h.copy(f)}function me(Z){if(1===x.length)g.set(Z.pageX,Z.pageY);else{const Ie=et(Z);g.set(.5*(Z.pageX+Ie.x),.5*(Z.pageY+Ie.y))}p.subVectors(g,_).multiplyScalar(n.panSpeed),L(p.x,p.y),_.copy(g)}function qe(Z){const Ie=et(Z),ye=Z.pageX-Ie.x,Je=Z.pageY-Ie.y,ct=Math.sqrt(ye*ye+Je*Je);b.set(0,ct),y.set(0,Math.pow(b.y/v.y,n.zoomSpeed)),j(y.y),v.copy(b)}function Se(Z){!1!==n.enabled&&(0===x.length&&(n.domElement.setPointerCapture(Z.pointerId),n.domElement.addEventListener("pointermove",it),n.domElement.addEventListener("pointerup",Xe)),function Ae(Z){x.push(Z)}(Z),"touch"===Z.pointerType?function xt(Z){switch(Ue(Z),x.length){case 1:switch(n.touches.ONE){case wl.ROTATE:if(!1===n.enableRotate)return;Y(),s=r.TOUCH_ROTATE;break;case wl.PAN:if(!1===n.enablePan)return;re(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(n.touches.TWO){case wl.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function D(){n.enableZoom&&J(),n.enablePan&&re()})(),s=r.TOUCH_DOLLY_PAN;break;case wl.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function ue(){n.enableZoom&&J(),n.enableRotate&&Y()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(cI)}(Z):function At(Z){let Ie;switch(Z.button){case 0:Ie=n.mouseButtons.LEFT;break;case 1:Ie=n.mouseButtons.MIDDLE;break;case 2:Ie=n.mouseButtons.RIGHT;break;default:Ie=-1}switch(Ie){case Zs.DOLLY:if(!1===n.enableZoom)return;(function V(Z){v.set(Z.clientX,Z.clientY)})(Z),s=r.DOLLY;break;case Zs.ROTATE:if(Z.ctrlKey||Z.metaKey||Z.shiftKey){if(!1===n.enablePan)return;O(Z),s=r.PAN}else{if(!1===n.enableRotate)return;B(Z),s=r.ROTATE}break;case Zs.PAN:if(Z.ctrlKey||Z.metaKey||Z.shiftKey){if(!1===n.enableRotate)return;B(Z),s=r.ROTATE}else{if(!1===n.enablePan)return;O(Z),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(cI)}(Z))}function it(Z){!1!==n.enabled&&("touch"===Z.pointerType?function N(Z){switch(Ue(Z),s){case r.TOUCH_ROTATE:if(!1===n.enableRotate)return;Ee(Z),n.update();break;case r.TOUCH_PAN:if(!1===n.enablePan)return;me(Z),n.update();break;case r.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function Me(Z){n.enableZoom&&qe(Z),n.enablePan&&me(Z)})(Z),n.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function we(Z){n.enableZoom&&qe(Z),n.enableRotate&&Ee(Z)})(Z),n.update();break;default:s=r.NONE}}(Z):function yt(Z){switch(s){case r.ROTATE:if(!1===n.enableRotate)return;!function Q(Z){f.set(Z.clientX,Z.clientY),m.subVectors(f,h).multiplyScalar(n.rotateSpeed);const Ie=n.domElement;C(2*Math.PI*m.x/Ie.clientHeight),T(2*Math.PI*m.y/Ie.clientHeight),h.copy(f),n.update()}(Z);break;case r.DOLLY:if(!1===n.enableZoom)return;!function oe(Z){b.set(Z.clientX,Z.clientY),y.subVectors(b,v),y.y>0?j(S()):y.y<0&&H(S()),v.copy(b),n.update()}(Z);break;case r.PAN:if(!1===n.enablePan)return;!function be(Z){g.set(Z.clientX,Z.clientY),p.subVectors(g,_).multiplyScalar(n.panSpeed),L(p.x,p.y),_.copy(g),n.update()}(Z)}}(Z))}function Xe(Z){(function ke(Z){delete w[Z.pointerId];for(let Ie=0;Ie<x.length;Ie++)if(x[Ie].pointerId==Z.pointerId)return void x.splice(Ie,1)})(Z),0===x.length&&(n.domElement.releasePointerCapture(Z.pointerId),n.domElement.removeEventListener("pointermove",it),n.domElement.removeEventListener("pointerup",Xe)),n.dispatchEvent(tV),s=r.NONE}function lt(Z){!1===n.enabled||!1===n.enableZoom||s!==r.NONE||(Z.preventDefault(),n.dispatchEvent(cI),function de(Z){Z.deltaY<0?H(S()):Z.deltaY>0&&j(S()),n.update()}(Z),n.dispatchEvent(tV))}function ht(Z){!1===n.enabled||!1===n.enablePan||function X(Z){let Ie=!1;switch(Z.code){case n.keys.UP:Z.ctrlKey||Z.metaKey||Z.shiftKey?T(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):L(0,n.keyPanSpeed),Ie=!0;break;case n.keys.BOTTOM:Z.ctrlKey||Z.metaKey||Z.shiftKey?T(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):L(0,-n.keyPanSpeed),Ie=!0;break;case n.keys.LEFT:Z.ctrlKey||Z.metaKey||Z.shiftKey?C(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):L(n.keyPanSpeed,0),Ie=!0;break;case n.keys.RIGHT:Z.ctrlKey||Z.metaKey||Z.shiftKey?C(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):L(-n.keyPanSpeed,0),Ie=!0}Ie&&(Z.preventDefault(),n.update())}(Z)}function F(Z){!1!==n.enabled&&Z.preventDefault()}function Ue(Z){let Ie=w[Z.pointerId];void 0===Ie&&(Ie=new fe,w[Z.pointerId]=Ie),Ie.set(Z.pageX,Z.pageY)}function et(Z){return w[(Z.pointerId===x[0].pointerId?x[1]:x[0]).pointerId]}n.domElement.addEventListener("contextmenu",F),n.domElement.addEventListener("pointerdown",Se),n.domElement.addEventListener("pointercancel",Xe),n.domElement.addEventListener("wheel",lt,{passive:!1}),this.update()}}class qn extends Do{constructor(e,t){super(),this._camera=e,this.canvas=t,this.renderLoop=Et(da)}createThreeInstance(e){e||(e=[this._camera.objRef,this.canvas?.elementRef.nativeElement]);const t=super.createThreeInstance(e);return this.patchDispatchEvent(t),this.subscribeControlUpdater(t),t}patchDispatchEvent(e){if(e.dispatchEvent){const t=this.origDispatchEventMethod=e.dispatchEvent;e.dispatchEvent=n=>{t.call(e,n),this.renderLoop.requestAnimationFrame()}}}ngOnDestroy(){super.ngOnDestroy(),this.unpatchDispatchEvent(),this.unsubscribeControlUpdater()}unpatchDispatchEvent(){this.origDispatchEventMethod&&this._objRef&&(this._objRef.dispatchEvent=this.origDispatchEventMethod)}subscribeControlUpdater(e){void 0!==e.update&&(this.beforeRenderSubscription=this.renderLoop.beforeRender$.subscribe(t=>{e.update(t.delta)}))}unsubscribeControlUpdater(){this.beforeRenderSubscription&&this.beforeRenderSubscription.unsubscribe()}}qn.\u0275fac=function(e){return new(e||qn)(I(We),I(Di))},qn.\u0275cmp=$({type:qn,selectors:[["th-abs-control"]],features:[q],decls:0,vars:0,template:function(e,t){},encapsulation:2});class Pr extends qn{getType(){return iV}set object(e){this._objRef&&(this._objRef.object=e)}get object(){return this._objRef?.object}set domElement(e){this._objRef&&(this._objRef.domElement=e)}get domElement(){return this._objRef?.domElement}set enabled(e){this._objRef&&(this._objRef.enabled=e)}get enabled(){return this._objRef?.enabled}set target(e){this._objRef&&(this._objRef.target=Ye(this._objRef.target,e))}get target(){return this._objRef?.target}set center(e){this._objRef&&(this._objRef.center=Ye(this._objRef.center,e))}get center(){return this._objRef?.center}set minDistance(e){this._objRef&&(this._objRef.minDistance=e)}get minDistance(){return this._objRef?.minDistance}set maxDistance(e){this._objRef&&(this._objRef.maxDistance=e)}get maxDistance(){return this._objRef?.maxDistance}set minZoom(e){this._objRef&&(this._objRef.minZoom=e)}get minZoom(){return this._objRef?.minZoom}set maxZoom(e){this._objRef&&(this._objRef.maxZoom=e)}get maxZoom(){return this._objRef?.maxZoom}set minPolarAngle(e){this._objRef&&(this._objRef.minPolarAngle=e)}get minPolarAngle(){return this._objRef?.minPolarAngle}set maxPolarAngle(e){this._objRef&&(this._objRef.maxPolarAngle=e)}get maxPolarAngle(){return this._objRef?.maxPolarAngle}set minAzimuthAngle(e){this._objRef&&(this._objRef.minAzimuthAngle=e)}get minAzimuthAngle(){return this._objRef?.minAzimuthAngle}set maxAzimuthAngle(e){this._objRef&&(this._objRef.maxAzimuthAngle=e)}get maxAzimuthAngle(){return this._objRef?.maxAzimuthAngle}set enableDamping(e){this._objRef&&(this._objRef.enableDamping=e)}get enableDamping(){return this._objRef?.enableDamping}set dampingFactor(e){this._objRef&&(this._objRef.dampingFactor=e)}get dampingFactor(){return this._objRef?.dampingFactor}set enableZoom(e){this._objRef&&(this._objRef.enableZoom=e)}get enableZoom(){return this._objRef?.enableZoom}set zoomSpeed(e){this._objRef&&(this._objRef.zoomSpeed=e)}get zoomSpeed(){return this._objRef?.zoomSpeed}set enableRotate(e){this._objRef&&(this._objRef.enableRotate=e)}get enableRotate(){return this._objRef?.enableRotate}set rotateSpeed(e){this._objRef&&(this._objRef.rotateSpeed=e)}get rotateSpeed(){return this._objRef?.rotateSpeed}set enablePan(e){this._objRef&&(this._objRef.enablePan=e)}get enablePan(){return this._objRef?.enablePan}set panSpeed(e){this._objRef&&(this._objRef.panSpeed=e)}get panSpeed(){return this._objRef?.panSpeed}set screenSpacePanning(e){this._objRef&&(this._objRef.screenSpacePanning=e)}get screenSpacePanning(){return this._objRef?.screenSpacePanning}set keyPanSpeed(e){this._objRef&&(this._objRef.keyPanSpeed=e)}get keyPanSpeed(){return this._objRef?.keyPanSpeed}set autoRotate(e){this._objRef&&(this._objRef.autoRotate=e)}get autoRotate(){return this._objRef?.autoRotate}set autoRotateSpeed(e){this._objRef&&(this._objRef.autoRotateSpeed=e)}get autoRotateSpeed(){return this._objRef?.autoRotateSpeed}set keys(e){this._objRef&&(this._objRef.keys=e)}get keys(){return this._objRef?.keys}set mouseButtons(e){this._objRef&&(this._objRef.mouseButtons=e)}get mouseButtons(){return this._objRef?.mouseButtons}set touches(e){this._objRef&&(this._objRef.touches=e)}get touches(){return this._objRef?.touches}set target0(e){this._objRef&&(this._objRef.target0=Ye(this._objRef.target0,e))}get target0(){return this._objRef?.target0}set position0(e){this._objRef&&(this._objRef.position0=Ye(this._objRef.position0,e))}get position0(){return this._objRef?.position0}set zoom0(e){this._objRef&&(this._objRef.zoom0=e)}get zoom0(){return this._objRef?.zoom0}}Pr.\u0275fac=function(){let i;return function(t){return(i||(i=le(Pr)))(t||Pr)}}(),Pr.\u0275cmp=$({type:Pr,selectors:[["th-orbitControls"]],inputs:{object:"object",domElement:"domElement",enabled:"enabled",target:"target",center:"center",minDistance:"minDistance",maxDistance:"maxDistance",minZoom:"minZoom",maxZoom:"maxZoom",minPolarAngle:"minPolarAngle",maxPolarAngle:"maxPolarAngle",minAzimuthAngle:"minAzimuthAngle",maxAzimuthAngle:"maxAzimuthAngle",enableDamping:"enableDamping",dampingFactor:"dampingFactor",enableZoom:"enableZoom",zoomSpeed:"zoomSpeed",enableRotate:"enableRotate",rotateSpeed:"rotateSpeed",enablePan:"enablePan",panSpeed:"panSpeed",screenSpacePanning:"screenSpacePanning",keyPanSpeed:"keyPanSpeed",autoRotate:"autoRotate",autoRotateSpeed:"autoRotateSpeed",keys:"keys",mouseButtons:"mouseButtons",touches:"touches",target0:"target0",position0:"position0",zoom0:"zoom0"},features:[ne([{provide:qn,useExisting:ae(()=>Pr)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class ps extends ao{getType(){return Sp}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set intensity(e){this._objRef&&(this._objRef.intensity=e)}get intensity(){return this._objRef?.intensity}set distance(e){this._objRef&&(this._objRef.distance=e)}get distance(){return this._objRef?.distance}set castShadow(e){this._objRef&&(this._objRef.castShadow=e)}get castShadow(){return this._objRef?.castShadow}set decay(e){this._objRef&&(this._objRef.decay=e)}get decay(){return this._objRef?.decay}set shadow(e){this._objRef&&(this._objRef.shadow=e)}get shadow(){return this._objRef?.shadow}set power(e){this._objRef&&(this._objRef.power=e)}get power(){return this._objRef?.power}}ps.\u0275fac=function(){let i;return function(t){return(i||(i=le(ps)))(t||ps)}}(),ps.\u0275cmp=$({type:ps,selectors:[["th-pointLight"]],inputs:{type:"type",intensity:"intensity",distance:"distance",castShadow:"castShadow",decay:"decay",shadow:"shadow",power:"power"},features:[ne([{provide:We,useExisting:ae(()=>ps)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Qa{get onMouseEnter(){return this.mouseEnter||(this.mouseEnter=new Tt),this.mouseEnter}get onMouseExit(){return this.mouseExit||(this.mouseExit=new Tt),this.mouseExit}get onClick(){return this.click||(this.click=new Tt),this.click}get onPointerDown(){return this.pointerDown||(this.pointerDown=new Tt),this.pointerDown}get onPointerUp(){return this.pointerUp||(this.pointerUp=new Tt),this.pointerUp}constructor(e,t){this.host=e,this.raycasterService=t,this.emitOnMouseEnter=this.emitOnMouseEnter.bind(this),this.emitOnMouseExit=this.emitOnMouseExit.bind(this),this.emitOnClick=this.emitOnClick.bind(this)}ngAfterViewInit(){this.subscribeEvents()}subscribeEvents(){this.raycasterService.addEventTarget(this)}unSubscribeEvents(){this.raycasterService.removeEventTarget(this)}emitOnMouseExit(){this.mouseExit?.emit({component:this.host,type:co.mouseExit})}emitOnMouseEnter(e){this.mouseEnter?.emit(e)}emitOnClick(e){this.click?.emit(e)}emitOnPointerDown(e){this.pointerDown?.emit(e)}emitOnPointerUp(e){this.pointerUp?.emit(e)}ngOnDestroy(){this.unSubscribeEvents()}}Qa.\u0275fac=function(e){return new(e||Qa)(I(We,1),I(uo))},Qa.\u0275dir=Ne({type:Qa,selectors:[["","onClick",""],["","onMouseEnter",""],["","onMouseExit",""],["","onPointerDown",""],["","onPointerUp",""]],outputs:{onMouseEnter:"onMouseEnter",onMouseExit:"onMouseExit",onClick:"onClick",onPointerDown:"onPointerDown",onPointerUp:"onPointerUp"}});const eue=function(){return[2,2,2]},tue=function(){return[1,1,1]},iue=function(){return[10,10]},nV=function(){return[10,10,10]},nue=function(){return[45,2,.1,100]},rue=function(){return[0,0,0]};class Xb{constructor(){this.selected=!1,this.glbPath=`${Ps}DamagedHelmet.glb`}}Xb.\u0275fac=function(e){return new(e||Xb)},Xb.\u0275cmp=$({type:Xb,selectors:[["app-controls-example"]],decls:8,vars:15,consts:[[3,"thStats"],["loadGLTF","",3,"url","scale","onClick"],[3,"args"],[3,"position"],[3,"args","position","lookAt"]],template:function(e,t){1&e&&(ge(0,"th-canvas",0)(1,"th-scene"),je(2,"th-ambientLight"),ge(3,"th-object3D",1),ut("onClick",function(){return t.selected=!t.selected}),Re(),je(4,"th-gridHelper",2)(5,"th-pointLight",3),ge(6,"th-perspectiveCamera",4),je(7,"th-orbitControls"),Re()()()),2&e&&(W("thStats",!0),K(3),W("url",t.glbPath)("scale",t.selected?Ce(8,eue):Ce(9,tue)),K(1),W("args",Ce(10,iue)),K(1),W("position",Ce(11,nV)),K(1),W("args",Ce(12,nue))("position",Ce(13,nV))("lookAt",Ce(14,rue)))},dependencies:[Pr,qi,We,Is,ps,Wn,Ki,Di,Bs,Qa,fs],encapsulation:2,changeDetection:0});const sue=function(){return[0,1,0]},oue=function(){return[10,10]},rV=function(){return[10,10,10]},aue=function(){return[45,2,.1,100]},lue=function(){return[0,0,0]};class Zb{constructor(e){this.cdref=e,this.modelScale=[1,1,1],this.rotation=[0,0,0],this.modelUrl1=`${Ps}DamagedHelmet.glb`,this.modelUrl2=`${Ps}BoomBox.glb`,this.modelUrl=this.toggleModel(),this.intervalHandle=window.setInterval(()=>this.toggleModel(),3e3)}toggleModel(){return this.modelUrl=this.modelUrl!==this.modelUrl1?this.modelUrl1:this.modelUrl2,this.cdref.markForCheck(),this.modelUrl}onLoaded(){this.modelScale=this.modelUrl!==this.modelUrl1?[100,100,100]:[1,1,1]}onRefChange(e){}onBeforeRender(){this.rotation=[0,this.rotation[1]+.01,0]}ngOnDestroy(){window.clearInterval(this.intervalHandle)}}Zb.\u0275fac=function(e){return new(e||Zb)(I(sr))},Zb.\u0275cmp=$({type:Zb,selectors:[["app-dynamic-loader-example"]],decls:7,vars:15,consts:[[3,"onRender"],["loadGLTF","",3,"url","scale","rotation","position","onLoaded","objRef$"],[3,"args"],[3,"position"],[3,"args","position","lookAt"]],template:function(e,t){1&e&&(ge(0,"th-canvas",0),ut("onRender",function(){return t.onBeforeRender()}),ge(1,"th-scene"),je(2,"th-ambientLight"),ge(3,"th-object3D",1),ut("onLoaded",function(){return t.onLoaded()})("objRef$",function(r){return t.onRefChange(r)}),Re(),je(4,"th-gridHelper",2)(5,"th-pointLight",3)(6,"th-perspectiveCamera",4),Re()()),2&e&&(K(3),W("url",t.modelUrl)("scale",t.modelScale)("rotation",t.rotation)("position",Ce(9,sue)),K(1),W("args",Ce(10,oue)),K(1),W("position",Ce(11,rV)),K(1),W("args",Ce(12,aue))("position",Ce(13,rV))("lookAt",Ce(14,lue)))},dependencies:[qi,We,Is,ps,Wn,Ki,Di,Bs],encapsulation:2});class Kb{transform(e,t){return e.bind(t)}}function cue(i,e){if(1&i&&(ge(0,"li"),bi(1),Re()),2&i){const t=e.$implicit;K(1),tc(" ",t," ")}}Kb.\u0275fac=function(e){return new(e||Kb)},Kb.\u0275pipe=_i({name:"bind",type:Kb,pure:!0});const due=function(){return[10,10]},sV=function(){return[10,10,10]},uue=function(){return[45,2,.1,100]},hue=function(){return[0,0,0]},fue=function(i,e){return{change:i,end:e}};class $b{constructor(e){this.cdref=e,this.id="CID",this.changes=[],this.rotation=[0,0,0],this.position=[0,1,0],this.assetPath=`${Ps}DamagedHelmet.glb`,this.onOrbitControlEnd=()=>{this.pushToChangesArray(`${this.id}: orbit control end`)},window.setInterval(()=>{this.rotation=[0,this.rotation[1]+.05,0],this.cdref.markForCheck()},1500),window.setInterval(()=>{this.position=[0,(this.position[1]+1)%5,0],this.cdref.markForCheck()},3e3)}logUpdates(e){this.pushToChangesArray(Object.keys(e).toString())}onLoaded(){this.changes.push("Model loaded")}onOrbitControlChange(){this.pushToChangesArray(`${this.id}: orbit control change`)}pushToChangesArray(e){this.changes.length>=20&&this.changes.shift(),this.changes.push(e)}}$b.\u0275fac=function(e){return new(e||$b)(I(sr))},$b.\u0275cmp=$({type:$b,selectors:[["app-events-example"]],decls:14,vars:21,consts:[["loadGLTF","",3,"url","rotation","position","onUpdate","onLoaded"],[3,"args"],[3,"position"],[3,"args","position","lookAt"],[3,"threeEvents"],[1,"change-list"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(ge(0,"th-canvas")(1,"th-scene"),je(2,"th-ambientLight"),ge(3,"th-object3D",0),ut("onUpdate",function(r){return t.logUpdates(r)})("onLoaded",function(){return t.onLoaded()}),Re(),je(4,"th-gridHelper",1)(5,"th-pointLight",2),ge(6,"th-perspectiveCamera",3),je(7,"th-orbitControls",4),On(8,"bind"),Re()()(),ge(9,"div",5)(10,"h1"),bi(11,"Updates"),Re(),ge(12,"ol"),Bt(13,cue,2,1,"li",6),Re()()),2&e&&(K(3),W("url",t.assetPath)("rotation",t.rotation)("position",t.position),K(1),W("args",Ce(13,due)),K(1),W("position",Ce(14,sV)),K(1),W("args",Ce(15,uue))("position",Ce(16,sV))("lookAt",Ce(17,hue)),K(1),W("threeEvents",$o(18,fue,function $F(i,e,t,n){const r=i+22,s=ze(),o=Dh(s,r);return y_(s,r)?YF(s,Jr(),e,o.transform,t,n,o):o.transform(t,n)}(8,10,t.onOrbitControlChange,t),t.onOrbitControlEnd)),K(6),W("ngForOf",t.changes))},dependencies:[yl,Pr,qi,We,Is,ps,Wn,Ki,Di,Bs,Kb],styles:[".change-list[_ngcontent-%COMP%]{padding:1em;box-shadow:0 4px 8px #0003;transition:.3s}[_nghost-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr)}"],changeDetection:0});const Pp=JSON.parse('{"name":"ngx-three","version":"0.28.0","scripts":{"ng":"ng","start":"ng serve","build":"ng build ngx-three","build:prod":"ng build ngx-three --configuration production","build:demo":"ng build ngx-three-demo --configuration production --base-href /ngx-three/","test":"ng test","test-headless":"ng test --watch=false --browsers=ChromeHeadless","lint":"ng lint","e2e":"ng e2e","copy:docs":"(cp README.md dist/ngx-three/ || copy README.md dist\\\\ngx-three)","package":"ng build --configuration production ngx-three && npm run copy:docs","format":"prettier-eslint --write \\"{,!(node_modules|dist)/**/}*.{ts,tsx}\\""},"private":true,"dependencies":{"@angular/animations":"^15.1.1","@angular/cdk":"^15.1.1","@angular/common":"^15.1.1","@angular/compiler":"^15.1.1","@angular/core":"^15.1.1","@angular/forms":"^15.1.1","@angular/material":"^15.1.1","@angular/platform-browser":"^15.1.1","@angular/platform-browser-dynamic":"^15.1.1","@angular/router":"^15.1.1","@stackblitz/sdk":"^1.5.3","lil-gui":"^0.17.0","ngx-highlightjs":"^7.0.0","normalize.css":"^8.0.1","rxjs":"~7.5.5","simplex-noise":"^4.0.1","three":"~0.151.0","tslib":"^2.3.1","zone.js":"~0.11.4"},"devDependencies":{"@angular-devkit/build-angular":"^15.1.2","@angular-eslint/builder":"~15.2.0","@angular-eslint/eslint-plugin":"~15.2.0","@angular-eslint/eslint-plugin-template":"~15.2.0","@angular-eslint/schematics":"^15.2.0","@angular-eslint/template-parser":"~15.2.0","@angular/cli":"^15.1.2","@angular/compiler-cli":"^15.1.1","@types/jasmine":"~3.6.0","@types/node":"^18.0.0","@types/prettier":"^2.6.3","@types/three":"~0.151.0","@typescript-eslint/eslint-plugin":"^5.43.0","@typescript-eslint/parser":"^5.43.0","acorn":">=8","eslint":"^8.28.0","eslint-plugin-import":"^2.26.0","eslint-plugin-jsdoc":"^39.3.3","eslint-plugin-prefer-arrow":"^1.2.3","jasmine-core":"~3.6.0","jasmine-spec-reporter":"~5.0.0","karma":"~6.3.9","karma-chrome-launcher":"~3.1.0","karma-coverage":"~2.0.3","karma-jasmine":"~4.0.0","karma-jasmine-html-reporter":"^1.5.0","ng-packagr":"^15.1.1","prettier":"^2.7.1","prettier-eslint":"^15.0.1","prettier-eslint-cli":"^7.1.0","ts-node":"^10.8.1","typescript":"~4.9.4","utility-types":"^3.10.0"}}'),oV='\nimport "zone.js";';function dI(){return(dI=ss(function*(i,e){const n=Jb(dV(i)),r=cV(n),s={"package.json":gue(),"src/index.html":{content:lV(r)},"src/main.ts":{content:aV(n,e)},"src/polyfills.ts":{content:oV},"src/assets.ts":{content:`export const ASSET_PATH = '${H5}';`}};yield mue(i,s),fetch("https://codesandbox.io/api/v1/sandboxes/define?json=1",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({files:s})}).then(o=>o.json()).then(o=>window.open(`https://codesandbox.io/s/${o.sandbox_id}`,"_blank"))})).apply(this,arguments)}function mue(i,e){return Promise.all(i.map(t=>fetch(t).then(function(){var n=ss(function*(r){e[`src/app/${Jb(t)}`]={content:yield r.text()}});return function(r){return n.apply(this,arguments)}}())))}function gue(){return{content:{main:"src/main.ts",dependencies:{"ngx-three":"latest","@types/three":Pp.devDependencies["@types/three"],...Pp.dependencies},devDependencies:{...Pp.devDependencies}}}}function Jb(i){return i.replace(/^.*[\\\/]/,"")}function aV(i,e){const t=function vue(i){if(i&&i.length>0)return i[0]}(e)??function _ue(i){return i.replace(".ts","").replace(/(?:^\w|[A-Z]|\b\w)/g,(e,t)=>e.toUpperCase()).replace(/[-.]/g,"")}(i),n=function Aue(i,e){return i&&i.length>0?i.join(","):e}(e,t);return`\n            import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n            import { NgModule } from '@angular/core';\n            import { BrowserModule } from '@angular/platform-browser';\n            import { NgxThreeModule } from 'ngx-three';\n            import { FormsModule } from '@angular/forms';\n            import { ${n} } from './app/${i.replace(".ts","")}';\n\n            @NgModule({\n                imports: [\n                    BrowserModule,\n                    NgxThreeModule,\n                    FormsModule\n                ],\n                providers: [],\n                declarations: [${n}],\n                bootstrap: [${t}]\n            })\n            export class AppModule {}\n\n            platformBrowserDynamic().bootstrapModule(AppModule)\n            .catch(err => console.log(err));\n            `}function lV(i){return`\n    <!DOCTYPE html>\n    <html lang="en">\n    <head>\n        <meta charset="utf-8" />\n        <title>NgxThreeDemo</title>\n        <base href="/" />\n        <meta name="viewport" content="width=device-width, initial-scale=1" />\n        <link rel="icon" type="image/x-icon" href="favicon.ico" />\n    </head>\n    <body>\n        <${i}></${i}>\n    </body>\n    </html>\n    `}function cV(i){return"app-"+i.replace(".component.ts","")}function dV(i){for(const e of i)if(e.endsWith(".ts"))return e;return""}function bue(i){for(const e of i)if(e.endsWith(".html"))return e}function kp(i){return i&&i.origin?i.origin:"https://stackblitz.com"}function uV(){return Math.random().toString(36).substring(7)}function Bp(i){var e=[];return i&&(i.forceEmbedLayout&&e.push("embed=1"),i.clickToLoad&&e.push("ctl=1"),"string"==typeof i.openFile&&e.push("file="+i.openFile),"preview"!==i.view&&"editor"!==i.view||e.push("view="+i.view),"light"!==i.theme&&"dark"!==i.theme||e.push("theme="+i.theme),i.hideExplorer&&e.push("hideExplorer=1"),i.hideNavigation&&e.push("hideNavigation=1"),i.hideDevTools&&e.push("hidedevtools=1"),"number"==typeof i.devToolsHeight&&i.devToolsHeight>=0&&i.devToolsHeight<=100&&e.push("devtoolsheight="+Math.round(i.devToolsHeight))),e.length?"?"+e.join("&"):""}function uI(i,e,t){if(null===i.parentNode)throw new Error("Invalid Element");e.id=i.id,function xue(i,e){e&&(e.hasOwnProperty("height")&&(i.height=""+e.height),e.hasOwnProperty("width")&&(i.width=""+e.width)),i.height||(i.height="300"),i.width||i.setAttribute("style","width:100%;")}(e,t),i.parentNode.replaceChild(e,i)}function hI(i){if("string"==typeof i){var e=document.getElementById(i);if(null!==e)return e}else if(i instanceof HTMLElement)return i;throw new Error("Invalid Element")}function fI(i){return i&&!1===i.newWindow?"_self":"_blank"}var hV=function(i){var e=this;this.pending={},this.port=i,this.port.onmessage=function(t){if(t.data.payload.__reqid){var n=t.data.payload.__reqid,r=t.data.payload.__success;if(e.pending[n]){if(delete t.data.payload.__reqid,delete t.data.payload.__success,r){var s=0===Object.keys(t.data.payload).length&&t.data.payload.constructor===Object?null:t.data.payload;e.pending[n].resolve(s)}else e.pending[n].reject(t.data.payload.error?t.data.type+": "+t.data.payload.error:t.data.type);delete e.pending[n]}}}};hV.prototype.request=function(i){var e=this,t=uV();return new Promise(function(n,r){e.pending[t]={resolve:n,reject:r},i.payload.__reqid=t,e.port.postMessage(i)})};var Yx=function(i,e){var t=this;this.rdc=new hV(i),this.preview={},Object.defineProperty(this.preview,"origin",{value:e.previewOrigin,writable:!1}),this.editor={openFile:function(n){return t.rdc.request({type:"SDK_OPEN_FILE",payload:{path:n}})}}};Yx.prototype.applyFsDiff=function(i){return this.rdc.request({type:"SDK_APPLY_FS_DIFF",payload:i})},Yx.prototype.getFsSnapshot=function(){return this.rdc.request({type:"SDK_GET_FS_SNAPSHOT",payload:{}})},Yx.prototype.getDependencies=function(){return this.rdc.request({type:"SDK_GET_DEPS_SNAPSHOT",payload:{}})};var Xx=[],wue=function(i){var e=this;this.id=uV(),this.element=i,this.pending=new Promise(function(t,n){var r=function(c){c.data.action&&"SDK_INIT_SUCCESS"===c.data.action&&c.data.id===e.id&&(e.vm=new Yx(c.ports[0],c.data.payload),t(e.vm),o())},s=function(){e.element.contentWindow&&e.element.contentWindow.postMessage({action:"SDK_INIT",id:e.id},"*")};function o(){window.clearInterval(l),window.removeEventListener("message",r)}window.addEventListener("message",r),s();var a=0,l=window.setInterval(function(){if(e.vm)o();else{if(a>=20)return o(),n("Timeout: Unable to establish a connection with the StackBlitz VM"),void Xx.forEach(function(c,d){c.id===e.id&&Xx.splice(d,1)});a++,s()}},500)}),Xx.push(this)},fV=["typescript","create-react-app","angular-cli","javascript","polymer","vue"];function Ru(i,e){var t=document.createElement("input");return t.type="hidden",t.name=i,t.value=e,t}function pV(i){-1===fV.indexOf(i.template)&&console.warn("Unsupported project template, must be one of: "+fV.join(", "));var e=document.createElement("form");return e.method="POST",e.setAttribute("style","display:none;"),e.appendChild(Ru("project[title]",i.title)),e.appendChild(Ru("project[description]",i.description)),e.appendChild(Ru("project[template]",i.template)),i.tags&&i.tags.forEach(function(t){e.appendChild(Ru("project[tags][]",t))}),i.dependencies&&e.appendChild(Ru("project[dependencies]",JSON.stringify(i.dependencies))),i.settings&&e.appendChild(Ru("project[settings]",JSON.stringify(i.settings))),Object.keys(i.files).forEach(function(t){e.appendChild(Ru("project[files]["+t+"]",i.files[t]))}),e}var Zx={connect:function(i){if(!i||!i.contentWindow)return Promise.reject("Provided element is not an iframe.");var e=function(i){var e=i instanceof Element?"element":"id";return Xx.find(function(n){return n[e]===i})||null}(i);return e?e.pending:new wue(i).pending},openGithubProject:function(i,e){window.open(kp(e)+"/github/"+i+Bp(e),fI(e))},openProject:function(i,e){!function Eue(i,e){var t=pV(i);t.action=kp(e)+"/run"+Bp(e),t.target=fI(e),document.body.appendChild(t),t.submit(),document.body.removeChild(t)}(i,e)},openProjectId:function(i,e){window.open(kp(e)+"/edit/"+i+Bp(e),fI(e))},embedGithubProject:function(i,e,t){var n=hI(i),r=document.createElement("iframe");return r.src=kp(t)+"/github/"+e+Bp(t),uI(n,r,t),Zx.connect(r)},embedProject:function(i,e,t){var n=hI(i),r=function Mue(i,e){var t=pV(i);return t.action=kp(e)+"/run"+Bp(e),t.id="sb","<html><head><title></title></head><body>"+t.outerHTML+"<script>document.getElementById('sb').submit();<\/script></body></html>"}(e,t),s=document.createElement("iframe");return uI(n,s,t),s.contentDocument&&s.contentDocument.write(r),Zx.connect(s)},embedProjectId:function(i,e,t){var n=hI(i),r=document.createElement("iframe");return r.src=kp(t)+"/edit/"+e+Bp(t),uI(n,r,t),Zx.connect(r)}};const Sue=Zx;function pI(){return(pI=ss(function*(i,e){const t=dV(i),n=bue(i),r=Jb(t),s=cV(r),o={template:"angular-cli",title:s,description:"ngx-three example "+s,files:{"src/index.html":lV(s),"src/main.ts":aV(r,e),"src/polyfills.ts":oV,"src/assets.ts":`export const ASSET_PATH = '${H5}';`},dependencies:{"ngx-three":"latest","@types/three":Pp.devDependencies["@types/three"],...Pp.dependencies},devDependencies:{...Pp.devDependencies}};yield Rue(i,o.files);const a=n?{openFile:`src/app/${Jb(n)}`}:void 0;Sue.openProject(o,a)})).apply(this,arguments)}function Rue(i,e){return Promise.all(i.map(t=>fetch(t).then(function(){var n=ss(function*(r){const s=yield r.text();e[`src/app/${Jb(t)}`]=s});return function(r){return n.apply(this,arguments)}}())))}class Kx{constructor(){this.urls=[],this.fileNames=[]}setUrls(e){this.urls=e,this.fileNames=this.extractFileNames()}extractFileNames(){return this.urls.map(e=>e.split("/").pop()??"")}toStackblitz(e){e?.preventDefault(),function Tue(i,e){pI.apply(this,arguments)}(this.urls,this.declarations)}toCodeSandbox(e){e?.preventDefault(),function pue(i,e){dI.apply(this,arguments)}(this.urls,this.declarations)}}let mI;try{mI=typeof Intl<"u"&&Intl.v8BreakIterator}catch{mI=!1}let e0,$x,Iu,gI,Yn=(()=>{class i{constructor(t){this._platformId=t,this.isBrowser=this._platformId?T3(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!mI)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return i.\u0275fac=function(t){return new(t||i)(xe(C_))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function t0(i){return function Iue(){if(null==e0&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>e0=!0}))}finally{e0=e0||!1}return e0}()?i:!!i.capture}function gV(){if(null==Iu){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Iu=!1,Iu;if("scrollBehavior"in document.documentElement.style)Iu=!0;else{const i=Element.prototype.scrollTo;Iu=!!i&&!/\{\s*\[native code\]\s*\}/.test(i.toString())}}return Iu}function n0(){if("object"!=typeof document||!document)return 0;if(null==$x){const i=document.createElement("div"),e=i.style;i.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),n=t.style;n.width="2px",n.height="1px",i.appendChild(t),document.body.appendChild(i),$x=0,0===i.scrollLeft&&(i.scrollLeft=1,$x=0===i.scrollLeft?1:2),i.remove()}return $x}function Ic(i){return i.composedPath?i.composedPath()[0]:i.target}function _I(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Jx(i,...e){return e.length?e.some(t=>i[t]):i.altKey||i.shiftKey||i.ctrlKey||i.metaKey}class $ue extends un{constructor(e,t){super()}schedule(e,t=0){return this}}const ew={setInterval(i,e,...t){const{delegate:n}=ew;return n?.setInterval?n.setInterval(i,e,...t):setInterval(i,e,...t)},clearInterval(i){const{delegate:e}=ew;return(e?.clearInterval||clearInterval)(i)},delegate:void 0};class bI extends $ue{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,n=0){return ew.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;ew.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,n=!1;try{this.work(e)}catch(s){n=!0,r=s||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,hv(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}class r0{constructor(e,t=r0.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}r0.now=KR.now;class vI extends r0{constructor(e,t=r0.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const AI=new vI(bI),Jue=AI;function tw(i,e=AI){return Mn((t,n)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const c=s;s=null,n.next(c)}};function l(){const c=o+i,d=e.now();if(d<c)return r=this.schedule(void 0,c-d),void n.add(r);a()}t.subscribe(hn(n,c=>{s=c,o=e.now(),r||(r=e.schedule(l,i),n.add(r))},()=>{a(),n.complete()},void 0,()=>{s=r=null}))})}function yI(i){return jn((e,t)=>i<=t)}function xI(i,e=Xl){return i=i??ehe,Mn((t,n)=>{let r,s=!0;t.subscribe(hn(n,o=>{const a=e(o);(s||!i(r,a))&&(s=!1,r=a,n.next(o))}))})}function ehe(i,e){return i===e}function Qi(i){return null!=i&&"false"!=`${i}`}function ms(i,e=0){return function the(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}(i)?Number(i):e}function iw(i){return Array.isArray(i)?i:[i]}function cr(i){return null==i?"":"string"==typeof i?i:`${i}px`}function Du(i){return i instanceof Ft?i.nativeElement:i}let AV=(()=>{class i{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),ihe=(()=>{class i{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,n)=>this._cleanupObserver(n))}observe(t){const n=Du(t);return new Oi(r=>{const o=this._observeElement(n).subscribe(r);return()=>{o.unsubscribe(),this._unobserveElement(n)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const n=new Wt,r=this._mutationObserverFactory.create(s=>n.next(s));r&&r.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:r,stream:n,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:n,stream:r}=this._observedElements.get(t);n&&n.disconnect(),r.complete(),this._observedElements.delete(t)}}}return i.\u0275fac=function(t){return new(t||i)(xe(AV))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),wI=(()=>{class i{get disabled(){return this._disabled}set disabled(t){this._disabled=Qi(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=ms(t),this._subscribe()}constructor(t,n,r){this._contentObserver=t,this._elementRef=n,this._ngZone=r,this.event=new Tt,this._disabled=!1,this._currentSubscription=null}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(tw(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(I(ihe),I(Ft),I(gt))},i.\u0275dir=Ne({type:i,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),i})(),nw=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({providers:[AV]}),i})(),nhe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({}),i})();const yV=new Set;let Fp,rhe=(()=>{class i{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):ohe}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function she(i){if(!yV.has(i))try{Fp||(Fp=document.createElement("style"),Fp.setAttribute("type","text/css"),document.head.appendChild(Fp)),Fp.sheet&&(Fp.sheet.insertRule(`@media ${i} {body{ }}`,0),yV.add(i))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return i.\u0275fac=function(t){return new(t||i)(xe(Yn))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function ohe(i){return{matches:"all"===i||""===i,media:i,addListener:()=>{},removeListener:()=>{}}}let xV=(()=>{class i{constructor(t,n){this._mediaMatcher=t,this._zone=n,this._queries=new Map,this._destroySubject=new Wt}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return wV(iw(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=TS(wV(iw(t)).map(o=>this._registerQuery(o).observable));return s=YA(s.pipe(bs(1)),s.pipe(yI(1),tw(0))),s.pipe(wt(o=>{const a={matches:!1,breakpoints:{}};return o.forEach(({matches:l,query:c})=>{a.matches=a.matches||l,a.breakpoints[c]=l}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const n=this._mediaMatcher.matchMedia(t),s={observable:new Oi(o=>{const a=l=>this._zone.run(()=>o.next(l));return n.addListener(a),()=>{n.removeListener(a)}}).pipe(sc(n),wt(({matches:o})=>({query:t,matches:o})),yn(this._destroySubject)),mql:n};return this._queries.set(t,s),s}}return i.\u0275fac=function(t){return new(t||i)(xe(rhe),xe(gt))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function wV(i){return i.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}class dhe{constructor(e){this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new Wt,this._typeaheadSubscription=un.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=t=>t.disabled,this._pressedLetters=[],this.tabOut=new Wt,this.change=new Wt,e instanceof Ld&&(this._itemChangesSubscription=e.changes.subscribe(t=>{if(this._activeItem){const r=t.toArray().indexOf(this._activeItem);r>-1&&r!==this._activeItemIndex&&(this._activeItemIndex=r)}}))}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(ln(t=>this._pressedLetters.push(t)),tw(e),jn(()=>this._pressedLetters.length>0),wt(()=>this._pressedLetters.join(""))).subscribe(t=>{const n=this._getItemsArray();for(let r=1;r<n.length+1;r++){const s=(this._activeItemIndex+r)%n.length,o=n[s];if(!this._skipPredicateFn(o)&&0===o.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(s);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}withPageUpDown(e=!0,t=10){return this._pageUpAndDown={enabled:e,delta:t},this}setActiveItem(e){const t=this._activeItem;this.updateActiveItem(e),this._activeItem!==t&&this.change.next(this._activeItemIndex)}onKeydown(e){const t=e.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!e[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;case 33:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(s>0?s:0,1);break}return;case 34:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex+this._pageUpAndDown.delta,o=this._getItemsArray().length;this._setActiveItemByIndex(s<o?s:o-1,-1);break}return;default:return void((r||Jx(e,"shiftKey"))&&(e.key&&1===e.key.length?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))))}this._pressedLetters=[],e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){const t=this._getItemsArray(),n="number"==typeof e?e:t.indexOf(e);this._activeItem=t[n]??null,this._activeItemIndex=n}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){const t=this._getItemsArray();for(let n=1;n<=t.length;n++){const r=(this._activeItemIndex+e*n+t.length)%t.length;if(!this._skipPredicateFn(t[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,t){const n=this._getItemsArray();if(n[e]){for(;this._skipPredicateFn(n[e]);)if(!n[e+=t])return;this.setActiveItem(e)}}_getItemsArray(){return this._items instanceof Ld?this._items.toArray():this._items}}class EV extends dhe{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(e){return this._origin=e,this}setActiveItem(e){super.setActiveItem(e),this.activeItem&&this.activeItem.focus(this._origin)}}let SV=(()=>{class i{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function hhe(i){return!!(i.offsetWidth||i.offsetHeight||"function"==typeof i.getClientRects&&i.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const n=function uhe(i){try{return i.frameElement}catch{return null}}(function Ahe(i){return i.ownerDocument&&i.ownerDocument.defaultView||window}(t));if(n&&(-1===RV(n)||!this.isVisible(n)))return!1;let r=t.nodeName.toLowerCase(),s=RV(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function bhe(i){let e=i.nodeName.toLowerCase(),t="input"===e&&i.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,n){return function vhe(i){return!function phe(i){return function ghe(i){return"input"==i.nodeName.toLowerCase()}(i)&&"hidden"==i.type}(i)&&(function fhe(i){let e=i.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(i)||function mhe(i){return function _he(i){return"a"==i.nodeName.toLowerCase()}(i)&&i.hasAttribute("href")}(i)||i.hasAttribute("contenteditable")||TV(i))}(t)&&!this.isDisabled(t)&&(n?.ignoreVisibility||this.isVisible(t))}}return i.\u0275fac=function(t){return new(t||i)(xe(Yn))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function TV(i){if(!i.hasAttribute("tabindex")||void 0===i.tabIndex)return!1;let e=i.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function RV(i){if(!TV(i))return null;const e=parseInt(i.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class yhe{get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}constructor(e,t,n,r,s=!1){this._element=e,this._checker=t,this._ngZone=n,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const n=this._getFirstTabbableElement(t);return n?.focus(e),!!n}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let n=0;n<t.length;n++){const r=t[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[n]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let n=t.length-1;n>=0;n--){const r=t[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[n]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(bs(1)).subscribe(e)}}let xhe=(()=>{class i{constructor(t,n,r){this._checker=t,this._ngZone=n,this._document=r}create(t,n=!1){return new yhe(t,this._checker,this._ngZone,this._document,n)}}return i.\u0275fac=function(t){return new(t||i)(xe(SV),xe(gt),xe(ti))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function IV(i){return 0===i.buttons||0===i.offsetX&&0===i.offsetY}function DV(i){const e=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const whe=new Oe("cdk-input-modality-detector-options"),Che={ignoreKeys:[18,17,224,91,16]},Op=t0({passive:!0,capture:!0});let Mhe=(()=>{class i{get mostRecentModality(){return this._modality.value}constructor(t,n,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new qs(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(a=>a===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Ic(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(IV(o)?"keyboard":"mouse"),this._mostRecentTarget=Ic(o))},this._onTouchstart=o=>{DV(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Ic(o))},this._options={...Che,...s},this.modalityDetected=this._modality.pipe(yI(1)),this.modalityChanged=this.modalityDetected.pipe(xI()),t.isBrowser&&n.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,Op),r.addEventListener("mousedown",this._onMousedown,Op),r.addEventListener("touchstart",this._onTouchstart,Op)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Op),document.removeEventListener("mousedown",this._onMousedown,Op),document.removeEventListener("touchstart",this._onTouchstart,Op))}}return i.\u0275fac=function(t){return new(t||i)(xe(Yn),xe(gt),xe(ti),xe(whe,8))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const She=new Oe("cdk-focus-monitor-default-options"),rw=t0({passive:!0,capture:!0});let CI=(()=>{class i{constructor(t,n,r,s,o){this._ngZone=t,this._platform=n,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Wt,this._rootNodeFocusAndBlurListener=a=>{for(let c=Ic(a);c;c=c.parentElement)"focus"===a.type?this._onFocus(a,c):this._onBlur(a,c)},this._document=s,this._detectionMode=o?.detectionMode||0}monitor(t,n=!1){const r=Du(t);if(!this._platform.isBrowser||1!==r.nodeType)return St(null);const s=function Pue(i){if(function Due(){if(null==gI){const i=typeof document<"u"?document.head:null;gI=!(!i||!i.createShadowRoot&&!i.attachShadow)}return gI}()){const e=i.getRootNode?i.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return n&&(o.checkChildren=!0),o.subject;const a={checkChildren:n,subject:new Wt,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const n=Du(t),r=this._elementInfo.get(n);r&&(r.subject.complete(),this._setClasses(n),this._elementInfo.delete(n),this._removeGlobalListeners(r))}focusVia(t,n,r){const s=Du(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,l])=>this._originChanged(a,n,l)):(this._setOrigin(n),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,n)=>this.stopMonitoring(n))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,n){t.classList.toggle("cdk-focused",!!n),t.classList.toggle("cdk-touch-focused","touch"===n),t.classList.toggle("cdk-keyboard-focused","keyboard"===n),t.classList.toggle("cdk-mouse-focused","mouse"===n),t.classList.toggle("cdk-program-focused","program"===n)}_setOrigin(t,n=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&n,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,n){const r=this._elementInfo.get(n),s=Ic(t);!r||!r.checkChildren&&n!==s||this._originChanged(n,this._getFocusOrigin(s),r)}_onBlur(t,n){const r=this._elementInfo.get(n);!r||r.checkChildren&&t.relatedTarget instanceof Node&&n.contains(t.relatedTarget)||(this._setClasses(n),this._emitOrigin(r,null))}_emitOrigin(t,n){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(n))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const n=t.rootNode,r=this._rootNodeFocusListenerCount.get(n)||0;r||this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",this._rootNodeFocusAndBlurListener,rw),n.addEventListener("blur",this._rootNodeFocusAndBlurListener,rw)}),this._rootNodeFocusListenerCount.set(n,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(yn(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const n=t.rootNode;if(this._rootNodeFocusListenerCount.has(n)){const r=this._rootNodeFocusListenerCount.get(n);r>1?this._rootNodeFocusListenerCount.set(n,r-1):(n.removeEventListener("focus",this._rootNodeFocusAndBlurListener,rw),n.removeEventListener("blur",this._rootNodeFocusAndBlurListener,rw),this._rootNodeFocusListenerCount.delete(n))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,n,r){this._setClasses(t,n),this._emitOrigin(r,n),this._lastFocusOrigin=n}_getClosestElementsInfo(t){const n=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&n.push([s,r])}),n}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:n,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!n||n===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const s=t.labels;if(s)for(let o=0;o<s.length;o++)if(s[o].contains(n))return!0;return!1}}return i.\u0275fac=function(t){return new(t||i)(xe(gt),xe(Yn),xe(Mhe),xe(ti,8),xe(She,8))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),The=(()=>{class i{constructor(t,n){this._elementRef=t,this._focusMonitor=n,this._focusOrigin=null,this.cdkFocusChange=new Tt}get focusOrigin(){return this._focusOrigin}ngAfterViewInit(){const t=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(t,1===t.nodeType&&t.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(n=>{this._focusOrigin=n,this.cdkFocusChange.emit(n)})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(CI))},i.\u0275dir=Ne({type:i,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"},exportAs:["cdkMonitorFocus"]}),i})();const kV="cdk-high-contrast-black-on-white",BV="cdk-high-contrast-white-on-black",MI="cdk-high-contrast-active";let LV=(()=>{class i{constructor(t,n){this._platform=t,this._document=n,this._breakpointSubscription=Et(xV).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const n=this._document.defaultView||window,r=n&&n.getComputedStyle?n.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(MI,kV,BV),this._hasCheckedHighContrastMode=!0;const n=this.getHighContrastMode();1===n?t.add(MI,kV):2===n&&t.add(MI,BV)}}}return i.\u0275fac=function(t){return new(t||i)(xe(Yn),xe(ti))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Rhe=(()=>{class i{constructor(t){t._applyBodyHighContrastModeCssClasses()}}return i.\u0275fac=function(t){return new(t||i)(xe(LV))},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[nw]}),i})();const Ihe=new Oe("cdk-dir-doc",{providedIn:"root",factory:function Dhe(){return Et(ti)}}),Phe=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Wa=(()=>{class i{constructor(t){this.value="ltr",this.change=new Tt,t&&(this.value=function khe(i){const e=i?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?Phe.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return i.\u0275fac=function(t){return new(t||i)(xe(Ihe,8))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),s0=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({}),i})();const Lhe=new Oe("mat-sanity-checks",{providedIn:"root",factory:function Bhe(){return!0}});let xn=(()=>{class i{constructor(t,n,r){this._sanityChecks=n,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!_I()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return i.\u0275fac=function(t){return new(t||i)(xe(LV),xe(Lhe,8),xe(ti))},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[s0,s0]}),i})();function EI(i){return class extends i{get disabled(){return this._disabled}set disabled(e){this._disabled=Qi(e)}constructor(...e){super(...e),this._disabled=!1}}}function sw(i,e){return class extends i{get color(){return this._color}set color(t){const n=t||this.defaultColor;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}constructor(...t){super(...t),this.defaultColor=e,this.color=e}}}function NV(i){return class extends i{get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=Qi(e)}constructor(...e){super(...e),this._disableRipple=!1}}}class Ohe{constructor(e,t,n,r=!1){this._renderer=e,this.element=t,this.config=n,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const jV=t0({passive:!0,capture:!0});class Nhe{constructor(){this._events=new Map,this._delegateEventHandler=e=>{const t=Ic(e);t&&this._events.get(e.type)?.forEach((n,r)=>{(r===t||r.contains(t))&&n.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,n,r){const s=this._events.get(t);if(s){const o=s.get(n);o?o.add(r):s.set(n,new Set([r]))}else this._events.set(t,new Map([[n,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,jV)})}removeHandler(e,t,n){const r=this._events.get(e);if(!r)return;const s=r.get(t);s&&(s.delete(n),0===s.size&&r.delete(t),0===r.size&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,jV)))}}const UV={enterDuration:225,exitDuration:150},VV=t0({passive:!0,capture:!0}),zV=["mousedown","touchstart"],GV=["mouseup","mouseleave","touchend","touchcancel"];class Np{constructor(e,t,n,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Du(n))}fadeInRipple(e,t,n={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...UV,...n.animation};n.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=n.radius||function Uhe(i,e,t){const n=Math.max(Math.abs(i-t.left),Math.abs(i-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(n*n+r*r)}(e,t,r),a=e-r.left,l=t-r.top,c=s.enterDuration,d=document.createElement("div");d.classList.add("mat-ripple-element"),d.style.left=a-o+"px",d.style.top=l-o+"px",d.style.height=2*o+"px",d.style.width=2*o+"px",null!=n.color&&(d.style.backgroundColor=n.color),d.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(d);const u=window.getComputedStyle(d),f=u.transitionDuration,m="none"===u.transitionProperty||"0s"===f||"0s, 0s"===f||0===r.width&&0===r.height,_=new Ohe(this,d,n,m);d.style.transform="scale3d(1, 1, 1)",_.state=0,n.persistent||(this._mostRecentTransientRipple=_);let g=null;return!m&&(c||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const p=()=>this._finishRippleTransition(_),v=()=>this._destroyRipple(_);d.addEventListener("transitionend",p),d.addEventListener("transitioncancel",v),g={onTransitionEnd:p,onTransitionCancel:v}}),this._activeRipples.set(_,g),(m||!c)&&this._finishRippleTransition(_),_}fadeOutRipple(e){if(2===e.state||3===e.state)return;const t=e.element,n={...UV,...e.config.animation};t.style.transitionDuration=`${n.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=Du(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,zV.forEach(n=>{Np._eventManager.addHandler(this._ngZone,n,t,this)}))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{GV.forEach(t=>{this._triggerElement.addEventListener(t,this,VV)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){0===e.state?this._startFadeOutTransition(e):2===e.state&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:n}=e.config;e.state=1,!n&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=IV(e),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!n&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!DV(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let n=0;n<t.length;n++)this.fadeInRipple(t[n].clientX,t[n].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const e=this._triggerElement;e&&(zV.forEach(t=>Np._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&GV.forEach(t=>e.removeEventListener(t,this,VV)))}}Np._eventManager=new Nhe;const ow=new Oe("mat-ripple-global-options");let a0=(()=>{class i{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,n,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new Np(this,n,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,n=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,n,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(gt),I(Yn),I(ow,8),I(rs,8))},i.\u0275dir=Ne({type:i,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,n){2&t&&Ei("mat-ripple-unbounded",n.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),i})(),l0=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[xn,xn]}),i})(),HV=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[xn]}),i})(),QV=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[l0,Ta,xn,HV]}),i})();const Vhe=["mat-button",""],zhe=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],Ghe=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],Qhe=["mat-icon-button",""],Whe=["*"],qhe=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],Yhe=sw(EI(NV(class{constructor(i){this._elementRef=i}})));let WV=(()=>{class i extends Yhe{constructor(t,n,r,s){super(t),this._platform=n,this._ngZone=r,this._animationMode=s,this._focusMonitor=Et(CI),this._isFab=!1;const o=t.nativeElement.classList;for(const a of qhe)this._hasHostAttributes(a.selector)&&a.mdcClasses.forEach(l=>{o.add(l)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t="program",n){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,n):this._elementRef.nativeElement.focus(n)}_hasHostAttributes(...t){return t.some(n=>this._elementRef.nativeElement.hasAttribute(n))}_isRippleDisabled(){return this.disableRipple||this.disabled}}return i.\u0275fac=function(t){o_()},i.\u0275dir=Ne({type:i,viewQuery:function(t,n){if(1&t&&ji(a0,5),2&t){let r;Ot(r=Nt())&&(n.ripple=r.first)}},features:[q]}),i})(),qV=(()=>{class i extends WV{constructor(t,n,r,s){super(t,n,r,s)}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(Yn),I(gt),I(rs,8))},i.\u0275cmp=$({type:i,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:7,hostBindings:function(t,n){2&t&&(pn("disabled",n.disabled||null),Ei("_mat-animation-noopable","NoopAnimations"===n._animationMode)("mat-unthemed",!n.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[q],attrs:Vhe,ngContentSelectors:Ghe,decls:8,vars:6,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(t,n){1&t&&(he(zhe),je(0,"span",0),ie(1),ge(2,"span",1),ie(3,1),Re(),ie(4,2),je(5,"span",2)(6,"span",3)(7,"span",4)),2&t&&(Ei("mdc-button__ripple",!n._isFab)("mdc-fab__ripple",n._isFab),K(6),W("matRippleDisabled",n._isRippleDisabled())("matRippleTrigger",n._elementRef.nativeElement))},dependencies:[a0],styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    );display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{height:var(--mdc-text-button-container-height, 36px);border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, inherit)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button{height:var(--mdc-filled-button-container-height, 36px);border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color, transparent)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, inherit)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button{height:var(--mdc-protected-button-container-height, 36px);border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px));box-shadow:var(--mdc-protected-button-container-elevation, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color, transparent)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, inherit)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button.mdc-ripple-upgraded--background-focused,.mat-mdc-raised-button:not(.mdc-ripple-upgraded):focus{box-shadow:var(--mdc-protected-button-focus-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled):active{box-shadow:var(--mdc-protected-button-pressed-container-elevation, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button{height:var(--mdc-outlined-button-container-height, 36px);border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px));padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, inherit)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width, 1px));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width, 1px))}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-button .mat-ripple-element,.mat-mdc-unelevated-button .mat-ripple-element,.mat-mdc-raised-button .mat-ripple-element,.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button[disabled],.mat-mdc-unelevated-button[disabled],.mat-mdc-raised-button[disabled],.mat-mdc-outlined-button[disabled]{cursor:default;pointer-events:none}.mat-mdc-button .mat-mdc-button-touch-target,.mat-mdc-unelevated-button .mat-mdc-button-touch-target,.mat-mdc-raised-button .mat-mdc-button-touch-target,.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .mat-mdc-button>.mat-icon,.mat-mdc-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}.mat-mdc-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon,.mat-mdc-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem;margin-left:-4px;margin-right:8px}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:-4px}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon,.mat-mdc-raised-button .mdc-button__label+.mat-icon,.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:-4px}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon,.mat-mdc-unelevated-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-raised-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-outlined-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:-4px;margin-right:8px}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px) * -1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),i})(),Khe=(()=>{class i extends WV{constructor(t,n,r,s){super(t,n,r,s)}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(Yn),I(gt),I(rs,8))},i.\u0275cmp=$({type:i,selectors:[["button","mat-icon-button",""]],hostVars:7,hostBindings:function(t,n){2&t&&(pn("disabled",n.disabled||null),Ei("_mat-animation-noopable","NoopAnimations"===n._animationMode)("mat-unthemed",!n.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[q],attrs:Qhe,ngContentSelectors:Whe,decls:5,vars:3,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(t,n){1&t&&(he(),je(0,"span",0),ie(1),je(2,"span",1)(3,"span",2)(4,"span",3)),2&t&&(K(3),W("matRippleDisabled",n._isRippleDisabled())("matRippleCentered",!0)("matRippleTrigger",n._elementRef.nativeElement))},dependencies:[a0],styles:['.mdc-icon-button{font-size:24px;width:48px;height:48px;padding:12px}.mdc-icon-button .mdc-icon-button__focus-ring{max-height:48px;max-width:48px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__ripple{width:40px;height:40px;margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__focus-ring{max-height:40px;max-width:40px}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-icon-button svg,.mdc-icon-button img{width:24px;height:24px}.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size, 48px);width:var(--mdc-icon-button-state-layer-size, 48px);color:var(--mdc-icon-button-icon-color, inherit);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size, 24px);height:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity, 0.38)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color, #000)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),i})(),SI=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[xn,l0,xn]}),i})();function YV(...i){const e=EM(i),{args:t,keys:n}=iN(i),r=new Oi(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let d=0;d<o;d++){let u=!1;_s(t[d]).subscribe(hn(s,h=>{u||(u=!0,c--),a[d]=h},()=>l--,void 0,()=>{(!l||!u)&&(c||s.next(n?nN(n,a):a),s.complete())}))}});return e?r.pipe(SS(e)):r}class aw{}class TI{}class Ol{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const n=t.indexOf(":");if(n>0){const r=t.slice(0,n),s=r.toLowerCase(),o=t.slice(n+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let n=e[t];const r=t.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Ol?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Ol;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Ol?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...n),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class $he{encodeKey(e){return XV(e)}encodeValue(e){return XV(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const efe=/%(\d[a-f0-9])/gi,tfe={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function XV(i){return encodeURIComponent(i).replace(efe,(e,t)=>tfe[t]??e)}function lw(i){return`${i}`}class Nl{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new $he,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Jhe(i,e){const t=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t],r=Array.isArray(n)?n.map(lw):[lw(n)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const r=e[n];Array.isArray(r)?r.forEach(s=>{t.push({param:n,value:s,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Nl({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(lw(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let n=this.map.get(e.param)||[];const r=n.indexOf(lw(e.value));-1!==r&&n.splice(r,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class ife{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function ZV(i){return typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer}function KV(i){return typeof Blob<"u"&&i instanceof Blob}function $V(i){return typeof FormData<"u"&&i instanceof FormData}class c0{constructor(e,t,n,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function nfe(i){switch(i){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,s=r):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new Ol),this.context||(this.context=new ife),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new Nl,this.urlWithParams=t}serializeBody(){return null===this.body?null:ZV(this.body)||KV(this.body)||$V(this.body)||function rfe(i){return typeof URLSearchParams<"u"&&i instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Nl?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||$V(this.body)?null:KV(this.body)?this.body.type||null:ZV(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Nl?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,n=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let l=e.headers||this.headers,c=e.params||this.params;const d=e.context??this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((u,h)=>u.set(h,e.setHeaders[h]),l)),e.setParams&&(c=Object.keys(e.setParams).reduce((u,h)=>u.set(h,e.setParams[h]),c)),new c0(t,n,s,{params:c,headers:l,context:d,reportProgress:a,responseType:r,withCredentials:o})}}var dr=(()=>((dr=dr||{})[dr.Sent=0]="Sent",dr[dr.UploadProgress=1]="UploadProgress",dr[dr.ResponseHeader=2]="ResponseHeader",dr[dr.DownloadProgress=3]="DownloadProgress",dr[dr.Response=4]="Response",dr[dr.User=5]="User",dr))();class RI{constructor(e,t=200,n="OK"){this.headers=e.headers||new Ol,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class II extends RI{constructor(e={}){super(e),this.type=dr.ResponseHeader}clone(e={}){return new II({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class cw extends RI{constructor(e={}){super(e),this.type=dr.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new cw({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class JV extends RI{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function DI(i,e){return{body:e,headers:i.headers,context:i.context,observe:i.observe,params:i.params,reportProgress:i.reportProgress,responseType:i.responseType,withCredentials:i.withCredentials}}let dw=(()=>{class i{constructor(t){this.handler=t}request(t,n,r={}){let s;if(t instanceof c0)s=t;else{let l,c;l=r.headers instanceof Ol?r.headers:new Ol(r.headers),r.params&&(c=r.params instanceof Nl?r.params:new Nl({fromObject:r.params})),s=new c0(t,n,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=St(s).pipe(ac(l=>this.handler.handle(l)));if(t instanceof c0||"events"===r.observe)return o;const a=o.pipe(jn(l=>l instanceof cw));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(wt(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(wt(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(wt(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(wt(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,n={}){return this.request("DELETE",t,n)}get(t,n={}){return this.request("GET",t,n)}head(t,n={}){return this.request("HEAD",t,n)}jsonp(t,n){return this.request("JSONP",t,{params:(new Nl).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,n={}){return this.request("OPTIONS",t,n)}patch(t,n,r={}){return this.request("PATCH",t,DI(r,n))}post(t,n,r={}){return this.request("POST",t,DI(r,n))}put(t,n,r={}){return this.request("PUT",t,DI(r,n))}}return i.\u0275fac=function(t){return new(t||i)(xe(aw))},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})();function ez(i,e){return e(i)}function sfe(i,e){return(t,n)=>e.intercept(t,{handle:r=>i(r,n)})}const afe=new Oe("HTTP_INTERCEPTORS"),d0=new Oe("HTTP_INTERCEPTOR_FNS");function lfe(){let i=null;return(e,t)=>(null===i&&(i=(Et(afe,{optional:!0})??[]).reduceRight(sfe,ez)),i(e,t))}let tz=(()=>{class i extends aw{constructor(t,n){super(),this.backend=t,this.injector=n,this.chain=null}handle(t){if(null===this.chain){const n=Array.from(new Set(this.injector.get(d0)));this.chain=n.reduceRight((r,s)=>function ofe(i,e,t){return(n,r)=>t.runInContext(()=>e(n,s=>i(s,r)))}(r,s,this.injector),ez)}return this.chain(t,n=>this.backend.handle(n))}}return i.\u0275fac=function(t){return new(t||i)(xe(TI),xe(xa))},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})();const hfe=/^\)\]\}',?\n/;let nz=(()=>{class i{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Oi(n=>{const r=this.xhrFactory.build();if(r.open(t.method,t.urlWithParams),t.withCredentials&&(r.withCredentials=!0),t.headers.forEach((f,m)=>r.setRequestHeader(f,m.join(","))),t.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const f=t.detectContentTypeHeader();null!==f&&r.setRequestHeader("Content-Type",f)}if(t.responseType){const f=t.responseType.toLowerCase();r.responseType="json"!==f?f:"text"}const s=t.serializeBody();let o=null;const a=()=>{if(null!==o)return o;const f=r.statusText||"OK",m=new Ol(r.getAllResponseHeaders()),_=function ffe(i){return"responseURL"in i&&i.responseURL?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):null}(r)||t.url;return o=new II({headers:m,status:r.status,statusText:f,url:_}),o},l=()=>{let{headers:f,status:m,statusText:_,url:g}=a(),p=null;204!==m&&(p=typeof r.response>"u"?r.responseText:r.response),0===m&&(m=p?200:0);let v=m>=200&&m<300;if("json"===t.responseType&&"string"==typeof p){const b=p;p=p.replace(hfe,"");try{p=""!==p?JSON.parse(p):null}catch(y){p=b,v&&(v=!1,p={error:y,text:p})}}v?(n.next(new cw({body:p,headers:f,status:m,statusText:_,url:g||void 0})),n.complete()):n.error(new JV({error:p,headers:f,status:m,statusText:_,url:g||void 0}))},c=f=>{const{url:m}=a(),_=new JV({error:f,status:r.status||0,statusText:r.statusText||"Unknown Error",url:m||void 0});n.error(_)};let d=!1;const u=f=>{d||(n.next(a()),d=!0);let m={type:dr.DownloadProgress,loaded:f.loaded};f.lengthComputable&&(m.total=f.total),"text"===t.responseType&&r.responseText&&(m.partialText=r.responseText),n.next(m)},h=f=>{let m={type:dr.UploadProgress,loaded:f.loaded};f.lengthComputable&&(m.total=f.total),n.next(m)};return r.addEventListener("load",l),r.addEventListener("error",c),r.addEventListener("timeout",c),r.addEventListener("abort",c),t.reportProgress&&(r.addEventListener("progress",u),null!==s&&r.upload&&r.upload.addEventListener("progress",h)),r.send(s),n.next({type:dr.Sent}),()=>{r.removeEventListener("error",c),r.removeEventListener("abort",c),r.removeEventListener("load",l),r.removeEventListener("timeout",c),t.reportProgress&&(r.removeEventListener("progress",u),null!==s&&r.upload&&r.upload.removeEventListener("progress",h)),r.readyState!==r.DONE&&r.abort()}})}}return i.\u0275fac=function(t){return new(t||i)(xe(I3))},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})();const PI=new Oe("XSRF_ENABLED"),rz="XSRF-TOKEN",sz=new Oe("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>rz}),oz="X-XSRF-TOKEN",az=new Oe("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>oz});class lz{}let pfe=(()=>{class i{constructor(t,n,r){this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=m3(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return i.\u0275fac=function(t){return new(t||i)(xe(ti),xe(C_),xe(sz))},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})();function mfe(i,e){const t=i.url.toLowerCase();if(!Et(PI)||"GET"===i.method||"HEAD"===i.method||t.startsWith("http://")||t.startsWith("https://"))return e(i);const n=Et(lz).getToken(),r=Et(az);return null!=n&&!i.headers.has(r)&&(i=i.clone({headers:i.headers.set(r,n)})),e(i)}var er=(()=>((er=er||{})[er.Interceptors=0]="Interceptors",er[er.LegacyInterceptors=1]="LegacyInterceptors",er[er.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",er[er.NoXsrfProtection=3]="NoXsrfProtection",er[er.JsonpSupport=4]="JsonpSupport",er[er.RequestsMadeViaParent=5]="RequestsMadeViaParent",er))();function jp(i,e){return{\u0275kind:i,\u0275providers:e}}function gfe(...i){const e=[dw,nz,tz,{provide:aw,useExisting:tz},{provide:TI,useExisting:nz},{provide:d0,useValue:mfe,multi:!0},{provide:PI,useValue:!0},{provide:lz,useClass:pfe}];for(const t of i)e.push(...t.\u0275providers);return function o9(i){return{\u0275providers:i}}(e)}const cz=new Oe("LEGACY_INTERCEPTOR_FN");function bfe({cookieName:i,headerName:e}){const t=[];return void 0!==i&&t.push({provide:sz,useValue:i}),void 0!==e&&t.push({provide:az,useValue:e}),jp(er.CustomXsrfConfiguration,t)}let vfe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({providers:[gfe(jp(er.LegacyInterceptors,[{provide:cz,useFactory:lfe},{provide:d0,useExisting:cz,multi:!0}]),bfe({cookieName:rz,headerName:oz}))]}),i})();const Afe=["*"];let uw;function u0(i){return function yfe(){if(void 0===uw&&(uw=null,typeof window<"u")){const i=window;void 0!==i.trustedTypes&&(uw=i.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return uw}()?.createHTML(i)||i}function dz(i){return Error(`Unable to find icon with the name "${i}"`)}function uz(i){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${i}".`)}function hz(i){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${i}".`)}class Pu{constructor(e,t,n){this.url=e,this.svgText=t,this.options=n}}let hw=(()=>{class i{constructor(t,n,r,s){this._httpClient=t,this._sanitizer=n,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(t,n,r){return this.addSvgIconInNamespace("",t,n,r)}addSvgIconLiteral(t,n,r){return this.addSvgIconLiteralInNamespace("",t,n,r)}addSvgIconInNamespace(t,n,r,s){return this._addSvgIconConfig(t,n,new Pu(r,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,n,r,s){const o=this._sanitizer.sanitize(Bi.HTML,r);if(!o)throw hz(r);const a=u0(o);return this._addSvgIconConfig(t,n,new Pu("",a,s))}addSvgIconSet(t,n){return this.addSvgIconSetInNamespace("",t,n)}addSvgIconSetLiteral(t,n){return this.addSvgIconSetLiteralInNamespace("",t,n)}addSvgIconSetInNamespace(t,n,r){return this._addSvgIconSetConfig(t,new Pu(n,null,r))}addSvgIconSetLiteralInNamespace(t,n,r){const s=this._sanitizer.sanitize(Bi.HTML,n);if(!s)throw hz(n);const o=u0(s);return this._addSvgIconSetConfig(t,new Pu("",o,r))}registerFontClassAlias(t,n=t){return this._fontCssClassesByAlias.set(t,n),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const n=this._sanitizer.sanitize(Bi.RESOURCE_URL,t);if(!n)throw uz(t);const r=this._cachedIconsByUrl.get(n);return r?St(fw(r)):this._loadSvgIconFromConfig(new Pu(t,null)).pipe(ln(s=>this._cachedIconsByUrl.set(n,s)),wt(s=>fw(s)))}getNamedSvgIcon(t,n=""){const r=fz(n,t);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(n,t),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const o=this._iconSetConfigs.get(n);return o?this._getSvgFromIconSetConfigs(t,o):ia(dz(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?St(fw(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(wt(n=>fw(n)))}_getSvgFromIconSetConfigs(t,n){const r=this._extractIconWithNameFromAnySet(t,n);return r?St(r):YV(n.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(na(a=>{const c=`Loading icon set URL: ${this._sanitizer.sanitize(Bi.RESOURCE_URL,o.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(c)),St(null)})))).pipe(wt(()=>{const o=this._extractIconWithNameFromAnySet(t,n);if(!o)throw dz(t);return o}))}_extractIconWithNameFromAnySet(t,n){for(let r=n.length-1;r>=0;r--){const s=n[r];if(s.svgText&&s.svgText.toString().indexOf(t)>-1){const o=this._svgElementFromConfig(s),a=this._extractSvgIconFromSet(o,t,s.options);if(a)return a}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(ln(n=>t.svgText=n),wt(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?St(null):this._fetchIcon(t).pipe(ln(n=>t.svgText=n))}_extractSvgIconFromSet(t,n,r){const s=t.querySelector(`[id="${n}"]`);if(!s)return null;const o=s.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,r);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),r);const a=this._svgElementFromString(u0("<svg></svg>"));return a.appendChild(o),this._setSvgAttributes(a,r)}_svgElementFromString(t){const n=this._document.createElement("DIV");n.innerHTML=t;const r=n.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const n=this._svgElementFromString(u0("<svg></svg>")),r=t.attributes;for(let s=0;s<r.length;s++){const{name:o,value:a}=r[s];"id"!==o&&n.setAttribute(o,a)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&n.appendChild(t.childNodes[s].cloneNode(!0));return n}_setSvgAttributes(t,n){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),n&&n.viewBox&&t.setAttribute("viewBox",n.viewBox),t}_fetchIcon(t){const{url:n,options:r}=t,s=r?.withCredentials??!1;if(!this._httpClient)throw function xfe(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==n)throw Error(`Cannot fetch icon from URL "${n}".`);const o=this._sanitizer.sanitize(Bi.RESOURCE_URL,n);if(!o)throw uz(n);const a=this._inProgressUrlFetches.get(o);if(a)return a;const l=this._httpClient.get(o,{responseType:"text",withCredentials:s}).pipe(wt(c=>u0(c)),KA(()=>this._inProgressUrlFetches.delete(o)),SM());return this._inProgressUrlFetches.set(o,l),l}_addSvgIconConfig(t,n,r){return this._svgIconConfigs.set(fz(t,n),r),this}_addSvgIconSetConfig(t,n){const r=this._iconSetConfigs.get(t);return r?r.push(n):this._iconSetConfigs.set(t,[n]),this}_svgElementFromConfig(t){if(!t.svgElement){const n=this._svgElementFromString(t.svgText);this._setSvgAttributes(n,t.options),t.svgElement=n}return t.svgElement}_getIconConfigFromResolvers(t,n){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](n,t);if(s)return Cfe(s)?new Pu(s.url,null,s.options):new Pu(s,null)}}}return i.\u0275fac=function(t){return new(t||i)(xe(dw,8),xe(WA),xe(ti,8),xe(ml))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function fw(i){return i.cloneNode(!0)}function fz(i,e){return i+":"+e}function Cfe(i){return!(!i.url||!i.options)}const Mfe=sw(class{constructor(i){this._elementRef=i}}),Efe=new Oe("MAT_ICON_DEFAULT_OPTIONS"),Sfe=new Oe("mat-icon-location",{providedIn:"root",factory:function Tfe(){const i=Et(ti),e=i?i.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),pz=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],Rfe=pz.map(i=>`[${i}]`).join(", "),Ife=/^url\(['"]?#(.*?)['"]?\)$/;let mz=(()=>{class i extends Mfe{get inline(){return this._inline}set inline(t){this._inline=Qi(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const n=this._cleanupFontValue(t);n!==this._fontSet&&(this._fontSet=n,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const n=this._cleanupFontValue(t);n!==this._fontIcon&&(this._fontIcon=n,this._updateFontIconClasses())}constructor(t,n,r,s,o,a){super(t),this._iconRegistry=n,this._location=s,this._errorHandler=o,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=un.EMPTY,a&&(a.color&&(this.color=this.defaultColor=a.color),a.fontSet&&(this.fontSet=a.fontSet)),r||t.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(t){if(!t)return["",""];const n=t.split(":");switch(n.length){case 1:return["",n[0]];case 2:return n;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const n=this._location.getPathname();n!==this._previousPath&&(this._previousPath=n,this._prependPathToReferences(n))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const n=this._location.getPathname();this._previousPath=n,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(n),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let n=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();n--;){const r=t.childNodes[n];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,n=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>t.classList.remove(r)),n.forEach(r=>t.classList.add(r)),this._previousFontSetClass=n,this.fontIcon!==this._previousFontIconClass&&!n.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const n=this._elementsWithExternalReferences;n&&n.forEach((r,s)=>{r.forEach(o=>{s.setAttribute(o.name,`url('${t}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(t){const n=t.querySelectorAll(Rfe),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<n.length;s++)pz.forEach(o=>{const a=n[s],l=a.getAttribute(o),c=l?l.match(Ife):null;if(c){let d=r.get(a);d||(d=[],r.set(a,d)),d.push({name:o,value:c[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[n,r]=this._splitIconName(t);n&&(this._svgNamespace=n),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,n).pipe(bs(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${n}:${r}! ${s.message}`))})}}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(hw),Yg("aria-hidden"),I(Sfe),I(ml),I(Efe,8))},i.\u0275cmp=$({type:i,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(t,n){2&t&&(pn("data-mat-icon-type",n._usingFontIcon()?"font":"svg")("data-mat-icon-name",n._svgName||n.fontIcon)("data-mat-icon-namespace",n._svgNamespace||n.fontSet)("fontIcon",n._usingFontIcon()?n.fontIcon:null),Ei("mat-icon-inline",n.inline)("mat-icon-no-color","primary"!==n.color&&"accent"!==n.color&&"warn"!==n.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[q],ngContentSelectors:Afe,decls:1,vars:0,template:function(t,n){1&t&&(he(),ie(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),i})(),kI=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[xn,xn]}),i})();const Dfe=["*"],Ffe=new Oe("MAT_CARD_CONFIG");let gz=(()=>{class i{constructor(t){this.appearance=t?.appearance||"raised"}}return i.\u0275fac=function(t){return new(t||i)(I(Ffe,8))},i.\u0275cmp=$({type:i,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(t,n){2&t&&Ei("mat-mdc-card-outlined","outlined"===n.appearance)("mdc-card--outlined","outlined"===n.appearance)},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:Dfe,decls:1,vars:0,template:function(t,n){1&t&&(he(),ie(0))},styles:['.mdc-card{display:flex;flex-direction:column;box-sizing:border-box}.mdc-card::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none;pointer-events:none}@media screen and (forced-colors: active){.mdc-card::after{border-color:CanvasText}}.mdc-card--outlined::after{border:none}.mdc-card__content{border-radius:inherit;height:100%}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__media--square::before{margin-top:100%}.mdc-card__media--16-9::before{margin-top:56.25%}.mdc-card__media-content{position:absolute;top:0;right:0;bottom:0;left:0;box-sizing:border-box}.mdc-card__primary-action{display:flex;flex-direction:column;box-sizing:border-box;position:relative;outline:none;color:inherit;text-decoration:none;cursor:pointer;overflow:hidden}.mdc-card__primary-action:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__primary-action:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mdc-card__actions--full-bleed{padding:0}.mdc-card__action-buttons,.mdc-card__action-icons{display:flex;flex-direction:row;align-items:center;box-sizing:border-box}.mdc-card__action-icons{flex-grow:1;justify-content:flex-end}.mdc-card__action-buttons+.mdc-card__action-icons{margin-left:16px;margin-right:0}[dir=rtl] .mdc-card__action-buttons+.mdc-card__action-icons,.mdc-card__action-buttons+.mdc-card__action-icons[dir=rtl]{margin-left:0;margin-right:16px}.mdc-card__action{display:inline-flex;flex-direction:row;align-items:center;box-sizing:border-box;justify-content:center;cursor:pointer;user-select:none}.mdc-card__action:focus{outline:none}.mdc-card__action--button{margin-left:0;margin-right:8px;padding:0 8px}[dir=rtl] .mdc-card__action--button,.mdc-card__action--button[dir=rtl]{margin-left:8px;margin-right:0}.mdc-card__action--button:last-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-card__action--button:last-child,.mdc-card__action--button:last-child[dir=rtl]{margin-left:0;margin-right:0}.mdc-card__actions--full-bleed .mdc-card__action--button{justify-content:space-between;width:100%;height:auto;max-height:none;margin:0;padding:8px 16px;text-align:left}[dir=rtl] .mdc-card__actions--full-bleed .mdc-card__action--button,.mdc-card__actions--full-bleed .mdc-card__action--button[dir=rtl]{text-align:right}.mdc-card__action--icon{margin:-6px 0;padding:12px}.mat-mdc-card{position:relative;border-radius:var(--mdc-elevated-card-container-shape, var(--mdc-shape-medium, 4px));background-color:var(--mdc-elevated-card-container-color, transparent);border-width:0;border-style:solid;border-color:var(--mdc-elevated-card-container-color, transparent)}.mat-mdc-card .mdc-card::after{border-radius:var(--mdc-elevated-card-container-shape, var(--mdc-shape-medium, 4px))}.mat-mdc-card-outlined{border-width:var(--mdc-outlined-card-outline-width, 1px);border-style:solid;border-color:var(--mdc-outlined-card-outline-color, transparent)}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0}),i})(),_z=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=Ne({type:i,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"]}),i})(),bz=(()=>{class i{constructor(){this.align="start"}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=Ne({type:i,selectors:[["mat-card-actions"]],hostAttrs:[1,"mat-mdc-card-actions","mdc-card__actions"],hostVars:2,hostBindings:function(t,n){2&t&&Ei("mat-mdc-card-actions-align-end","end"===n.align)},inputs:{align:"align"},exportAs:["matCardActions"]}),i})(),vz=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[xn,Ta,xn]}),i})();class BI{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class Yfe extends BI{constructor(e,t,n,r,s){super(),this.component=e,this.viewContainerRef=t,this.injector=n,this.componentFactoryResolver=r,this.projectableNodes=s}}class LI extends BI{constructor(e,t,n,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=n,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class Xfe extends BI{constructor(e){super(),this.element=e instanceof Ft?e.nativeElement:e}}class Az{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof Yfe?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof LI?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof Xfe?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class Zfe extends Az{constructor(e,t,n,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=n,this._defaultInjector=r,this.attachDomPortal=o=>{const a=o.element,l=this._document.createComment("dom-portal");a.parentNode.insertBefore(l,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(a,l)})},this._document=s}attachComponentPortal(e){const n=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(n,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=n.create(e.injector||this._defaultInjector||zr.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,n=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return n.rootNodes.forEach(r=>this.outletElement.appendChild(r)),n.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(n);-1!==r&&t.remove(r)}),this._attachedPortal=e,n}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let Kfe=(()=>{class i extends LI{constructor(t,n){super(t,n)}}return i.\u0275fac=function(t){return new(t||i)(I(is),I(Ir))},i.\u0275dir=Ne({type:i,selectors:[["","cdkPortal",""]],exportAs:["cdkPortal"],features:[q]}),i})(),FI=(()=>{class i extends Az{constructor(t,n,r){super(),this._componentFactoryResolver=t,this._viewContainerRef=n,this._isInitialized=!1,this.attached=new Tt,this.attachDomPortal=s=>{const o=s.element,a=this._document.createComment("dom-portal");s.setAttachedHost(this),o.parentNode.insertBefore(a,o),this._getRootNode().appendChild(o),this._attachedPortal=s,super.setDisposeFn(()=>{a.parentNode&&a.parentNode.replaceChild(o,a)})},this._document=r}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(t){t.setAttachedHost(this);const n=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,s=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),o=n.createComponent(s,n.length,t.injector||n.injector,t.projectableNodes||void 0);return n!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=t,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(t){t.setAttachedHost(this);const n=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=n,this.attached.emit(n),n}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}}return i.\u0275fac=function(t){return new(t||i)(I(Jl),I(Ir),I(ti))},i.\u0275dir=Ne({type:i,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[q]}),i})(),yz=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({}),i})();const $fe=["addListener","removeListener"],Jfe=["addEventListener","removeEventListener"],epe=["on","off"];function Dc(i,e,t,n){if(Ti(t)&&(n=t,t=void 0),n)return Dc(i,e,t).pipe(SS(n));const[r,s]=function npe(i){return Ti(i.addEventListener)&&Ti(i.removeEventListener)}(i)?Jfe.map(o=>a=>i[o](e,a,t)):function tpe(i){return Ti(i.addListener)&&Ti(i.removeListener)}(i)?$fe.map(xz(i,e)):function ipe(i){return Ti(i.on)&&Ti(i.off)}(i)?epe.map(xz(i,e)):[];if(!r&&CM(i))return wr(o=>Dc(o,e,t))(_s(i));if(!r)throw new TypeError("Invalid event target");return new Oi(o=>{const a=(...l)=>o.next(1<l.length?l:l[0]);return r(a),()=>s(a)})}function xz(i,e){return t=>n=>i[t](e,n)}function wz(i=0,e,t=Jue){let n=-1;return null!=e&&(bP(e)?t=e:n=e),new Oi(r=>{let s=function rpe(i){return i instanceof Date&&!isNaN(i)}(i)?+i-t.now():i;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=n?this.schedule(void 0,n):r.complete())},s)})}class Cz{}class spe{}const jl="*";function h0(i,e){return{type:7,name:i,definitions:e,options:{}}}function Pc(i,e=null){return{type:4,styles:e,timings:i}}function Mz(i,e=null){return{type:2,steps:i,options:e}}function Ls(i){return{type:6,styles:i,offset:null}}function ku(i,e,t){return{type:0,name:i,styles:e,options:t}}function Ul(i,e,t=null){return{type:1,expr:i,animation:e,options:t}}function Ez(i){Promise.resolve().then(i)}class f0{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){Ez(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class Sz{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,r=0;const s=this.players.length;0==s?Ez(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++n==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const r=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(r)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}const p0={schedule(i){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:n}=p0;n&&(e=n.requestAnimationFrame,t=n.cancelAnimationFrame);const r=e(s=>{t=void 0,i(s)});return new un(()=>t?.(r))},requestAnimationFrame(...i){const{delegate:e}=p0;return(e?.requestAnimationFrame||requestAnimationFrame)(...i)},cancelAnimationFrame(...i){const{delegate:e}=p0;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...i)},delegate:void 0},pw=new class cpe extends vI{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;e=e||n.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=n[0])&&e.id===t&&n.shift());if(this._active=!1,r){for(;(e=n[0])&&e.id===t&&n.shift();)e.unsubscribe();throw r}}}(class lpe extends bI{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e._scheduled||(e._scheduled=p0.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,n=0){if(null!=n&&n>0||null==n&&this.delay>0)return super.recycleAsyncId(e,t,n);e.actions.some(r=>r.id===t)||(p0.cancelAnimationFrame(t),e._scheduled=void 0)}});let NI,dpe=1;const mw={};function Tz(i){return i in mw&&(delete mw[i],!0)}const upe={setImmediate(i){const e=dpe++;return mw[e]=!0,NI||(NI=Promise.resolve()),NI.then(()=>Tz(e)&&i()),e},clearImmediate(i){Tz(i)}},{setImmediate:hpe,clearImmediate:fpe}=upe,gw={setImmediate(...i){const{delegate:e}=gw;return(e?.setImmediate||hpe)(...i)},clearImmediate(i){const{delegate:e}=gw;return(e?.clearImmediate||fpe)(i)},delegate:void 0},gpe=new class mpe extends vI{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;e=e||n.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=n[0])&&e.id===t&&n.shift());if(this._active=!1,r){for(;(e=n[0])&&e.id===t&&n.shift();)e.unsubscribe();throw r}}}(class ppe extends bI{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e._scheduled||(e._scheduled=gw.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,n=0){if(null!=n&&n>0||null==n&&this.delay>0)return super.recycleAsyncId(e,t,n);e.actions.some(r=>r.id===t)||(gw.clearImmediate(t),e._scheduled=void 0)}});function jI(i,e=AI){return function _pe(i){return Mn((e,t)=>{let n=!1,r=null,s=null,o=!1;const a=()=>{if(s?.unsubscribe(),s=null,n){n=!1;const c=r;r=null,t.next(c)}o&&t.complete()},l=()=>{s=null,o&&t.complete()};e.subscribe(hn(t,c=>{n=!0,r=c,s||_s(i(c)).subscribe(s=hn(t,a,l))},()=>{o=!0,(!n||!s||s.closed)&&t.complete()}))})}(()=>wz(i,e))}const bpe=["contentWrapper"],vpe=["*"],Ape=new Oe("VIRTUAL_SCROLL_STRATEGY");let Up=(()=>{class i{constructor(t,n,r){this._ngZone=t,this._platform=n,this._scrolled=new Wt,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const n=this.scrollContainers.get(t);n&&(n.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new Oi(n=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(jI(t)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):St()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(t,n){const r=this.getAncestorScrollContainers(t);return this.scrolled(n).pipe(jn(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const n=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&n.push(s)}),n}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,n){let r=Du(n),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Dc(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return i.\u0275fac=function(t){return new(t||i)(xe(gt),xe(Yn),xe(ti,8))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Bu=(()=>{class i{constructor(t,n,r,s){this.elementRef=t,this.scrollDispatcher=n,this.ngZone=r,this.dir=s,this._destroyed=new Wt,this._elementScrolled=new Oi(o=>this.ngZone.runOutsideAngular(()=>Dc(this.elementRef.nativeElement,"scroll").pipe(yn(this._destroyed)).subscribe(o)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const n=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=r?t.end:t.start),null==t.right&&(t.right=r?t.start:t.end),null!=t.bottom&&(t.top=n.scrollHeight-n.clientHeight-t.bottom),r&&0!=n0()?(null!=t.left&&(t.right=n.scrollWidth-n.clientWidth-t.left),2==n0()?t.left=t.right:1==n0()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=n.scrollWidth-n.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const n=this.elementRef.nativeElement;gV()?n.scrollTo(t):(null!=t.top&&(n.scrollTop=t.top),null!=t.left&&(n.scrollLeft=t.left))}measureScrollOffset(t){const n="left",r="right",s=this.elementRef.nativeElement;if("top"==t)return s.scrollTop;if("bottom"==t)return s.scrollHeight-s.clientHeight-s.scrollTop;const o=this.dir&&"rtl"==this.dir.value;return"start"==t?t=o?r:n:"end"==t&&(t=o?n:r),o&&2==n0()?t==n?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:o&&1==n0()?t==n?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:t==n?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(Up),I(gt),I(Wa,8))},i.\u0275dir=Ne({type:i,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0}),i})(),Lu=(()=>{class i{constructor(t,n,r){this._platform=t,this._change=new Wt,this._changeListener=s=>{this._change.next(s)},this._document=r,n.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:n,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+n,height:r,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,n=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||n.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||n.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(jI(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return i.\u0275fac=function(t){return new(t||i)(xe(Yn),xe(gt),xe(ti,8))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Rz=new Oe("VIRTUAL_SCROLLABLE");let wpe=(()=>{class i extends Bu{constructor(t,n,r,s){super(t,n,r,s)}measureViewportSize(t){const n=this.elementRef.nativeElement;return"horizontal"===t?n.clientWidth:n.clientHeight}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(Up),I(gt),I(Wa,8))},i.\u0275dir=Ne({type:i,features:[q]}),i})();const Mpe=typeof requestAnimationFrame<"u"?pw:gpe;let Epe=(()=>{class i extends wpe{get orientation(){return this._orientation}set orientation(t){this._orientation!==t&&(this._orientation=t,this._calculateSpacerSize())}get appendOnly(){return this._appendOnly}set appendOnly(t){this._appendOnly=Qi(t)}constructor(t,n,r,s,o,a,l,c){super(t,a,r,o),this.elementRef=t,this._changeDetectorRef=n,this._scrollStrategy=s,this.scrollable=c,this._platform=Et(Yn),this._detachedSubject=new Wt,this._renderedRangeSubject=new Wt,this._orientation="vertical",this._appendOnly=!1,this.scrolledIndexChange=new Oi(d=>this._scrollStrategy.scrolledIndexChange.subscribe(u=>Promise.resolve().then(()=>this.ngZone.run(()=>d.next(u))))),this.renderedRangeStream=this._renderedRangeSubject,this._totalContentSize=0,this._totalContentWidth="",this._totalContentHeight="",this._renderedRange={start:0,end:0},this._dataLength=0,this._viewportSize=0,this._renderedContentOffset=0,this._renderedContentOffsetNeedsRewrite=!1,this._isChangeDetectionPending=!1,this._runAfterChangeDetection=[],this._viewportChanges=un.EMPTY,this._viewportChanges=l.change().subscribe(()=>{this.checkViewportSize()}),this.scrollable||(this.elementRef.nativeElement.classList.add("cdk-virtual-scrollable"),this.scrollable=this)}ngOnInit(){this._platform.isBrowser&&(this.scrollable===this&&super.ngOnInit(),this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._measureViewportSize(),this._scrollStrategy.attach(this),this.scrollable.elementScrolled().pipe(sc(null),jI(0,Mpe)).subscribe(()=>this._scrollStrategy.onContentScrolled()),this._markChangeDetectionNeeded()})))}ngOnDestroy(){this.detach(),this._scrollStrategy.detach(),this._renderedRangeSubject.complete(),this._detachedSubject.complete(),this._viewportChanges.unsubscribe(),super.ngOnDestroy()}attach(t){this.ngZone.runOutsideAngular(()=>{this._forOf=t,this._forOf.dataStream.pipe(yn(this._detachedSubject)).subscribe(n=>{const r=n.length;r!==this._dataLength&&(this._dataLength=r,this._scrollStrategy.onDataLengthChanged()),this._doChangeDetection()})})}detach(){this._forOf=null,this._detachedSubject.next()}getDataLength(){return this._dataLength}getViewportSize(){return this._viewportSize}getRenderedRange(){return this._renderedRange}measureBoundingClientRectWithScrollOffset(t){return this.getElementRef().nativeElement.getBoundingClientRect()[t]}setTotalContentSize(t){this._totalContentSize!==t&&(this._totalContentSize=t,this._calculateSpacerSize(),this._markChangeDetectionNeeded())}setRenderedRange(t){(function Cpe(i,e){return i.start==e.start&&i.end==e.end})(this._renderedRange,t)||(this.appendOnly&&(t={start:0,end:Math.max(this._renderedRange.end,t.end)}),this._renderedRangeSubject.next(this._renderedRange=t),this._markChangeDetectionNeeded(()=>this._scrollStrategy.onContentRendered()))}getOffsetToRenderedContentStart(){return this._renderedContentOffsetNeedsRewrite?null:this._renderedContentOffset}setRenderedContentOffset(t,n="to-start"){t=this.appendOnly&&"to-start"===n?0:t;const s="horizontal"==this.orientation,o=s?"X":"Y";let l=`translate${o}(${Number((s&&this.dir&&"rtl"==this.dir.value?-1:1)*t)}px)`;this._renderedContentOffset=t,"to-end"===n&&(l+=` translate${o}(-100%)`,this._renderedContentOffsetNeedsRewrite=!0),this._renderedContentTransform!=l&&(this._renderedContentTransform=l,this._markChangeDetectionNeeded(()=>{this._renderedContentOffsetNeedsRewrite?(this._renderedContentOffset-=this.measureRenderedContentSize(),this._renderedContentOffsetNeedsRewrite=!1,this.setRenderedContentOffset(this._renderedContentOffset)):this._scrollStrategy.onRenderedOffsetChanged()}))}scrollToOffset(t,n="auto"){const r={behavior:n};"horizontal"===this.orientation?r.start=t:r.top=t,this.scrollable.scrollTo(r)}scrollToIndex(t,n="auto"){this._scrollStrategy.scrollToIndex(t,n)}measureScrollOffset(t){let n;return n=this.scrollable==this?r=>super.measureScrollOffset(r):r=>this.scrollable.measureScrollOffset(r),Math.max(0,n(t??("horizontal"===this.orientation?"start":"top"))-this.measureViewportOffset())}measureViewportOffset(t){let n;const r="left",s="right",o="rtl"==this.dir?.value;n="start"==t?o?s:r:"end"==t?o?r:s:t||("horizontal"===this.orientation?"left":"top");const a=this.scrollable.measureBoundingClientRectWithScrollOffset(n);return this.elementRef.nativeElement.getBoundingClientRect()[n]-a}measureRenderedContentSize(){const t=this._contentWrapper.nativeElement;return"horizontal"===this.orientation?t.offsetWidth:t.offsetHeight}measureRangeSize(t){return this._forOf?this._forOf.measureRangeSize(t,this.orientation):0}checkViewportSize(){this._measureViewportSize(),this._scrollStrategy.onDataLengthChanged()}_measureViewportSize(){this._viewportSize=this.scrollable.measureViewportSize(this.orientation)}_markChangeDetectionNeeded(t){t&&this._runAfterChangeDetection.push(t),this._isChangeDetectionPending||(this._isChangeDetectionPending=!0,this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._doChangeDetection()})))}_doChangeDetection(){this._isChangeDetectionPending=!1,this._contentWrapper.nativeElement.style.transform=this._renderedContentTransform,this.ngZone.run(()=>this._changeDetectorRef.markForCheck());const t=this._runAfterChangeDetection;this._runAfterChangeDetection=[];for(const n of t)n()}_calculateSpacerSize(){this._totalContentHeight="horizontal"===this.orientation?"":`${this._totalContentSize}px`,this._totalContentWidth="horizontal"===this.orientation?`${this._totalContentSize}px`:""}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(sr),I(gt),I(Ape,8),I(Wa,8),I(Up),I(Lu),I(Rz,8))},i.\u0275cmp=$({type:i,selectors:[["cdk-virtual-scroll-viewport"]],viewQuery:function(t,n){if(1&t&&ji(bpe,7),2&t){let r;Ot(r=Nt())&&(n._contentWrapper=r.first)}},hostAttrs:[1,"cdk-virtual-scroll-viewport"],hostVars:4,hostBindings:function(t,n){2&t&&Ei("cdk-virtual-scroll-orientation-horizontal","horizontal"===n.orientation)("cdk-virtual-scroll-orientation-vertical","horizontal"!==n.orientation)},inputs:{orientation:"orientation",appendOnly:"appendOnly"},outputs:{scrolledIndexChange:"scrolledIndexChange"},standalone:!0,features:[ne([{provide:Bu,useFactory:(e,t)=>e||t,deps:[[new hl,new zv(Rz)],i]}]),q,TE],ngContentSelectors:vpe,decls:4,vars:4,consts:[[1,"cdk-virtual-scroll-content-wrapper"],["contentWrapper",""],[1,"cdk-virtual-scroll-spacer"]],template:function(t,n){1&t&&(he(),ge(0,"div",0,1),ie(2),Re(),je(3,"div",2)),2&t&&(K(3),Pd("width",n._totalContentWidth)("height",n._totalContentHeight))},styles:["cdk-virtual-scroll-viewport{display:block;position:relative;transform:translateZ(0)}.cdk-virtual-scrollable{overflow:auto;will-change:scroll-position;contain:strict;-webkit-overflow-scrolling:touch}.cdk-virtual-scroll-content-wrapper{position:absolute;top:0;left:0;contain:content}[dir=rtl] .cdk-virtual-scroll-content-wrapper{right:0;left:auto}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper{min-height:100%}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-left:0;padding-right:0;margin-left:0;margin-right:0;border-left-width:0;border-right-width:0;outline:none}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:100%}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;border-top-width:0;border-bottom-width:0;outline:none}.cdk-virtual-scroll-spacer{height:1px;transform-origin:0 0;flex:0 0 auto}[dir=rtl] .cdk-virtual-scroll-spacer{transform-origin:100% 0}"],encapsulation:2,changeDetection:0}),i})(),m0=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({}),i})(),Iz=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[s0,m0,Epe,s0,m0]}),i})();function Spe(i,e){}const Tpe=function(i){return{animationDuration:i}},Rpe=function(i,e){return{value:i,params:e}};function Ipe(i,e){1&i&&ie(0)}const Dz=["*"],Dpe=["tabListContainer"],Ppe=["tabList"],kpe=["tabListInner"],Bpe=["nextPaginator"],Lpe=["previousPaginator"],Fpe=["tabBodyWrapper"],Ope=["tabHeader"];function Npe(i,e){}function jpe(i,e){1&i&&Bt(0,Npe,0,0,"ng-template",14),2&i&&W("cdkPortalOutlet",di().$implicit.templateLabel)}function Upe(i,e){1&i&&bi(0),2&i&&pA(di().$implicit.textLabel)}function Vpe(i,e){if(1&i){const t=ys();ge(0,"div",6,7),ut("click",function(){const r=nr(t),s=r.$implicit,o=r.index,a=di(),l=qt(1);return rr(a._handleClick(s,l,o))})("cdkFocusChange",function(r){const o=nr(t).index;return rr(di()._tabFocusChanged(r,o))}),je(2,"span",8)(3,"div",9),ge(4,"span",10)(5,"span",11),Bt(6,jpe,1,1,"ng-template",12),Bt(7,Upe,1,1,"ng-template",null,13,Fd),Re()()()}if(2&i){const t=e.$implicit,n=e.index,r=qt(1),s=qt(8),o=di();Ei("mdc-tab--active",o.selectedIndex===n),W("id",o._getTabLabelId(n))("ngClass",t.labelClass)("disabled",t.disabled)("fitInkBarToContent",o.fitInkBarToContent),pn("tabIndex",o._getTabIndex(n))("aria-posinset",n+1)("aria-setsize",o._tabs.length)("aria-controls",o._getTabContentId(n))("aria-selected",o.selectedIndex===n)("aria-label",t.ariaLabel||null)("aria-labelledby",!t.ariaLabel&&t.ariaLabelledby?t.ariaLabelledby:null),K(3),W("matRippleTrigger",r)("matRippleDisabled",t.disabled||o.disableRipple),K(3),W("ngIf",t.templateLabel)("ngIfElse",s)}}function zpe(i,e){if(1&i){const t=ys();ge(0,"mat-tab-body",15),ut("_onCentered",function(){return nr(t),rr(di()._removeTabBodyWrapperHeight())})("_onCentering",function(r){return nr(t),rr(di()._setTabBodyWrapperHeight(r))}),Re()}if(2&i){const t=e.$implicit,n=e.index,r=di();Ei("mat-mdc-tab-body-active",r.selectedIndex===n),W("id",r._getTabContentId(n))("ngClass",t.bodyClass)("content",t.content)("position",t.position)("origin",t.origin)("animationDuration",r.animationDuration)("preserveContent",r.preserveContent),pn("tabindex",null!=r.contentTabIndex&&r.selectedIndex===n?r.contentTabIndex:null)("aria-labelledby",r._getTabLabelId(n))}}const Gpe={translateTab:h0("translateTab",[ku("center, void, left-origin-center, right-origin-center",Ls({transform:"none"})),ku("left",Ls({transform:"translate3d(-100%, 0, 0)",minHeight:"1px",visibility:"hidden"})),ku("right",Ls({transform:"translate3d(100%, 0, 0)",minHeight:"1px",visibility:"hidden"})),Ul("* => left, * => right, left => center, right => center",Pc("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")),Ul("void => left-origin-center",[Ls({transform:"translate3d(-100%, 0, 0)",visibility:"hidden"}),Pc("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")]),Ul("void => right-origin-center",[Ls({transform:"translate3d(100%, 0, 0)",visibility:"hidden"}),Pc("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")])])};let Hpe=(()=>{class i extends FI{constructor(t,n,r,s){super(t,n,s),this._host=r,this._centeringSub=un.EMPTY,this._leavingSub=un.EMPTY}ngOnInit(){super.ngOnInit(),this._centeringSub=this._host._beforeCentering.pipe(sc(this._host._isCenterPosition(this._host._position))).subscribe(t=>{t&&!this.hasAttached()&&this.attach(this._host._content)}),this._leavingSub=this._host._afterLeavingCenter.subscribe(()=>{this._host.preserveContent||this.detach()})}ngOnDestroy(){super.ngOnDestroy(),this._centeringSub.unsubscribe(),this._leavingSub.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(I(Jl),I(Ir),I(ae(()=>Pz)),I(ti))},i.\u0275dir=Ne({type:i,selectors:[["","matTabBodyHost",""]],features:[q]}),i})(),Qpe=(()=>{class i{set position(t){this._positionIndex=t,this._computePositionAnimationState()}constructor(t,n,r){this._elementRef=t,this._dir=n,this._dirChangeSubscription=un.EMPTY,this._translateTabComplete=new Wt,this._onCentering=new Tt,this._beforeCentering=new Tt,this._afterLeavingCenter=new Tt,this._onCentered=new Tt(!0),this.animationDuration="500ms",this.preserveContent=!1,n&&(this._dirChangeSubscription=n.change.subscribe(s=>{this._computePositionAnimationState(s),r.markForCheck()})),this._translateTabComplete.pipe(xI((s,o)=>s.fromState===o.fromState&&s.toState===o.toState)).subscribe(s=>{this._isCenterPosition(s.toState)&&this._isCenterPosition(this._position)&&this._onCentered.emit(),this._isCenterPosition(s.fromState)&&!this._isCenterPosition(this._position)&&this._afterLeavingCenter.emit()})}ngOnInit(){"center"==this._position&&null!=this.origin&&(this._position=this._computePositionFromOrigin(this.origin))}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._translateTabComplete.complete()}_onTranslateTabStarted(t){const n=this._isCenterPosition(t.toState);this._beforeCentering.emit(n),n&&this._onCentering.emit(this._elementRef.nativeElement.clientHeight)}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_isCenterPosition(t){return"center"==t||"left-origin-center"==t||"right-origin-center"==t}_computePositionAnimationState(t=this._getLayoutDirection()){this._position=this._positionIndex<0?"ltr"==t?"left":"right":this._positionIndex>0?"ltr"==t?"right":"left":"center"}_computePositionFromOrigin(t){const n=this._getLayoutDirection();return"ltr"==n&&t<=0||"rtl"==n&&t>0?"left-origin-center":"right-origin-center"}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(Wa,8),I(sr))},i.\u0275dir=Ne({type:i,inputs:{_content:["content","_content"],origin:"origin",animationDuration:"animationDuration",preserveContent:"preserveContent",position:"position"},outputs:{_onCentering:"_onCentering",_beforeCentering:"_beforeCentering",_afterLeavingCenter:"_afterLeavingCenter",_onCentered:"_onCentered"}}),i})(),Pz=(()=>{class i extends Qpe{constructor(t,n,r){super(t,n,r)}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(Wa,8),I(sr))},i.\u0275cmp=$({type:i,selectors:[["mat-tab-body"]],viewQuery:function(t,n){if(1&t&&ji(FI,5),2&t){let r;Ot(r=Nt())&&(n._portalHost=r.first)}},hostAttrs:[1,"mat-mdc-tab-body"],features:[q],decls:3,vars:6,consts:[["cdkScrollable","",1,"mat-mdc-tab-body-content"],["content",""],["matTabBodyHost",""]],template:function(t,n){1&t&&(ge(0,"div",0,1),ut("@translateTab.start",function(s){return n._onTranslateTabStarted(s)})("@translateTab.done",function(s){return n._translateTabComplete.next(s)}),Bt(2,Spe,0,0,"ng-template",2),Re()),2&t&&W("@translateTab",$o(3,Rpe,n._position,Ht(1,Tpe,n.animationDuration)))},dependencies:[Hpe],styles:['.mat-mdc-tab-body{top:0;left:0;right:0;bottom:0;position:absolute;display:block;overflow:hidden;outline:0;flex-basis:100%}.mat-mdc-tab-body.mat-mdc-tab-body-active{position:relative;overflow-x:hidden;overflow-y:auto;z-index:1;flex-grow:1}.mat-mdc-tab-group.mat-mdc-tab-group-dynamic-height .mat-mdc-tab-body.mat-mdc-tab-body-active{overflow-y:hidden}.mat-mdc-tab-body-content{height:100%;overflow:auto}.mat-mdc-tab-group-dynamic-height .mat-mdc-tab-body-content{overflow:hidden}.mat-mdc-tab-body-content[style*="visibility: hidden"]{display:none}'],encapsulation:2,data:{animation:[Gpe.translateTab]}}),i})();const Wpe=new Oe("MatTabContent");let qpe=(()=>{class i{constructor(t){this.template=t}}return i.\u0275fac=function(t){return new(t||i)(I(is))},i.\u0275dir=Ne({type:i,selectors:[["","matTabContent",""]],features:[ne([{provide:Wpe,useExisting:i}])]}),i})();const Ype=new Oe("MatTabLabel"),kz=new Oe("MAT_TAB");let Xpe=(()=>{class i extends Kfe{constructor(t,n,r){super(t,n),this._closestTab=r}}return i.\u0275fac=function(t){return new(t||i)(I(is),I(Ir),I(kz,8))},i.\u0275dir=Ne({type:i,selectors:[["","mat-tab-label",""],["","matTabLabel",""]],features:[ne([{provide:Ype,useExisting:i}]),q]}),i})();const UI="mdc-tab-indicator--active",Bz="mdc-tab-indicator--no-transition";class Zpe{constructor(e){this._items=e}hide(){this._items.forEach(e=>e.deactivateInkBar())}alignToElement(e){const t=this._items.find(r=>r.elementRef.nativeElement===e),n=this._currentItem;if(n?.deactivateInkBar(),t){const r=n?.elementRef.nativeElement.getBoundingClientRect?.();t.activateInkBar(r),this._currentItem=t}}}function Kpe(i){return class extends i{constructor(...e){super(...e),this._fitToContent=!1}get fitInkBarToContent(){return this._fitToContent}set fitInkBarToContent(e){const t=Qi(e);this._fitToContent!==t&&(this._fitToContent=t,this._inkBarElement&&this._appendInkBarElement())}activateInkBar(e){const t=this.elementRef.nativeElement;if(!e||!t.getBoundingClientRect||!this._inkBarContentElement)return void t.classList.add(UI);const n=t.getBoundingClientRect(),r=e.width/n.width,s=e.left-n.left;t.classList.add(Bz),this._inkBarContentElement.style.setProperty("transform",`translateX(${s}px) scaleX(${r})`),t.getBoundingClientRect(),t.classList.remove(Bz),t.classList.add(UI),this._inkBarContentElement.style.setProperty("transform","")}deactivateInkBar(){this.elementRef.nativeElement.classList.remove(UI)}ngOnInit(){this._createInkBarElement()}ngOnDestroy(){this._inkBarElement?.remove(),this._inkBarElement=this._inkBarContentElement=null}_createInkBarElement(){const e=this.elementRef.nativeElement.ownerDocument||document;this._inkBarElement=e.createElement("span"),this._inkBarContentElement=e.createElement("span"),this._inkBarElement.className="mdc-tab-indicator",this._inkBarContentElement.className="mdc-tab-indicator__content mdc-tab-indicator__content--underline",this._inkBarElement.appendChild(this._inkBarContentElement),this._appendInkBarElement()}_appendInkBarElement(){(this._fitToContent?this.elementRef.nativeElement.querySelector(".mdc-tab__content"):this.elementRef.nativeElement).appendChild(this._inkBarElement)}}}const Jpe=EI(class{}),eme=Kpe((()=>{class i extends Jpe{constructor(t){super(),this.elementRef=t}focus(){this.elementRef.nativeElement.focus()}getOffsetLeft(){return this.elementRef.nativeElement.offsetLeft}getOffsetWidth(){return this.elementRef.nativeElement.offsetWidth}}return i.\u0275fac=function(t){return new(t||i)(I(Ft))},i.\u0275dir=Ne({type:i,features:[q]}),i})());let Lz=(()=>{class i extends eme{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=le(i)))(n||i)}}(),i.\u0275dir=Ne({type:i,selectors:[["","matTabLabelWrapper",""]],hostVars:3,hostBindings:function(t,n){2&t&&(pn("aria-disabled",!!n.disabled),Ei("mat-mdc-tab-disabled",n.disabled))},inputs:{disabled:"disabled",fitInkBarToContent:"fitInkBarToContent"},features:[q]}),i})();const tme=EI(class{}),Fz=new Oe("MAT_TAB_GROUP");let ime=(()=>{class i extends tme{get content(){return this._contentPortal}constructor(t,n){super(),this._viewContainerRef=t,this._closestTabGroup=n,this.textLabel="",this._contentPortal=null,this._stateChanges=new Wt,this.position=null,this.origin=null,this.isActive=!1}ngOnChanges(t){(t.hasOwnProperty("textLabel")||t.hasOwnProperty("disabled"))&&this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}ngOnInit(){this._contentPortal=new LI(this._explicitContent||this._implicitContent,this._viewContainerRef)}_setTemplateLabelInput(t){t&&t._closestTab===this&&(this._templateLabel=t)}}return i.\u0275fac=function(t){return new(t||i)(I(Ir),I(Fz,8))},i.\u0275dir=Ne({type:i,viewQuery:function(t,n){if(1&t&&ji(is,7),2&t){let r;Ot(r=Nt())&&(n._implicitContent=r.first)}},inputs:{textLabel:["label","textLabel"],ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],labelClass:"labelClass",bodyClass:"bodyClass"},features:[q,Cr]}),i})(),Oz=(()=>{class i extends ime{get templateLabel(){return this._templateLabel}set templateLabel(t){this._setTemplateLabelInput(t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=le(i)))(n||i)}}(),i.\u0275cmp=$({type:i,selectors:[["mat-tab"]],contentQueries:function(t,n,r){if(1&t&&(Nn(r,qpe,7,is),Nn(r,Xpe,5)),2&t){let s;Ot(s=Nt())&&(n._explicitContent=s.first),Ot(s=Nt())&&(n.templateLabel=s.first)}},inputs:{disabled:"disabled"},exportAs:["matTab"],features:[ne([{provide:kz,useExisting:i}]),q],ngContentSelectors:Dz,decls:1,vars:0,template:function(t,n){1&t&&(he(),Bt(0,Ipe,1,0,"ng-template"))},encapsulation:2}),i})();const Nz=t0({passive:!0});let sme=(()=>{class i{get disablePagination(){return this._disablePagination}set disablePagination(t){this._disablePagination=Qi(t)}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){t=ms(t),this._selectedIndex!=t&&(this._selectedIndexChanged=!0,this._selectedIndex=t,this._keyManager&&this._keyManager.updateActiveItem(t))}constructor(t,n,r,s,o,a,l){this._elementRef=t,this._changeDetectorRef=n,this._viewportRuler=r,this._dir=s,this._ngZone=o,this._platform=a,this._animationMode=l,this._scrollDistance=0,this._selectedIndexChanged=!1,this._destroyed=new Wt,this._showPaginationControls=!1,this._disableScrollAfter=!0,this._disableScrollBefore=!0,this._stopScrolling=new Wt,this._disablePagination=!1,this._selectedIndex=0,this.selectFocusedIndex=new Tt,this.indexFocused=new Tt,o.runOutsideAngular(()=>{Dc(t.nativeElement,"mouseleave").pipe(yn(this._destroyed)).subscribe(()=>{this._stopInterval()})})}ngAfterViewInit(){Dc(this._previousPaginator.nativeElement,"touchstart",Nz).pipe(yn(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("before")}),Dc(this._nextPaginator.nativeElement,"touchstart",Nz).pipe(yn(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("after")})}ngAfterContentInit(){const t=this._dir?this._dir.change:St("ltr"),n=this._viewportRuler.change(150),r=()=>{this.updatePagination(),this._alignInkBarToSelectedTab()};this._keyManager=new EV(this._items).withHorizontalOrientation(this._getLayoutDirection()).withHomeAndEnd().withWrap().skipPredicate(()=>!1),this._keyManager.updateActiveItem(this._selectedIndex),this._ngZone.onStable.pipe(bs(1)).subscribe(r),bd(t,n,this._items.changes,this._itemsResized()).pipe(yn(this._destroyed)).subscribe(()=>{this._ngZone.run(()=>{Promise.resolve().then(()=>{this._scrollDistance=Math.max(0,Math.min(this._getMaxScrollDistance(),this._scrollDistance)),r()})}),this._keyManager.withHorizontalOrientation(this._getLayoutDirection())}),this._keyManager.change.subscribe(s=>{this.indexFocused.emit(s),this._setTabFocus(s)})}_itemsResized(){return"function"!=typeof ResizeObserver?Or:this._items.changes.pipe(sc(this._items),Ys(t=>new Oi(n=>this._ngZone.runOutsideAngular(()=>{const r=new ResizeObserver(s=>n.next(s));return t.forEach(s=>r.observe(s.elementRef.nativeElement)),()=>{r.disconnect()}}))),yI(1),jn(t=>t.some(n=>n.contentRect.width>0&&n.contentRect.height>0)))}ngAfterContentChecked(){this._tabLabelCount!=this._items.length&&(this.updatePagination(),this._tabLabelCount=this._items.length,this._changeDetectorRef.markForCheck()),this._selectedIndexChanged&&(this._scrollToLabel(this._selectedIndex),this._checkScrollingControls(),this._alignInkBarToSelectedTab(),this._selectedIndexChanged=!1,this._changeDetectorRef.markForCheck()),this._scrollDistanceChanged&&(this._updateTabScrollPosition(),this._scrollDistanceChanged=!1,this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._keyManager?.destroy(),this._destroyed.next(),this._destroyed.complete(),this._stopScrolling.complete()}_handleKeydown(t){if(!Jx(t))switch(t.keyCode){case 13:case 32:if(this.focusIndex!==this.selectedIndex){const n=this._items.get(this.focusIndex);n&&!n.disabled&&(this.selectFocusedIndex.emit(this.focusIndex),this._itemSelected(t))}break;default:this._keyManager.onKeydown(t)}}_onContentChanges(){const t=this._elementRef.nativeElement.textContent;t!==this._currentTextContent&&(this._currentTextContent=t||"",this._ngZone.run(()=>{this.updatePagination(),this._alignInkBarToSelectedTab(),this._changeDetectorRef.markForCheck()}))}updatePagination(){this._checkPaginationEnabled(),this._checkScrollingControls(),this._updateTabScrollPosition()}get focusIndex(){return this._keyManager?this._keyManager.activeItemIndex:0}set focusIndex(t){!this._isValidIndex(t)||this.focusIndex===t||!this._keyManager||this._keyManager.setActiveItem(t)}_isValidIndex(t){return!this._items||!!this._items.toArray()[t]}_setTabFocus(t){if(this._showPaginationControls&&this._scrollToLabel(t),this._items&&this._items.length){this._items.toArray()[t].focus();const n=this._tabListContainer.nativeElement;n.scrollLeft="ltr"==this._getLayoutDirection()?0:n.scrollWidth-n.offsetWidth}}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_updateTabScrollPosition(){if(this.disablePagination)return;const t=this.scrollDistance,n="ltr"===this._getLayoutDirection()?-t:t;this._tabList.nativeElement.style.transform=`translateX(${Math.round(n)}px)`,(this._platform.TRIDENT||this._platform.EDGE)&&(this._tabListContainer.nativeElement.scrollLeft=0)}get scrollDistance(){return this._scrollDistance}set scrollDistance(t){this._scrollTo(t)}_scrollHeader(t){return this._scrollTo(this._scrollDistance+("before"==t?-1:1)*this._tabListContainer.nativeElement.offsetWidth/3)}_handlePaginatorClick(t){this._stopInterval(),this._scrollHeader(t)}_scrollToLabel(t){if(this.disablePagination)return;const n=this._items?this._items.toArray()[t]:null;if(!n)return;const r=this._tabListContainer.nativeElement.offsetWidth,{offsetLeft:s,offsetWidth:o}=n.elementRef.nativeElement;let a,l;"ltr"==this._getLayoutDirection()?(a=s,l=a+o):(l=this._tabListInner.nativeElement.offsetWidth-s,a=l-o);const c=this.scrollDistance,d=this.scrollDistance+r;a<c?this.scrollDistance-=c-a+60:l>d&&(this.scrollDistance+=l-d+60)}_checkPaginationEnabled(){if(this.disablePagination)this._showPaginationControls=!1;else{const t=this._tabListInner.nativeElement.scrollWidth>this._elementRef.nativeElement.offsetWidth;t||(this.scrollDistance=0),t!==this._showPaginationControls&&this._changeDetectorRef.markForCheck(),this._showPaginationControls=t}}_checkScrollingControls(){this.disablePagination?this._disableScrollAfter=this._disableScrollBefore=!0:(this._disableScrollBefore=0==this.scrollDistance,this._disableScrollAfter=this.scrollDistance==this._getMaxScrollDistance(),this._changeDetectorRef.markForCheck())}_getMaxScrollDistance(){return this._tabListInner.nativeElement.scrollWidth-this._tabListContainer.nativeElement.offsetWidth||0}_alignInkBarToSelectedTab(){const t=this._items&&this._items.length?this._items.toArray()[this.selectedIndex]:null,n=t?t.elementRef.nativeElement:null;n?this._inkBar.alignToElement(n):this._inkBar.hide()}_stopInterval(){this._stopScrolling.next()}_handlePaginatorPress(t,n){n&&null!=n.button&&0!==n.button||(this._stopInterval(),wz(650,100).pipe(yn(bd(this._stopScrolling,this._destroyed))).subscribe(()=>{const{maxScrollDistance:r,distance:s}=this._scrollHeader(t);(0===s||s>=r)&&this._stopInterval()}))}_scrollTo(t){if(this.disablePagination)return{maxScrollDistance:0,distance:0};const n=this._getMaxScrollDistance();return this._scrollDistance=Math.max(0,Math.min(n,t)),this._scrollDistanceChanged=!0,this._checkScrollingControls(),{maxScrollDistance:n,distance:this._scrollDistance}}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(sr),I(Lu),I(Wa,8),I(gt),I(Yn),I(rs,8))},i.\u0275dir=Ne({type:i,inputs:{disablePagination:"disablePagination"}}),i})(),ome=(()=>{class i extends sme{get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=Qi(t)}constructor(t,n,r,s,o,a,l){super(t,n,r,s,o,a,l),this._disableRipple=!1}_itemSelected(t){t.preventDefault()}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(sr),I(Lu),I(Wa,8),I(gt),I(Yn),I(rs,8))},i.\u0275dir=Ne({type:i,inputs:{disableRipple:"disableRipple"},features:[q]}),i})(),ame=(()=>{class i extends ome{constructor(t,n,r,s,o,a,l){super(t,n,r,s,o,a,l)}ngAfterContentInit(){this._inkBar=new Zpe(this._items),super.ngAfterContentInit()}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(sr),I(Lu),I(Wa,8),I(gt),I(Yn),I(rs,8))},i.\u0275cmp=$({type:i,selectors:[["mat-tab-header"]],contentQueries:function(t,n,r){if(1&t&&Nn(r,Lz,4),2&t){let s;Ot(s=Nt())&&(n._items=s)}},viewQuery:function(t,n){if(1&t&&(ji(Dpe,7),ji(Ppe,7),ji(kpe,7),ji(Bpe,5),ji(Lpe,5)),2&t){let r;Ot(r=Nt())&&(n._tabListContainer=r.first),Ot(r=Nt())&&(n._tabList=r.first),Ot(r=Nt())&&(n._tabListInner=r.first),Ot(r=Nt())&&(n._nextPaginator=r.first),Ot(r=Nt())&&(n._previousPaginator=r.first)}},hostAttrs:[1,"mat-mdc-tab-header"],hostVars:4,hostBindings:function(t,n){2&t&&Ei("mat-mdc-tab-header-pagination-controls-enabled",n._showPaginationControls)("mat-mdc-tab-header-rtl","rtl"==n._getLayoutDirection())},inputs:{selectedIndex:"selectedIndex"},outputs:{selectFocusedIndex:"selectFocusedIndex",indexFocused:"indexFocused"},features:[q],ngContentSelectors:Dz,decls:13,vars:10,consts:[["aria-hidden","true","type","button","mat-ripple","","tabindex","-1",1,"mat-mdc-tab-header-pagination","mat-mdc-tab-header-pagination-before",3,"matRippleDisabled","disabled","click","mousedown","touchend"],["previousPaginator",""],[1,"mat-mdc-tab-header-pagination-chevron"],[1,"mat-mdc-tab-label-container",3,"keydown"],["tabListContainer",""],["role","tablist",1,"mat-mdc-tab-list",3,"cdkObserveContent"],["tabList",""],[1,"mat-mdc-tab-labels"],["tabListInner",""],["aria-hidden","true","type","button","mat-ripple","","tabindex","-1",1,"mat-mdc-tab-header-pagination","mat-mdc-tab-header-pagination-after",3,"matRippleDisabled","disabled","mousedown","click","touchend"],["nextPaginator",""]],template:function(t,n){1&t&&(he(),ge(0,"button",0,1),ut("click",function(){return n._handlePaginatorClick("before")})("mousedown",function(s){return n._handlePaginatorPress("before",s)})("touchend",function(){return n._stopInterval()}),je(2,"div",2),Re(),ge(3,"div",3,4),ut("keydown",function(s){return n._handleKeydown(s)}),ge(5,"div",5,6),ut("cdkObserveContent",function(){return n._onContentChanges()}),ge(7,"div",7,8),ie(9),Re()()(),ge(10,"button",9,10),ut("mousedown",function(s){return n._handlePaginatorPress("after",s)})("click",function(){return n._handlePaginatorClick("after")})("touchend",function(){return n._stopInterval()}),je(12,"div",2),Re()),2&t&&(Ei("mat-mdc-tab-header-pagination-disabled",n._disableScrollBefore),W("matRippleDisabled",n._disableScrollBefore||n.disableRipple)("disabled",n._disableScrollBefore||null),K(3),Ei("_mat-animation-noopable","NoopAnimations"===n._animationMode),K(7),Ei("mat-mdc-tab-header-pagination-disabled",n._disableScrollAfter),W("matRippleDisabled",n._disableScrollAfter||n.disableRipple)("disabled",n._disableScrollAfter||null))},dependencies:[a0,wI],styles:[".mat-mdc-tab-header{display:flex;overflow:hidden;position:relative;flex-shrink:0}.mat-mdc-tab-header-pagination{-webkit-user-select:none;user-select:none;position:relative;display:none;justify-content:center;align-items:center;min-width:32px;cursor:pointer;z-index:2;-webkit-tap-highlight-color:rgba(0,0,0,0);touch-action:none;box-sizing:content-box;background:none;border:none;outline:0;padding:0}.mat-mdc-tab-header-pagination::-moz-focus-inner{border:0}.mat-mdc-tab-header-pagination .mat-ripple-element{opacity:.12}.mat-mdc-tab-header-pagination-controls-enabled .mat-mdc-tab-header-pagination{display:flex}.mat-mdc-tab-header-pagination-before,.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-after{padding-left:4px}.mat-mdc-tab-header-pagination-before .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-after .mat-mdc-tab-header-pagination-chevron{transform:rotate(-135deg)}.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-before,.mat-mdc-tab-header-pagination-after{padding-right:4px}.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-before .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-header-pagination-after .mat-mdc-tab-header-pagination-chevron{transform:rotate(45deg)}.mat-mdc-tab-header-pagination-chevron{border-style:solid;border-width:2px 2px 0 0;height:8px;width:8px}.mat-mdc-tab-header-pagination-disabled{box-shadow:none;cursor:default;pointer-events:none}.mat-mdc-tab-header-pagination-disabled .mat-mdc-tab-header-pagination-chevron{opacity:.4}.mat-mdc-tab-list{flex-grow:1;position:relative;transition:transform 500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-mdc-tab-list{transition:none}._mat-animation-noopable span.mdc-tab-indicator__content,._mat-animation-noopable span.mdc-tab__text-label{transition:none}.mat-mdc-tab-label-container{display:flex;flex-grow:1;overflow:hidden;z-index:1}.mat-mdc-tab-labels{display:flex;flex:1 0 auto}[mat-align-tabs=center]>.mat-mdc-tab-header .mat-mdc-tab-labels{justify-content:center}[mat-align-tabs=end]>.mat-mdc-tab-header .mat-mdc-tab-labels{justify-content:flex-end}.mat-mdc-tab::before{margin:5px}.cdk-high-contrast-active .mat-mdc-tab[aria-disabled=true]{color:GrayText}"],encapsulation:2}),i})();const Uz=new Oe("MAT_TABS_CONFIG");let lme=0;const cme=sw(NV(class{constructor(i){this._elementRef=i}}),"primary");let dme=(()=>{class i extends cme{get dynamicHeight(){return this._dynamicHeight}set dynamicHeight(t){this._dynamicHeight=Qi(t)}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){this._indexToSelect=ms(t,null)}get animationDuration(){return this._animationDuration}set animationDuration(t){this._animationDuration=/^\d+$/.test(t+"")?t+"ms":t}get contentTabIndex(){return this._contentTabIndex}set contentTabIndex(t){this._contentTabIndex=ms(t,null)}get disablePagination(){return this._disablePagination}set disablePagination(t){this._disablePagination=Qi(t)}get preserveContent(){return this._preserveContent}set preserveContent(t){this._preserveContent=Qi(t)}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){const n=this._elementRef.nativeElement.classList;n.remove("mat-tabs-with-background",`mat-background-${this.backgroundColor}`),t&&n.add("mat-tabs-with-background",`mat-background-${t}`),this._backgroundColor=t}constructor(t,n,r,s){super(t),this._changeDetectorRef=n,this._animationMode=s,this._tabs=new Ld,this._indexToSelect=0,this._lastFocusedTabIndex=null,this._tabBodyWrapperHeight=0,this._tabsSubscription=un.EMPTY,this._tabLabelSubscription=un.EMPTY,this._dynamicHeight=!1,this._selectedIndex=null,this.headerPosition="above",this._disablePagination=!1,this._preserveContent=!1,this.selectedIndexChange=new Tt,this.focusChange=new Tt,this.animationDone=new Tt,this.selectedTabChange=new Tt(!0),this._groupId=lme++,this.animationDuration=r&&r.animationDuration?r.animationDuration:"500ms",this.disablePagination=!(!r||null==r.disablePagination)&&r.disablePagination,this.dynamicHeight=!(!r||null==r.dynamicHeight)&&r.dynamicHeight,this.contentTabIndex=r?.contentTabIndex??null,this.preserveContent=!!r?.preserveContent}ngAfterContentChecked(){const t=this._indexToSelect=this._clampTabIndex(this._indexToSelect);if(this._selectedIndex!=t){const n=null==this._selectedIndex;if(!n){this.selectedTabChange.emit(this._createChangeEvent(t));const r=this._tabBodyWrapper.nativeElement;r.style.minHeight=r.clientHeight+"px"}Promise.resolve().then(()=>{this._tabs.forEach((r,s)=>r.isActive=s===t),n||(this.selectedIndexChange.emit(t),this._tabBodyWrapper.nativeElement.style.minHeight="")})}this._tabs.forEach((n,r)=>{n.position=r-t,null!=this._selectedIndex&&0==n.position&&!n.origin&&(n.origin=t-this._selectedIndex)}),this._selectedIndex!==t&&(this._selectedIndex=t,this._lastFocusedTabIndex=null,this._changeDetectorRef.markForCheck())}ngAfterContentInit(){this._subscribeToAllTabChanges(),this._subscribeToTabLabels(),this._tabsSubscription=this._tabs.changes.subscribe(()=>{const t=this._clampTabIndex(this._indexToSelect);if(t===this._selectedIndex){const n=this._tabs.toArray();let r;for(let s=0;s<n.length;s++)if(n[s].isActive){this._indexToSelect=this._selectedIndex=s,this._lastFocusedTabIndex=null,r=n[s];break}!r&&n[t]&&Promise.resolve().then(()=>{n[t].isActive=!0,this.selectedTabChange.emit(this._createChangeEvent(t))})}this._changeDetectorRef.markForCheck()})}_subscribeToAllTabChanges(){this._allTabs.changes.pipe(sc(this._allTabs)).subscribe(t=>{this._tabs.reset(t.filter(n=>n._closestTabGroup===this||!n._closestTabGroup)),this._tabs.notifyOnChanges()})}ngOnDestroy(){this._tabs.destroy(),this._tabsSubscription.unsubscribe(),this._tabLabelSubscription.unsubscribe()}realignInkBar(){this._tabHeader&&this._tabHeader._alignInkBarToSelectedTab()}updatePagination(){this._tabHeader&&this._tabHeader.updatePagination()}focusTab(t){const n=this._tabHeader;n&&(n.focusIndex=t)}_focusChanged(t){this._lastFocusedTabIndex=t,this.focusChange.emit(this._createChangeEvent(t))}_createChangeEvent(t){const n=new hme;return n.index=t,this._tabs&&this._tabs.length&&(n.tab=this._tabs.toArray()[t]),n}_subscribeToTabLabels(){this._tabLabelSubscription&&this._tabLabelSubscription.unsubscribe(),this._tabLabelSubscription=bd(...this._tabs.map(t=>t._stateChanges)).subscribe(()=>this._changeDetectorRef.markForCheck())}_clampTabIndex(t){return Math.min(this._tabs.length-1,Math.max(t||0,0))}_getTabLabelId(t){return`mat-tab-label-${this._groupId}-${t}`}_getTabContentId(t){return`mat-tab-content-${this._groupId}-${t}`}_setTabBodyWrapperHeight(t){if(!this._dynamicHeight||!this._tabBodyWrapperHeight)return;const n=this._tabBodyWrapper.nativeElement;n.style.height=this._tabBodyWrapperHeight+"px",this._tabBodyWrapper.nativeElement.offsetHeight&&(n.style.height=t+"px")}_removeTabBodyWrapperHeight(){const t=this._tabBodyWrapper.nativeElement;this._tabBodyWrapperHeight=t.clientHeight,t.style.height="",this.animationDone.emit()}_handleClick(t,n,r){n.focusIndex=r,t.disabled||(this.selectedIndex=r)}_getTabIndex(t){return t===(this._lastFocusedTabIndex??this.selectedIndex)?0:-1}_tabFocusChanged(t,n){t&&"mouse"!==t&&"touch"!==t&&(this._tabHeader.focusIndex=n)}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(sr),I(Uz,8),I(rs,8))},i.\u0275dir=Ne({type:i,inputs:{dynamicHeight:"dynamicHeight",selectedIndex:"selectedIndex",headerPosition:"headerPosition",animationDuration:"animationDuration",contentTabIndex:"contentTabIndex",disablePagination:"disablePagination",preserveContent:"preserveContent",backgroundColor:"backgroundColor"},outputs:{selectedIndexChange:"selectedIndexChange",focusChange:"focusChange",animationDone:"animationDone",selectedTabChange:"selectedTabChange"},features:[q]}),i})(),ume=(()=>{class i extends dme{get fitInkBarToContent(){return this._fitInkBarToContent}set fitInkBarToContent(t){this._fitInkBarToContent=Qi(t),this._changeDetectorRef.markForCheck()}get stretchTabs(){return this._stretchTabs}set stretchTabs(t){this._stretchTabs=Qi(t)}constructor(t,n,r,s){super(t,n,r,s),this._fitInkBarToContent=!1,this._stretchTabs=!0,this.fitInkBarToContent=!(!r||null==r.fitInkBarToContent)&&r.fitInkBarToContent}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(sr),I(Uz,8),I(rs,8))},i.\u0275cmp=$({type:i,selectors:[["mat-tab-group"]],contentQueries:function(t,n,r){if(1&t&&Nn(r,Oz,5),2&t){let s;Ot(s=Nt())&&(n._allTabs=s)}},viewQuery:function(t,n){if(1&t&&(ji(Fpe,5),ji(Ope,5)),2&t){let r;Ot(r=Nt())&&(n._tabBodyWrapper=r.first),Ot(r=Nt())&&(n._tabHeader=r.first)}},hostAttrs:[1,"mat-mdc-tab-group"],hostVars:6,hostBindings:function(t,n){2&t&&Ei("mat-mdc-tab-group-dynamic-height",n.dynamicHeight)("mat-mdc-tab-group-inverted-header","below"===n.headerPosition)("mat-mdc-tab-group-stretch-tabs",n.stretchTabs)},inputs:{color:"color",disableRipple:"disableRipple",fitInkBarToContent:"fitInkBarToContent",stretchTabs:["mat-stretch-tabs","stretchTabs"]},exportAs:["matTabGroup"],features:[ne([{provide:Fz,useExisting:i}]),q],decls:6,vars:6,consts:[[3,"selectedIndex","disableRipple","indexFocused","selectFocusedIndex"],["tabHeader",""],["class","mdc-tab mat-mdc-tab mat-mdc-focus-indicator","role","tab","matTabLabelWrapper","","cdkMonitorElementFocus","",3,"id","mdc-tab--active","ngClass","disabled","fitInkBarToContent","click","cdkFocusChange",4,"ngFor","ngForOf"],[1,"mat-mdc-tab-body-wrapper"],["tabBodyWrapper",""],["role","tabpanel",3,"id","mat-mdc-tab-body-active","ngClass","content","position","origin","animationDuration","preserveContent","_onCentered","_onCentering",4,"ngFor","ngForOf"],["role","tab","matTabLabelWrapper","","cdkMonitorElementFocus","",1,"mdc-tab","mat-mdc-tab","mat-mdc-focus-indicator",3,"id","ngClass","disabled","fitInkBarToContent","click","cdkFocusChange"],["tabNode",""],[1,"mdc-tab__ripple"],["mat-ripple","",1,"mat-mdc-tab-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mdc-tab__content"],[1,"mdc-tab__text-label"],[3,"ngIf","ngIfElse"],["tabTextLabel",""],[3,"cdkPortalOutlet"],["role","tabpanel",3,"id","ngClass","content","position","origin","animationDuration","preserveContent","_onCentered","_onCentering"]],template:function(t,n){1&t&&(ge(0,"mat-tab-header",0,1),ut("indexFocused",function(s){return n._focusChanged(s)})("selectFocusedIndex",function(s){return n.selectedIndex=s}),Bt(2,Vpe,9,17,"div",2),Re(),ge(3,"div",3,4),Bt(5,zpe,1,11,"mat-tab-body",5),Re()),2&t&&(W("selectedIndex",n.selectedIndex||0)("disableRipple",n.disableRipple),K(2),W("ngForOf",n._tabs),K(1),Ei("_mat-animation-noopable","NoopAnimations"===n._animationMode),K(2),W("ngForOf",n._tabs))},dependencies:[_3,yl,nc,FI,a0,The,Pz,Lz,ame],styles:['.mdc-tab{min-width:90px;padding-right:24px;padding-left:24px;display:flex;flex:1 0 auto;justify-content:center;box-sizing:border-box;margin:0;padding-top:0;padding-bottom:0;border:none;outline:none;text-align:center;white-space:nowrap;cursor:pointer;-webkit-appearance:none;z-index:1}.mdc-tab::-moz-focus-inner{padding:0;border:0}.mdc-tab[hidden]{display:none}.mdc-tab--min-width{flex:0 1 auto}.mdc-tab__content{display:flex;align-items:center;justify-content:center;height:inherit;pointer-events:none}.mdc-tab__text-label{transition:150ms color linear;display:inline-block;line-height:1;z-index:2}.mdc-tab__icon{transition:150ms color linear;z-index:2}.mdc-tab--stacked .mdc-tab__content{flex-direction:column;align-items:center;justify-content:center}.mdc-tab--stacked .mdc-tab__text-label{padding-top:6px;padding-bottom:4px}.mdc-tab--active .mdc-tab__text-label,.mdc-tab--active .mdc-tab__icon{transition-delay:100ms}.mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label{padding-left:8px;padding-right:0}[dir=rtl] .mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label,.mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label[dir=rtl]{padding-left:0;padding-right:8px}.mdc-tab-indicator .mdc-tab-indicator__content--underline{border-top-width:2px}.mdc-tab-indicator .mdc-tab-indicator__content--icon{height:34px;font-size:34px}.mdc-tab-indicator{display:flex;position:absolute;top:0;left:0;justify-content:center;width:100%;height:100%;pointer-events:none;z-index:1}.mdc-tab-indicator__content{transform-origin:left;opacity:0}.mdc-tab-indicator__content--underline{align-self:flex-end;box-sizing:border-box;width:100%;border-top-style:solid}.mdc-tab-indicator__content--icon{align-self:center;margin:0 auto}.mdc-tab-indicator--active .mdc-tab-indicator__content{opacity:1}.mdc-tab-indicator .mdc-tab-indicator__content{transition:250ms transform cubic-bezier(0.4, 0, 0.2, 1)}.mdc-tab-indicator--no-transition .mdc-tab-indicator__content{transition:none}.mdc-tab-indicator--fade .mdc-tab-indicator__content{transition:150ms opacity linear}.mdc-tab-indicator--active.mdc-tab-indicator--fade .mdc-tab-indicator__content{transition-delay:100ms}.mat-mdc-tab-ripple{position:absolute;top:0;left:0;bottom:0;right:0;pointer-events:none}.mat-mdc-tab{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-tab.mdc-tab{height:48px;flex-grow:0}.mat-mdc-tab .mdc-tab__ripple::before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;opacity:0;pointer-events:none}.mat-mdc-tab .mdc-tab__text-label{display:inline-flex;align-items:center}.mat-mdc-tab .mdc-tab__content{position:relative}.mat-mdc-tab:hover .mdc-tab__ripple::before{opacity:.04}.mat-mdc-tab.cdk-program-focused .mdc-tab__ripple::before,.mat-mdc-tab.cdk-keyboard-focused .mdc-tab__ripple::before{opacity:.12}.mat-mdc-tab .mat-ripple-element{opacity:.12}.mat-mdc-tab-group.mat-mdc-tab-group-stretch-tabs>.mat-mdc-tab-header .mat-mdc-tab{flex-grow:1}.mat-mdc-tab-disabled{opacity:.4}.mat-mdc-tab-group{display:flex;flex-direction:column;max-width:100%}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination{background-color:var(--mat-mdc-tab-header-with-background-background-color, transparent)}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-tab .mdc-tab__text-label,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-tab-link .mdc-tab__text-label{color:var(--mat-mdc-tab-header-with-background-foreground-color, inherit)}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mdc-tab-indicator__content--underline,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-focus-indicator::before{border-color:var(--mat-mdc-tab-header-with-background-foreground-color, inherit)}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-ripple-element,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mdc-tab__ripple::before,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mat-ripple-element,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mdc-tab__ripple::before{background-color:var(--mat-mdc-tab-header-with-background-foreground-color, inherit)}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mat-mdc-tab-header-pagination-chevron{border-color:var(--mat-mdc-tab-header-with-background-foreground-color, inherit)}.mat-mdc-tab-group.mat-mdc-tab-group-inverted-header{flex-direction:column-reverse}.mat-mdc-tab-group.mat-mdc-tab-group-inverted-header .mdc-tab-indicator__content--underline{align-self:flex-start}.mat-mdc-tab-body-wrapper{position:relative;overflow:hidden;display:flex;transition:height 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-mdc-tab-body-wrapper._mat-animation-noopable{transition:none !important;animation:none !important}'],encapsulation:2}),i})();class hme{}let Vz=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[Ta,xn,yz,l0,nw,Rhe,xn]}),i})();const{isArray:fme}=Array;const _w=new Oe("HIGHLIGHT_OPTIONS");let gme=(()=>{class i{constructor(t,n,r){this.doc=t,this._options=r,this._ready=new qs(null),this.ready=this._ready.asObservable().pipe(jn(s=>!!s),wt(s=>s),bs(1)),T3(n)&&(t.defaultView.hljs?this._ready.next(t.defaultView.hljs):this._loadLibrary().pipe(Ys(s=>this._options&&this._options.lineNumbersLoader?(t.defaultView.hljs=s,this.loadLineNumbers().pipe(ln(()=>this._ready.next(s)))):(this._ready.next(s),Or)),na(s=>(console.error("[HLJS] ",s),Or))).subscribe(),this._options?.themePath&&this.loadTheme(this._options.themePath))}_loadLibrary(){if(this._options){if(this._options.fullLibraryLoader&&this._options.coreLibraryLoader)return ia(()=>"The full library and the core library were imported, only one of them should be imported!");if(this._options.fullLibraryLoader&&this._options.languages)return ia(()=>"The highlighting languages were imported they are not needed!");if(this._options.coreLibraryLoader&&!this._options.languages)return ia(()=>"The highlighting languages were not imported!");if(!this._options.coreLibraryLoader&&this._options.languages)return ia(()=>"The core library was not imported!");if(this._options.fullLibraryLoader)return this.loadFullLibrary();if(this._options.coreLibraryLoader&&this._options.languages&&Object.keys(this._options.languages).length)return this.loadCoreLibrary().pipe(Ys(t=>this._loadLanguages(t)))}return ia(()=>"Highlight.js library was not imported!")}_loadLanguages(t){return function mme(...i){const e=EM(i),t=function pme(i){return 1===i.length&&fme(i[0])?i[0]:i}(i);return t.length?new Oi(n=>{let r=t.map(()=>[]),s=t.map(()=>!1);n.add(()=>{r=s=null});for(let o=0;!n.closed&&o<t.length;o++)_s(t[o]).subscribe(hn(n,a=>{if(r[o].push(a),r.every(l=>l.length)){const l=r.map(c=>c.shift());n.next(e?e(...l):l),r.some((c,d)=>!c.length&&s[d])&&n.complete()}},()=>{s[o]=!0,!r[o].length&&n.complete()}));return()=>{r=s=null}}):Or}(...Object.entries(this._options.languages).map(([r,s])=>bw(s()).pipe(ln(o=>t.registerLanguage(r,o))))).pipe(wt(()=>t))}loadCoreLibrary(){return bw(this._options.coreLibraryLoader())}loadFullLibrary(){return bw(this._options.fullLibraryLoader())}loadLineNumbers(){return bw(this._options.lineNumbersLoader())}setTheme(t){this._themeLinkElement.href=t}loadTheme(t){this._themeLinkElement=this.doc.createElement("link"),this._themeLinkElement.href=t,this._themeLinkElement.type="text/css",this._themeLinkElement.rel="stylesheet",this._themeLinkElement.media="screen,print",this.doc.head.appendChild(this._themeLinkElement)}}return i.\u0275fac=function(t){return new(t||i)(xe(ti),xe(C_),xe(_w,8))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const bw=i=>En(i).pipe(jn(e=>!!e&&!!e.default),wt(e=>e.default));let _me=(()=>{class i{constructor(t,n){this._loader=t,this._hljs=null,t.ready.subscribe(r=>{this._hljs=r,n&&n.config&&(r.configure(n.config),r.listLanguages().length<1&&console.error("[HighlightJS]: No languages were registered!"))})}get hljs(){return this._hljs}highlight(t,{language:n,ignoreIllegals:r}){return this._loader.ready.pipe(wt(s=>s.highlight(t,{language:n,ignoreIllegals:r})))}highlightAuto(t,n){return this._loader.ready.pipe(wt(r=>r.highlightAuto(t,n)))}highlightElement(t){return this._loader.ready.pipe(wt(n=>n.highlightElement(t)))}highlightAll(){return this._loader.ready.pipe(wt(t=>t.highlightAll()))}configure(t){return this._loader.ready.pipe(wt(n=>n.configure(t)))}registerLanguage(t,n){return this._loader.ready.pipe(ln(r=>r.registerLanguage(t,n)))}unregisterLanguage(t){return this._loader.ready.pipe(ln(n=>n.unregisterLanguage(t)))}registerAliases(t,{languageName:n}){return this._loader.ready.pipe(ln(r=>r.registerAliases(t,{languageName:n})))}listLanguages(){return this._loader.ready.pipe(wt(t=>t.listLanguages()))}getLanguage(t){return this._loader.ready.pipe(wt(n=>n.getLanguage(t)))}safeMode(){return this._loader.ready.pipe(wt(t=>t.safeMode()))}debugMode(){return this._loader.ready.pipe(wt(t=>t.debugMode()))}lineNumbersBlock(t){return this._loader.ready.pipe(jn(n=>!!n.lineNumbersBlock),ln(n=>n.lineNumbersBlock(t)))}}return i.\u0275fac=function(t){return new(t||i)(xe(gme),xe(_w,8))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),bme=(()=>{class i{constructor(t,n,r,s){this._hljs=n,this._sanitizer=r,this._options=s,this.highlighted=new Tt,this._nativeElement=t.nativeElement}ngOnChanges(t){null!==t?.code?.currentValue&&t.code.currentValue!==t.code.previousValue&&(this.code?this.highlightElement(this.code,this.languages):this.setTextContent(""))}highlightElement(t,n){this.setTextContent(t),this._hljs.highlightAuto(t,n).subscribe(r=>{this.setInnerHTML(r?.value),this.lineNumbers&&this._options&&this._options.lineNumbersLoader&&this.addLineNumbers(),this.highlighted.emit(r)})}addLineNumbers(){this.destroyLineNumbersObserver(),pw.schedule(()=>{this._hljs.lineNumbersBlock(this._nativeElement).subscribe(),this._lineNumbersObs=new MutationObserver(()=>{this._nativeElement.firstElementChild&&"TABLE"===this._nativeElement.firstElementChild.tagName.toUpperCase()&&this._nativeElement.classList.add("hljs-line-numbers"),this.destroyLineNumbersObserver()}),this._lineNumbersObs.observe(this._nativeElement,{childList:!0})})}destroyLineNumbersObserver(){this._lineNumbersObs&&(this._lineNumbersObs.disconnect(),this._lineNumbersObs=null)}setTextContent(t){pw.schedule(()=>this._nativeElement.textContent=t)}setInnerHTML(t){pw.schedule(()=>this._nativeElement.innerHTML=this._sanitizer.sanitize(Bi.HTML,t)||"")}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(_me),I(WA),I(_w,8))},i.\u0275dir=Ne({type:i,selectors:[["","highlight",""]],hostVars:2,hostBindings:function(t,n){2&t&&Ei("hljs",!0)},inputs:{code:["highlight","code"],languages:"languages",lineNumbers:"lineNumbers"},outputs:{highlighted:"highlighted"},features:[Cr]}),i})(),zz=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({}),i})();const Ame={connector:()=>new Wt};function wme(i,e,t,n){t&&!Ti(t)&&(n=t);const r=Ti(t)?t:void 0;return s=>function xme(i,e){const t=Ti(i)?i:()=>i;return Ti(e)?function yme(i,e=Ame){const{connector:t}=e;return Mn((n,r)=>{const s=t();En(i(function vme(i){return new Oi(e=>i.subscribe(e))}(s))).subscribe(r),r.add(n.subscribe(s))})}(e,{connector:t}):n=>new RS(n,t)}(new $R(i,e,n),r)(s)}const Cme=new Oe("GIST_OPTIONS");let Mme=(()=>{class i{constructor(t,n){this._http=t,this._options=n}getCodeFromGist(t){let n;return this.isOAuthProvided()&&(n=(new Nl).set("client_id",this._options.clientId).set("client_secret",this._options.clientSecret)),this.fetchFile(`https://api.github.com/gists/${t}`,{params:n,responseType:"json"})}getCodeFromUrl(t){return this.fetchFile(t,{responseType:"text"})}isOAuthProvided(){return!!this._options&&!!this._options.clientId&&!!this._options.clientSecret}fetchFile(t,n){return function Eme(i){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(i)}(t)?this._http.get(t,n).pipe(wme(1),XA(),na(r=>(console.error("[NgxHighlight]: Unable to fetch the URL!",r.message),Or))):Or}}return i.\u0275fac=function(t){return new(t||i)(xe(dw),xe(Cme,8))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Sme=(()=>{class i{constructor(t){this._loader=t}transform(t){return this._loader.getCodeFromUrl(t)}}return i.\u0275fac=function(t){return new(t||i)(I(Mme,16))},i.\u0275pipe=_i({name:"codeFromUrl",type:i,pure:!0}),i})(),Tme=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[zz,vfe,zz]}),i})();function Rme(i,e){if(1&i&&(ge(0,"mat-tab",5)(1,"pre"),bi(2,"            "),je(3,"code",6),On(4,"async"),On(5,"codeFromUrl"),bi(6,"\n        "),Re()()),2&i){const t=e.$implicit,n=e.index,r=di();W("label",r.fileNames[n]),K(3),W("highlight",Zn(4,3,Zn(5,5,t)))("lineNumbers",r.lineNumbers)}}class g0{constructor(e){this.editorService=e,this.fileNames=[],this.lineNumbers=!1}set codeUrls(e){this.editorService.setUrls(e),this.fileNames=this.editorService.fileNames}get codeUrls(){return this.editorService.urls}}function Ime(i,e){1&i&&u_(0)}g0.\u0275fac=function(e){return new(e||g0)(I(Kx))},g0.\u0275cmp=$({type:g0,selectors:[["app-code"]],inputs:{codeUrls:"codeUrls",lineNumbers:"lineNumbers"},decls:14,vars:1,consts:[[1,"code-wrapper","hljs"],["dynamicHeight","","color","primary","backgroundColor","primary"],[3,"label",4,"ngFor","ngForOf"],["align","end"],["mat-button","","href","#",1,"gist-url",3,"click"],[3,"label"],[3,"highlight","lineNumbers"]],template:function(e,t){1&e&&(ge(0,"mat-card")(1,"mat-card-content")(2,"div",0)(3,"mat-tab-group",1),Bt(4,Rme,7,7,"mat-tab",2),Re()()(),ge(5,"mat-card-actions",3)(6,"button",4),ut("click",function(r){return t.editorService.toCodeSandbox(r)}),ge(7,"mat-icon"),bi(8,"crop_din"),Re(),bi(9," CodeSandbox "),Re(),ge(10,"button",4),ut("click",function(r){return t.editorService.toStackblitz(r)}),ge(11,"mat-icon"),bi(12,"bolt"),Re(),bi(13," Stackblitz "),Re()()()),2&e&&(K(4),W("ngForOf",t.codeUrls))},dependencies:[yl,qV,mz,gz,bz,_z,Oz,ume,bme,mS,Sme],styles:["pre[_ngcontent-%COMP%]{display:flex;margin-top:0;margin-bottom:0;word-wrap:break-word}pre[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{flex:1;line-height:1.8em;font-size:14px;min-height:100%;padding:1em 1.2em}pre[_ngcontent-%COMP%]   code.hljs-line-numbers[_ngcontent-%COMP%]{padding:0}.mat-mdc-card[_ngcontent-%COMP%]{padding:0;margin-bottom:3em}.mat-card-header[_ngcontent-%COMP%]{margin:0!important;padding:0!important;display:flex;align-items:center;height:40px}.mat-card-content[_ngcontent-%COMP%]{position:relative;overflow:hidden;padding:1px;margin-bottom:0}.mat-card-footer[_ngcontent-%COMP%]{padding:10px!important;margin:0!important;display:flex;flex-direction:row-reverse}.mat-card-footer[_ngcontent-%COMP%]   .gist-url[_ngcontent-%COMP%]{display:flex;align-items:center;font-weight:300;font-size:13px;text-decoration:unset}.mat-card-footer[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.mat-icon[_ngcontent-%COMP%]{margin:0 3px}.code-wrapper[_ngcontent-%COMP%]{border-radius:3px 3px 0 0}  .hljs{padding:0;border:none;transition:border ease 1s}  .hljs-ln{padding:10px 0}  .hljs-ln tr:first-child td{padding-top:10px!important}  .hljs-ln tr:last-child td{padding-bottom:10px!important}  td.hljs-ln-numbers{-webkit-user-select:none;user-select:none;text-align:center;color:#cccccc6b;border-right:1px solid rgba(204,204,204,.1098039216);vertical-align:top;padding-right:10px!important;padding-left:10px!important}  td.hljs-ln-code{padding-left:10px!important}"],changeDetection:0});class _0{constructor(e,t){this.editorService=e,this.route=t,this.exampleComponent=null,this.codeUrls=this.route.snapshot.data.codeUrls??[],this.editorService.declarations=this.route.snapshot.data.declarations,this.exampleComponent=this.route.snapshot.data.exampleComponent}ngOnInit(){}}_0.\u0275fac=function(e){return new(e||_0)(I(Kx),I(Gd))},_0.\u0275cmp=$({type:_0,selectors:[["app-example-page"]],decls:3,vars:3,consts:[[1,"example-container"],[4,"ngComponentOutlet"],[3,"lineNumbers","codeUrls"]],template:function(e,t){1&e&&(ge(0,"div",0),Bt(1,Ime,1,0,"ng-container",1),Re(),je(2,"app-code",2)),2&e&&(K(1),W("ngComponentOutlet",t.exampleComponent),K(1),W("lineNumbers",!0)("codeUrls",t.codeUrls))},dependencies:[b3,g0]});class Fu{}Fu.\u0275fac=function(e){return new(e||Fu)},Fu.\u0275mod=li({type:Fu}),Fu.\u0275inj=si({});class Vp{}Vp.\u0275fac=function(e){return new(e||Vp)},Vp.\u0275mod=li({type:Vp}),Vp.\u0275inj=si({imports:[Fu,Ta,Fu]});const Dme=/^[og]\s*(.+)?/,Pme=/^mtllib /,kme=/^usemtl /,Bme=/^usemap /,Gz=/\s+/,Hz=new R,VI=new R,Qz=new R,Wz=new R,Fo=new R,vw=new Le;function Lme(){const i={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);const n=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(r,s){const o=this._finalize(!1);o&&(o.inherited||o.groupCount<=0)&&this.materials.splice(o.index,1);const a={index:this.materials.length,name:r||"",mtllib:Array.isArray(s)&&s.length>0?s[s.length-1]:"",smooth:void 0!==o?o.smooth:this.smooth,groupStart:void 0!==o?o.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(l){const c={index:"number"==typeof l?l:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return c.clone=this.clone.bind(c),c}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(r){const s=this.currentMaterial();if(s&&-1===s.groupEnd&&(s.groupEnd=this.geometry.vertices.length/3,s.groupCount=s.groupEnd-s.groupStart,s.inherited=!1),r&&this.materials.length>1)for(let o=this.materials.length-1;o>=0;o--)this.materials[o].groupCount<=0&&this.materials.splice(o,1);return r&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),s}},n&&n.name&&"function"==typeof n.clone){const r=n.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseNormalIndex:function(e,t){const n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseUVIndex:function(e,t){const n=parseInt(e,10);return 2*(n>=0?n-1:n+t/2)},addVertex:function(e,t,n){const r=this.vertices,s=this.object.geometry.vertices;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[n+0],r[n+1],r[n+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,n){const r=this.normals,s=this.object.geometry.normals;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[n+0],r[n+1],r[n+2])},addFaceNormal:function(e,t,n){const r=this.vertices,s=this.object.geometry.normals;Hz.fromArray(r,e),VI.fromArray(r,t),Qz.fromArray(r,n),Fo.subVectors(Qz,VI),Wz.subVectors(Hz,VI),Fo.cross(Wz),Fo.normalize(),s.push(Fo.x,Fo.y,Fo.z),s.push(Fo.x,Fo.y,Fo.z),s.push(Fo.x,Fo.y,Fo.z)},addColor:function(e,t,n){const r=this.colors,s=this.object.geometry.colors;void 0!==r[e]&&s.push(r[e+0],r[e+1],r[e+2]),void 0!==r[t]&&s.push(r[t+0],r[t+1],r[t+2]),void 0!==r[n]&&s.push(r[n+0],r[n+1],r[n+2])},addUV:function(e,t,n){const r=this.uvs,s=this.object.geometry.uvs;s.push(r[e+0],r[e+1]),s.push(r[t+0],r[t+1]),s.push(r[n+0],r[n+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,n,r,s,o,a,l,c){const d=this.vertices.length;let u=this.parseVertexIndex(e,d),h=this.parseVertexIndex(t,d),f=this.parseVertexIndex(n,d);if(this.addVertex(u,h,f),this.addColor(u,h,f),void 0!==a&&""!==a){const m=this.normals.length;u=this.parseNormalIndex(a,m),h=this.parseNormalIndex(l,m),f=this.parseNormalIndex(c,m),this.addNormal(u,h,f)}else this.addFaceNormal(u,h,f);if(void 0!==r&&""!==r){const m=this.uvs.length;u=this.parseUVIndex(r,m),h=this.parseUVIndex(s,m),f=this.parseUVIndex(o,m),this.addUV(u,h,f),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let n=0,r=e.length;n<r;n++){const s=this.parseVertexIndex(e[n],t);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const n=this.vertices.length,r=this.uvs.length;for(let s=0,o=e.length;s<o;s++)this.addVertexLine(this.parseVertexIndex(e[s],n));for(let s=0,o=t.length;s<o;s++)this.addUVLine(this.parseUVIndex(t[s],r))}};return i.startObject("",!1),i}class Fme extends Ar{constructor(e){super(e),this.materials=null}load(e,t,n,r){const s=this,o=new yr(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(a))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}setMaterials(e){return this.materials=e,this}parse(e){const t=new Lme;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));const n=e.split("\n");let r=[];for(let a=0,l=n.length;a<l;a++){const c=n[a].trimStart();if(0===c.length)continue;const d=c.charAt(0);if("#"!==d)if("v"===d){const u=c.split(Gz);switch(u[0]){case"v":t.vertices.push(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])),u.length>=7?(vw.setRGB(parseFloat(u[4]),parseFloat(u[5]),parseFloat(u[6])).convertSRGBToLinear(),t.colors.push(vw.r,vw.g,vw.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]));break;case"vt":t.uvs.push(parseFloat(u[1]),parseFloat(u[2]))}}else if("f"===d){const h=c.slice(1).trim().split(Gz),f=[];for(let _=0,g=h.length;_<g;_++){const p=h[_];if(p.length>0){const v=p.split("/");f.push(v)}}const m=f[0];for(let _=1,g=f.length-1;_<g;_++){const p=f[_],v=f[_+1];t.addFace(m[0],p[0],v[0],m[1],p[1],v[1],m[2],p[2],v[2])}}else if("l"===d){const u=c.substring(1).trim().split(" ");let h=[];const f=[];if(-1===c.indexOf("/"))h=u;else for(let m=0,_=u.length;m<_;m++){const g=u[m].split("/");""!==g[0]&&h.push(g[0]),""!==g[1]&&f.push(g[1])}t.addLineGeometry(h,f)}else if("p"===d){const h=c.slice(1).trim().split(" ");t.addPointGeometry(h)}else if(null!==(r=Dme.exec(c))){const u=(" "+r[0].slice(1).trim()).slice(1);t.startObject(u)}else if(kme.test(c))t.object.startMaterial(c.substring(7).trim(),t.materialLibraries);else if(Pme.test(c))t.materialLibraries.push(c.substring(7).trim());else if(Bme.test(c))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===d){if(r=c.split(" "),r.length>1){const h=r[1].trim().toLowerCase();t.object.smooth="0"!==h&&"off"!==h}else t.object.smooth=!0;const u=t.object.currentMaterial();u&&(u.smooth=t.object.smooth)}else{if("\0"===c)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+c+'"')}}t.finalize();const s=new Es;if(s.materialLibraries=[].concat(t.materialLibraries),1==!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length))for(let a=0,l=t.objects.length;a<l;a++){const c=t.objects[a],d=c.geometry,u=c.materials,h="Line"===d.type,f="Points"===d.type;let m=!1;if(0===d.vertices.length)continue;const _=new Mt;_.setAttribute("position",new Ke(d.vertices,3)),d.normals.length>0&&_.setAttribute("normal",new Ke(d.normals,3)),d.colors.length>0&&(m=!0,_.setAttribute("color",new Ke(d.colors,3))),!0===d.hasUVIndices&&_.setAttribute("uv",new Ke(d.uvs,2));const g=[];for(let v=0,b=u.length;v<b;v++){const y=u[v],x=y.name+"_"+y.smooth+"_"+m;let w=t.materials[x];if(null!==this.materials)if(w=this.materials.create(y.name),!h||!w||w instanceof gn){if(f&&w&&!(w instanceof Pl)){const E=new Pl({size:10,sizeAttenuation:!1});zn.prototype.copy.call(E,w),E.color.copy(w.color),E.map=w.map,w=E}}else{const E=new gn;zn.prototype.copy.call(E,w),E.color.copy(w.color),w=E}void 0===w&&(w=h?new gn:f?new Pl({size:1,sizeAttenuation:!1}):new du,w.name=y.name,w.flatShading=!y.smooth,w.vertexColors=m,t.materials[x]=w),g.push(w)}let p;if(g.length>1){for(let v=0,b=u.length;v<b;v++){const y=u[v];_.addGroup(y.groupStart,y.groupCount,v)}p=h?new Ss(_,g):f?new su(_,g):new nt(_,g)}else p=h?new Ss(_,g[0]):f?new su(_,g[0]):new nt(_,g[0]);p.name=c.name,s.add(p)}else if(t.vertices.length>0){const a=new Pl({size:1,sizeAttenuation:!1}),l=new Mt;l.setAttribute("position",new Ke(t.vertices,3)),t.colors.length>0&&void 0!==t.colors[0]&&(l.setAttribute("color",new Ke(t.colors,3)),a.vertexColors=!0);const c=new su(l,a);s.add(c)}return s}}class kc extends za{constructor(){super(...arguments),this.clazz=Fme}}kc.\u0275fac=function(){let i;return function(t){return(i||(i=le(kc)))(t||kc)}}(),kc.\u0275prov=He({token:kc,factory:kc.\u0275fac,providedIn:"root"});class Aw extends Wx{constructor(e){super(),this.service=e}}Aw.\u0275fac=function(e){return new(e||Aw)(I(kc,16))},Aw.\u0275pipe=_i({name:"loadObj",type:Aw,pure:!0});class yw extends Su{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}getRefFromResponse(e){return e}}yw.\u0275fac=function(e){return new(e||yw)(I(We,1),I(gt),I(kc))},yw.\u0275dir=Ne({type:yw,selectors:[["","loadObj",""]],features:[q]});var zI=function(i){return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))};try{URL.revokeObjectURL(zI(""))}catch{zI=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)}}var $i=Uint8Array,Er=Uint16Array,Bc=Uint32Array,zp=new $i([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Gp=new $i([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),b0=new $i([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Xz=function(i,e){for(var t=new Er(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];var r=new Bc(t[30]);for(n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)r[s]=s-t[n]<<5|n;return[t,r]},Zz=Xz(zp,2),GI=Zz[0],xw=Zz[1];GI[28]=258,xw[258]=28;for(var $z=Xz(Gp,0)[0],v0=new Er(32768),_n=0;_n<32768;++_n){var Lc=(43690&_n)>>>1|(21845&_n)<<1;v0[_n]=((65280&(Lc=(61680&(Lc=(52428&Lc)>>>2|(13107&Lc)<<2))>>>4|(3855&Lc)<<4))>>>8|(255&Lc)<<8)>>>1}var qa=function(i,e,t){for(var n=i.length,r=0,s=new Er(e);r<n;++r)++s[i[r]-1];var a,o=new Er(e);for(r=0;r<e;++r)o[r]=o[r-1]+s[r-1]<<1;if(t){a=new Er(1<<e);var l=15-e;for(r=0;r<n;++r)if(i[r])for(var c=r<<4|i[r],d=e-i[r],u=o[i[r]-1]++<<d,h=u|(1<<d)-1;u<=h;++u)a[v0[u]>>>l]=c}else for(a=new Er(n),r=0;r<n;++r)i[r]&&(a[r]=v0[o[i[r]-1]++]>>>15-i[r]);return a},Fc=new $i(288);for(_n=0;_n<144;++_n)Fc[_n]=8;for(_n=144;_n<256;++_n)Fc[_n]=9;for(_n=256;_n<280;++_n)Fc[_n]=7;for(_n=280;_n<288;++_n)Fc[_n]=8;var A0=new $i(32);for(_n=0;_n<32;++_n)A0[_n]=5;var eG=qa(Fc,9,1),iG=qa(A0,5,1),ww=function(i){for(var e=i[0],t=1;t<i.length;++t)i[t]>e&&(e=i[t]);return e},Oo=function(i,e,t){var n=e/8|0;return(i[n]|i[n+1]<<8)>>(7&e)&t},Cw=function(i,e){var t=e/8|0;return(i[t]|i[t+1]<<8|i[t+2]<<16)>>(7&e)},y0=function(i){return(i/8|0)+(7&i&&1)},Mw=function(i,e,t){var n=i.length;if(!n||t&&!t.l&&n<5)return e||new $i(0);var r=!e||t,s=!t||t.i;t||(t={}),e||(e=new $i(3*n));var o=function(J){var D=e.length;if(J>D){var ue=new $i(Math.max(2*D,J));ue.set(e),e=ue}},a=t.f||0,l=t.p||0,c=t.b||0,d=t.l,u=t.d,h=t.m,f=t.n,m=8*n;do{if(!d){t.f=a=Oo(i,l,1);var _=Oo(i,l+1,3);if(l+=3,!_){var p=i[(g=y0(l)+4)-4]|i[g-3]<<8,v=g+p;if(v>n){if(s)throw"unexpected EOF";break}r&&o(c+p),e.set(i.subarray(g,v),c),t.b=c+=p,t.p=l=8*v;continue}if(1==_)d=eG,u=iG,h=9,f=5;else{if(2!=_)throw"invalid block type";var b=Oo(i,l,31)+257,y=Oo(i,l+10,15)+4,x=b+Oo(i,l+5,31)+1;l+=14;for(var w=new $i(x),E=new $i(19),S=0;S<y;++S)E[b0[S]]=Oo(i,l+3*S,7);l+=3*y;var C=ww(E),T=(1<<C)-1,k=qa(E,C,1);for(S=0;S<x;){var g,U=k[Oo(i,l,T)];if(l+=15&U,(g=U>>>4)<16)w[S++]=g;else{var L=0,j=0;for(16==g?(j=3+Oo(i,l,3),l+=2,L=w[S-1]):17==g?(j=3+Oo(i,l,7),l+=3):18==g&&(j=11+Oo(i,l,127),l+=7);j--;)w[S++]=L}}var H=w.subarray(0,b),B=w.subarray(b);h=ww(H),f=ww(B),d=qa(H,h,1),u=qa(B,f,1)}if(l>m){if(s)throw"unexpected EOF";break}}r&&o(c+131072);for(var V=(1<<h)-1,O=(1<<f)-1,Q=l;;Q=l){var oe=(L=d[Cw(i,l)&V])>>>4;if((l+=15&L)>m){if(s)throw"unexpected EOF";break}if(!L)throw"invalid length/literal";if(oe<256)e[c++]=oe;else{if(256==oe){Q=l,d=null;break}var be=oe-254;oe>264&&(be=Oo(i,l,(1<<(de=zp[S=oe-257]))-1)+GI[S],l+=de);var X=u[Cw(i,l)&O],Y=X>>>4;if(!X)throw"invalid distance";if(l+=15&X,B=$z[Y],Y>3){var de=Gp[Y];B+=Cw(i,l)&(1<<de)-1,l+=de}if(l>m){if(s)throw"unexpected EOF";break}r&&o(c+131072);for(var re=c+be;c<re;c+=4)e[c]=e[c-B],e[c+1]=e[c+1-B],e[c+2]=e[c+2-B],e[c+3]=e[c+3-B];c=re}}t.l=d,t.p=Q,t.b=c,d&&(a=1,t.m=h,t.d=u,t.n=f)}while(!a);return c==e.length?e:function(i,e,t){(null==e||e<0)&&(e=0),(null==t||t>i.length)&&(t=i.length);var n=new(i instanceof Er?Er:i instanceof Bc?Bc:$i)(t-e);return n.set(i.subarray(e,t)),n}(e,0,c)},Tw=new $i(0);function jc(i,e){return Mw((function(i){if(8!=(15&i[0])||i[0]>>>4>7||(i[0]<<8|i[1])%31)throw"invalid zlib data";if(32&i[1])throw"invalid zlib data: preset dictionaries not supported"}(i),i.subarray(2,-4)),e)}var JI=typeof TextDecoder<"u"&&new TextDecoder;try{JI.decode(Tw,{stream:!0})}catch{}function Fw(i,e,t){const n=t.length-i-1;if(e>=t[n])return n-1;if(e<=t[i])return i;let r=i,s=n,o=Math.floor((r+s)/2);for(;e<t[o]||e>=t[o+1];)e<t[o]?s=o:r=o,o=Math.floor((r+s)/2);return o}function Jme(i,e){let t=1;for(let r=2;r<=i;++r)t*=r;let n=1;for(let r=2;r<=e;++r)n*=r;for(let r=2;r<=i-e;++r)n*=r;return t/n}class ige extends Ro{constructor(e,t,n,r,s){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=r||0,this.endKnot=s||this.knots.length-1;for(let o=0;o<n.length;++o){const a=n[o];this.controlPoints[o]=new ii(a.x,a.y,a.z,a.w)}}getPoint(e,t=new R){const n=t,s=function Zme(i,e,t,n){const r=Fw(i,n,e),s=function eD(i,e,t,n){const r=[],s=[],o=[];r[0]=1;for(let a=1;a<=t;++a){s[a]=e-n[i+1-a],o[a]=n[i+a]-e;let l=0;for(let c=0;c<a;++c){const d=o[c+1],u=s[a-c],h=r[c]/(d+u);r[c]=l+d*h,l=u*h}r[a]=l}return r}(r,n,i,e),o=new ii(0,0,0,0);for(let a=0;a<=i;++a){const l=t[r-i+a],c=s[a],d=l.w*c;o.x+=l.x*d,o.y+=l.y*d,o.z+=l.z*d,o.w+=l.w*c}return o}(this.degree,this.knots,this.controlPoints,this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]));return 1!==s.w&&s.divideScalar(s.w),n.set(s.x,s.y,s.z)}getTangent(e,t=new R){const n=t,s=function tge(i,e,t,n,r){const s=function $me(i,e,t,n,r){const s=r<i?r:i,o=[],a=Fw(i,n,e),l=function Kme(i,e,t,n,r){const s=[];for(let u=0;u<=t;++u)s[u]=0;const o=[];for(let u=0;u<=n;++u)o[u]=s.slice(0);const a=[];for(let u=0;u<=t;++u)a[u]=s.slice(0);a[0][0]=1;const l=s.slice(0),c=s.slice(0);for(let u=1;u<=t;++u){l[u]=e-r[i+1-u],c[u]=r[i+u]-e;let h=0;for(let f=0;f<u;++f){const m=c[f+1],_=l[u-f];a[u][f]=m+_;const g=a[f][u-1]/a[u][f];a[f][u]=h+m*g,h=_*g}a[u][u]=h}for(let u=0;u<=t;++u)o[0][u]=a[u][t];for(let u=0;u<=t;++u){let h=0,f=1;const m=[];for(let _=0;_<=t;++_)m[_]=s.slice(0);m[0][0]=1;for(let _=1;_<=n;++_){let g=0;const p=u-_,v=t-_;u>=_&&(m[f][0]=m[h][0]/a[v+1][p],g=m[f][0]*a[p][v]);const y=u-1<=v?_-1:t-u;for(let w=p>=-1?1:-p;w<=y;++w)m[f][w]=(m[h][w]-m[h][w-1])/a[v+1][p+w],g+=m[f][w]*a[p+w][v];u<=v&&(m[f][_]=-m[h][_-1]/a[v+1][u],g+=m[f][_]*a[u][v]),o[_][u]=g;const x=h;h=f,f=x}}let d=t;for(let u=1;u<=n;++u){for(let h=0;h<=t;++h)o[u][h]*=d;d*=t-u}return o}(a,n,i,s,e),c=[];for(let d=0;d<t.length;++d){const u=t[d].clone(),h=u.w;u.x*=h,u.y*=h,u.z*=h,c[d]=u}for(let d=0;d<=s;++d){const u=c[a-i].clone().multiplyScalar(l[d][0]);for(let h=1;h<=i;++h)u.add(c[a-i+h].clone().multiplyScalar(l[d][h]));o[d]=u}for(let d=s+1;d<=r+1;++d)o[d]=new ii(0,0,0);return o}(i,e,t,n,r);return function ege(i){const e=i.length,t=[],n=[];for(let s=0;s<e;++s){const o=i[s];t[s]=new R(o.x,o.y,o.z),n[s]=o.w}const r=[];for(let s=0;s<e;++s){const o=t[s].clone();for(let a=1;a<=s;++a)o.sub(r[s-a].clone().multiplyScalar(Jme(s,a)*n[a]));r[s]=o.divideScalar(n[0])}return r}(s)}(this.degree,this.knots,this.controlPoints,this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),1);return n.copy(s[1]).normalize(),n}}let wi,tr,Fs;class nge extends Ar{constructor(e){super(e)}load(e,t,n,r){const s=this,o=""===s.path?bu.extractUrlBase(e):s.path,a=new yr(this.manager);a.setPath(s.path),a.setResponseType("arraybuffer"),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(l){try{t(s.parse(l,o))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},n,r)}parse(e,t){if(function cge(i){const e="Kaydara FBX Binary  \0";return i.byteLength>=e.length&&e===SG(i,0,e.length)}(e))wi=(new lge).parse(e);else{const r=SG(e);if(!function dge(i){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let t=0;function n(r){const s=i[r-1];return i=i.slice(t+r),t++,s}for(let r=0;r<e.length;++r)if(n(1)===e[r])return!1;return!0}(r))throw new Error("THREE.FBXLoader: Unknown format.");if(CG(r)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+CG(r));wi=(new age).parse(r)}const n=new Bx(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new rge(n,this.manager).parse(wi)}}class rge{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){tr=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),r=this.parseDeformers(),s=(new sge).parse(r);return this.parseScene(r,s,n),Fs}parseConnections(){const e=new Map;return"Connections"in wi&&wi.Connections.connections.forEach(function(n){const r=n[0],s=n[1],o=n[2];e.has(r)||e.set(r,{parents:[],children:[]});const a={ID:s,relationship:o};e.get(r).parents.push(a),e.has(s)||e.set(s,{parents:[],children:[]});const l={ID:r,relationship:o};e.get(s).children.push(l)}),e}parseImages(){const e={},t={};if("Video"in wi.Objects){const n=wi.Objects.Video;for(const r in n){const s=n[r];if(e[parseInt(r)]=s.RelativeFilename||s.Filename,"Content"in s&&(s.Content instanceof ArrayBuffer&&s.Content.byteLength>0||"string"==typeof s.Content&&""!==s.Content)){const c=this.parseImage(n[r]);t[s.RelativeFilename||s.Filename]=c}}}for(const n in e){const r=e[n];e[n]=void 0!==t[r]?t[r]:e[n].split("\\").pop()}return e}parseImage(e){const t=e.Content,n=e.RelativeFilename||e.Filename,r=n.slice(n.lastIndexOf(".")+1).toLowerCase();let s;switch(r){case"bmp":s="image/bmp";break;case"jpg":case"jpeg":s="image/jpeg";break;case"png":s="image/png";break;case"tif":s="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),s="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+r+'" is not supported.')}if("string"==typeof t)return"data:"+s+";base64,"+t;{const o=new Uint8Array(t);return window.URL.createObjectURL(new Blob([o],{type:s}))}}parseTextures(e){const t=new Map;if("Texture"in wi.Objects){const n=wi.Objects.Texture;for(const r in n){const s=this.parseTexture(n[r],e);t.set(parseInt(r),s)}}return t}parseTexture(e,t){const n=this.loadTexture(e,t);n.ID=e.id,n.name=e.attrName;const r=e.WrapModeU,s=e.WrapModeV,a=void 0!==s?s.value:0;if(n.wrapS=0===(void 0!==r?r.value:0)?Mo:_r,n.wrapT=0===a?Mo:_r,"Scaling"in e){const l=e.Scaling.value;n.repeat.x=l[0],n.repeat.y=l[1]}if("Translation"in e){const l=e.Translation.value;n.offset.x=l[0],n.offset.y=l[1]}return n}loadTexture(e,t){let n;const r=this.textureLoader.path,s=tr.get(e.id).children;let o;void 0!==s&&s.length>0&&void 0!==t[s[0].ID]&&(n=t[s[0].ID],(0===n.indexOf("blob:")||0===n.indexOf("data:"))&&this.textureLoader.setPath(void 0));const a=e.FileName.slice(-3).toLowerCase();if("tga"===a){const l=this.manager.getHandler(".tga");null===l?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),o=new An):(l.setPath(this.textureLoader.path),o=l.load(n))}else"psd"===a?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),o=new An):o=this.textureLoader.load(n);return this.textureLoader.setPath(r),o}parseMaterials(e){const t=new Map;if("Material"in wi.Objects){const n=wi.Objects.Material;for(const r in n){const s=this.parseMaterial(n[r],e);null!==s&&t.set(parseInt(r),s)}}return t}parseMaterial(e,t){const n=e.id,r=e.attrName;let s=e.ShadingModel;if("object"==typeof s&&(s=s.value),!tr.has(n))return null;const o=this.parseParameters(e,t,n);let a;switch(s.toLowerCase()){case"phong":a=new du;break;case"lambert":a=new Px;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',s),a=new du}return a.setValues(o),a.name=r,a}parseParameters(e,t,n){const r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=(new Le).fromArray(e.Diffuse.value).convertSRGBToLinear():e.DiffuseColor&&("Color"===e.DiffuseColor.type||"ColorRGB"===e.DiffuseColor.type)&&(r.color=(new Le).fromArray(e.DiffuseColor.value).convertSRGBToLinear()),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=(new Le).fromArray(e.Emissive.value).convertSRGBToLinear():e.EmissiveColor&&("Color"===e.EmissiveColor.type||"ColorRGB"===e.EmissiveColor.type)&&(r.emissive=(new Le).fromArray(e.EmissiveColor.value).convertSRGBToLinear()),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(r.opacity=parseFloat(e.Opacity.value)),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=(new Le).fromArray(e.Specular.value).convertSRGBToLinear():e.SpecularColor&&"Color"===e.SpecularColor.type&&(r.specular=(new Le).fromArray(e.SpecularColor.value).convertSRGBToLinear());const s=this;return tr.get(n).children.forEach(function(o){const a=o.relationship;switch(a){case"Bump":r.bumpMap=s.getTexture(t,o.ID);break;case"Maya|TEX_ao_map":r.aoMap=s.getTexture(t,o.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=s.getTexture(t,o.ID),void 0!==r.map&&(r.map.encoding=ui);break;case"DisplacementColor":r.displacementMap=s.getTexture(t,o.ID);break;case"EmissiveColor":r.emissiveMap=s.getTexture(t,o.ID),void 0!==r.emissiveMap&&(r.emissiveMap.encoding=ui);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=s.getTexture(t,o.ID);break;case"ReflectionColor":r.envMap=s.getTexture(t,o.ID),void 0!==r.envMap&&(r.envMap.mapping=Ef,r.envMap.encoding=ui);break;case"SpecularColor":r.specularMap=s.getTexture(t,o.ID),void 0!==r.specularMap&&(r.specularMap.encoding=ui);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=s.getTexture(t,o.ID),r.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",a)}}),r}getTexture(e,t){return"LayeredTexture"in wi.Objects&&t in wi.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=tr.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in wi.Objects){const n=wi.Objects.Deformer;for(const r in n){const s=n[r],o=tr.get(parseInt(r));if("Skin"===s.attrType){const a=this.parseSkeleton(o,n);a.ID=r,o.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),a.geometryID=o.parents[0].ID,e[r]=a}else if("BlendShape"===s.attrType){const a={id:r};a.rawTargets=this.parseMorphTargets(o,n),a.id=r,o.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[r]=a}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const n=[];return e.children.forEach(function(r){const s=t[r.ID];if("Cluster"!==s.attrType)return;const o={ID:r.ID,indices:[],weights:[],transformLink:(new Qe).fromArray(s.TransformLink.a)};"Indexes"in s&&(o.indices=s.Indexes.a,o.weights=s.Weights.a),n.push(o)}),{rawBones:n,bones:[]}}parseMorphTargets(e,t){const n=[];for(let r=0;r<e.children.length;r++){const s=e.children[r],o=t[s.ID],a={name:o.attrName,initialWeight:o.DeformPercent,id:o.id,fullWeights:o.FullWeights.a};if("BlendShapeChannel"!==o.attrType)return;a.geoID=tr.get(parseInt(s.ID)).children.filter(function(l){return void 0===l.relationship})[0].ID,n.push(a)}return n}parseScene(e,t,n){Fs=new Es;const r=this.parseModels(e.skeletons,t,n),s=wi.Objects.Model,o=this;r.forEach(function(l){o.setLookAtProperties(l,s[l.ID]),tr.get(l.ID).parents.forEach(function(u){const h=r.get(u.ID);void 0!==h&&h.add(l)}),null===l.parent&&Fs.add(l)}),this.bindSkeleton(e.skeletons,t,r),this.createAmbientLight(),Fs.traverse(function(l){if(l.userData.transformData){l.parent&&(l.userData.transformData.parentMatrix=l.parent.matrix,l.userData.transformData.parentMatrixWorld=l.parent.matrixWorld);const c=MG(l.userData.transformData);l.applyMatrix4(c),l.updateWorldMatrix()}});const a=(new oge).parse();1===Fs.children.length&&Fs.children[0].isGroup&&(Fs.children[0].animations=a,Fs=Fs.children[0]),Fs.animations=a}parseModels(e,t,n){const r=new Map,s=wi.Objects.Model;for(const o in s){const a=parseInt(o),l=s[o],c=tr.get(a);let d=this.buildSkeleton(c,e,a,l.attrName);if(!d){switch(l.attrType){case"Camera":d=this.createCamera(c);break;case"Light":d=this.createLight(c);break;case"Mesh":d=this.createMesh(c,t,n);break;case"NurbsCurve":d=this.createCurve(c,t);break;case"LimbNode":case"Root":d=new ru;break;default:d=new Es}d.name=l.attrName?Vi.sanitizeNodeName(l.attrName):"",d.ID=a}this.getTransformData(d,l),r.set(a,d)}return r}buildSkeleton(e,t,n,r){let s=null;return e.parents.forEach(function(o){for(const a in t){const l=t[a];l.rawBones.forEach(function(c,d){if(c.ID===o.ID){const u=s;s=new ru,s.matrixWorld.copy(c.transformLink),s.name=r?Vi.sanitizeNodeName(r):"",s.ID=n,l.bones[d]=s,null!==u&&s.add(u)}})}}),s}createCamera(e){let t,n;if(e.children.forEach(function(r){const s=wi.Objects.NodeAttribute[r.ID];void 0!==s&&(n=s)}),void 0===n)t=new Qt;else{let r=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(r=1);let s=1;void 0!==n.NearPlane&&(s=n.NearPlane.value/1e3);let o=1e3;void 0!==n.FarPlane&&(o=n.FarPlane.value/1e3);let a=window.innerWidth,l=window.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(a=n.AspectWidth.value,l=n.AspectHeight.value);const c=a/l;let d=45;void 0!==n.FieldOfView&&(d=n.FieldOfView.value);const u=n.FocalLength?n.FocalLength.value:null;switch(r){case 0:t=new In(d,c,s,o),null!==u&&t.setFocalLength(u);break;case 1:t=new La(-a/2,a/2,l/2,-l/2,s,o);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+r+"."),t=new Qt}}return t}createLight(e){let t,n;if(e.children.forEach(function(r){const s=wi.Objects.NodeAttribute[r.ID];void 0!==s&&(n=s)}),void 0===n)t=new Qt;else{let r;r=void 0===n.LightType?0:n.LightType.value;let s=16777215;void 0!==n.Color&&(s=(new Le).fromArray(n.Color.value).convertSRGBToLinear());let o=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(o=0);let a=0;void 0!==n.FarAttenuationEnd&&(a=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);const l=1;switch(r){case 0:t=new Sp(s,o,a,l);break;case 1:t=new Fb(s,o);break;case 2:let c=Math.PI/3;void 0!==n.InnerAngle&&(c=ft.degToRad(n.InnerAngle.value));let d=0;void 0!==n.OuterAngle&&(d=ft.degToRad(n.OuterAngle.value),d=Math.max(d,1)),t=new Bb(s,o,a,c,d,l);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),t=new Sp(s,o)}void 0!==n.CastShadows&&1===n.CastShadows.value&&(t.castShadow=!0)}return t}createMesh(e,t,n){let r,s=null,o=null;const a=[];return e.children.forEach(function(l){t.has(l.ID)&&(s=t.get(l.ID)),n.has(l.ID)&&a.push(n.get(l.ID))}),a.length>1?o=a:a.length>0?o=a[0]:(o=new du({color:13421772}),a.push(o)),"color"in s.attributes&&a.forEach(function(l){l.vertexColors=!0}),s.FBX_Deformer?(r=new wb(s,o),r.normalizeSkinWeights()):r=new nt(s,o),r}createCurve(e,t){const n=e.children.reduce(function(s,o){return t.has(o.ID)&&(s=t.get(o.ID)),s},null),r=new gn({color:3342591,linewidth:1});return new Gn(n,r)}getTransformData(e,t){const n={};"InheritType"in t&&(n.inheritType=parseInt(t.InheritType.value)),n.eulerOrder="RotationOrder"in t?EG(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(n.translation=t.Lcl_Translation.value),"PreRotation"in t&&(n.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(n.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(n.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(n.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(n.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(n.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(n.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(n.rotationPivot=t.RotationPivot.value),e.userData.transformData=n}setLookAtProperties(e,t){"LookAtProperty"in t&&tr.get(e.ID).children.forEach(function(r){if("LookAtProperty"===r.relationship){const s=wi.Objects.Model[r.ID];if("Lcl_Translation"in s){const o=s.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(o),Fs.add(e.target)):e.lookAt((new R).fromArray(o))}}})}bindSkeleton(e,t,n){const r=this.parsePoseNodes();for(const s in e){const o=e[s];tr.get(parseInt(o.ID)).parents.forEach(function(l){t.has(l.ID)&&tr.get(l.ID).parents.forEach(function(u){n.has(u.ID)&&n.get(u.ID).bind(new dp(o.bones),r[u.ID])})})}}parsePoseNodes(){const e={};if("Pose"in wi.Objects){const t=wi.Objects.Pose;for(const n in t)if("BindPose"===t[n].attrType&&t[n].NbPoseNodes>0){const r=t[n].PoseNode;Array.isArray(r)?r.forEach(function(s){e[s.Node]=(new Qe).fromArray(s.Matrix.a)}):e[r.Node]=(new Qe).fromArray(r.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in wi&&"AmbientColor"in wi.GlobalSettings){const e=wi.GlobalSettings.AmbientColor.value,t=e[0],n=e[1],r=e[2];if(0!==t||0!==n||0!==r){const s=new Le(t,n,r).convertSRGBToLinear();Fs.add(new Lx(s,1))}}}}class sge{constructor(){this.negativeMaterialIndices=!1}parse(e){const t=new Map;if("Geometry"in wi.Objects){const n=wi.Objects.Geometry;for(const r in n){const s=tr.get(parseInt(r)),o=this.parseGeometry(s,n[r],e);t.set(parseInt(r),o)}}return!0===this.negativeMaterialIndices&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),t}parseGeometry(e,t,n){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,n);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,n){const r=n.skeletons,s=[],o=e.parents.map(function(u){return wi.Objects.Model[u.ID]});if(0===o.length)return;const a=e.children.reduce(function(u,h){return void 0!==r[h.ID]&&(u=r[h.ID]),u},null);e.children.forEach(function(u){void 0!==n.morphTargets[u.ID]&&s.push(n.morphTargets[u.ID])});const l=o[0],c={};"RotationOrder"in l&&(c.eulerOrder=EG(l.RotationOrder.value)),"InheritType"in l&&(c.inheritType=parseInt(l.InheritType.value)),"GeometricTranslation"in l&&(c.translation=l.GeometricTranslation.value),"GeometricRotation"in l&&(c.rotation=l.GeometricRotation.value),"GeometricScaling"in l&&(c.scale=l.GeometricScaling.value);const d=MG(c);return this.genGeometry(t,a,s,d)}genGeometry(e,t,n,r){const s=new Mt;e.attrName&&(s.name=e.attrName);const o=this.parseGeoNode(e,t),a=this.genBuffers(o),l=new Ke(a.vertex,3);if(l.applyMatrix4(r),s.setAttribute("position",l),a.colors.length>0&&s.setAttribute("color",new Ke(a.colors,3)),t&&(s.setAttribute("skinIndex",new Wy(a.weightsIndices,4)),s.setAttribute("skinWeight",new Ke(a.vertexWeights,4)),s.FBX_Deformer=t),a.normal.length>0){const c=(new Ai).getNormalMatrix(r),d=new Ke(a.normal,3);d.applyNormalMatrix(c),s.setAttribute("normal",d)}if(a.uvs.forEach(function(c,d){let u="uv"+(d+1).toString();0===d&&(u="uv"),s.setAttribute(u,new Ke(a.uvs[d],2))}),o.material&&"AllSame"!==o.material.mappingType){let c=a.materialIndex[0],d=0;if(a.materialIndex.forEach(function(u,h){u!==c&&(s.addGroup(d,h-d,c),c=u,d=h)}),s.groups.length>0){const u=s.groups[s.groups.length-1],h=u.start+u.count;h!==a.materialIndex.length&&s.addGroup(h,a.materialIndex.length-h,c)}0===s.groups.length&&s.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(s,e,n,r),s}parseGeoNode(e,t){const n={};if(n.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],n.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(n.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(n.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){n.uv=[];let r=0;for(;e.LayerElementUV[r];)e.LayerElementUV[r].UV&&n.uv.push(this.parseUVs(e.LayerElementUV[r])),r++}return n.weightTable={},null!==t&&(n.skeleton=t,t.rawBones.forEach(function(r,s){r.indices.forEach(function(o,a){void 0===n.weightTable[o]&&(n.weightTable[o]=[]),n.weightTable[o].push({id:s,weight:r.weights[a]})})})),n}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,r=0,s=!1,o=[],a=[],l=[],c=[],d=[],u=[];const h=this;return e.vertexIndices.forEach(function(f,m){let _,g=!1;f<0&&(f^=-1,g=!0);let p=[],v=[];if(o.push(3*f,3*f+1,3*f+2),e.color){const b=Ow(m,n,f,e.color);l.push(b[0],b[1],b[2])}if(e.skeleton){if(void 0!==e.weightTable[f]&&e.weightTable[f].forEach(function(b){v.push(b.weight),p.push(b.id)}),v.length>4){s||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),s=!0);const b=[0,0,0,0],y=[0,0,0,0];v.forEach(function(x,w){let E=x,S=p[w];y.forEach(function(C,T,k){if(E>C){k[T]=E,E=C;const U=b[T];b[T]=S,S=U}})}),p=b,v=y}for(;v.length<4;)v.push(0),p.push(0);for(let b=0;b<4;++b)d.push(v[b]),u.push(p[b])}if(e.normal){const b=Ow(m,n,f,e.normal);a.push(b[0],b[1],b[2])}e.material&&"AllSame"!==e.material.mappingType&&(_=Ow(m,n,f,e.material)[0],_<0&&(h.negativeMaterialIndices=!0,_=0)),e.uv&&e.uv.forEach(function(b,y){const x=Ow(m,n,f,b);void 0===c[y]&&(c[y]=[]),c[y].push(x[0]),c[y].push(x[1])}),r++,g&&(r>4&&console.warn("THREE.FBXLoader: Polygons with more than four sides are not supported. Make sure to triangulate the geometry during export."),h.genFace(t,e,o,_,a,l,c,d,u,r),n++,r=0,o=[],a=[],l=[],c=[],d=[],u=[])}),t}genFace(e,t,n,r,s,o,a,l,c,d){for(let u=2;u<d;u++)e.vertex.push(t.vertexPositions[n[0]]),e.vertex.push(t.vertexPositions[n[1]]),e.vertex.push(t.vertexPositions[n[2]]),e.vertex.push(t.vertexPositions[n[3*(u-1)]]),e.vertex.push(t.vertexPositions[n[3*(u-1)+1]]),e.vertex.push(t.vertexPositions[n[3*(u-1)+2]]),e.vertex.push(t.vertexPositions[n[3*u]]),e.vertex.push(t.vertexPositions[n[3*u+1]]),e.vertex.push(t.vertexPositions[n[3*u+2]]),t.skeleton&&(e.vertexWeights.push(l[0]),e.vertexWeights.push(l[1]),e.vertexWeights.push(l[2]),e.vertexWeights.push(l[3]),e.vertexWeights.push(l[4*(u-1)]),e.vertexWeights.push(l[4*(u-1)+1]),e.vertexWeights.push(l[4*(u-1)+2]),e.vertexWeights.push(l[4*(u-1)+3]),e.vertexWeights.push(l[4*u]),e.vertexWeights.push(l[4*u+1]),e.vertexWeights.push(l[4*u+2]),e.vertexWeights.push(l[4*u+3]),e.weightsIndices.push(c[0]),e.weightsIndices.push(c[1]),e.weightsIndices.push(c[2]),e.weightsIndices.push(c[3]),e.weightsIndices.push(c[4*(u-1)]),e.weightsIndices.push(c[4*(u-1)+1]),e.weightsIndices.push(c[4*(u-1)+2]),e.weightsIndices.push(c[4*(u-1)+3]),e.weightsIndices.push(c[4*u]),e.weightsIndices.push(c[4*u+1]),e.weightsIndices.push(c[4*u+2]),e.weightsIndices.push(c[4*u+3])),t.color&&(e.colors.push(o[0]),e.colors.push(o[1]),e.colors.push(o[2]),e.colors.push(o[3*(u-1)]),e.colors.push(o[3*(u-1)+1]),e.colors.push(o[3*(u-1)+2]),e.colors.push(o[3*u]),e.colors.push(o[3*u+1]),e.colors.push(o[3*u+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(s[0]),e.normal.push(s[1]),e.normal.push(s[2]),e.normal.push(s[3*(u-1)]),e.normal.push(s[3*(u-1)+1]),e.normal.push(s[3*(u-1)+2]),e.normal.push(s[3*u]),e.normal.push(s[3*u+1]),e.normal.push(s[3*u+2])),t.uv&&t.uv.forEach(function(h,f){void 0===e.uvs[f]&&(e.uvs[f]=[]),e.uvs[f].push(a[f][0]),e.uvs[f].push(a[f][1]),e.uvs[f].push(a[f][2*(u-1)]),e.uvs[f].push(a[f][2*(u-1)+1]),e.uvs[f].push(a[f][2*u]),e.uvs[f].push(a[f][2*u+1])})}addMorphTargets(e,t,n,r){if(0===n.length)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const s=this;n.forEach(function(o){o.rawTargets.forEach(function(a){const l=wi.Objects.Geometry[a.geoID];void 0!==l&&s.genMorphGeometry(e,t,l,r,a.name)})})}genMorphGeometry(e,t,n,r,s){const o=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],a=void 0!==n.Vertices?n.Vertices.a:[],l=void 0!==n.Indexes?n.Indexes.a:[],d=new Float32Array(3*e.attributes.position.count);for(let m=0;m<l.length;m++){const _=3*l[m];d[_]=a[3*m],d[_+1]=a[3*m+1],d[_+2]=a[3*m+2]}const h=this.genBuffers({vertexIndices:o,vertexPositions:d}),f=new Ke(h.vertex,3);f.name=s||n.attrName,f.applyMatrix4(r),e.morphAttributes.position.push(f)}parseNormals(e){const n=e.ReferenceInformationType;let s=[];return"IndexToDirect"===n&&("NormalIndex"in e?s=e.NormalIndex.a:"NormalsIndex"in e&&(s=e.NormalsIndex.a)),{dataSize:3,buffer:e.Normals.a,indices:s,mappingType:e.MappingInformationType,referenceType:n}}parseUVs(e){const n=e.ReferenceInformationType;let s=[];return"IndexToDirect"===n&&(s=e.UVIndex.a),{dataSize:2,buffer:e.UV.a,indices:s,mappingType:e.MappingInformationType,referenceType:n}}parseVertexColors(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Colors.a;let s=[];"IndexToDirect"===n&&(s=e.ColorIndex.a);for(let o=0,a=new Le;o<r.length;o+=4)a.fromArray(r,o).convertSRGBToLinear().toArray(r,o);return{dataSize:4,buffer:r,indices:s,mappingType:t,referenceType:n}}parseMaterialIndices(e){const t=e.MappingInformationType,n=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const r=e.Materials.a,s=[];for(let o=0;o<r.length;++o)s.push(o);return{dataSize:1,buffer:r,indices:s,mappingType:t,referenceType:n}}parseNurbsGeometry(e){const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new Mt;const n=t-1,r=e.KnotVector.a,s=[],o=e.Points.a;for(let u=0,h=o.length;u<h;u+=4)s.push((new ii).fromArray(o,u));let a,l;if("Closed"===e.Form)s.push(s[0]);else if("Periodic"===e.Form){a=n,l=r.length-1-a;for(let u=0;u<n;++u)s.push(s[u])}const d=new ige(n,r,s,a,l).getPoints(12*s.length);return(new Mt).setFromPoints(d)}}class oge{parse(){const e=[],t=this.parseClips();if(void 0!==t)for(const n in t){const s=this.addClip(t[n]);e.push(s)}return e}parseClips(){if(void 0===wi.Objects.AnimationCurve)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=wi.Objects.AnimationCurveNode,t=new Map;for(const n in e){const r=e[n];if(null!==r.attrName.match(/S|R|T|DeformPercent/)){const s={id:r.id,attr:r.attrName,curves:{}};t.set(s.id,s)}}return t}parseAnimationCurves(e){const t=wi.Objects.AnimationCurve;for(const n in t){const r={id:t[n].id,times:t[n].KeyTime.a.map(uge),values:t[n].KeyValueFloat.a},s=tr.get(r.id);if(void 0!==s){const o=s.parents[0].ID,a=s.parents[0].relationship;a.match(/X/)?e.get(o).curves.x=r:a.match(/Y/)?e.get(o).curves.y=r:a.match(/Z/)?e.get(o).curves.z=r:a.match(/DeformPercent/)&&e.has(o)&&(e.get(o).curves.morph=r)}}}parseAnimationLayers(e){const t=wi.Objects.AnimationLayer,n=new Map;for(const r in t){const s=[],o=tr.get(parseInt(r));void 0!==o&&(o.children.forEach(function(l,c){if(e.has(l.ID)){const d=e.get(l.ID);if(void 0!==d.curves.x||void 0!==d.curves.y||void 0!==d.curves.z){if(void 0===s[c]){const u=tr.get(l.ID).parents.filter(function(h){return void 0!==h.relationship})[0].ID;if(void 0!==u){const h=wi.Objects.Model[u.toString()];if(void 0===h)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",l);const f={modelName:h.attrName?Vi.sanitizeNodeName(h.attrName):"",ID:h.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Fs.traverse(function(m){m.ID===h.id&&(f.transform=m.matrix,m.userData.transformData&&(f.eulerOrder=m.userData.transformData.eulerOrder))}),f.transform||(f.transform=new Qe),"PreRotation"in h&&(f.preRotation=h.PreRotation.value),"PostRotation"in h&&(f.postRotation=h.PostRotation.value),s[c]=f}}s[c]&&(s[c][d.attr]=d)}else if(void 0!==d.curves.morph){if(void 0===s[c]){const u=tr.get(l.ID).parents.filter(function(p){return void 0!==p.relationship})[0].ID,h=tr.get(u).parents[0].ID,f=tr.get(h).parents[0].ID,m=tr.get(f).parents[0].ID,_=wi.Objects.Model[m],g={modelName:_.attrName?Vi.sanitizeNodeName(_.attrName):"",morphName:wi.Objects.Deformer[u].attrName};s[c]=g}s[c][d.attr]=d}}}),n.set(parseInt(r),s))}return n}parseAnimStacks(e){const t=wi.Objects.AnimationStack,n={};for(const r in t){const s=tr.get(parseInt(r)).children;s.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const o=e.get(s[0].ID);n[r]={name:t[r].attrName,layer:o}}return n}addClip(e){let t=[];const n=this;return e.layer.forEach(function(r){t=t.concat(n.generateTracks(r))}),new gu(e.name,-1,t)}generateTracks(e){const t=[];let n=new R,r=new xi,s=new R;if(e.transform&&e.transform.decompose(n,r,s),n=n.toArray(),r=(new ro).setFromQuaternion(r,e.eulerOrder).toArray(),s=s.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");void 0!==o&&t.push(o)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){const o=this.generateRotationTrack(e.modelName,e.R.curves,r,e.preRotation,e.postRotation,e.eulerOrder);void 0!==o&&t.push(o)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.S.curves,s,"scale");void 0!==o&&t.push(o)}if(void 0!==e.DeformPercent){const o=this.generateMorphTrack(e);void 0!==o&&t.push(o)}return t}generateVectorTrack(e,t,n,r){const s=this.getTimesForAllAxes(t),o=this.getKeyframeTrackValues(s,t,n);return new mu(e+"."+r,s,o)}generateRotationTrack(e,t,n,r,s,o){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(ft.degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(ft.degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(ft.degToRad));const a=this.getTimesForAllAxes(t),l=this.getKeyframeTrackValues(a,t,n);void 0!==r&&((r=r.map(ft.degToRad)).push(o),r=(new ro).fromArray(r),r=(new xi).setFromEuler(r)),void 0!==s&&((s=s.map(ft.degToRad)).push(o),s=(new ro).fromArray(s),s=(new xi).setFromEuler(s).invert());const c=new xi,d=new ro,u=[];for(let h=0;h<l.length;h+=3)d.set(l[h],l[h+1],l[h+2],o),c.setFromEuler(d),void 0!==r&&c.premultiply(r),void 0!==s&&c.multiply(s),c.toArray(u,h/3*4);return new kl(e+".quaternion",a,u)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,n=t.values.map(function(s){return s/100}),r=Fs.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new fu(e.modelName+".morphTargetInfluences["+r+"]",t.times,n)}getTimesForAllAxes(e){let t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort(function(n,r){return n-r}),t.length>1){let n=1,r=t[0];for(let s=1;s<t.length;s++){const o=t[s];o!==r&&(t[n]=o,r=o,n++)}t=t.slice(0,n)}return t}getKeyframeTrackValues(e,t,n){const r=n,s=[];let o=-1,a=-1,l=-1;return e.forEach(function(c){if(t.x&&(o=t.x.times.indexOf(c)),t.y&&(a=t.y.times.indexOf(c)),t.z&&(l=t.z.times.indexOf(c)),-1!==o){const d=t.x.values[o];s.push(d),r[0]=d}else s.push(r[0]);if(-1!==a){const d=t.y.values[a];s.push(d),r[1]=d}else s.push(r[1]);if(-1!==l){const d=t.z.values[l];s.push(d),r[2]=d}else s.push(r[2])}),s}interpolateRotations(e){for(let t=1;t<e.values.length;t++){const n=e.values[t-1],r=e.values[t]-n,s=Math.abs(r);if(s>=180){const o=s/180,a=r/o;let l=n+a;const c=e.times[t-1],u=(e.times[t]-c)/o;let h=c+u;const f=[],m=[];for(;h<e.times[t];)f.push(h),h+=u,m.push(l),l+=a;e.times=TG(e.times,t,f),e.values=TG(e.values,t,m)}}}}class age{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new wG,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,n=e.split(/[\r\n]+/);return n.forEach(function(r,s){const o=r.match(/^[\s\t]*;/),a=r.match(/^[\s\t]*$/);if(o||a)return;const l=r.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),c=r.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),d=r.match("^\\t{"+(t.currentIndent-1)+"}}");l?t.parseNodeBegin(r,l):c?t.parseNodeProperty(r,c,n[++s]):d?t.popStack():r.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(r)}),this.allNodes}parseNodeBegin(e,t){const n=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map(function(l){return l.trim().replace(/^"/,"").replace(/"$/,"")}),s={name:n},o=this.parseNodeAttr(r),a=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(n,s):n in a?("PoseNode"===n?a.PoseNode.push(s):void 0!==a[n].id&&(a[n]={},a[n][a[n].id]=a[n]),""!==o.id&&(a[n][o.id]=s)):"number"==typeof o.id?(a[n]={},a[n][o.id]=s):"Properties70"!==n&&(a[n]="PoseNode"===n?[s]:s),"number"==typeof o.id&&(s.id=o.id),""!==o.name&&(s.attrName=o.name),""!==o.type&&(s.attrType=o.type),this.pushStack(s)}parseNodeAttr(e){let t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let n="",r="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:n,type:r}}parseNodeProperty(e,t,n){let r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),s=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===r&&","===s&&(s=n.replace(/"/g,"").replace(/,$/,"").trim());const o=this.getCurrentNode();if("Properties70"!==o.name){if("C"===r){const l=s.split(",").slice(1),c=parseInt(l[0]),d=parseInt(l[1]);let u=s.split(",").slice(3);u=u.map(function(h){return h.trim().replace(/^"/,"")}),r="connections",s=[c,d],function fge(i,e){for(let t=0,n=i.length,r=e.length;t<r;t++,n++)i[n]=e[t]}(s,u),void 0===o[r]&&(o[r]=[])}"Node"===r&&(o.id=s),r in o&&Array.isArray(o[r])?o[r].push(s):"a"!==r?o[r]=s:o.a=s,this.setCurrentProp(o,r),"a"===r&&","!==s.slice(-1)&&(o.a=iD(s))}else this.parseNodeSpecialProperty(e,r,s)}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=iD(t.a))}parseNodeSpecialProperty(e,t,n){const r=n.split('",').map(function(d){return d.trim().replace(/^\"/,"").replace(/\s/,"_")}),s=r[0],o=r[1],a=r[2],l=r[3];let c=r[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":c=parseFloat(c);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":c=iD(c)}this.getPrevNode()[s]={type:o,type2:a,flag:l,value:c},this.setCurrentProp(this.getPrevNode(),s)}}class lge{parse(e){const t=new xG(e);t.skip(23);const n=t.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const r=new wG;for(;!this.endOfContent(t);){const s=this.parseNode(t,n);null!==s&&r.add(s.name,s)}return r}endOfContent(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const n={},r=t>=7500?e.getUint64():e.getUint32(),s=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const o=e.getUint8(),a=e.getString(o);if(0===r)return null;const l=[];for(let h=0;h<s;h++)l.push(this.parseProperty(e));const c=l.length>0?l[0]:"",d=l.length>1?l[1]:"",u=l.length>2?l[2]:"";for(n.singleProperty=1===s&&e.getOffset()===r;r>e.getOffset();){const h=this.parseNode(e,t);null!==h&&this.parseSubNode(a,n,h)}return n.propertyList=l,"number"==typeof c&&(n.id=c),""!==d&&(n.attrName=d),""!==u&&(n.attrType=u),""!==a&&(n.name=a),n}parseSubNode(e,t,n){if(!0===n.singleProperty){const r=n.propertyList[0];Array.isArray(r)?(t[n.name]=n,n.a=r):t[n.name]=r}else if("Connections"===e&&"C"===n.name){const r=[];n.propertyList.forEach(function(s,o){0!==o&&r.push(s)}),void 0===t.connections&&(t.connections=[]),t.connections.push(r)}else if("Properties70"===n.name)Object.keys(n).forEach(function(s){t[s]=n[s]});else if("Properties70"===e&&"P"===n.name){let r=n.propertyList[0],s=n.propertyList[1];const o=n.propertyList[2],a=n.propertyList[3];let l;0===r.indexOf("Lcl ")&&(r=r.replace("Lcl ","Lcl_")),0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),l="Color"===s||"ColorRGB"===s||"Vector"===s||"Vector3D"===s||0===s.indexOf("Lcl_")?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],t[r]={type:s,type2:o,flag:a,value:l}}else void 0===t[n.name]?"number"==typeof n.id?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:"PoseNode"===n.name?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):void 0===t[n.name][n.id]&&(t[n.name][n.id]=n)}parseProperty(e){const t=e.getString(1);let n;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return n=e.getUint32(),e.getArrayBuffer(n);case"S":return n=e.getUint32(),e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const r=e.getUint32(),s=e.getUint32(),o=e.getUint32();if(0===s)switch(t){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}const a=jc(new Uint8Array(e.getArrayBuffer(o))),l=new xG(a.buffer);switch(t){case"b":case"c":return l.getBooleanArray(r);case"d":return l.getFloat64Array(r);case"f":return l.getFloat32Array(r);case"i":return l.getInt32Array(r);case"l":return l.getInt64Array(r)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class xG{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return 1==(1&this.getUint8())}getBooleanArray(e){const t=[];for(let n=0;n<e;n++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,e=4294967295&~e,4294967295===e&&(t=t+1&4294967295),e=e+1&4294967295,-(4294967296*t+e)):4294967296*t+e}getInt64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){const t=this.offset;let n=new Uint8Array(this.dv.buffer,t,e);this.skip(e);const r=n.indexOf(0);return r>=0&&(n=new Uint8Array(this.dv.buffer,t,r)),this._textDecoder.decode(n)}}class wG{add(e,t){this[e]=t}}function CG(i){const t=i.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function uge(i){return i/46186158e3}const hge=[];function Ow(i,e,t,n){let r;switch(n.mappingType){case"ByPolygonVertex":r=i;break;case"ByPolygon":r=e;break;case"ByVertice":r=t;break;case"AllSame":r=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}"IndexToDirect"===n.referenceType&&(r=n.indices[r]);const s=r*n.dataSize;return function pge(i,e,t,n){for(let r=t,s=0;r<n;r++,s++)i[s]=e[r];return i}(hge,n.buffer,s,s+n.dataSize)}const tD=new ro,qp=new R;function MG(i){const e=new Qe,t=new Qe,n=new Qe,r=new Qe,s=new Qe,o=new Qe,a=new Qe,l=new Qe,c=new Qe,d=new Qe,u=new Qe,h=new Qe,f=i.inheritType?i.inheritType:0;if(i.translation&&e.setPosition(qp.fromArray(i.translation)),i.preRotation){const T=i.preRotation.map(ft.degToRad);T.push(i.eulerOrder||ro.DEFAULT_ORDER),t.makeRotationFromEuler(tD.fromArray(T))}if(i.rotation){const T=i.rotation.map(ft.degToRad);T.push(i.eulerOrder||ro.DEFAULT_ORDER),n.makeRotationFromEuler(tD.fromArray(T))}if(i.postRotation){const T=i.postRotation.map(ft.degToRad);T.push(i.eulerOrder||ro.DEFAULT_ORDER),r.makeRotationFromEuler(tD.fromArray(T)),r.invert()}i.scale&&s.scale(qp.fromArray(i.scale)),i.scalingOffset&&a.setPosition(qp.fromArray(i.scalingOffset)),i.scalingPivot&&o.setPosition(qp.fromArray(i.scalingPivot)),i.rotationOffset&&l.setPosition(qp.fromArray(i.rotationOffset)),i.rotationPivot&&c.setPosition(qp.fromArray(i.rotationPivot)),i.parentMatrixWorld&&(u.copy(i.parentMatrix),d.copy(i.parentMatrixWorld));const m=t.clone().multiply(n).multiply(r),_=new Qe;_.extractRotation(d);const g=new Qe;g.copyPosition(d);const p=g.clone().invert().multiply(d),v=_.clone().invert().multiply(p),b=s,y=new Qe;if(0===f)y.copy(_).multiply(m).multiply(v).multiply(b);else if(1===f)y.copy(_).multiply(v).multiply(m).multiply(b);else{const k=(new Qe).scale((new R).setFromMatrixScale(u)).clone().invert(),U=v.clone().multiply(k);y.copy(_).multiply(m).multiply(U).multiply(b)}const x=c.clone().invert(),w=o.clone().invert();let E=e.clone().multiply(l).multiply(c).multiply(t).multiply(n).multiply(r).multiply(x).multiply(a).multiply(o).multiply(s).multiply(w);const S=(new Qe).copyPosition(E),C=d.clone().multiply(S);return h.copyPosition(C),E=h.clone().multiply(y),E.premultiply(d.invert()),E}function EG(i){const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(i=i||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[i]}function iD(i){return i.split(",").map(function(t){return parseFloat(t)})}function SG(i,e,t){return void 0===e&&(e=0),void 0===t&&(t=i.byteLength),(new TextDecoder).decode(new Uint8Array(i,e,t))}function TG(i,e,t){return i.slice(0,e).concat(t).concat(i.slice(e))}class Uc extends za{constructor(){super(...arguments),this.clazz=nge}}Uc.\u0275fac=function(){let i;return function(t){return(i||(i=le(Uc)))(t||Uc)}}(),Uc.\u0275prov=He({token:Uc,factory:Uc.\u0275fac,providedIn:"root"});class Nw extends Wx{constructor(e){super(),this.service=e}}Nw.\u0275fac=function(e){return new(e||Nw)(I(Uc,16))},Nw.\u0275pipe=_i({name:"loadFBX",type:Nw,pure:!0});class jw extends Su{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}getRefFromResponse(e){return e}}jw.\u0275fac=function(e){return new(e||jw)(I(We,1),I(gt),I(Uc))},jw.\u0275dir=Ne({type:jw,selectors:[["","loadFBX",""]],features:[q]});class Ou extends We{getType(){return L5}set element(e){this._objRef&&(this._objRef.element=e)}get element(){return this._objRef?.element}set center(e){this._objRef&&(this._objRef.center=Ye(this._objRef.center,e))}get center(){return this._objRef?.center}set onBeforeRender(e){this._objRef&&(this._objRef.onBeforeRender=e)}get onBeforeRender(){return this._objRef?.onBeforeRender}set onAfterRender(e){this._objRef&&(this._objRef.onAfterRender=e)}get onAfterRender(){return this._objRef?.onAfterRender}}Ou.\u0275fac=function(){let i;return function(t){return(i||(i=le(Ou)))(t||Ou)}}(),Ou.\u0275cmp=$({type:Ou,selectors:[["th-cSS2DObjectGen"]],inputs:{element:"element",center:"center",onBeforeRender:"onBeforeRender",onAfterRender:"onAfterRender"},features:[ne([{provide:We,useExisting:ae(()=>Ou)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Nu extends Ou{constructor(){super(...arguments),this.elementRef=Et(Ft)}getType(){return L5}createThreeInstance(e){return super.createThreeInstance(e??this.elementRef?.nativeElement)}}Nu.\u0275fac=function(){let i;return function(t){return(i||(i=le(Nu)))(t||Nu)}}(),Nu.\u0275cmp=$({type:Nu,selectors:[["th-cSS2DObject"]],features:[ne([{provide:We,useExisting:ae(()=>Nu)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},styles:["[_nghost-%COMP%]{display:inline-block}"],changeDetection:0});class ju extends We{getType(){return B5}set element(e){this._objRef&&(this._objRef.element=e)}get element(){return this._objRef?.element}set onBeforeRender(e){this._objRef&&(this._objRef.onBeforeRender=e)}get onBeforeRender(){return this._objRef?.onBeforeRender}set onAfterRender(e){this._objRef&&(this._objRef.onAfterRender=e)}get onAfterRender(){return this._objRef?.onAfterRender}}ju.\u0275fac=function(){let i;return function(t){return(i||(i=le(ju)))(t||ju)}}(),ju.\u0275cmp=$({type:ju,selectors:[["th-cSS3DObjectGen"]],inputs:{element:"element",onBeforeRender:"onBeforeRender",onAfterRender:"onAfterRender"},features:[ne([{provide:We,useExisting:ae(()=>ju)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Vc extends ju{constructor(){super(...arguments),this.elementRef=Et(Ft)}getType(){return B5}createThreeInstance(e){return super.createThreeInstance(e??this.elementRef?.nativeElement)}}Vc.\u0275fac=function(){let i;return function(t){return(i||(i=le(Vc)))(t||Vc)}}(),Vc.\u0275cmp=$({type:Vc,selectors:[["th-cSS3DObject"]],features:[ne([{provide:We,useExisting:ae(()=>Vc)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},styles:["[_nghost-%COMP%]{display:inline-block}"],changeDetection:0});const Yr={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor.a *= opacity;\n\n\n\t\t}"};class wn{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const vge=new La(-1,1,1,-1,0,1),nD=new Mt;nD.setAttribute("position",new Ke([-1,3,0,-1,-1,0,3,-1,0],3)),nD.setAttribute("uv",new Ke([0,2,0,0,2,0],2));class xr{constructor(e){this._mesh=new nt(nD,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,vge)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class rD extends wn{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof Pt?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=gi.clone(e.uniforms),this.material=new Pt({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new xr(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class sD extends wn{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){const r=e.getContext(),s=e.state;let o,a;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0),this.inverse?(o=0,a=1):(o=1,a=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),s.buffers.stencil.setClear(a),s.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}}class RG extends wn{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class Age{constructor(e,t){if(this.renderer=e,void 0===t){const n=e.getSize(new fe);this._pixelRatio=e.getPixelRatio(),this._width=n.width,this._height=n.height,(t=new Gt(this._width*this._pixelRatio,this._height*this._pixelRatio)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new rD(Yr),this.clock=new Au}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let n=!1;for(let r=0,s=this.passes.length;r<s;r++){const o=this.passes[r];if(!1!==o.enabled){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),o.needsSwap){if(n){const a=this.renderer.getContext(),l=this.renderer.state.buffers.stencil;l.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),l.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==sD&&(o instanceof sD?n=!0:o instanceof RG&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new fe);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class Yp extends Do{getType(){return Age}set renderer(e){this._objRef&&(this._objRef.renderer=e)}get renderer(){return this._objRef?.renderer}set renderTarget1(e){this._objRef&&(this._objRef.renderTarget1=e)}get renderTarget1(){return this._objRef?.renderTarget1}set renderTarget2(e){this._objRef&&(this._objRef.renderTarget2=e)}get renderTarget2(){return this._objRef?.renderTarget2}set writeBuffer(e){this._objRef&&(this._objRef.writeBuffer=e)}get writeBuffer(){return this._objRef?.writeBuffer}set readBuffer(e){this._objRef&&(this._objRef.readBuffer=e)}get readBuffer(){return this._objRef?.readBuffer}set passes(e){this._objRef&&(this._objRef.passes=e)}get passes(){return this._objRef?.passes}set copyPass(e){this._objRef&&(this._objRef.copyPass=e)}get copyPass(){return this._objRef?.copyPass}set clock(e){this._objRef&&(this._objRef.clock=e)}get clock(){return this._objRef?.clock}set renderToScreen(e){this._objRef&&(this._objRef.renderToScreen=e)}get renderToScreen(){return this._objRef?.renderToScreen}}Yp.\u0275fac=function(){let i;return function(t){return(i||(i=le(Yp)))(t||Yp)}}(),Yp.\u0275cmp=$({type:Yp,selectors:[["th-effectComposerGen"]],inputs:{renderer:"renderer",renderTarget1:"renderTarget1",renderTarget2:"renderTarget2",writeBuffer:"writeBuffer",readBuffer:"readBuffer",passes:"passes",copyPass:"copyPass",clock:"clock",renderToScreen:"renderToScreen"},features:[ne([]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Vl extends Yp{constructor(e,t){super(),this.view=e,this.engineService=t}createThreeInstance(e){return e||(e=new Array(5)),e[0]=e[0]??this.engineService.wegblRenderer,e[1]=e[1]??this.initRenderTarget(),super.createThreeInstance(e)}initRenderTarget(){if(this.view.viewPort){let e,t;return this.view.viewPort instanceof ii?(e=this.view.viewPort.z,t=this.view.viewPort?.width):(e=this.view.viewPort.width,t=this.view.viewPort.height),new Gt(e,t)}}addToParent(){this._objRef&&(this.view.effectComposer=this._objRef)}removeFromParent(){this.view.effectComposer=void 0}}Vl.\u0275fac=function(e){return new(e||Vl)(I(Ds),I(ko))},Vl.\u0275cmp=$({type:Vl,selectors:[["th-effectComposer"]],features:[ne([]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Li extends Do{constructor(e){super(),this.effectComposer=e}addToParent(){this._objRef&&this.effectComposer&&this.effectComposer.objRef&&this.effectComposer.objRef.addPass(this._objRef)}removeFromParent(){this._objRef&&this.effectComposer&&this.effectComposer.objRef&&this.effectComposer.objRef.removePass(this._objRef)}}Li.\u0275fac=function(e){return new(e||Li)(I(Vl,8))},Li.\u0275cmp=$({type:Li,selectors:[["th-abs-control"]],features:[q],decls:0,vars:0,template:function(e,t){},encapsulation:2});class wge extends wn{constructor(e,t,n,r,s){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=void 0!==s?s:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Le}render(e,t,n){const r=e.autoClear;let s,o;e.autoClear=!1,void 0!==this.overrideMaterial&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),s=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,s),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=o),e.autoClear=r}}class Yi extends Li{getType(){return wn}set isPass(e){this._objRef&&(this._objRef.isPass=e)}get isPass(){return this._objRef?.isPass}set enabled(e){this._objRef&&(this._objRef.enabled=e)}get enabled(){return this._objRef?.enabled}set needsSwap(e){this._objRef&&(this._objRef.needsSwap=e)}get needsSwap(){return this._objRef?.needsSwap}set clear(e){this._objRef&&(this._objRef.clear=e)}get clear(){return this._objRef?.clear}set renderToScreen(e){this._objRef&&(this._objRef.renderToScreen=e)}get renderToScreen(){return this._objRef?.renderToScreen}}Yi.\u0275fac=function(){let i;return function(t){return(i||(i=le(Yi)))(t||Yi)}}(),Yi.\u0275cmp=$({type:Yi,selectors:[["th-pass"]],inputs:{isPass:"isPass",enabled:"enabled",needsSwap:"needsSwap",clear:"clear",renderToScreen:"renderToScreen"},features:[ne([{provide:Li,useExisting:ae(()=>Yi)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Uu extends Yi{getType(){return wge}set scene(e){this._objRef&&(this._objRef.scene=e)}get scene(){return this._objRef?.scene}set camera(e){this._objRef&&(this._objRef.camera=e)}get camera(){return this._objRef?.camera}set overrideMaterial(e){this._objRef&&(this._objRef.overrideMaterial=e)}get overrideMaterial(){return this._objRef?.overrideMaterial}set clearColor(e){this._objRef&&(this._objRef.clearColor=Ye(this._objRef.clearColor,e))}get clearColor(){return this._objRef?.clearColor}set clearAlpha(e){this._objRef&&(this._objRef.clearAlpha=e)}get clearAlpha(){return this._objRef?.clearAlpha}set clearDepth(e){this._objRef&&(this._objRef.clearDepth=e)}get clearDepth(){return this._objRef?.clearDepth}}Uu.\u0275fac=function(){let i;return function(t){return(i||(i=le(Uu)))(t||Uu)}}(),Uu.\u0275cmp=$({type:Uu,selectors:[["th-renderPassGen"]],inputs:{scene:"scene",camera:"camera",overrideMaterial:"overrideMaterial",clearColor:"clearColor",clearAlpha:"clearAlpha",clearDepth:"clearDepth"},features:[ne([{provide:Li,useExisting:ae(()=>Uu)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class zc extends Uu{constructor(e,t){super(e),this.effectComposer=e,this.view=t}createThreeInstance(e){return e||(e=new Array(5)),e[0]=e[0]??this.view.scene,e[1]=e[1]??this.view.camera,e[2]=e[2]??this.overrideMaterial,e[3]=e[3]??this.clearColor,e[4]=e[4]??this.clearAlpha,super.createThreeInstance(e)}ngAfterContentChecked(){this._objRef&&(this.view.scene&&this.view.scene.objRef&&(this._objRef.scene=this.view.scene.objRef),this.view.camera&&this.view.camera.objRef&&(this._objRef.camera=this.view.camera.objRef))}}zc.\u0275fac=function(e){return new(e||zc)(I(Vl),I(Ds))},zc.\u0275cmp=$({type:zc,selectors:[["th-renderPass"]],features:[ne([{provide:Li,useExisting:ae(()=>zc)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const Vu=new Mu,Os=new R,Gc=new R,Cn=new xi,IG={X:new R(1,0,0),Y:new R(0,1,0),Z:new R(0,0,1)},oD={type:"change"},DG={type:"mouseDown"},PG={type:"mouseUp",mode:null},kG={type:"objectChange"};class BG extends Qt{constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const n=new Pge;this._gizmo=n,this.add(n);const r=new kge;this._plane=r,this.add(r);const s=this;function o(v,b){let y=b;Object.defineProperty(s,v,{get:function(){return void 0!==y?y:b},set:function(x){y!==x&&(y=x,r[v]=x,n[v]=x,s.dispatchEvent({type:v+"-changed",value:x}),s.dispatchEvent(oD))}}),s[v]=b,r[v]=b,n[v]=b}o("camera",e),o("object",void 0),o("enabled",!0),o("axis",null),o("mode","translate"),o("translationSnap",null),o("rotationSnap",null),o("scaleSnap",null),o("space","world"),o("size",1),o("dragging",!1),o("showX",!0),o("showY",!0),o("showZ",!0);const a=new R,l=new R,c=new xi,d=new xi,u=new R,h=new xi,f=new R,m=new R,_=new R,p=new R;o("worldPosition",a),o("worldPositionStart",l),o("worldQuaternion",c),o("worldQuaternionStart",d),o("cameraPosition",u),o("cameraQuaternion",h),o("pointStart",f),o("pointEnd",m),o("rotationAxis",_),o("rotationAngle",0),o("eye",p),this._offset=new R,this._startNorm=new R,this._endNorm=new R,this._cameraScale=new R,this._parentPosition=new R,this._parentQuaternion=new xi,this._parentQuaternionInv=new xi,this._parentScale=new R,this._worldScaleStart=new R,this._worldQuaternionInv=new xi,this._worldScale=new R,this._positionStart=new R,this._quaternionStart=new xi,this._scaleStart=new R,this._getPointer=Sge.bind(this),this._onPointerDown=Rge.bind(this),this._onPointerHover=Tge.bind(this),this._onPointerMove=Ige.bind(this),this._onPointerUp=Dge.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;Vu.setFromCamera(e,this.camera);const t=aD(this._gizmo.picker[this.mode],Vu);this.axis=t?t.object.name:null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){Vu.setFromCamera(e,this.camera);const t=aD(this._plane,Vu,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,DG.mode=this.mode,this.dispatchEvent(DG)}}pointerMove(e){const t=this.axis,n=this.mode,r=this.object;let s=this.space;if("scale"===n?s="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(s="world"),void 0===r||null===t||!1===this.dragging||-1!==e.button)return;Vu.setFromCamera(e,this.camera);const o=aD(this._plane,Vu,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),"translate"===n)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===s&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===s&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),r.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===s&&(r.position.applyQuaternion(Cn.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this._quaternionStart)),"world"===s&&(r.parent&&r.position.add(Os.setFromMatrixPosition(r.parent.matrixWorld)),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(Os.setFromMatrixPosition(r.parent.matrixWorld))));else if("scale"===n){if(-1!==t.search("XYZ")){let a=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(a*=-1),Gc.set(a,a,a)}else Os.copy(this.pointStart),Gc.copy(this.pointEnd),Os.applyQuaternion(this._worldQuaternionInv),Gc.applyQuaternion(this._worldQuaternionInv),Gc.divide(Os),-1===t.search("X")&&(Gc.x=1),-1===t.search("Y")&&(Gc.y=1),-1===t.search("Z")&&(Gc.z=1);r.scale.copy(this._scaleStart).multiply(Gc),this.scaleSnap&&(-1!==t.search("X")&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===n){this._offset.copy(this.pointEnd).sub(this.pointStart);const a=20/this.worldPosition.distanceTo(Os.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(Os.copy(this.rotationAxis).cross(this.eye))*a):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(IG[t]),Os.copy(IG[t]),"local"===s&&Os.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(Os.cross(this.eye).normalize())*a),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===s&&"E"!==t&&"XYZE"!==t?(r.quaternion.copy(this._quaternionStart),r.quaternion.multiply(Cn.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),r.quaternion.copy(Cn.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(oD),this.dispatchEvent(kG)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(PG.mode=this.mode,this.dispatchEvent(PG)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(oD),this.dispatchEvent(kG),this.pointStart.copy(this.pointEnd))}getRaycaster(){return Vu}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}}function Sge(i){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:i.button};{const e=this.domElement.getBoundingClientRect();return{x:(i.clientX-e.left)/e.width*2-1,y:-(i.clientY-e.top)/e.height*2+1,button:i.button}}}function Tge(i){if(this.enabled)switch(i.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(i))}}function Rge(i){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(i)),this.pointerDown(this._getPointer(i)))}function Ige(i){this.enabled&&this.pointerMove(this._getPointer(i))}function Dge(i){this.enabled&&(this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(i)))}function aD(i,e,t){const n=e.intersectObject(i,!0);for(let r=0;r<n.length;r++)if(n[r].object.visible||t)return n[r];return!1}const Uw=new ro,nn=new R(0,1,0),LG=new R(0,0,0),FG=new Qe,Vw=new xi,zw=new xi,Xa=new R,OG=new Qe,M0=new R(1,0,0),zu=new R(0,1,0),E0=new R(0,0,1),Gw=new R,S0=new R,T0=new R;class Pge extends Qt{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new $n({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new gn({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),n=e.clone();n.opacity=.15;const r=t.clone();r.opacity=.5;const s=e.clone();s.color.setHex(16711680);const o=e.clone();o.color.setHex(65280);const a=e.clone();a.color.setHex(255);const l=e.clone();l.color.setHex(16711680),l.opacity=.5;const c=e.clone();c.color.setHex(65280),c.opacity=.5;const d=e.clone();d.color.setHex(255),d.opacity=.5;const u=e.clone();u.opacity=.25;const h=e.clone();h.color.setHex(16776960),h.opacity=.25,e.clone().color.setHex(16776960);const m=e.clone();m.color.setHex(7895160);const _=new Hn(0,.04,.1,12);_.translate(0,.05,0);const g=new tn(.08,.08,.08);g.translate(0,.04,0);const p=new Mt;p.setAttribute("position",new Ke([0,0,0,1,0,0],3));const v=new Hn(.0075,.0075,.5,3);function b(H,B){const V=new la(H,.0075,3,64,B*Math.PI*2);return V.rotateY(Math.PI/2),V.rotateX(Math.PI/2),V}v.translate(0,.25,0);const x={X:[[new nt(_,s),[.5,0,0],[0,0,-Math.PI/2]],[new nt(_,s),[-.5,0,0],[0,0,Math.PI/2]],[new nt(v,s),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new nt(_,o),[0,.5,0]],[new nt(_,o),[0,-.5,0],[Math.PI,0,0]],[new nt(v,o)]],Z:[[new nt(_,a),[0,0,.5],[Math.PI/2,0,0]],[new nt(_,a),[0,0,-.5],[-Math.PI/2,0,0]],[new nt(v,a),null,[Math.PI/2,0,0]]],XYZ:[[new nt(new aa(.1,0),u.clone()),[0,0,0]]],XY:[[new nt(new tn(.15,.15,.01),d.clone()),[.15,.15,0]]],YZ:[[new nt(new tn(.15,.15,.01),l.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new nt(new tn(.15,.15,.01),c.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},w={X:[[new nt(new Hn(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new nt(new Hn(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new nt(new Hn(.2,0,.6,4),n),[0,.3,0]],[new nt(new Hn(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new nt(new Hn(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new nt(new Hn(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new nt(new aa(.2,0),n)]],XY:[[new nt(new tn(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new nt(new tn(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new nt(new tn(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]]},E={START:[[new nt(new aa(.01,2),r),null,null,null,"helper"]],END:[[new nt(new aa(.01,2),r),null,null,null,"helper"]],DELTA:[[new Gn(function y(){const H=new Mt;return H.setAttribute("position",new Ke([0,0,0,1,1,1],3)),H}(),r),null,null,null,"helper"]],X:[[new Gn(p,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Gn(p,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Gn(p,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},S={XYZE:[[new nt(b(.5,1),m),null,[0,Math.PI/2,0]]],X:[[new nt(b(.5,.5),s)]],Y:[[new nt(b(.5,.5),o),null,[0,0,-Math.PI/2]]],Z:[[new nt(b(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new nt(b(.75,1),h),null,[0,Math.PI/2,0]]]},C={AXIS:[[new Gn(p,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},T={XYZE:[[new nt(new wc(.25,10,8),n)]],X:[[new nt(new la(.5,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new nt(new la(.5,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new nt(new la(.5,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new nt(new la(.75,.1,2,24),n)]]},k={X:[[new nt(g,s),[.5,0,0],[0,0,-Math.PI/2]],[new nt(v,s),[0,0,0],[0,0,-Math.PI/2]],[new nt(g,s),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new nt(g,o),[0,.5,0]],[new nt(v,o)],[new nt(g,o),[0,-.5,0],[0,0,Math.PI]]],Z:[[new nt(g,a),[0,0,.5],[Math.PI/2,0,0]],[new nt(v,a),[0,0,0],[Math.PI/2,0,0]],[new nt(g,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new nt(new tn(.15,.15,.01),d),[.15,.15,0]]],YZ:[[new nt(new tn(.15,.15,.01),l),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new nt(new tn(.15,.15,.01),c),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new nt(new tn(.1,.1,.1),u.clone())]]},U={X:[[new nt(new Hn(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new nt(new Hn(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new nt(new Hn(.2,0,.6,4),n),[0,.3,0]],[new nt(new Hn(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new nt(new Hn(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new nt(new Hn(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new nt(new tn(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new nt(new tn(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new nt(new tn(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new nt(new tn(.2,.2,.2),n),[0,0,0]]]},L={X:[[new Gn(p,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Gn(p,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Gn(p,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function j(H){const B=new Qt;for(const V in H)for(let O=H[V].length;O--;){const Q=H[V][O][0].clone(),oe=H[V][O][1],be=H[V][O][2],de=H[V][O][3],X=H[V][O][4];Q.name=V,Q.tag=X,oe&&Q.position.set(oe[0],oe[1],oe[2]),be&&Q.rotation.set(be[0],be[1],be[2]),de&&Q.scale.set(de[0],de[1],de[2]),Q.updateMatrix();const Y=Q.geometry.clone();Y.applyMatrix4(Q.matrix),Q.geometry=Y,Q.renderOrder=1/0,Q.position.set(0,0,0),Q.rotation.set(0,0,0),Q.scale.set(1,1,1),B.add(Q)}return B}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=j(x)),this.add(this.gizmo.rotate=j(S)),this.add(this.gizmo.scale=j(k)),this.add(this.picker.translate=j(w)),this.add(this.picker.rotate=j(T)),this.add(this.picker.scale=j(U)),this.add(this.helper.translate=j(E)),this.add(this.helper.rotate=j(C)),this.add(this.helper.scale=j(L)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const n="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:zw;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let r=[];r=r.concat(this.picker[this.mode].children),r=r.concat(this.gizmo[this.mode].children),r=r.concat(this.helper[this.mode].children);for(let s=0;s<r.length;s++){const o=r[s];let a;o.visible=!0,o.rotation.set(0,0,0),o.position.copy(this.worldPosition),a=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),o.scale.set(1,1,1).multiplyScalar(a*this.size/4),"helper"!==o.tag?(o.quaternion.copy(n),"translate"===this.mode||"scale"===this.mode?("X"===o.name&&Math.abs(nn.copy(M0).applyQuaternion(n).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Y"===o.name&&Math.abs(nn.copy(zu).applyQuaternion(n).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Z"===o.name&&Math.abs(nn.copy(E0).applyQuaternion(n).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XY"===o.name&&Math.abs(nn.copy(E0).applyQuaternion(n).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"YZ"===o.name&&Math.abs(nn.copy(M0).applyQuaternion(n).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XZ"===o.name&&Math.abs(nn.copy(zu).applyQuaternion(n).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1)):"rotate"===this.mode&&(Vw.copy(n),nn.copy(this.eye).applyQuaternion(Cn.copy(n).invert()),-1!==o.name.search("E")&&o.quaternion.setFromRotationMatrix(FG.lookAt(this.eye,LG,zu)),"X"===o.name&&(Cn.setFromAxisAngle(M0,Math.atan2(-nn.y,nn.z)),Cn.multiplyQuaternions(Vw,Cn),o.quaternion.copy(Cn)),"Y"===o.name&&(Cn.setFromAxisAngle(zu,Math.atan2(nn.x,nn.z)),Cn.multiplyQuaternions(Vw,Cn),o.quaternion.copy(Cn)),"Z"===o.name&&(Cn.setFromAxisAngle(E0,Math.atan2(nn.y,nn.x)),Cn.multiplyQuaternions(Vw,Cn),o.quaternion.copy(Cn))),o.visible=o.visible&&(-1===o.name.indexOf("X")||this.showX),o.visible=o.visible&&(-1===o.name.indexOf("Y")||this.showY),o.visible=o.visible&&(-1===o.name.indexOf("Z")||this.showZ),o.visible=o.visible&&(-1===o.name.indexOf("E")||this.showX&&this.showY&&this.showZ),o.material._color=o.material._color||o.material.color.clone(),o.material._opacity=o.material._opacity||o.material.opacity,o.material.color.copy(o.material._color),o.material.opacity=o.material._opacity,this.enabled&&this.axis&&(o.name===this.axis||this.axis.split("").some(function(l){return o.name===l}))&&(o.material.color.setHex(16776960),o.material.opacity=1)):(o.visible=!1,"AXIS"===o.name?(o.visible=!!this.axis,"X"===this.axis&&(Cn.setFromEuler(Uw.set(0,0,0)),o.quaternion.copy(n).multiply(Cn),Math.abs(nn.copy(M0).applyQuaternion(n).dot(this.eye))>.9&&(o.visible=!1)),"Y"===this.axis&&(Cn.setFromEuler(Uw.set(0,0,Math.PI/2)),o.quaternion.copy(n).multiply(Cn),Math.abs(nn.copy(zu).applyQuaternion(n).dot(this.eye))>.9&&(o.visible=!1)),"Z"===this.axis&&(Cn.setFromEuler(Uw.set(0,Math.PI/2,0)),o.quaternion.copy(n).multiply(Cn),Math.abs(nn.copy(E0).applyQuaternion(n).dot(this.eye))>.9&&(o.visible=!1)),"XYZE"===this.axis&&(Cn.setFromEuler(Uw.set(0,Math.PI/2,0)),nn.copy(this.rotationAxis),o.quaternion.setFromRotationMatrix(FG.lookAt(LG,nn,zu)),o.quaternion.multiply(Cn),o.visible=this.dragging),"E"===this.axis&&(o.visible=!1)):"START"===o.name?(o.position.copy(this.worldPositionStart),o.visible=this.dragging):"END"===o.name?(o.position.copy(this.worldPosition),o.visible=this.dragging):"DELTA"===o.name?(o.position.copy(this.worldPositionStart),o.quaternion.copy(this.worldQuaternionStart),Os.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),Os.applyQuaternion(this.worldQuaternionStart.clone().invert()),o.scale.copy(Os),o.visible=this.dragging):(o.quaternion.copy(n),o.position.copy(this.dragging?this.worldPositionStart:this.worldPosition),this.axis&&(o.visible=-1!==this.axis.search(o.name))))}super.updateMatrixWorld(e)}}class kge extends nt{constructor(){super(new Ac(1e5,1e5,2,2),new $n({visible:!1,wireframe:!0,side:os,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),Gw.copy(M0).applyQuaternion("local"===t?this.worldQuaternion:zw),S0.copy(zu).applyQuaternion("local"===t?this.worldQuaternion:zw),T0.copy(E0).applyQuaternion("local"===t?this.worldQuaternion:zw),nn.copy(S0),this.mode){case"translate":case"scale":switch(this.axis){case"X":nn.copy(this.eye).cross(Gw),Xa.copy(Gw).cross(nn);break;case"Y":nn.copy(this.eye).cross(S0),Xa.copy(S0).cross(nn);break;case"Z":nn.copy(this.eye).cross(T0),Xa.copy(T0).cross(nn);break;case"XY":Xa.copy(T0);break;case"YZ":Xa.copy(Gw);break;case"XZ":nn.copy(T0),Xa.copy(S0);break;case"XYZ":case"E":Xa.set(0,0,0)}break;default:Xa.set(0,0,0)}0===Xa.length()?this.quaternion.copy(this.cameraQuaternion):(OG.lookAt(Os.set(0,0,0),Xa,nn),this.quaternion.setFromRotationMatrix(OG)),super.updateMatrixWorld(e)}}class Gu extends qn{getType(){return BG}set domElement(e){this._objRef&&(this._objRef.domElement=e)}get domElement(){return this._objRef?.domElement}set camera(e){this._objRef&&(this._objRef.camera=e)}get camera(){return this._objRef?.camera}set object(e){this._objRef&&(this._objRef.object=e)}get object(){return this._objRef?.object}set enabled(e){this._objRef&&(this._objRef.enabled=e)}get enabled(){return this._objRef?.enabled}set axis(e){this._objRef&&(this._objRef.axis=e)}get axis(){return this._objRef?.axis}set mode(e){this._objRef&&(this._objRef.mode=e)}get mode(){return this._objRef?.mode}set translationSnap(e){this._objRef&&(this._objRef.translationSnap=e)}get translationSnap(){return this._objRef?.translationSnap}set rotationSnap(e){this._objRef&&(this._objRef.rotationSnap=e)}get rotationSnap(){return this._objRef?.rotationSnap}set space(e){this._objRef&&(this._objRef.space=e)}get space(){return this._objRef?.space}set size(e){this._objRef&&(this._objRef.size=e)}get size(){return this._objRef?.size}set dragging(e){this._objRef&&(this._objRef.dragging=e)}get dragging(){return this._objRef?.dragging}set showX(e){this._objRef&&(this._objRef.showX=e)}get showX(){return this._objRef?.showX}set showY(e){this._objRef&&(this._objRef.showY=e)}get showY(){return this._objRef?.showY}set showZ(e){this._objRef&&(this._objRef.showZ=e)}get showZ(){return this._objRef?.showZ}get isTransformControls(){return this._objRef?.isTransformControls}set mouseButtons(e){this._objRef&&(this._objRef.mouseButtons=e)}get mouseButtons(){return this._objRef?.mouseButtons}}Gu.\u0275fac=function(){let i;return function(t){return(i||(i=le(Gu)))(t||Gu)}}(),Gu.\u0275cmp=$({type:Gu,selectors:[["th-transformControlsGen"]],inputs:{domElement:"domElement",camera:"camera",object:"object",enabled:"enabled",axis:"axis",mode:"mode",translationSnap:"translationSnap",rotationSnap:"rotationSnap",space:"space",size:"size",dragging:"dragging",showX:"showX",showY:"showY",showZ:"showZ",mouseButtons:"mouseButtons"},features:[ne([{provide:qn,useExisting:ae(()=>Gu)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Hu extends Gu{getType(){return BG}set object(e){this._objRef&&(this._objRef.object=e,e?this._objRef.attach(e):this._objRef.detach())}addToParent(){this._objRef&&this.canvas?.scene?.objRef?.add(this._objRef)}removeFromParent(){this._objRef&&this.canvas?.scene?.objRef?.remove(this._objRef)}}Hu.\u0275fac=function(){let i;return function(t){return(i||(i=le(Hu)))(t||Hu)}}(),Hu.\u0275cmp=$({type:Hu,selectors:[["th-transformControls"]],inputs:{object:"object"},features:[ne([{provide:qn,useExisting:ae(()=>Hu)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const lD_uniforms={tDiffuse:{value:null}},lD_vertexShader="\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",lD_fragmentShader="\n\n\t\t#include <common>\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tfloat l = luminance( texel.rgb );\n\n\t\t\tgl_FragColor = vec4( l, l, l, texel.w );\n\n\t\t}",cD_uniforms={tDiffuse:{value:null},averageLuminance:{value:1},luminanceMap:{value:null},maxLuminance:{value:16},minLuminance:{value:.01},middleGrey:{value:.6}},cD_vertexShader="\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",cD_fragmentShader="\n\n\t\t#include <common>\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tuniform float middleGrey;\n\t\tuniform float minLuminance;\n\t\tuniform float maxLuminance;\n\t\t#ifdef ADAPTED_LUMINANCE\n\t\t\tuniform sampler2D luminanceMap;\n\t\t#else\n\t\t\tuniform float averageLuminance;\n\t\t#endif\n\n\t\tvec3 ToneMap( vec3 vColor ) {\n\t\t\t#ifdef ADAPTED_LUMINANCE\n\t\t\t\t// Get the calculated average luminance\n\t\t\t\tfloat fLumAvg = texture2D(luminanceMap, vec2(0.5, 0.5)).r;\n\t\t\t#else\n\t\t\t\tfloat fLumAvg = averageLuminance;\n\t\t\t#endif\n\n\t\t\t// Calculate the luminance of the current pixel\n\t\t\tfloat fLumPixel = luminance( vColor );\n\n\t\t\t// Apply the modified operator (Eq. 4)\n\t\t\tfloat fLumScaled = (fLumPixel * middleGrey) / max( minLuminance, fLumAvg );\n\n\t\t\tfloat fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (maxLuminance * maxLuminance)))) / (1.0 + fLumScaled);\n\t\t\treturn fLumCompressed * vColor;\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tgl_FragColor = vec4( ToneMap( texel.xyz ), texel.w );\n\n\t\t}";class Fge extends wn{constructor(e,t){super(),this.resolution=void 0!==t?t:256,this.needsInit=!0,this.adaptive=void 0===e||!!e,this.luminanceRT=null,this.previousLuminanceRT=null,this.currentLuminanceRT=null;const n=Yr;this.copyUniforms=gi.clone(n.uniforms),this.materialCopy=new Pt({uniforms:this.copyUniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,blending:Kt,depthTest:!1}),this.materialLuminance=new Pt({uniforms:gi.clone(lD_uniforms),vertexShader:lD_vertexShader,fragmentShader:lD_fragmentShader,blending:Kt}),this.adaptLuminanceShader={defines:{MIP_LEVEL_1X1:(Math.log(this.resolution)/Math.log(2)).toFixed(1)},uniforms:{lastLum:{value:null},currentLum:{value:null},minLuminance:{value:.01},delta:{value:.016},tau:{value:1}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D lastLum;\n\t\t\t\tuniform sampler2D currentLum;\n\t\t\t\tuniform float minLuminance;\n\t\t\t\tuniform float delta;\n\t\t\t\tuniform float tau;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec4 lastLum = texture2D( lastLum, vUv, MIP_LEVEL_1X1 );\n\t\t\t\t\tvec4 currentLum = texture2D( currentLum, vUv, MIP_LEVEL_1X1 );\n\n\t\t\t\t\tfloat fLastLum = max( minLuminance, lastLum.r );\n\t\t\t\t\tfloat fCurrentLum = max( minLuminance, currentLum.r );\n\n\t\t\t\t\t//The adaption seems to work better in extreme lighting differences\n\t\t\t\t\t//if the input luminance is squared.\n\t\t\t\t\tfCurrentLum *= fCurrentLum;\n\n\t\t\t\t\t// Adapt the luminance using Pattanaik's technique\n\t\t\t\t\tfloat fAdaptedLum = fLastLum + (fCurrentLum - fLastLum) * (1.0 - exp(-delta * tau));\n\t\t\t\t\t// \"fAdaptedLum = sqrt(fAdaptedLum);\n\t\t\t\t\tgl_FragColor.r = fAdaptedLum;\n\t\t\t\t}"},this.materialAdaptiveLum=new Pt({uniforms:gi.clone(this.adaptLuminanceShader.uniforms),vertexShader:this.adaptLuminanceShader.vertexShader,fragmentShader:this.adaptLuminanceShader.fragmentShader,defines:Object.assign({},this.adaptLuminanceShader.defines),blending:Kt}),this.materialToneMap=new Pt({uniforms:gi.clone(cD_uniforms),vertexShader:cD_vertexShader,fragmentShader:cD_fragmentShader,blending:Kt}),this.fsQuad=new xr(null)}render(e,t,n,r){this.needsInit&&(this.reset(e),this.luminanceRT.texture.type=n.texture.type,this.previousLuminanceRT.texture.type=n.texture.type,this.currentLuminanceRT.texture.type=n.texture.type,this.needsInit=!1),this.adaptive&&(this.fsQuad.material=this.materialLuminance,this.materialLuminance.uniforms.tDiffuse.value=n.texture,e.setRenderTarget(this.currentLuminanceRT),this.fsQuad.render(e),this.fsQuad.material=this.materialAdaptiveLum,this.materialAdaptiveLum.uniforms.delta.value=r,this.materialAdaptiveLum.uniforms.lastLum.value=this.previousLuminanceRT.texture,this.materialAdaptiveLum.uniforms.currentLum.value=this.currentLuminanceRT.texture,e.setRenderTarget(this.luminanceRT),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.luminanceRT.texture,e.setRenderTarget(this.previousLuminanceRT),this.fsQuad.render(e)),this.fsQuad.material=this.materialToneMap,this.materialToneMap.uniforms.tDiffuse.value=n.texture,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}reset(){this.luminanceRT&&this.luminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.luminanceRT=new Gt(this.resolution,this.resolution),this.luminanceRT.texture.name="AdaptiveToneMappingPass.l",this.luminanceRT.texture.generateMipmaps=!1,this.previousLuminanceRT=new Gt(this.resolution,this.resolution),this.previousLuminanceRT.texture.name="AdaptiveToneMappingPass.pl",this.previousLuminanceRT.texture.generateMipmaps=!1,this.currentLuminanceRT=new Gt(this.resolution,this.resolution,{minFilter:Ks,generateMipmaps:!0}),this.currentLuminanceRT.texture.name="AdaptiveToneMappingPass.cl",this.adaptive&&(this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture),this.fsQuad.material=new $n({color:7829367}),this.materialLuminance.needsUpdate=!0,this.materialAdaptiveLum.needsUpdate=!0,this.materialToneMap.needsUpdate=!0}setAdaptive(e){e?(this.adaptive=!0,this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture):(this.adaptive=!1,delete this.materialToneMap.defines.ADAPTED_LUMINANCE,this.materialToneMap.uniforms.luminanceMap.value=null),this.materialToneMap.needsUpdate=!0}setAdaptionRate(e){e&&(this.materialAdaptiveLum.uniforms.tau.value=Math.abs(e))}setMinLuminance(e){e&&(this.materialToneMap.uniforms.minLuminance.value=e,this.materialAdaptiveLum.uniforms.minLuminance.value=e)}setMaxLuminance(e){e&&(this.materialToneMap.uniforms.maxLuminance.value=e)}setAverageLuminance(e){e&&(this.materialToneMap.uniforms.averageLuminance.value=e)}setMiddleGrey(e){e&&(this.materialToneMap.uniforms.middleGrey.value=e)}dispose(){this.luminanceRT&&this.luminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.materialLuminance&&this.materialLuminance.dispose(),this.materialAdaptiveLum&&this.materialAdaptiveLum.dispose(),this.materialCopy&&this.materialCopy.dispose(),this.materialToneMap&&this.materialToneMap.dispose()}}class Xp extends Yi{getType(){return Fge}set adaptive(e){this._objRef&&(this._objRef.adaptive=e)}get adaptive(){return this._objRef?.adaptive}set resolution(e){this._objRef&&(this._objRef.resolution=e)}get resolution(){return this._objRef?.resolution}set needsInit(e){this._objRef&&(this._objRef.needsInit=e)}get needsInit(){return this._objRef?.needsInit}set luminanceRT(e){this._objRef&&(this._objRef.luminanceRT=e)}get luminanceRT(){return this._objRef?.luminanceRT}set previousLuminanceRT(e){this._objRef&&(this._objRef.previousLuminanceRT=e)}get previousLuminanceRT(){return this._objRef?.previousLuminanceRT}set currentLuminanceRT(e){this._objRef&&(this._objRef.currentLuminanceRT=e)}get currentLuminanceRT(){return this._objRef?.currentLuminanceRT}set copyUniforms(e){this._objRef&&(this._objRef.copyUniforms=e)}get copyUniforms(){return this._objRef?.copyUniforms}set materialCopy(e){this._objRef&&(this._objRef.materialCopy=e)}get materialCopy(){return this._objRef?.materialCopy}set materialLuminance(e){this._objRef&&(this._objRef.materialLuminance=e)}get materialLuminance(){return this._objRef?.materialLuminance}set adaptLuminanceShader(e){this._objRef&&(this._objRef.adaptLuminanceShader=e)}get adaptLuminanceShader(){return this._objRef?.adaptLuminanceShader}set materialAdaptiveLum(e){this._objRef&&(this._objRef.materialAdaptiveLum=e)}get materialAdaptiveLum(){return this._objRef?.materialAdaptiveLum}set materialToneMap(e){this._objRef&&(this._objRef.materialToneMap=e)}get materialToneMap(){return this._objRef?.materialToneMap}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}}Xp.\u0275fac=function(){let i;return function(t){return(i||(i=le(Xp)))(t||Xp)}}(),Xp.\u0275cmp=$({type:Xp,selectors:[["th-adaptiveToneMappingPass"]],inputs:{adaptive:"adaptive",resolution:"resolution",needsInit:"needsInit",luminanceRT:"luminanceRT",previousLuminanceRT:"previousLuminanceRT",currentLuminanceRT:"currentLuminanceRT",copyUniforms:"copyUniforms",materialCopy:"materialCopy",materialLuminance:"materialLuminance",adaptLuminanceShader:"adaptLuminanceShader",materialAdaptiveLum:"materialAdaptiveLum",materialToneMap:"materialToneMap",fsQuad:"fsQuad"},features:[ne([{provide:Li,useExisting:ae(()=>Xp)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const Nge={uniforms:{damp:{value:.96},tOld:{value:null},tNew:{value:null}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float damp;\n\n\t\tuniform sampler2D tOld;\n\t\tuniform sampler2D tNew;\n\n\t\tvarying vec2 vUv;\n\n\t\tvec4 when_gt( vec4 x, float y ) {\n\n\t\t\treturn max( sign( x - y ), 0.0 );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvec4 texelOld = texture2D( tOld, vUv );\n\t\t\tvec4 texelNew = texture2D( tNew, vUv );\n\n\t\t\ttexelOld *= damp * when_gt( texelOld, 0.1 );\n\n\t\t\tgl_FragColor = max(texelNew, texelOld);\n\n\t\t}"};class jge extends wn{constructor(e=.96){super(),this.shader=Nge,this.uniforms=gi.clone(this.shader.uniforms),this.uniforms.damp.value=e,this.textureComp=new Gt(window.innerWidth,window.innerHeight,{magFilter:$t}),this.textureOld=new Gt(window.innerWidth,window.innerHeight,{magFilter:$t}),this.compFsMaterial=new Pt({uniforms:this.uniforms,vertexShader:this.shader.vertexShader,fragmentShader:this.shader.fragmentShader}),this.compFsQuad=new xr(this.compFsMaterial),this.copyFsMaterial=new $n,this.copyFsQuad=new xr(this.copyFsMaterial)}render(e,t,n){this.uniforms.tOld.value=this.textureOld.texture,this.uniforms.tNew.value=n.texture,e.setRenderTarget(this.textureComp),this.compFsQuad.render(e),this.copyFsQuad.material.map=this.textureComp.texture,this.renderToScreen?(e.setRenderTarget(null),this.copyFsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.copyFsQuad.render(e));const r=this.textureOld;this.textureOld=this.textureComp,this.textureComp=r}setSize(e,t){this.textureComp.setSize(e,t),this.textureOld.setSize(e,t)}dispose(){this.textureComp.dispose(),this.textureOld.dispose(),this.compFsMaterial.dispose(),this.copyFsMaterial.dispose(),this.compFsQuad.dispose(),this.copyFsQuad.dispose()}}class Zp extends Yi{getType(){return jge}set shader(e){this._objRef&&(this._objRef.shader=e)}get shader(){return this._objRef?.shader}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}get uniforms(){return this._objRef?.uniforms}set textureComp(e){this._objRef&&(this._objRef.textureComp=e)}get textureComp(){return this._objRef?.textureComp}set textureOld(e){this._objRef&&(this._objRef.textureOld=e)}get textureOld(){return this._objRef?.textureOld}set shaderMaterial(e){this._objRef&&(this._objRef.shaderMaterial=e)}get shaderMaterial(){return this._objRef?.shaderMaterial}set compFsQuad(e){this._objRef&&(this._objRef.compFsQuad=e)}get compFsQuad(){return this._objRef?.compFsQuad}set copyFsQuad(e){this._objRef&&(this._objRef.copyFsQuad=e)}get copyFsQuad(){return this._objRef?.copyFsQuad}}Zp.\u0275fac=function(){let i;return function(t){return(i||(i=le(Zp)))(t||Zp)}}(),Zp.\u0275cmp=$({type:Zp,selectors:[["th-afterimagePass"]],inputs:{shader:"shader",uniforms:"uniforms",textureComp:"textureComp",textureOld:"textureOld",shaderMaterial:"shaderMaterial",compFsQuad:"compFsQuad",copyFsQuad:"copyFsQuad"},features:[ne([{provide:Li,useExisting:ae(()=>Zp)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Hc extends ao{getType(){return Ob}get isLightProbe(){return this._objRef?.isLightProbe}set sh(e){this._objRef&&(this._objRef.sh=Ye(this._objRef.sh,e))}get sh(){return this._objRef?.sh}}Hc.\u0275fac=function(){let i;return function(t){return(i||(i=le(Hc)))(t||Hc)}}(),Hc.\u0275cmp=$({type:Hc,selectors:[["th-lightProbe"]],inputs:{sh:"sh"},features:[ne([{provide:We,useExisting:ae(()=>Hc)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Kp extends Hc{getType(){return Y4}get isAmbientLightProbe(){return this._objRef?.isAmbientLightProbe}}Kp.\u0275fac=function(){let i;return function(t){return(i||(i=le(Kp)))(t||Kp)}}(),Kp.\u0275cmp=$({type:Kp,selectors:[["th-ambientLightProbe"]],features:[ne([{provide:We,useExisting:ae(()=>Kp)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const kt={IDLE:Symbol(),ROTATE:Symbol(),PAN:Symbol(),SCALE:Symbol(),FOV:Symbol(),FOCUS:Symbol(),ZROTATE:Symbol(),TOUCH_MULTI:Symbol(),ANIMATION_FOCUS:Symbol(),ANIMATION_ROTATE:Symbol()},Xi={NONE:Symbol(),ONE_FINGER:Symbol(),ONE_FINGER_SWITCHED:Symbol(),TWO_FINGER:Symbol(),MULT_FINGER:Symbol(),CURSOR:Symbol()},ni={x:0,y:0},ho={camera:new Qe,gizmos:new Qe},cn={type:"change"},pa={type:"start"},No={type:"end"},Gge=new Mu,ur=new R,NG=new Qe,jG=new Qe,ma=new R;class Hge extends as{constructor(e,t,n=null){super(),this.camera=null,this.domElement=t,this.scene=n,this.target=new R,this._currentTarget=new R,this.radiusFactor=.67,this.mouseActions=[],this._mouseOp=null,this._v2_1=new fe,this._v3_1=new R,this._v3_2=new R,this._m4_1=new Qe,this._m4_2=new Qe,this._quat=new xi,this._translationMatrix=new Qe,this._rotationMatrix=new Qe,this._scaleMatrix=new Qe,this._rotationAxis=new R,this._cameraMatrixState=new Qe,this._cameraProjectionState=new Qe,this._fovState=1,this._upState=new R,this._zoomState=1,this._nearPos=0,this._farPos=0,this._gizmoMatrixState=new Qe,this._up0=new R,this._zoom0=1,this._fov0=0,this._initialNear=0,this._nearPos0=0,this._initialFar=0,this._farPos0=0,this._cameraMatrixState0=new Qe,this._gizmoMatrixState0=new Qe,this._button=-1,this._touchStart=[],this._touchCurrent=[],this._input=Xi.NONE,this._switchSensibility=32,this._startFingerDistance=0,this._currentFingerDistance=0,this._startFingerRotation=0,this._currentFingerRotation=0,this._devPxRatio=0,this._downValid=!0,this._nclicks=0,this._downEvents=[],this._downStart=0,this._clickStart=0,this._maxDownTime=250,this._maxInterval=300,this._posThreshold=24,this._movementThreshold=24,this._currentCursorPosition=new R,this._startCursorPosition=new R,this._grid=null,this._gridPosition=new R,this._gizmos=new Es,this._curvePts=128,this._timeStart=-1,this._animationId=-1,this.focusAnimationTime=500,this._timePrev=0,this._timeCurrent=0,this._anglePrev=0,this._angleCurrent=0,this._cursorPosPrev=new R,this._cursorPosCurr=new R,this._wPrev=0,this._wCurr=0,this.adjustNearFar=!1,this.scaleFactor=1.1,this.dampingFactor=25,this.wMax=20,this.enableAnimations=!0,this.enableGrid=!1,this.cursorZoom=!1,this.minFov=5,this.maxFov=90,this.enabled=!0,this.enablePan=!0,this.enableRotate=!0,this.enableZoom=!0,this.enableGizmos=!0,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this._tbRadius=1,this._state=kt.IDLE,this.setCamera(e),null!=this.scene&&this.scene.add(this._gizmos),this.domElement.style.touchAction="none",this._devPxRatio=window.devicePixelRatio,this.initializeMouseActions(),this._onContextMenu=Wge.bind(this),this._onWheel=Kge.bind(this),this._onPointerUp=Zge.bind(this),this._onPointerMove=Xge.bind(this),this._onPointerDown=Yge.bind(this),this._onPointerCancel=qge.bind(this),this._onWindowResize=Qge.bind(this),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onWheel),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),window.addEventListener("resize",this._onWindowResize)}onSinglePanStart(e,t){if(this.enabled)switch(this.dispatchEvent(pa),this.setCenter(e.clientX,e.clientY),t){case"PAN":if(!this.enablePan)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(cn)),this.updateTbState(kt.PAN,!0),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.camera,ni.x,ni.y,this.domElement)),this.enableGrid&&(this.drawGrid(),this.dispatchEvent(cn));break;case"ROTATE":if(!this.enableRotate)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1),this.updateTbState(kt.ROTATE,!0),this._startCursorPosition.copy(this.unprojectOnTbSurface(this.camera,ni.x,ni.y,this.domElement,this._tbRadius)),this.activateGizmos(!0),this.enableAnimations&&(this._timePrev=this._timeCurrent=performance.now(),this._angleCurrent=this._anglePrev=0,this._cursorPosPrev.copy(this._startCursorPosition),this._cursorPosCurr.copy(this._cursorPosPrev),this._wCurr=0,this._wPrev=this._wCurr),this.dispatchEvent(cn);break;case"FOV":if(!this.camera.isPerspectiveCamera||!this.enableZoom)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(cn)),this.updateTbState(kt.FOV,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(ni.x,ni.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition);break;case"ZOOM":if(!this.enableZoom)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(cn)),this.updateTbState(kt.SCALE,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(ni.x,ni.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition)}}onSinglePanMove(e,t){if(this.enabled){const n=t!=this._state;switch(this.setCenter(e.clientX,e.clientY),t){case kt.PAN:this.enablePan&&(n?(this.dispatchEvent(No),this.dispatchEvent(pa),this.updateTbState(t,!0),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.camera,ni.x,ni.y,this.domElement)),this.enableGrid&&this.drawGrid(),this.activateGizmos(!1)):(this._currentCursorPosition.copy(this.unprojectOnTbPlane(this.camera,ni.x,ni.y,this.domElement)),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition))));break;case kt.ROTATE:if(this.enableRotate)if(n)this.dispatchEvent(No),this.dispatchEvent(pa),this.updateTbState(t,!0),this._startCursorPosition.copy(this.unprojectOnTbSurface(this.camera,ni.x,ni.y,this.domElement,this._tbRadius)),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!0);else{this._currentCursorPosition.copy(this.unprojectOnTbSurface(this.camera,ni.x,ni.y,this.domElement,this._tbRadius));const r=this._startCursorPosition.distanceTo(this._currentCursorPosition),s=this._startCursorPosition.angleTo(this._currentCursorPosition),o=Math.max(r/this._tbRadius,s);this.applyTransformMatrix(this.rotate(this.calculateRotationAxis(this._startCursorPosition,this._currentCursorPosition),o)),this.enableAnimations&&(this._timePrev=this._timeCurrent,this._timeCurrent=performance.now(),this._anglePrev=this._angleCurrent,this._angleCurrent=o,this._cursorPosPrev.copy(this._cursorPosCurr),this._cursorPosCurr.copy(this._currentCursorPosition),this._wPrev=this._wCurr,this._wCurr=this.calculateAngularSpeed(this._anglePrev,this._angleCurrent,this._timePrev,this._timeCurrent))}break;case kt.SCALE:if(this.enableZoom)if(n)this.dispatchEvent(No),this.dispatchEvent(pa),this.updateTbState(t,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(ni.x,ni.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(.5*this.getCursorNDC(ni.x,ni.y,this.domElement).y);const s=this._currentCursorPosition.y-this._startCursorPosition.y;let o=1;s<0?o=1/Math.pow(this.scaleFactor,8*-s):s>0&&(o=Math.pow(this.scaleFactor,8*s)),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState),this.applyTransformMatrix(this.scale(o,this._v3_1))}break;case kt.FOV:if(this.enableZoom&&this.camera.isPerspectiveCamera)if(n)this.dispatchEvent(No),this.dispatchEvent(pa),this.updateTbState(t,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(ni.x,ni.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(.5*this.getCursorNDC(ni.x,ni.y,this.domElement).y);const s=this._currentCursorPosition.y-this._startCursorPosition.y;let o=1;s<0?o=1/Math.pow(this.scaleFactor,8*-s):s>0&&(o=Math.pow(this.scaleFactor,8*s)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);const a=this._v3_1.distanceTo(this._gizmos.position);let l=a/o;l=ft.clamp(l,this.minDistance,this.maxDistance);const c=a*Math.tan(ft.DEG2RAD*this._fovState*.5);let d=ft.RAD2DEG*(2*Math.atan(c/l));d=ft.clamp(d,this.minFov,this.maxFov);const u=c/Math.tan(ft.DEG2RAD*(d/2));o=a/u,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(d),this.applyTransformMatrix(this.scale(o,this._v3_2,!1)),ur.copy(this._gizmos.position).sub(this.camera.position).normalize().multiplyScalar(u/a),this._m4_1.makeTranslation(ur.x,ur.y,ur.z)}}this.dispatchEvent(cn)}}onSinglePanEnd(){if(this._state==kt.ROTATE){if(!this.enableRotate)return;if(this.enableAnimations)if(performance.now()-this._timeCurrent<120){const t=Math.abs((this._wPrev+this._wCurr)/2),n=this;this._animationId=window.requestAnimationFrame(function(r){n.updateTbState(kt.ANIMATION_ROTATE,!0);const s=n.calculateRotationAxis(n._cursorPosPrev,n._cursorPosCurr);n.onRotationAnim(r,s,Math.min(t,n.wMax))})}else this.updateTbState(kt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(cn);else this.updateTbState(kt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(cn)}else(this._state==kt.PAN||this._state==kt.IDLE)&&(this.updateTbState(kt.IDLE,!1),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1),this.dispatchEvent(cn));this.dispatchEvent(No)}onDoubleTap(e){if(this.enabled&&this.enablePan&&null!=this.scene){this.dispatchEvent(pa),this.setCenter(e.clientX,e.clientY);const t=this.unprojectOnObj(this.getCursorNDC(ni.x,ni.y,this.domElement),this.camera);if(null!=t&&this.enableAnimations){const n=this;-1!=this._animationId&&window.cancelAnimationFrame(this._animationId),this._timeStart=-1,this._animationId=window.requestAnimationFrame(function(r){n.updateTbState(kt.ANIMATION_FOCUS,!0),n.onFocusAnim(r,t,n._cameraMatrixState,n._gizmoMatrixState)})}else null!=t&&!this.enableAnimations&&(this.updateTbState(kt.FOCUS,!0),this.focus(t,this.scaleFactor),this.updateTbState(kt.IDLE,!1),this.dispatchEvent(cn))}this.dispatchEvent(No)}onDoublePanStart(){this.enabled&&this.enablePan&&(this.dispatchEvent(pa),this.updateTbState(kt.PAN,!0),this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.camera,ni.x,ni.y,this.domElement,!0)),this._currentCursorPosition.copy(this._startCursorPosition),this.activateGizmos(!1))}onDoublePanMove(){this.enabled&&this.enablePan&&(this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._state!=kt.PAN&&(this.updateTbState(kt.PAN,!0),this._startCursorPosition.copy(this._currentCursorPosition)),this._currentCursorPosition.copy(this.unprojectOnTbPlane(this.camera,ni.x,ni.y,this.domElement,!0)),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition,!0)),this.dispatchEvent(cn))}onDoublePanEnd(){this.updateTbState(kt.IDLE,!1),this.dispatchEvent(No)}onRotateStart(){this.enabled&&this.enableRotate&&(this.dispatchEvent(pa),this.updateTbState(kt.ZROTATE,!0),this._startFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this._currentFingerRotation=this._startFingerRotation,this.camera.getWorldDirection(this._rotationAxis),!this.enablePan&&!this.enableZoom&&this.activateGizmos(!0))}onRotateMove(){if(this.enabled&&this.enableRotate){let e;this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._state!=kt.ZROTATE&&(this.updateTbState(kt.ZROTATE,!0),this._startFingerRotation=this._currentFingerRotation),this._currentFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this.enablePan?(this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),e=this.unprojectOnTbPlane(this.camera,ni.x,ni.y,this.domElement).applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._v3_2)):e=(new R).setFromMatrixPosition(this._gizmoMatrixState),this.applyTransformMatrix(this.zRotate(e,ft.DEG2RAD*(this._startFingerRotation-this._currentFingerRotation))),this.dispatchEvent(cn)}}onRotateEnd(){this.updateTbState(kt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(No)}onPinchStart(){this.enabled&&this.enableZoom&&(this.dispatchEvent(pa),this.updateTbState(kt.SCALE,!0),this._startFingerDistance=this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),this._currentFingerDistance=this._startFingerDistance,this.activateGizmos(!1))}onPinchMove(){if(this.enabled&&this.enableZoom){this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2);const e=12;this._state!=kt.SCALE&&(this._startFingerDistance=this._currentFingerDistance,this.updateTbState(kt.SCALE,!0)),this._currentFingerDistance=Math.max(this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),e*this._devPxRatio);const t=this._currentFingerDistance/this._startFingerDistance;let n;this.enablePan?this.camera.isOrthographicCamera?n=this.unprojectOnTbPlane(this.camera,ni.x,ni.y,this.domElement).applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._gizmos.position):this.camera.isPerspectiveCamera&&(n=this.unprojectOnTbPlane(this.camera,ni.x,ni.y,this.domElement).applyQuaternion(this.camera.quaternion).add(this._gizmos.position)):n=this._gizmos.position,this.applyTransformMatrix(this.scale(t,n)),this.dispatchEvent(cn)}}onPinchEnd(){this.updateTbState(kt.IDLE,!1),this.dispatchEvent(No)}onTriplePanStart(){if(this.enabled&&this.enableZoom){this.dispatchEvent(pa),this.updateTbState(kt.SCALE,!0);let e=0,t=0;const n=this._touchCurrent.length;for(let r=0;r<n;r++)e+=this._touchCurrent[r].clientX,t+=this._touchCurrent[r].clientY;this.setCenter(e/n,t/n),this._startCursorPosition.setY(.5*this.getCursorNDC(ni.x,ni.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition)}}onTriplePanMove(){if(this.enabled&&this.enableZoom){let e=0,t=0;const n=this._touchCurrent.length;for(let h=0;h<n;h++)e+=this._touchCurrent[h].clientX,t+=this._touchCurrent[h].clientY;this.setCenter(e/n,t/n);const r=8;this._currentCursorPosition.setY(.5*this.getCursorNDC(ni.x,ni.y,this.domElement).y);const s=this._currentCursorPosition.y-this._startCursorPosition.y;let o=1;s<0?o=1/Math.pow(this.scaleFactor,-s*r):s>0&&(o=Math.pow(this.scaleFactor,s*r)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);const a=this._v3_1.distanceTo(this._gizmos.position);let l=a/o;l=ft.clamp(l,this.minDistance,this.maxDistance);const c=a*Math.tan(ft.DEG2RAD*this._fovState*.5);let d=ft.RAD2DEG*(2*Math.atan(c/l));d=ft.clamp(d,this.minFov,this.maxFov);const u=c/Math.tan(ft.DEG2RAD*(d/2));o=a/u,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(d),this.applyTransformMatrix(this.scale(o,this._v3_2,!1)),ur.copy(this._gizmos.position).sub(this.camera.position).normalize().multiplyScalar(u/a),this._m4_1.makeTranslation(ur.x,ur.y,ur.z),this.dispatchEvent(cn)}}onTriplePanEnd(){this.updateTbState(kt.IDLE,!1),this.dispatchEvent(No)}setCenter(e,t){ni.x=e,ni.y=t}initializeMouseActions(){this.setMouseAction("PAN",0,"CTRL"),this.setMouseAction("PAN",2),this.setMouseAction("ROTATE",0),this.setMouseAction("ZOOM","WHEEL"),this.setMouseAction("ZOOM",1),this.setMouseAction("FOV","WHEEL","SHIFT"),this.setMouseAction("FOV",1,"SHIFT")}compareMouseAction(e,t){return e.operation==t.operation&&e.mouse==t.mouse&&e.key==t.key}setMouseAction(e,t,n=null){let a;if(!["PAN","ROTATE","ZOOM","FOV"].includes(e)||![0,1,2,"WHEEL"].includes(t)||!["CTRL","SHIFT",null].includes(n)||"WHEEL"==t&&"ZOOM"!=e&&"FOV"!=e)return!1;switch(e){case"PAN":a=kt.PAN;break;case"ROTATE":a=kt.ROTATE;break;case"ZOOM":a=kt.SCALE;break;case"FOV":a=kt.FOV}const l={operation:e,mouse:t,key:n,state:a};for(let c=0;c<this.mouseActions.length;c++)if(this.mouseActions[c].mouse==l.mouse&&this.mouseActions[c].key==l.key)return this.mouseActions.splice(c,1,l),!0;return this.mouseActions.push(l),!0}unsetMouseAction(e,t=null){for(let n=0;n<this.mouseActions.length;n++)if(this.mouseActions[n].mouse==e&&this.mouseActions[n].key==t)return this.mouseActions.splice(n,1),!0;return!1}getOpFromAction(e,t){let n;for(let r=0;r<this.mouseActions.length;r++)if(n=this.mouseActions[r],n.mouse==e&&n.key==t)return n.operation;if(null!=t)for(let r=0;r<this.mouseActions.length;r++)if(n=this.mouseActions[r],n.mouse==e&&null==n.key)return n.operation;return null}getOpStateFromAction(e,t){let n;for(let r=0;r<this.mouseActions.length;r++)if(n=this.mouseActions[r],n.mouse==e&&n.key==t)return n.state;if(null!=t)for(let r=0;r<this.mouseActions.length;r++)if(n=this.mouseActions[r],n.mouse==e&&null==n.key)return n.state;return null}getAngle(e,t){return 180*Math.atan2(t.clientY-e.clientY,t.clientX-e.clientX)/Math.PI}updateTouchEvent(e){for(let t=0;t<this._touchCurrent.length;t++)if(this._touchCurrent[t].pointerId==e.pointerId){this._touchCurrent.splice(t,1,e);break}}applyTransformMatrix(e){if(null!=e.camera&&(this._m4_1.copy(this._cameraMatrixState).premultiply(e.camera),this._m4_1.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.updateMatrix(),(this._state==kt.ROTATE||this._state==kt.ZROTATE||this._state==kt.ANIMATION_ROTATE)&&this.camera.up.copy(this._upState).applyQuaternion(this.camera.quaternion)),null!=e.gizmos&&(this._m4_1.copy(this._gizmoMatrixState).premultiply(e.gizmos),this._m4_1.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix()),this._state==kt.SCALE||this._state==kt.FOCUS||this._state==kt.ANIMATION_FOCUS)if(this._tbRadius=this.calculateTbRadius(this.camera),this.adjustNearFar){const t=this.camera.position.distanceTo(this._gizmos.position),n=new io;n.setFromObject(this._gizmos);const r=new Eo;n.getBoundingSphere(r);const s=Math.max(this._nearPos0,r.radius+r.center.length()),a=Math.min(s,t-this._initialNear);this.camera.near=t-a;const l=Math.min(this._farPos0,-r.radius+r.center.length()),d=Math.min(l,t-this._initialFar);this.camera.far=t-d,this.camera.updateProjectionMatrix()}else{let t=!1;this.camera.near!=this._initialNear&&(this.camera.near=this._initialNear,t=!0),this.camera.far!=this._initialFar&&(this.camera.far=this._initialFar,t=!0),t&&this.camera.updateProjectionMatrix()}}calculateAngularSpeed(e,t,n,r){const o=(r-n)/1e3;return 0==o?0:(t-e)/o}calculatePointersDistance(e,t){return Math.sqrt(Math.pow(t.clientX-e.clientX,2)+Math.pow(t.clientY-e.clientY,2))}calculateRotationAxis(e,t){return this._rotationMatrix.extractRotation(this._cameraMatrixState),this._quat.setFromRotationMatrix(this._rotationMatrix),this._rotationAxis.crossVectors(e,t).applyQuaternion(this._quat),this._rotationAxis.normalize().clone()}calculateTbRadius(e){const t=e.position.distanceTo(this._gizmos.position);if("PerspectiveCamera"==e.type){const n=ft.DEG2RAD*e.fov*.5,r=Math.atan(e.aspect*Math.tan(n));return Math.tan(Math.min(n,r))*t*this.radiusFactor}if("OrthographicCamera"==e.type)return Math.min(e.top,e.right)*this.radiusFactor}focus(e,t,n=1){ur.copy(e).sub(this._gizmos.position).multiplyScalar(n),this._translationMatrix.makeTranslation(ur.x,ur.y,ur.z),NG.copy(this._gizmoMatrixState),this._gizmoMatrixState.premultiply(this._translationMatrix),this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),jG.copy(this._cameraMatrixState),this._cameraMatrixState.premultiply(this._translationMatrix),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.enableZoom&&this.applyTransformMatrix(this.scale(t,this._gizmos.position)),this._gizmoMatrixState.copy(NG),this._cameraMatrixState.copy(jG)}drawGrid(){if(null!=this.scene){let n,r,s,o;if(this.camera.isOrthographicCamera)s=Math.max(this.camera.right-this.camera.left,this.camera.bottom-this.camera.top),o=s/20,n=s/this.camera.zoom*3,r=n/o*this.camera.zoom;else if(this.camera.isPerspectiveCamera){const a=this.camera.position.distanceTo(this._gizmos.position),l=ft.DEG2RAD*this.camera.fov*.5,c=Math.atan(this.camera.aspect*Math.tan(l));s=Math.tan(Math.max(l,c))*a*2,o=s/20,n=3*s,r=n/o}null==this._grid&&(this._grid=new XR(n,r,8947848,8947848),this._grid.position.copy(this._gizmos.position),this._gridPosition.copy(this._grid.position),this._grid.quaternion.copy(this.camera.quaternion),this._grid.rotateX(.5*Math.PI),this.scene.add(this._grid))}}dispose(){-1!=this._animationId&&window.cancelAnimationFrame(this._animationId),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),window.removeEventListener("pointermove",this._onPointerMove),window.removeEventListener("pointerup",this._onPointerUp),window.removeEventListener("resize",this._onWindowResize),null!==this.scene&&this.scene.remove(this._gizmos),this.disposeGrid()}disposeGrid(){null!=this._grid&&null!=this.scene&&(this.scene.remove(this._grid),this._grid=null)}easeOutCubic(e){return 1-Math.pow(1-e,3)}activateGizmos(e){const t=this._gizmos.children[0],n=this._gizmos.children[1],r=this._gizmos.children[2];e?(t.material.setValues({opacity:1}),n.material.setValues({opacity:1}),r.material.setValues({opacity:1})):(t.material.setValues({opacity:.6}),n.material.setValues({opacity:.6}),r.material.setValues({opacity:.6}))}getCursorNDC(e,t,n){const r=n.getBoundingClientRect();return this._v2_1.setX((e-r.left)/r.width*2-1),this._v2_1.setY((r.bottom-t)/r.height*2-1),this._v2_1.clone()}getCursorPosition(e,t,n){return this._v2_1.copy(this.getCursorNDC(e,t,n)),this._v2_1.x*=.5*(this.camera.right-this.camera.left),this._v2_1.y*=.5*(this.camera.top-this.camera.bottom),this._v2_1.clone()}setCamera(e){e.lookAt(this.target),e.updateMatrix(),"PerspectiveCamera"==e.type&&(this._fov0=e.fov,this._fovState=e.fov),this._cameraMatrixState0.copy(e.matrix),this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraProjectionState.copy(e.projectionMatrix),this._zoom0=e.zoom,this._zoomState=this._zoom0,this._initialNear=e.near,this._nearPos0=e.position.distanceTo(this.target)-e.near,this._nearPos=this._initialNear,this._initialFar=e.far,this._farPos0=e.position.distanceTo(this.target)-e.far,this._farPos=this._initialFar,this._up0.copy(e.up),this._upState.copy(e.up),this.camera=e,this.camera.updateProjectionMatrix(),this._tbRadius=this.calculateTbRadius(e),this.makeGizmos(this.target,this._tbRadius)}setGizmosVisible(e){this._gizmos.visible=e,this.dispatchEvent(cn)}setTbRadius(e){this.radiusFactor=e,this._tbRadius=this.calculateTbRadius(this.camera);const n=new xc(0,0,this._tbRadius,this._tbRadius).getPoints(this._curvePts),r=(new Mt).setFromPoints(n);for(const s in this._gizmos.children)this._gizmos.children[s].geometry=r;this.dispatchEvent(cn)}makeGizmos(e,t){const r=new xc(0,0,t,t).getPoints(this._curvePts),s=(new Mt).setFromPoints(r),o=new gn({color:16744576,fog:!1,transparent:!0,opacity:.6}),a=new gn({color:8454016,fog:!1,transparent:!0,opacity:.6}),l=new gn({color:8421631,fog:!1,transparent:!0,opacity:.6}),c=new Gn(s,o),d=new Gn(s,a),u=new Gn(s,l),h=.5*Math.PI;if(c.rotation.x=h,d.rotation.y=h,this._gizmoMatrixState0.identity().setPosition(e),this._gizmoMatrixState.copy(this._gizmoMatrixState0),1!==this.camera.zoom){const f=1/this.camera.zoom;this._scaleMatrix.makeScale(f,f,f),this._translationMatrix.makeTranslation(-e.x,-e.y,-e.z),this._gizmoMatrixState.premultiply(this._translationMatrix).premultiply(this._scaleMatrix),this._translationMatrix.makeTranslation(e.x,e.y,e.z),this._gizmoMatrixState.premultiply(this._translationMatrix)}this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.traverse(function(f){f.isLine&&(f.geometry.dispose(),f.material.dispose())}),this._gizmos.clear(),this._gizmos.add(c),this._gizmos.add(d),this._gizmos.add(u)}onFocusAnim(e,t,n,r){if(-1==this._timeStart&&(this._timeStart=e),this._state==kt.ANIMATION_FOCUS){const o=(e-this._timeStart)/this.focusAnimationTime;if(this._gizmoMatrixState.copy(r),o>=1)this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(t,this.scaleFactor),this._timeStart=-1,this.updateTbState(kt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(cn);else{const a=this.easeOutCubic(o),l=1-a+this.scaleFactor*a;this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(t,l,a),this.dispatchEvent(cn);const c=this;this._animationId=window.requestAnimationFrame(function(d){c.onFocusAnim(d,t,n,r.clone())})}}else this._animationId=-1,this._timeStart=-1}onRotationAnim(e,t,n){if(-1==this._timeStart&&(this._anglePrev=0,this._angleCurrent=0,this._timeStart=e),this._state==kt.ANIMATION_ROTATE){const r=(e-this._timeStart)/1e3;if(n+-this.dampingFactor*r>0){this._angleCurrent=.5*-this.dampingFactor*Math.pow(r,2)+n*r+0,this.applyTransformMatrix(this.rotate(t,this._angleCurrent)),this.dispatchEvent(cn);const o=this;this._animationId=window.requestAnimationFrame(function(a){o.onRotationAnim(a,t,n)})}else this._animationId=-1,this._timeStart=-1,this.updateTbState(kt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(cn)}else this._animationId=-1,this._timeStart=-1,this._state!=kt.ROTATE&&(this.activateGizmos(!1),this.dispatchEvent(cn))}pan(e,t,n=!1){const r=e.clone().sub(t);if(this.camera.isOrthographicCamera)r.multiplyScalar(1/this.camera.zoom);else if(this.camera.isPerspectiveCamera&&n){this._v3_1.setFromMatrixPosition(this._cameraMatrixState0),this._v3_2.setFromMatrixPosition(this._gizmoMatrixState0);const s=this._v3_1.distanceTo(this._v3_2)/this.camera.position.distanceTo(this._gizmos.position);r.multiplyScalar(1/s)}return this._v3_1.set(r.x,r.y,0).applyQuaternion(this.camera.quaternion),this._m4_1.makeTranslation(this._v3_1.x,this._v3_1.y,this._v3_1.z),this.setTransformationMatrices(this._m4_1,this._m4_1),ho}reset(){this.camera.zoom=this._zoom0,this.camera.isPerspectiveCamera&&(this.camera.fov=this._fov0),this.camera.near=this._nearPos,this.camera.far=this._farPos,this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.up.copy(this._up0),this.camera.updateMatrix(),this.camera.updateProjectionMatrix(),this._gizmoMatrixState.copy(this._gizmoMatrixState0),this._gizmoMatrixState0.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix(),this._tbRadius=this.calculateTbRadius(this.camera),this.makeGizmos(this._gizmos.position,this._tbRadius),this.camera.lookAt(this._gizmos.position),this.updateTbState(kt.IDLE,!1),this.dispatchEvent(cn)}rotate(e,t){const n=this._gizmos.position;return this._translationMatrix.makeTranslation(-n.x,-n.y,-n.z),this._rotationMatrix.makeRotationAxis(e,-t),this._m4_1.makeTranslation(n.x,n.y,n.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this.setTransformationMatrices(this._m4_1),ho}copyState(){let e;this.camera.isOrthographicCamera?e=JSON.stringify({arcballState:{cameraFar:this.camera.far,cameraMatrix:this.camera.matrix,cameraNear:this.camera.near,cameraUp:this.camera.up,cameraZoom:this.camera.zoom,gizmoMatrix:this._gizmos.matrix}}):this.camera.isPerspectiveCamera&&(e=JSON.stringify({arcballState:{cameraFar:this.camera.far,cameraFov:this.camera.fov,cameraMatrix:this.camera.matrix,cameraNear:this.camera.near,cameraUp:this.camera.up,cameraZoom:this.camera.zoom,gizmoMatrix:this._gizmos.matrix}})),navigator.clipboard.writeText(e)}pasteState(){const e=this;navigator.clipboard.readText().then(function(n){e.setStateFromJSON(n)})}saveState(){this._cameraMatrixState0.copy(this.camera.matrix),this._gizmoMatrixState0.copy(this._gizmos.matrix),this._nearPos=this.camera.near,this._farPos=this.camera.far,this._zoom0=this.camera.zoom,this._up0.copy(this.camera.up),this.camera.isPerspectiveCamera&&(this._fov0=this.camera.fov)}scale(e,t,n=!0){ma.copy(t);let r=1/e;if(this.camera.isOrthographicCamera){this.camera.zoom=this._zoomState,this.camera.zoom*=e,this.camera.zoom>this.maxZoom?(this.camera.zoom=this.maxZoom,r=this._zoomState/this.maxZoom):this.camera.zoom<this.minZoom&&(this.camera.zoom=this.minZoom,r=this._zoomState/this.minZoom),this.camera.updateProjectionMatrix(),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState),this._scaleMatrix.makeScale(r,r,r),this._translationMatrix.makeTranslation(-this._v3_1.x,-this._v3_1.y,-this._v3_1.z),this._m4_2.makeTranslation(this._v3_1.x,this._v3_1.y,this._v3_1.z).multiply(this._scaleMatrix),this._m4_2.multiply(this._translationMatrix),ma.sub(this._v3_1);const s=ma.clone().multiplyScalar(r);return ma.sub(s),this._m4_1.makeTranslation(ma.x,ma.y,ma.z),this._m4_2.premultiply(this._m4_1),this.setTransformationMatrices(this._m4_1,this._m4_2),ho}if(this.camera.isPerspectiveCamera){this._v3_1.setFromMatrixPosition(this._cameraMatrixState),this._v3_2.setFromMatrixPosition(this._gizmoMatrixState);let s=this._v3_1.distanceTo(ma),o=s-s*r;const a=s-o;if(a<this.minDistance?(r=this.minDistance/s,o=s-s*r):a>this.maxDistance&&(r=this.maxDistance/s,o=s-s*r),ur.copy(ma).sub(this._v3_1).normalize().multiplyScalar(o),this._m4_1.makeTranslation(ur.x,ur.y,ur.z),n){const l=this._v3_2;s=l.distanceTo(ma),o=s-s*r,ur.copy(ma).sub(this._v3_2).normalize().multiplyScalar(o),this._translationMatrix.makeTranslation(l.x,l.y,l.z),this._scaleMatrix.makeScale(r,r,r),this._m4_2.makeTranslation(ur.x,ur.y,ur.z).multiply(this._translationMatrix),this._m4_2.multiply(this._scaleMatrix),this._translationMatrix.makeTranslation(-l.x,-l.y,-l.z),this._m4_2.multiply(this._translationMatrix),this.setTransformationMatrices(this._m4_1,this._m4_2)}else this.setTransformationMatrices(this._m4_1);return ho}}setFov(e){this.camera.isPerspectiveCamera&&(this.camera.fov=ft.clamp(e,this.minFov,this.maxFov),this.camera.updateProjectionMatrix())}setTransformationMatrices(e=null,t=null){null!=e?null!=ho.camera?ho.camera.copy(e):ho.camera=e.clone():ho.camera=null,null!=t?null!=ho.gizmos?ho.gizmos.copy(t):ho.gizmos=t.clone():ho.gizmos=null}zRotate(e,t){return this._rotationMatrix.makeRotationAxis(this._rotationAxis,t),this._translationMatrix.makeTranslation(-e.x,-e.y,-e.z),this._m4_1.makeTranslation(e.x,e.y,e.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState).sub(e),this._v3_2.copy(this._v3_1).applyAxisAngle(this._rotationAxis,t),this._v3_2.sub(this._v3_1),this._m4_2.makeTranslation(this._v3_2.x,this._v3_2.y,this._v3_2.z),this.setTransformationMatrices(this._m4_1,this._m4_2),ho}getRaycaster(){return Gge}unprojectOnObj(e,t){const n=this.getRaycaster();n.near=t.near,n.far=t.far,n.setFromCamera(e,t);const r=n.intersectObjects(this.scene.children,!0);for(let s=0;s<r.length;s++)if(r[s].object.uuid!=this._gizmos.uuid&&null!=r[s].face)return r[s].point.clone();return null}unprojectOnTbSurface(e,t,n,r,s){if("OrthographicCamera"==e.type){this._v2_1.copy(this.getCursorPosition(t,n,r)),this._v3_1.set(this._v2_1.x,this._v2_1.y,0);const o=Math.pow(this._v2_1.x,2),a=Math.pow(this._v2_1.y,2),l=Math.pow(this._tbRadius,2);return this._v3_1.setZ(o+a<=.5*l?Math.sqrt(l-(o+a)):.5*l/Math.sqrt(o+a)),this._v3_1}if("PerspectiveCamera"==e.type){this._v2_1.copy(this.getCursorNDC(t,n,r)),this._v3_1.set(this._v2_1.x,this._v2_1.y,-1),this._v3_1.applyMatrix4(e.projectionMatrixInverse);const o=this._v3_1.clone().normalize(),a=e.position.distanceTo(this._gizmos.position),l=Math.pow(s,2),c=this._v3_1.z,d=Math.sqrt(Math.pow(this._v3_1.x,2)+Math.pow(this._v3_1.y,2));if(0==d)return o.set(this._v3_1.x,this._v3_1.y,s),o;const u=c/d,h=a;let f=Math.pow(u,2)+1,m=2*u*h,_=Math.pow(h,2)-l,g=Math.pow(m,2)-4*f*_;if(g>=0&&(this._v2_1.setX((-m-Math.sqrt(g))/(2*f)),this._v2_1.setY(u*this._v2_1.x+h),ft.RAD2DEG*this._v2_1.angle()>=45)){const b=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(a-this._v2_1.y,2));return o.multiplyScalar(b),o.z+=a,o}f=u,m=h,_=.5*-l,g=Math.pow(m,2)-4*f*_,this._v2_1.setX((-m-Math.sqrt(g))/(2*f)),this._v2_1.setY(u*this._v2_1.x+h);const p=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(a-this._v2_1.y,2));return o.multiplyScalar(p),o.z+=a,o}}unprojectOnTbPlane(e,t,n,r,s=!1){if("OrthographicCamera"==e.type)return this._v2_1.copy(this.getCursorPosition(t,n,r)),this._v3_1.set(this._v2_1.x,this._v2_1.y,0),this._v3_1.clone();if("PerspectiveCamera"==e.type){this._v2_1.copy(this.getCursorNDC(t,n,r)),this._v3_1.set(this._v2_1.x,this._v2_1.y,-1),this._v3_1.applyMatrix4(e.projectionMatrixInverse);const o=this._v3_1.clone().normalize(),a=this._v3_1.z,l=Math.sqrt(Math.pow(this._v3_1.x,2)+Math.pow(this._v3_1.y,2));let c;if(c=s?this._v3_1.setFromMatrixPosition(this._cameraMatrixState0).distanceTo(this._v3_2.setFromMatrixPosition(this._gizmoMatrixState0)):e.position.distanceTo(this._gizmos.position),0==l)return o.set(0,0,0),o;const h=-c/(a/l),f=Math.sqrt(Math.pow(c,2)+Math.pow(h,2));return o.multiplyScalar(f),o.z=0,o}}updateMatrixState(){this._cameraMatrixState.copy(this.camera.matrix),this._gizmoMatrixState.copy(this._gizmos.matrix),this.camera.isOrthographicCamera?(this._cameraProjectionState.copy(this.camera.projectionMatrix),this.camera.updateProjectionMatrix(),this._zoomState=this.camera.zoom):this.camera.isPerspectiveCamera&&(this._fovState=this.camera.fov)}updateTbState(e,t){this._state=e,t&&this.updateMatrixState()}update(){if(!1===this.target.equals(this._currentTarget)&&(this._gizmos.position.copy(this.target),this._tbRadius=this.calculateTbRadius(this.camera),this.makeGizmos(this.target,this._tbRadius),this._currentTarget.copy(this.target)),this.camera.isOrthographicCamera){if(this.camera.zoom>this.maxZoom||this.camera.zoom<this.minZoom){const t=ft.clamp(this.camera.zoom,this.minZoom,this.maxZoom);this.applyTransformMatrix(this.scale(t/this.camera.zoom,this._gizmos.position,!0))}}else if(this.camera.isPerspectiveCamera){const t=this.camera.position.distanceTo(this._gizmos.position);if(t>this.maxDistance+1e-6||t<this.minDistance-1e-6){const r=ft.clamp(t,this.minDistance,this.maxDistance);this.applyTransformMatrix(this.scale(r/t,this._gizmos.position)),this.updateMatrixState()}(this.camera.fov<this.minFov||this.camera.fov>this.maxFov)&&(this.camera.fov=ft.clamp(this.camera.fov,this.minFov,this.maxFov),this.camera.updateProjectionMatrix());const n=this._tbRadius;if(this._tbRadius=this.calculateTbRadius(this.camera),n<this._tbRadius-1e-6||n>this._tbRadius+1e-6){const s=this._tbRadius/((this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3),a=new xc(0,0,s,s).getPoints(this._curvePts),l=(new Mt).setFromPoints(a);for(const c in this._gizmos.children)this._gizmos.children[c].geometry=l}}this.camera.lookAt(this._gizmos.position)}setStateFromJSON(e){const t=JSON.parse(e);if(null!=t.arcballState){this._cameraMatrixState.fromArray(t.arcballState.cameraMatrix.elements),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.up.copy(t.arcballState.cameraUp),this.camera.near=t.arcballState.cameraNear,this.camera.far=t.arcballState.cameraFar,this.camera.zoom=t.arcballState.cameraZoom,this.camera.isPerspectiveCamera&&(this.camera.fov=t.arcballState.cameraFov),this._gizmoMatrixState.fromArray(t.arcballState.gizmoMatrix.elements),this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.camera.updateMatrix(),this.camera.updateProjectionMatrix(),this._gizmos.updateMatrix(),this._tbRadius=this.calculateTbRadius(this.camera);const n=(new Qe).copy(this._gizmoMatrixState0);this.makeGizmos(this._gizmos.position,this._tbRadius),this._gizmoMatrixState0.copy(n),this.camera.lookAt(this._gizmos.position),this.updateTbState(kt.IDLE,!1),this.dispatchEvent(cn)}}}function Qge(){const i=(this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3;this._tbRadius=this.calculateTbRadius(this.camera);const e=this._tbRadius/i,n=new xc(0,0,e,e).getPoints(this._curvePts),r=(new Mt).setFromPoints(n);for(const s in this._gizmos.children)this._gizmos.children[s].geometry=r;this.dispatchEvent(cn)}function Wge(i){if(this.enabled)for(let e=0;e<this.mouseActions.length;e++)if(2==this.mouseActions[e].mouse){i.preventDefault();break}}function qge(){this._touchStart.splice(0,this._touchStart.length),this._touchCurrent.splice(0,this._touchCurrent.length),this._input=Xi.NONE}function Yge(i){if(0==i.button&&i.isPrimary?(this._downValid=!0,this._downEvents.push(i),this._downStart=performance.now()):this._downValid=!1,"touch"==i.pointerType&&this._input!=Xi.CURSOR)switch(this._touchStart.push(i),this._touchCurrent.push(i),this._input){case Xi.NONE:this._input=Xi.ONE_FINGER,this.onSinglePanStart(i,"ROTATE"),window.addEventListener("pointermove",this._onPointerMove),window.addEventListener("pointerup",this._onPointerUp);break;case Xi.ONE_FINGER:case Xi.ONE_FINGER_SWITCHED:this._input=Xi.TWO_FINGER,this.onRotateStart(),this.onPinchStart(),this.onDoublePanStart();break;case Xi.TWO_FINGER:this._input=Xi.MULT_FINGER,this.onTriplePanStart(i)}else if("touch"!=i.pointerType&&this._input==Xi.NONE){let e=null;i.ctrlKey||i.metaKey?e="CTRL":i.shiftKey&&(e="SHIFT"),this._mouseOp=this.getOpFromAction(i.button,e),null!=this._mouseOp&&(window.addEventListener("pointermove",this._onPointerMove),window.addEventListener("pointerup",this._onPointerUp),this._input=Xi.CURSOR,this._button=i.button,this.onSinglePanStart(i,this._mouseOp))}}function Xge(i){if("touch"==i.pointerType&&this._input!=Xi.CURSOR)switch(this._input){case Xi.ONE_FINGER:this.updateTouchEvent(i),this.onSinglePanMove(i,kt.ROTATE);break;case Xi.ONE_FINGER_SWITCHED:if(this.calculatePointersDistance(this._touchCurrent[0],i)*this._devPxRatio>=this._switchSensibility){this._input=Xi.ONE_FINGER,this.updateTouchEvent(i),this.onSinglePanStart(i,"ROTATE");break}break;case Xi.TWO_FINGER:this.updateTouchEvent(i),this.onRotateMove(),this.onPinchMove(),this.onDoublePanMove();break;case Xi.MULT_FINGER:this.updateTouchEvent(i),this.onTriplePanMove(i)}else if("touch"!=i.pointerType&&this._input==Xi.CURSOR){let e=null;i.ctrlKey||i.metaKey?e="CTRL":i.shiftKey&&(e="SHIFT");const t=this.getOpStateFromAction(this._button,e);null!=t&&this.onSinglePanMove(i,t)}this._downValid&&this.calculatePointersDistance(this._downEvents[this._downEvents.length-1],i)*this._devPxRatio>this._movementThreshold&&(this._downValid=!1)}function Zge(i){if("touch"==i.pointerType&&this._input!=Xi.CURSOR){const e=this._touchCurrent.length;for(let t=0;t<e;t++)if(this._touchCurrent[t].pointerId==i.pointerId){this._touchCurrent.splice(t,1),this._touchStart.splice(t,1);break}switch(this._input){case Xi.ONE_FINGER:case Xi.ONE_FINGER_SWITCHED:window.removeEventListener("pointermove",this._onPointerMove),window.removeEventListener("pointerup",this._onPointerUp),this._input=Xi.NONE,this.onSinglePanEnd();break;case Xi.TWO_FINGER:this.onDoublePanEnd(i),this.onPinchEnd(i),this.onRotateEnd(i),this._input=Xi.ONE_FINGER_SWITCHED;break;case Xi.MULT_FINGER:0==this._touchCurrent.length&&(window.removeEventListener("pointermove",this._onPointerMove),window.removeEventListener("pointerup",this._onPointerUp),this._input=Xi.NONE,this.onTriplePanEnd())}}else"touch"!=i.pointerType&&this._input==Xi.CURSOR&&(window.removeEventListener("pointermove",this._onPointerMove),window.removeEventListener("pointerup",this._onPointerUp),this._input=Xi.NONE,this.onSinglePanEnd(),this._button=-1);if(i.isPrimary)if(this._downValid)if(i.timeStamp-this._downEvents[this._downEvents.length-1].timeStamp<=this._maxDownTime)if(0==this._nclicks)this._nclicks=1,this._clickStart=performance.now();else{const t=i.timeStamp-this._clickStart,n=this.calculatePointersDistance(this._downEvents[1],this._downEvents[0])*this._devPxRatio;t<=this._maxInterval&&n<=this._posThreshold?(this._nclicks=0,this._downEvents.splice(0,this._downEvents.length),this.onDoubleTap(i)):(this._nclicks=1,this._downEvents.shift(),this._clickStart=performance.now())}else this._downValid=!1,this._nclicks=0,this._downEvents.splice(0,this._downEvents.length);else this._nclicks=0,this._downEvents.splice(0,this._downEvents.length)}function Kge(i){if(this.enabled&&this.enableZoom){let e=null;i.ctrlKey||i.metaKey?e="CTRL":i.shiftKey&&(e="SHIFT");const t=this.getOpFromAction("WHEEL",e);if(null!=t){i.preventDefault(),this.dispatchEvent(pa);const n=125;let r=i.deltaY/n,s=1;switch(r>0?s=1/this.scaleFactor:r<0&&(s=this.scaleFactor),t){case"ZOOM":if(this.updateTbState(kt.SCALE,!0),r>0?s=1/Math.pow(this.scaleFactor,r):r<0&&(s=Math.pow(this.scaleFactor,-r)),this.cursorZoom&&this.enablePan){let o;this.camera.isOrthographicCamera?o=this.unprojectOnTbPlane(this.camera,i.clientX,i.clientY,this.domElement).applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._gizmos.position):this.camera.isPerspectiveCamera&&(o=this.unprojectOnTbPlane(this.camera,i.clientX,i.clientY,this.domElement).applyQuaternion(this.camera.quaternion).add(this._gizmos.position)),this.applyTransformMatrix(this.scale(s,o))}else this.applyTransformMatrix(this.scale(s,this._gizmos.position));null!=this._grid&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(kt.IDLE,!1),this.dispatchEvent(cn),this.dispatchEvent(No);break;case"FOV":if(this.camera.isPerspectiveCamera){this.updateTbState(kt.FOV,!0),0!=i.deltaX&&(r=i.deltaX/n,s=1,r>0?s=1/Math.pow(this.scaleFactor,r):r<0&&(s=Math.pow(this.scaleFactor,-r))),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);const o=this._v3_1.distanceTo(this._gizmos.position);let a=o/s;a=ft.clamp(a,this.minDistance,this.maxDistance);const l=o*Math.tan(ft.DEG2RAD*this.camera.fov*.5);let c=ft.RAD2DEG*(2*Math.atan(l/a));c>this.maxFov?c=this.maxFov:c<this.minFov&&(c=this.minFov),s=o/(l/Math.tan(ft.DEG2RAD*(c/2))),this.setFov(c),this.applyTransformMatrix(this.scale(s,this._gizmos.position,!1))}null!=this._grid&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(kt.IDLE,!1),this.dispatchEvent(cn),this.dispatchEvent(No)}}}}class Qu extends qn{getType(){return Hge}set camera(e){this._objRef&&(this._objRef.camera=e)}get camera(){return this._objRef?.camera}set domElement(e){this._objRef&&(this._objRef.domElement=e)}get domElement(){return this._objRef?.domElement}set scene(e){this._objRef&&(this._objRef.scene=e)}get scene(){return this._objRef?.scene}set focusAnimationTime(e){this._objRef&&(this._objRef.focusAnimationTime=e)}get focusAnimationTime(){return this._objRef?.focusAnimationTime}set enabled(e){this._objRef&&(this._objRef.enabled=e)}get enabled(){return this._objRef?.enabled}set enablePan(e){this._objRef&&(this._objRef.enablePan=e)}get enablePan(){return this._objRef?.enablePan}set enableRotate(e){this._objRef&&(this._objRef.enableRotate=e)}get enableRotate(){return this._objRef?.enableRotate}set enableZoom(e){this._objRef&&(this._objRef.enableZoom=e)}get enableZoom(){return this._objRef?.enableZoom}set enableGizmos(e){this._objRef&&(this._objRef.enableGizmos=e)}get enableGizmos(){return this._objRef?.enableGizmos}set adjustNearFar(e){this._objRef&&(this._objRef.adjustNearFar=e)}get adjustNearFar(){return this._objRef?.adjustNearFar}set scaleFactor(e){this._objRef&&(this._objRef.scaleFactor=e)}get scaleFactor(){return this._objRef?.scaleFactor}set dampingFactor(e){this._objRef&&(this._objRef.dampingFactor=e)}get dampingFactor(){return this._objRef?.dampingFactor}set wMax(e){this._objRef&&(this._objRef.wMax=e)}get wMax(){return this._objRef?.wMax}set enableAnimations(e){this._objRef&&(this._objRef.enableAnimations=e)}get enableAnimations(){return this._objRef?.enableAnimations}set enableGrid(e){this._objRef&&(this._objRef.enableGrid=e)}get enableGrid(){return this._objRef?.enableGrid}set cursorZoom(e){this._objRef&&(this._objRef.cursorZoom=e)}get cursorZoom(){return this._objRef?.cursorZoom}set minFov(e){this._objRef&&(this._objRef.minFov=e)}get minFov(){return this._objRef?.minFov}set maxFov(e){this._objRef&&(this._objRef.maxFov=e)}get maxFov(){return this._objRef?.maxFov}set minDistance(e){this._objRef&&(this._objRef.minDistance=e)}get minDistance(){return this._objRef?.minDistance}set maxDistance(e){this._objRef&&(this._objRef.maxDistance=e)}get maxDistance(){return this._objRef?.maxDistance}set minZoom(e){this._objRef&&(this._objRef.minZoom=e)}get minZoom(){return this._objRef?.minZoom}set maxZoom(e){this._objRef&&(this._objRef.maxZoom=e)}get maxZoom(){return this._objRef?.maxZoom}set target(e){this._objRef&&(this._objRef.target=Ye(this._objRef.target,e))}get target(){return this._objRef?.target}set radiusFactor(e){this._objRef&&(this._objRef.radiusFactor=e)}get radiusFactor(){return this._objRef?.radiusFactor}}Qu.\u0275fac=function(){let i;return function(t){return(i||(i=le(Qu)))(t||Qu)}}(),Qu.\u0275cmp=$({type:Qu,selectors:[["th-arcballControls"]],inputs:{camera:"camera",domElement:"domElement",scene:"scene",focusAnimationTime:"focusAnimationTime",enabled:"enabled",enablePan:"enablePan",enableRotate:"enableRotate",enableZoom:"enableZoom",enableGizmos:"enableGizmos",adjustNearFar:"adjustNearFar",scaleFactor:"scaleFactor",dampingFactor:"dampingFactor",wMax:"wMax",enableAnimations:"enableAnimations",enableGrid:"enableGrid",cursorZoom:"cursorZoom",minFov:"minFov",maxFov:"maxFov",minDistance:"minDistance",maxDistance:"maxDistance",minZoom:"minZoom",maxZoom:"maxZoom",target:"target",radiusFactor:"radiusFactor"},features:[ne([{provide:qn,useExisting:ae(()=>Qu)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Wu extends qi{getType(){return nR}get isArrayCamera(){return this._objRef?.isArrayCamera}set cameras(e){this._objRef&&(this._objRef.cameras=e)}get cameras(){return this._objRef?.cameras}}Wu.\u0275fac=function(){let i;return function(t){return(i||(i=le(Wu)))(t||Wu)}}(),Wu.\u0275cmp=$({type:Wu,selectors:[["th-arrayCamera"]],inputs:{cameras:"cameras"},features:[ne([{provide:We,useExisting:ae(()=>Wu)},{provide:Ts,useExisting:ae(()=>Wu)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class $p extends We{getType(){return T5}get type(){return this._objRef?.type}set line(e){this._objRef&&(this._objRef.line=e)}get line(){return this._objRef?.line}set cone(e){this._objRef&&(this._objRef.cone=e)}get cone(){return this._objRef?.cone}}$p.\u0275fac=function(){let i;return function(t){return(i||(i=le($p)))(t||$p)}}(),$p.\u0275cmp=$({type:$p,selectors:[["th-arrowHelper"]],inputs:{line:"line",cone:"cone"},features:[ne([{provide:We,useExisting:ae(()=>$p)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class qu extends We{getType(){return GR}get type(){return this._objRef?.type}set listener(e){this._objRef&&(this._objRef.listener=e)}get listener(){return this._objRef?.listener}set context(e){this._objRef&&(this._objRef.context=e)}get context(){return this._objRef?.context}set gain(e){this._objRef&&(this._objRef.gain=e)}get gain(){return this._objRef?.gain}set autoplay(e){this._objRef&&(this._objRef.autoplay=e)}get autoplay(){return this._objRef?.autoplay}set buffer(e){this._objRef&&(this._objRef.buffer=e)}get buffer(){return this._objRef?.buffer}set detune(e){this._objRef&&(this._objRef.detune=e)}get detune(){return this._objRef?.detune}set loop(e){this._objRef&&(this._objRef.loop=e)}get loop(){return this._objRef?.loop}set loopStart(e){this._objRef&&(this._objRef.loopStart=e)}get loopStart(){return this._objRef?.loopStart}set loopEnd(e){this._objRef&&(this._objRef.loopEnd=e)}get loopEnd(){return this._objRef?.loopEnd}set offset(e){this._objRef&&(this._objRef.offset=e)}get offset(){return this._objRef?.offset}set duration(e){this._objRef&&(this._objRef.duration=e)}get duration(){return this._objRef?.duration}set playbackRate(e){this._objRef&&(this._objRef.playbackRate=e)}get playbackRate(){return this._objRef?.playbackRate}set isPlaying(e){this._objRef&&(this._objRef.isPlaying=e)}get isPlaying(){return this._objRef?.isPlaying}set hasPlaybackControl(e){this._objRef&&(this._objRef.hasPlaybackControl=e)}get hasPlaybackControl(){return this._objRef?.hasPlaybackControl}set sourceType(e){this._objRef&&(this._objRef.sourceType=e)}get sourceType(){return this._objRef?.sourceType}set source(e){this._objRef&&(this._objRef.source=e)}get source(){return this._objRef?.source}set filters(e){this._objRef&&(this._objRef.filters=e)}get filters(){return this._objRef?.filters}}qu.\u0275fac=function(){let i;return function(t){return(i||(i=le(qu)))(t||qu)}}(),qu.\u0275cmp=$({type:qu,selectors:[["th-audio"]],inputs:{listener:"listener",context:"context",gain:"gain",autoplay:"autoplay",buffer:"buffer",detune:"detune",loop:"loop",loopStart:"loopStart",loopEnd:"loopEnd",offset:"offset",duration:"duration",playbackRate:"playbackRate",isPlaying:"isPlaying",hasPlaybackControl:"hasPlaybackControl",sourceType:"sourceType",source:"source",filters:"filters"},features:[ne([{provide:We,useExisting:ae(()=>qu)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Jp extends We{getType(){return e5}get type(){return this._objRef?.type}set context(e){this._objRef&&(this._objRef.context=e)}get context(){return this._objRef?.context}set gain(e){this._objRef&&(this._objRef.gain=e)}get gain(){return this._objRef?.gain}set filter(e){this._objRef&&(this._objRef.filter=e)}get filter(){return this._objRef?.filter}set timeDelta(e){this._objRef&&(this._objRef.timeDelta=e)}get timeDelta(){return this._objRef?.timeDelta}}Jp.\u0275fac=function(){let i;return function(t){return(i||(i=le(Jp)))(t||Jp)}}(),Jp.\u0275cmp=$({type:Jp,selectors:[["th-audioListener"]],inputs:{context:"context",gain:"gain",filter:"filter",timeDelta:"timeDelta"},features:[ne([{provide:We,useExisting:ae(()=>Jp)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class em extends Rs{getType(){return R5}get type(){return this._objRef?.type}}em.\u0275fac=function(){let i;return function(t){return(i||(i=le(em)))(t||em)}}(),em.\u0275cmp=$({type:em,selectors:[["th-axesHelper"]],features:[ne([{provide:We,useExisting:ae(()=>em)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const UG={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new fe(.001953125,0)},cKernel:{value:[]}},vertexShader:"\n\n\t\tuniform vec2 uImageIncrement;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float cKernel[ KERNEL_SIZE_INT ];\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec2 uImageIncrement;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec2 imageCoord = vUv;\n\t\t\tvec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );\n\n\t\t\tfor( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {\n\n\t\t\t\tsum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];\n\t\t\t\timageCoord += uImageIncrement;\n\n\t\t\t}\n\n\t\t\tgl_FragColor = sum;\n\n\t\t}",buildKernel:function(i){let t=2*Math.ceil(3*i)+1;t>25&&(t=25);const n=.5*(t-1),r=new Array(t);let s=0;for(let o=0;o<t;++o)r[o]=r_e(o-n,i),s+=r[o];for(let o=0;o<t;++o)r[o]/=s;return r}};function r_e(i,e){return Math.exp(-i*i/(2*e*e))}class Yu extends wn{constructor(e=1,t=25,n=4){super(),this.renderTargetX=new Gt,this.renderTargetX.texture.name="BloomPass.x",this.renderTargetY=new Gt,this.renderTargetY.texture.name="BloomPass.y",this.combineUniforms=gi.clone(dD.uniforms),this.combineUniforms.strength.value=e,this.materialCombine=new Pt({uniforms:this.combineUniforms,vertexShader:dD.vertexShader,fragmentShader:dD.fragmentShader,blending:xf,transparent:!0});const r=UG;this.convolutionUniforms=gi.clone(r.uniforms),this.convolutionUniforms.uImageIncrement.value=Yu.blurX,this.convolutionUniforms.cKernel.value=UG.buildKernel(n),this.materialConvolution=new Pt({uniforms:this.convolutionUniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,defines:{KERNEL_SIZE_FLOAT:t.toFixed(1),KERNEL_SIZE_INT:t.toFixed(0)}}),this.needsSwap=!1,this.fsQuad=new xr(null)}render(e,t,n,r,s){s&&e.state.buffers.stencil.setTest(!1),this.fsQuad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=n.texture,this.convolutionUniforms.uImageIncrement.value=Yu.blurX,e.setRenderTarget(this.renderTargetX),e.clear(),this.fsQuad.render(e),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=Yu.blurY,e.setRenderTarget(this.renderTargetY),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCombine,this.combineUniforms.tDiffuse.value=this.renderTargetY.texture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(n),this.clear&&e.clear(),this.fsQuad.render(e)}setSize(e,t){this.renderTargetX.setSize(e,t),this.renderTargetY.setSize(e,t)}dispose(){this.renderTargetX.dispose(),this.renderTargetY.dispose(),this.materialCombine.dispose(),this.materialConvolution.dispose(),this.fsQuad.dispose()}}const dD={uniforms:{tDiffuse:{value:null},strength:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float strength;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = strength * texel;\n\n\t\t}"};Yu.blurX=new fe(.001953125,0),Yu.blurY=new fe(0,.001953125);class tm extends Yi{getType(){return Yu}set renderTargetX(e){this._objRef&&(this._objRef.renderTargetX=e)}get renderTargetX(){return this._objRef?.renderTargetX}set renderTargetY(e){this._objRef&&(this._objRef.renderTargetY=e)}get renderTargetY(){return this._objRef?.renderTargetY}set copyUniforms(e){this._objRef&&(this._objRef.copyUniforms=e)}get copyUniforms(){return this._objRef?.copyUniforms}set materialCopy(e){this._objRef&&(this._objRef.materialCopy=e)}get materialCopy(){return this._objRef?.materialCopy}set convolutionUniforms(e){this._objRef&&(this._objRef.convolutionUniforms=e)}get convolutionUniforms(){return this._objRef?.convolutionUniforms}set materialConvolution(e){this._objRef&&(this._objRef.materialConvolution=e)}get materialConvolution(){return this._objRef?.materialConvolution}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}}tm.\u0275fac=function(){let i;return function(t){return(i||(i=le(tm)))(t||tm)}}(),tm.\u0275cmp=$({type:tm,selectors:[["th-bloomPass"]],inputs:{renderTargetX:"renderTargetX",renderTargetY:"renderTargetY",copyUniforms:"copyUniforms",materialCopy:"materialCopy",convolutionUniforms:"convolutionUniforms",materialConvolution:"materialConvolution",fsQuad:"fsQuad"},features:[ne([{provide:Li,useExisting:ae(()=>tm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const o_e={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:.01},nearClip:{value:1},farClip:{value:1e3}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\t#include <common>\n\n\t\tvarying vec2 vUv;\n\n\t\tuniform sampler2D tColor;\n\t\tuniform sampler2D tDepth;\n\n\t\tuniform float maxblur; // max blur amount\n\t\tuniform float aperture; // aperture - bigger values for shallower depth of field\n\n\t\tuniform float nearClip;\n\t\tuniform float farClip;\n\n\t\tuniform float focus;\n\t\tuniform float aspect;\n\n\t\t#include <packing>\n\n\t\tfloat getDepth( const in vec2 screenPosition ) {\n\t\t\t#if DEPTH_PACKING == 1\n\t\t\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );\n\t\t\t#else\n\t\t\treturn texture2D( tDepth, screenPosition ).x;\n\t\t\t#endif\n\t\t}\n\n\t\tfloat getViewZ( const in float depth ) {\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\t\t\treturn perspectiveDepthToViewZ( depth, nearClip, farClip );\n\t\t\t#else\n\t\t\treturn orthographicDepthToViewZ( depth, nearClip, farClip );\n\t\t\t#endif\n\t\t}\n\n\n\t\tvoid main() {\n\n\t\t\tvec2 aspectcorrect = vec2( 1.0, aspect );\n\n\t\t\tfloat viewZ = getViewZ( getDepth( vUv ) );\n\n\t\t\tfloat factor = ( focus + viewZ ); // viewZ is <= 0, so this is a difference equation\n\n\t\t\tvec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );\n\n\t\t\tvec2 dofblur9 = dofblur * 0.9;\n\t\t\tvec2 dofblur7 = dofblur * 0.7;\n\t\t\tvec2 dofblur4 = dofblur * 0.4;\n\n\t\t\tvec4 col = vec4( 0.0 );\n\n\t\t\tcol += texture2D( tColor, vUv.xy );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );\n\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );\n\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );\n\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );\n\n\t\t\tgl_FragColor = col / 41.0;\n\t\t\tgl_FragColor.a = 1.0;\n\n\t\t}"};class a_e extends wn{constructor(e,t,n){super(),this.scene=e,this.camera=t;const r=void 0!==n.focus?n.focus:1,s=void 0!==n.aspect?n.aspect:t.aspect,o=void 0!==n.aperture?n.aperture:.025,a=void 0!==n.maxblur?n.maxblur:1;this.renderTargetDepth=new Gt(1,1,{minFilter:$t,magFilter:$t}),this.renderTargetDepth.texture.name="BokehPass.depth",this.materialDepth=new nu,this.materialDepth.depthPacking=rb,this.materialDepth.blending=Kt;const l=o_e,c=gi.clone(l.uniforms);c.tDepth.value=this.renderTargetDepth.texture,c.focus.value=r,c.aspect.value=s,c.aperture.value=o,c.maxblur.value=a,c.nearClip.value=t.near,c.farClip.value=t.far,this.materialBokeh=new Pt({defines:Object.assign({},l.defines),uniforms:c,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}),this.uniforms=c,this.needsSwap=!1,this.fsQuad=new xr(this.materialBokeh),this._oldClearColor=new Le}render(e,t,n){this.scene.overrideMaterial=this.materialDepth,e.getClearColor(this._oldClearColor);const r=e.getClearAlpha(),s=e.autoClear;e.autoClear=!1,e.setClearColor(16777215),e.setClearAlpha(1),e.setRenderTarget(this.renderTargetDepth),e.clear(),e.render(this.scene,this.camera),this.uniforms.tColor.value=n.texture,this.uniforms.nearClip.value=this.camera.near,this.uniforms.farClip.value=this.camera.far,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),e.clear(),this.fsQuad.render(e)),this.scene.overrideMaterial=null,e.setClearColor(this._oldClearColor),e.setClearAlpha(r),e.autoClear=s}setSize(e,t){this.renderTargetDepth.setSize(e,t)}dispose(){this.renderTargetDepth.dispose(),this.materialDepth.dispose(),this.materialBokeh.dispose(),this.fsQuad.dispose()}}class im extends Yi{getType(){return a_e}set scene(e){this._objRef&&(this._objRef.scene=e)}get scene(){return this._objRef?.scene}set camera(e){this._objRef&&(this._objRef.camera=e)}get camera(){return this._objRef?.camera}set renderTargetColor(e){this._objRef&&(this._objRef.renderTargetColor=e)}get renderTargetColor(){return this._objRef?.renderTargetColor}set renderTargetDepth(e){this._objRef&&(this._objRef.renderTargetDepth=e)}get renderTargetDepth(){return this._objRef?.renderTargetDepth}set materialDepth(e){this._objRef&&(this._objRef.materialDepth=e)}get materialDepth(){return this._objRef?.materialDepth}set materialBokeh(e){this._objRef&&(this._objRef.materialBokeh=e)}get materialBokeh(){return this._objRef?.materialBokeh}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}get uniforms(){return this._objRef?.uniforms}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}set oldClearColor(e){this._objRef&&(this._objRef.oldClearColor=Ye(this._objRef.oldClearColor,e))}get oldClearColor(){return this._objRef?.oldClearColor}}im.\u0275fac=function(){let i;return function(t){return(i||(i=le(im)))(t||im)}}(),im.\u0275cmp=$({type:im,selectors:[["th-bokehPass"]],inputs:{scene:"scene",camera:"camera",renderTargetColor:"renderTargetColor",renderTargetDepth:"renderTargetDepth",materialDepth:"materialDepth",materialBokeh:"materialBokeh",uniforms:"uniforms",fsQuad:"fsQuad",oldClearColor:"oldClearColor"},features:[ne([{provide:Li,useExisting:ae(()=>im)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class nm extends We{getType(){return ru}get isBone(){return this._objRef?.isBone}get type(){return this._objRef?.type}}nm.\u0275fac=function(){let i;return function(t){return(i||(i=le(nm)))(t||nm)}}(),nm.\u0275cmp=$({type:nm,selectors:[["th-bone"]],features:[ne([{provide:We,useExisting:ae(()=>nm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Xu extends Rs{getType(){return M5}get type(){return this._objRef?.type}set box(e){this._objRef&&(this._objRef.box=Ye(this._objRef.box,e))}get box(){return this._objRef?.box}}Xu.\u0275fac=function(){let i;return function(t){return(i||(i=le(Xu)))(t||Xu)}}(),Xu.\u0275cmp=$({type:Xu,selectors:[["th-box3Helper"]],inputs:{box:"box"},features:[ne([{provide:We,useExisting:ae(()=>Xu)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class rm extends Rs{getType(){return C5}get type(){return this._objRef?.type}}rm.\u0275fac=function(){let i;return function(t){return(i||(i=le(rm)))(t||rm)}}(),rm.\u0275cmp=$({type:rm,selectors:[["th-boxHelper"]],features:[ne([{provide:We,useExisting:ae(()=>rm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class h_e extends Mt{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super();const a=e/2,l=t/2,c=n/2,d=e/(r=Math.floor(r)),u=t/(s=Math.floor(s)),h=n/(o=Math.floor(o)),f=[];let m=-a,_=-l,g=-c;for(let p=0;p<=r;p++)f.push(m,-l,-c,m,l,-c),f.push(m,l,-c,m,l,c),f.push(m,l,c,m,-l,c),f.push(m,-l,c,m,-l,-c),m+=d;for(let p=0;p<=s;p++)f.push(-a,_,-c,a,_,-c),f.push(a,_,-c,a,_,c),f.push(a,_,c,-a,_,c),f.push(-a,_,c,-a,_,-c),_+=u;for(let p=0;p<=o;p++)f.push(-a,-l,g,-a,l,g),f.push(-a,l,g,a,l,g),f.push(a,l,g,a,-l,g),f.push(a,-l,g,-a,-l,g),g+=h;this.setAttribute("position",new Ke(f,3))}}class sm extends Rt{getType(){return h_e}}sm.\u0275fac=function(){let i;return function(t){return(i||(i=le(sm)))(t||sm)}}(),sm.\u0275cmp=$({type:sm,selectors:[["th-boxLineGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>sm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class om extends Rs{getType(){return w5}get type(){return this._objRef?.type}set camera(e){this._objRef&&(this._objRef.camera=e)}get camera(){return this._objRef?.camera}set pointMap(e){this._objRef&&(this._objRef.pointMap=e)}get pointMap(){return this._objRef?.pointMap}set matrix(e){this._objRef&&(this._objRef.matrix=Ye(this._objRef.matrix,e))}get matrix(){return this._objRef?.matrix}set matrixAutoUpdate(e){this._objRef&&(this._objRef.matrixAutoUpdate=e)}get matrixAutoUpdate(){return this._objRef?.matrixAutoUpdate}}om.\u0275fac=function(){let i;return function(t){return(i||(i=le(om)))(t||om)}}(),om.\u0275cmp=$({type:om,selectors:[["th-cameraHelper"]],inputs:{camera:"camera",pointMap:"pointMap",matrix:"matrix",matrixAutoUpdate:"matrixAutoUpdate"},features:[ne([{provide:We,useExisting:ae(()=>om)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Br extends Do{}Br.\u0275fac=function(){let i;return function(t){return(i||(i=le(Br)))(t||Br)}}(),Br.\u0275cmp=$({type:Br,selectors:[["th-abs-texture"]],features:[q],decls:0,vars:0,template:function(e,t){},encapsulation:2});class ir extends Br{getType(){return An}get isTexture(){return this._objRef?.isTexture}get id(){return this._objRef?.id}set uuid(e){this._objRef&&(this._objRef.uuid=e)}get uuid(){return this._objRef?.uuid}set name(e){this._objRef&&(this._objRef.name=e)}get name(){return this._objRef?.name}set source(e){this._objRef&&(this._objRef.source=e)}get source(){return this._objRef?.source}set mipmaps(e){this._objRef&&(this._objRef.mipmaps=e)}get mipmaps(){return this._objRef?.mipmaps}set mapping(e){this._objRef&&(this._objRef.mapping=e)}get mapping(){return this._objRef?.mapping}set channel(e){this._objRef&&(this._objRef.channel=e)}get channel(){return this._objRef?.channel}set wrapS(e){this._objRef&&(this._objRef.wrapS=e)}get wrapS(){return this._objRef?.wrapS}set wrapT(e){this._objRef&&(this._objRef.wrapT=e)}get wrapT(){return this._objRef?.wrapT}set magFilter(e){this._objRef&&(this._objRef.magFilter=e)}get magFilter(){return this._objRef?.magFilter}set minFilter(e){this._objRef&&(this._objRef.minFilter=e)}get minFilter(){return this._objRef?.minFilter}set anisotropy(e){this._objRef&&(this._objRef.anisotropy=e)}get anisotropy(){return this._objRef?.anisotropy}set format(e){this._objRef&&(this._objRef.format=e)}get format(){return this._objRef?.format}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set internalFormat(e){this._objRef&&(this._objRef.internalFormat=e)}get internalFormat(){return this._objRef?.internalFormat}set matrix(e){this._objRef&&(this._objRef.matrix=Ye(this._objRef.matrix,e))}get matrix(){return this._objRef?.matrix}set matrixAutoUpdate(e){this._objRef&&(this._objRef.matrixAutoUpdate=e)}get matrixAutoUpdate(){return this._objRef?.matrixAutoUpdate}set offset(e){this._objRef&&(this._objRef.offset=Ye(this._objRef.offset,e))}get offset(){return this._objRef?.offset}set repeat(e){this._objRef&&(this._objRef.repeat=Ye(this._objRef.repeat,e))}get repeat(){return this._objRef?.repeat}set center(e){this._objRef&&(this._objRef.center=Ye(this._objRef.center,e))}get center(){return this._objRef?.center}set rotation(e){this._objRef&&(this._objRef.rotation=e)}get rotation(){return this._objRef?.rotation}set generateMipmaps(e){this._objRef&&(this._objRef.generateMipmaps=e)}get generateMipmaps(){return this._objRef?.generateMipmaps}set premultiplyAlpha(e){this._objRef&&(this._objRef.premultiplyAlpha=e)}get premultiplyAlpha(){return this._objRef?.premultiplyAlpha}set flipY(e){this._objRef&&(this._objRef.flipY=e)}get flipY(){return this._objRef?.flipY}set unpackAlignment(e){this._objRef&&(this._objRef.unpackAlignment=e)}get unpackAlignment(){return this._objRef?.unpackAlignment}set encoding(e){this._objRef&&(this._objRef.encoding=e)}get encoding(){return this._objRef?.encoding}set isRenderTargetTexture(e){this._objRef&&(this._objRef.isRenderTargetTexture=e)}get isRenderTargetTexture(){return this._objRef?.isRenderTargetTexture}set needsPMREMUpdate(e){this._objRef&&(this._objRef.needsPMREMUpdate=e)}get needsPMREMUpdate(){return this._objRef?.needsPMREMUpdate}set userData(e){this._objRef&&(this._objRef.userData=e)}get userData(){return this._objRef?.userData}set version(e){this._objRef&&(this._objRef.version=e)}get version(){return this._objRef?.version}}ir.DEFAULT_ANISOTROPY=An.DEFAULT_ANISOTROPY,ir.DEFAULT_IMAGE=An.DEFAULT_IMAGE,ir.DEFAULT_MAPPING=An.DEFAULT_MAPPING,ir.\u0275fac=function(){let i;return function(t){return(i||(i=le(ir)))(t||ir)}}(),ir.\u0275cmp=$({type:ir,selectors:[["th-texture"]],inputs:{uuid:"uuid",name:"name",source:"source",mipmaps:"mipmaps",mapping:"mapping",channel:"channel",wrapS:"wrapS",wrapT:"wrapT",magFilter:"magFilter",minFilter:"minFilter",anisotropy:"anisotropy",format:"format",type:"type",internalFormat:"internalFormat",matrix:"matrix",matrixAutoUpdate:"matrixAutoUpdate",offset:"offset",repeat:"repeat",center:"center",rotation:"rotation",generateMipmaps:"generateMipmaps",premultiplyAlpha:"premultiplyAlpha",flipY:"flipY",unpackAlignment:"unpackAlignment",encoding:"encoding",isRenderTargetTexture:"isRenderTargetTexture",needsPMREMUpdate:"needsPMREMUpdate",userData:"userData",version:"version"},features:[ne([{provide:Br,useExisting:ae(()=>ir)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class am extends ir{getType(){return wx}get isCanvasTexture(){return this._objRef?.isCanvasTexture}}am.\u0275fac=function(){let i;return function(t){return(i||(i=le(am)))(t||am)}}(),am.\u0275cmp=$({type:am,selectors:[["th-canvasTexture"]],features:[ne([{provide:Br,useExisting:ae(()=>am)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class lm extends Rt{getType(){return fp}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}}lm.\u0275fac=function(){let i;return function(t){return(i||(i=le(lm)))(t||lm)}}(),lm.\u0275cmp=$({type:lm,selectors:[["th-capsuleGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>lm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class cm extends Rt{getType(){return pp}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}}cm.\u0275fac=function(){let i;return function(t){return(i||(i=le(cm)))(t||cm)}}(),cm.\u0275cmp=$({type:cm,selectors:[["th-circleGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>cm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class dm extends Yi{getType(){return RG}}dm.\u0275fac=function(){let i;return function(t){return(i||(i=le(dm)))(t||dm)}}(),dm.\u0275cmp=$({type:dm,selectors:[["th-clearMaskPass"]],features:[ne([{provide:Li,useExisting:ae(()=>dm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class A_e extends wn{constructor(e,t){super(),this.needsSwap=!1,this.clearColor=void 0!==e?e:0,this.clearAlpha=void 0!==t?t:0,this._oldClearColor=new Le}render(e,t,n){let r;this.clearColor&&(e.getClearColor(this._oldClearColor),r=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),e.setRenderTarget(this.renderToScreen?null:n),e.clear(),this.clearColor&&e.setClearColor(this._oldClearColor,r)}}class um extends Yi{getType(){return A_e}set clearColor(e){this._objRef&&(this._objRef.clearColor=e)}get clearColor(){return this._objRef?.clearColor}set clearAlpha(e){this._objRef&&(this._objRef.clearAlpha=e)}get clearAlpha(){return this._objRef?.clearAlpha}}um.\u0275fac=function(){let i;return function(t){return(i||(i=le(um)))(t||um)}}(),um.\u0275cmp=$({type:um,selectors:[["th-clearPass"]],inputs:{clearColor:"clearColor",clearAlpha:"clearAlpha"},features:[ne([{provide:Li,useExisting:ae(()=>um)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Za extends ir{getType(){return Eb}get isCompressedTexture(){return this._objRef?.isCompressedTexture}set mipmaps(e){this._objRef&&(this._objRef.mipmaps=e)}get mipmaps(){return this._objRef?.mipmaps}set format(e){this._objRef&&(this._objRef.format=e)}get format(){return this._objRef?.format}set flipY(e){this._objRef&&(this._objRef.flipY=e)}get flipY(){return this._objRef?.flipY}set generateMipmaps(e){this._objRef&&(this._objRef.generateMipmaps=e)}get generateMipmaps(){return this._objRef?.generateMipmaps}}Za.\u0275fac=function(){let i;return function(t){return(i||(i=le(Za)))(t||Za)}}(),Za.\u0275cmp=$({type:Za,selectors:[["th-compressedTexture"]],inputs:{mipmaps:"mipmaps",format:"format",flipY:"flipY",generateMipmaps:"generateMipmaps"},features:[ne([{provide:Br,useExisting:ae(()=>Za)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class hm extends Za{getType(){return dR}get isCompressedArrayTexture(){return this._objRef?.isCompressedArrayTexture}set wrapR(e){this._objRef&&(this._objRef.wrapR=e)}get wrapR(){return this._objRef?.wrapR}}hm.\u0275fac=function(){let i;return function(t){return(i||(i=le(hm)))(t||hm)}}(),hm.\u0275cmp=$({type:hm,selectors:[["th-compressedArrayTexture"]],inputs:{wrapR:"wrapR"},features:[ne([{provide:Br,useExisting:ae(()=>hm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Zu extends Rt{getType(){return Hn}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}}Zu.\u0275fac=function(){let i;return function(t){return(i||(i=le(Zu)))(t||Zu)}}(),Zu.\u0275cmp=$({type:Zu,selectors:[["th-cylinderGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>Zu)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class fm extends Zu{getType(){return mp}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}}fm.\u0275fac=function(){let i;return function(t){return(i||(i=le(fm)))(t||fm)}}(),fm.\u0275cmp=$({type:fm,selectors:[["th-coneGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>fm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const S_e=new R,VG=new d5,uD=new oo,zG=new R,Qw=new ls;class T_e{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new GG,this.unassigned=new GG,this.vertices=[]}setFromPoints(e){if(e.length>=4){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.vertices.push(new R_e(e[t]));this.compute()}return this}setFromObject(e){const t=[];return e.updateMatrixWorld(!0),e.traverse(function(n){const r=n.geometry;if(void 0!==r){const s=r.attributes.position;if(void 0!==s)for(let o=0,a=s.count;o<a;o++){const l=new R;l.fromBufferAttribute(s,o).applyMatrix4(n.matrixWorld),t.push(l)}}}),this.setFromPoints(t)}containsPoint(e){const t=this.faces;for(let n=0,r=t.length;n<r;n++)if(t[n].distanceToPoint(e)>this.tolerance)return!1;return!0}intersectRay(e,t){const n=this.faces;let r=-1/0,s=1/0;for(let o=0,a=n.length;o<a;o++){const l=n[o],c=l.distanceToPoint(e.origin),d=l.normal.dot(e.direction);if(c>0&&d>=0)return null;const u=0!==d?-c/d:0;if(!(u<=0)&&(d>0?s=Math.min(u,s):r=Math.max(u,r),r>s))return null}return e.at(r!==-1/0?r:s,t),t}intersectsRay(e){return null!==this.intersectRay(e,S_e)}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(e,t){return e.face=t,null===t.outside?this.assigned.append(e):this.assigned.insertBefore(t.outside,e),t.outside=e,this}removeVertexFromFace(e,t){return e===t.outside&&(t.outside=null!==e.next&&e.next.face===t?e.next:null),this.assigned.remove(e),this}removeAllVerticesFromFace(e){if(null!==e.outside){const t=e.outside;let n=e.outside;for(;null!==n.next&&n.next.face===e;)n=n.next;return this.assigned.removeSubList(t,n),t.prev=n.next=null,e.outside=null,t}}deleteFaceVertices(e,t){const n=this.removeAllVerticesFromFace(e);if(void 0!==n)if(void 0===t)this.unassigned.appendChain(n);else{let r=n;do{const s=r.next;t.distanceToPoint(r.point)>this.tolerance?this.addVertexToFace(r,t):this.unassigned.append(r),r=s}while(null!==r)}return this}resolveUnassignedPoints(e){if(!1===this.unassigned.isEmpty()){let t=this.unassigned.first();do{const n=t.next;let r=this.tolerance,s=null;for(let o=0;o<e.length;o++){const a=e[o];if(0===a.mark){const l=a.distanceToPoint(t.point);if(l>r&&(r=l,s=a),r>1e3*this.tolerance)break}}null!==s&&this.addVertexToFace(t,s),t=n}while(null!==t)}return this}computeExtremes(){const e=new R,t=new R,n=[],r=[];for(let s=0;s<3;s++)n[s]=r[s]=this.vertices[0];e.copy(this.vertices[0].point),t.copy(this.vertices[0].point);for(let s=0,o=this.vertices.length;s<o;s++){const a=this.vertices[s],l=a.point;for(let c=0;c<3;c++)l.getComponent(c)<e.getComponent(c)&&(e.setComponent(c,l.getComponent(c)),n[c]=a);for(let c=0;c<3;c++)l.getComponent(c)>t.getComponent(c)&&(t.setComponent(c,l.getComponent(c)),r[c]=a)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(e.x),Math.abs(t.x))+Math.max(Math.abs(e.y),Math.abs(t.y))+Math.max(Math.abs(e.z),Math.abs(t.z))),{min:n,max:r}}computeInitialHull(){const e=this.vertices,t=this.computeExtremes(),n=t.min,r=t.max;let s=0,o=0;for(let h=0;h<3;h++){const f=r[h].point.getComponent(h)-n[h].point.getComponent(h);f>s&&(s=f,o=h)}const a=n[o],l=r[o];let c,d;s=0,VG.set(a.point,l.point);for(let h=0,f=this.vertices.length;h<f;h++){const m=e[h];if(m!==a&&m!==l){VG.closestPointToPoint(m.point,!0,zG);const _=zG.distanceToSquared(m.point);_>s&&(s=_,c=m)}}s=-1,uD.setFromCoplanarPoints(a.point,l.point,c.point);for(let h=0,f=this.vertices.length;h<f;h++){const m=e[h];if(m!==a&&m!==l&&m!==c){const _=Math.abs(uD.distanceToPoint(m.point));_>s&&(s=_,d=m)}}const u=[];if(uD.distanceToPoint(d.point)<0){u.push(ga.create(a,l,c),ga.create(d,l,a),ga.create(d,c,l),ga.create(d,a,c));for(let h=0;h<3;h++){const f=(h+1)%3;u[h+1].getEdge(2).setTwin(u[0].getEdge(f)),u[h+1].getEdge(1).setTwin(u[f+1].getEdge(0))}}else{u.push(ga.create(a,c,l),ga.create(d,a,l),ga.create(d,l,c),ga.create(d,c,a));for(let h=0;h<3;h++){const f=(h+1)%3;u[h+1].getEdge(2).setTwin(u[0].getEdge((3-h)%3)),u[h+1].getEdge(0).setTwin(u[f+1].getEdge(1))}}for(let h=0;h<4;h++)this.faces.push(u[h]);for(let h=0,f=e.length;h<f;h++){const m=e[h];if(m!==a&&m!==l&&m!==c&&m!==d){s=this.tolerance;let _=null;for(let g=0;g<4;g++){const p=this.faces[g].distanceToPoint(m.point);p>s&&(s=p,_=this.faces[g])}null!==_&&this.addVertexToFace(m,_)}}return this}reindexFaces(){const e=[];for(let t=0;t<this.faces.length;t++){const n=this.faces[t];0===n.mark&&e.push(n)}return this.faces=e,this}nextVertexToAdd(){if(!1===this.assigned.isEmpty()){let e,t=0;const n=this.assigned.first().face;let r=n.outside;do{const s=n.distanceToPoint(r.point);s>t&&(t=s,e=r),r=r.next}while(null!==r&&r.face===n);return e}}computeHorizon(e,t,n,r){let s;this.deleteFaceVertices(n),n.mark=1,s=null===t?t=n.getEdge(0):t.next;do{const o=s.twin,a=o.face;0===a.mark&&(a.distanceToPoint(e)>this.tolerance?this.computeHorizon(e,o,a,r):r.push(s)),s=s.next}while(s!==t);return this}addAdjoiningFace(e,t){const n=ga.create(e,t.tail(),t.head());return this.faces.push(n),n.getEdge(-1).setTwin(t.twin),n.getEdge(0)}addNewFaces(e,t){this.newFaces=[];let n=null,r=null;for(let s=0;s<t.length;s++){const a=this.addAdjoiningFace(e,t[s]);null===n?n=a:a.next.setTwin(r),this.newFaces.push(a.face),r=a}return n.next.setTwin(r),this}addVertexToHull(e){const t=[];return this.unassigned.clear(),this.removeVertexFromFace(e,e.face),this.computeHorizon(e.point,null,e.face,t),this.addNewFaces(e,t),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let e;for(this.computeInitialHull();void 0!==(e=this.nextVertexToAdd());)this.addVertexToHull(e);return this.reindexFaces(),this.cleanup(),this}}class ga{constructor(){this.normal=new R,this.midpoint=new R,this.area=0,this.constant=0,this.outside=null,this.mark=0,this.edge=null}static create(e,t,n){const r=new ga,s=new hD(e,r),o=new hD(t,r),a=new hD(n,r);return s.next=a.prev=o,o.next=s.prev=a,a.next=o.prev=s,r.edge=s,r.compute()}getEdge(e){let t=this.edge;for(;e>0;)t=t.next,e--;for(;e<0;)t=t.prev,e++;return t}compute(){const e=this.edge.tail(),t=this.edge.head(),n=this.edge.next.head();return Qw.set(e.point,t.point,n.point),Qw.getNormal(this.normal),Qw.getMidpoint(this.midpoint),this.area=Qw.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(e){return this.normal.dot(e)-this.constant}}class hD{constructor(e,t){this.vertex=e,this.prev=null,this.next=null,this.twin=null,this.face=t}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const e=this.head(),t=this.tail();return null!==t?t.point.distanceTo(e.point):-1}lengthSquared(){const e=this.head(),t=this.tail();return null!==t?t.point.distanceToSquared(e.point):-1}setTwin(e){return this.twin=e,e.twin=this,this}}class R_e{constructor(e){this.point=e,this.prev=null,this.next=null,this.face=null}}class GG{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(e,t){return t.prev=e.prev,t.next=e,null===t.prev?this.head=t:t.prev.next=t,e.prev=t,this}insertAfter(e,t){return t.prev=e,t.next=e.next,null===t.next?this.tail=t:t.next.prev=t,e.next=t,this}append(e){return null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e,this}appendChain(e){for(null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail;null!==e.next;)e=e.next;return this.tail=e,this}remove(e){return null===e.prev?this.head=e.next:e.prev.next=e.next,null===e.next?this.tail=e.prev:e.next.prev=e.prev,this}removeSubList(e,t){return null===e.prev?this.head=t.next:e.prev.next=t.next,null===t.next?this.tail=e.prev:t.next.prev=e.prev,this}isEmpty(){return null===this.head}}class I_e extends Mt{constructor(e=[]){super();const t=[],n=[],s=(new T_e).setFromPoints(e).faces;for(let o=0;o<s.length;o++){const a=s[o];let l=a.edge;do{const c=l.head().point;t.push(c.x,c.y,c.z),n.push(a.normal.x,a.normal.y,a.normal.z),l=l.next}while(l!==a.edge)}this.setAttribute("position",new Ke(t,3)),this.setAttribute("normal",new Ke(n,3))}}class pm extends Rt{getType(){return I_e}}pm.\u0275fac=function(){let i;return function(t){return(i||(i=le(pm)))(t||pm)}}(),pm.\u0275cmp=$({type:pm,selectors:[["th-convexGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>pm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class mm extends We{getType(){return XT}get type(){return this._objRef?.type}set renderTarget(e){this._objRef&&(this._objRef.renderTarget=e)}get renderTarget(){return this._objRef?.renderTarget}}mm.\u0275fac=function(){let i;return function(t){return(i||(i=le(mm)))(t||mm)}}(),mm.\u0275cmp=$({type:mm,selectors:[["th-cubeCamera"]],inputs:{renderTarget:"renderTarget"},features:[ne([{provide:We,useExisting:ae(()=>mm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class gm extends ir{getType(){return Jd}get isCubeTexture(){return this._objRef?.isCubeTexture}set mapping(e){this._objRef&&(this._objRef.mapping=e)}get mapping(){return this._objRef?.mapping}set flipY(e){this._objRef&&(this._objRef.flipY=e)}get flipY(){return this._objRef?.flipY}}gm.\u0275fac=function(){let i;return function(t){return(i||(i=le(gm)))(t||gm)}}(),gm.\u0275cmp=$({type:gm,selectors:[["th-cubeTexture"]],inputs:{mapping:"mapping",flipY:"flipY"},features:[ne([{provide:Br,useExisting:ae(()=>gm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class B_e extends wn{constructor(e,t,n=1){super(),this.camera=e,this.needsSwap=!1,this.cubeShader=To.cube,this.cubeMesh=new nt(new tn(10,10,10),new Pt({uniforms:gi.clone(this.cubeShader.uniforms),vertexShader:this.cubeShader.vertexShader,fragmentShader:this.cubeShader.fragmentShader,depthTest:!1,depthWrite:!1,side:Hr})),Object.defineProperty(this.cubeMesh.material,"envMap",{get:function(){return this.uniforms.tCube.value}}),this.tCube=t,this.opacity=n,this.cubeScene=new ux,this.cubeCamera=new In,this.cubeScene.add(this.cubeMesh)}render(e,t,n){const r=e.autoClear;e.autoClear=!1,this.cubeCamera.projectionMatrix.copy(this.camera.projectionMatrix),this.cubeCamera.quaternion.setFromRotationMatrix(this.camera.matrixWorld),this.cubeMesh.material.uniforms.tCube.value=this.tCube,this.cubeMesh.material.uniforms.tFlip.value=this.tCube.isCubeTexture&&!1===this.tCube.isRenderTargetTexture?-1:1,this.cubeMesh.material.uniforms.opacity.value=this.opacity,this.cubeMesh.material.transparent=this.opacity<1,e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(),e.render(this.cubeScene,this.cubeCamera),e.autoClear=r}dispose(){this.cubeMesh.geometry.dispose(),this.cubeMesh.material.dispose()}}class _m extends Yi{getType(){return B_e}set camera(e){this._objRef&&(this._objRef.camera=e)}get camera(){return this._objRef?.camera}set cubeShader(e){this._objRef&&(this._objRef.cubeShader=e)}get cubeShader(){return this._objRef?.cubeShader}set cubeMesh(e){this._objRef&&(this._objRef.cubeMesh=e)}get cubeMesh(){return this._objRef?.cubeMesh}set envMap(e){this._objRef&&(this._objRef.envMap=e)}get envMap(){return this._objRef?.envMap}set opacity(e){this._objRef&&(this._objRef.opacity=e)}get opacity(){return this._objRef?.opacity}set cubeScene(e){this._objRef&&(this._objRef.cubeScene=e)}get cubeScene(){return this._objRef?.cubeScene}set cubeCamera(e){this._objRef&&(this._objRef.cubeCamera=e)}get cubeCamera(){return this._objRef?.cubeCamera}}_m.\u0275fac=function(){let i;return function(t){return(i||(i=le(_m)))(t||_m)}}(),_m.\u0275cmp=$({type:_m,selectors:[["th-cubeTexturePass"]],inputs:{camera:"camera",cubeShader:"cubeShader",cubeMesh:"cubeMesh",envMap:"envMap",opacity:"opacity",cubeScene:"cubeScene",cubeCamera:"cubeCamera"},features:[ne([{provide:Li,useExisting:ae(()=>_m)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class bm extends ir{getType(){return cb}get isData3DTexture(){return this._objRef?.isData3DTexture}set magFilter(e){this._objRef&&(this._objRef.magFilter=e)}get magFilter(){return this._objRef?.magFilter}set minFilter(e){this._objRef&&(this._objRef.minFilter=e)}get minFilter(){return this._objRef?.minFilter}set wrapR(e){this._objRef&&(this._objRef.wrapR=e)}get wrapR(){return this._objRef?.wrapR}set flipY(e){this._objRef&&(this._objRef.flipY=e)}get flipY(){return this._objRef?.flipY}set generateMipmaps(e){this._objRef&&(this._objRef.generateMipmaps=e)}get generateMipmaps(){return this._objRef?.generateMipmaps}set unpackAlignment(e){this._objRef&&(this._objRef.unpackAlignment=e)}get unpackAlignment(){return this._objRef?.unpackAlignment}}bm.\u0275fac=function(){let i;return function(t){return(i||(i=le(bm)))(t||bm)}}(),bm.\u0275cmp=$({type:bm,selectors:[["th-data3DTexture"]],inputs:{magFilter:"magFilter",minFilter:"minFilter",wrapR:"wrapR",flipY:"flipY",generateMipmaps:"generateMipmaps",unpackAlignment:"unpackAlignment"},features:[ne([{provide:Br,useExisting:ae(()=>bm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class vm extends ir{getType(){return lb}get isDataArrayTexture(){return this._objRef?.isDataArrayTexture}set magFilter(e){this._objRef&&(this._objRef.magFilter=e)}get magFilter(){return this._objRef?.magFilter}set minFilter(e){this._objRef&&(this._objRef.minFilter=e)}get minFilter(){return this._objRef?.minFilter}set wrapR(e){this._objRef&&(this._objRef.wrapR=e)}get wrapR(){return this._objRef?.wrapR}set flipY(e){this._objRef&&(this._objRef.flipY=e)}get flipY(){return this._objRef?.flipY}set generateMipmaps(e){this._objRef&&(this._objRef.generateMipmaps=e)}get generateMipmaps(){return this._objRef?.generateMipmaps}set unpackAlignment(e){this._objRef&&(this._objRef.unpackAlignment=e)}get unpackAlignment(){return this._objRef?.unpackAlignment}}vm.\u0275fac=function(){let i;return function(t){return(i||(i=le(vm)))(t||vm)}}(),vm.\u0275cmp=$({type:vm,selectors:[["th-dataArrayTexture"]],inputs:{magFilter:"magFilter",minFilter:"minFilter",wrapR:"wrapR",flipY:"flipY",generateMipmaps:"generateMipmaps",unpackAlignment:"unpackAlignment"},features:[ne([{provide:Br,useExisting:ae(()=>vm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class _a extends ir{getType(){return Fa}get isDataTexture(){return this._objRef?.isDataTexture}set magFilter(e){this._objRef&&(this._objRef.magFilter=e)}get magFilter(){return this._objRef?.magFilter}set minFilter(e){this._objRef&&(this._objRef.minFilter=e)}get minFilter(){return this._objRef?.minFilter}set flipY(e){this._objRef&&(this._objRef.flipY=e)}get flipY(){return this._objRef?.flipY}set generateMipmaps(e){this._objRef&&(this._objRef.generateMipmaps=e)}get generateMipmaps(){return this._objRef?.generateMipmaps}set unpackAlignment(e){this._objRef&&(this._objRef.unpackAlignment=e)}get unpackAlignment(){return this._objRef?.unpackAlignment}}_a.\u0275fac=function(){let i;return function(t){return(i||(i=le(_a)))(t||_a)}}(),_a.\u0275cmp=$({type:_a,selectors:[["th-dataTexture"]],inputs:{magFilter:"magFilter",minFilter:"minFilter",flipY:"flipY",generateMipmaps:"generateMipmaps",unpackAlignment:"unpackAlignment"},features:[ne([{provide:Br,useExisting:ae(()=>_a)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class j_e extends Mt{constructor(e,t,n,r){super();const s=[],o=[],a=[],l=new R,c=new Qe;c.makeRotationFromEuler(n),c.setPosition(t);const d=new Qe;function h(_,g,p){g.applyMatrix4(e.matrixWorld),g.applyMatrix4(d),p.transformDirection(e.matrixWorld),_.push(new HG(g.clone(),p.clone()))}function f(_,g){const p=[],v=.5*Math.abs(r.dot(g));for(let b=0;b<_.length;b+=3){let x,w,E,S,y=0;const U=_[b+0].position.dot(g)-v>0,L=_[b+1].position.dot(g)-v>0,j=_[b+2].position.dot(g)-v>0;switch(y=(U?1:0)+(L?1:0)+(j?1:0),y){case 0:p.push(_[b]),p.push(_[b+1]),p.push(_[b+2]);break;case 1:if(U&&(x=_[b+1],w=_[b+2],E=m(_[b],x,g,v),S=m(_[b],w,g,v)),L){x=_[b],w=_[b+2],E=m(_[b+1],x,g,v),S=m(_[b+1],w,g,v),p.push(E),p.push(w.clone()),p.push(x.clone()),p.push(w.clone()),p.push(E.clone()),p.push(S);break}j&&(x=_[b],w=_[b+1],E=m(_[b+2],x,g,v),S=m(_[b+2],w,g,v)),p.push(x.clone()),p.push(w.clone()),p.push(E),p.push(S),p.push(E.clone()),p.push(w.clone());break;case 2:U||(x=_[b].clone(),w=m(x,_[b+1],g,v),E=m(x,_[b+2],g,v),p.push(x),p.push(w),p.push(E)),L||(x=_[b+1].clone(),w=m(x,_[b+2],g,v),E=m(x,_[b],g,v),p.push(x),p.push(w),p.push(E)),j||(x=_[b+2].clone(),w=m(x,_[b],g,v),E=m(x,_[b+1],g,v),p.push(x),p.push(w),p.push(E))}}return p}function m(_,g,p,v){const b=_.position.dot(p)-v,x=b/(b-(g.position.dot(p)-v));return new HG(new R(_.position.x+x*(g.position.x-_.position.x),_.position.y+x*(g.position.y-_.position.y),_.position.z+x*(g.position.z-_.position.z)),new R(_.normal.x+x*(g.normal.x-_.normal.x),_.normal.y+x*(g.normal.y-_.normal.y),_.normal.z+x*(g.normal.z-_.normal.z)))}d.copy(c).invert(),function u(){let _=[];const g=new R,p=new R,v=e.geometry,b=v.attributes.position,y=v.attributes.normal;if(null!==v.index){const x=v.index;for(let w=0;w<x.count;w++)g.fromBufferAttribute(b,x.getX(w)),p.fromBufferAttribute(y,x.getX(w)),h(_,g,p)}else for(let x=0;x<b.count;x++)g.fromBufferAttribute(b,x),p.fromBufferAttribute(y,x),h(_,g,p);_=f(_,l.set(1,0,0)),_=f(_,l.set(-1,0,0)),_=f(_,l.set(0,1,0)),_=f(_,l.set(0,-1,0)),_=f(_,l.set(0,0,1)),_=f(_,l.set(0,0,-1));for(let x=0;x<_.length;x++){const w=_[x];a.push(.5+w.position.x/r.x,.5+w.position.y/r.y),w.position.applyMatrix4(c),s.push(w.position.x,w.position.y,w.position.z),o.push(w.normal.x,w.normal.y,w.normal.z)}}(),this.setAttribute("position",new Ke(s,3)),this.setAttribute("normal",new Ke(o,3)),this.setAttribute("uv",new Ke(a,2))}}class HG{constructor(e,t){this.position=e,this.normal=t}clone(){return new this.constructor(this.position.clone(),this.normal.clone())}}class Am extends Rt{getType(){return j_e}}Am.\u0275fac=function(){let i;return function(t){return(i||(i=le(Am)))(t||Am)}}(),Am.\u0275cmp=$({type:Am,selectors:[["th-decalGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>Am)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class ym extends ir{getType(){return rp}get isDepthTexture(){return this._objRef?.isDepthTexture}set flipY(e){this._objRef&&(this._objRef.flipY=e)}get flipY(){return this._objRef?.flipY}set magFilter(e){this._objRef&&(this._objRef.magFilter=e)}get magFilter(){return this._objRef?.magFilter}set minFilter(e){this._objRef&&(this._objRef.minFilter=e)}get minFilter(){return this._objRef?.minFilter}set generateMipmaps(e){this._objRef&&(this._objRef.generateMipmaps=e)}get generateMipmaps(){return this._objRef?.generateMipmaps}set format(e){this._objRef&&(this._objRef.format=e)}get format(){return this._objRef?.format}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}}ym.\u0275fac=function(){let i;return function(t){return(i||(i=le(ym)))(t||ym)}}(),ym.\u0275cmp=$({type:ym,selectors:[["th-depthTexture"]],inputs:{flipY:"flipY",magFilter:"magFilter",minFilter:"minFilter",generateMipmaps:"generateMipmaps",format:"format",type:"type"},features:[ne([{provide:Br,useExisting:ae(()=>ym)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class xm extends We{getType(){return x5}get type(){return this._objRef?.type}set lightPlane(e){this._objRef&&(this._objRef.lightPlane=e)}get lightPlane(){return this._objRef?.lightPlane}set light(e){this._objRef&&(this._objRef.light=e)}get light(){return this._objRef?.light}set matrix(e){this._objRef&&(this._objRef.matrix=Ye(this._objRef.matrix,e))}get matrix(){return this._objRef?.matrix}set matrixAutoUpdate(e){this._objRef&&(this._objRef.matrixAutoUpdate=e)}get matrixAutoUpdate(){return this._objRef?.matrixAutoUpdate}set color(e){this._objRef&&(this._objRef.color=e)}get color(){return this._objRef?.color}set targetLine(e){this._objRef&&(this._objRef.targetLine=e)}get targetLine(){return this._objRef?.targetLine}}xm.\u0275fac=function(){let i;return function(t){return(i||(i=le(xm)))(t||xm)}}(),xm.\u0275cmp=$({type:xm,selectors:[["th-directionalLightHelper"]],inputs:{lightPlane:"lightPlane",light:"light",matrix:"matrix",matrixAutoUpdate:"matrixAutoUpdate",color:"color",targetLine:"targetLine"},features:[ne([{provide:We,useExisting:ae(()=>xm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Ka extends Rt{getType(){return Oa}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}}Ka.\u0275fac=function(){let i;return function(t){return(i||(i=le(Ka)))(t||Ka)}}(),Ka.\u0275cmp=$({type:Ka,selectors:[["th-polyhedronGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>Ka)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class wm extends Ka{getType(){return gp}get type(){return this._objRef?.type}}wm.\u0275fac=function(){let i;return function(t){return(i||(i=le(wm)))(t||wm)}}(),wm.\u0275cmp=$({type:wm,selectors:[["th-dodecahedronGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>wm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const fD={uniforms:{tDiffuse:{value:null},tSize:{value:new fe(256,256)},center:{value:new fe(.5,.5)},angle:{value:1.57},scale:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform vec2 center;\n\t\tuniform float angle;\n\t\tuniform float scale;\n\t\tuniform vec2 tSize;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tfloat pattern() {\n\n\t\t\tfloat s = sin( angle ), c = cos( angle );\n\n\t\t\tvec2 tex = vUv * tSize - center;\n\t\t\tvec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;\n\n\t\t\treturn ( sin( point.x ) * sin( point.y ) ) * 4.0;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvec4 color = texture2D( tDiffuse, vUv );\n\n\t\t\tfloat average = ( color.r + color.g + color.b ) / 3.0;\n\n\t\t\tgl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );\n\n\t\t}"};class Q_e extends wn{constructor(e,t,n){super();const r=fD;this.uniforms=gi.clone(r.uniforms),void 0!==e&&this.uniforms.center.value.copy(e),void 0!==t&&(this.uniforms.angle.value=t),void 0!==n&&(this.uniforms.scale.value=n),this.material=new Pt({uniforms:this.uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}),this.fsQuad=new xr(this.material)}render(e,t,n){this.uniforms.tDiffuse.value=n.texture,this.uniforms.tSize.value.set(n.width,n.height),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class Cm extends Yi{getType(){return Q_e}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}get uniforms(){return this._objRef?.uniforms}set material(e){this._objRef&&(this._objRef.material=e)}get material(){return this._objRef?.material}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}}Cm.\u0275fac=function(){let i;return function(t){return(i||(i=le(Cm)))(t||Cm)}}(),Cm.\u0275cmp=$({type:Cm,selectors:[["th-dotScreenPass"]],inputs:{uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[ne([{provide:Li,useExisting:ae(()=>Cm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const Mm=new oo,Qc=new Mu,R0=new fe,QG=new R,Ww=new R,pD=new R,WG=new Qe;class q_e extends as{constructor(e,t,n){super(),n.style.touchAction="none";let r=null,s=null;const o=[],a=this;function l(){n.addEventListener("pointermove",f),n.addEventListener("pointerdown",m),n.addEventListener("pointerup",_),n.addEventListener("pointerleave",_)}function c(){n.removeEventListener("pointermove",f),n.removeEventListener("pointerdown",m),n.removeEventListener("pointerup",_),n.removeEventListener("pointerleave",_),n.style.cursor=""}function f(p){if(!1!==a.enabled){if(g(p),Qc.setFromCamera(R0,t),r)return Qc.ray.intersectPlane(Mm,Ww)&&r.position.copy(Ww.sub(QG).applyMatrix4(WG)),void a.dispatchEvent({type:"drag",object:r});if("mouse"===p.pointerType||"pen"===p.pointerType)if(o.length=0,Qc.setFromCamera(R0,t),Qc.intersectObjects(e,!0,o),o.length>0){const v=o[0].object;Mm.setFromNormalAndCoplanarPoint(t.getWorldDirection(Mm.normal),pD.setFromMatrixPosition(v.matrixWorld)),s!==v&&null!==s&&(a.dispatchEvent({type:"hoveroff",object:s}),n.style.cursor="auto",s=null),s!==v&&(a.dispatchEvent({type:"hoveron",object:v}),n.style.cursor="pointer",s=v)}else null!==s&&(a.dispatchEvent({type:"hoveroff",object:s}),n.style.cursor="auto",s=null)}}function m(p){!1!==a.enabled&&(g(p),o.length=0,Qc.setFromCamera(R0,t),Qc.intersectObjects(e,!0,o),o.length>0&&(r=!0===a.transformGroup?e[0]:o[0].object,Mm.setFromNormalAndCoplanarPoint(t.getWorldDirection(Mm.normal),pD.setFromMatrixPosition(r.matrixWorld)),Qc.ray.intersectPlane(Mm,Ww)&&(WG.copy(r.parent.matrixWorld).invert(),QG.copy(Ww).sub(pD.setFromMatrixPosition(r.matrixWorld))),n.style.cursor="move",a.dispatchEvent({type:"dragstart",object:r})))}function _(){!1!==a.enabled&&(r&&(a.dispatchEvent({type:"dragend",object:r}),r=null),n.style.cursor=s?"pointer":"auto")}function g(p){const v=n.getBoundingClientRect();R0.x=(p.clientX-v.left)/v.width*2-1,R0.y=-(p.clientY-v.top)/v.height*2+1}l(),this.enabled=!0,this.transformGroup=!1,this.activate=l,this.deactivate=c,this.dispose=function d(){c()},this.getObjects=function u(){return e},this.getRaycaster=function h(){return Qc}}}class Ku extends qn{getType(){return q_e}set object(e){this._objRef&&(this._objRef.object=e)}get object(){return this._objRef?.object}set enabled(e){this._objRef&&(this._objRef.enabled=e)}get enabled(){return this._objRef?.enabled}set transformGroup(e){this._objRef&&(this._objRef.transformGroup=e)}get transformGroup(){return this._objRef?.transformGroup}}Ku.\u0275fac=function(){let i;return function(t){return(i||(i=le(Ku)))(t||Ku)}}(),Ku.\u0275cmp=$({type:Ku,selectors:[["th-dragControls"]],inputs:{object:"object",enabled:"enabled",transformGroup:"transformGroup"},features:[ne([{provide:qn,useExisting:ae(()=>Ku)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Em extends Rt{getType(){return yR}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}}Em.\u0275fac=function(){let i;return function(t){return(i||(i=le(Em)))(t||Em)}}(),Em.\u0275cmp=$({type:Em,selectors:[["th-edgesGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>Em)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class $u extends Rt{getType(){return cu}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}}$u.\u0275fac=function(){let i;return function(t){return(i||(i=le($u)))(t||$u)}}(),$u.\u0275cmp=$({type:$u,selectors:[["th-extrudeGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>$u)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const K_e={uniforms:{tDiffuse:{value:null},time:{value:0},nIntensity:{value:.5},sIntensity:{value:.05},sCount:{value:4096},grayscale:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\t#include <common>\n\n\t\t// control parameter\n\t\tuniform float time;\n\n\t\tuniform bool grayscale;\n\n\t\t// noise effect intensity value (0 = no effect, 1 = full effect)\n\t\tuniform float nIntensity;\n\n\t\t// scanlines effect intensity value (0 = no effect, 1 = full effect)\n\t\tuniform float sIntensity;\n\n\t\t// scanlines effect count value (0 = no effect, 4096 = full effect)\n\t\tuniform float sCount;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t// sample the source\n\t\t\tvec4 cTextureScreen = texture2D( tDiffuse, vUv );\n\n\t\t// make some noise\n\t\t\tfloat dx = rand( vUv + time );\n\n\t\t// add noise\n\t\t\tvec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );\n\n\t\t// get us a sine and cosine\n\t\t\tvec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );\n\n\t\t// add scanlines\n\t\t\tcResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;\n\n\t\t// interpolate between source and result by intensity\n\t\t\tcResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );\n\n\t\t// convert to grayscale if desired\n\t\t\tif( grayscale ) {\n\n\t\t\t\tcResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );\n\n\t\t\t}\n\n\t\t\tgl_FragColor =  vec4( cResult, cTextureScreen.a );\n\n\t\t}"};class $_e extends wn{constructor(e,t,n,r){super();const s=K_e;this.uniforms=gi.clone(s.uniforms),this.material=new Pt({uniforms:this.uniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader}),void 0!==r&&(this.uniforms.grayscale.value=r),void 0!==e&&(this.uniforms.nIntensity.value=e),void 0!==t&&(this.uniforms.sIntensity.value=t),void 0!==n&&(this.uniforms.sCount.value=n),this.fsQuad=new xr(this.material)}render(e,t,n,r){this.uniforms.tDiffuse.value=n.texture,this.uniforms.time.value+=r,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class Ju extends Yi{getType(){return $_e}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}get uniforms(){return this._objRef?.uniforms}set material(e){this._objRef&&(this._objRef.material=e)}get material(){return this._objRef?.material}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}}Ju.\u0275fac=function(){let i;return function(t){return(i||(i=le(Ju)))(t||Ju)}}(),Ju.\u0275cmp=$({type:Ju,selectors:[["th-filmPass"]],inputs:{uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[ne([{provide:Li,useExisting:ae(()=>Ju)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const qG=new R,mD=new Nx,gD=new R;class ebe{constructor(e,t){this.object=e,this.domElement=t,this.enabled=!0,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.mouseDragOn=!1,this.autoSpeedFactor=0,this.pointerX=0,this.pointerY=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.viewHalfX=0,this.viewHalfY=0;let n=0,r=0;this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onPointerDown=function(u){if(this.domElement!==document&&this.domElement.focus(),this.activeLook)switch(u.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0},this.onPointerUp=function(u){if(this.activeLook)switch(u.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1},this.onPointerMove=function(u){this.domElement===document?(this.pointerX=u.pageX-this.viewHalfX,this.pointerY=u.pageY-this.viewHalfY):(this.pointerX=u.pageX-this.domElement.offsetLeft-this.viewHalfX,this.pointerY=u.pageY-this.domElement.offsetTop-this.viewHalfY)},this.onKeyDown=function(u){switch(u.code){case"ArrowUp":case"KeyW":this.moveForward=!0;break;case"ArrowLeft":case"KeyA":this.moveLeft=!0;break;case"ArrowDown":case"KeyS":this.moveBackward=!0;break;case"ArrowRight":case"KeyD":this.moveRight=!0;break;case"KeyR":this.moveUp=!0;break;case"KeyF":this.moveDown=!0}},this.onKeyUp=function(u){switch(u.code){case"ArrowUp":case"KeyW":this.moveForward=!1;break;case"ArrowLeft":case"KeyA":this.moveLeft=!1;break;case"ArrowDown":case"KeyS":this.moveBackward=!1;break;case"ArrowRight":case"KeyD":this.moveRight=!1;break;case"KeyR":this.moveUp=!1;break;case"KeyF":this.moveDown=!1}},this.lookAt=function(u,h,f){return u.isVector3?gD.copy(u):gD.set(u,h,f),this.object.lookAt(gD),d(this),this},this.update=function(){const u=new R;return function(f){if(!1===this.enabled)return;if(this.heightSpeed){const x=ft.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=f*(x*this.heightCoef)}else this.autoSpeedFactor=0;const m=f*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(m+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(m),this.moveLeft&&this.object.translateX(-m),this.moveRight&&this.object.translateX(m),this.moveUp&&this.object.translateY(m),this.moveDown&&this.object.translateY(-m);let _=f*this.lookSpeed;this.activeLook||(_=0);let g=1;this.constrainVertical&&(g=Math.PI/(this.verticalMax-this.verticalMin)),r-=this.pointerX*_,this.lookVertical&&(n-=this.pointerY*_*g),n=Math.max(-85,Math.min(85,n));let p=ft.degToRad(90-n);const v=ft.degToRad(r);this.constrainVertical&&(p=ft.mapLinear(p,0,Math.PI,this.verticalMin,this.verticalMax));const b=this.object.position;u.setFromSphericalCoords(1,p,v).add(b),this.object.lookAt(u)}}(),this.dispose=function(){this.domElement.removeEventListener("contextmenu",YG),this.domElement.removeEventListener("pointerdown",o),this.domElement.removeEventListener("pointermove",s),this.domElement.removeEventListener("pointerup",a),window.removeEventListener("keydown",l),window.removeEventListener("keyup",c)};const s=this.onPointerMove.bind(this),o=this.onPointerDown.bind(this),a=this.onPointerUp.bind(this),l=this.onKeyDown.bind(this),c=this.onKeyUp.bind(this);function d(u){const h=u.object.quaternion;qG.set(0,0,-1).applyQuaternion(h),mD.setFromVector3(qG),n=90-ft.radToDeg(mD.phi),r=ft.radToDeg(mD.theta)}this.domElement.addEventListener("contextmenu",YG),this.domElement.addEventListener("pointerdown",o),this.domElement.addEventListener("pointermove",s),this.domElement.addEventListener("pointerup",a),window.addEventListener("keydown",l),window.addEventListener("keyup",c),this.handleResize(),d(this)}}function YG(i){i.preventDefault()}class eh extends qn{getType(){return ebe}set object(e){this._objRef&&(this._objRef.object=e)}get object(){return this._objRef?.object}set domElement(e){this._objRef&&(this._objRef.domElement=e)}get domElement(){return this._objRef?.domElement}set enabled(e){this._objRef&&(this._objRef.enabled=e)}get enabled(){return this._objRef?.enabled}set movementSpeed(e){this._objRef&&(this._objRef.movementSpeed=e)}get movementSpeed(){return this._objRef?.movementSpeed}set lookSpeed(e){this._objRef&&(this._objRef.lookSpeed=e)}get lookSpeed(){return this._objRef?.lookSpeed}set lookVertical(e){this._objRef&&(this._objRef.lookVertical=e)}get lookVertical(){return this._objRef?.lookVertical}set autoForward(e){this._objRef&&(this._objRef.autoForward=e)}get autoForward(){return this._objRef?.autoForward}set activeLook(e){this._objRef&&(this._objRef.activeLook=e)}get activeLook(){return this._objRef?.activeLook}set heightSpeed(e){this._objRef&&(this._objRef.heightSpeed=e)}get heightSpeed(){return this._objRef?.heightSpeed}set heightCoef(e){this._objRef&&(this._objRef.heightCoef=e)}get heightCoef(){return this._objRef?.heightCoef}set heightMin(e){this._objRef&&(this._objRef.heightMin=e)}get heightMin(){return this._objRef?.heightMin}set heightMax(e){this._objRef&&(this._objRef.heightMax=e)}get heightMax(){return this._objRef?.heightMax}set constrainVertical(e){this._objRef&&(this._objRef.constrainVertical=e)}get constrainVertical(){return this._objRef?.constrainVertical}set verticalMin(e){this._objRef&&(this._objRef.verticalMin=e)}get verticalMin(){return this._objRef?.verticalMin}set verticalMax(e){this._objRef&&(this._objRef.verticalMax=e)}get verticalMax(){return this._objRef?.verticalMax}set mouseDragOn(e){this._objRef&&(this._objRef.mouseDragOn=e)}get mouseDragOn(){return this._objRef?.mouseDragOn}}eh.\u0275fac=function(){let i;return function(t){return(i||(i=le(eh)))(t||eh)}}(),eh.\u0275cmp=$({type:eh,selectors:[["th-firstPersonControls"]],inputs:{object:"object",domElement:"domElement",enabled:"enabled",movementSpeed:"movementSpeed",lookSpeed:"lookSpeed",lookVertical:"lookVertical",autoForward:"autoForward",activeLook:"activeLook",heightSpeed:"heightSpeed",heightCoef:"heightCoef",heightMin:"heightMin",heightMax:"heightMax",constrainVertical:"constrainVertical",verticalMin:"verticalMin",verticalMax:"verticalMax",mouseDragOn:"mouseDragOn"},features:[ne([{provide:qn,useExisting:ae(()=>eh)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const ibe={type:"change"};class nbe extends as{constructor(e,t){super(),this.object=e,this.domElement=t,this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1;const n=this,r=1e-6,s=new xi,o=new R;this.tmpQuaternion=new xi,this.status=0,this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this.moveVector=new R(0,0,0),this.rotationVector=new R(0,0,0),this.keydown=function(h){if(!h.altKey){switch(h.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this.moveState.forward=1;break;case"KeyS":this.moveState.back=1;break;case"KeyA":this.moveState.left=1;break;case"KeyD":this.moveState.right=1;break;case"KeyR":this.moveState.up=1;break;case"KeyF":this.moveState.down=1;break;case"ArrowUp":this.moveState.pitchUp=1;break;case"ArrowDown":this.moveState.pitchDown=1;break;case"ArrowLeft":this.moveState.yawLeft=1;break;case"ArrowRight":this.moveState.yawRight=1;break;case"KeyQ":this.moveState.rollLeft=1;break;case"KeyE":this.moveState.rollRight=1}this.updateMovementVector(),this.updateRotationVector()}},this.keyup=function(h){switch(h.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this.moveState.forward=0;break;case"KeyS":this.moveState.back=0;break;case"KeyA":this.moveState.left=0;break;case"KeyD":this.moveState.right=0;break;case"KeyR":this.moveState.up=0;break;case"KeyF":this.moveState.down=0;break;case"ArrowUp":this.moveState.pitchUp=0;break;case"ArrowDown":this.moveState.pitchDown=0;break;case"ArrowLeft":this.moveState.yawLeft=0;break;case"ArrowRight":this.moveState.yawRight=0;break;case"KeyQ":this.moveState.rollLeft=0;break;case"KeyE":this.moveState.rollRight=0}this.updateMovementVector(),this.updateRotationVector()},this.pointerdown=function(h){if(this.dragToLook)this.status++;else{switch(h.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1}this.updateMovementVector()}},this.pointermove=function(h){if(!this.dragToLook||this.status>0){const f=this.getContainerDimensions(),m=f.size[0]/2,_=f.size[1]/2;this.moveState.yawLeft=-(h.pageX-f.offset[0]-m)/m,this.moveState.pitchDown=(h.pageY-f.offset[1]-_)/_,this.updateRotationVector()}},this.pointerup=function(h){if(this.dragToLook)this.status--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(h.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0}this.updateMovementVector()}this.updateRotationVector()},this.update=function(h){const f=h*n.movementSpeed,m=h*n.rollSpeed;n.object.translateX(n.moveVector.x*f),n.object.translateY(n.moveVector.y*f),n.object.translateZ(n.moveVector.z*f),n.tmpQuaternion.set(n.rotationVector.x*m,n.rotationVector.y*m,n.rotationVector.z*m,1).normalize(),n.object.quaternion.multiply(n.tmpQuaternion),(o.distanceToSquared(n.object.position)>r||8*(1-s.dot(n.object.quaternion))>r)&&(n.dispatchEvent(ibe),s.copy(n.object.quaternion),o.copy(n.object.position))},this.updateMovementVector=function(){const h=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-h+this.moveState.back},this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft},this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}},this.dispose=function(){this.domElement.removeEventListener("contextmenu",XG),this.domElement.removeEventListener("pointerdown",l),this.domElement.removeEventListener("pointermove",a),this.domElement.removeEventListener("pointerup",c),window.removeEventListener("keydown",d),window.removeEventListener("keyup",u)};const a=this.pointermove.bind(this),l=this.pointerdown.bind(this),c=this.pointerup.bind(this),d=this.keydown.bind(this),u=this.keyup.bind(this);this.domElement.addEventListener("contextmenu",XG),this.domElement.addEventListener("pointerdown",l),this.domElement.addEventListener("pointermove",a),this.domElement.addEventListener("pointerup",c),window.addEventListener("keydown",d),window.addEventListener("keyup",u),this.updateMovementVector(),this.updateRotationVector()}}function XG(i){i.preventDefault()}class th extends qn{getType(){return nbe}set object(e){this._objRef&&(this._objRef.object=e)}get object(){return this._objRef?.object}set domElement(e){this._objRef&&(this._objRef.domElement=e)}get domElement(){return this._objRef?.domElement}set movementSpeed(e){this._objRef&&(this._objRef.movementSpeed=e)}get movementSpeed(){return this._objRef?.movementSpeed}set rollSpeed(e){this._objRef&&(this._objRef.rollSpeed=e)}get rollSpeed(){return this._objRef?.rollSpeed}set dragToLook(e){this._objRef&&(this._objRef.dragToLook=e)}get dragToLook(){return this._objRef?.dragToLook}set autoForward(e){this._objRef&&(this._objRef.autoForward=e)}get autoForward(){return this._objRef?.autoForward}}th.\u0275fac=function(){let i;return function(t){return(i||(i=le(th)))(t||th)}}(),th.\u0275cmp=$({type:th,selectors:[["th-flyControls"]],inputs:{object:"object",domElement:"domElement",movementSpeed:"movementSpeed",rollSpeed:"rollSpeed",dragToLook:"dragToLook",autoForward:"autoForward"},features:[ne([{provide:qn,useExisting:ae(()=>th)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Sm extends ir{getType(){return b4}get isFramebufferTexture(){return this._objRef?.isFramebufferTexture}set magFilter(e){this._objRef&&(this._objRef.magFilter=e)}get magFilter(){return this._objRef?.magFilter}set minFilter(e){this._objRef&&(this._objRef.minFilter=e)}get minFilter(){return this._objRef?.minFilter}set generateMipmaps(e){this._objRef&&(this._objRef.generateMipmaps=e)}get generateMipmaps(){return this._objRef?.generateMipmaps}}Sm.\u0275fac=function(){let i;return function(t){return(i||(i=le(Sm)))(t||Sm)}}(),Sm.\u0275cmp=$({type:Sm,selectors:[["th-framebufferTexture"]],inputs:{magFilter:"magFilter",minFilter:"minFilter",generateMipmaps:"generateMipmaps"},features:[ne([{provide:Br,useExisting:ae(()=>Sm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const obe={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t}",fragmentShader:"\n\n\t\tuniform int byp; //should we apply the glitch ?\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tDisp;\n\n\t\tuniform float amount;\n\t\tuniform float angle;\n\t\tuniform float seed;\n\t\tuniform float seed_x;\n\t\tuniform float seed_y;\n\t\tuniform float distortion_x;\n\t\tuniform float distortion_y;\n\t\tuniform float col_s;\n\n\t\tvarying vec2 vUv;\n\n\n\t\tfloat rand(vec2 co){\n\t\t\treturn fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n\t\t}\n\n\t\tvoid main() {\n\t\t\tif(byp<1) {\n\t\t\t\tvec2 p = vUv;\n\t\t\t\tfloat xs = floor(gl_FragCoord.x / 0.5);\n\t\t\t\tfloat ys = floor(gl_FragCoord.y / 0.5);\n\t\t\t\t//based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch\n\t\t\t\tfloat disp = texture2D(tDisp, p*seed*seed).r;\n\t\t\t\tif(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {\n\t\t\t\t\tif(seed_x>0.){\n\t\t\t\t\t\tp.y = 1. - (p.y + distortion_y);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tp.y = distortion_y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {\n\t\t\t\t\tif(seed_y>0.){\n\t\t\t\t\t\tp.x=distortion_x;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tp.x = 1. - (p.x + distortion_x);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tp.x+=disp*seed_x*(seed/5.);\n\t\t\t\tp.y+=disp*seed_y*(seed/5.);\n\t\t\t\t//base from RGB shift shader\n\t\t\t\tvec2 offset = amount * vec2( cos(angle), sin(angle));\n\t\t\t\tvec4 cr = texture2D(tDiffuse, p + offset);\n\t\t\t\tvec4 cga = texture2D(tDiffuse, p);\n\t\t\t\tvec4 cb = texture2D(tDiffuse, p - offset);\n\t\t\t\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);\n\t\t\t\t//add noise\n\t\t\t\tvec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);\n\t\t\t\tgl_FragColor = gl_FragColor+ snow;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tgl_FragColor=texture2D (tDiffuse, vUv);\n\t\t\t}\n\t\t}"};class abe extends wn{constructor(e=64){super();const t=obe;this.uniforms=gi.clone(t.uniforms),this.heightMap=this.generateHeightmap(e),this.uniforms.tDisp.value=this.heightMap,this.material=new Pt({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.fsQuad=new xr(this.material),this.goWild=!1,this.curF=0,this.generateTrigger()}render(e,t,n){!1===e.capabilities.isWebGL2&&(this.uniforms.tDisp.value.format=Cy),this.uniforms.tDiffuse.value=n.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||1==this.goWild?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=ft.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=ft.randFloat(-1,1),this.uniforms.seed_y.value=ft.randFloat(-1,1),this.uniforms.distortion_x.value=ft.randFloat(0,1),this.uniforms.distortion_y.value=ft.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=ft.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=ft.randFloat(0,1),this.uniforms.distortion_y.value=ft.randFloat(0,1),this.uniforms.seed_x.value=ft.randFloat(-.3,.3),this.uniforms.seed_y.value=ft.randFloat(-.3,.3)):0==this.goWild&&(this.uniforms.byp.value=1),this.curF++,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}generateTrigger(){this.randX=ft.randInt(120,240)}generateHeightmap(e){const t=new Float32Array(e*e),n=e*e;for(let s=0;s<n;s++){const o=ft.randFloat(0,1);t[s]=o}const r=new Fa(t,e,e,Cl,Un);return r.needsUpdate=!0,r}dispose(){this.material.dispose(),this.heightMap.dispose(),this.fsQuad.dispose()}}class ih extends Yi{getType(){return abe}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}get uniforms(){return this._objRef?.uniforms}set material(e){this._objRef&&(this._objRef.material=e)}get material(){return this._objRef?.material}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}set goWild(e){this._objRef&&(this._objRef.goWild=e)}get goWild(){return this._objRef?.goWild}set curF(e){this._objRef&&(this._objRef.curF=e)}get curF(){return this._objRef?.curF}set randX(e){this._objRef&&(this._objRef.randX=e)}get randX(){return this._objRef?.randX}}ih.\u0275fac=function(){let i;return function(t){return(i||(i=le(ih)))(t||ih)}}(),ih.\u0275cmp=$({type:ih,selectors:[["th-glitchPass"]],inputs:{uniforms:"uniforms",material:"material",fsQuad:"fsQuad",goWild:"goWild",curF:"curF",randX:"randX"},features:[ne([{provide:Li,useExisting:ae(()=>ih)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class $a extends We{getType(){return Es}get isGroup(){return this._objRef?.isGroup}get type(){return this._objRef?.type}}$a.\u0275fac=function(){let i;return function(t){return(i||(i=le($a)))(t||$a)}}(),$a.\u0275cmp=$({type:$a,selectors:[["th-group"]],features:[ne([{provide:We,useExisting:ae(()=>$a)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const _D={uniforms:{tDiffuse:{value:null},shape:{value:1},radius:{value:4},rotateR:{value:Math.PI/12*1},rotateG:{value:Math.PI/12*2},rotateB:{value:Math.PI/12*3},scatter:{value:0},width:{value:1},height:{value:1},blending:{value:1},blendingMode:{value:1},greyscale:{value:!1},disable:{value:!1}},vertexShader:"\n\n\t\tvarying vec2 vUV;\n\n\t\tvoid main() {\n\n\t\t\tvUV = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\n\t\t}",fragmentShader:"\n\n\t\t#define SQRT2_MINUS_ONE 0.41421356\n\t\t#define SQRT2_HALF_MINUS_ONE 0.20710678\n\t\t#define PI2 6.28318531\n\t\t#define SHAPE_DOT 1\n\t\t#define SHAPE_ELLIPSE 2\n\t\t#define SHAPE_LINE 3\n\t\t#define SHAPE_SQUARE 4\n\t\t#define BLENDING_LINEAR 1\n\t\t#define BLENDING_MULTIPLY 2\n\t\t#define BLENDING_ADD 3\n\t\t#define BLENDING_LIGHTER 4\n\t\t#define BLENDING_DARKER 5\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float radius;\n\t\tuniform float rotateR;\n\t\tuniform float rotateG;\n\t\tuniform float rotateB;\n\t\tuniform float scatter;\n\t\tuniform float width;\n\t\tuniform float height;\n\t\tuniform int shape;\n\t\tuniform bool disable;\n\t\tuniform float blending;\n\t\tuniform int blendingMode;\n\t\tvarying vec2 vUV;\n\t\tuniform bool greyscale;\n\t\tconst int samples = 8;\n\n\t\tfloat blend( float a, float b, float t ) {\n\n\t\t// linear blend\n\t\t\treturn a * ( 1.0 - t ) + b * t;\n\n\t\t}\n\n\t\tfloat hypot( float x, float y ) {\n\n\t\t// vector magnitude\n\t\t\treturn sqrt( x * x + y * y );\n\n\t\t}\n\n\t\tfloat rand( vec2 seed ){\n\n\t\t// get pseudo-random number\n\t\t\treturn fract( sin( dot( seed.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453 );\n\n\t\t}\n\n\t\tfloat distanceToDotRadius( float channel, vec2 coord, vec2 normal, vec2 p, float angle, float rad_max ) {\n\n\t\t// apply shape-specific transforms\n\t\t\tfloat dist = hypot( coord.x - p.x, coord.y - p.y );\n\t\t\tfloat rad = channel;\n\n\t\t\tif ( shape == SHAPE_DOT ) {\n\n\t\t\t\trad = pow( abs( rad ), 1.125 ) * rad_max;\n\n\t\t\t} else if ( shape == SHAPE_ELLIPSE ) {\n\n\t\t\t\trad = pow( abs( rad ), 1.125 ) * rad_max;\n\n\t\t\t\tif ( dist != 0.0 ) {\n\t\t\t\t\tfloat dot_p = abs( ( p.x - coord.x ) / dist * normal.x + ( p.y - coord.y ) / dist * normal.y );\n\t\t\t\t\tdist = ( dist * ( 1.0 - SQRT2_HALF_MINUS_ONE ) ) + dot_p * dist * SQRT2_MINUS_ONE;\n\t\t\t\t}\n\n\t\t\t} else if ( shape == SHAPE_LINE ) {\n\n\t\t\t\trad = pow( abs( rad ), 1.5) * rad_max;\n\t\t\t\tfloat dot_p = ( p.x - coord.x ) * normal.x + ( p.y - coord.y ) * normal.y;\n\t\t\t\tdist = hypot( normal.x * dot_p, normal.y * dot_p );\n\n\t\t\t} else if ( shape == SHAPE_SQUARE ) {\n\n\t\t\t\tfloat theta = atan( p.y - coord.y, p.x - coord.x ) - angle;\n\t\t\t\tfloat sin_t = abs( sin( theta ) );\n\t\t\t\tfloat cos_t = abs( cos( theta ) );\n\t\t\t\trad = pow( abs( rad ), 1.4 );\n\t\t\t\trad = rad_max * ( rad + ( ( sin_t > cos_t ) ? rad - sin_t * rad : rad - cos_t * rad ) );\n\n\t\t\t}\n\n\t\t\treturn rad - dist;\n\n\t\t}\n\n\t\tstruct Cell {\n\n\t\t// grid sample positions\n\t\t\tvec2 normal;\n\t\t\tvec2 p1;\n\t\t\tvec2 p2;\n\t\t\tvec2 p3;\n\t\t\tvec2 p4;\n\t\t\tfloat samp2;\n\t\t\tfloat samp1;\n\t\t\tfloat samp3;\n\t\t\tfloat samp4;\n\n\t\t};\n\n\t\tvec4 getSample( vec2 point ) {\n\n\t\t// multi-sampled point\n\t\t\tvec4 tex = texture2D( tDiffuse, vec2( point.x / width, point.y / height ) );\n\t\t\tfloat base = rand( vec2( floor( point.x ), floor( point.y ) ) ) * PI2;\n\t\t\tfloat step = PI2 / float( samples );\n\t\t\tfloat dist = radius * 0.66;\n\n\t\t\tfor ( int i = 0; i < samples; ++i ) {\n\n\t\t\t\tfloat r = base + step * float( i );\n\t\t\t\tvec2 coord = point + vec2( cos( r ) * dist, sin( r ) * dist );\n\t\t\t\ttex += texture2D( tDiffuse, vec2( coord.x / width, coord.y / height ) );\n\n\t\t\t}\n\n\t\t\ttex /= float( samples ) + 1.0;\n\t\t\treturn tex;\n\n\t\t}\n\n\t\tfloat getDotColour( Cell c, vec2 p, int channel, float angle, float aa ) {\n\n\t\t// get colour for given point\n\t\t\tfloat dist_c_1, dist_c_2, dist_c_3, dist_c_4, res;\n\n\t\t\tif ( channel == 0 ) {\n\n\t\t\t\tc.samp1 = getSample( c.p1 ).r;\n\t\t\t\tc.samp2 = getSample( c.p2 ).r;\n\t\t\t\tc.samp3 = getSample( c.p3 ).r;\n\t\t\t\tc.samp4 = getSample( c.p4 ).r;\n\n\t\t\t} else if (channel == 1) {\n\n\t\t\t\tc.samp1 = getSample( c.p1 ).g;\n\t\t\t\tc.samp2 = getSample( c.p2 ).g;\n\t\t\t\tc.samp3 = getSample( c.p3 ).g;\n\t\t\t\tc.samp4 = getSample( c.p4 ).g;\n\n\t\t\t} else {\n\n\t\t\t\tc.samp1 = getSample( c.p1 ).b;\n\t\t\t\tc.samp3 = getSample( c.p3 ).b;\n\t\t\t\tc.samp2 = getSample( c.p2 ).b;\n\t\t\t\tc.samp4 = getSample( c.p4 ).b;\n\n\t\t\t}\n\n\t\t\tdist_c_1 = distanceToDotRadius( c.samp1, c.p1, c.normal, p, angle, radius );\n\t\t\tdist_c_2 = distanceToDotRadius( c.samp2, c.p2, c.normal, p, angle, radius );\n\t\t\tdist_c_3 = distanceToDotRadius( c.samp3, c.p3, c.normal, p, angle, radius );\n\t\t\tdist_c_4 = distanceToDotRadius( c.samp4, c.p4, c.normal, p, angle, radius );\n\t\t\tres = ( dist_c_1 > 0.0 ) ? clamp( dist_c_1 / aa, 0.0, 1.0 ) : 0.0;\n\t\t\tres += ( dist_c_2 > 0.0 ) ? clamp( dist_c_2 / aa, 0.0, 1.0 ) : 0.0;\n\t\t\tres += ( dist_c_3 > 0.0 ) ? clamp( dist_c_3 / aa, 0.0, 1.0 ) : 0.0;\n\t\t\tres += ( dist_c_4 > 0.0 ) ? clamp( dist_c_4 / aa, 0.0, 1.0 ) : 0.0;\n\t\t\tres = clamp( res, 0.0, 1.0 );\n\n\t\t\treturn res;\n\n\t\t}\n\n\t\tCell getReferenceCell( vec2 p, vec2 origin, float grid_angle, float step ) {\n\n\t\t// get containing cell\n\t\t\tCell c;\n\n\t\t// calc grid\n\t\t\tvec2 n = vec2( cos( grid_angle ), sin( grid_angle ) );\n\t\t\tfloat threshold = step * 0.5;\n\t\t\tfloat dot_normal = n.x * ( p.x - origin.x ) + n.y * ( p.y - origin.y );\n\t\t\tfloat dot_line = -n.y * ( p.x - origin.x ) + n.x * ( p.y - origin.y );\n\t\t\tvec2 offset = vec2( n.x * dot_normal, n.y * dot_normal );\n\t\t\tfloat offset_normal = mod( hypot( offset.x, offset.y ), step );\n\t\t\tfloat normal_dir = ( dot_normal < 0.0 ) ? 1.0 : -1.0;\n\t\t\tfloat normal_scale = ( ( offset_normal < threshold ) ? -offset_normal : step - offset_normal ) * normal_dir;\n\t\t\tfloat offset_line = mod( hypot( ( p.x - offset.x ) - origin.x, ( p.y - offset.y ) - origin.y ), step );\n\t\t\tfloat line_dir = ( dot_line < 0.0 ) ? 1.0 : -1.0;\n\t\t\tfloat line_scale = ( ( offset_line < threshold ) ? -offset_line : step - offset_line ) * line_dir;\n\n\t\t// get closest corner\n\t\t\tc.normal = n;\n\t\t\tc.p1.x = p.x - n.x * normal_scale + n.y * line_scale;\n\t\t\tc.p1.y = p.y - n.y * normal_scale - n.x * line_scale;\n\n\t\t// scatter\n\t\t\tif ( scatter != 0.0 ) {\n\n\t\t\t\tfloat off_mag = scatter * threshold * 0.5;\n\t\t\t\tfloat off_angle = rand( vec2( floor( c.p1.x ), floor( c.p1.y ) ) ) * PI2;\n\t\t\t\tc.p1.x += cos( off_angle ) * off_mag;\n\t\t\t\tc.p1.y += sin( off_angle ) * off_mag;\n\n\t\t\t}\n\n\t\t// find corners\n\t\t\tfloat normal_step = normal_dir * ( ( offset_normal < threshold ) ? step : -step );\n\t\t\tfloat line_step = line_dir * ( ( offset_line < threshold ) ? step : -step );\n\t\t\tc.p2.x = c.p1.x - n.x * normal_step;\n\t\t\tc.p2.y = c.p1.y - n.y * normal_step;\n\t\t\tc.p3.x = c.p1.x + n.y * line_step;\n\t\t\tc.p3.y = c.p1.y - n.x * line_step;\n\t\t\tc.p4.x = c.p1.x - n.x * normal_step + n.y * line_step;\n\t\t\tc.p4.y = c.p1.y - n.y * normal_step - n.x * line_step;\n\n\t\t\treturn c;\n\n\t\t}\n\n\t\tfloat blendColour( float a, float b, float t ) {\n\n\t\t// blend colours\n\t\t\tif ( blendingMode == BLENDING_LINEAR ) {\n\t\t\t\treturn blend( a, b, 1.0 - t );\n\t\t\t} else if ( blendingMode == BLENDING_ADD ) {\n\t\t\t\treturn blend( a, min( 1.0, a + b ), t );\n\t\t\t} else if ( blendingMode == BLENDING_MULTIPLY ) {\n\t\t\t\treturn blend( a, max( 0.0, a * b ), t );\n\t\t\t} else if ( blendingMode == BLENDING_LIGHTER ) {\n\t\t\t\treturn blend( a, max( a, b ), t );\n\t\t\t} else if ( blendingMode == BLENDING_DARKER ) {\n\t\t\t\treturn blend( a, min( a, b ), t );\n\t\t\t} else {\n\t\t\t\treturn blend( a, b, 1.0 - t );\n\t\t\t}\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tif ( ! disable ) {\n\n\t\t// setup\n\t\t\t\tvec2 p = vec2( vUV.x * width, vUV.y * height );\n\t\t\t\tvec2 origin = vec2( 0, 0 );\n\t\t\t\tfloat aa = ( radius < 2.5 ) ? radius * 0.5 : 1.25;\n\n\t\t// get channel samples\n\t\t\t\tCell cell_r = getReferenceCell( p, origin, rotateR, radius );\n\t\t\t\tCell cell_g = getReferenceCell( p, origin, rotateG, radius );\n\t\t\t\tCell cell_b = getReferenceCell( p, origin, rotateB, radius );\n\t\t\t\tfloat r = getDotColour( cell_r, p, 0, rotateR, aa );\n\t\t\t\tfloat g = getDotColour( cell_g, p, 1, rotateG, aa );\n\t\t\t\tfloat b = getDotColour( cell_b, p, 2, rotateB, aa );\n\n\t\t// blend with original\n\t\t\t\tvec4 colour = texture2D( tDiffuse, vUV );\n\t\t\t\tr = blendColour( r, colour.r, blending );\n\t\t\t\tg = blendColour( g, colour.g, blending );\n\t\t\t\tb = blendColour( b, colour.b, blending );\n\n\t\t\t\tif ( greyscale ) {\n\t\t\t\t\tr = g = b = (r + b + g) / 3.0;\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = vec4( r, g, b, 1.0 );\n\n\t\t\t} else {\n\n\t\t\t\tgl_FragColor = texture2D( tDiffuse, vUV );\n\n\t\t\t}\n\n\t\t}"};class dbe extends wn{constructor(e,t,n){super(),this.uniforms=gi.clone(_D.uniforms),this.material=new Pt({uniforms:this.uniforms,fragmentShader:_D.fragmentShader,vertexShader:_D.vertexShader}),this.uniforms.width.value=e,this.uniforms.height.value=t;for(const r in n)n.hasOwnProperty(r)&&this.uniforms.hasOwnProperty(r)&&(this.uniforms[r].value=n[r]);this.fsQuad=new xr(this.material)}render(e,t,n){this.material.uniforms.tDiffuse.value=n.texture,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}setSize(e,t){this.uniforms.width.value=e,this.uniforms.height.value=t}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class Tm extends Yi{getType(){return dbe}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}get uniforms(){return this._objRef?.uniforms}set material(e){this._objRef&&(this._objRef.material=e)}get material(){return this._objRef?.material}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}}Tm.\u0275fac=function(){let i;return function(t){return(i||(i=le(Tm)))(t||Tm)}}(),Tm.\u0275cmp=$({type:Tm,selectors:[["th-halftonePass"]],inputs:{uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[ne([{provide:Li,useExisting:ae(()=>Tm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Rm extends We{getType(){return b5}get type(){return this._objRef?.type}set light(e){this._objRef&&(this._objRef.light=e)}get light(){return this._objRef?.light}set matrix(e){this._objRef&&(this._objRef.matrix=Ye(this._objRef.matrix,e))}get matrix(){return this._objRef?.matrix}set matrixAutoUpdate(e){this._objRef&&(this._objRef.matrixAutoUpdate=e)}get matrixAutoUpdate(){return this._objRef?.matrixAutoUpdate}set material(e){this._objRef&&(this._objRef.material=e)}get material(){return this._objRef?.material}set color(e){this._objRef&&(this._objRef.color=e)}get color(){return this._objRef?.color}}Rm.\u0275fac=function(){let i;return function(t){return(i||(i=le(Rm)))(t||Rm)}}(),Rm.\u0275cmp=$({type:Rm,selectors:[["th-hemisphereLightHelper"]],inputs:{light:"light",matrix:"matrix",matrixAutoUpdate:"matrixAutoUpdate",material:"material",color:"color"},features:[ne([{provide:We,useExisting:ae(()=>Rm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Im extends Hc{getType(){return q4}get isHemisphereLightProbe(){return this._objRef?.isHemisphereLightProbe}}Im.\u0275fac=function(){let i;return function(t){return(i||(i=le(Im)))(t||Im)}}(),Im.\u0275cmp=$({type:Im,selectors:[["th-hemisphereLightProbe"]],features:[ne([{provide:We,useExisting:ae(()=>Im)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class nh extends Ka{getType(){return bp}get type(){return this._objRef?.type}}nh.\u0275fac=function(){let i;return function(t){return(i||(i=le(nh)))(t||nh)}}(),nh.\u0275cmp=$({type:nh,selectors:[["th-icosahedronGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>nh)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Dm extends Rt{getType(){return VR}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}get isInstancedBufferGeometry(){return this._objRef?.isInstancedBufferGeometry}set instanceCount(e){this._objRef&&(this._objRef.instanceCount=e)}get instanceCount(){return this._objRef?.instanceCount}}Dm.\u0275fac=function(){let i;return function(t){return(i||(i=le(Dm)))(t||Dm)}}(),Dm.\u0275cmp=$({type:Dm,selectors:[["th-instancedBufferGeometry"]],inputs:{type:"type",instanceCount:"instanceCount"},features:[ne([{provide:Rt,useExisting:ae(()=>Dm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class rh extends Pn{getType(){return bx}get isInstancedMesh(){return this._objRef?.isInstancedMesh}set boundingBox(e){this._objRef&&(this._objRef.boundingBox=Ye(this._objRef.boundingBox,e))}get boundingBox(){return this._objRef?.boundingBox}set boundingSphere(e){this._objRef&&(this._objRef.boundingSphere=Ye(this._objRef.boundingSphere,e))}get boundingSphere(){return this._objRef?.boundingSphere}set count(e){this._objRef&&(this._objRef.count=e)}get count(){return this._objRef?.count}set instanceColor(e){this._objRef&&(this._objRef.instanceColor=Ye(this._objRef.instanceColor,e))}get instanceColor(){return this._objRef?.instanceColor}set instanceMatrix(e){this._objRef&&(this._objRef.instanceMatrix=Ye(this._objRef.instanceMatrix,e))}get instanceMatrix(){return this._objRef?.instanceMatrix}}rh.\u0275fac=function(){let i;return function(t){return(i||(i=le(rh)))(t||rh)}}(),rh.\u0275cmp=$({type:rh,selectors:[["th-instancedMesh"]],inputs:{boundingBox:"boundingBox",boundingSphere:"boundingSphere",count:"count",instanceColor:"instanceColor",instanceMatrix:"instanceMatrix"},features:[ne([{provide:We,useExisting:ae(()=>rh)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Pm extends Rt{getType(){return ou}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}}Pm.\u0275fac=function(){let i;return function(t){return(i||(i=le(Pm)))(t||Pm)}}(),Pm.\u0275cmp=$({type:Pm,selectors:[["th-latheGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>Pm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class qw{constructor(e=Math){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(let t=0;t<256;t++)this.p[t]=Math.floor(256*e.random());this.perm=[];for(let t=0;t<512;t++)this.perm[t]=this.p[255&t];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}dot(e,t,n){return e[0]*t+e[1]*n}dot3(e,t,n,r){return e[0]*t+e[1]*n+e[2]*r}dot4(e,t,n,r,s){return e[0]*t+e[1]*n+e[2]*r+e[3]*s}noise(e,t){let n,r,s;const a=(e+t)*(.5*(Math.sqrt(3)-1)),l=Math.floor(e+a),c=Math.floor(t+a),d=(3-Math.sqrt(3))/6,u=(l+c)*d,m=e-(l-u),_=t-(c-u);let g,p;m>_?(g=1,p=0):(g=0,p=1);const v=m-g+d,b=_-p+d,y=m-1+2*d,x=_-1+2*d,w=255&l,E=255&c,C=this.perm[w+g+this.perm[E+p]]%12,T=this.perm[w+1+this.perm[E+1]]%12;let k=.5-m*m-_*_;k<0?n=0:(k*=k,n=k*k*this.dot(this.grad3[this.perm[w+this.perm[E]]%12],m,_));let U=.5-v*v-b*b;U<0?r=0:(U*=U,r=U*U*this.dot(this.grad3[C],v,b));let L=.5-y*y-x*x;return L<0?s=0:(L*=L,s=L*L*this.dot(this.grad3[T],y,x)),70*(n+r+s)}noise3d(e,t,n){let r,s,o,a;const c=.3333333333333333*(e+t+n),d=Math.floor(e+c),u=Math.floor(t+c),h=Math.floor(n+c),f=1/6,m=(d+u+h)*f,v=e-(d-m),b=t-(u-m),y=n-(h-m);let x,w,E,S,C,T;v>=b?b>=y?(x=1,w=0,E=0,S=1,C=1,T=0):v>=y?(x=1,w=0,E=0,S=1,C=0,T=1):(x=0,w=0,E=1,S=1,C=0,T=1):b<y?(x=0,w=0,E=1,S=0,C=1,T=1):v<y?(x=0,w=1,E=0,S=0,C=1,T=1):(x=0,w=1,E=0,S=1,C=1,T=0);const k=v-x+f,U=b-w+f,L=y-E+f,j=v-S+2*f,H=b-C+2*f,B=y-T+2*f,V=v-1+.5,O=b-1+.5,Q=y-1+.5,oe=255&d,be=255&u,de=255&h,Y=this.perm[oe+x+this.perm[be+w+this.perm[de+E]]]%12,re=this.perm[oe+S+this.perm[be+C+this.perm[de+T]]]%12,J=this.perm[oe+1+this.perm[be+1+this.perm[de+1]]]%12;let D=.6-v*v-b*b-y*y;D<0?r=0:(D*=D,r=D*D*this.dot3(this.grad3[this.perm[oe+this.perm[be+this.perm[de]]]%12],v,b,y));let ue=.6-k*k-U*U-L*L;ue<0?s=0:(ue*=ue,s=ue*ue*this.dot3(this.grad3[Y],k,U,L));let Ee=.6-j*j-H*H-B*B;Ee<0?o=0:(Ee*=Ee,o=Ee*Ee*this.dot3(this.grad3[re],j,H,B));let me=.6-V*V-O*O-Q*Q;return me<0?a=0:(me*=me,a=me*me*this.dot3(this.grad3[J],V,O,Q)),32*(r+s+o+a)}noise4d(e,t,n,r){const s=this.grad4,o=this.simplex,a=this.perm,l=(Math.sqrt(5)-1)/4,c=(5-Math.sqrt(5))/20;let d,u,h,f,m;const _=(e+t+n+r)*l,g=Math.floor(e+_),p=Math.floor(t+_),v=Math.floor(n+_),b=Math.floor(r+_),y=(g+p+v+b)*c,C=e-(g-y),T=t-(p-y),k=n-(v-y),U=r-(b-y),Q=(C>T?32:0)+(C>k?16:0)+(T>k?8:0)+(C>U?4:0)+(T>U?2:0)+(k>U?1:0),oe=o[Q][0]>=3?1:0,be=o[Q][1]>=3?1:0,de=o[Q][2]>=3?1:0,X=o[Q][3]>=3?1:0,Y=o[Q][0]>=2?1:0,re=o[Q][1]>=2?1:0,J=o[Q][2]>=2?1:0,D=o[Q][3]>=2?1:0,ue=o[Q][0]>=1?1:0,Ee=o[Q][1]>=1?1:0,me=o[Q][2]>=1?1:0,qe=o[Q][3]>=1?1:0,Me=C-oe+c,we=T-be+c,Se=k-de+c,it=U-X+c,Xe=C-Y+2*c,At=T-re+2*c,yt=k-J+2*c,lt=U-D+2*c,ht=C-ue+3*c,xt=T-Ee+3*c,N=k-me+3*c,F=U-qe+3*c,Ae=C-1+4*c,ke=T-1+4*c,Ue=k-1+4*c,et=U-1+4*c,Z=255&g,Ie=255&p,ye=255&v,Je=255&b,pt=a[Z+oe+a[Ie+be+a[ye+de+a[Je+X]]]]%32,$e=a[Z+Y+a[Ie+re+a[ye+J+a[Je+D]]]]%32,tt=a[Z+ue+a[Ie+Ee+a[ye+me+a[Je+qe]]]]%32,Lt=a[Z+1+a[Ie+1+a[ye+1+a[Je+1]]]]%32;let It=.6-C*C-T*T-k*k-U*U;It<0?d=0:(It*=It,d=It*It*this.dot4(s[a[Z+a[Ie+a[ye+a[Je]]]]%32],C,T,k,U));let Jt=.6-Me*Me-we*we-Se*Se-it*it;Jt<0?u=0:(Jt*=Jt,u=Jt*Jt*this.dot4(s[pt],Me,we,Se,it));let se=.6-Xe*Xe-At*At-yt*yt-lt*lt;se<0?h=0:(se*=se,h=se*se*this.dot4(s[$e],Xe,At,yt,lt));let te=.6-ht*ht-xt*xt-N*N-F*F;te<0?f=0:(te*=te,f=te*te*this.dot4(s[tt],ht,xt,N,F));let Ge=.6-Ae*Ae-ke*ke-Ue*Ue-et*et;return Ge<0?m=0:(Ge*=Ge,m=Ge*Ge*this.dot4(s[Lt],Ae,ke,Ue,et)),27*(d+u+h+f+m)}}class Wi extends Mt{constructor(e={}){super(),this.isLightningStrike=!0,this.type="LightningStrike",this.init(Wi.copyParameters(e,e)),this.createMesh()}static createRandomGenerator(){const t=[];for(let r=0;r<2053;r++)t.push(Math.random());const n={currentSeed:0,random:function(){const r=t[n.currentSeed];return n.currentSeed=(n.currentSeed+1)%2053,r},getSeed:function(){return n.currentSeed/2053},setSeed:function(r){n.currentSeed=Math.floor(2053*r)%2053}};return n}static copyParameters(e={},t={}){const n=function(r){return t===e?r:r.clone()};return e.sourceOffset=void 0!==t.sourceOffset?n(t.sourceOffset):new R(0,100,0),e.destOffset=void 0!==t.destOffset?n(t.destOffset):new R(0,0,0),e.timeScale=void 0!==t.timeScale?t.timeScale:1,e.roughness=void 0!==t.roughness?t.roughness:.9,e.straightness=void 0!==t.straightness?t.straightness:.7,e.up0=void 0!==t.up0?n(t.up0):new R(0,0,1),e.up1=void 0!==t.up1?n(t.up1):new R(0,0,1),e.radius0=void 0!==t.radius0?t.radius0:1,e.radius1=void 0!==t.radius1?t.radius1:1,e.radius0Factor=void 0!==t.radius0Factor?t.radius0Factor:.5,e.radius1Factor=void 0!==t.radius1Factor?t.radius1Factor:.2,e.minRadius=void 0!==t.minRadius?t.minRadius:.2,e.isEternal=void 0!==t.isEternal?t.isEternal:void 0===t.birthTime||void 0===t.deathTime,e.birthTime=t.birthTime,e.deathTime=t.deathTime,e.propagationTimeFactor=void 0!==t.propagationTimeFactor?t.propagationTimeFactor:.1,e.vanishingTimeFactor=void 0!==t.vanishingTimeFactor?t.vanishingTimeFactor:.9,e.subrayPeriod=void 0!==t.subrayPeriod?t.subrayPeriod:4,e.subrayDutyCycle=void 0!==t.subrayDutyCycle?t.subrayDutyCycle:.6,e.maxIterations=void 0!==t.maxIterations?t.maxIterations:9,e.isStatic=void 0!==t.isStatic&&t.isStatic,e.ramification=void 0!==t.ramification?t.ramification:5,e.maxSubrayRecursion=void 0!==t.maxSubrayRecursion?t.maxSubrayRecursion:3,e.recursionProbability=void 0!==t.recursionProbability?t.recursionProbability:.6,e.generateUVs=void 0!==t.generateUVs&&t.generateUVs,e.randomGenerator=t.randomGenerator,e.noiseSeed=t.noiseSeed,e.onDecideSubrayCreation=t.onDecideSubrayCreation,e.onSubrayCreation=t.onSubrayCreation,e}update(e){this.isStatic||(this.rayParameters.isEternal||this.rayParameters.birthTime<=e&&e<=this.rayParameters.deathTime?(this.updateMesh(e),this.state=e<this.subrays[0].endPropagationTime?Wi.RAY_PROPAGATING:e>this.subrays[0].beginVanishingTime?Wi.RAY_VANISHING:Wi.RAY_STEADY,this.visible=!0):(this.visible=!1,this.state=e<this.rayParameters.birthTime?Wi.RAY_UNBORN:Wi.RAY_EXTINGUISHED))}init(e){this.rayParameters=e,this.maxIterations=void 0!==e.maxIterations?Math.floor(e.maxIterations):9,e.maxIterations=this.maxIterations,this.isStatic=void 0!==e.isStatic&&e.isStatic,e.isStatic=this.isStatic,this.ramification=void 0!==e.ramification?Math.floor(e.ramification):5,e.ramification=this.ramification,this.maxSubrayRecursion=void 0!==e.maxSubrayRecursion?Math.floor(e.maxSubrayRecursion):3,e.maxSubrayRecursion=this.maxSubrayRecursion,this.recursionProbability=void 0!==e.recursionProbability?e.recursionProbability:.6,e.recursionProbability=this.recursionProbability,this.generateUVs=void 0!==e.generateUVs&&e.generateUVs,e.generateUVs=this.generateUVs,void 0!==e.randomGenerator?(this.randomGenerator=e.randomGenerator,this.seedGenerator=e.randomGenerator,void 0!==e.noiseSeed&&this.seedGenerator.setSeed(e.noiseSeed)):(this.randomGenerator=Wi.createRandomGenerator(),this.seedGenerator=Math),void 0!==e.onDecideSubrayCreation?this.onDecideSubrayCreation=e.onDecideSubrayCreation:(this.createDefaultSubrayCreationCallbacks(),void 0!==e.onSubrayCreation&&(this.onSubrayCreation=e.onSubrayCreation)),this.state=Wi.RAY_INITIALIZED,this.maxSubrays=Math.ceil(1+Math.pow(this.ramification,Math.max(0,this.maxSubrayRecursion-1))),e.maxSubrays=this.maxSubrays,this.maxRaySegments=2*(1<<this.maxIterations),this.subrays=[];for(let t=0;t<this.maxSubrays;t++)this.subrays.push(this.createSubray());this.raySegments=[];for(let t=0;t<this.maxRaySegments;t++)this.raySegments.push(this.createSegment());this.time=0,this.timeFraction=0,this.currentSegmentCallback=null,this.currentCreateTriangleVertices=this.generateUVs?this.createTriangleVerticesWithUVs:this.createTriangleVerticesWithoutUVs,this.numSubrays=0,this.currentSubray=null,this.currentSegmentIndex=0,this.isInitialSegment=!1,this.subrayProbability=0,this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.vertices=null,this.uvs=null,this.indices=null,this.positionAttribute=null,this.uvsAttribute=null,this.simplexX=new qw(this.seedGenerator),this.simplexY=new qw(this.seedGenerator),this.simplexZ=new qw(this.seedGenerator),this.forwards=new R,this.forwardsFill=new R,this.side=new R,this.down=new R,this.middlePos=new R,this.middleLinPos=new R,this.newPos=new R,this.vPos=new R,this.cross1=new R}createMesh(){const e=1<<this.maxIterations,t=3*(e+1)*this.maxSubrays,n=18*e*this.maxSubrays;this.vertices=new Float32Array(3*t),this.indices=new Uint32Array(n),this.generateUVs&&(this.uvs=new Float32Array(2*t)),this.fillMesh(0),this.setIndex(new qy(this.indices,1)),this.positionAttribute=new Ke(this.vertices,3),this.setAttribute("position",this.positionAttribute),this.generateUVs&&(this.uvsAttribute=new Ke(new Float32Array(this.uvs),2),this.setAttribute("uv",this.uvsAttribute)),this.isStatic||(this.index.usage=By,this.positionAttribute.usage=By,this.generateUVs&&(this.uvsAttribute.usage=By)),this.vertices=this.positionAttribute.array,this.indices=this.index.array,this.generateUVs&&(this.uvs=this.uvsAttribute.array)}updateMesh(e){this.fillMesh(e),this.drawRange.count=this.currentIndex,this.index.needsUpdate=!0,this.positionAttribute.needsUpdate=!0,this.generateUVs&&(this.uvsAttribute.needsUpdate=!0)}fillMesh(e){const t=this;this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.fractalRay(e,function(r){const s=t.currentSubray;e<s.birthTime||(this.rayParameters.isEternal&&0==t.currentSubray.recursion?(t.createPrism(r),t.onDecideSubrayCreation(r,t)):e<s.endPropagationTime?t.timeFraction>=r.fraction0*s.propagationTimeFactor&&(t.createPrism(r),t.onDecideSubrayCreation(r,t)):e<s.beginVanishingTime?(t.createPrism(r),t.onDecideSubrayCreation(r,t)):(t.timeFraction<=s.vanishingTimeFactor+r.fraction1*(1-s.vanishingTimeFactor)&&t.createPrism(r),t.onDecideSubrayCreation(r,t)))})}addNewSubray(){return this.subrays[this.numSubrays++]}initSubray(e,t){e.pos0.copy(t.sourceOffset),e.pos1.copy(t.destOffset),e.up0.copy(t.up0),e.up1.copy(t.up1),e.radius0=t.radius0,e.radius1=t.radius1,e.birthTime=t.birthTime,e.deathTime=t.deathTime,e.timeScale=t.timeScale,e.roughness=t.roughness,e.straightness=t.straightness,e.propagationTimeFactor=t.propagationTimeFactor,e.vanishingTimeFactor=t.vanishingTimeFactor,e.maxIterations=this.maxIterations,e.seed=void 0!==t.noiseSeed?t.noiseSeed:0,e.recursion=0}fractalRay(e,t){this.time=e,this.currentSegmentCallback=t,this.numSubrays=0,this.initSubray(this.addNewSubray(),this.rayParameters);for(let n=0;n<this.numSubrays;n++){const r=this.subrays[n];this.currentSubray=r,this.randomGenerator.setSeed(r.seed),r.endPropagationTime=ft.lerp(r.birthTime,r.deathTime,r.propagationTimeFactor),r.beginVanishingTime=ft.lerp(r.deathTime,r.birthTime,1-r.vanishingTimeFactor);const s=this.randomGenerator.random;r.linPos0.set(s(),s(),s()).multiplyScalar(1e3),r.linPos1.set(s(),s(),s()).multiplyScalar(1e3),this.timeFraction=(e-r.birthTime)/(r.deathTime-r.birthTime),this.currentSegmentIndex=0,this.isInitialSegment=!0;const o=this.getNewSegment();o.iteration=0,o.pos0.copy(r.pos0),o.pos1.copy(r.pos1),o.linPos0.copy(r.linPos0),o.linPos1.copy(r.linPos1),o.up0.copy(r.up0),o.up1.copy(r.up1),o.radius0=r.radius0,o.radius1=r.radius1,o.fraction0=0,o.fraction1=1,o.positionVariationFactor=1-r.straightness,this.subrayProbability=this.ramification*Math.pow(this.recursionProbability,r.recursion)/(1<<r.maxIterations),this.fractalRayRecursive(o)}this.currentSegmentCallback=null,this.currentSubray=null}fractalRayRecursive(e){if(e.iteration>=this.currentSubray.maxIterations)return void this.currentSegmentCallback(e);this.forwards.subVectors(e.pos1,e.pos0);let t=this.forwards.length();t<1e-6&&(this.forwards.set(0,0,.01),t=this.forwards.length());const n=.5*(e.radius0+e.radius1),r=.5*(e.fraction0+e.fraction1),s=this.time*this.currentSubray.timeScale*Math.pow(2,e.iteration);this.middlePos.lerpVectors(e.pos0,e.pos1,.5),this.middleLinPos.lerpVectors(e.linPos0,e.linPos1,.5);const o=this.middleLinPos;this.newPos.set(this.simplexX.noise4d(o.x,o.y,o.z,s),this.simplexY.noise4d(o.x,o.y,o.z,s),this.simplexZ.noise4d(o.x,o.y,o.z,s)),this.newPos.multiplyScalar(e.positionVariationFactor*t),this.newPos.add(this.middlePos);const a=this.getNewSegment();a.pos0.copy(e.pos0),a.pos1.copy(this.newPos),a.linPos0.copy(e.linPos0),a.linPos1.copy(this.middleLinPos),a.up0.copy(e.up0),a.up1.copy(e.up1),a.radius0=e.radius0,a.radius1=n,a.fraction0=e.fraction0,a.fraction1=r,a.positionVariationFactor=e.positionVariationFactor*this.currentSubray.roughness,a.iteration=e.iteration+1;const l=this.getNewSegment();l.pos0.copy(this.newPos),l.pos1.copy(e.pos1),l.linPos0.copy(this.middleLinPos),l.linPos1.copy(e.linPos1),this.cross1.crossVectors(e.up0,this.forwards.normalize()),l.up0.crossVectors(this.forwards,this.cross1).normalize(),l.up1.copy(e.up1),l.radius0=n,l.radius1=e.radius1,l.fraction0=r,l.fraction1=e.fraction1,l.positionVariationFactor=e.positionVariationFactor*this.currentSubray.roughness,l.iteration=e.iteration+1,this.fractalRayRecursive(a),this.fractalRayRecursive(l)}createPrism(e){this.forwardsFill.subVectors(e.pos1,e.pos0).normalize(),this.isInitialSegment&&(this.currentCreateTriangleVertices(e.pos0,e.up0,this.forwardsFill,e.radius0,0),this.isInitialSegment=!1),this.currentCreateTriangleVertices(e.pos1,e.up0,this.forwardsFill,e.radius1,e.fraction1),this.createPrismFaces()}createTriangleVerticesWithoutUVs(e,t,n,r){this.side.crossVectors(t,n).multiplyScalar(r*Wi.COS30DEG),this.down.copy(t).multiplyScalar(-r*Wi.SIN30DEG);const s=this.vPos,o=this.vertices;s.copy(e).sub(this.side).add(this.down),o[this.currentCoordinate++]=s.x,o[this.currentCoordinate++]=s.y,o[this.currentCoordinate++]=s.z,s.copy(e).add(this.side).add(this.down),o[this.currentCoordinate++]=s.x,o[this.currentCoordinate++]=s.y,o[this.currentCoordinate++]=s.z,s.copy(t).multiplyScalar(r).add(e),o[this.currentCoordinate++]=s.x,o[this.currentCoordinate++]=s.y,o[this.currentCoordinate++]=s.z,this.currentVertex+=3}createTriangleVerticesWithUVs(e,t,n,r,s){this.side.crossVectors(t,n).multiplyScalar(r*Wi.COS30DEG),this.down.copy(t).multiplyScalar(-r*Wi.SIN30DEG);const o=this.vPos,a=this.vertices,l=this.uvs;o.copy(e).sub(this.side).add(this.down),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=s,l[this.currentUVCoordinate++]=0,o.copy(e).add(this.side).add(this.down),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=s,l[this.currentUVCoordinate++]=.5,o.copy(t).multiplyScalar(r).add(e),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=s,l[this.currentUVCoordinate++]=1,this.currentVertex+=3}createPrismFaces(e){const t=this.indices;e=this.currentVertex-6,t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+5,t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+5,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+5}createDefaultSubrayCreationCallbacks(){const e=this.randomGenerator.random;this.onDecideSubrayCreation=function(o,a){const l=a.currentSubray,c=a.rayParameters.subrayPeriod,d=a.rayParameters.subrayDutyCycle,u=a.rayParameters.isEternal&&0==l.recursion?-e()*c:ft.lerp(l.birthTime,l.endPropagationTime,o.fraction0)-e()*c,h=a.time-u,f=Math.floor(h/c),m=e()*(f+1);let g=0;if(h%c<=d*c&&(g=a.subrayProbability),l.recursion<a.maxSubrayRecursion&&a.numSubrays<a.maxSubrays&&e()<g){const p=a.addNewSubray(),v=a.randomGenerator.getSeed();p.seed=m,a.randomGenerator.setSeed(m),p.recursion=l.recursion+1,p.maxIterations=Math.max(1,l.maxIterations-1),p.linPos0.set(e(),e(),e()).multiplyScalar(1e3),p.linPos1.set(e(),e(),e()).multiplyScalar(1e3),p.up0.copy(l.up0),p.up1.copy(l.up1),p.radius0=o.radius0*a.rayParameters.radius0Factor,p.radius1=Math.min(a.rayParameters.minRadius,o.radius1*a.rayParameters.radius1Factor),p.birthTime=u+f*c,p.deathTime=p.birthTime+c*d,!a.rayParameters.isEternal&&0==l.recursion&&(p.birthTime=Math.max(p.birthTime,l.birthTime),p.deathTime=Math.min(p.deathTime,l.deathTime)),p.timeScale=2*l.timeScale,p.roughness=l.roughness,p.straightness=l.straightness,p.propagationTimeFactor=l.propagationTimeFactor,p.vanishingTimeFactor=l.vanishingTimeFactor,a.onSubrayCreation(o,l,p,a),a.randomGenerator.setSeed(v)}};const t=new R,n=new R,r=new R,s=new R;this.onSubrayCreation=function(o,a,l,c){c.subrayCylinderPosition(o,a,l,.5,.6,.2)},this.subrayConePosition=function(o,a,l,c,d,u){l.pos0.copy(o.pos0),t.subVectors(a.pos1,a.pos0),n.copy(t).normalize(),t.multiplyScalar(o.fraction0+(1-o.fraction0)*(e()*c));const h=t.length();r.crossVectors(a.up0,n);const f=2*Math.PI*e();r.multiplyScalar(Math.cos(f)),s.copy(a.up0).multiplyScalar(Math.sin(f)),l.pos1.copy(r).add(s).multiplyScalar(h*d*(u+e()*(1-u))).add(t).add(a.pos0)},this.subrayCylinderPosition=function(o,a,l,c,d,u){l.pos0.copy(o.pos0),t.subVectors(a.pos1,a.pos0),n.copy(t).normalize(),t.multiplyScalar(o.fraction0+(1-o.fraction0)*((2*e()-1)*c));const h=t.length();r.crossVectors(a.up0,n);const f=2*Math.PI*e();r.multiplyScalar(Math.cos(f)),s.copy(a.up0).multiplyScalar(Math.sin(f)),l.pos1.copy(r).add(s).multiplyScalar(h*d*(u+e()*(1-u))).add(t).add(a.pos0)}}createSubray(){return{seed:0,maxIterations:0,recursion:0,pos0:new R,pos1:new R,linPos0:new R,linPos1:new R,up0:new R,up1:new R,radius0:0,radius1:0,birthTime:0,deathTime:0,timeScale:0,roughness:0,straightness:0,propagationTimeFactor:0,vanishingTimeFactor:0,endPropagationTime:0,beginVanishingTime:0}}createSegment(){return{iteration:0,pos0:new R,pos1:new R,linPos0:new R,linPos1:new R,up0:new R,up1:new R,radius0:0,radius1:0,fraction0:0,fraction1:0,positionVariationFactor:0}}getNewSegment(){return this.raySegments[this.currentSegmentIndex++]}copy(e){return super.copy(e),this.init(Wi.copyParameters({},e.rayParameters)),this}clone(){return new this.constructor(Wi.copyParameters({},this.rayParameters))}}Wi.RAY_INITIALIZED=0,Wi.RAY_UNBORN=1,Wi.RAY_PROPAGATING=2,Wi.RAY_STEADY=3,Wi.RAY_VANISHING=4,Wi.RAY_EXTINGUISHED=5,Wi.COS30DEG=Math.cos(30*Math.PI/180),Wi.SIN30DEG=Math.sin(30*Math.PI/180);class jo extends Rt{getType(){return Wi}set state(e){this._objRef&&(this._objRef.state=e)}get state(){return this._objRef?.state}}jo.RAY_INITIALIZED=Wi.RAY_INITIALIZED,jo.RAY_UNBORN=Wi.RAY_UNBORN,jo.RAY_PROPAGATING=Wi.RAY_PROPAGATING,jo.RAY_STEADY=Wi.RAY_STEADY,jo.RAY_VANISHING=Wi.RAY_VANISHING,jo.RAY_EXTINGUISHED=Wi.RAY_EXTINGUISHED,jo.\u0275fac=function(){let i;return function(t){return(i||(i=le(jo)))(t||jo)}}(),jo.\u0275cmp=$({type:jo,selectors:[["th-lightningStrike"]],inputs:{state:"state"},features:[ne([{provide:Rt,useExisting:ae(()=>jo)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class sh extends Si{getType(){return gn}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set color(e){this._objRef&&(this._objRef.color=Ye(this._objRef.color,e))}get color(){return this._objRef?.color}set fog(e){this._objRef&&(this._objRef.fog=e)}get fog(){return this._objRef?.fog}set linewidth(e){this._objRef&&(this._objRef.linewidth=e)}get linewidth(){return this._objRef?.linewidth}set linecap(e){this._objRef&&(this._objRef.linecap=e)}get linecap(){return this._objRef?.linecap}set linejoin(e){this._objRef&&(this._objRef.linejoin=e)}get linejoin(){return this._objRef?.linejoin}set map(e){this._objRef&&(this._objRef.map=e)}get map(){return this._objRef?.map}}sh.\u0275fac=function(){let i;return function(t){return(i||(i=le(sh)))(t||sh)}}(),sh.\u0275cmp=$({type:sh,selectors:[["th-lineBasicMaterial"]],inputs:{type:"type",color:"color",fog:"fog",linewidth:"linewidth",linecap:"linecap",linejoin:"linejoin",map:"map"},features:[ne([{provide:Si,useExisting:ae(()=>sh)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class km extends sh{getType(){return RR}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set scale(e){this._objRef&&(this._objRef.scale=e)}get scale(){return this._objRef?.scale}set dashSize(e){this._objRef&&(this._objRef.dashSize=e)}get dashSize(){return this._objRef?.dashSize}set gapSize(e){this._objRef&&(this._objRef.gapSize=e)}get gapSize(){return this._objRef?.gapSize}get isLineDashedMaterial(){return this._objRef?.isLineDashedMaterial}}km.\u0275fac=function(){let i;return function(t){return(i||(i=le(km)))(t||km)}}(),km.\u0275cmp=$({type:km,selectors:[["th-lineDashedMaterial"]],inputs:{type:"type",scale:"scale",dashSize:"dashSize",gapSize:"gapSize"},features:[ne([{provide:Si,useExisting:ae(()=>km)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Bm extends Ec{getType(){return Ax}get isLineLoop(){return this._objRef?.isLineLoop}get type(){return this._objRef?.type}}Bm.\u0275fac=function(){let i;return function(t){return(i||(i=le(Bm)))(t||Bm)}}(),Bm.\u0275cmp=$({type:Bm,selectors:[["th-lineLoop"]],features:[ne([{provide:We,useExisting:ae(()=>Bm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Lm extends We{getType(){return aR}get isLOD(){return this._objRef?.isLOD}get type(){return this._objRef?.type}set levels(e){this._objRef&&(this._objRef.levels=e)}get levels(){return this._objRef?.levels}set autoUpdate(e){this._objRef&&(this._objRef.autoUpdate=e)}get autoUpdate(){return this._objRef?.autoUpdate}}Lm.\u0275fac=function(){let i;return function(t){return(i||(i=le(Lm)))(t||Lm)}}(),Lm.\u0275cmp=$({type:Lm,selectors:[["th-lOD"]],inputs:{levels:"levels",autoUpdate:"autoUpdate"},features:[ne([{provide:We,useExisting:ae(()=>Lm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const wbe={defines:{USE_3DTEXTURE:1},uniforms:{lut3d:{value:null},lut:{value:null},lutSize:{value:0},tDiffuse:{value:null},intensity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}\n\n\t",fragmentShader:"\n\n\t\tuniform float lutSize;\n\t\t#if USE_3DTEXTURE\n\t\tprecision highp sampler3D;\n\t\tuniform sampler3D lut3d;\n\t\t#else\n\t\tuniform sampler2D lut;\n\n\t\tvec3 lutLookup( sampler2D tex, float size, vec3 rgb ) {\n\n\t\t\tfloat sliceHeight = 1.0 / size;\n\t\t\tfloat yPixelHeight = 1.0 / ( size * size );\n\n\t\t\t// Get the slices on either side of the sample\n\t\t\tfloat slice = rgb.b * size;\n\t\t\tfloat interp = fract( slice );\n\t\t\tfloat slice0 = slice - interp;\n\t\t\tfloat centeredInterp = interp - 0.5;\n\n\t\t\tfloat slice1 = slice0 + sign( centeredInterp );\n\n\t\t\t// Pull y sample in by half a pixel in each direction to avoid color\n\t\t\t// bleeding from adjacent slices.\n\t\t\tfloat greenOffset = clamp( rgb.g * sliceHeight, yPixelHeight * 0.5, sliceHeight - yPixelHeight * 0.5 );\n\n\t\t\tvec2 uv0 = vec2(\n\t\t\t\trgb.r,\n\t\t\t\tslice0 * sliceHeight + greenOffset\n\t\t\t);\n\t\t\tvec2 uv1 = vec2(\n\t\t\t\trgb.r,\n\t\t\t\tslice1 * sliceHeight + greenOffset\n\t\t\t);\n\n\t\t\tvec3 sample0 = texture2D( tex, uv0 ).rgb;\n\t\t\tvec3 sample1 = texture2D( tex, uv1 ).rgb;\n\n\t\t\treturn mix( sample0, sample1, abs( centeredInterp ) );\n\n\t\t}\n\t\t#endif\n\n\t\tvarying vec2 vUv;\n\t\tuniform float intensity;\n\t\tuniform sampler2D tDiffuse;\n\t\tvoid main() {\n\n\t\t\tvec4 val = texture2D( tDiffuse, vUv );\n\t\t\tvec4 lutVal;\n\n\t\t\t// pull the sample in by half a pixel so the sample begins\n\t\t\t// at the center of the edge pixels.\n\t\t\tfloat pixelWidth = 1.0 / lutSize;\n\t\t\tfloat halfPixelWidth = 0.5 / lutSize;\n\t\t\tvec3 uvw = vec3( halfPixelWidth ) + val.rgb * ( 1.0 - pixelWidth );\n\n\t\t\t#if USE_3DTEXTURE\n\n\t\t\tlutVal = vec4( texture( lut3d, uvw ).rgb, val.a );\n\n\t\t\t#else\n\n\t\t\tlutVal = vec4( lutLookup( lut, lutSize, uvw ), val.a );\n\n\t\t\t#endif\n\n\t\t\tgl_FragColor = vec4( mix( val, lutVal, intensity ) );\n\n\t\t}\n\n\t"};class Cbe extends rD{set lut(e){const t=this.material;if(e!==this.lut&&(t.uniforms.lut3d.value=null,t.uniforms.lut.value=null,e)){const n=e.isData3DTexture?1:0;n!==t.defines.USE_3DTEXTURE&&(t.defines.USE_3DTEXTURE=n,t.needsUpdate=!0),t.uniforms.lutSize.value=e.image.width,e.isData3DTexture?t.uniforms.lut3d.value=e:t.uniforms.lut.value=e}}get lut(){return this.material.uniforms.lut.value||this.material.uniforms.lut3d.value}set intensity(e){this.material.uniforms.intensity.value=e}get intensity(){return this.material.uniforms.intensity.value}constructor(e={}){super(wbe),this.lut=e.lut||null,this.intensity="intensity"in e?e.intensity:1}}class zl extends Yi{getType(){return rD}set textureID(e){this._objRef&&(this._objRef.textureID=e)}get textureID(){return this._objRef?.textureID}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}get uniforms(){return this._objRef?.uniforms}set material(e){this._objRef&&(this._objRef.material=e)}get material(){return this._objRef?.material}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}}zl.\u0275fac=function(){let i;return function(t){return(i||(i=le(zl)))(t||zl)}}(),zl.\u0275cmp=$({type:zl,selectors:[["th-shaderPass"]],inputs:{textureID:"textureID",uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[ne([{provide:Li,useExisting:ae(()=>zl)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Fm extends zl{getType(){return Cbe}set lut(e){this._objRef&&(this._objRef.lut=e)}get lut(){return this._objRef?.lut}set intensity(e){this._objRef&&(this._objRef.intensity=e)}get intensity(){return this._objRef?.intensity}}Fm.\u0275fac=function(){let i;return function(t){return(i||(i=le(Fm)))(t||Fm)}}(),Fm.\u0275cmp=$({type:Fm,selectors:[["th-lUTPass"]],inputs:{lut:"lut",intensity:"intensity"},features:[ne([{provide:Li,useExisting:ae(()=>Fm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Sbe extends iV{constructor(e,t){super(e,t),this.screenSpacePanning=!1,this.mouseButtons={LEFT:Zs.PAN,MIDDLE:Zs.DOLLY,RIGHT:Zs.ROTATE},this.touches={ONE:wl.PAN,TWO:wl.DOLLY_ROTATE}}}class oh extends Pr{getType(){return Sbe}}oh.\u0275fac=function(){let i;return function(t){return(i||(i=le(oh)))(t||oh)}}(),oh.\u0275cmp=$({type:oh,selectors:[["th-mapControls"]],features:[ne([{provide:qn,useExisting:ae(()=>oh)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Om extends Yi{getType(){return sD}set scene(e){this._objRef&&(this._objRef.scene=e)}get scene(){return this._objRef?.scene}set camera(e){this._objRef&&(this._objRef.camera=e)}get camera(){return this._objRef?.camera}set inverse(e){this._objRef&&(this._objRef.inverse=e)}get inverse(){return this._objRef?.inverse}}Om.\u0275fac=function(){let i;return function(t){return(i||(i=le(Om)))(t||Om)}}(),Om.\u0275cmp=$({type:Om,selectors:[["th-maskPass"]],inputs:{scene:"scene",camera:"camera",inverse:"inverse"},features:[ne([{provide:Li,useExisting:ae(()=>Om)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Nm extends Si{getType(){return nu}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set map(e){this._objRef&&(this._objRef.map=e)}get map(){return this._objRef?.map}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}get alphaMap(){return this._objRef?.alphaMap}set depthPacking(e){this._objRef&&(this._objRef.depthPacking=e)}get depthPacking(){return this._objRef?.depthPacking}set displacementMap(e){this._objRef&&(this._objRef.displacementMap=e)}get displacementMap(){return this._objRef?.displacementMap}set displacementScale(e){this._objRef&&(this._objRef.displacementScale=e)}get displacementScale(){return this._objRef?.displacementScale}set displacementBias(e){this._objRef&&(this._objRef.displacementBias=e)}get displacementBias(){return this._objRef?.displacementBias}set wireframe(e){this._objRef&&(this._objRef.wireframe=e)}get wireframe(){return this._objRef?.wireframe}set wireframeLinewidth(e){this._objRef&&(this._objRef.wireframeLinewidth=e)}get wireframeLinewidth(){return this._objRef?.wireframeLinewidth}set fog(e){this._objRef&&(this._objRef.fog=e)}get fog(){return this._objRef?.fog}}Nm.\u0275fac=function(){let i;return function(t){return(i||(i=le(Nm)))(t||Nm)}}(),Nm.\u0275cmp=$({type:Nm,selectors:[["th-meshDepthMaterial"]],inputs:{type:"type",map:"map",alphaMap:"alphaMap",depthPacking:"depthPacking",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",fog:"fog"},features:[ne([{provide:Si,useExisting:ae(()=>Nm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class jm extends Si{getType(){return cx}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set map(e){this._objRef&&(this._objRef.map=e)}get map(){return this._objRef?.map}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}get alphaMap(){return this._objRef?.alphaMap}set displacementMap(e){this._objRef&&(this._objRef.displacementMap=e)}get displacementMap(){return this._objRef?.displacementMap}set displacementScale(e){this._objRef&&(this._objRef.displacementScale=e)}get displacementScale(){return this._objRef?.displacementScale}set displacementBias(e){this._objRef&&(this._objRef.displacementBias=e)}get displacementBias(){return this._objRef?.displacementBias}set fog(e){this._objRef&&(this._objRef.fog=e)}get fog(){return this._objRef?.fog}}jm.\u0275fac=function(){let i;return function(t){return(i||(i=le(jm)))(t||jm)}}(),jm.\u0275cmp=$({type:jm,selectors:[["th-meshDistanceMaterial"]],inputs:{type:"type",map:"map",alphaMap:"alphaMap",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",fog:"fog"},features:[ne([{provide:Si,useExisting:ae(()=>jm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Um extends Si{getType(){return Px}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set color(e){this._objRef&&(this._objRef.color=Ye(this._objRef.color,e))}get color(){return this._objRef?.color}set bumpMap(e){this._objRef&&(this._objRef.bumpMap=e)}get bumpMap(){return this._objRef?.bumpMap}set bumpScale(e){this._objRef&&(this._objRef.bumpScale=e)}get bumpScale(){return this._objRef?.bumpScale}set displacementMap(e){this._objRef&&(this._objRef.displacementMap=e)}get displacementMap(){return this._objRef?.displacementMap}set displacementScale(e){this._objRef&&(this._objRef.displacementScale=e)}get displacementScale(){return this._objRef?.displacementScale}set displacementBias(e){this._objRef&&(this._objRef.displacementBias=e)}get displacementBias(){return this._objRef?.displacementBias}set emissive(e){this._objRef&&(this._objRef.emissive=Ye(this._objRef.emissive,e))}get emissive(){return this._objRef?.emissive}set emissiveIntensity(e){this._objRef&&(this._objRef.emissiveIntensity=e)}get emissiveIntensity(){return this._objRef?.emissiveIntensity}set emissiveMap(e){this._objRef&&(this._objRef.emissiveMap=e)}get emissiveMap(){return this._objRef?.emissiveMap}set flatShading(e){this._objRef&&(this._objRef.flatShading=e)}get flatShading(){return this._objRef?.flatShading}set map(e){this._objRef&&(this._objRef.map=e)}get map(){return this._objRef?.map}set lightMap(e){this._objRef&&(this._objRef.lightMap=e)}get lightMap(){return this._objRef?.lightMap}set lightMapIntensity(e){this._objRef&&(this._objRef.lightMapIntensity=e)}get lightMapIntensity(){return this._objRef?.lightMapIntensity}set normalMap(e){this._objRef&&(this._objRef.normalMap=e)}get normalMap(){return this._objRef?.normalMap}set normalMapType(e){this._objRef&&(this._objRef.normalMapType=e)}get normalMapType(){return this._objRef?.normalMapType}set normalScale(e){this._objRef&&(this._objRef.normalScale=Ye(this._objRef.normalScale,e))}get normalScale(){return this._objRef?.normalScale}set aoMap(e){this._objRef&&(this._objRef.aoMap=e)}get aoMap(){return this._objRef?.aoMap}set aoMapIntensity(e){this._objRef&&(this._objRef.aoMapIntensity=e)}get aoMapIntensity(){return this._objRef?.aoMapIntensity}set specularMap(e){this._objRef&&(this._objRef.specularMap=e)}get specularMap(){return this._objRef?.specularMap}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}get alphaMap(){return this._objRef?.alphaMap}set envMap(e){this._objRef&&(this._objRef.envMap=e)}get envMap(){return this._objRef?.envMap}set combine(e){this._objRef&&(this._objRef.combine=e)}get combine(){return this._objRef?.combine}set reflectivity(e){this._objRef&&(this._objRef.reflectivity=e)}get reflectivity(){return this._objRef?.reflectivity}set refractionRatio(e){this._objRef&&(this._objRef.refractionRatio=e)}get refractionRatio(){return this._objRef?.refractionRatio}set wireframe(e){this._objRef&&(this._objRef.wireframe=e)}get wireframe(){return this._objRef?.wireframe}set wireframeLinewidth(e){this._objRef&&(this._objRef.wireframeLinewidth=e)}get wireframeLinewidth(){return this._objRef?.wireframeLinewidth}set wireframeLinecap(e){this._objRef&&(this._objRef.wireframeLinecap=e)}get wireframeLinecap(){return this._objRef?.wireframeLinecap}set wireframeLinejoin(e){this._objRef&&(this._objRef.wireframeLinejoin=e)}get wireframeLinejoin(){return this._objRef?.wireframeLinejoin}set fog(e){this._objRef&&(this._objRef.fog=e)}get fog(){return this._objRef?.fog}}Um.\u0275fac=function(){let i;return function(t){return(i||(i=le(Um)))(t||Um)}}(),Um.\u0275cmp=$({type:Um,selectors:[["th-meshLambertMaterial"]],inputs:{type:"type",color:"color",bumpMap:"bumpMap",bumpScale:"bumpScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",emissive:"emissive",emissiveIntensity:"emissiveIntensity",emissiveMap:"emissiveMap",flatShading:"flatShading",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",specularMap:"specularMap",alphaMap:"alphaMap",envMap:"envMap",combine:"combine",reflectivity:"reflectivity",refractionRatio:"refractionRatio",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",fog:"fog"},features:[ne([{provide:Si,useExisting:ae(()=>Um)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Vm extends Si{getType(){return TR}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set defines(e){this._objRef&&(this._objRef.defines=e)}get defines(){return this._objRef?.defines}set color(e){this._objRef&&(this._objRef.color=Ye(this._objRef.color,e))}get color(){return this._objRef?.color}set matcap(e){this._objRef&&(this._objRef.matcap=e)}get matcap(){return this._objRef?.matcap}set map(e){this._objRef&&(this._objRef.map=e)}get map(){return this._objRef?.map}set bumpMap(e){this._objRef&&(this._objRef.bumpMap=e)}get bumpMap(){return this._objRef?.bumpMap}set bumpScale(e){this._objRef&&(this._objRef.bumpScale=e)}get bumpScale(){return this._objRef?.bumpScale}set normalMap(e){this._objRef&&(this._objRef.normalMap=e)}get normalMap(){return this._objRef?.normalMap}set normalMapType(e){this._objRef&&(this._objRef.normalMapType=e)}get normalMapType(){return this._objRef?.normalMapType}set normalScale(e){this._objRef&&(this._objRef.normalScale=Ye(this._objRef.normalScale,e))}get normalScale(){return this._objRef?.normalScale}set displacementMap(e){this._objRef&&(this._objRef.displacementMap=e)}get displacementMap(){return this._objRef?.displacementMap}set displacementScale(e){this._objRef&&(this._objRef.displacementScale=e)}get displacementScale(){return this._objRef?.displacementScale}set displacementBias(e){this._objRef&&(this._objRef.displacementBias=e)}get displacementBias(){return this._objRef?.displacementBias}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}get alphaMap(){return this._objRef?.alphaMap}set flatShading(e){this._objRef&&(this._objRef.flatShading=e)}get flatShading(){return this._objRef?.flatShading}set fog(e){this._objRef&&(this._objRef.fog=e)}get fog(){return this._objRef?.fog}}Vm.\u0275fac=function(){let i;return function(t){return(i||(i=le(Vm)))(t||Vm)}}(),Vm.\u0275cmp=$({type:Vm,selectors:[["th-meshMatcapMaterial"]],inputs:{type:"type",defines:"defines",color:"color",matcap:"matcap",map:"map",bumpMap:"bumpMap",bumpScale:"bumpScale",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",alphaMap:"alphaMap",flatShading:"flatShading",fog:"fog"},features:[ne([{provide:Si,useExisting:ae(()=>Vm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class zm extends Si{getType(){return Cp}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set bumpMap(e){this._objRef&&(this._objRef.bumpMap=e)}get bumpMap(){return this._objRef?.bumpMap}set bumpScale(e){this._objRef&&(this._objRef.bumpScale=e)}get bumpScale(){return this._objRef?.bumpScale}set normalMap(e){this._objRef&&(this._objRef.normalMap=e)}get normalMap(){return this._objRef?.normalMap}set normalMapType(e){this._objRef&&(this._objRef.normalMapType=e)}get normalMapType(){return this._objRef?.normalMapType}set normalScale(e){this._objRef&&(this._objRef.normalScale=Ye(this._objRef.normalScale,e))}get normalScale(){return this._objRef?.normalScale}set displacementMap(e){this._objRef&&(this._objRef.displacementMap=e)}get displacementMap(){return this._objRef?.displacementMap}set displacementScale(e){this._objRef&&(this._objRef.displacementScale=e)}get displacementScale(){return this._objRef?.displacementScale}set displacementBias(e){this._objRef&&(this._objRef.displacementBias=e)}get displacementBias(){return this._objRef?.displacementBias}set wireframe(e){this._objRef&&(this._objRef.wireframe=e)}get wireframe(){return this._objRef?.wireframe}set wireframeLinewidth(e){this._objRef&&(this._objRef.wireframeLinewidth=e)}get wireframeLinewidth(){return this._objRef?.wireframeLinewidth}set flatShading(e){this._objRef&&(this._objRef.flatShading=e)}get flatShading(){return this._objRef?.flatShading}}zm.\u0275fac=function(){let i;return function(t){return(i||(i=le(zm)))(t||zm)}}(),zm.\u0275cmp=$({type:zm,selectors:[["th-meshNormalMaterial"]],inputs:{type:"type",bumpMap:"bumpMap",bumpScale:"bumpScale",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",flatShading:"flatShading"},features:[ne([{provide:Si,useExisting:ae(()=>zm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Gl extends Si{getType(){return ja}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set defines(e){this._objRef&&(this._objRef.defines=e)}get defines(){return this._objRef?.defines}set color(e){this._objRef&&(this._objRef.color=Ye(this._objRef.color,e))}get color(){return this._objRef?.color}set roughness(e){this._objRef&&(this._objRef.roughness=e)}get roughness(){return this._objRef?.roughness}set metalness(e){this._objRef&&(this._objRef.metalness=e)}get metalness(){return this._objRef?.metalness}set map(e){this._objRef&&(this._objRef.map=e)}get map(){return this._objRef?.map}set lightMap(e){this._objRef&&(this._objRef.lightMap=e)}get lightMap(){return this._objRef?.lightMap}set lightMapIntensity(e){this._objRef&&(this._objRef.lightMapIntensity=e)}get lightMapIntensity(){return this._objRef?.lightMapIntensity}set aoMap(e){this._objRef&&(this._objRef.aoMap=e)}get aoMap(){return this._objRef?.aoMap}set aoMapIntensity(e){this._objRef&&(this._objRef.aoMapIntensity=e)}get aoMapIntensity(){return this._objRef?.aoMapIntensity}set emissive(e){this._objRef&&(this._objRef.emissive=Ye(this._objRef.emissive,e))}get emissive(){return this._objRef?.emissive}set emissiveIntensity(e){this._objRef&&(this._objRef.emissiveIntensity=e)}get emissiveIntensity(){return this._objRef?.emissiveIntensity}set emissiveMap(e){this._objRef&&(this._objRef.emissiveMap=e)}get emissiveMap(){return this._objRef?.emissiveMap}set bumpMap(e){this._objRef&&(this._objRef.bumpMap=e)}get bumpMap(){return this._objRef?.bumpMap}set bumpScale(e){this._objRef&&(this._objRef.bumpScale=e)}get bumpScale(){return this._objRef?.bumpScale}set normalMap(e){this._objRef&&(this._objRef.normalMap=e)}get normalMap(){return this._objRef?.normalMap}set normalMapType(e){this._objRef&&(this._objRef.normalMapType=e)}get normalMapType(){return this._objRef?.normalMapType}set normalScale(e){this._objRef&&(this._objRef.normalScale=Ye(this._objRef.normalScale,e))}get normalScale(){return this._objRef?.normalScale}set displacementMap(e){this._objRef&&(this._objRef.displacementMap=e)}get displacementMap(){return this._objRef?.displacementMap}set displacementScale(e){this._objRef&&(this._objRef.displacementScale=e)}get displacementScale(){return this._objRef?.displacementScale}set displacementBias(e){this._objRef&&(this._objRef.displacementBias=e)}get displacementBias(){return this._objRef?.displacementBias}set roughnessMap(e){this._objRef&&(this._objRef.roughnessMap=e)}get roughnessMap(){return this._objRef?.roughnessMap}set metalnessMap(e){this._objRef&&(this._objRef.metalnessMap=e)}get metalnessMap(){return this._objRef?.metalnessMap}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}get alphaMap(){return this._objRef?.alphaMap}set envMap(e){this._objRef&&(this._objRef.envMap=e)}get envMap(){return this._objRef?.envMap}set envMapIntensity(e){this._objRef&&(this._objRef.envMapIntensity=e)}get envMapIntensity(){return this._objRef?.envMapIntensity}set wireframe(e){this._objRef&&(this._objRef.wireframe=e)}get wireframe(){return this._objRef?.wireframe}set wireframeLinewidth(e){this._objRef&&(this._objRef.wireframeLinewidth=e)}get wireframeLinewidth(){return this._objRef?.wireframeLinewidth}set wireframeLinecap(e){this._objRef&&(this._objRef.wireframeLinecap=e)}get wireframeLinecap(){return this._objRef?.wireframeLinecap}set wireframeLinejoin(e){this._objRef&&(this._objRef.wireframeLinejoin=e)}get wireframeLinejoin(){return this._objRef?.wireframeLinejoin}set flatShading(e){this._objRef&&(this._objRef.flatShading=e)}get flatShading(){return this._objRef?.flatShading}set fog(e){this._objRef&&(this._objRef.fog=e)}get fog(){return this._objRef?.fog}set isMeshStandardMaterial(e){this._objRef&&(this._objRef.isMeshStandardMaterial=e)}get isMeshStandardMaterial(){return this._objRef?.isMeshStandardMaterial}}Gl.\u0275fac=function(){let i;return function(t){return(i||(i=le(Gl)))(t||Gl)}}(),Gl.\u0275cmp=$({type:Gl,selectors:[["th-meshStandardMaterial"]],inputs:{type:"type",defines:"defines",color:"color",roughness:"roughness",metalness:"metalness",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",emissive:"emissive",emissiveIntensity:"emissiveIntensity",emissiveMap:"emissiveMap",bumpMap:"bumpMap",bumpScale:"bumpScale",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",roughnessMap:"roughnessMap",metalnessMap:"metalnessMap",alphaMap:"alphaMap",envMap:"envMap",envMapIntensity:"envMapIntensity",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",flatShading:"flatShading",fog:"fog",isMeshStandardMaterial:"isMeshStandardMaterial"},features:[ne([{provide:Si,useExisting:ae(()=>Gl)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Gm extends Gl{getType(){return Ua}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set defines(e){this._objRef&&(this._objRef.defines=e)}get defines(){return this._objRef?.defines}set clearcoat(e){this._objRef&&(this._objRef.clearcoat=e)}get clearcoat(){return this._objRef?.clearcoat}set clearcoatMap(e){this._objRef&&(this._objRef.clearcoatMap=e)}get clearcoatMap(){return this._objRef?.clearcoatMap}set clearcoatRoughness(e){this._objRef&&(this._objRef.clearcoatRoughness=e)}get clearcoatRoughness(){return this._objRef?.clearcoatRoughness}set clearcoatRoughnessMap(e){this._objRef&&(this._objRef.clearcoatRoughnessMap=e)}get clearcoatRoughnessMap(){return this._objRef?.clearcoatRoughnessMap}set clearcoatNormalScale(e){this._objRef&&(this._objRef.clearcoatNormalScale=Ye(this._objRef.clearcoatNormalScale,e))}get clearcoatNormalScale(){return this._objRef?.clearcoatNormalScale}set clearcoatNormalMap(e){this._objRef&&(this._objRef.clearcoatNormalMap=e)}get clearcoatNormalMap(){return this._objRef?.clearcoatNormalMap}set reflectivity(e){this._objRef&&(this._objRef.reflectivity=e)}get reflectivity(){return this._objRef?.reflectivity}set ior(e){this._objRef&&(this._objRef.ior=e)}get ior(){return this._objRef?.ior}set sheen(e){this._objRef&&(this._objRef.sheen=e)}get sheen(){return this._objRef?.sheen}set sheenColor(e){this._objRef&&(this._objRef.sheenColor=Ye(this._objRef.sheenColor,e))}get sheenColor(){return this._objRef?.sheenColor}set sheenColorMap(e){this._objRef&&(this._objRef.sheenColorMap=e)}get sheenColorMap(){return this._objRef?.sheenColorMap}set sheenRoughness(e){this._objRef&&(this._objRef.sheenRoughness=e)}get sheenRoughness(){return this._objRef?.sheenRoughness}set sheenRoughnessMap(e){this._objRef&&(this._objRef.sheenRoughnessMap=e)}get sheenRoughnessMap(){return this._objRef?.sheenRoughnessMap}set transmission(e){this._objRef&&(this._objRef.transmission=e)}get transmission(){return this._objRef?.transmission}set transmissionMap(e){this._objRef&&(this._objRef.transmissionMap=e)}get transmissionMap(){return this._objRef?.transmissionMap}set thickness(e){this._objRef&&(this._objRef.thickness=e)}get thickness(){return this._objRef?.thickness}set thicknessMap(e){this._objRef&&(this._objRef.thicknessMap=e)}get thicknessMap(){return this._objRef?.thicknessMap}set attenuationDistance(e){this._objRef&&(this._objRef.attenuationDistance=e)}get attenuationDistance(){return this._objRef?.attenuationDistance}set attenuationColor(e){this._objRef&&(this._objRef.attenuationColor=Ye(this._objRef.attenuationColor,e))}get attenuationColor(){return this._objRef?.attenuationColor}set specularIntensity(e){this._objRef&&(this._objRef.specularIntensity=e)}get specularIntensity(){return this._objRef?.specularIntensity}set specularColor(e){this._objRef&&(this._objRef.specularColor=Ye(this._objRef.specularColor,e))}get specularColor(){return this._objRef?.specularColor}set specularIntensityMap(e){this._objRef&&(this._objRef.specularIntensityMap=e)}get specularIntensityMap(){return this._objRef?.specularIntensityMap}set specularColorMap(e){this._objRef&&(this._objRef.specularColorMap=e)}get specularColorMap(){return this._objRef?.specularColorMap}set iridescenceMap(e){this._objRef&&(this._objRef.iridescenceMap=e)}get iridescenceMap(){return this._objRef?.iridescenceMap}set iridescenceIOR(e){this._objRef&&(this._objRef.iridescenceIOR=e)}get iridescenceIOR(){return this._objRef?.iridescenceIOR}set iridescence(e){this._objRef&&(this._objRef.iridescence=e)}get iridescence(){return this._objRef?.iridescence}set iridescenceThicknessRange(e){this._objRef&&(this._objRef.iridescenceThicknessRange=e)}get iridescenceThicknessRange(){return this._objRef?.iridescenceThicknessRange}set iridescenceThicknessMap(e){this._objRef&&(this._objRef.iridescenceThicknessMap=e)}get iridescenceThicknessMap(){return this._objRef?.iridescenceThicknessMap}}Gm.\u0275fac=function(){let i;return function(t){return(i||(i=le(Gm)))(t||Gm)}}(),Gm.\u0275cmp=$({type:Gm,selectors:[["th-meshPhysicalMaterial"]],inputs:{type:"type",defines:"defines",clearcoat:"clearcoat",clearcoatMap:"clearcoatMap",clearcoatRoughness:"clearcoatRoughness",clearcoatRoughnessMap:"clearcoatRoughnessMap",clearcoatNormalScale:"clearcoatNormalScale",clearcoatNormalMap:"clearcoatNormalMap",reflectivity:"reflectivity",ior:"ior",sheen:"sheen",sheenColor:"sheenColor",sheenColorMap:"sheenColorMap",sheenRoughness:"sheenRoughness",sheenRoughnessMap:"sheenRoughnessMap",transmission:"transmission",transmissionMap:"transmissionMap",thickness:"thickness",thicknessMap:"thicknessMap",attenuationDistance:"attenuationDistance",attenuationColor:"attenuationColor",specularIntensity:"specularIntensity",specularColor:"specularColor",specularIntensityMap:"specularIntensityMap",specularColorMap:"specularColorMap",iridescenceMap:"iridescenceMap",iridescenceIOR:"iridescenceIOR",iridescence:"iridescence",iridescenceThicknessRange:"iridescenceThicknessRange",iridescenceThicknessMap:"iridescenceThicknessMap"},features:[ne([{provide:Si,useExisting:ae(()=>Gm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Hm extends Si{getType(){return SR}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set defines(e){this._objRef&&(this._objRef.defines=e)}get defines(){return this._objRef?.defines}set color(e){this._objRef&&(this._objRef.color=Ye(this._objRef.color,e))}get color(){return this._objRef?.color}set gradientMap(e){this._objRef&&(this._objRef.gradientMap=e)}get gradientMap(){return this._objRef?.gradientMap}set map(e){this._objRef&&(this._objRef.map=e)}get map(){return this._objRef?.map}set lightMap(e){this._objRef&&(this._objRef.lightMap=e)}get lightMap(){return this._objRef?.lightMap}set lightMapIntensity(e){this._objRef&&(this._objRef.lightMapIntensity=e)}get lightMapIntensity(){return this._objRef?.lightMapIntensity}set aoMap(e){this._objRef&&(this._objRef.aoMap=e)}get aoMap(){return this._objRef?.aoMap}set aoMapIntensity(e){this._objRef&&(this._objRef.aoMapIntensity=e)}get aoMapIntensity(){return this._objRef?.aoMapIntensity}set emissive(e){this._objRef&&(this._objRef.emissive=Ye(this._objRef.emissive,e))}get emissive(){return this._objRef?.emissive}set emissiveIntensity(e){this._objRef&&(this._objRef.emissiveIntensity=e)}get emissiveIntensity(){return this._objRef?.emissiveIntensity}set emissiveMap(e){this._objRef&&(this._objRef.emissiveMap=e)}get emissiveMap(){return this._objRef?.emissiveMap}set bumpMap(e){this._objRef&&(this._objRef.bumpMap=e)}get bumpMap(){return this._objRef?.bumpMap}set bumpScale(e){this._objRef&&(this._objRef.bumpScale=e)}get bumpScale(){return this._objRef?.bumpScale}set normalMap(e){this._objRef&&(this._objRef.normalMap=e)}get normalMap(){return this._objRef?.normalMap}set normalMapType(e){this._objRef&&(this._objRef.normalMapType=e)}get normalMapType(){return this._objRef?.normalMapType}set normalScale(e){this._objRef&&(this._objRef.normalScale=Ye(this._objRef.normalScale,e))}get normalScale(){return this._objRef?.normalScale}set displacementMap(e){this._objRef&&(this._objRef.displacementMap=e)}get displacementMap(){return this._objRef?.displacementMap}set displacementScale(e){this._objRef&&(this._objRef.displacementScale=e)}get displacementScale(){return this._objRef?.displacementScale}set displacementBias(e){this._objRef&&(this._objRef.displacementBias=e)}get displacementBias(){return this._objRef?.displacementBias}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}get alphaMap(){return this._objRef?.alphaMap}set wireframe(e){this._objRef&&(this._objRef.wireframe=e)}get wireframe(){return this._objRef?.wireframe}set wireframeLinewidth(e){this._objRef&&(this._objRef.wireframeLinewidth=e)}get wireframeLinewidth(){return this._objRef?.wireframeLinewidth}set wireframeLinecap(e){this._objRef&&(this._objRef.wireframeLinecap=e)}get wireframeLinecap(){return this._objRef?.wireframeLinecap}set wireframeLinejoin(e){this._objRef&&(this._objRef.wireframeLinejoin=e)}get wireframeLinejoin(){return this._objRef?.wireframeLinejoin}set fog(e){this._objRef&&(this._objRef.fog=e)}get fog(){return this._objRef?.fog}}Hm.\u0275fac=function(){let i;return function(t){return(i||(i=le(Hm)))(t||Hm)}}(),Hm.\u0275cmp=$({type:Hm,selectors:[["th-meshToonMaterial"]],inputs:{type:"type",defines:"defines",color:"color",gradientMap:"gradientMap",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",emissive:"emissive",emissiveIntensity:"emissiveIntensity",emissiveMap:"emissiveMap",bumpMap:"bumpMap",bumpScale:"bumpScale",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",alphaMap:"alphaMap",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",fog:"fog"},features:[ne([{provide:Si,useExisting:ae(()=>Hm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Qm extends Ka{getType(){return aa}get type(){return this._objRef?.type}}Qm.\u0275fac=function(){let i;return function(t){return(i||(i=le(Qm)))(t||Qm)}}(),Qm.\u0275cmp=$({type:Qm,selectors:[["th-octahedronGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>Qm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class ah extends Ts{getType(){return La}get isOrthographicCamera(){return this._objRef?.isOrthographicCamera}get type(){return this._objRef?.type}set zoom(e){this._objRef&&(this._objRef.zoom=e)}get zoom(){return this._objRef?.zoom}set view(e){this._objRef&&(this._objRef.view=e)}get view(){return this._objRef?.view}set left(e){this._objRef&&(this._objRef.left=e)}get left(){return this._objRef?.left}set right(e){this._objRef&&(this._objRef.right=e)}get right(){return this._objRef?.right}set top(e){this._objRef&&(this._objRef.top=e)}get top(){return this._objRef?.top}set bottom(e){this._objRef&&(this._objRef.bottom=e)}get bottom(){return this._objRef?.bottom}set near(e){this._objRef&&(this._objRef.near=e)}get near(){return this._objRef?.near}set far(e){this._objRef&&(this._objRef.far=e)}get far(){return this._objRef?.far}}ah.\u0275fac=function(){let i;return function(t){return(i||(i=le(ah)))(t||ah)}}(),ah.\u0275cmp=$({type:ah,selectors:[["th-orthographicCamera"]],inputs:{zoom:"zoom",view:"view",left:"left",right:"right",top:"top",bottom:"bottom",near:"near",far:"far"},features:[ne([{provide:We,useExisting:ae(()=>ah)},{provide:Ts,useExisting:ae(()=>ah)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Wc extends wn{constructor(e,t,n,r){super(),this.renderScene=t,this.renderCamera=n,this.selectedObjects=void 0!==r?r:[],this.visibleEdgeColor=new Le(1,1,1),this.hiddenEdgeColor=new Le(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this.resolution=void 0!==e?new fe(e.x,e.y):new fe(256,256);const s=Math.round(this.resolution.x/this.downSampleRatio),o=Math.round(this.resolution.y/this.downSampleRatio);this.renderTargetMaskBuffer=new Gt(this.resolution.x,this.resolution.y),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new nu,this.depthMaterial.side=os,this.depthMaterial.depthPacking=rb,this.depthMaterial.blending=Kt,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=os,this.prepareMaskMaterial.fragmentShader=function d(u,h){return u.replace(/DEPTH_TO_VIEW_Z/g,(h.isPerspectiveCamera?"perspective":"orthographic")+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new Gt(this.resolution.x,this.resolution.y),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new Gt(s,o),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new Gt(s,o),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new Gt(Math.round(s/2),Math.round(o/2)),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new Gt(s,o),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new Gt(Math.round(s/2),Math.round(o/2)),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1,this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value.set(s,o),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(s/2),Math.round(o/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial();const c=Yr;this.copyUniforms=gi.clone(c.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new Pt({uniforms:this.copyUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,blending:Kt,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Le,this.oldClearAlpha=1,this.fsQuad=new xr(null),this.tempPulseColor1=new Le,this.tempPulseColor2=new Le,this.textureMatrix=new Qe}dispose(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose(),this.depthMaterial.dispose(),this.prepareMaskMaterial.dispose(),this.edgeDetectionMaterial.dispose(),this.separableBlurMaterial1.dispose(),this.separableBlurMaterial2.dispose(),this.overlayMaterial.dispose(),this.materialCopy.dispose(),this.fsQuad.dispose()}setSize(e,t){this.renderTargetMaskBuffer.setSize(e,t),this.renderTargetDepthBuffer.setSize(e,t);let n=Math.round(e/this.downSampleRatio),r=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(n,r),this.renderTargetBlurBuffer1.setSize(n,r),this.renderTargetEdgeBuffer1.setSize(n,r),this.separableBlurMaterial1.uniforms.texSize.value.set(n,r),n=Math.round(n/2),r=Math.round(r/2),this.renderTargetBlurBuffer2.setSize(n,r),this.renderTargetEdgeBuffer2.setSize(n,r),this.separableBlurMaterial2.uniforms.texSize.value.set(n,r)}changeVisibilityOfSelectedObjects(e){const t=this._visibilityCache;function n(r){r.isMesh&&(!0===e?r.visible=t.get(r):(t.set(r,r.visible),r.visible=e))}for(let r=0;r<this.selectedObjects.length;r++)this.selectedObjects[r].traverse(n)}changeVisibilityOfNonSelectedObjects(e){const t=this._visibilityCache,n=[];function r(o){o.isMesh&&n.push(o)}for(let o=0;o<this.selectedObjects.length;o++)this.selectedObjects[o].traverse(r);this.renderScene.traverse(function s(o){if(o.isMesh||o.isSprite){let a=!1;for(let l=0;l<n.length;l++)if(n[l].id===o.id){a=!0;break}if(!1===a){const l=o.visible;(!1===e||!0===t.get(o))&&(o.visible=e),t.set(o,l)}}else(o.isPoints||o.isLine)&&(!0===e?o.visible=t.get(o):(t.set(o,o.visible),o.visible=e))})}updateTextureMatrix(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)}render(e,t,n,r,s){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,s&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);const a=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this.renderScene.background=a,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){const l=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(l),this.tempPulseColor2.multiplyScalar(l)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=Wc.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=Wc.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=Wc.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=Wc.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(n),this.fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=n.texture,e.setRenderTarget(null),this.fsQuad.render(e))}getPrepareMaskMaterial(){return new Pt({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new fe(.5,.5)},textureMatrix:{value:null}},vertexShader:"#include <morphtarget_pars_vertex>\n\t\t\t\t#include <skinning_pars_vertex>\n\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tuniform mat4 textureMatrix;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <morphtarget_vertex>\n\t\t\t\t\t#include <skinning_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t\tvPosition = mvPosition;\n\n\t\t\t\t\tvec4 worldPosition = vec4( transformed, 1.0 );\n\n\t\t\t\t\t#ifdef USE_INSTANCING\n\n\t\t\t\t\t\tworldPosition = instanceMatrix * worldPosition;\n\n\t\t\t\t\t#endif\n\t\t\t\t\t\n\t\t\t\t\tworldPosition = modelMatrix * worldPosition;\n\n\t\t\t\t\tprojTexCoord = textureMatrix * worldPosition;\n\n\t\t\t\t}",fragmentShader:"#include <packing>\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tuniform sampler2D depthTexture;\n\t\t\t\tuniform vec2 cameraNearFar;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));\n\t\t\t\t\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );\n\t\t\t\t\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;\n\t\t\t\t\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);\n\n\t\t\t\t}"})}getEdgeDetectionMaterial(){return new Pt({uniforms:{maskTexture:{value:null},texSize:{value:new fe(.5,.5)},visibleEdgeColor:{value:new R(1,1,1)},hiddenEdgeColor:{value:new R(1,1,1)}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec3 visibleEdgeColor;\n\t\t\t\tuniform vec3 hiddenEdgeColor;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\n\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\n\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\n\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\n\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\n\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\n\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\n\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\n\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\n\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\n\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\n\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\n\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\n\t\t\t\t}"})}getSeperableBlurMaterial(e){return new Pt({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new fe(.5,.5)},direction:{value:new fe(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\t\t\t\tuniform float kernelRadius;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat sigma = kernelRadius/2.0;\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, sigma);\n\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\n\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\n\t\t\t\t\tvec2 uvOffset = delta;\n\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = kernelRadius * float(i) / float(MAX_RADIUS);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, sigma);\n\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\n\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\n\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\n\t\t\t\t\t\tweightSum += (2.0 * w);\n\t\t\t\t\t\tuvOffset += delta;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\n\t\t\t\t}"})}getOverlayMaterial(){return new Pt({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform sampler2D edgeTexture1;\n\t\t\t\tuniform sampler2D edgeTexture2;\n\t\t\t\tuniform sampler2D patternTexture;\n\t\t\t\tuniform float edgeStrength;\n\t\t\t\tuniform float edgeGlow;\n\t\t\t\tuniform bool usePatternTexture;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\n\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\n\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\n\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\n\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\n\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\n\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\n\t\t\t\t\tif(usePatternTexture)\n\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\n\t\t\t\t\tgl_FragColor = finalColor;\n\t\t\t\t}",blending:xf,depthTest:!1,depthWrite:!1,transparent:!0})}}Wc.BlurDirectionX=new fe(1,0),Wc.BlurDirectionY=new fe(0,1);class lh extends Yi{getType(){return Wc}set renderScene(e){this._objRef&&(this._objRef.renderScene=e)}get renderScene(){return this._objRef?.renderScene}set renderCamera(e){this._objRef&&(this._objRef.renderCamera=e)}get renderCamera(){return this._objRef?.renderCamera}set selectedObjects(e){this._objRef&&(this._objRef.selectedObjects=e)}get selectedObjects(){return this._objRef?.selectedObjects}set visibleEdgeColor(e){this._objRef&&(this._objRef.visibleEdgeColor=Ye(this._objRef.visibleEdgeColor,e))}get visibleEdgeColor(){return this._objRef?.visibleEdgeColor}set hiddenEdgeColor(e){this._objRef&&(this._objRef.hiddenEdgeColor=Ye(this._objRef.hiddenEdgeColor,e))}get hiddenEdgeColor(){return this._objRef?.hiddenEdgeColor}set edgeGlow(e){this._objRef&&(this._objRef.edgeGlow=e)}get edgeGlow(){return this._objRef?.edgeGlow}set usePatternTexture(e){this._objRef&&(this._objRef.usePatternTexture=e)}get usePatternTexture(){return this._objRef?.usePatternTexture}set edgeThickness(e){this._objRef&&(this._objRef.edgeThickness=e)}get edgeThickness(){return this._objRef?.edgeThickness}set edgeStrength(e){this._objRef&&(this._objRef.edgeStrength=e)}get edgeStrength(){return this._objRef?.edgeStrength}set downSampleRatio(e){this._objRef&&(this._objRef.downSampleRatio=e)}get downSampleRatio(){return this._objRef?.downSampleRatio}set pulsePeriod(e){this._objRef&&(this._objRef.pulsePeriod=e)}get pulsePeriod(){return this._objRef?.pulsePeriod}set resolution(e){this._objRef&&(this._objRef.resolution=Ye(this._objRef.resolution,e))}get resolution(){return this._objRef?.resolution}set patternTexture(e){this._objRef&&(this._objRef.patternTexture=e)}get patternTexture(){return this._objRef?.patternTexture}set maskBufferMaterial(e){this._objRef&&(this._objRef.maskBufferMaterial=e)}get maskBufferMaterial(){return this._objRef?.maskBufferMaterial}set renderTargetMaskBuffer(e){this._objRef&&(this._objRef.renderTargetMaskBuffer=e)}get renderTargetMaskBuffer(){return this._objRef?.renderTargetMaskBuffer}set depthMaterial(e){this._objRef&&(this._objRef.depthMaterial=e)}get depthMaterial(){return this._objRef?.depthMaterial}set prepareMaskMaterial(e){this._objRef&&(this._objRef.prepareMaskMaterial=e)}get prepareMaskMaterial(){return this._objRef?.prepareMaskMaterial}set renderTargetDepthBuffer(e){this._objRef&&(this._objRef.renderTargetDepthBuffer=e)}get renderTargetDepthBuffer(){return this._objRef?.renderTargetDepthBuffer}set renderTargetMaskDownSampleBuffer(e){this._objRef&&(this._objRef.renderTargetMaskDownSampleBuffer=e)}get renderTargetMaskDownSampleBuffer(){return this._objRef?.renderTargetMaskDownSampleBuffer}set renderTargetBlurBuffer1(e){this._objRef&&(this._objRef.renderTargetBlurBuffer1=e)}get renderTargetBlurBuffer1(){return this._objRef?.renderTargetBlurBuffer1}set renderTargetBlurBuffer2(e){this._objRef&&(this._objRef.renderTargetBlurBuffer2=e)}get renderTargetBlurBuffer2(){return this._objRef?.renderTargetBlurBuffer2}set edgeDetectionMaterial(e){this._objRef&&(this._objRef.edgeDetectionMaterial=e)}get edgeDetectionMaterial(){return this._objRef?.edgeDetectionMaterial}set renderTargetEdgeBuffer1(e){this._objRef&&(this._objRef.renderTargetEdgeBuffer1=e)}get renderTargetEdgeBuffer1(){return this._objRef?.renderTargetEdgeBuffer1}set renderTargetEdgeBuffer2(e){this._objRef&&(this._objRef.renderTargetEdgeBuffer2=e)}get renderTargetEdgeBuffer2(){return this._objRef?.renderTargetEdgeBuffer2}set separableBlurMaterial1(e){this._objRef&&(this._objRef.separableBlurMaterial1=e)}get separableBlurMaterial1(){return this._objRef?.separableBlurMaterial1}set separableBlurMaterial2(e){this._objRef&&(this._objRef.separableBlurMaterial2=e)}get separableBlurMaterial2(){return this._objRef?.separableBlurMaterial2}set overlayMaterial(e){this._objRef&&(this._objRef.overlayMaterial=e)}get overlayMaterial(){return this._objRef?.overlayMaterial}set copyUniforms(e){this._objRef&&(this._objRef.copyUniforms=e)}get copyUniforms(){return this._objRef?.copyUniforms}set materialCopy(e){this._objRef&&(this._objRef.materialCopy=e)}get materialCopy(){return this._objRef?.materialCopy}set oldClearColor(e){this._objRef&&(this._objRef.oldClearColor=Ye(this._objRef.oldClearColor,e))}get oldClearColor(){return this._objRef?.oldClearColor}set oldClearAlpha(e){this._objRef&&(this._objRef.oldClearAlpha=e)}get oldClearAlpha(){return this._objRef?.oldClearAlpha}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}set tempPulseColor1(e){this._objRef&&(this._objRef.tempPulseColor1=Ye(this._objRef.tempPulseColor1,e))}get tempPulseColor1(){return this._objRef?.tempPulseColor1}set tempPulseColor2(e){this._objRef&&(this._objRef.tempPulseColor2=Ye(this._objRef.tempPulseColor2,e))}get tempPulseColor2(){return this._objRef?.tempPulseColor2}set textureMatrix(e){this._objRef&&(this._objRef.textureMatrix=Ye(this._objRef.textureMatrix,e))}get textureMatrix(){return this._objRef?.textureMatrix}}lh.\u0275fac=function(){let i;return function(t){return(i||(i=le(lh)))(t||lh)}}(),lh.\u0275cmp=$({type:lh,selectors:[["th-outlinePass"]],inputs:{renderScene:"renderScene",renderCamera:"renderCamera",selectedObjects:"selectedObjects",visibleEdgeColor:"visibleEdgeColor",hiddenEdgeColor:"hiddenEdgeColor",edgeGlow:"edgeGlow",usePatternTexture:"usePatternTexture",edgeThickness:"edgeThickness",edgeStrength:"edgeStrength",downSampleRatio:"downSampleRatio",pulsePeriod:"pulsePeriod",resolution:"resolution",patternTexture:"patternTexture",maskBufferMaterial:"maskBufferMaterial",renderTargetMaskBuffer:"renderTargetMaskBuffer",depthMaterial:"depthMaterial",prepareMaskMaterial:"prepareMaskMaterial",renderTargetDepthBuffer:"renderTargetDepthBuffer",renderTargetMaskDownSampleBuffer:"renderTargetMaskDownSampleBuffer",renderTargetBlurBuffer1:"renderTargetBlurBuffer1",renderTargetBlurBuffer2:"renderTargetBlurBuffer2",edgeDetectionMaterial:"edgeDetectionMaterial",renderTargetEdgeBuffer1:"renderTargetEdgeBuffer1",renderTargetEdgeBuffer2:"renderTargetEdgeBuffer2",separableBlurMaterial1:"separableBlurMaterial1",separableBlurMaterial2:"separableBlurMaterial2",overlayMaterial:"overlayMaterial",copyUniforms:"copyUniforms",materialCopy:"materialCopy",oldClearColor:"oldClearColor",oldClearAlpha:"oldClearAlpha",fsQuad:"fsQuad",tempPulseColor1:"tempPulseColor1",tempPulseColor2:"tempPulseColor2",textureMatrix:"textureMatrix"},features:[ne([{provide:Li,useExisting:ae(()=>lh)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Vbe extends Mt{constructor(e=((r,s,o)=>o.set(r,s,Math.cos(r)*Math.sin(s))),t=8,n=8){super(),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n};const r=[],s=[],o=[],a=[],l=1e-5,c=new R,d=new R,u=new R,h=new R,f=new R,m=t+1;for(let _=0;_<=n;_++){const g=_/n;for(let p=0;p<=t;p++){const v=p/t;e(v,g,d),s.push(d.x,d.y,d.z),v-l>=0?(e(v-l,g,u),h.subVectors(d,u)):(e(v+l,g,u),h.subVectors(u,d)),g-l>=0?(e(v,g-l,u),f.subVectors(d,u)):(e(v,g+l,u),f.subVectors(u,d)),c.crossVectors(h,f).normalize(),o.push(c.x,c.y,c.z),a.push(v,g)}}for(let _=0;_<n;_++)for(let g=0;g<t;g++){const v=_*m+g+1,b=(_+1)*m+g+1,y=(_+1)*m+g;r.push(_*m+g,v,y),r.push(v,b,y)}this.setIndex(r),this.setAttribute("position",new Ke(s,3)),this.setAttribute("normal",new Ke(o,3)),this.setAttribute("uv",new Ke(a,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Wm extends Rt{getType(){return Vbe}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set parameters(e){this._objRef&&(this._objRef.parameters=e)}get parameters(){return this._objRef?.parameters}}Wm.\u0275fac=function(){let i;return function(t){return(i||(i=le(Wm)))(t||Wm)}}(),Wm.\u0275cmp=$({type:Wm,selectors:[["th-parametricGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[ne([{provide:Rt,useExisting:ae(()=>Wm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class qm extends Rs{getType(){return E5}get type(){return this._objRef?.type}set plane(e){this._objRef&&(this._objRef.plane=Ye(this._objRef.plane,e))}get plane(){return this._objRef?.plane}set size(e){this._objRef&&(this._objRef.size=e)}get size(){return this._objRef?.size}}qm.\u0275fac=function(){let i;return function(t){return(i||(i=le(qm)))(t||qm)}}(),qm.\u0275cmp=$({type:qm,selectors:[["th-planeHelper"]],inputs:{plane:"plane",size:"size"},features:[ne([{provide:We,useExisting:ae(()=>qm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const Ym=new ro(0,0,0,"YXZ"),Xm=new R,Hbe={type:"change"},Qbe={type:"lock"},Wbe={type:"unlock"},ZG=Math.PI/2;class qbe extends as{constructor(e,t){super(),this.camera=e,this.domElement=t,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,this._onMouseMove=Ybe.bind(this),this._onPointerlockChange=Xbe.bind(this),this._onPointerlockError=Zbe.bind(this),this.connect()}connect(){this.domElement.ownerDocument.addEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this._onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this._onPointerlockError)}disconnect(){this.domElement.ownerDocument.removeEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this._onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this._onPointerlockError)}dispose(){this.disconnect()}getObject(){return this.camera}getDirection(e){return e.set(0,0,-1).applyQuaternion(this.camera.quaternion)}moveForward(e){const t=this.camera;Xm.setFromMatrixColumn(t.matrix,0),Xm.crossVectors(t.up,Xm),t.position.addScaledVector(Xm,e)}moveRight(e){const t=this.camera;Xm.setFromMatrixColumn(t.matrix,0),t.position.addScaledVector(Xm,e)}lock(){this.domElement.requestPointerLock()}unlock(){this.domElement.ownerDocument.exitPointerLock()}}function Ybe(i){if(!1===this.isLocked)return;const e=i.movementX||i.mozMovementX||i.webkitMovementX||0,t=i.movementY||i.mozMovementY||i.webkitMovementY||0,n=this.camera;Ym.setFromQuaternion(n.quaternion),Ym.y-=.002*e*this.pointerSpeed,Ym.x-=.002*t*this.pointerSpeed,Ym.x=Math.max(ZG-this.maxPolarAngle,Math.min(ZG-this.minPolarAngle,Ym.x)),n.quaternion.setFromEuler(Ym),this.dispatchEvent(Hbe)}function Xbe(){this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(Qbe),this.isLocked=!0):(this.dispatchEvent(Wbe),this.isLocked=!1)}function Zbe(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}class Zm extends qn{getType(){return qbe}set camera(e){this._objRef&&(this._objRef.camera=e)}get camera(){return this._objRef?.camera}set domElement(e){this._objRef&&(this._objRef.domElement=e)}get domElement(){return this._objRef?.domElement}set isLocked(e){this._objRef&&(this._objRef.isLocked=e)}get isLocked(){return this._objRef?.isLocked}set minPolarAngle(e){this._objRef&&(this._objRef.minPolarAngle=e)}get minPolarAngle(){return this._objRef?.minPolarAngle}set maxPolarAngle(e){this._objRef&&(this._objRef.maxPolarAngle=e)}get maxPolarAngle(){return this._objRef?.maxPolarAngle}set pointerSpeed(e){this._objRef&&(this._objRef.pointerSpeed=e)}get pointerSpeed(){return this._objRef?.pointerSpeed}}Zm.\u0275fac=function(){let i;return function(t){return(i||(i=le(Zm)))(t||Zm)}}(),Zm.\u0275cmp=$({type:Zm,selectors:[["th-pointerLockControls"]],inputs:{camera:"camera",domElement:"domElement",isLocked:"isLocked",minPolarAngle:"minPolarAngle",maxPolarAngle:"maxPolarAngle",pointerSpeed:"pointerSpeed"},features:[ne([{provide:qn,useExisting:ae(()=>Zm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Km extends We{getType(){return m5}get type(){return this._objRef?.type}set light(e){this._objRef&&(this._objRef.light=e)}get light(){return this._objRef?.light}set matrix(e){this._objRef&&(this._objRef.matrix=Ye(this._objRef.matrix,e))}get matrix(){return this._objRef?.matrix}set color(e){this._objRef&&(this._objRef.color=e)}get color(){return this._objRef?.color}set matrixAutoUpdate(e){this._objRef&&(this._objRef.matrixAutoUpdate=e)}get matrixAutoUpdate(){return this._objRef?.matrixAutoUpdate}}Km.\u0275fac=function(){let i;return function(t){return(i||(i=le(Km)))(t||Km)}}(),Km.\u0275cmp=$({type:Km,selectors:[["th-pointLightHelper"]],inputs:{light:"light",matrix:"matrix",color:"color",matrixAutoUpdate:"matrixAutoUpdate"},features:[ne([{provide:We,useExisting:ae(()=>Km)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class $m extends We{getType(){return su}get isPoints(){return this._objRef?.isPoints}get type(){return this._objRef?.type}set morphTargetInfluences(e){this._objRef&&(this._objRef.morphTargetInfluences=e)}get morphTargetInfluences(){return this._objRef?.morphTargetInfluences}set morphTargetDictionary(e){this._objRef&&(this._objRef.morphTargetDictionary=e)}get morphTargetDictionary(){return this._objRef?.morphTargetDictionary}set geometry(e){this._objRef&&(this._objRef.geometry=e)}get geometry(){return this._objRef?.geometry}set material(e){this._objRef&&(this._objRef.material=e)}get material(){return this._objRef?.material}}$m.\u0275fac=function(){let i;return function(t){return(i||(i=le($m)))(t||$m)}}(),$m.\u0275cmp=$({type:$m,selectors:[["th-points"]],inputs:{morphTargetInfluences:"morphTargetInfluences",morphTargetDictionary:"morphTargetDictionary",geometry:"geometry",material:"material"},features:[ne([{provide:We,useExisting:ae(()=>$m)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Jm extends Si{getType(){return Pl}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set color(e){this._objRef&&(this._objRef.color=Ye(this._objRef.color,e))}get color(){return this._objRef?.color}set map(e){this._objRef&&(this._objRef.map=e)}get map(){return this._objRef?.map}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}get alphaMap(){return this._objRef?.alphaMap}set size(e){this._objRef&&(this._objRef.size=e)}get size(){return this._objRef?.size}set sizeAttenuation(e){this._objRef&&(this._objRef.sizeAttenuation=e)}get sizeAttenuation(){return this._objRef?.sizeAttenuation}set fog(e){this._objRef&&(this._objRef.fog=e)}get fog(){return this._objRef?.fog}}Jm.\u0275fac=function(){let i;return function(t){return(i||(i=le(Jm)))(t||Jm)}}(),Jm.\u0275cmp=$({type:Jm,selectors:[["th-pointsMaterial"]],inputs:{type:"type",color:"color",map:"map",alphaMap:"alphaMap",size:"size",sizeAttenuation:"sizeAttenuation",fog:"fog"},features:[ne([{provide:Si,useExisting:ae(()=>Jm)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class eg extends Rs{getType(){return v5}get type(){return this._objRef?.type}}eg.\u0275fac=function(){let i;return function(t){return(i||(i=le(eg)))(t||eg)}}(),eg.\u0275cmp=$({type:eg,selectors:[["th-polarGridHelper"]],features:[ne([{provide:We,useExisting:ae(()=>eg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class tg extends qu{getType(){return n5}set panner(e){this._objRef&&(this._objRef.panner=e)}get panner(){return this._objRef?.panner}}tg.\u0275fac=function(){let i;return function(t){return(i||(i=le(tg)))(t||tg)}}(),tg.\u0275cmp=$({type:tg,selectors:[["th-positionalAudio"]],inputs:{panner:"panner"},features:[ne([{provide:We,useExisting:ae(()=>tg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class qc extends Si{getType(){return Pt}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set defines(e){this._objRef&&(this._objRef.defines=e)}get defines(){return this._objRef?.defines}set uniforms(e){this._objRef&&(this._objRef.uniforms=e)}get uniforms(){return this._objRef?.uniforms}set vertexShader(e){this._objRef&&(this._objRef.vertexShader=e)}get vertexShader(){return this._objRef?.vertexShader}set fragmentShader(e){this._objRef&&(this._objRef.fragmentShader=e)}get fragmentShader(){return this._objRef?.fragmentShader}set linewidth(e){this._objRef&&(this._objRef.linewidth=e)}get linewidth(){return this._objRef?.linewidth}set wireframe(e){this._objRef&&(this._objRef.wireframe=e)}get wireframe(){return this._objRef?.wireframe}set wireframeLinewidth(e){this._objRef&&(this._objRef.wireframeLinewidth=e)}get wireframeLinewidth(){return this._objRef?.wireframeLinewidth}set fog(e){this._objRef&&(this._objRef.fog=e)}get fog(){return this._objRef?.fog}set lights(e){this._objRef&&(this._objRef.lights=e)}get lights(){return this._objRef?.lights}set clipping(e){this._objRef&&(this._objRef.clipping=e)}get clipping(){return this._objRef?.clipping}set derivatives(e){this._objRef&&(this._objRef.derivatives=e)}get derivatives(){return this._objRef?.derivatives}set extensions(e){this._objRef&&(this._objRef.extensions=e)}get extensions(){return this._objRef?.extensions}set defaultAttributeValues(e){this._objRef&&(this._objRef.defaultAttributeValues=e)}get defaultAttributeValues(){return this._objRef?.defaultAttributeValues}set index0AttributeName(e){this._objRef&&(this._objRef.index0AttributeName=e)}get index0AttributeName(){return this._objRef?.index0AttributeName}set uniformsNeedUpdate(e){this._objRef&&(this._objRef.uniformsNeedUpdate=e)}get uniformsNeedUpdate(){return this._objRef?.uniformsNeedUpdate}set glslVersion(e){this._objRef&&(this._objRef.glslVersion=e)}get glslVersion(){return this._objRef?.glslVersion}set isShaderMaterial(e){this._objRef&&(this._objRef.isShaderMaterial=e)}get isShaderMaterial(){return this._objRef?.isShaderMaterial}}qc.\u0275fac=function(){let i;return function(t){return(i||(i=le(qc)))(t||qc)}}(),qc.\u0275cmp=$({type:qc,selectors:[["th-shaderMaterial"]],inputs:{type:"type",defines:"defines",uniforms:"uniforms",vertexShader:"vertexShader",fragmentShader:"fragmentShader",linewidth:"linewidth",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",fog:"fog",lights:"lights",clipping:"clipping",derivatives:"derivatives",extensions:"extensions",defaultAttributeValues:"defaultAttributeValues",index0AttributeName:"index0AttributeName",uniformsNeedUpdate:"uniformsNeedUpdate",glslVersion:"glslVersion",isShaderMaterial:"isShaderMaterial"},features:[ne([{provide:Si,useExisting:ae(()=>qc)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class ig extends qc{getType(){return ER}}ig.\u0275fac=function(){let i;return function(t){return(i||(i=le(ig)))(t||ig)}}(),ig.\u0275cmp=$({type:ig,selectors:[["th-rawShaderMaterial"]],features:[ne([{provide:Si,useExisting:ae(()=>ig)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class ng extends ao{getType(){return UR}get isRectAreaLight(){return this._objRef?.isRectAreaLight}get type(){return this._objRef?.type}set width(e){this._objRef&&(this._objRef.width=e)}get width(){return this._objRef?.width}set height(e){this._objRef&&(this._objRef.height=e)}get height(){return this._objRef?.height}set intensity(e){this._objRef&&(this._objRef.intensity=e)}get intensity(){return this._objRef?.intensity}set power(e){this._objRef&&(this._objRef.power=e)}get power(){return this._objRef?.power}}ng.\u0275fac=function(){let i;return function(t){return(i||(i=le(ng)))(t||ng)}}(),ng.\u0275cmp=$({type:ng,selectors:[["th-rectAreaLight"]],inputs:{width:"width",height:"height",intensity:"intensity",power:"power"},features:[ne([{provide:We,useExisting:ae(()=>ng)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class rg extends Rt{getType(){return vp}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}}rg.\u0275fac=function(){let i;return function(t){return(i||(i=le(rg)))(t||rg)}}(),rg.\u0275cmp=$({type:rg,selectors:[["th-ringGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>rg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const I0=new R;function Uo(i,e,t,n,r,s){const o=2*Math.PI*r/4,a=Math.max(s-2*r,0),l=Math.PI/4;I0.copy(e),I0[n]=0,I0.normalize();const c=.5*o/(o+a),d=1-I0.angleTo(i)/l;return 1===Math.sign(I0[t])?d*c:a/(o+a)+c+c*(1-d)}class a0e extends tn{constructor(e=1,t=1,n=1,r=2,s=.1){if(r=2*r+1,s=Math.min(e/2,t/2,n/2,s),super(1,1,1,r,r,r),1===r)return;const o=this.toNonIndexed();this.index=null,this.attributes.position=o.attributes.position,this.attributes.normal=o.attributes.normal,this.attributes.uv=o.attributes.uv;const a=new R,l=new R,c=new R(e,t,n).divideScalar(2).subScalar(s),d=this.attributes.position.array,u=this.attributes.normal.array,h=this.attributes.uv.array,f=d.length/6,m=new R,_=.5/r;for(let g=0,p=0;g<d.length;g+=3,p+=2)switch(a.fromArray(d,g),l.copy(a),l.x-=Math.sign(l.x)*_,l.y-=Math.sign(l.y)*_,l.z-=Math.sign(l.z)*_,l.normalize(),d[g+0]=c.x*Math.sign(a.x)+l.x*s,d[g+1]=c.y*Math.sign(a.y)+l.y*s,d[g+2]=c.z*Math.sign(a.z)+l.z*s,u[g+0]=l.x,u[g+1]=l.y,u[g+2]=l.z,Math.floor(g/f)){case 0:m.set(1,0,0),h[p+0]=Uo(m,l,"z","y",s,n),h[p+1]=1-Uo(m,l,"y","z",s,t);break;case 1:m.set(-1,0,0),h[p+0]=1-Uo(m,l,"z","y",s,n),h[p+1]=1-Uo(m,l,"y","z",s,t);break;case 2:m.set(0,1,0),h[p+0]=1-Uo(m,l,"x","z",s,e),h[p+1]=Uo(m,l,"z","x",s,n);break;case 3:m.set(0,-1,0),h[p+0]=1-Uo(m,l,"x","z",s,e),h[p+1]=1-Uo(m,l,"z","x",s,n);break;case 4:m.set(0,0,1),h[p+0]=1-Uo(m,l,"x","y",s,e),h[p+1]=1-Uo(m,l,"y","x",s,t);break;case 5:m.set(0,0,-1),h[p+0]=Uo(m,l,"x","y",s,e),h[p+1]=1-Uo(m,l,"y","x",s,t)}}}class sg extends Ha{getType(){return a0e}}sg.\u0275fac=function(){let i;return function(t){return(i||(i=le(sg)))(t||sg)}}(),sg.\u0275cmp=$({type:sg,selectors:[["th-roundedBoxGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>sg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const Yw={defines:{NUM_SAMPLES:7,NUM_RINGS:4,NORMAL_TEXTURE:0,DIFFUSE_TEXTURE:0,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},tDiffuse:{value:null},tNormal:{value:null},size:{value:new fe(512,512)},cameraNear:{value:1},cameraFar:{value:100},cameraProjectionMatrix:{value:new Qe},cameraInverseProjectionMatrix:{value:new Qe},scale:{value:1},intensity:{value:.1},bias:{value:.5},minResolution:{value:0},kernelRadius:{value:100},randomSeed:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t}",fragmentShader:"\n\n\t\t#include <common>\n\n\t\tvarying vec2 vUv;\n\n\t\t#if DIFFUSE_TEXTURE == 1\n\t\tuniform sampler2D tDiffuse;\n\t\t#endif\n\n\t\tuniform sampler2D tDepth;\n\n\t\t#if NORMAL_TEXTURE == 1\n\t\tuniform sampler2D tNormal;\n\t\t#endif\n\n\t\tuniform float cameraNear;\n\t\tuniform float cameraFar;\n\t\tuniform mat4 cameraProjectionMatrix;\n\t\tuniform mat4 cameraInverseProjectionMatrix;\n\n\t\tuniform float scale;\n\t\tuniform float intensity;\n\t\tuniform float bias;\n\t\tuniform float kernelRadius;\n\t\tuniform float minResolution;\n\t\tuniform vec2 size;\n\t\tuniform float randomSeed;\n\n\t\t// RGBA depth\n\n\t\t#include <packing>\n\n\t\tvec4 getDefaultColor( const in vec2 screenPosition ) {\n\t\t\t#if DIFFUSE_TEXTURE == 1\n\t\t\treturn texture2D( tDiffuse, vUv );\n\t\t\t#else\n\t\t\treturn vec4( 1.0 );\n\t\t\t#endif\n\t\t}\n\n\t\tfloat getDepth( const in vec2 screenPosition ) {\n\t\t\t#if DEPTH_PACKING == 1\n\t\t\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );\n\t\t\t#else\n\t\t\treturn texture2D( tDepth, screenPosition ).x;\n\t\t\t#endif\n\t\t}\n\n\t\tfloat getViewZ( const in float depth ) {\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\t\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#else\n\t\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#endif\n\t\t}\n\n\t\tvec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {\n\t\t\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];\n\t\t\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );\n\t\t\tclipPosition *= clipW; // unprojection.\n\n\t\t\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;\n\t\t}\n\n\t\tvec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {\n\t\t\t#if NORMAL_TEXTURE == 1\n\t\t\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );\n\t\t\t#else\n\t\t\treturn normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );\n\t\t\t#endif\n\t\t}\n\n\t\tfloat scaleDividedByCameraFar;\n\t\tfloat minResolutionMultipliedByCameraFar;\n\n\t\tfloat getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {\n\t\t\tvec3 viewDelta = sampleViewPosition - centerViewPosition;\n\t\t\tfloat viewDistance = length( viewDelta );\n\t\t\tfloat scaledScreenDistance = scaleDividedByCameraFar * viewDistance;\n\n\t\t\treturn max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );\n\t\t}\n\n\t\t// moving costly divides into consts\n\t\tconst float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );\n\t\tconst float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );\n\n\t\tfloat getAmbientOcclusion( const in vec3 centerViewPosition ) {\n\t\t\t// precompute some variables require in getOcclusion.\n\t\t\tscaleDividedByCameraFar = scale / cameraFar;\n\t\t\tminResolutionMultipliedByCameraFar = minResolution * cameraFar;\n\t\t\tvec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );\n\n\t\t\t// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/\n\t\t\tfloat angle = rand( vUv + randomSeed ) * PI2;\n\t\t\tvec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;\n\t\t\tvec2 radiusStep = radius;\n\n\t\t\tfloat occlusionSum = 0.0;\n\t\t\tfloat weightSum = 0.0;\n\n\t\t\tfor( int i = 0; i < NUM_SAMPLES; i ++ ) {\n\t\t\t\tvec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;\n\t\t\t\tradius += radiusStep;\n\t\t\t\tangle += ANGLE_STEP;\n\n\t\t\t\tfloat sampleDepth = getDepth( sampleUv );\n\t\t\t\tif( sampleDepth >= ( 1.0 - EPSILON ) ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tfloat sampleViewZ = getViewZ( sampleDepth );\n\t\t\t\tvec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );\n\t\t\t\tocclusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );\n\t\t\t\tweightSum += 1.0;\n\t\t\t}\n\n\t\t\tif( weightSum == 0.0 ) discard;\n\n\t\t\treturn occlusionSum * ( intensity / weightSum );\n\t\t}\n\n\t\tvoid main() {\n\t\t\tfloat centerDepth = getDepth( vUv );\n\t\t\tif( centerDepth >= ( 1.0 - EPSILON ) ) {\n\t\t\t\tdiscard;\n\t\t\t}\n\n\t\t\tfloat centerViewZ = getViewZ( centerDepth );\n\t\t\tvec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );\n\n\t\t\tfloat ambientOcclusion = getAmbientOcclusion( viewPosition );\n\n\t\t\tgl_FragColor = getDefaultColor( vUv );\n\t\t\tgl_FragColor.xyz *=  1.0 - ambientOcclusion;\n\t\t}"},Yc={defines:{KERNEL_RADIUS:4,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDiffuse:{value:null},size:{value:new fe(512,512)},sampleUvOffsets:{value:[new fe(0,0)]},sampleWeights:{value:[1]},tDepth:{value:null},cameraNear:{value:10},cameraFar:{value:1e3},depthCutoff:{value:10}},vertexShader:"\n\n\t\t#include <common>\n\n\t\tuniform vec2 size;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec2 vInvSize;\n\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tvInvSize = 1.0 / size;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t}",fragmentShader:"\n\n\t\t#include <common>\n\t\t#include <packing>\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tDepth;\n\n\t\tuniform float cameraNear;\n\t\tuniform float cameraFar;\n\t\tuniform float depthCutoff;\n\n\t\tuniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];\n\t\tuniform float sampleWeights[ KERNEL_RADIUS + 1 ];\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec2 vInvSize;\n\n\t\tfloat getDepth( const in vec2 screenPosition ) {\n\t\t\t#if DEPTH_PACKING == 1\n\t\t\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );\n\t\t\t#else\n\t\t\treturn texture2D( tDepth, screenPosition ).x;\n\t\t\t#endif\n\t\t}\n\n\t\tfloat getViewZ( const in float depth ) {\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\t\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#else\n\t\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#endif\n\t\t}\n\n\t\tvoid main() {\n\t\t\tfloat depth = getDepth( vUv );\n\t\t\tif( depth >= ( 1.0 - EPSILON ) ) {\n\t\t\t\tdiscard;\n\t\t\t}\n\n\t\t\tfloat centerViewZ = -getViewZ( depth );\n\t\t\tbool rBreak = false, lBreak = false;\n\n\t\t\tfloat weightSum = sampleWeights[0];\n\t\t\tvec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;\n\n\t\t\tfor( int i = 1; i <= KERNEL_RADIUS; i ++ ) {\n\n\t\t\t\tfloat sampleWeight = sampleWeights[i];\n\t\t\t\tvec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;\n\n\t\t\t\tvec2 sampleUv = vUv + sampleUvOffset;\n\t\t\t\tfloat viewZ = -getViewZ( getDepth( sampleUv ) );\n\n\t\t\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;\n\n\t\t\t\tif( ! rBreak ) {\n\t\t\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;\n\t\t\t\t\tweightSum += sampleWeight;\n\t\t\t\t}\n\n\t\t\t\tsampleUv = vUv - sampleUvOffset;\n\t\t\t\tviewZ = -getViewZ( getDepth( sampleUv ) );\n\n\t\t\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;\n\n\t\t\t\tif( ! lBreak ) {\n\t\t\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;\n\t\t\t\t\tweightSum += sampleWeight;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tgl_FragColor = diffuseSum / weightSum;\n\t\t}"},Xw={createSampleWeights:function(i,e){const t=[];for(let n=0;n<=i;n++)t.push(c0e(n,e));return t},createSampleOffsets:function(i,e){const t=[];for(let n=0;n<=i;n++)t.push(e.clone().multiplyScalar(n));return t},configure:function(i,e,t,n){i.defines.KERNEL_RADIUS=e,i.uniforms.sampleUvOffsets.value=Xw.createSampleOffsets(e,n),i.uniforms.sampleWeights.value=Xw.createSampleWeights(e,t),i.needsUpdate=!0}};function c0e(i,e){return Math.exp(-i*i/(e*e*2))/(Math.sqrt(2*Math.PI)*e)}const bD_uniforms={tDiffuse:{value:null},opacity:{value:1}},bD_vertexShader="\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",bD_fragmentShader="\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\t#include <packing>\n\n\t\tvoid main() {\n\n\t\t\tfloat depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );\n\t\t\tgl_FragColor = vec4( vec3( depth ), opacity );\n\n\t\t}";let KG=(()=>{class i extends wn{constructor(t,n,r=!1,s=!1,o=new fe(256,256)){let a;super(),this.scene=t,this.camera=n,this.clear=!0,this.needsSwap=!1,this.supportsDepthTextureExtension=r,this.supportsNormalTexture=s,this.originalClearColor=new Le,this._oldClearColor=new Le,this.oldClearAlpha=1,this.params={output:0,saoBias:.5,saoIntensity:.18,saoScale:1,saoKernelRadius:100,saoMinResolution:0,saoBlur:!0,saoBlurRadius:8,saoBlurStdDev:4,saoBlurDepthCutoff:.01},this.resolution=new fe(o.x,o.y),this.saoRenderTarget=new Gt(this.resolution.x,this.resolution.y),this.blurIntermediateRenderTarget=this.saoRenderTarget.clone(),this.beautyRenderTarget=this.saoRenderTarget.clone(),this.normalRenderTarget=new Gt(this.resolution.x,this.resolution.y,{minFilter:$t,magFilter:$t}),this.depthRenderTarget=this.normalRenderTarget.clone(),this.supportsDepthTextureExtension&&(a=new rp,a.type=$_,this.beautyRenderTarget.depthTexture=a,this.beautyRenderTarget.depthBuffer=!0),this.depthMaterial=new nu,this.depthMaterial.depthPacking=rb,this.depthMaterial.blending=Kt,this.normalMaterial=new Cp,this.normalMaterial.blending=Kt,this.saoMaterial=new Pt({defines:Object.assign({},Yw.defines),fragmentShader:Yw.fragmentShader,vertexShader:Yw.vertexShader,uniforms:gi.clone(Yw.uniforms)}),this.saoMaterial.extensions.derivatives=!0,this.saoMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.saoMaterial.defines.NORMAL_TEXTURE=this.supportsNormalTexture?1:0,this.saoMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.saoMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?a:this.depthRenderTarget.texture,this.saoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.saoMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.blending=Kt,this.vBlurMaterial=new Pt({uniforms:gi.clone(Yc.uniforms),defines:Object.assign({},Yc.defines),vertexShader:Yc.vertexShader,fragmentShader:Yc.fragmentShader}),this.vBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.vBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.vBlurMaterial.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.vBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?a:this.depthRenderTarget.texture,this.vBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.vBlurMaterial.blending=Kt,this.hBlurMaterial=new Pt({uniforms:gi.clone(Yc.uniforms),defines:Object.assign({},Yc.defines),vertexShader:Yc.vertexShader,fragmentShader:Yc.fragmentShader}),this.hBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.hBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.hBlurMaterial.uniforms.tDiffuse.value=this.blurIntermediateRenderTarget.texture,this.hBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?a:this.depthRenderTarget.texture,this.hBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.hBlurMaterial.blending=Kt,this.materialCopy=new Pt({uniforms:gi.clone(Yr.uniforms),vertexShader:Yr.vertexShader,fragmentShader:Yr.fragmentShader,blending:Kt}),this.materialCopy.transparent=!0,this.materialCopy.depthTest=!1,this.materialCopy.depthWrite=!1,this.materialCopy.blending=wf,this.materialCopy.blendSrc=Ay,this.materialCopy.blendDst=Cf,this.materialCopy.blendEquation=ws,this.materialCopy.blendSrcAlpha=vy,this.materialCopy.blendDstAlpha=Cf,this.materialCopy.blendEquationAlpha=ws,this.depthCopy=new Pt({uniforms:gi.clone(bD_uniforms),vertexShader:bD_vertexShader,fragmentShader:bD_fragmentShader,blending:Kt}),this.fsQuad=new xr(null)}render(t,n,r){if(this.renderToScreen&&(this.materialCopy.blending=Kt,this.materialCopy.uniforms.tDiffuse.value=r.texture,this.materialCopy.needsUpdate=!0,this.renderPass(t,this.materialCopy,null)),1===this.params.output)return;t.getClearColor(this._oldClearColor),this.oldClearAlpha=t.getClearAlpha();const s=t.autoClear;t.autoClear=!1,t.setRenderTarget(this.depthRenderTarget),t.clear(),this.saoMaterial.uniforms.bias.value=this.params.saoBias,this.saoMaterial.uniforms.intensity.value=this.params.saoIntensity,this.saoMaterial.uniforms.scale.value=this.params.saoScale,this.saoMaterial.uniforms.kernelRadius.value=this.params.saoKernelRadius,this.saoMaterial.uniforms.minResolution.value=this.params.saoMinResolution,this.saoMaterial.uniforms.cameraNear.value=this.camera.near,this.saoMaterial.uniforms.cameraFar.value=this.camera.far;const o=this.params.saoBlurDepthCutoff*(this.camera.far-this.camera.near);this.vBlurMaterial.uniforms.depthCutoff.value=o,this.hBlurMaterial.uniforms.depthCutoff.value=o,this.vBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.vBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.hBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.hBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.params.saoBlurRadius=Math.floor(this.params.saoBlurRadius),(this.prevStdDev!==this.params.saoBlurStdDev||this.prevNumSamples!==this.params.saoBlurRadius)&&(Xw.configure(this.vBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new fe(0,1)),Xw.configure(this.hBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new fe(1,0)),this.prevStdDev=this.params.saoBlurStdDev,this.prevNumSamples=this.params.saoBlurRadius),t.setClearColor(0),t.setRenderTarget(this.beautyRenderTarget),t.clear(),t.render(this.scene,this.camera),this.supportsDepthTextureExtension||this.renderOverride(t,this.depthMaterial,this.depthRenderTarget,0,1),this.supportsNormalTexture&&this.renderOverride(t,this.normalMaterial,this.normalRenderTarget,7829503,1),this.renderPass(t,this.saoMaterial,this.saoRenderTarget,16777215,1),this.params.saoBlur&&(this.renderPass(t,this.vBlurMaterial,this.blurIntermediateRenderTarget,16777215,1),this.renderPass(t,this.hBlurMaterial,this.saoRenderTarget,16777215,1));let a=this.materialCopy;3===this.params.output?this.supportsDepthTextureExtension?(this.materialCopy.uniforms.tDiffuse.value=this.beautyRenderTarget.depthTexture,this.materialCopy.needsUpdate=!0):(this.depthCopy.uniforms.tDiffuse.value=this.depthRenderTarget.texture,this.depthCopy.needsUpdate=!0,a=this.depthCopy):4===this.params.output?(this.materialCopy.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.materialCopy.needsUpdate=!0):(this.materialCopy.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.materialCopy.needsUpdate=!0),a.blending=0===this.params.output?wf:Kt,this.renderPass(t,a,this.renderToScreen?null:r),t.setClearColor(this._oldClearColor,this.oldClearAlpha),t.autoClear=s}renderPass(t,n,r,s,o){t.getClearColor(this.originalClearColor);const a=t.getClearAlpha(),l=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,null!=s&&(t.setClearColor(s),t.setClearAlpha(o||0),t.clear()),this.fsQuad.material=n,this.fsQuad.render(t),t.autoClear=l,t.setClearColor(this.originalClearColor),t.setClearAlpha(a)}renderOverride(t,n,r,s,o){t.getClearColor(this.originalClearColor);const a=t.getClearAlpha(),l=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,o=n.clearAlpha||o,null!=(s=n.clearColor||s)&&(t.setClearColor(s),t.setClearAlpha(o||0),t.clear()),this.scene.overrideMaterial=n,t.render(this.scene,this.camera),this.scene.overrideMaterial=null,t.autoClear=l,t.setClearColor(this.originalClearColor),t.setClearAlpha(a)}setSize(t,n){this.beautyRenderTarget.setSize(t,n),this.saoRenderTarget.setSize(t,n),this.blurIntermediateRenderTarget.setSize(t,n),this.normalRenderTarget.setSize(t,n),this.depthRenderTarget.setSize(t,n),this.saoMaterial.uniforms.size.value.set(t,n),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.needsUpdate=!0,this.vBlurMaterial.uniforms.size.value.set(t,n),this.vBlurMaterial.needsUpdate=!0,this.hBlurMaterial.uniforms.size.value.set(t,n),this.hBlurMaterial.needsUpdate=!0}dispose(){this.saoRenderTarget.dispose(),this.blurIntermediateRenderTarget.dispose(),this.beautyRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.depthRenderTarget.dispose(),this.depthMaterial.dispose(),this.normalMaterial.dispose(),this.saoMaterial.dispose(),this.vBlurMaterial.dispose(),this.hBlurMaterial.dispose(),this.materialCopy.dispose(),this.depthCopy.dispose(),this.fsQuad.dispose()}}return i.OUTPUT={Beauty:1,Default:0,SAO:2,Depth:3,Normal:4},i})();class ch extends Yi{getType(){return KG}set scene(e){this._objRef&&(this._objRef.scene=e)}get scene(){return this._objRef?.scene}set camera(e){this._objRef&&(this._objRef.camera=e)}get camera(){return this._objRef?.camera}set supportsDepthTextureExtension(e){this._objRef&&(this._objRef.supportsDepthTextureExtension=e)}get supportsDepthTextureExtension(){return this._objRef?.supportsDepthTextureExtension}set supportsNormalTexture(e){this._objRef&&(this._objRef.supportsNormalTexture=e)}get supportsNormalTexture(){return this._objRef?.supportsNormalTexture}set originalClearColor(e){this._objRef&&(this._objRef.originalClearColor=Ye(this._objRef.originalClearColor,e))}get originalClearColor(){return this._objRef?.originalClearColor}set oldClearColor(e){this._objRef&&(this._objRef.oldClearColor=Ye(this._objRef.oldClearColor,e))}get oldClearColor(){return this._objRef?.oldClearColor}set oldClearAlpha(e){this._objRef&&(this._objRef.oldClearAlpha=e)}get oldClearAlpha(){return this._objRef?.oldClearAlpha}set resolution(e){this._objRef&&(this._objRef.resolution=Ye(this._objRef.resolution,e))}get resolution(){return this._objRef?.resolution}set saoRenderTarget(e){this._objRef&&(this._objRef.saoRenderTarget=e)}get saoRenderTarget(){return this._objRef?.saoRenderTarget}set blurIntermediateRenderTarget(e){this._objRef&&(this._objRef.blurIntermediateRenderTarget=e)}get blurIntermediateRenderTarget(){return this._objRef?.blurIntermediateRenderTarget}set beautyRenderTarget(e){this._objRef&&(this._objRef.beautyRenderTarget=e)}get beautyRenderTarget(){return this._objRef?.beautyRenderTarget}set normalRenderTarget(e){this._objRef&&(this._objRef.normalRenderTarget=e)}get normalRenderTarget(){return this._objRef?.normalRenderTarget}set depthRenderTarget(e){this._objRef&&(this._objRef.depthRenderTarget=e)}get depthRenderTarget(){return this._objRef?.depthRenderTarget}set depthMaterial(e){this._objRef&&(this._objRef.depthMaterial=e)}get depthMaterial(){return this._objRef?.depthMaterial}set normalMaterial(e){this._objRef&&(this._objRef.normalMaterial=e)}get normalMaterial(){return this._objRef?.normalMaterial}set saoMaterial(e){this._objRef&&(this._objRef.saoMaterial=e)}get saoMaterial(){return this._objRef?.saoMaterial}set vBlurMaterial(e){this._objRef&&(this._objRef.vBlurMaterial=e)}get vBlurMaterial(){return this._objRef?.vBlurMaterial}set hBlurMaterial(e){this._objRef&&(this._objRef.hBlurMaterial=e)}get hBlurMaterial(){return this._objRef?.hBlurMaterial}set materialCopy(e){this._objRef&&(this._objRef.materialCopy=e)}get materialCopy(){return this._objRef?.materialCopy}set depthCopy(e){this._objRef&&(this._objRef.depthCopy=e)}get depthCopy(){return this._objRef?.depthCopy}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}set params(e){this._objRef&&(this._objRef.params=e)}get params(){return this._objRef?.params}}ch.OUTPUT=KG.OUTPUT,ch.\u0275fac=function(){let i;return function(t){return(i||(i=le(ch)))(t||ch)}}(),ch.\u0275cmp=$({type:ch,selectors:[["th-sAOPass"]],inputs:{scene:"scene",camera:"camera",supportsDepthTextureExtension:"supportsDepthTextureExtension",supportsNormalTexture:"supportsNormalTexture",originalClearColor:"originalClearColor",oldClearColor:"oldClearColor",oldClearAlpha:"oldClearAlpha",resolution:"resolution",saoRenderTarget:"saoRenderTarget",blurIntermediateRenderTarget:"blurIntermediateRenderTarget",beautyRenderTarget:"beautyRenderTarget",normalRenderTarget:"normalRenderTarget",depthRenderTarget:"depthRenderTarget",depthMaterial:"depthMaterial",normalMaterial:"normalMaterial",saoMaterial:"saoMaterial",vBlurMaterial:"vBlurMaterial",hBlurMaterial:"hBlurMaterial",materialCopy:"materialCopy",depthCopy:"depthCopy",fsQuad:"fsQuad",params:"params"},features:[ne([{provide:Li,useExisting:ae(()=>ch)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class u0e extends wn{constructor(e){super();const t=Yr;this.textureID="tDiffuse",this.uniforms=gi.clone(t.uniforms),this.material=new Pt({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.renderTarget=e,void 0===this.renderTarget&&(this.renderTarget=new Gt,this.renderTarget.texture.name="SavePass.rt"),this.needsSwap=!1,this.fsQuad=new xr(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),e.setRenderTarget(this.renderTarget),this.clear&&e.clear(),this.fsQuad.render(e)}setSize(e,t){this.renderTarget.setSize(e,t)}dispose(){this.renderTarget.dispose(),this.material.dispose(),this.fsQuad.dispose()}}class og extends Yi{getType(){return u0e}set textureID(e){this._objRef&&(this._objRef.textureID=e)}get textureID(){return this._objRef?.textureID}set renderTarget(e){this._objRef&&(this._objRef.renderTarget=e)}get renderTarget(){return this._objRef?.renderTarget}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}get uniforms(){return this._objRef?.uniforms}set material(e){this._objRef&&(this._objRef.material=e)}get material(){return this._objRef?.material}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}}og.\u0275fac=function(){let i;return function(t){return(i||(i=le(og)))(t||og)}}(),og.\u0275cmp=$({type:og,selectors:[["th-savePass"]],inputs:{textureID:"textureID",renderTarget:"renderTarget",uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[ne([{provide:Li,useExisting:ae(()=>og)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class ag extends Si{getType(){return MR}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set color(e){this._objRef&&(this._objRef.color=Ye(this._objRef.color,e))}get color(){return this._objRef?.color}set transparent(e){this._objRef&&(this._objRef.transparent=e)}get transparent(){return this._objRef?.transparent}set fog(e){this._objRef&&(this._objRef.fog=e)}get fog(){return this._objRef?.fog}}ag.\u0275fac=function(){let i;return function(t){return(i||(i=le(ag)))(t||ag)}}(),ag.\u0275cmp=$({type:ag,selectors:[["th-shadowMaterial"]],inputs:{type:"type",color:"color",transparent:"transparent",fog:"fog"},features:[ne([{provide:Si,useExisting:ae(()=>ag)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class lg extends Rt{getType(){return Ap}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}}lg.\u0275fac=function(){let i;return function(t){return(i||(i=le(lg)))(t||lg)}}(),lg.\u0275cmp=$({type:lg,selectors:[["th-shapeGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>lg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class cg extends Rs{getType(){return f5}get type(){return this._objRef?.type}set bones(e){this._objRef&&(this._objRef.bones=e)}get bones(){return this._objRef?.bones}set root(e){this._objRef&&(this._objRef.root=e)}get root(){return this._objRef?.root}set matrix(e){this._objRef&&(this._objRef.matrix=Ye(this._objRef.matrix,e))}get matrix(){return this._objRef?.matrix}set matrixAutoUpdate(e){this._objRef&&(this._objRef.matrixAutoUpdate=e)}get matrixAutoUpdate(){return this._objRef?.matrixAutoUpdate}}cg.\u0275fac=function(){let i;return function(t){return(i||(i=le(cg)))(t||cg)}}(),cg.\u0275cmp=$({type:cg,selectors:[["th-skeletonHelper"]],inputs:{bones:"bones",root:"root",matrix:"matrix",matrixAutoUpdate:"matrixAutoUpdate"},features:[ne([{provide:We,useExisting:ae(()=>cg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class dg extends Pn{getType(){return wb}get isSkinnedMesh(){return this._objRef?.isSkinnedMesh}get type(){return this._objRef?.type}set bindMode(e){this._objRef&&(this._objRef.bindMode=e)}get bindMode(){return this._objRef?.bindMode}set bindMatrix(e){this._objRef&&(this._objRef.bindMatrix=Ye(this._objRef.bindMatrix,e))}get bindMatrix(){return this._objRef?.bindMatrix}set bindMatrixInverse(e){this._objRef&&(this._objRef.bindMatrixInverse=Ye(this._objRef.bindMatrixInverse,e))}get bindMatrixInverse(){return this._objRef?.bindMatrixInverse}set boundingBox(e){this._objRef&&(this._objRef.boundingBox=Ye(this._objRef.boundingBox,e))}get boundingBox(){return this._objRef?.boundingBox}set boundingSphere(e){this._objRef&&(this._objRef.boundingSphere=Ye(this._objRef.boundingSphere,e))}get boundingSphere(){return this._objRef?.boundingSphere}set skeleton(e){this._objRef&&(this._objRef.skeleton=e)}get skeleton(){return this._objRef?.skeleton}}dg.\u0275fac=function(){let i;return function(t){return(i||(i=le(dg)))(t||dg)}}(),dg.\u0275cmp=$({type:dg,selectors:[["th-skinnedMesh"]],inputs:{bindMode:"bindMode",bindMatrix:"bindMatrix",bindMatrixInverse:"bindMatrixInverse",boundingBox:"boundingBox",boundingSphere:"boundingSphere",skeleton:"skeleton"},features:[ne([{provide:We,useExisting:ae(()=>dg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const Zw={defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new fe(1/1024,1/512)}},vertexShader:"\n\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 3 ];\n\n\t\tvoid SMAAEdgeDetectionVS( vec2 texcoord ) {\n\t\t\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 ); // WebGL port note: Changed sign in W component\n\t\t\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component\n\t\t\tvOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 ); // WebGL port note: Changed sign in W component\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tSMAAEdgeDetectionVS( vUv );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 3 ];\n\n\t\tvec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {\n\t\t\tvec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );\n\n\t\t\t// Calculate color deltas:\n\t\t\tvec4 delta;\n\t\t\tvec3 C = texture2D( colorTex, texcoord ).rgb;\n\n\t\t\tvec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;\n\t\t\tvec3 t = abs( C - Cleft );\n\t\t\tdelta.x = max( max( t.r, t.g ), t.b );\n\n\t\t\tvec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;\n\t\t\tt = abs( C - Ctop );\n\t\t\tdelta.y = max( max( t.r, t.g ), t.b );\n\n\t\t\t// We do the usual threshold:\n\t\t\tvec2 edges = step( threshold, delta.xy );\n\n\t\t\t// Then discard if there is no edge:\n\t\t\tif ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )\n\t\t\t\tdiscard;\n\n\t\t\t// Calculate right and bottom deltas:\n\t\t\tvec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;\n\t\t\tt = abs( C - Cright );\n\t\t\tdelta.z = max( max( t.r, t.g ), t.b );\n\n\t\t\tvec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;\n\t\t\tt = abs( C - Cbottom );\n\t\t\tdelta.w = max( max( t.r, t.g ), t.b );\n\n\t\t\t// Calculate the maximum delta in the direct neighborhood:\n\t\t\tfloat maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );\n\n\t\t\t// Calculate left-left and top-top deltas:\n\t\t\tvec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;\n\t\t\tt = abs( C - Cleftleft );\n\t\t\tdelta.z = max( max( t.r, t.g ), t.b );\n\n\t\t\tvec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;\n\t\t\tt = abs( C - Ctoptop );\n\t\t\tdelta.w = max( max( t.r, t.g ), t.b );\n\n\t\t\t// Calculate the final maximum delta:\n\t\t\tmaxDelta = max( max( maxDelta, delta.z ), delta.w );\n\n\t\t\t// Local contrast adaptation in action:\n\t\t\tedges.xy *= step( 0.5 * maxDelta, delta.xy );\n\n\t\t\treturn vec4( edges, 0.0, 0.0 );\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );\n\n\t\t}"},Kw={defines:{SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},uniforms:{tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new fe(1/1024,1/512)}},vertexShader:"\n\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 3 ];\n\t\tvarying vec2 vPixcoord;\n\n\t\tvoid SMAABlendingWeightCalculationVS( vec2 texcoord ) {\n\t\t\tvPixcoord = texcoord / resolution;\n\n\t\t\t// We will use these offsets for the searches later on (see @PSEUDO_GATHER4):\n\t\t\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 ); // WebGL port note: Changed sign in Y and W components\n\t\t\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 ); // WebGL port note: Changed sign in Y and W components\n\n\t\t\t// And these for the searches, they indicate the ends of the loops:\n\t\t\tvOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tSMAABlendingWeightCalculationVS( vUv );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\t#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tArea;\n\t\tuniform sampler2D tSearch;\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[3];\n\t\tvarying vec2 vPixcoord;\n\n\t\t#if __VERSION__ == 100\n\t\tvec2 round( vec2 x ) {\n\t\t\treturn sign( x ) * floor( abs( x ) + 0.5 );\n\t\t}\n\t\t#endif\n\n\t\tfloat SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {\n\t\t\t// Not required if searchTex accesses are set to point:\n\t\t\t// float2 SEARCH_TEX_PIXEL_SIZE = 1.0 / float2(66.0, 33.0);\n\t\t\t// e = float2(bias, 0.0) + 0.5 * SEARCH_TEX_PIXEL_SIZE +\n\t\t\t//     e * float2(scale, 1.0) * float2(64.0, 32.0) * SEARCH_TEX_PIXEL_SIZE;\n\t\t\te.r = bias + e.r * scale;\n\t\t\treturn 255.0 * texture2D( searchTex, e, 0.0 ).r;\n\t\t}\n\n\t\tfloat SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\t\t\t/**\n\t\t\t\t* @PSEUDO_GATHER4\n\t\t\t\t* This texcoord has been offset by (-0.25, -0.125) in the vertex shader to\n\t\t\t\t* sample between edge, thus fetching four edges in a row.\n\t\t\t\t* Sampling with different offsets in each direction allows to disambiguate\n\t\t\t\t* which edges are active from the four fetched ones.\n\t\t\t\t*/\n\t\t\tvec2 e = vec2( 0.0, 1.0 );\n\n\t\t\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n\t\t\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\t\t\ttexcoord -= vec2( 2.0, 0.0 ) * resolution;\n\t\t\t\tif ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;\n\t\t\t}\n\n\t\t\t// We correct the previous (-0.25, -0.125) offset we applied:\n\t\t\ttexcoord.x += 0.25 * resolution.x;\n\n\t\t\t// The searches are bias by 1, so adjust the coords accordingly:\n\t\t\ttexcoord.x += resolution.x;\n\n\t\t\t// Disambiguate the length added by the last step:\n\t\t\ttexcoord.x += 2.0 * resolution.x; // Undo last step\n\t\t\ttexcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);\n\n\t\t\treturn texcoord.x;\n\t\t}\n\n\t\tfloat SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\t\t\tvec2 e = vec2( 0.0, 1.0 );\n\n\t\t\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n\t\t\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\t\t\ttexcoord += vec2( 2.0, 0.0 ) * resolution;\n\t\t\t\tif ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;\n\t\t\t}\n\n\t\t\ttexcoord.x -= 0.25 * resolution.x;\n\t\t\ttexcoord.x -= resolution.x;\n\t\t\ttexcoord.x -= 2.0 * resolution.x;\n\t\t\ttexcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );\n\n\t\t\treturn texcoord.x;\n\t\t}\n\n\t\tfloat SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\t\t\tvec2 e = vec2( 1.0, 0.0 );\n\n\t\t\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n\t\t\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\t\t\ttexcoord += vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign\n\t\t\t\tif ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;\n\t\t\t}\n\n\t\t\ttexcoord.y -= 0.25 * resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y -= resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y -= 2.0 * resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 ); // WebGL port note: Changed sign\n\n\t\t\treturn texcoord.y;\n\t\t}\n\n\t\tfloat SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\t\t\tvec2 e = vec2( 1.0, 0.0 );\n\n\t\t\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n\t\t\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\t\t\ttexcoord -= vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign\n\t\t\t\tif ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;\n\t\t\t}\n\n\t\t\ttexcoord.y += 0.25 * resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y += resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y += 2.0 * resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 ); // WebGL port note: Changed sign\n\n\t\t\treturn texcoord.y;\n\t\t}\n\n\t\tvec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {\n\t\t\t// Rounding prevents precision errors of bilinear filtering:\n\t\t\tvec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;\n\n\t\t\t// We do a scale and bias for mapping to texel space:\n\t\t\ttexcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );\n\n\t\t\t// Move to proper place, according to the subpixel offset:\n\t\t\ttexcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;\n\n\t\t\treturn texture2D( areaTex, texcoord, 0.0 ).rg;\n\t\t}\n\n\t\tvec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {\n\t\t\tvec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );\n\n\t\t\tvec2 e = texture2D( edgesTex, texcoord ).rg;\n\n\t\t\tif ( e.g > 0.0 ) { // Edge at north\n\t\t\t\tvec2 d;\n\n\t\t\t\t// Find the distance to the left:\n\t\t\t\tvec2 coords;\n\t\t\t\tcoords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );\n\t\t\t\tcoords.y = offset[ 1 ].y; // offset[1].y = texcoord.y - 0.25 * resolution.y (@CROSSING_OFFSET)\n\t\t\t\td.x = coords.x;\n\n\t\t\t\t// Now fetch the left crossing edges, two at a time using bilinear\n\t\t\t\t// filtering. Sampling at -0.25 (see @CROSSING_OFFSET) enables to\n\t\t\t\t// discern what value each edge has:\n\t\t\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).r;\n\n\t\t\t\t// Find the distance to the right:\n\t\t\t\tcoords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );\n\t\t\t\td.y = coords.x;\n\n\t\t\t\t// We want the distances to be in pixel units (doing this here allow to\n\t\t\t\t// better interleave arithmetic and memory accesses):\n\t\t\t\td = d / resolution.x - pixcoord.x;\n\n\t\t\t\t// SMAAArea below needs a sqrt, as the areas texture is compressed\n\t\t\t\t// quadratically:\n\t\t\t\tvec2 sqrt_d = sqrt( abs( d ) );\n\n\t\t\t\t// Fetch the right crossing edges:\n\t\t\t\tcoords.y -= 1.0 * resolution.y; // WebGL port note: Added\n\t\t\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;\n\n\t\t\t\t// Ok, we know how this pattern looks like, now it is time for getting\n\t\t\t\t// the actual area:\n\t\t\t\tweights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );\n\t\t\t}\n\n\t\t\tif ( e.r > 0.0 ) { // Edge at west\n\t\t\t\tvec2 d;\n\n\t\t\t\t// Find the distance to the top:\n\t\t\t\tvec2 coords;\n\n\t\t\t\tcoords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );\n\t\t\t\tcoords.x = offset[ 0 ].x; // offset[1].x = texcoord.x - 0.25 * resolution.x;\n\t\t\t\td.x = coords.y;\n\n\t\t\t\t// Fetch the top crossing edges:\n\t\t\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).g;\n\n\t\t\t\t// Find the distance to the bottom:\n\t\t\t\tcoords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );\n\t\t\t\td.y = coords.y;\n\n\t\t\t\t// We want the distances to be in pixel units:\n\t\t\t\td = d / resolution.y - pixcoord.y;\n\n\t\t\t\t// SMAAArea below needs a sqrt, as the areas texture is compressed\n\t\t\t\t// quadratically:\n\t\t\t\tvec2 sqrt_d = sqrt( abs( d ) );\n\n\t\t\t\t// Fetch the bottom crossing edges:\n\t\t\t\tcoords.y -= 1.0 * resolution.y; // WebGL port note: Added\n\t\t\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;\n\n\t\t\t\t// Get the area for this direction:\n\t\t\t\tweights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );\n\t\t\t}\n\n\t\t\treturn weights;\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );\n\n\t\t}"},vD={uniforms:{tDiffuse:{value:null},tColor:{value:null},resolution:{value:new fe(1/1024,1/512)}},vertexShader:"\n\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 2 ];\n\n\t\tvoid SMAANeighborhoodBlendingVS( vec2 texcoord ) {\n\t\t\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 ); // WebGL port note: Changed sign in W component\n\t\t\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tSMAANeighborhoodBlendingVS( vUv );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tColor;\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 2 ];\n\n\t\tvec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {\n\t\t\t// Fetch the blending weights for current pixel:\n\t\t\tvec4 a;\n\t\t\ta.xz = texture2D( blendTex, texcoord ).xz;\n\t\t\ta.y = texture2D( blendTex, offset[ 1 ].zw ).g;\n\t\t\ta.w = texture2D( blendTex, offset[ 1 ].xy ).a;\n\n\t\t\t// Is there any blending weight with a value greater than 0.0?\n\t\t\tif ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {\n\t\t\t\treturn texture2D( colorTex, texcoord, 0.0 );\n\t\t\t} else {\n\t\t\t\t// Up to 4 lines can be crossing a pixel (one through each edge). We\n\t\t\t\t// favor blending by choosing the line with the maximum weight for each\n\t\t\t\t// direction:\n\t\t\t\tvec2 offset;\n\t\t\t\toffset.x = a.a > a.b ? a.a : -a.b; // left vs. right\n\t\t\t\toffset.y = a.g > a.r ? -a.g : a.r; // top vs. bottom // WebGL port note: Changed signs\n\n\t\t\t\t// Then we go in the direction that has the maximum weight:\n\t\t\t\tif ( abs( offset.x ) > abs( offset.y )) { // horizontal vs. vertical\n\t\t\t\t\toffset.y = 0.0;\n\t\t\t\t} else {\n\t\t\t\t\toffset.x = 0.0;\n\t\t\t\t}\n\n\t\t\t\t// Fetch the opposite color and lerp by hand:\n\t\t\t\tvec4 C = texture2D( colorTex, texcoord, 0.0 );\n\t\t\t\ttexcoord += sign( offset ) * resolution;\n\t\t\t\tvec4 Cop = texture2D( colorTex, texcoord, 0.0 );\n\t\t\t\tfloat s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );\n\n\t\t\t\t// WebGL port note: Added gamma correction\n\t\t\t\tC.xyz = pow(C.xyz, vec3(2.2));\n\t\t\t\tCop.xyz = pow(Cop.xyz, vec3(2.2));\n\t\t\t\tvec4 mixed = mix(C, Cop, s);\n\t\t\t\tmixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));\n\n\t\t\t\treturn mixed;\n\t\t\t}\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );\n\n\t\t}"};class _0e extends wn{constructor(e,t){super(),this.edgesRT=new Gt(e,t,{depthBuffer:!1}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new Gt(e,t,{depthBuffer:!1}),this.weightsRT.texture.name="SMAAPass.weights";const n=this,r=new Image;r.src=this.getAreaTexture(),r.onload=function(){n.areaTexture.needsUpdate=!0},this.areaTexture=new An,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=r,this.areaTexture.minFilter=Ui,this.areaTexture.generateMipmaps=!1,this.areaTexture.flipY=!1;const s=new Image;s.src=this.getSearchTexture(),s.onload=function(){n.searchTexture.needsUpdate=!0},this.searchTexture=new An,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=s,this.searchTexture.magFilter=$t,this.searchTexture.minFilter=$t,this.searchTexture.generateMipmaps=!1,this.searchTexture.flipY=!1,this.uniformsEdges=gi.clone(Zw.uniforms),this.uniformsEdges.resolution.value.set(1/e,1/t),this.materialEdges=new Pt({defines:Object.assign({},Zw.defines),uniforms:this.uniformsEdges,vertexShader:Zw.vertexShader,fragmentShader:Zw.fragmentShader}),this.uniformsWeights=gi.clone(Kw.uniforms),this.uniformsWeights.resolution.value.set(1/e,1/t),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new Pt({defines:Object.assign({},Kw.defines),uniforms:this.uniformsWeights,vertexShader:Kw.vertexShader,fragmentShader:Kw.fragmentShader}),this.uniformsBlend=gi.clone(vD.uniforms),this.uniformsBlend.resolution.value.set(1/e,1/t),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new Pt({uniforms:this.uniformsBlend,vertexShader:vD.vertexShader,fragmentShader:vD.fragmentShader}),this.needsSwap=!1,this.fsQuad=new xr(null)}render(e,t,n){this.uniformsEdges.tDiffuse.value=n.texture,this.fsQuad.material=this.materialEdges,e.setRenderTarget(this.edgesRT),this.clear&&e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialWeights,e.setRenderTarget(this.weightsRT),this.clear&&e.clear(),this.fsQuad.render(e),this.uniformsBlend.tColor.value=n.texture,this.fsQuad.material=this.materialBlend,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}setSize(e,t){this.edgesRT.setSize(e,t),this.weightsRT.setSize(e,t),this.materialEdges.uniforms.resolution.value.set(1/e,1/t),this.materialWeights.uniforms.resolution.value.set(1/e,1/t),this.materialBlend.uniforms.resolution.value.set(1/e,1/t)}getAreaTexture(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAIAAACOVPcQAACBeklEQVR42u39W4xlWXrnh/3WWvuciIzMrKxrV8/0rWbY0+SQFKcb4owIkSIFCjY9AC1BT/LYBozRi+EX+cV+8IMsYAaCwRcBwjzMiw2jAWtgwC8WR5Q8mDFHZLNHTarZGrLJJllt1W2qKrsumZWZcTvn7L3W54e1vrXX3vuciLPPORFR1XE2EomorB0nVuz//r71re/y/1eMvb4Cb3N11xV/PP/2v4UBAwJG/7H8urx6/25/Gf8O5hypMQ0EEEQwAqLfoN/Z+97f/SW+/NvcgQk4sGBJK6H7N4PFVL+K+e0N11yNfkKvwUdwdlUAXPHHL38oa15f/i/46Ih6SuMSPmLAYAwyRKn7dfMGH97jaMFBYCJUgotIC2YAdu+LyW9vvubxAP8kAL8H/koAuOKP3+q6+xGnd5kdYCeECnGIJViwGJMAkQKfDvB3WZxjLKGh8VSCCzhwEWBpMc5/kBbjawT4HnwJfhr+pPBIu7uu+OOTo9vsmtQcniMBGkKFd4jDWMSCRUpLjJYNJkM+IRzQ+PQvIeAMTrBS2LEiaiR9b/5PuT6Ap/AcfAFO4Y3dA3DFH7/VS+M8k4baEAQfMI4QfbVDDGIRg7GKaIY52qAjTAgTvGBAPGIIghOCYAUrGFNgzA7Q3QhgCwfwAnwe5vDejgG44o/fbm1C5ZlYQvQDARPAIQGxCWBM+wWl37ZQESb4gImexGMDouhGLx1Cst0Saa4b4AqO4Hk4gxo+3DHAV/nx27p3JziPM2pVgoiia5MdEzCGULprIN7gEEeQ5IQxEBBBQnxhsDb5auGmAAYcHMA9eAAz8PBol8/xij9+C4Djlim4gJjWcwZBhCBgMIIYxGAVIkH3ZtcBuLdtRFMWsPGoY9rN+HoBji9VBYdwD2ZQg4cnO7OSq/z4rU5KKdwVbFAjNojCQzTlCLPFSxtamwh2jMUcEgg2Wm/6XgErIBhBckQtGN3CzbVacERgCnfgLswhnvqf7QyAq/z4rRZm1YglYE3affGITaZsdIe2FmMIpnOCap25I6jt2kCwCW0D1uAD9sZctNGXcQIHCkINDQgc78aCr+zjtw3BU/ijdpw3zhCwcaONwBvdeS2YZKkJNJsMPf2JKEvC28RXxxI0ASJyzQCjCEQrO4Q7sFArEzjZhaFc4cdv+/JFdKULM4px0DfUBI2hIsy06BqLhGTQEVdbfAIZXYMPesq6VoCHICzUyjwInO4Y411//LYLs6TDa9wvg2CC2rElgAnpTBziThxaL22MYhzfkghz6GAs2VHbbdM91VZu1MEEpupMMwKyVTb5ij9+u4VJG/5EgEMMmFF01cFai3isRbKbzb+YaU/MQbAm2XSMoUPAmvZzbuKYRIFApbtlrfFuUGd6vq2hXNnH78ZLh/iFhsQG3T4D1ib7k5CC6vY0DCbtrohgLEIClXiGtl10zc0CnEGIhhatLBva7NP58Tvw0qE8yWhARLQ8h4+AhQSP+I4F5xoU+VilGRJs6wnS7ruti/4KvAY/CfdgqjsMy4pf8fodQO8/gnuX3f/3xi3om1/h7THr+co3x93PP9+FBUfbNUjcjEmhcrkT+8K7ml7V10Jo05mpIEFy1NmCJWx9SIKKt+EjAL4Ez8EBVOB6havuT/rByPvHXK+9zUcfcbb254+9fydJknYnRr1oGfdaiAgpxu1Rx/Rek8KISftx3L+DfsLWAANn8Hvw0/AFeAGO9DFV3c6D+CcWbL8Dj9e7f+T1k8AZv/d7+PXWM/Z+VvdCrIvuAKO09RpEEQJM0Ci6+B4xhTWr4cZNOvhktabw0ta0rSJmqz3Yw5/AKXwenod7cAhTmBSPKf6JBdvH8IP17h95pXqw50/+BFnj88fev4NchyaK47OPhhtI8RFSvAfDSNh0Ck0p2gLxGkib5NJj/JWCr90EWQJvwBzO4AHcgztwAFN1evHPUVGwfXON+0debT1YeGON9Yy9/63X+OguiwmhIhQhD7l4sMqlG3D86Suc3qWZ4rWjI1X7u0Ytw6x3rIMeIOPDprfe2XzNgyj6PahhBjO4C3e6puDgXrdg+/5l948vF3bqwZetZ+z9Rx9zdIY5pInPK4Nk0t+l52xdK2B45Qd87nM8fsD5EfUhIcJcERw4RdqqH7Yde5V7m1vhNmtedkz6EDzUMF/2jJYWbC+4fzzA/Y+/8PPH3j9dcBAPIRP8JLXd5BpAu03aziOL3VVHZzz3CXWDPWd+SH2AnxIqQoTZpo9Ckc6HIrFbAbzNmlcg8Ag8NFDDAhbJvTBZXbC94P7t68EXfv6o+21gUtPETU7bbkLxvNKRFG2+KXzvtObonPP4rBvsgmaKj404DlshFole1Glfh02fE7bYR7dZ82oTewIBGn1Md6CG6YUF26X376oevOLzx95vhUmgblI6LBZwTCDY7vMq0op5WVXgsObOXJ+1x3qaBl9j1FeLxbhU9w1F+Wiba6s1X/TBz1LnUfuYDi4r2C69f1f14BWfP+p+W2GFKuC9phcELMYRRLur9DEZTUdEH+iEqWdaM7X4WOoPGI+ZYD2+wcQ+y+ioHUZ9dTDbArzxmi/bJI9BND0Ynd6lBdve/butBw8+f/T9D3ABa3AG8W3VPX4hBin+bj8dMMmSpp5pg7fJ6xrBFE2WQQEWnV8Qg3FbAWzYfM1rREEnmvkN2o1+acG2d/9u68GDzx91v3mAjb1zkpqT21OipPKO0b9TO5W0nTdOmAQm0TObts3aBKgwARtoPDiCT0gHgwnbArzxmtcLc08HgF1asN0C4Ms/fvD5I+7PhfqyXE/b7RbbrGyRQRT9ARZcwAUmgdoz0ehJ9Fn7QAhUjhDAQSw0bV3T3WbNa59jzmiP6GsWbGXDX2ytjy8+f9T97fiBPq9YeLdBmyuizZHaqXITnXiMUEEVcJ7K4j3BFPurtB4bixW8wTpweL8DC95szWMOqucFYGsWbGU7p3TxxxefP+r+oTVktxY0v5hbq3KiOKYnY8ddJVSBxuMMVffNbxwIOERShst73HZ78DZrHpmJmH3K6sGz0fe3UUj0eyRrSCGTTc+rjVNoGzNSv05srAxUBh8IhqChiQgVNIIBH3AVPnrsnXQZbLTm8ammv8eVXn/vWpaTem5IXRlt+U/LA21zhSb9cye6jcOfCnOwhIAYXAMVTUNV0QhVha9xjgA27ODJbLbmitt3tRN80lqG6N/khgot4ZVlOyO4WNg3OIMzhIZQpUEHieg2im6F91hB3I2tubql6BYNN9Hj5S7G0G2tahslBWKDnOiIvuAEDzakDQKDNFQT6gbn8E2y4BBubM230YIpBnDbMa+y3dx0n1S0BtuG62lCCXwcY0F72T1VRR3t2ONcsmDjbmzNt9RFs2LO2hQNyb022JisaI8rAWuw4HI3FuAIhZdOGIcdjLJvvObqlpqvWTJnnQbyi/1M9O8UxWhBs//H42I0q1Yb/XPGONzcmm+ri172mHKvZBpHkJaNJz6v9jxqiklDj3U4CA2ugpAaYMWqNXsdXbmJNd9egCnJEsphXNM+MnK3m0FCJ5S1kmJpa3DgPVbnQnPGWIDspW9ozbcO4K/9LkfaQO2KHuqlfFXSbdNzcEcwoqNEFE9zcIXu9/6n/ym/BC/C3aJLzEKPuYVlbFnfhZ8kcWxV3dbv4bKl28566wD+8C53aw49lTABp9PWbsB+knfc/Li3eVizf5vv/xmvnPKg5ihwKEwlrcHqucuVcVOxEv8aH37E3ZqpZypUulrHEtIWKUr+txHg+ojZDGlwnqmkGlzcVi1dLiNSJiHjfbRNOPwKpx9TVdTn3K05DBx4psIk4Ei8aCkJahRgffk4YnEXe07T4H2RR1u27E6wfQsBDofUgjFUFnwC2AiVtA+05J2zpiDK2Oa0c5fmAecN1iJzmpqFZxqYBCYhFTCsUNEmUnIcZ6aEA5rQVhEywG6w7HSW02XfOoBlQmjwulOFQAg66SvJblrTEX1YtJ3uG15T/BH1OfOQeuR8g/c0gdpT5fx2SKbs9EfHTKdM8A1GaJRHLVIwhcGyydZsbifAFVKl5EMKNU2Hryo+06BeTgqnxzYjThVySDikbtJPieco75lYfKAJOMEZBTjoITuWHXXZVhcUDIS2hpiXHV9Ku4u44bN5OYLDOkJo8w+xJSMbhBRHEdEs9JZUCkQrPMAvaHyLkxgkEHxiNkx/x2YB0mGsQ8EUWj/stW5YLhtS5SMu+/YBbNPDCkGTUybN8krRLBGPlZkVOA0j+a1+rkyQKWGaPHPLZOkJhioQYnVZ2hS3zVxMtgC46KuRwbJNd9nV2PHgb36F194ecf/Yeu2vAFe5nm/bRBFrnY4BauE8ERmZRFUn0k8hbftiVYSKMEme2dJCJSCGYAlNqh87bXOPdUkGy24P6d1ll21MBqqx48Fvv8ZHH8HZFY7j/uAq1xMJUFqCSUlJPmNbIiNsmwuMs/q9CMtsZsFO6SprzCS1Z7QL8xCQClEelpjTduDMsmWD8S1PT152BtvmIGvUeDA/yRn83u/x0/4qxoPHjx+PXY9pqX9bgMvh/Nz9kpP4pOe1/fYf3axUiMdHLlPpZCNjgtNFAhcHEDxTumNONhHrBduW+vOyY++70WWnPXj98eA4kOt/mj/5E05l9+O4o8ePx67HFqyC+qSSnyselqjZGaVK2TadbFLPWAQ4NBhHqDCCV7OTpo34AlSSylPtIdd2AJZlyzYQrDJ5lcWGNceD80CunPLGGzsfD+7wRb95NevJI5docQ3tgCyr5bGnyaPRlmwNsFELViOOx9loebGNq2moDOKpHLVP5al2cymWHbkfzGXL7kfRl44H9wZy33tvt+PB/Xnf93e+nh5ZlU18wCiRUa9m7kib9LYuOk+hudQNbxwm0AQqbfloimaB2lM5fChex+ylMwuTbfmXQtmWlenZljbdXTLuOxjI/fDDHY4Hjx8/Hrse0zXfPFxbUN1kKqSCCSk50m0Ajtx3ub9XHBKHXESb8iO6E+qGytF4nO0OG3SXzbJlhxBnKtKyl0NwybjvYCD30aMdjgePHz8eu56SVTBbgxJMliQ3Oauwg0QHxXE2Ez/EIReLdQj42Gzb4CLS0YJD9xUx7bsi0vJi5mUbW1QzL0h0PFk17rtiIPfJk52MB48fPx67npJJwyrBa2RCCQRTbGZSPCxTPOiND4G2pYyOQ4h4jINIJh5wFU1NFZt+IsZ59LSnDqBjZ2awbOku+yInunLcd8VA7rNnOxkPHj9+PGY9B0MWJJNozOJmlglvDMXDEozdhQWbgs/U6oBanGzLrdSNNnZFjOkmbi5bNt1lX7JLLhn3vXAg9/h4y/Hg8ePHI9dzQMEkWCgdRfYykYKnkP7D4rIujsujaKPBsB54vE2TS00ccvFY/Tth7JXeq1hz+qgVy04sAJawTsvOknHfCwdyT062HA8eP348Zj0vdoXF4pilKa2BROed+9fyw9rWRXeTFXESMOanvDZfJuJaSXouQdMdDJZtekZcLLvEeK04d8m474UDuaenW44Hjx8/Xns9YYqZpszGWB3AN/4VHw+k7WSFtJ3Qicuqb/NlVmgXWsxh570xg2UwxUw3WfO6B5nOuO8aA7lnZxuPB48fPx6znm1i4bsfcbaptF3zNT78eFPtwi1OaCNOqp1x3zUGcs/PN++AGD1+fMXrSVm2baTtPhPahbPhA71wIHd2bXzRa69nG+3CraTtPivahV/55tXWg8fyRY/9AdsY8VbSdp8V7cKrrgdfM//z6ILQFtJ2nxHtwmuoB4/kf74+gLeRtvvMaBdeSz34+vifx0YG20jbfTa0C6+tHrwe//NmOG0L8EbSdp8R7cLrrQe/996O+ai3ujQOskpTNULa7jOjXXj99eCd8lHvoFiwsbTdZ0a78PrrwTvlo966pLuRtB2fFe3Cm6oHP9kNH/W2FryxtN1nTLvwRurBO+Kj3pWXHidtx2dFu/Bm68Fb81HvykuPlrb7LGkX3mw9eGs+6h1Y8MbSdjegXcguQLjmevDpTQLMxtJ2N6NdyBZu9AbrwVvwUW+LbteULUpCdqm0HTelXbhNPe8G68Gb8lFvVfYfSNuxvrTdTWoXbozAzdaDZzfkorOj1oxVxlIMlpSIlpLrt8D4hrQL17z+c3h6hU/wv4Q/utps4+bm+6P/hIcf0JwQ5oQGPBL0eKPTYEXTW+eL/2DKn73J9BTXYANG57hz1cEMviVf/4tf5b/6C5pTQkMIWoAq7hTpOJjtAM4pxKu5vg5vXeUrtI09/Mo/5H+4z+Mp5xULh7cEm2QbRP2tFIKR7WM3fPf/jZ3SWCqLM2l4NxID5zB72HQXv3jj/8mLR5xXNA5v8EbFQEz7PpRfl1+MB/hlAN65qgDn3wTgH13hK7T59bmP+NIx1SHHU84nLOITt3iVz8mNO+lPrjGAnBFqmioNn1mTyk1ta47R6d4MrX7tjrnjYUpdUbv2rVr6YpVfsGG58AG8Ah9eyUN8CX4WfgV+G8LVWPDGb+Zd4cU584CtqSbMKxauxTg+dyn/LkVgA+IR8KHtejeFKRtTmLLpxN6mYVLjYxwXf5x2VofiZcp/lwKk4wGOpYDnoIZPdg/AAbwMfx0+ge9dgZvYjuqKe4HnGnykYo5TvJbG0Vj12JagRhwKa44H95ShkZa5RyLGGdfYvG7aw1TsF6iapPAS29mNS3NmsTQZCmgTzFwgL3upCTgtBTRwvGMAKrgLn4evwin8+afJRcff+8izUGUM63GOOuAs3tJkw7J4kyoNreqrpO6cYLQeFUd7TTpr5YOTLc9RUUogUOVJQ1GYJaFLAW0oTmKyYS46ZooP4S4EON3xQ5zC8/CX4CnM4c1PE8ApexpoYuzqlP3d4S3OJP8ZDK7cKWNaTlqmgDiiHwl1YsE41w1zT4iRTm3DBqxvOUsbMKKDa/EHxagtnta072ejc3DOIh5ojvh8l3tk1JF/AV6FU6jh3U8HwEazLgdCLYSQ+MYiAI2ltomkzttUb0gGHdSUUgsIYjTzLG3mObX4FBRaYtpDVNZrih9TgTeYOBxsEnN1gOCTM8Bsw/ieMc75w9kuAT6A+/AiHGvN/+Gn4KRkiuzpNNDYhDGFndWRpE6SVfm8U5bxnSgVV2jrg6JCKmneqey8VMFgq2+AM/i4L4RUbfSi27lNXZ7R7W9RTcq/q9fk4Xw3AMQd4I5ifAZz8FcVtm9SAom/dyN4lczJQW/kC42ZrHgcCoIf1oVMKkVItmMBi9cOeNHGLqOZk+QqQmrbc5YmYgxELUUN35z2iohstgfLIFmcMV7s4CFmI74L9+EFmGsi+tGnAOD4Yk9gIpo01Y4cA43BWGygMdr4YZekG3OBIUXXNukvJS8tqa06e+lSDCtnqqMFu6hWHXCF+WaYt64m9QBmNxi7Ioy7D+fa1yHw+FMAcPt7SysFLtoG4PXAk7JOA3aAxBRqUiAdU9Yp5lK3HLSRFtOim0sa8euEt08xvKjYjzeJ2GU7YawexrnKI9tmobInjFXCewpwriY9+RR4aaezFhMhGCppKwom0ChrgFlKzyPKkGlTW1YQrE9HJqu8hKGgMc6hVi5QRq0PZxNfrYNgE64utmRv6KKHRpxf6VDUaOvNP5jCEx5q185My/7RKz69UQu2im5k4/eownpxZxNLwiZ1AZTO2ZjWjkU9uaB2HFn6Q3u0JcsSx/qV9hTEApRzeBLDJQXxYmTnq7bdLa3+uqFrxLJ5w1TehnNHx5ECvCh2g2c3hHH5YsfdaSKddztfjQ6imKFGSyFwlLzxEGPp6r5IevVjk1AMx3wMqi1NxDVjLBiPs9tbsCkIY5we5/ML22zrCScFxnNtzsr9Wcc3CnD+pYO+4VXXiDE0oc/vQQ/fDK3oPESJMYXNmJa/DuloJZkcTpcYE8lIH8Dz8DJMiynNC86Mb2lNaaqP/+L7f2fcE/yP7/Lde8xfgSOdMxvOixZf/9p3+M4hT1+F+zApxg9XfUvYjc8qX2lfOOpK2gNRtB4flpFu9FTKCp2XJRgXnX6olp1zyYjTKJSkGmLE2NjUr1bxFM4AeAAHBUFIeSLqXR+NvH/M9fOnfHzOD2vCSyQJKzfgsCh+yi/Mmc35F2fUrw7miW33W9hBD1vpuUojFphIyvg7aTeoymDkIkeW3XLHmguMzbIAJejN6B5MDrhipE2y6SoFRO/AK/AcHHZHNIfiWrEe/C6cr3f/yOvrQKB+zMM55/GQdLDsR+ifr5Fiuu+/y+M78LzOE5dsNuXC3PYvYWd8NXvphLSkJIasrlD2/HOqQ+RjcRdjKTGWYhhVUm4yxlyiGPuMsZR7sMCHUBeTuNWA7if+ifXgc/hovftHXs/DV+Fvwe+f8shzMiMcweFgBly3//vwJfg5AN4450fn1Hd1Rm1aBLu22Dy3y3H2+OqMemkbGZ4jozcDjJf6596xOLpC0eMTHbKnxLxH27uZ/bMTGs2jOaMOY4m87CfQwF0dw53oa1k80JRuz/XgS+8fX3N9Af4qPIMfzKgCp4H5TDGe9GGeFPzSsZz80SlPTxXjgwJmC45njzgt2vbQ4b4OAdUK4/vWhO8d8v6EE8fMUsfakXbPpFJeLs2ubM/qdm/la3WP91uWhxXHjoWhyRUq2iJ/+5mA73zwIIo+LoZ/SgvIRjAd1IMvvn98PfgOvAJfhhm8scAKVWDuaRaK8aQ9f7vuPDH6Bj47ZXau7rqYJ66mTDwEDU6lLbCjCK0qTXyl5mnDoeNRxanj3FJbaksTk0faXxHxLrssgPkWB9LnA/MFleXcJozzjwsUvUG0X/QCve51qkMDXp9mtcyOy3rwBfdvVJK7D6/ACSzg3RoruIq5UDeESfEmVclDxnniU82vxMLtceD0hGZWzBNPMM/jSPne2OVatiTKUpY5vY7gc0LdUAWeWM5tH+O2I66AOWw9xT2BuyRVLGdoDHUsVRXOo/c+ZdRXvFfnxWyIV4upFLCl9eAL7h8Zv0QH8Ry8pA2cHzQpGesctVA37ZtklBTgHjyvdSeKY/RZw/kJMk0Y25cSNRWSigQtlULPTw+kzuJPeYEkXjQRpoGZobYsLF79pyd1dMRHInbgFTZqNLhDqiIsTNpoex2WLcy0/X6rHcdMMQvFSd5dWA++4P7xv89deACnmr36uGlL69bRCL6BSZsS6c0TU2TKK5gtWCzgAOOwQcurqk9j8whvziZSMLcq5hbuwBEsYjopUBkqw1yYBGpLA97SRElEmx5MCInBY5vgLk94iKqSWmhIGmkJ4Bi9m4L645J68LyY4wsFYBfUg5feP/6gWWm58IEmKQM89hq7KsZNaKtP5TxxrUZZVkNmMJtjbKrGxLNEbHPJxhqy7lAmbC32ZqeF6lTaknRWcYaFpfLUBh/rwaQycCCJmW15Kstv6jRHyJFry2C1ahkkIW0LO75s61+owxK1y3XqweX9m5YLM2DPFeOjn/iiqCKJ+yKXF8t5Yl/kNsqaSCryxPq5xWTFIaP8KSW0RYxqupaUf0RcTNSSdJZGcKYdYA6kdtrtmyBckfKXwqk0pHpUHlwWaffjNRBYFPUDWa8e3Lt/o0R0CdisKDM89cX0pvRHEfM8ca4t0s2Xx4kgo91MPQJ/0c9MQYq0co8MBh7bz1fio0UUHLR4aAIOvOmoYO6kwlEVODSSTliWtOtH6sPkrtctF9ZtJ9GIerBskvhdVS5cFNv9s1BU0AbdUgdK4FG+dRnjFmDTzniRMdZO1QhzMK355vigbdkpz9P6qjUGE5J2qAcXmwJ20cZUiAD0z+pGMx6xkzJkmEf40Hr4qZfVg2XzF9YOyoV5BjzVkUJngKf8lgNYwKECEHrCNDrWZzMlflS3yBhr/InyoUgBc/lKT4pxVrrC6g1YwcceK3BmNxZcAtz3j5EIpqguh9H6wc011YN75cKDLpFDxuwkrPQmUwW4KTbj9mZTwBwLq4aQMUZbHm1rylJ46dzR0dua2n3RYCWZsiHROeywyJGR7mXKlpryyCiouY56sFkBWEnkEB/raeh/Sw4162KeuAxMQpEkzy5alMY5wamMsWKKrtW2WpEWNnReZWONKWjrdsKZarpFjqCslq773PLmEhM448Pc3+FKr1+94vv/rfw4tEcu+lKTBe4kZSdijBrykwv9vbCMPcLQTygBjzVckSLPRVGslqdunwJ4oegtFOYb4SwxNgWLCmD7T9kVjTv5YDgpo0XBmN34Z/rEHp0sgyz7lngsrm4lvMm2Mr1zNOJYJ5cuxuQxwMGJq/TP5emlb8fsQBZviK4t8hFL+zbhtlpwaRSxQRWfeETjuauPsdGxsBVdO7nmP4xvzSoT29pRl7kGqz+k26B3Oy0YNV+SXbbQas1ctC/GarskRdFpKczVAF1ZXnLcpaMuzVe6lZ2g/1ndcvOVgRG3sdUAY1bKD6achijMPdMxV4muKVorSpiDHituH7rSTs7n/4y5DhRXo4FVBN4vO/zbAcxhENzGbHCzU/98Mcx5e7a31kWjw9FCe/zNeYyQjZsWb1uc7U33pN4Mji6hCLhivqfa9Ss6xLg031AgfesA/l99m9fgvnaF9JoE6bYKmkGNK3aPbHB96w3+DnxFm4hs0drLsk7U8kf/N/CvwQNtllna0rjq61sH8L80HAuvwH1tvBy2ChqWSCaYTaGN19sTvlfzFD6n+iKTbvtayfrfe9ueWh6GJFoxLdr7V72a5ZpvHcCPDzma0wTO4EgbLyedxstO81n57LYBOBzyfsOhUKsW1J1BB5vr/tz8RyqOFylQP9Tvst2JALsC5lsH8PyQ40DV4ANzYa4dedNiKNR1s+x2wwbR7q4/4cTxqEk4LWDebfisuo36JXLiWFjOtLrlNWh3K1rRS4xvHcDNlFnNmWBBAl5SWaL3oPOfnvbr5pdjVnEaeBJSYjuLEkyLLsWhKccadmOphZkOPgVdalj2QpSmfOsADhMWE2ZBu4+EEJI4wKTAuCoC4xwQbWXBltpxbjkXJtKxxabo9e7tyhlgb6gNlSbUpMh+l/FaqzVwewGu8BW1Zx7pTpQDJUjb8tsUTW6+GDXbMn3mLbXlXJiGdggxFAoUrtPS3wE4Nk02UZG2OOzlk7fRs7i95QCLo3E0jtrjnM7SR3uS1p4qtS2nJ5OwtQVHgOvArLBFijZUV9QtSl8dAY5d0E0hM0w3HS2DpIeB6m/A1+HfhJcGUq4sOxH+x3f5+VO+Ds9rYNI7zPXOYWPrtf8bYMx6fuOAX5jzNR0PdsuON+X1f7EERxMJJoU6GkTEWBvVolVlb5lh3tKCg6Wx1IbaMDdJ+9sUCc5KC46hKGCk3IVOS4TCqdBNfUs7Kd4iXf2RjnT/LLysJy3XDcHLh/vde3x8DoGvwgsa67vBk91G5Pe/HbOe7xwym0NXbtiuuDkGO2IJDh9oQvJ4cY4vdoqLDuoH9Zl2F/ofsekn8lkuhIlhQcffUtSjytFyp++p6NiE7Rqx/lodgKVoceEp/CP4FfjrquZaTtj2AvH5K/ywpn7M34K/SsoYDAdIN448I1/0/wveW289T1/lX5xBzc8N5IaHr0XMOQdHsIkDuJFifj20pBm5jzwUv9e2FhwRsvhAbalCIuIw3bhJihY3p6nTFFIZgiSYjfTf3aXuOjmeGn4bPoGvwl+CFzTRczBIuHBEeImHc37/lGfwZR0cXzVDOvaKfNHvwe+suZ771K/y/XcBlsoN996JpBhoE2toYxOznNEOS5TJc6Id5GEXLjrWo+LEWGNpPDU4WAwsIRROu+1vM+0oW37z/MBN9kqHnSArwPfgFJ7Cq/Ai3Ie7g7ncmI09v8sjzw9mzOAEXoIHxURueaAce5V80f/DOuuZwHM8vsMb5wBzOFWM7wymTXPAEvm4vcFpZ2ut0VZRjkiP2MlmLd6DIpbGSiHOjdnUHN90hRYmhTnmvhzp1iKDNj+b7t5hi79lWGwQ+HN9RsfFMy0FXbEwhfuczKgCbyxYwBmcFhhvo/7a44v+i3XWcwDP86PzpGQYdWh7csP5dBvZ1jNzdxC8pBGuxqSW5vw40nBpj5JhMwvOzN0RWqERHMr4Lv1kWX84xLR830G3j6yqZ1a8UstTlW+qJPOZ+sZ7xZPKTJLhiNOAFd6tk+jrTH31ncLOxid8+nzRb128HhUcru/y0Wn6iT254YPC6FtVSIMoW2sk727AhvTtrWKZTvgsmckfXYZWeNRXx/3YQ2OUxLDrbHtN11IwrgXT6c8dATDwLniYwxzO4RzuQqTKSC5gAofMZ1QBK3zQ4JWobFbcvJm87FK+6JXrKahLn54m3p+McXzzYtP8VF/QpJuh1OwieElEoI1pRxPS09FBrkq2tWCU59+HdhNtTIqKm8EBrw2RTOEDpG3IKo2Y7mFdLm3ZeVjYwVw11o/oznceMve4CgMfNym/utA/d/ILMR7gpXzRy9eDsgLcgbs8O2Va1L0zzIdwGGemTBuwROHeoMShkUc7P+ISY3KH5ZZeWqO8mFTxQYeXTNuzvvK5FGPdQfuu00DwYFY9dyhctEt+OJDdnucfpmyhzUJzfsJjr29l8S0bXBfwRS9ZT26tmMIdZucch5ZboMz3Nio3nIOsYHCGoDT4kUA9MiXEp9Xsui1S8th/kbWIrMBxDGLodWUQIWcvnXy+9M23xPiSMOiRPqM+YMXkUN3gXFrZJwXGzUaMpJfyRS9ZT0lPe8TpScuRlbMHeUmlaKDoNuy62iWNTWNFYjoxFzuJs8oR+RhRx7O4SVNSXpa0ZJQ0K1LAHDQ+D9IepkMXpcsq5EVCvClBUIzDhDoyKwDw1Lc59GbTeORivugw1IcuaEOaGWdNm+Ps5fQ7/tm0DjMegq3yM3vb5j12qUId5UZD2oxDSEWOZMSqFl/W+5oynWDa/aI04tJRQ2eTXusg86SQVu/nwSYwpW6wLjlqIzwLuxGIvoAvul0PS+ZNz0/akp/pniO/8JDnGyaCkzbhl6YcqmK/69prxPqtpx2+Km9al9sjL+rwMgHw4jE/C8/HQ3m1vBuL1fldbzd8mOueVJ92syqdEY4KJjSCde3mcRw2TA6szxedn+zwhZMps0XrqEsiUjnC1hw0TELC2Ek7uAAdzcheXv1BYLagspxpzSAoZZUsIzIq35MnFQ9DOrlNB30jq3L4pkhccKUAA8/ocvN1Rzx9QyOtERs4CVsJRK/DF71kPYrxYsGsm6RMh4cps5g1DOmM54Ly1ii0Hd3Y/BMk8VWFgBVmhqrkJCPBHAolwZaWzLR9Vb7bcWdX9NyUYE+uB2BKfuaeBUcjDljbYVY4DdtsVWvzRZdWnyUzDpjNl1Du3aloAjVJTNDpcIOVVhrHFF66lLfJL1zJr9PQ2nFJSBaKoDe+sAvLufZVHVzYh7W0h/c6AAZ+7Tvj6q9j68G/cTCS/3n1vLKHZwNi+P+pS0WkZNMBMUl+LDLuiE4omZy71r3UFMwNJV+VJ/GC5ixVUkBStsT4gGKh0Gm4Oy3qvq7Lbmq24nPdDuDR9deR11XzP4vFu3TYzfnIyiSVmgizUYGqkIXNdKTY9pgb9D2Ix5t0+NHkVzCdU03suWkkVZAoCONCn0T35gAeW38de43mf97sMOpSvj4aa1KYUm58USI7Wxxes03bAZdRzk6UtbzMaCQ6IxO0dy7X+XsjoD16hpsBeGz9dfzHj+R/Hp8nCxZRqkEDTaCKCSywjiaoMJ1TITE9eg7Jqnq8HL6gDwiZb0u0V0Rr/rmvqjxKuaLCX7ZWXTvAY+uvm3z8CP7nzVpngqrJpZKwWnCUjIviYVlirlGOzPLI3SMVyp/elvBUjjDkNhrtufFFErQ8pmdSlbK16toBHlt/HV8uHMX/vEGALkV3RJREiSlopxwdMXOZPLZ+ix+kAHpMKIk8UtE1ygtquttwxNhphrIZ1IBzjGF3IIGxGcBj6q8bHJBG8T9vdsoWrTFEuebEZuVxhhClH6P5Zo89OG9fwHNjtNQTpD0TG9PJLEYqvEY6Rlxy+ZZGfL0Aj62/bnQCXp//eeM4KzfQVJbgMQbUjlMFIm6TpcfWlZje7NBSV6IsEVmumWIbjiloUzQX9OzYdo8L1wjw2PrrpimONfmfNyzKklrgnEkSzT5QWYQW40YShyzqsRmMXbvVxKtGuYyMKaU1ugenLDm5Ily4iT14fP11Mx+xJv+zZ3MvnfdFqxU3a1W/FTB4m3Qfsyc1XUcdVhDeUDZXSFHHLQj/Y5jtC7ZqM0CXGwB4bP11i3LhOvzPGygYtiUBiwQV/4wFO0majijGsafHyRLu0yG6q35cL1rOpVxr2s5cM2jJYMCdc10Aj6q/blRpWJ//+dmm5psMl0KA2+AFRx9jMe2WbC4jQxnikd4DU8TwUjRVacgdlhmr3bpddzuJ9zXqr2xnxJfzP29RexdtjDVZqzkqa6PyvcojGrfkXiJ8SEtml/nYskicv0ivlxbqjemwUjMw5evdg8fUX9nOiC/lf94Q2i7MURk9nW1MSj5j8eAyV6y5CN2S6qbnw3vdA1Iwq+XOSCl663udN3IzLnrt+us25cI1+Z83SXQUldqQq0b5XOT17bGpLd6ssN1VMPf8c+jG8L3NeCnMdF+Ra3fRa9dft39/LuZ/3vwHoHrqGmQFafmiQw6eyzMxS05K4bL9uA+SKUQzCnSDkqOGokXyJvbgJ/BHI+qvY69//4rl20NsmK2ou2dTsyIALv/91/8n3P2Aao71WFGi8KKv1fRC5+J67Q/507/E/SOshqN5TsmYIjVt+kcjAx98iz/4SaojbIV1rexE7/C29HcYD/DX4a0rBOF5VTu7omsb11L/AWcVlcVZHSsqGuXLLp9ha8I//w3Mv+T4Ew7nTBsmgapoCrNFObIcN4pf/Ob/mrvHTGqqgAupL8qWjWPS9m/31jAe4DjA+4+uCoQoT/zOzlrNd3qd4SdphFxsUvYwGWbTWtISc3wNOWH+kHBMfc6kpmpwPgHWwqaSUG2ZWWheYOGQGaHB+eQ/kn6b3pOgLV+ODSn94wDvr8Bvb70/LLuiPPEr8OGVWfDmr45PZyccEmsVXZGe1pRNX9SU5+AVQkNTIVPCHF/jGmyDC9j4R9LfWcQvfiETmgMMUCMN1uNCakkweZsowdYobiMSlnKA93u7NzTXlSfe+SVbfnPQXmg9LpYAQxpwEtONyEyaueWM4FPjjyjG3uOaFmBTWDNgBXGEiQpsaWhnAqIijB07Dlsy3fUGeP989xbWkyf+FF2SNEtT1E0f4DYYVlxFlbaSMPIRMk/3iMU5pME2SIWJvjckciebkQuIRRyhUvkHg/iUljG5kzVog5hV7vIlCuBrmlhvgPfNHQM8lCf+FEGsYbMIBC0qC9a0uuy2wLXVbLBaP5kjHokCRxapkQyzI4QEcwgYHRZBp+XEFTqXFuNVzMtjXLJgX4gAid24Hjwc4N3dtVSe+NNiwTrzH4WVUOlDobUqr1FuAgYllc8pmzoVrELRHSIW8ViPxNy4xwjBpyR55I6J220qQTZYR4guvUICJiSpr9gFFle4RcF/OMB7BRiX8sSfhpNSO3lvEZCQfLUVTKT78Ek1LRLhWN+yLyTnp8qWUZ46b6vxdRGXfHVqx3eI75YaLa4iNNiK4NOW7wPW6lhbSOF9/M9qw8e/aoB3d156qTzxp8pXx5BKAsYSTOIIiPkp68GmTq7sZtvyzBQaRLNxIZ+paozHWoLFeExIhRBrWitHCAHrCF7/thhD8JhYz84wg93QRV88wLuLY8zF8sQ36qF1J455bOlgnELfshKVxYOXKVuKx0jaj22sczTQqPqtV/XDgpswmGTWWMSDw3ssyUunLLrVPGjYRsH5ggHeHSWiV8kT33ycFSfMgkoOK8apCye0J6VW6GOYvffgU9RWsukEi2kUV2nl4dOYUzRik9p7bcA4ggdJ53LxKcEe17B1R8eqAd7dOepV8sTXf5lhejoL85hUdhDdknPtKHFhljOT+bdq0hxbm35p2nc8+Ja1Iw+tJykgp0EWuAAZYwMVwac5KzYMslhvgHdHRrxKnvhTYcfKsxTxtTETkjHO7rr3zjoV25lAQHrqpV7bTiy2aXMmUhTBnKS91jhtR3GEoF0oLnWhWNnYgtcc4N0FxlcgT7yz3TgNIKkscx9jtV1ZKpWW+Ub1tc1eOv5ucdgpx+FJy9pgbLE7xDyXb/f+hLHVGeitHOi6A7ybo3sF8sS7w7cgdk0nJaOn3hLj3uyD0Zp5pazFIUXUpuTTU18d1EPkDoX8SkmWTnVIozEdbTcZjoqxhNHf1JrSS/AcvHjZ/SMHhL/7i5z+POsTUh/8BvNfYMTA8n+yU/MlTZxSJDRStqvEuLQKWwDctMTQogUDyQRoTQG5Kc6oQRE1yV1jCA7ri7jdZyK0sYTRjCR0Hnnd+y7nHxNgTULqw+8wj0mQKxpYvhjm9uSUxg+TTy7s2GtLUGcywhXSKZN275GsqlclX90J6bRI1aouxmgL7Q0Nen5ziM80SqMIo8cSOo+8XplT/5DHNWsSUr/6lLN/QQ3rDyzLruEW5enpf7KqZoShEduuSFOV7DLX7Ye+GmXb6/hnNNqKsVXuMDFpb9Y9eH3C6NGEzuOuI3gpMH/I6e+zDiH1fXi15t3vA1czsLws0TGEtmPEJdiiFPwlwKbgLHAFk4P6ZyPdymYYHGE0dutsChQBl2JcBFlrEkY/N5bQeXQ18gjunuMfMfsBlxJSx3niO485fwO4fGD5T/+3fPQqkneWVdwnw/3bMPkW9Wbqg+iC765Zk+xcT98ibKZc2EdgHcLoF8cSOo/Oc8fS+OyEULF4g4sJqXVcmfMfsc7A8v1/yfGXmL9I6Fn5pRwZhsPv0TxFNlAfZCvG+Oohi82UC5f/2IsJo0cTOm9YrDoKhFPEUr/LBYTUNht9zelHXDqwfPCIw4owp3mOcIQcLttWXFe3VZ/j5H3cIc0G6oPbCR+6Y2xF2EC5cGUm6wKC5tGEzhsWqw5hNidUiKX5gFWE1GXh4/Qplw4sVzOmx9QxU78g3EF6wnZlEN4FzJ1QPSLEZz1KfXC7vd8ssGdIbNUYpVx4UapyFUHzJoTOo1McSkeNn1M5MDQfs4qQuhhX5vQZFw8suwWTcyYTgioISk2YdmkhehG4PkE7w51inyAGGaU+uCXADabGzJR1fn3lwkty0asIo8cROm9Vy1g0yDxxtPvHDAmpu+PKnM8Ix1wwsGw91YJqhteaWgjYBmmQiebmSpwKKzE19hx7jkzSWOm66oPbzZ8Yj6kxVSpYjVAuvLzYMCRo3oTQecOOjjgi3NQ4l9K5/hOGhNTdcWVOTrlgYNkEXINbpCkBRyqhp+LdRB3g0OU6rMfW2HPCFFMV9nSp+uB2woepdbLBuJQyaw/ZFysXrlXwHxI0b0LovEkiOpXGA1Ijagf+KUNC6rKNa9bQnLFqYNkEnMc1uJrg2u64ELPBHpkgWbmwKpJoDhMwNbbGzAp7Yg31wS2T5rGtzit59PrKhesWG550CZpHEzpv2NGRaxlNjbMqpmEIzygJqQfjypycs2pg2cS2RY9r8HUqkqdEgKTWtWTKoRvOBPDYBltja2SO0RGjy9UHtxwRjA11ujbKF+ti5cIR9eCnxUg6owidtyoU5tK4NLji5Q3HCtiyF2IqLGYsHViOXTXOYxucDqG0HyttqYAKqYo3KTY1ekyDXRAm2AWh9JmsVh/ccg9WJ2E8YjG201sPq5ULxxX8n3XLXuMInbft2mk80rRGjCGctJ8/GFdmEQ9Ug4FlE1ll1Y7jtiraqm5Fe04VV8lvSVBL8hiPrfFVd8+7QH3Qbu2ipTVi8cvSGivc9cj8yvH11YMHdNSERtuOslM97feYFOPKzGcsI4zW0YGAbTAOaxCnxdfiYUmVWslxiIblCeAYr9VYR1gM7GmoPrilunSxxeT3DN/2eBQ9H11+nk1adn6VK71+5+Jfct4/el10/7KBZfNryUunWSCPxPECk1rdOv1WVSrQmpC+Tl46YD3ikQYcpunSQgzVB2VHFhxHVGKDgMEY5GLlQnP7FMDzw7IacAWnO6sBr12u+XanW2AO0wQ8pknnFhsL7KYIqhkEPmEXFkwaN5KQphbkUmG72wgw7WSm9RiL9QT925hkjiVIIhphFS9HKI6/8QAjlpXqg9W2C0apyaVDwKQwrwLY3j6ADR13ZyUNByQXHQu6RY09Hu6zMqXRaNZGS/KEJs0cJEe9VH1QdvBSJv9h09eiRmy0V2uJcqHcShcdvbSNg5fxkenkVprXM9rDVnX24/y9MVtncvbKY706anNl3ASll9a43UiacVquXGhvq4s2FP62NGKfQLIQYu9q1WmdMfmUrDGt8eDS0cXozH/fjmUH6Jruvm50hBDSaEU/2Ru2LEN/dl006TSc/g7tfJERxGMsgDUEr104pfWH9lQaN+M4KWQjwZbVc2rZVNHsyHal23wZtIs2JJqtIc/WLXXRFCpJkfE9jvWlfFbsNQ9pP5ZBS0zKh4R0aMFj1IjTcTnvi0Zz2rt7NdvQb2mgbju1plsH8MmbnEk7KbK0b+wC2iy3aX3szW8xeZvDwET6hWZYwqTXSSG+wMETKum0Dq/q+x62gt2ua2ppAo309TRk9TPazfV3qL9H8z7uhGqGqxNVg/FKx0HBl9OVUORn8Q8Jx9gFttGQUDr3tzcXX9xGgN0EpzN9mdZ3GATtPhL+CjxFDmkeEU6x56kqZRusLzALXVqkCN7zMEcqwjmywDQ6OhyUe0Xao1Qpyncrg6wKp9XfWDsaZplElvQ/b3sdweeghorwBDlHzgk1JmMc/wiERICVy2VJFdMjFuLQSp3S0W3+sngt2njwNgLssFGVQdJ0tu0KH4ky1LW4yrbkuaA6Iy9oz/qEMMXMMDWyIHhsAyFZc2peV9hc7kiKvfULxCl9iddfRK1f8kk9qvbdOoBtOg7ZkOZ5MsGrSHsokgLXUp9y88smniwWyuFSIRVmjplga3yD8Uij5QS1ZiM4U3Qw5QlSm2bXjFe6jzzBFtpg+/YBbLAWG7OPynNjlCw65fukGNdkJRf7yM1fOxVzbxOJVocFoYIaGwH22mIQkrvu1E2nGuebxIgW9U9TSiukPGU+Lt++c3DJPKhyhEEbXCQLUpae2exiKy6tMPe9mDRBFCEMTWrtwxN8qvuGnt6MoihKWS5NSyBhbH8StXoAz8PLOrRgLtOT/+4vcu+7vDLnqNvztOq7fmd8sMmY9Xzn1zj8Dq8+XVdu2Nv0IIySgEdQo3xVHps3Q5i3fLFsV4aiqzAiBhbgMDEd1uh8qZZ+lwhjkgokkOIv4xNJmyncdfUUzgB4oFMBtiu71Xumpz/P+cfUP+SlwFExwWW62r7b+LSPxqxn/gvMZ5z9C16t15UbNlq+jbGJtco7p8wbYlL4alSyfWdeuu0j7JA3JFNuVAwtst7F7FhWBbPFNKIUORndWtLraFLmMu7KFVDDOzqkeaiN33YAW/r76wR4XDN/yN1z7hejPau06EddkS/6XThfcz1fI/4K736fO48vlxt2PXJYFaeUkFS8U15XE3428xdtn2kc8GQlf1vkIaNRRnOMvLTWrZbElEHeLWi1o0dlKPAh1MVgbbVquPJ5+Cr8LU5/H/+I2QlHIU2ClXM9G8v7Rr7oc/hozfUUgsPnb3D+I+7WF8kNO92GY0SNvuxiE+2Bt8prVJTkzE64sfOstxuwfxUUoyk8VjcTlsqe2qITSFoSj6Epd4KsT6BZOWmtgE3hBfir8IzZDwgV4ZTZvD8VvPHERo8v+vL1DASHTz/i9OlKueHDjK5Rnx/JB1Vb1ioXdBra16dmt7dgik10yA/FwJSVY6XjA3oy4SqM2frqDPPSRMex9qs3XQtoWxMj7/Er8GWYsXgjaVz4OYumP2+9kbxvny/6kvWsEBw+fcb5bInc8APdhpOSs01tEqIkoiZjbAqKMruLbJYddHuHFRIyJcbdEdbl2sVLaySygunutBg96Y2/JjKRCdyHV+AEFtTvIpbKIXOamknYSiB6KV/0JetZITgcjjk5ZdaskBtWO86UF0ap6ozGXJk2WNiRUlCPFir66lzdm/SLSuK7EUdPz8f1z29Skq6F1fXg8+5UVR6bszncP4Tn4KUkkdJ8UFCY1zR1i8RmL/qQL3rlei4THG7OODlnKko4oI01kd3CaM08Ia18kC3GNoVaO9iDh+hWxSyTXFABXoau7Q6q9OxYg/OVEMw6jdbtSrJ9cBcewGmaZmg+bvkUnUUaGr+ZfnMH45Ivevl61hMcXsxYLFTu1hTm2zViCp7u0o5l+2PSUh9bDj6FgYypufBDhqK2+oXkiuHFHR3zfj+9PtA8oR0xnqX8qn+sx3bFODSbbF0X8EUvWQ8jBIcjo5bRmLOljDNtcqNtOe756h3l0VhKa9hDd2l1eqmsnh0MNMT/Cqnx6BInumhLT8luljzQ53RiJeA/0dxe5NK0o2fA1+GLXr6eNQWHNUOJssQaTRlGpLHKL9fD+IrQzTOMZS9fNQD4AnRNVxvTdjC+fJdcDDWQcyB00B0t9BDwTxXgaAfzDZ/DBXzRnfWMFRwuNqocOmX6OKNkY63h5n/fFcB28McVHqnXZVI27K0i4rDLNE9lDKV/rT+udVbD8dFFu2GGZ8mOt0kAXcoX3ZkIWVtw+MNf5NjR2FbivROHmhV1/pj2egv/fMGIOWTIWrV3Av8N9imV9IWml36H6cUjqEWNv9aNc+veb2sH46PRaHSuMBxvtW+twxctq0z+QsHhux8Q7rCY4Ct8lqsx7c6Sy0dl5T89rIeEuZKoVctIk1hNpfavER6yyH1Vvm3MbsUHy4ab4hWr/OZPcsRBphnaV65/ZcdYPNNwsjN/djlf9NqCw9U5ExCPcdhKxUgLSmfROpLp4WSUr8ojdwbncbvCf+a/YzRaEc6QOvXcGO256TXc5Lab9POvB+AWY7PigWYjzhifbovuunzRawsO24ZqQQAqguBtmpmPB7ysXJfyDDaV/aPGillgz1MdQg4u5MYaEtBNNHFjkRlSpd65lp4hd2AVPTfbV7FGpyIOfmNc/XVsPfg7vzaS/3nkvLL593ANLvMuRMGpQIhiF7kUEW9QDpAUbTWYBcbp4WpacHHY1aacqQyjGZS9HI3yCBT9kUZJhVOD+zUDvEH9ddR11fzPcTDQ5TlgB0KwqdXSavk9BC0pKp0WmcuowSw07VXmXC5guzSa4p0UvRw2lbDiYUx0ExJJRzWzi6Gm8cnEkfXXsdcG/M/jAJa0+bmCgdmQ9CYlNlSYZOKixmRsgiFxkrmW4l3KdFKv1DM8tk6WxPYJZhUUzcd8Kdtgrw/gkfXXDT7+avmfVak32qhtkg6NVdUS5wgkru1YzIkSduTW1FDwVWV3JQVJVuieTc0y4iDpFwc7/BvSalvKdQM8sv662cevz/+8sQVnjVAT0W2wLllw1JiMhJRxgDjCjLQsOzSFSgZqx7lAW1JW0e03yAD3asC+GD3NbQhbe+mN5GXH1F83KDOM4n/e5JIuH4NpdQARrFPBVptUNcjj4cVMcFSRTE2NpR1LEYbYMmfWpXgP9KejaPsLUhuvLCsVXznAG9dfx9SR1ud/3hZdCLHb1GMdPqRJgqDmm76mHbvOXDtiO2QPUcKo/TWkQ0i2JFXpBoo7vij1i1Lp3ADAo+qvG3V0rM//vFnnTE4hxd5Ka/Cor5YEdsLVJyKtDgVoHgtW11pWSjolPNMnrlrVj9Fv2Qn60twMwKPqr+N/wvr8z5tZcDsDrv06tkqyzESM85Ycv6XBWA2birlNCXrI6VbD2lx2L0vQO0QVTVVLH4SE67fgsfVXv8n7sz7/85Z7cMtbE6f088wSaR4kCkCm10s6pKbJhfqiUNGLq+0gLWC6eUAZFPnLjwqtKd8EwGvWX59t7iPW4X/eAN1svgRVSY990YZg06BD1ohLMtyFTI4pKTJsS9xREq9EOaPWiO2gpms7397x6nQJkbh+Fz2q/rqRROX6/M8bJrqlVW4l6JEptKeUFuMYUbtCQ7CIttpGc6MY93x1r1vgAnRXvY5cvwWPqb9uWQm+lP95QxdNMeWhOq1x0Db55C7GcUv2ZUuN6n8iKzsvOxibC//Yfs9Na8r2Rlz02vXXDT57FP/zJi66/EJSmsJKa8QxnoqW3VLQ+jZVUtJwJ8PNX1NQCwfNgdhhHD9on7PdRdrdGPF28rJr1F+3LBdeyv+8yYfLoMYet1vX4upNAjVvwOUWnlNXJXlkzk5Il6kqeoiL0C07qno+/CYBXq/+utlnsz7/Mzvy0tmI4zm4ag23PRN3t/CWryoUVJGm+5+K8RJ0V8Hc88/XHUX/HfiAq7t+BH+x6v8t438enWmdJwFA6ZINriLGKv/95f8lT9/FnyA1NMVEvQyaXuu+gz36f/DD73E4pwqpLcvm/o0Vle78n//+L/NPvoefp1pTJye6e4A/D082FERa5/opeH9zpvh13cNm19/4v/LDe5xMWTi8I0Ta0qKlK27AS/v3/r+/x/2GO9K2c7kVMonDpq7//jc5PKCxeNPpFVzaRr01wF8C4Pu76hXuX18H4LduTr79guuFD3n5BHfI+ZRFhY8w29TYhbbLi/bvBdqKE4fUgg1pBKnV3FEaCWOWyA+m3WpORZr/j+9TKJtW8yBTF2/ZEODI9/QavHkVdGFp/Pjn4Q+u5hXapsP5sOH+OXXA1LiKuqJxiMNbhTkbdJTCy4llEt6NnqRT4dhg1V3nbdrm6dYMecA1yTOL4PWTE9L5VzPFlLBCvlG58AhehnN4uHsAYinyJ+AZ/NkVvELbfOBUuOO5syBIEtiqHU1k9XeISX5bsimrkUUhnGDxourN8SgUsCZVtKyGbyGzHXdjOhsAvOAswSRyIBddRdEZWP6GZhNK/yjwew9ehBo+3jEADu7Ay2n8mDc+TS7awUHg0OMzR0LABhqLD4hJEh/BEGyBdGlSJoXYXtr+3HS4ijzVpgi0paWXtdruGTknXBz+11qT1Q2inxaTzQCO46P3lfLpyS4fou2PH/PupwZgCxNhGlj4IvUuWEsTkqMWm6i4xCSMc9N1RDQoCVcuGItJ/MRWefais+3synowi/dESgJjkilnWnBTGvRWmaw8oR15257t7CHmCf8HOn7cwI8+NQBXMBEmAa8PMRemrNCEhLGEhDQKcGZWS319BX9PFBEwGTbRBhLbDcaV3drFcDqk5kCTd2JF1Wp0HraqBx8U0wwBTnbpCadwBA/gTH/CDrcCs93LV8E0YlmmcyQRQnjBa8JESmGUfIjK/7fkaDJpmD2QptFNVJU1bbtIAjjWQizepOKptRjbzR9Kag6xZmMLLjHOtcLT3Tx9o/0EcTT1XN3E45u24AiwEypDJXihKjQxjLprEwcmRKclaDNZCVqr/V8mYWyFADbusiY5hvgFoU2vio49RgJLn5OsReRFN6tabeetiiy0V7KFHT3HyZLx491u95sn4K1QQSPKM9hNT0wMVvAWbzDSVdrKw4zRjZMyJIHkfq1VAVCDl/bUhNKlGq0zGr05+YAceXVPCttVk0oqjVwMPt+BBefx4yPtGVkUsqY3CHDPiCM5ngupUwCdbkpd8kbPrCWHhkmtIKLEetF2499eS1jZlIPGYnlcPXeM2KD9vLS0bW3ktYNqUllpKLn5ZrsxlIzxvDu5eHxzGLctkZLEY4PgSOg2IUVVcUONzUDBEpRaMoXNmUc0tFZrTZquiLyKxrSm3DvIW9Fil+AkhXu5PhEPx9mUNwqypDvZWdKlhIJQY7vn2OsnmBeOWnYZ0m1iwbbw1U60by5om47iHRV6fOgzjMf/DAZrlP40Z7syxpLK0lJ0gqaAK1c2KQKu7tabTXkLFz0sCftuwX++MyNeNn68k5Buq23YQhUh0SNTJa1ioQ0p4nUG2y0XilF1JqODqdImloPS4Bp111DEWT0jJjVv95uX9BBV7eB3bUWcu0acSVM23YZdd8R8UbQUxJ9wdu3oMuhdt929ME+mh6JXJ8di2RxbTi6TbrDquqV4aUKR2iwT6aZbyOwEXN3DUsWr8Hn4EhwNyHuXHh7/pdaUjtR7vnDh/d8c9xD/s5f501eQ1+CuDiCvGhk1AN/4Tf74RfxPwD3toLarR0zNtsnPzmS64KIRk861dMWCU8ArasG9T9H0ZBpsDGnjtAOM2+/LuIb2iIUGXNgl5ZmKD/Tw8TlaAuihaFP5yrw18v4x1898zIdP+DDAX1bM3GAMvPgRP/cJn3zCW013nrhHkrITyvYuwOUkcHuKlRSW5C6rzIdY4ppnF7J8aAJbQepgbJYBjCY9usGXDKQxq7RZfh9eg5d1UHMVATRaD/4BHK93/1iAgYZ/+jqPn8Dn4UExmWrpa3+ZOK6MvM3bjwfzxNWA2dhs8+51XHSPJiaAhGSpWevEs5xHLXcEGFXYiCONySH3fPWq93JIsBiSWvWyc3CAN+EcXoT7rCSANloPPoa31rt/5PUA/gp8Q/jDD3hyrjzlR8VkanfOvB1XPubt17vzxAfdSVbD1pzAnfgyF3ycadOTOTXhpEUoLC1HZyNGW3dtmjeXgr2r56JNmRwdNNWaQVBddd6rh4MhviEB9EFRD/7RGvePvCbwAL4Mx/D6M541hHO4D3e7g6PafdcZVw689z7NGTwo5om7A8sPhccT6qKcl9NJl9aM/9kX+e59Hh1yPqGuCCZxuITcsmNaJ5F7d0q6J3H48TO1/+M57085q2icdu2U+W36Ldllz9Agiv4YGljoEN908EzvDOrBF98/vtJwCC/BF2AG75xxEmjmMIcjxbjoaxqOK3/4hPOZzhMPBpYPG44CM0dTVm1LjLtUWWVz1Bcf8tEx0zs8O2A2YVHRxKYOiy/aOVoAaMu0i7ubu43njjmd4ibMHU1sIDHaQNKrZND/FZYdk54oCXetjq7E7IVl9eAL7t+oHnwXXtLx44czzoRFHBztYVwtH1d+NOMkupZ5MTM+gUmq90X+Bh9zjRlmaQ+m7YMqUL/veemcecAtOJ0yq1JnVlN27di2E0+Klp1tAJ4KRw1eMI7aJjsO3R8kPSI3fUFXnIOfdQe86sIIVtWDL7h//Ok6vj8vwDk08NEcI8zz7OhBy+WwalzZeZ4+0XniRfst9pAJqQHDGLzVQ2pheZnnv1OWhwO43/AgcvAEXEVVpa4db9sGvNK8wjaENHkfFQ4Ci5i7dqnQlPoLQrHXZDvO3BIXZbJOBrOaEbML6sFL798I4FhKihjHMsPjBUZYCMFr6nvaArxqXPn4lCa+cHfSa2cP27g3Z3ziYTRrcbQNGLQmGF3F3cBdzzzX7AILx0IB9rbwn9kx2G1FW3Inic+ZLIsVvKR8Zwfj0l1fkqo8LWY1M3IX14OX3r9RKTIO+d9XzAI8qRPGPn/4NC2n6o4rN8XJ82TOIvuVA8zLKUHRFgBCetlDZlqR1gLKjS39xoE7Bt8UvA6BxuEDjU3tFsEijgA+615tmZkXKqiEENrh41iLDDZNq4pKTWR3LZfnos81LOuNa15cD956vLMsJd1rqYp51gDUQqMYm2XsxnUhD2jg1DM7SeuJxxgrmpfISSXVIJIS5qJJSvJPEQ49DQTVIbYWJ9QWa/E2+c/oPK1drmC7WSfJRNKBO5Yjvcp7Gc3dmmI/Xh1kDTEuiSnWqQf37h+fTMhGnDf6dsS8SQfQWlqqwXXGlc/PEZ/SC5mtzIV0nAshlQdM/LvUtYutrEZ/Y+EAFtq1k28zQhOwLr1AIeANzhF8t9qzTdZf2qRKO6MWE9ohBYwibbOmrFtNmg3mcS+tB28xv2uKd/agYCvOP+GkSc+0lr7RXzyufL7QbkUpjLjEWFLqOIkAGu2B0tNlO9Eau2W1qcOUvVRgKzypKIQZ5KI3q0MLzqTNRYqiZOqmtqloIRlmkBHVpHmRYV6/HixbO6UC47KOFJnoMrVyr7wYz+SlW6GUaghYbY1I6kkxA2W1fSJokUdSh2LQ1GAimRGm0MT+uu57H5l7QgOWxERpO9moLRPgTtquWCfFlGlIjQaRly9odmzMOWY+IBO5tB4sW/0+VWGUh32qYk79EidWKrjWuiLpiVNGFWFRJVktyeXWmbgBBzVl8anPuXyNJlBJOlKLTgAbi/EYHVHxWiDaVR06GnHQNpJcWcK2jJtiCfG2sEHLzuI66sGrMK47nPIInPnu799935aOK2cvmvubrE38ZzZjrELCmXM2hM7UcpXD2oC3+ECVp7xtIuxptJ0jUr3sBmBS47TVxlvJ1Sqb/E0uLdvLj0lLr29ypdd/eMX3f6lrxGlKwKQxEGvw0qHbkbwrF3uHKwVENbIV2wZ13kNEF6zD+x24aLNMfDTCbDPnEikZFyTNttxWBXDaBuM8KtI2rmaMdUY7cXcUPstqTGvBGSrFWIpNMfbdea990bvAOC1YX0qbc6smDS1mPxSJoW4fwEXvjMmhlijDRq6qale6aJEuFGoppYDoBELQzLBuh/mZNx7jkinv0EtnUp50lO9hbNK57lZaMAWuWR5Yo9/kYwcYI0t4gWM47Umnl3YmpeBPqSyNp3K7s2DSAS/39KRuEN2bS4xvowV3dFRMx/VFcp2Yp8w2nTO9hCXtHG1kF1L4KlrJr2wKfyq77R7MKpFKzWlY9UkhYxyHWW6nBWPaudvEAl3CGcNpSXPZ6R9BbBtIl6cHL3gIBi+42CYXqCx1gfGWe7Ap0h3luyXdt1MKy4YUT9xSF01G16YEdWsouW9mgDHd3veyA97H+Ya47ZmEbqMY72oPztCGvK0onL44AvgC49saZKkWRz4veWljE1FHjbRJaWv6ZKKtl875h4CziFCZhG5rx7tefsl0aRT1bMHZjm8dwL/6u7wCRysaQblQoG5yAQN5zpatMNY/+yf8z+GLcH/Qn0iX2W2oEfXP4GvwQHuIL9AYGnaO3zqAX6946nkgqZNnUhx43DIdQtMFeOPrgy/y3Yd85HlJWwjLFkU3kFwq28xPnuPhMWeS+tDLV9Otllq7pQCf3uXJDN9wFDiUTgefHaiYbdfi3b3u8+iY6TnzhgehI1LTe8lcd7s1wJSzKbahCRxKKztTLXstGAiu3a6rPuQs5pk9TWAan5f0BZmGf7Ylxzzk/A7PAs4QPPPAHeFQ2hbFHszlgZuKZsJcUmbDC40sEU403cEjczstOEypa+YxevL4QBC8oRYqWdK6b7sK25tfE+oDZgtOQ2Jg8T41HGcBE6fTWHn4JtHcu9S7uYgU5KSCkl/mcnq+5/YBXOEr6lCUCwOTOM1taOI8mSxx1NsCXBEmLKbMAg5MkwbLmpBaFOPrNSlO2HnLiEqW3tHEwd8AeiQLmn+2gxjC3k6AxREqvKcJbTEzlpLiw4rNZK6oJdidbMMGX9FULKr0AkW+2qDEPBNNm5QAt2Ik2nftNWHetubosHLo2nG4vQA7GkcVCgVCgaDixHqo9UUn1A6OshapaNR/LPRYFV8siT1cCtJE0k/3WtaNSuUZYKPnsVIW0xXWnMUxq5+En4Kvw/MqQmVXnAXj9Z+9zM98zM/Agy7F/qqj2Nh67b8HjFnPP3iBn/tkpdzwEJX/whIcQUXOaikeliCRGUk7tiwF0rItwMEhjkZ309hikFoRAmLTpEXWuHS6y+am/KB/fM50aLEhGnSMwkpxzOov4H0AvgovwJ1iGzDLtJn/9BU+fAINfwUe6FHSLhu83viV/+/HrOePX+STT2B9uWGbrMHHLldRBlhS/CJQmcRxJFqZica01XixAZsYiH1uolZxLrR/SgxVIJjkpQP4PE9sE59LKLr7kltSBogS5tyszzH8Fvw8/AS8rNOg0xUS9fIaHwb+6et8Q/gyvKRjf5OusOzGx8evA/BP4IP11uN/grca5O0lcsPLJ5YjwI4QkJBOHa0WdMZYGxPbh2W2nR9v3WxEWqgp/G3+6VZbRLSAAZ3BhdhAaUL33VUSw9yjEsvbaQ9u4A/gGXwZXoEHOuU1GSj2chf+Mo+f8IcfcAxfIKVmyunRbYQVnoevwgfw3TXXcw++xNuP4fhyueEUNttEduRVaDttddoP0eSxLe2LENk6itYxlrxBNBYrNNKSQmeaLcm9c8UsaB5WyO6675yyQIAWSDpBVoA/gxmcwEvwoDv0m58UE7gHn+fJOa8/Ywan8EKRfjsopF83eCglX/Sfr7OeaRoQfvt1CGvIDccH5BCvw1sWIzRGC/66t0VTcLZQZtm6PlAasbOJ9iwWtUo7biktTSIPxnR24jxP1ZKaqq+2RcXM9OrBAm/AAs7hDJ5bNmGb+KIfwCs8a3jnjBrOFeMjHSCdbKr+2uOLfnOd9eiA8Hvvwwq54VbP2OqwkB48Ytc4YEOiH2vTXqodabfWEOzso4qxdbqD5L6tbtNPECqbhnA708DZH4QOJUXqScmUlks7Ot6FBuZw3n2mEbaUX7kDzxHOOQk8nKWMzAzu6ZZ8sOFw4RK+6PcuXo9tB4SbMz58ApfKDXf3szjNIIbGpD5TKTRxGkEMLjLl+K3wlWXBsCUxIDU+jbOiysESqAy1MGUJpXgwbTWzNOVEziIXZrJ+VIztl1PUBxTSo0dwn2bOmfDRPD3TRTGlfbCJvO9KvuhL1hMHhB9wPuPRLGHcdOWG2xc0U+5bQtAJT0nRTewXL1pgk2+rZAdeWmz3jxAqfNQQdzTlbF8uJ5ecEIWvTkevAHpwz7w78QujlD/Lr491bD8/1vhM2yrUQRrWXNQY4fGilfctMWYjL72UL/qS9eiA8EmN88nbNdour+PBbbAjOjIa4iBhfFg6rxeKdEGcL6p3EWR1Qq2Qkhs2DrnkRnmN9tG2EAqmgPw6hoL7Oza7B+3SCrR9tRftko+Lsf2F/mkTndN2LmzuMcKTuj/mX2+4Va3ki16+nnJY+S7MefpkidxwnV+4wkXH8TKnX0tsYzYp29DOOoSW1nf7nTh2akYiWmcJOuTidSaqESrTYpwjJJNVGQr+rLI7WsqerHW6Kp/oM2pKuV7T1QY9gjqlZp41/WfKpl56FV/0kvXQFRyeQ83xaTu5E8p5dNP3dUF34ihyI3GSpeCsywSh22ZJdWto9winhqifb7VRvgktxp13vyjrS0EjvrRfZ62uyqddSWaWYlwTPAtJZ2oZ3j/Sgi/mi+6vpzesfAcWNA0n8xVyw90GVFGuZjTXEQy+6GfLGLMLL523f5E0OmxVjDoOuRiH91RKU+vtoCtH7TgmvBLvtFXWLW15H9GTdVw8ow4IlRLeHECN9ym1e9K0I+Cbnhgv4Yu+aD2HaQJ80XDqOzSGAV4+4yCqBxrsJAX6ZTIoX36QnvzhhzzMfFW2dZVLOJfo0zbce5OvwXMFaZ81mOnlTVXpDZsQNuoYWveketKb5+6JOOsgX+NTm7H49fUTlx+WLuWL7qxnOFh4BxpmJx0p2gDzA/BUARuS6phR+pUsY7MMboAHx5xNsSVfVZcYSwqCKrqon7zM+8ecCkeS4nm3rINuaWvVNnMRI1IRpxTqx8PZUZ0Br/UEduo3B3hNvmgZfs9gQPj8vIOxd2kndir3awvJ6BLvoUuOfFWNYB0LR1OQJoUySKb9IlOBx74q1+ADC2G6rOdmFdJcD8BkfualA+BdjOOzP9uUhGUEX/TwhZsUduwRr8wNuXKurCixLBgpQI0mDbJr9dIqUuV+92ngkJZ7xduCk2yZKbfWrH1VBiTg9VdzsgRjW3CVXCvAwDd+c1z9dWw9+B+8MJL/eY15ZQ/HqvTwVdsZn5WQsgRRnMaWaecu3jFvMBEmgg+FJFZsnSl0zjB9OqPYaBD7qmoVyImFvzi41usesV0julaAR9dfR15Xzv9sEruRDyk1nb+QaLU67T885GTls6YgcY+UiMa25M/pwGrbCfzkvR3e0jjtuaFtnwuagHTSb5y7boBH119HXhvwP487jJLsLJ4XnUkHX5sLbS61dpiAXRoZSCrFJ+EjpeU3puVfitngYNo6PJrAigKktmwjyQdZpfq30mmtulaAx9Zfx15Xzv+cyeuiBFUs9zq8Kq+XB9a4PVvph3GV4E3y8HENJrN55H1X2p8VyqSKwVusJDKzXOZzplWdzBUFK9e+B4+uv468xvI/b5xtSAkBHQaPvtqWzllVvEOxPbuiE6+j2pvjcKsbvI7txnRErgfH7LdXqjq0IokKzga14GzQ23SSbCQvO6r+Or7SMIr/efOkkqSdMnj9mBx2DRsiY29Uj6+qK9ZrssCKaptR6HKURdwUYeUWA2kPzVKQO8ku2nU3Anhs/XWkBx3F/7wJtCTTTIKftthue1ty9xvNYLY/zo5KSbIuKbXpbEdSyeRyYdAIwKY2neyoc3+k1XUaufYga3T9daMUx/r8z1s10ITknIO0kuoMt+TB8jK0lpayqqjsJ2qtXAYwBU932zinimgmd6mTRDnQfr88q36NAI+tv24E8Pr8zxtasBqx0+xHH9HhlrwsxxNUfKOHQaZBITNf0uccj8GXiVmXAuPEAKSdN/4GLHhs/XWj92dN/uetNuBMnVR+XWDc25JLjo5Mg5IZIq226tmCsip2zZliL213YrTlL2hcFjpCduyim3M7/eB16q/blQsv5X/esDRbtJeabLIosWy3ycavwLhtxdWzbMmHiBTiVjJo6lCLjXZsi7p9PEPnsq6X6wd4bP11i0rD5fzPm/0A6brrIsllenZs0lCJlU4abakR59enZKrKe3BZihbTxlyZ2zl1+g0wvgmA166/bhwDrcn/7Ddz0eWZuJvfSESug6NzZsox3Z04FIxz0mUjMwVOOVTq1CQ0AhdbBGVdjG/CgsfUX7esJl3K/7ytWHRv683praW/8iDOCqWLLhpljDY1ZpzK75QiaZoOTpLKl60auHS/97oBXrv+umU9+FL+5+NtLFgjqVLCdbmj7pY5zPCPLOHNCwXGOcLquOhi8CmCWvbcuO73XmMUPab+ug3A6/A/78Bwe0bcS2+tgHn4J5pyS2WbOck0F51Vq3LcjhLvZ67p1ABbaL2H67bg78BfjKi/jr3+T/ABV3ilLmNXTI2SpvxWBtt6/Z//D0z/FXaGbSBgylzlsEGp+5//xrd4/ae4d8DUUjlslfIYS3t06HZpvfQtvv0N7AHWqtjP2pW08QD/FLy//da38vo8PNlKHf5y37Dxdfe/oj4kVIgFq3koLReSR76W/bx//n9k8jonZxzWTANVwEniDsg87sOSd/z7//PvMp3jQiptGVWFX2caezzAXwfgtzYUvbr0iozs32c3Uge7varH+CNE6cvEYmzbPZ9hMaYDdjK4V2iecf6EcEbdUDVUARda2KzO/JtCuDbNQB/iTeL0EG1JSO1jbXS+nLxtPMDPw1fh5+EPrgSEKE/8Gry5A73ui87AmxwdatyMEBCPNOCSKUeRZ2P6Myb5MRvgCHmA9ywsMifU+AYXcB6Xa5GibUC5TSyerxyh0j6QgLVpdyhfArRTTLqQjwe4HOD9s92D4Ap54odXAPBWLAwB02igG5Kkc+piN4lvODIFGAZgT+EO4Si1s7fjSR7vcQETUkRm9O+MXyo9OYhfe4xt9STQ2pcZRLayCV90b4D3jR0DYAfyxJ+eywg2IL7NTMXna7S/RpQ63JhWEM8U41ZyQGjwsVS0QBrEKLu8xwZsbi4wLcCT+OGidPIOCe1PiSc9Qt+go+vYqB7cG+B9d8cAD+WJPz0Am2gxXgU9IneOqDpAAXOsOltVuMzpdakJXrdPCzXiNVUpCeOos5cxnpQT39G+XVLhs1osQVvJKPZyNq8HDwd4d7pNDuWJPxVX7MSzqUDU6gfadKiNlUFTzLeFHHDlzO4kpa7aiKhBPGKwOqxsBAmYkOIpipyXcQSPlRTf+Tii0U3EJGaZsDER2qoB3h2hu0qe+NNwUooYU8y5mILbJe6OuX+2FTKy7bieTDAemaQyQ0CPthljSWO+xmFDIYiESjM5xKd6Ik5lvLq5GrQ3aCMLvmCA9wowLuWJb9xF59hVVP6O0CrBi3ZjZSNOvRy+I6klNVRJYRBaEzdN+imiUXQ8iVF8fsp+W4JXw7WISW7fDh7lptWkCwZ4d7QTXyBPfJMYK7SijjFppGnlIVJBJBYj7eUwtiP1IBXGI1XCsjNpbjENVpSAJ2hq2LTywEly3hUYazt31J8w2+aiLx3g3fohXixPfOMYm6zCGs9LVo9MoW3MCJE7R5u/WsOIjrqBoHUO0bJE9vxBpbhsd3+Nb4/vtPCZ4oZYCitNeYuC/8UDvDvy0qvkiW/cgqNqRyzqSZa/s0mqNGjtKOoTm14zZpUauiQgVfqtQiZjq7Q27JNaSK5ExRcrGCXO1FJYh6jR6CFqK7bZdQZ4t8g0rSlPfP1RdBtqaa9diqtzJkQ9duSryi2brQXbxDwbRUpFMBHjRj8+Nt7GDKgvph9okW7LX47gu0SpGnnFQ1S1lYldOsC7hYteR574ZuKs7Ei1lBsfdz7IZoxzzCVmmVqaSySzQbBVAWDek+N4jh9E/4VqZrJjPwiv9BC1XcvOWgO8275CVyBPvAtTVlDJfZkaZGU7NpqBogAj/xEHkeAuJihWYCxGN6e8+9JtSegFXF1TrhhLGP1fak3pebgPz192/8gB4d/6WT7+GdYnpH7hH/DJzzFiYPn/vjW0SgNpTNuPIZoAEZv8tlGw4+RLxy+ZjnKa5NdFoC7UaW0aduoYse6+bXg1DLg6UfRYwmhGEjqPvF75U558SANrElK/+MdpXvmqBpaXOa/MTZaa1DOcSiLaw9j0NNNst3c+63c7EKTpkvKHzu6bPbP0RkuHAVcbRY8ijP46MIbQeeT1mhA+5PV/inyDdQipf8LTvMXbwvoDy7IruDNVZKTfV4CTSRUYdybUCnGU7KUTDxLgCknqUm5aAW6/1p6eMsOYsphLzsHrE0Y/P5bQedx1F/4yPHnMB3/IOoTU9+BL8PhtjuFKBpZXnYNJxTuv+2XqolKR2UQgHhS5novuxVySJhBNRF3SoKK1XZbbXjVwWNyOjlqWJjrWJIy+P5bQedyldNScP+HZ61xKSK3jyrz+NiHG1hcOLL/+P+PDF2gOkekKGiNWKgJ+8Z/x8Iv4DdQHzcpZyF4v19I27w9/yPGDFQvmEpKtqv/TLiWMfn4sofMm9eAH8Ao0zzh7h4sJqYtxZd5/D7hkYPneDzl5idlzNHcIB0jVlQ+8ULzw/nc5/ojzl2juE0apD7LRnJxe04dMz2iOCFNtGFpTuXA5AhcTRo8mdN4kz30nVjEC4YTZQy4gpC7GlTlrePKhGsKKgeXpCYeO0MAd/GH7yKQUlXPLOasOH3FnSphjHuDvEu4gB8g66oNbtr6eMbFIA4fIBJkgayoXriw2XEDQPJrQeROAlY6aeYOcMf+IVYTU3XFlZufMHinGywaW3YLpObVBAsbjF4QJMsVUSayjk4voPsHJOQfPWDhCgDnmDl6XIRerD24HsGtw86RMHOLvVSHrKBdeVE26gKB5NKHzaIwLOmrqBWJYZDLhASG16c0Tn+CdRhWDgWXnqRZUTnPIHuMJTfLVpkoYy5CzylHVTGZMTwkGAo2HBlkQplrJX6U+uF1wZz2uwS1SQ12IqWaPuO4baZaEFBdukksJmkcTOm+YJSvoqPFzxFA/YUhIvWxcmSdPWTWwbAKVp6rxTtPFUZfKIwpzm4IoMfaYQLWgmlG5FME2gdBgm+J7J+rtS/XBbaVLsR7bpPQnpMFlo2doWaVceHk9+MkyguZNCJ1He+kuHTWyQAzNM5YSUg/GlTk9ZunAsg1qELVOhUSAK0LABIJHLKbqaEbHZLL1VA3VgqoiOKXYiS+HRyaEKgsfIqX64HYWbLRXy/qWoylIV9gudL1OWBNgBgTNmxA6b4txDT4gi3Ri7xFSLxtXpmmYnzAcWDZgY8d503LFogz5sbonDgkKcxGsWsE1OI+rcQtlgBBCSOKD1mtqYpIU8cTvBmAT0yZe+zUzeY92fYjTtGipXLhuR0ePoHk0ofNWBX+lo8Z7pAZDk8mEw5L7dVyZZoE/pTewbI6SNbiAL5xeygW4xPRuLCGbhcO4RIeTMFYHEJkYyEO9HmJfXMDEj/LaH781wHHZEtqSQ/69UnGpzH7LKIAZEDSPJnTesJTUa+rwTepI9dLJEawYV+ZkRn9g+QirD8vF8Mq0jFQ29js6kCS3E1+jZIhgPNanHdHFqFvPJLHqFwQqbIA4jhDxcNsOCCQLDomaL/dr5lyJaJU6FxPFjO3JOh3kVMcROo8u+C+jo05GjMF3P3/FuDLn5x2M04xXULPwaS6hBYki+MrMdZJSgPHlcB7nCR5bJ9Kr5ACUn9jk5kivdd8tk95SOGrtqu9lr2IhK65ZtEl7ZKrp7DrqwZfRUSN1el7+7NJxZbywOC8neNKTch5vsTEMNsoCCqHBCqIPRjIPkm0BjvFODGtto99rCl+d3wmHkW0FPdpZtC7MMcVtGFQjJLX5bdQ2+x9ypdc313uj8xlsrfuLgWXz1cRhZvJYX0iNVBRcVcmCXZs6aEf3RQF2WI/TcCbKmGU3IOoDJGDdDub0+hYckt6PlGu2BcxmhbTdj/klhccLGJMcqRjMJP1jW2ETqLSWJ/29MAoORluJ+6LPffBZbi5gqi5h6catQpmOT7/OFf5UorRpLzCqcMltBLhwd1are3kztrSzXO0LUbXRQcdLh/RdSZ+swRm819REDrtqzC4es6Gw4JCKlSnjYVpo0xeq33PrADbFLL3RuCmObVmPN+24kfa+AojDuM4umKe2QwCf6EN906HwjujaitDs5o0s1y+k3lgbT2W2i7FJdnwbLXhJUBq/9liTctSmFC/0OqUinb0QddTWamtjbHRFuWJJ6NpqZ8vO3fZJ37Db+2GkaPYLGHs7XTTdiFQJ68SkVJFVmY6McR5UycflNCsccHFaV9FNbR4NttLxw4pQ7wJd066Z0ohVbzihaxHVExd/ay04oxUKWt+AsdiQ9OUyZ2krzN19IZIwafSTFgIBnMV73ADj7V/K8u1MaY2sJp2HWm0f41tqwajEvdHWOJs510MaAqN4aoSiPCXtN2KSi46dUxHdaMquar82O1x5jqhDGvqmoE9LfxcY3zqA7/x3HA67r9ZG4O6Cuxu12/+TP+eLP+I+HErqDDCDVmBDO4larujNe7x8om2rMug0MX0rL1+IWwdwfR+p1TNTyNmVJ85ljWzbWuGv8/C7HD/izjkHNZNYlhZcUOKVzKFUxsxxN/kax+8zPWPSFKw80rJr9Tizyj3o1gEsdwgWGoxPezDdZ1TSENE1dLdNvuKL+I84nxKesZgxXVA1VA1OcL49dFlpFV5yJMhzyCmNQ+a4BqusPJ2bB+xo8V9u3x48VVIEPS/mc3DvAbXyoYr6VgDfh5do5hhHOCXMqBZUPhWYbWZECwVJljLgMUWOCB4MUuMaxGNUQDVI50TQ+S3kFgIcu2qKkNSHVoM0SHsgoZxP2d5HH8B9woOk4x5bPkKtAHucZsdykjxuIpbUrSILgrT8G7G5oCW+K0990o7E3T6AdW4TilH5kDjds+H64kS0mz24grtwlzDHBJqI8YJQExotPvoC4JBq0lEjjQkyBZ8oH2LnRsQ4Hu1QsgDTJbO8fQDnllitkxuVskoiKbRF9VwzMDvxHAdwB7mD9yCplhHFEyUWHx3WtwCbSMMTCUCcEmSGlg4gTXkHpZXWQ7kpznK3EmCHiXInqndkQjunG5kxTKEeGye7jWz9cyMR2mGiFQ15ENRBTbCp+Gh86vAyASdgmJq2MC6hoADQ3GosP0QHbnMHjyBQvQqfhy/BUbeHd5WY/G/9LK/8Ka8Jd7UFeNWEZvzPb458Dn8DGLOe3/wGL/4xP+HXlRt+M1PE2iLhR8t+lfgxsuh7AfO2AOf+owWhSZRYQbd622hbpKWKuU+XuvNzP0OseRDa+mObgDHJUSc/pKx31QdKffQ5OIJpt8GWjlgTwMc/w5MPCR/yl1XC2a2Yut54SvOtMev55Of45BOat9aWG27p2ZVORRvnEk1hqWMVUmqa7S2YtvlIpspuF1pt0syuZS2NV14mUidCSfzQzg+KqvIYCMljIx2YK2AO34fX4GWdu5xcIAb8MzTw+j/lyWM+Dw/gjs4GD6ehNgA48kX/AI7XXM/XAN4WHr+9ntywqoCakCqmKP0rmQrJJEErG2Upg1JObr01lKQy4jskWalKYfJ/EDLMpjNSHFEUAde2fltaDgmrNaWQ9+AAb8I5vKjz3L1n1LriB/BXkG/wwR9y/oRX4LlioHA4LzP2inzRx/DWmutRweFjeP3tNeSGlaE1Fde0OS11yOpmbIp2u/jF1n2RRZviJM0yBT3IZl2HWImKjQOxIyeU325b/qWyU9Moj1o07tS0G7qJDoGHg5m8yeCxMoEH8GU45tnrNM84D2l297DQ9t1YP7jki/7RmutRweEA77/HWXOh3HCxkRgldDQkAjNTMl2Iloc1qN5JfJeeTlyTRzxURTdn1Ixv2uKjs12AbdEWlBtmVdk2k7FFwj07PCZ9XAwW3dG+8xKzNFr4EnwBZpy9Qzhh3jDXebBpYcpuo4fQ44u+fD1dweEnHzI7v0xuuOALRUV8rXpFyfSTQYkhd7IHm07jpyhlkCmI0ALYqPTpUxXS+z4jgDj1Pflvmz5ecuItpIBxyTHpSTGWd9g1ApfD/bvwUhL4nT1EzqgX7cxfCcNmb3mPL/qi9SwTHJ49oj5ZLjccbTG3pRmlYi6JCG0mQrAt1+i2UXTZ2dv9IlQpN5naMYtviaXlTrFpoMsl3bOAFEa8sqPj2WCMrx3Yjx99qFwO59Aw/wgx+HlqNz8oZvA3exRDvuhL1jMQHPaOJ0+XyA3fp1OfM3qObEVdhxjvynxNMXQV4+GJyvOEFqeQBaIbbO7i63rpxCltdZShPFxkjM2FPVkn3TG+Rp9pO3l2RzFegGfxGDHIAh8SteR0C4HopXzRF61nheDw6TFN05Ebvq8M3VKKpGjjO6r7nhudTEGMtYM92HTDaR1FDMXJ1eThsbKfywyoWwrzRSXkc51flG3vIid62h29bIcFbTGhfV+faaB+ohj7dPN0C2e2lC96+XouFByen9AsunLDJZ9z7NExiUc0OuoYW6UZkIyx2YUR2z6/TiRjyKMx5GbbjLHvHuf7YmtKghf34LJfx63Yg8vrvN2zC7lY0x0tvKezo4HmGYDU+Gab6dFL+KI761lDcNifcjLrrr9LWZJctG1FfU1uwhoQE22ObjdfkSzY63CbU5hzs21WeTddH2BaL11Gi7lVdlxP1nkxqhnKhVY6knS3EPgVGg1JpN5cP/hivujOelhXcPj8HC/LyI6MkteVjlolBdMmF3a3DbsuAYhL44dxzthWSN065xxUd55Lmf0wRbOYOqH09/o9WbO2VtFdaMb4qBgtFJoT1SqoN8wPXMoXLb3p1PUEhxfnnLzGzBI0Ku7FxrKsNJj/8bn/H8fPIVOd3rfrklUB/DOeO+nkghgSPzrlPxluCMtOnDL4Yml6dK1r3vsgMxgtPOrMFUZbEUbTdIzii5beq72G4PD0DKnwjmBULUVFmy8t+k7fZ3pKc0Q4UC6jpVRqS9Umv8bxw35flZVOU1X7qkjnhZlsMbk24qQ6Hz7QcuL6sDC0iHHki96Uh2UdvmgZnjIvExy2TeJdMDZNSbdZyAHe/Yd1xsQhHiKzjh7GxQ4yqMPaywPkjMamvqrYpmO7Knad+ZQC5msCuAPWUoxrxVhrGv7a+KLXFhyONdTMrZ7ke23qiO40ZJUyzgYyX5XyL0mV7NiUzEs9mjtbMN0dERqwyAJpigad0B3/zRV7s4PIfXSu6YV/MK7+OrYe/JvfGMn/PHJe2fyUdtnFrKRNpXV0Y2559aWPt/G4BlvjTMtXlVIWCnNyA3YQBDmYIodFz41PvXPSa6rq9lWZawZ4dP115HXV/M/tnFkkrBOdzg6aP4pID+MZnTJ1SuuB6iZlyiox4HT2y3YBtkUKWooacBQUDTpjwaDt5poBHl1/HXltwP887lKKXxNUEyPqpGTyA699UqY/lt9yGdlUKra0fFWS+36iylVWrAyd7Uw0CZM0z7xKTOduznLIjG2Hx8cDPLb+OvK6Bv7n1DYci4CxUuRxrjBc0bb4vD3rN5Zz36ntLb83eVJIB8LiIzCmn6SMPjlX+yNlTjvIGjs+QzHPf60Aj62/jrzG8j9vYMFtm1VoRWCJdmw7z9N0t+c8cxZpPeK4aTRicS25QhrVtUp7U578chk4q04Wx4YoQSjFryUlpcQ1AbxZ/XVMknIU//OGl7Q6z9Zpxi0+3yFhSkjUDpnCIUhLWVX23KQ+L9vKvFKI0ZWFQgkDLvBoylrHNVmaw10zwCPrr5tlodfnf94EWnQ0lFRWy8pW9LbkLsyUVDc2NSTHGDtnD1uMtchjbCeb1mpxFP0YbcClhzdLu6lfO8Bj6q+bdT2sz/+8SZCV7VIxtt0DUn9L7r4cLYWDSXnseEpOGFuty0qbOVlS7NNzs5FOGJUqQpl2Q64/yBpZf90sxbE+//PGdZ02HSipCbmD6NItmQ4Lk5XUrGpDMkhbMm2ZVheNYV+VbUWTcv99+2NyX1VoafSuC+AN6q9bFIMv5X/eagNWXZxEa9JjlMwNWb00akGUkSoepp1/yRuuqHGbUn3UdBSTxBU6SEVklzWRUkPndVvw2PrrpjvxOvzPmwHc0hpmq82npi7GRro8dXp0KXnUQmhZbRL7NEVp1uuZmO45vuzKsHrktS3GLWXODVjw+vXXLYx4Hf7njRPd0i3aoAGX6W29GnaV5YdyDj9TFkakje7GHYzDoObfddHtOSpoi2SmzJHrB3hM/XUDDEbxP2/oosszcRlehWXUvzHv4TpBVktHqwenFo8uLVmy4DKLa5d3RtLrmrM3aMFr1183E4sewf+85VWeg1c5ag276NZrM9IJVNcmLEvDNaV62aq+14IAOGFsBt973Ra8Xv11YzXwNfmft7Jg2oS+XOyoC8/cwzi66Dhmgk38kUmP1CUiYWOX1bpD2zWXt2FCp7uq8703APAa9dfNdscR/M/bZLIyouVxqJfeWvG9Je+JVckHQ9+CI9NWxz+blX/KYYvO5n2tAP/vrlZ7+8/h9y+9qeB/Hnt967e5mevX10rALDWK//FaAT5MXdBXdP0C/BAes792c40H+AiAp1e1oH8HgH94g/Lttx1gp63op1eyoM/Bvw5/G/7xFbqJPcCXnmBiwDPb/YKO4FX4OjyCb289db2/Noqicw4i7N6TVtoz8tNwDH+8x/i6Ae7lmaQVENzJFb3Di/BFeAwz+Is9SjeQySpPqbLFlNmyz47z5a/AF+AYFvDmHqibSXTEzoT4Gc3OALaqAP4KPFUJ6n+1x+rGAM6Zd78bgJ0a8QN4GU614vxwD9e1Amy6CcskNrczLx1JIp6HE5UZD/DBHrFr2oNlgG4Odv226BodoryjGJ9q2T/AR3vQrsOCS0ctXZi3ruLlhpFDJYl4HmYtjQCP9rhdn4suySLKDt6wLcC52h8xPlcjju1fn+yhuw4LZsAGUuo2b4Fx2UwQu77uqRHXGtg92aN3tQCbFexc0uk93vhTXbct6y7MulLycoUljx8ngDMBg1tvJjAazpEmOtxlzclvj1vQf1Tx7QlPDpGpqgtdSKz/d9/hdy1vTfFHSmC9dGDZbLiezz7Ac801HirGZsWjydfZyPvHXL/Y8Mjzg8BxTZiuwKz4Eb8sBE9zznszmjvFwHKPIWUnwhqfVRcd4Ck0K6ate48m1oOfrX3/yOtvAsJ8zsPAM89sjnddmuLuDPjX9Bu/L7x7xpMzFk6nWtyQfPg278Gn4Aekz2ZgOmU9eJ37R14vwE/BL8G3aibCiWMWWDQ0ZtkPMnlcGeAu/Ag+8ZyecU5BPuy2ILD+sQqyZhAKmn7XZd+jIMTN9eBL7x95xVLSX4On8EcNlXDqmBlqS13jG4LpmGbkF/0CnOi3H8ETOIXzmnmtb0a16Tzxj1sUvQCBiXZGDtmB3KAefPH94xcUa/6vwRn80GOFyjEXFpba4A1e8KQfFF+259tx5XS4egYn8fQsLGrqGrHbztr+uByTahWuL1NUGbDpsnrwBfePPwHHIf9X4RnM4Z2ABWdxUBlqQ2PwhuDxoS0vvqB1JzS0P4h2nA/QgTrsJFn+Y3AOjs9JFC07CGWX1oNX3T/yHOzgDjwPn1PM3g9Jk9lZrMEpxnlPmBbjyo2+KFXRU52TJM/2ALcY57RUzjObbjqxVw++4P6RAOf58pcVsw9Daje3htriYrpDOonre3CudSe6bfkTEgHBHuDiyu5MCsc7BHhYDx7ePxLjqigXZsw+ijMHFhuwBmtoTPtOxOrTvYJDnC75dnUbhfwu/ZW9AgYd+peL68HD+0emKquiXHhWjJg/UrkJYzuiaL3E9aI/ytrCvAd4GcYZMCkSQxfUg3v3j8c4e90j5ZTPdvmJJGHnOCI2nHS8081X013pHuBlV1gB2MX1YNmWLHqqGN/TWmG0y6clJWthxNUl48q38Bi8vtMKyzzpFdSDhxZ5WBA5ZLt8Jv3895DduBlgbPYAj8C4B8hO68FDkoh5lydC4FiWvBOVqjYdqjiLv92t8yPDjrDaiHdUD15qkSURSGmXJwOMSxWAXYwr3zaAufJ66l+94vv3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/wHuD9tQd4f+0B3l97gPfXHuD9tQd4f+0B3l97gG8LwP8G/AL8O/A5OCq0Ys2KIdv/qOIXG/4mvFAMF16gZD+2Xvu/B8as5+8bfllWyg0zaNO5bfXj6vfhhwD86/Aq3NfRS9t9WPnhfnvCIw/CT8GLcFTMnpntdF/z9V+PWc/vWoIH+FL3Znv57PitcdGP4R/C34avw5fgRVUInCwbsn1yyA8C8zm/BH8NXoXnVE6wVPjdeCI38kX/3+Ct9dbz1pTmHFRu+Hm4O9Ch3clr99negxfwj+ER/DR8EV6B5+DuQOnTgUw5rnkY+FbNU3gNXh0o/JYTuWOvyBf9FvzX663HH/HejO8LwAl8Hl5YLTd8q7sqA3wbjuExfAFegQdwfyDoSkWY8swzEf6o4Qyewefg+cHNbqMQruSL/u/WWc+E5g7vnnEXgDmcDeSGb/F4cBcCgT+GGRzDU3hZYburAt9TEtHgbM6JoxJ+6NMzzTcf6c2bycv2+KK/f+l6LBzw5IwfqZJhA3M472pWT/ajKxnjv4AFnMEpnBTPND6s2J7qHbPAqcMK74T2mZ4VGB9uJA465It+/eL1WKhYOD7xHOkr1ajK7d0C4+ke4Hy9qXZwpgLr+Znm/uNFw8xQOSy8H9IzjUrd9+BIfenYaylf9FsXr8fBAadnPIEDna8IBcwlxnuA0/Wv6GAWPd7dDIKjMdSWueAsBj4M7TOd06qBbwDwKr7oleuxMOEcTuEZTHWvDYUO7aHqAe0Bbq+HEFRzOz7WVoTDQkVds7A4sIIxfCQdCefFRoIOF/NFL1mPab/nvOakSL/Q1aFtNpUb/nFOVX6gzyg/1nISyDfUhsokIzaBR9Kxm80s5mK+6P56il1jXic7nhQxsxSm3OwBHl4fFdLqi64nDQZvqE2at7cWAp/IVvrN6/BFL1mPhYrGMBfOi4PyjuSGf6wBBh7p/FZTghCNWGgMzlBbrNJoPJX2mW5mwZfyRffXo7OFi5pZcS4qZUrlViptrXtw+GQoyhDPS+ANjcGBNRiLCQDPZPMHuiZfdFpPSTcQwwKYdRNqpkjm7AFeeT0pJzALgo7g8YYGrMHS0iocy+YTm2vyRUvvpXCIpQ5pe666TJrcygnScUf/p0NDs/iAI/nqDHC8TmQT8x3NF91l76oDdQGwu61Z6E0ABv7uO1dbf/37Zlv+Zw/Pbh8f1s4Avur6657/+YYBvur6657/+YYBvur6657/+YYBvur6657/+aYBvuL6657/+VMA8FXWX/f8zzcN8BXXX/f8zzcNMFdbf93zP38KLPiK6697/uebtuArrr/u+Z9vGmCusP6653/+1FjwVdZf9/zPN7oHX339dc//fNMu+irrr3v+50+Bi+Zq6697/uebA/jz8Pudf9ht/fWv517J/XUzAP8C/BAeX9WCDrUpZ3/dEMBxgPcfbtTVvsYV5Yn32u03B3Ac4P3b8I+vxNBKeeL9dRMAlwO83959qGO78sT769oB7g3w/vGVYFzKE++v6wV4OMD7F7tckFkmT7y/rhHgpQO8b+4Y46XyxPvrugBeNcB7BRiX8sT767oAvmCA9woAHsoT76+rBJjLBnh3txOvkifeX1dswZcO8G6N7sXyxPvr6i340gHe3TnqVfLE++uKAb50gHcXLnrX8sR7gNdPRqwzwLu7Y/FO5Yn3AK9jXCMGeHdgxDuVJ75VAI8ljP7PAb3/RfjcZfePHBB+79dpfpH1CanN30d+mT1h9GqAxxJGM5LQeeQ1+Tb+EQJrElLb38VHQ94TRq900aMIo8cSOo+8Dp8QfsB8zpqE1NO3OI9Zrj1h9EV78PqE0WMJnUdeU6E+Jjyk/hbrEFIfeWbvId8H9oTRFwdZaxJGvziW0Hn0gqYB/wyZ0PwRlxJST+BOw9m77Amj14ii1yGM/txYQudN0qDzGe4EqfA/5GJCagsHcPaEPWH0esekSwmjRxM6b5JEcZ4ww50ilvAOFxBSx4yLW+A/YU8YvfY5+ALC6NGEzhtmyZoFZoarwBLeZxUhtY4rc3bKnjB6TKJjFUHzJoTOozF2YBpsjcyxDgzhQ1YRUse8+J4wenwmaylB82hC5w0zoRXUNXaRBmSMQUqiWSWkLsaVqc/ZE0aPTFUuJWgeTei8SfLZQeMxNaZSIzbII4aE1Nmr13P2hNHjc9E9guYNCZ032YlNwESMLcZiLQHkE4aE1BFg0yAR4z1h9AiAGRA0jyZ03tyIxWMajMPWBIsxYJCnlITU5ShiHYdZ94TR4wCmSxg9jtB5KyPGYzymAYexWEMwAPIsAdYdV6aObmNPGD0aYLoEzaMJnTc0Ygs+YDw0GAtqxBjkuP38bMRWCHn73xNGjz75P73WenCEJnhwyVe3AEe8TtKdJcYhBl97wuhNAObK66lvD/9J9NS75v17wuitAN5fe4D31x7g/bUHeH/tAd5fe4D3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/w/toDvAd4f/24ABzZ8o+KLsSLS+Pv/TqTb3P4hKlQrTGh+fbIBT0Axqznnb+L/V2mb3HkN5Mb/nEHeK7d4IcDld6lmDW/iH9E+AH1MdOw/Jlu2T1xNmY98sv4wHnD7D3uNHu54WUuOsBTbQuvBsPT/UfzNxGYzwkP8c+Yz3C+r/i6DcyRL/rZ+utRwWH5PmfvcvYEt9jLDS/bg0/B64DWKrQM8AL8FPwS9beQCe6EMKNZYJol37jBMy35otdaz0Bw2H/C2Smc7+WGB0HWDELBmOByA3r5QONo4V+DpzR/hFS4U8wMW1PXNB4TOqYz9urxRV++ntWCw/U59Ty9ebdWbrgfRS9AYKKN63ZokZVygr8GZ/gfIhZXIXPsAlNjPOLBby5c1eOLvmQ9lwkOy5x6QV1j5TYqpS05JtUgUHUp5toHGsVfn4NX4RnMCe+AxTpwmApTYxqMxwfCeJGjpXzRF61nbcHhUBPqWze9svwcHJ+S6NPscKrEjug78Dx8Lj3T8D4YxGIdxmJcwhi34fzZUr7olevZCw5vkOhoClq5zBPZAnygD/Tl9EzDh6kl3VhsHYcDEb+hCtJSvuiV69kLDm+WycrOTArHmB5/VYyP6jOVjwgGawk2zQOaTcc1L+aLXrKeveDwZqlKrw8U9Y1p66uK8dEzdYwBeUQAY7DbyYNezBfdWQ97weEtAKYQg2xJIkuveAT3dYeLGH+ShrWNwZgN0b2YL7qznr3g8JYAo5bQBziPjx7BPZ0d9RCQp4UZbnFdzBddor4XHN4KYMrB2qHFRIzzcLAHQZ5the5ovui94PCWAPefaYnxIdzRwdHCbuR4B+tbiy96Lzi8E4D7z7S0mEPd+eqO3cT53Z0Y8SV80XvB4Z0ADJi/f7X113f+7p7/+UYBvur6657/+YYBvur6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+VMA8FXWX/f8z58OgK+y/rrnf75RgLna+uue//lTA/CV1V/3/M837aKvvv6653++UQvmauuve/7nTwfAV1N/3fM/fzr24Cuuv+75nz8FFnxl9dc9//MOr/8/glixwRuUfM4AAAAASUVORK5CYII="}getSearchTexture(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}dispose(){this.edgesRT.dispose(),this.weightsRT.dispose(),this.areaTexture.dispose(),this.searchTexture.dispose(),this.materialEdges.dispose(),this.materialWeights.dispose(),this.materialBlend.dispose(),this.fsQuad.dispose()}}class ug extends Yi{getType(){return _0e}set edgesRT(e){this._objRef&&(this._objRef.edgesRT=e)}get edgesRT(){return this._objRef?.edgesRT}set weightsRT(e){this._objRef&&(this._objRef.weightsRT=e)}get weightsRT(){return this._objRef?.weightsRT}set areaTexture(e){this._objRef&&(this._objRef.areaTexture=e)}get areaTexture(){return this._objRef?.areaTexture}set searchTexture(e){this._objRef&&(this._objRef.searchTexture=e)}get searchTexture(){return this._objRef?.searchTexture}set uniformsEdges(e){this._objRef&&(this._objRef.uniformsEdges=e)}get uniformsEdges(){return this._objRef?.uniformsEdges}set materialEdges(e){this._objRef&&(this._objRef.materialEdges=e)}get materialEdges(){return this._objRef?.materialEdges}set uniformsWeights(e){this._objRef&&(this._objRef.uniformsWeights=e)}get uniformsWeights(){return this._objRef?.uniformsWeights}set materialWeights(e){this._objRef&&(this._objRef.materialWeights=e)}get materialWeights(){return this._objRef?.materialWeights}set uniformsBlend(e){this._objRef&&(this._objRef.uniformsBlend=e)}get uniformsBlend(){return this._objRef?.uniformsBlend}set materialBlend(e){this._objRef&&(this._objRef.materialBlend=e)}get materialBlend(){return this._objRef?.materialBlend}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}}ug.\u0275fac=function(){let i;return function(t){return(i||(i=le(ug)))(t||ug)}}(),ug.\u0275cmp=$({type:ug,selectors:[["th-sMAAPass"]],inputs:{edgesRT:"edgesRT",weightsRT:"weightsRT",areaTexture:"areaTexture",searchTexture:"searchTexture",uniformsEdges:"uniformsEdges",materialEdges:"materialEdges",uniformsWeights:"uniformsWeights",materialWeights:"materialWeights",uniformsBlend:"uniformsBlend",materialBlend:"materialBlend",fsQuad:"fsQuad"},features:[ne([{provide:Li,useExisting:ae(()=>ug)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Ja extends Rt{getType(){return wc}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}}Ja.\u0275fac=function(){let i;return function(t){return(i||(i=le(Ja)))(t||Ja)}}(),Ja.\u0275cmp=$({type:Ja,selectors:[["th-sphereGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>Ja)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class hg extends ao{getType(){return Bb}get isSpotLight(){return this._objRef?.isSpotLight}get type(){return this._objRef?.type}set position(e){this._objRef&&(this._objRef.position=Ye(this._objRef.position,e))}get position(){return this._objRef?.position}set target(e){this._objRef&&(this._objRef.target=e)}get target(){return this._objRef?.target}set castShadow(e){this._objRef&&(this._objRef.castShadow=e)}get castShadow(){return this._objRef?.castShadow}set intensity(e){this._objRef&&(this._objRef.intensity=e)}get intensity(){return this._objRef?.intensity}set distance(e){this._objRef&&(this._objRef.distance=e)}get distance(){return this._objRef?.distance}set angle(e){this._objRef&&(this._objRef.angle=e)}get angle(){return this._objRef?.angle}set decay(e){this._objRef&&(this._objRef.decay=e)}get decay(){return this._objRef?.decay}set shadow(e){this._objRef&&(this._objRef.shadow=e)}get shadow(){return this._objRef?.shadow}set power(e){this._objRef&&(this._objRef.power=e)}get power(){return this._objRef?.power}set penumbra(e){this._objRef&&(this._objRef.penumbra=e)}get penumbra(){return this._objRef?.penumbra}set map(e){this._objRef&&(this._objRef.map=e)}get map(){return this._objRef?.map}}hg.\u0275fac=function(){let i;return function(t){return(i||(i=le(hg)))(t||hg)}}(),hg.\u0275cmp=$({type:hg,selectors:[["th-spotLight"]],inputs:{position:"position",target:"target",castShadow:"castShadow",intensity:"intensity",distance:"distance",angle:"angle",decay:"decay",shadow:"shadow",power:"power",penumbra:"penumbra",map:"map"},features:[ne([{provide:We,useExisting:ae(()=>hg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class fg extends We{getType(){return h5}get type(){return this._objRef?.type}set cone(e){this._objRef&&(this._objRef.cone=e)}get cone(){return this._objRef?.cone}set light(e){this._objRef&&(this._objRef.light=e)}get light(){return this._objRef?.light}set matrix(e){this._objRef&&(this._objRef.matrix=Ye(this._objRef.matrix,e))}get matrix(){return this._objRef?.matrix}set color(e){this._objRef&&(this._objRef.color=e)}get color(){return this._objRef?.color}set matrixAutoUpdate(e){this._objRef&&(this._objRef.matrixAutoUpdate=e)}get matrixAutoUpdate(){return this._objRef?.matrixAutoUpdate}}fg.\u0275fac=function(){let i;return function(t){return(i||(i=le(fg)))(t||fg)}}(),fg.\u0275cmp=$({type:fg,selectors:[["th-spotLightHelper"]],inputs:{cone:"cone",light:"light",matrix:"matrix",color:"color",matrixAutoUpdate:"matrixAutoUpdate"},features:[ne([{provide:We,useExisting:ae(()=>fg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class pg extends We{getType(){return oR}get isSprite(){return this._objRef?.isSprite}get type(){return this._objRef?.type}set castShadow(e){this._objRef&&(this._objRef.castShadow=e)}get castShadow(){return this._objRef?.castShadow}set geometry(e){this._objRef&&(this._objRef.geometry=e)}get geometry(){return this._objRef?.geometry}set material(e){this._objRef&&(this._objRef.material=e)}get material(){return this._objRef?.material}set center(e){this._objRef&&(this._objRef.center=Ye(this._objRef.center,e))}get center(){return this._objRef?.center}}pg.\u0275fac=function(){let i;return function(t){return(i||(i=le(pg)))(t||pg)}}(),pg.\u0275cmp=$({type:pg,selectors:[["th-sprite"]],inputs:{castShadow:"castShadow",geometry:"geometry",material:"material",center:"center"},features:[ne([{provide:We,useExisting:ae(()=>pg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class mg extends Si{getType(){return hx}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set color(e){this._objRef&&(this._objRef.color=Ye(this._objRef.color,e))}get color(){return this._objRef?.color}set map(e){this._objRef&&(this._objRef.map=e)}get map(){return this._objRef?.map}set alphaMap(e){this._objRef&&(this._objRef.alphaMap=e)}get alphaMap(){return this._objRef?.alphaMap}set rotation(e){this._objRef&&(this._objRef.rotation=e)}get rotation(){return this._objRef?.rotation}set sizeAttenuation(e){this._objRef&&(this._objRef.sizeAttenuation=e)}get sizeAttenuation(){return this._objRef?.sizeAttenuation}set transparent(e){this._objRef&&(this._objRef.transparent=e)}get transparent(){return this._objRef?.transparent}set fog(e){this._objRef&&(this._objRef.fog=e)}get fog(){return this._objRef?.fog}get isSpriteMaterial(){return this._objRef?.isSpriteMaterial}}mg.\u0275fac=function(){let i;return function(t){return(i||(i=le(mg)))(t||mg)}}(),mg.\u0275cmp=$({type:mg,selectors:[["th-spriteMaterial"]],inputs:{type:"type",color:"color",map:"map",alphaMap:"alphaMap",rotation:"rotation",sizeAttenuation:"sizeAttenuation",transparent:"transparent",fog:"fog"},features:[ne([{provide:Si,useExisting:ae(()=>mg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class $G extends wn{constructor(e,t,n,r){super(),this.scene=e,this.camera=t,this.sampleLevel=4,this.unbiased=!0,this.clearColor=void 0!==n?n:0,this.clearAlpha=void 0!==r?r:0,this._oldClearColor=new Le;const s=Yr;this.copyUniforms=gi.clone(s.uniforms),this.copyMaterial=new Pt({uniforms:this.copyUniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blending:wf,blendEquation:ws,blendDst:q_,blendDstAlpha:q_,blendSrc:Mf,blendSrcAlpha:q_}),this.fsQuad=new xr(this.copyMaterial)}dispose(){this.sampleRenderTarget&&(this.sampleRenderTarget.dispose(),this.sampleRenderTarget=null),this.copyMaterial.dispose(),this.fsQuad.dispose()}setSize(e,t){this.sampleRenderTarget&&this.sampleRenderTarget.setSize(e,t)}render(e,t,n){this.sampleRenderTarget||(this.sampleRenderTarget=new Gt(n.width,n.height),this.sampleRenderTarget.texture.name="SSAARenderPass.sample");const r=C0e[Math.max(0,Math.min(this.sampleLevel,5))],s=e.autoClear;e.autoClear=!1,e.getClearColor(this._oldClearColor);const o=e.getClearAlpha(),a=1/r.length;this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture;const c={fullWidth:n.width,fullHeight:n.height,offsetX:0,offsetY:0,width:n.width,height:n.height},d=Object.assign({},this.camera.view);d.enabled&&Object.assign(c,d);for(let u=0;u<r.length;u++){const h=r[u];this.camera.setViewOffset&&this.camera.setViewOffset(c.fullWidth,c.fullHeight,c.offsetX+.0625*h[0],c.offsetY+.0625*h[1],c.width,c.height);let f=a;this.unbiased&&(f+=.03125*((u+.5)/r.length-.5)),this.copyUniforms.opacity.value=f,e.setClearColor(this.clearColor,this.clearAlpha),e.setRenderTarget(this.sampleRenderTarget),e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(this.renderToScreen?null:t),0===u&&(e.setClearColor(0,0),e.clear()),this.fsQuad.render(e)}this.camera.setViewOffset&&d.enabled?this.camera.setViewOffset(d.fullWidth,d.fullHeight,d.offsetX,d.offsetY,d.width,d.height):this.camera.clearViewOffset&&this.camera.clearViewOffset(),e.autoClear=s,e.setClearColor(this._oldClearColor,o)}}const C0e=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]];class dh extends Yi{getType(){return $G}set scene(e){this._objRef&&(this._objRef.scene=e)}get scene(){return this._objRef?.scene}set camera(e){this._objRef&&(this._objRef.camera=e)}get camera(){return this._objRef?.camera}set sampleLevel(e){this._objRef&&(this._objRef.sampleLevel=e)}get sampleLevel(){return this._objRef?.sampleLevel}set unbiased(e){this._objRef&&(this._objRef.unbiased=e)}get unbiased(){return this._objRef?.unbiased}set clearColor(e){this._objRef&&(this._objRef.clearColor=e)}get clearColor(){return this._objRef?.clearColor}set clearAlpha(e){this._objRef&&(this._objRef.clearAlpha=e)}get clearAlpha(){return this._objRef?.clearAlpha}set copyUniforms(e){this._objRef&&(this._objRef.copyUniforms=e)}get copyUniforms(){return this._objRef?.copyUniforms}set copyMaterial(e){this._objRef&&(this._objRef.copyMaterial=e)}get copyMaterial(){return this._objRef?.copyMaterial}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}set sampleRenderTarget(e){this._objRef&&(this._objRef.sampleRenderTarget=e)}get sampleRenderTarget(){return this._objRef?.sampleRenderTarget}}dh.\u0275fac=function(){let i;return function(t){return(i||(i=le(dh)))(t||dh)}}(),dh.\u0275cmp=$({type:dh,selectors:[["th-sSAARenderPass"]],inputs:{scene:"scene",camera:"camera",sampleLevel:"sampleLevel",unbiased:"unbiased",clearColor:"clearColor",clearAlpha:"clearAlpha",copyUniforms:"copyUniforms",copyMaterial:"copyMaterial",fsQuad:"fsQuad",sampleRenderTarget:"sampleRenderTarget"},features:[ne([{provide:Li,useExisting:ae(()=>dh)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const $w={defines:{PERSPECTIVE_CAMERA:1,KERNEL_SIZE:32},uniforms:{tDiffuse:{value:null},tNormal:{value:null},tDepth:{value:null},tNoise:{value:null},kernel:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new fe},cameraProjectionMatrix:{value:new Qe},cameraInverseProjectionMatrix:{value:new Qe},kernelRadius:{value:8},minDistance:{value:.005},maxDistance:{value:.05}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tNormal;\n\t\tuniform sampler2D tDepth;\n\t\tuniform sampler2D tNoise;\n\n\t\tuniform vec3 kernel[ KERNEL_SIZE ];\n\n\t\tuniform vec2 resolution;\n\n\t\tuniform float cameraNear;\n\t\tuniform float cameraFar;\n\t\tuniform mat4 cameraProjectionMatrix;\n\t\tuniform mat4 cameraInverseProjectionMatrix;\n\n\t\tuniform float kernelRadius;\n\t\tuniform float minDistance; // avoid artifacts caused by neighbour fragments with minimal depth difference\n\t\tuniform float maxDistance; // avoid the influence of fragments which are too far away\n\n\t\tvarying vec2 vUv;\n\n\t\t#include <packing>\n\n\t\tfloat getDepth( const in vec2 screenPosition ) {\n\n\t\t\treturn texture2D( tDepth, screenPosition ).x;\n\n\t\t}\n\n\t\tfloat getLinearDepth( const in vec2 screenPosition ) {\n\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\n\t\t\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;\n\t\t\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );\n\t\t\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );\n\n\t\t\t#else\n\n\t\t\t\treturn texture2D( tDepth, screenPosition ).x;\n\n\t\t\t#endif\n\n\t\t}\n\n\t\tfloat getViewZ( const in float depth ) {\n\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\n\t\t\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\n\n\t\t\t#else\n\n\t\t\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );\n\n\t\t\t#endif\n\n\t\t}\n\n\t\tvec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {\n\n\t\t\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];\n\n\t\t\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );\n\n\t\t\tclipPosition *= clipW; // unprojection.\n\n\t\t\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;\n\n\t\t}\n\n\t\tvec3 getViewNormal( const in vec2 screenPosition ) {\n\n\t\t\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tfloat depth = getDepth( vUv );\n\t\t\tfloat viewZ = getViewZ( depth );\n\n\t\t\tvec3 viewPosition = getViewPosition( vUv, depth, viewZ );\n\t\t\tvec3 viewNormal = getViewNormal( vUv );\n\n\t\t\tvec2 noiseScale = vec2( resolution.x / 4.0, resolution.y / 4.0 );\n\t\t\tvec3 random = vec3( texture2D( tNoise, vUv * noiseScale ).r );\n\n\t\t\t// compute matrix used to reorient a kernel vector\n\n\t\t\tvec3 tangent = normalize( random - viewNormal * dot( random, viewNormal ) );\n\t\t\tvec3 bitangent = cross( viewNormal, tangent );\n\t\t\tmat3 kernelMatrix = mat3( tangent, bitangent, viewNormal );\n\n\t\t float occlusion = 0.0;\n\n\t\t for ( int i = 0; i < KERNEL_SIZE; i ++ ) {\n\n\t\t\t\tvec3 sampleVector = kernelMatrix * kernel[ i ]; // reorient sample vector in view space\n\t\t\t\tvec3 samplePoint = viewPosition + ( sampleVector * kernelRadius ); // calculate sample point\n\n\t\t\t\tvec4 samplePointNDC = cameraProjectionMatrix * vec4( samplePoint, 1.0 ); // project point and calculate NDC\n\t\t\t\tsamplePointNDC /= samplePointNDC.w;\n\n\t\t\t\tvec2 samplePointUv = samplePointNDC.xy * 0.5 + 0.5; // compute uv coordinates\n\n\t\t\t\tfloat realDepth = getLinearDepth( samplePointUv ); // get linear depth from depth texture\n\t\t\t\tfloat sampleDepth = viewZToOrthographicDepth( samplePoint.z, cameraNear, cameraFar ); // compute linear depth of the sample view Z value\n\t\t\t\tfloat delta = sampleDepth - realDepth;\n\n\t\t\t\tif ( delta > minDistance && delta < maxDistance ) { // if fragment is before sample point, increase occlusion\n\n\t\t\t\t\tocclusion += 1.0;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tocclusion = clamp( occlusion / float( KERNEL_SIZE ), 0.0, 1.0 );\n\n\t\t\tgl_FragColor = vec4( vec3( 1.0 - occlusion ), 1.0 );\n\n\t\t}"},Jw_defines={PERSPECTIVE_CAMERA:1},Jw_uniforms={tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null}},Jw_vertexShader="varying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",Jw_fragmentShader="uniform sampler2D tDepth;\n\n\t\tuniform float cameraNear;\n\t\tuniform float cameraFar;\n\n\t\tvarying vec2 vUv;\n\n\t\t#include <packing>\n\n\t\tfloat getLinearDepth( const in vec2 screenPosition ) {\n\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\n\t\t\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;\n\t\t\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );\n\t\t\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );\n\n\t\t\t#else\n\n\t\t\t\treturn texture2D( tDepth, screenPosition ).x;\n\n\t\t\t#endif\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tfloat depth = getLinearDepth( vUv );\n\t\t\tgl_FragColor = vec4( vec3( 1.0 - depth ), 1.0 );\n\n\t\t}",eC={uniforms:{tDiffuse:{value:null},resolution:{value:new fe}},vertexShader:"varying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"uniform sampler2D tDiffuse;\n\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec2 texelSize = ( 1.0 / resolution );\n\t\t\tfloat result = 0.0;\n\n\t\t\tfor ( int i = - 2; i <= 2; i ++ ) {\n\n\t\t\t\tfor ( int j = - 2; j <= 2; j ++ ) {\n\n\t\t\t\t\tvec2 offset = ( vec2( float( i ), float( j ) ) ) * texelSize;\n\t\t\t\t\tresult += texture2D( tDiffuse, vUv + offset ).r;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tgl_FragColor = vec4( vec3( result / ( 5.0 * 5.0 ) ), 1.0 );\n\n\t\t}"};let JG=(()=>{class i extends wn{constructor(t,n,r,s){super(),this.width=void 0!==r?r:512,this.height=void 0!==s?s:512,this.clear=!0,this.camera=n,this.scene=t,this.kernelRadius=8,this.kernelSize=32,this.kernel=[],this.noiseTexture=null,this.output=0,this.minDistance=.005,this.maxDistance=.1,this._visibilityCache=new Map,this.generateSampleKernel(),this.generateRandomKernelRotations();const o=new rp;o.format=pc,o.type=hc,this.beautyRenderTarget=new Gt(this.width,this.height),this.normalRenderTarget=new Gt(this.width,this.height,{minFilter:$t,magFilter:$t,depthTexture:o}),this.ssaoRenderTarget=new Gt(this.width,this.height),this.blurRenderTarget=this.ssaoRenderTarget.clone(),this.ssaoMaterial=new Pt({defines:Object.assign({},$w.defines),uniforms:gi.clone($w.uniforms),vertexShader:$w.vertexShader,fragmentShader:$w.fragmentShader,blending:Kt}),this.ssaoMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.ssaoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.ssaoMaterial.uniforms.tDepth.value=this.normalRenderTarget.depthTexture,this.ssaoMaterial.uniforms.tNoise.value=this.noiseTexture,this.ssaoMaterial.uniforms.kernel.value=this.kernel,this.ssaoMaterial.uniforms.cameraNear.value=this.camera.near,this.ssaoMaterial.uniforms.cameraFar.value=this.camera.far,this.ssaoMaterial.uniforms.resolution.value.set(this.width,this.height),this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.normalMaterial=new Cp,this.normalMaterial.blending=Kt,this.blurMaterial=new Pt({defines:Object.assign({},eC.defines),uniforms:gi.clone(eC.uniforms),vertexShader:eC.vertexShader,fragmentShader:eC.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.blurMaterial.uniforms.resolution.value.set(this.width,this.height),this.depthRenderMaterial=new Pt({defines:Object.assign({},Jw_defines),uniforms:gi.clone(Jw_uniforms),vertexShader:Jw_vertexShader,fragmentShader:Jw_fragmentShader,blending:Kt}),this.depthRenderMaterial.uniforms.tDepth.value=this.normalRenderTarget.depthTexture,this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.copyMaterial=new Pt({uniforms:gi.clone(Yr.uniforms),vertexShader:Yr.vertexShader,fragmentShader:Yr.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:Ay,blendDst:Cf,blendEquation:ws,blendSrcAlpha:vy,blendDstAlpha:Cf,blendEquationAlpha:ws}),this.fsQuad=new xr(null),this.originalClearColor=new Le}dispose(){this.beautyRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.ssaoRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.normalMaterial.dispose(),this.blurMaterial.dispose(),this.copyMaterial.dispose(),this.depthRenderMaterial.dispose(),this.fsQuad.dispose()}render(t,n){switch(!1===t.capabilities.isWebGL2&&(this.noiseTexture.format=Cy),t.setRenderTarget(this.beautyRenderTarget),t.clear(),t.render(this.scene,this.camera),this.overrideVisibility(),this.renderOverride(t,this.normalMaterial,this.normalRenderTarget,7829503,1),this.restoreVisibility(),this.ssaoMaterial.uniforms.kernelRadius.value=this.kernelRadius,this.ssaoMaterial.uniforms.minDistance.value=this.minDistance,this.ssaoMaterial.uniforms.maxDistance.value=this.maxDistance,this.renderPass(t,this.ssaoMaterial,this.ssaoRenderTarget),this.renderPass(t,this.blurMaterial,this.blurRenderTarget),this.output){case i.OUTPUT.SSAO:this.copyMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Blur:this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Beauty:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Depth:this.renderPass(t,this.depthRenderMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Normal:this.copyMaterial.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Default:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n),this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=wf,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;default:console.warn("THREE.SSAOPass: Unknown output type.")}}renderPass(t,n,r,s,o){t.getClearColor(this.originalClearColor);const a=t.getClearAlpha(),l=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,null!=s&&(t.setClearColor(s),t.setClearAlpha(o||0),t.clear()),this.fsQuad.material=n,this.fsQuad.render(t),t.autoClear=l,t.setClearColor(this.originalClearColor),t.setClearAlpha(a)}renderOverride(t,n,r,s,o){t.getClearColor(this.originalClearColor);const a=t.getClearAlpha(),l=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,o=n.clearAlpha||o,null!=(s=n.clearColor||s)&&(t.setClearColor(s),t.setClearAlpha(o||0),t.clear()),this.scene.overrideMaterial=n,t.render(this.scene,this.camera),this.scene.overrideMaterial=null,t.autoClear=l,t.setClearColor(this.originalClearColor),t.setClearAlpha(a)}setSize(t,n){this.width=t,this.height=n,this.beautyRenderTarget.setSize(t,n),this.ssaoRenderTarget.setSize(t,n),this.normalRenderTarget.setSize(t,n),this.blurRenderTarget.setSize(t,n),this.ssaoMaterial.uniforms.resolution.value.set(t,n),this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.blurMaterial.uniforms.resolution.value.set(t,n)}generateSampleKernel(){const t=this.kernelSize,n=this.kernel;for(let r=0;r<t;r++){const s=new R;s.x=2*Math.random()-1,s.y=2*Math.random()-1,s.z=Math.random(),s.normalize();let o=r/t;o=ft.lerp(.1,1,o*o),s.multiplyScalar(o),n.push(s)}}generateRandomKernelRotations(){const r=new qw,o=new Float32Array(16);for(let a=0;a<16;a++){const l=2*Math.random()-1,c=2*Math.random()-1;o[a]=r.noise3d(l,c,0)}this.noiseTexture=new Fa(o,4,4,Cl,Un),this.noiseTexture.wrapS=Mo,this.noiseTexture.wrapT=Mo,this.noiseTexture.needsUpdate=!0}overrideVisibility(){const n=this._visibilityCache;this.scene.traverse(function(r){n.set(r,r.visible),(r.isPoints||r.isLine)&&(r.visible=!1)})}restoreVisibility(){const n=this._visibilityCache;this.scene.traverse(function(r){const s=n.get(r);r.visible=s}),n.clear()}}return i.OUTPUT={Default:0,SSAO:1,Blur:2,Beauty:3,Depth:4,Normal:5},i})();class uh extends Yi{getType(){return JG}set scene(e){this._objRef&&(this._objRef.scene=e)}get scene(){return this._objRef?.scene}set camera(e){this._objRef&&(this._objRef.camera=e)}get camera(){return this._objRef?.camera}set width(e){this._objRef&&(this._objRef.width=e)}get width(){return this._objRef?.width}set height(e){this._objRef&&(this._objRef.height=e)}get height(){return this._objRef?.height}set clear(e){this._objRef&&(this._objRef.clear=e)}get clear(){return this._objRef?.clear}set kernelRadius(e){this._objRef&&(this._objRef.kernelRadius=e)}get kernelRadius(){return this._objRef?.kernelRadius}set kernelSize(e){this._objRef&&(this._objRef.kernelSize=e)}get kernelSize(){return this._objRef?.kernelSize}set kernel(e){this._objRef&&(this._objRef.kernel=e)}get kernel(){return this._objRef?.kernel}set noiseTexture(e){this._objRef&&(this._objRef.noiseTexture=e)}get noiseTexture(){return this._objRef?.noiseTexture}set output(e){this._objRef&&(this._objRef.output=e)}get output(){return this._objRef?.output}set minDistance(e){this._objRef&&(this._objRef.minDistance=e)}get minDistance(){return this._objRef?.minDistance}set maxDistance(e){this._objRef&&(this._objRef.maxDistance=e)}get maxDistance(){return this._objRef?.maxDistance}set beautyRenderTarget(e){this._objRef&&(this._objRef.beautyRenderTarget=e)}get beautyRenderTarget(){return this._objRef?.beautyRenderTarget}set normalRenderTarget(e){this._objRef&&(this._objRef.normalRenderTarget=e)}get normalRenderTarget(){return this._objRef?.normalRenderTarget}set ssaoRenderTarget(e){this._objRef&&(this._objRef.ssaoRenderTarget=e)}get ssaoRenderTarget(){return this._objRef?.ssaoRenderTarget}set blurRenderTarget(e){this._objRef&&(this._objRef.blurRenderTarget=e)}get blurRenderTarget(){return this._objRef?.blurRenderTarget}set ssaoMaterial(e){this._objRef&&(this._objRef.ssaoMaterial=e)}get ssaoMaterial(){return this._objRef?.ssaoMaterial}set normalMaterial(e){this._objRef&&(this._objRef.normalMaterial=e)}get normalMaterial(){return this._objRef?.normalMaterial}set blurMaterial(e){this._objRef&&(this._objRef.blurMaterial=e)}get blurMaterial(){return this._objRef?.blurMaterial}set depthRenderMaterial(e){this._objRef&&(this._objRef.depthRenderMaterial=e)}get depthRenderMaterial(){return this._objRef?.depthRenderMaterial}set copyMaterial(e){this._objRef&&(this._objRef.copyMaterial=e)}get copyMaterial(){return this._objRef?.copyMaterial}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}set originalClearColor(e){this._objRef&&(this._objRef.originalClearColor=Ye(this._objRef.originalClearColor,e))}get originalClearColor(){return this._objRef?.originalClearColor}}uh.OUTPUT=JG.OUTPUT,uh.\u0275fac=function(){let i;return function(t){return(i||(i=le(uh)))(t||uh)}}(),uh.\u0275cmp=$({type:uh,selectors:[["th-sSAOPass"]],inputs:{scene:"scene",camera:"camera",width:"width",height:"height",clear:"clear",kernelRadius:"kernelRadius",kernelSize:"kernelSize",kernel:"kernel",noiseTexture:"noiseTexture",output:"output",minDistance:"minDistance",maxDistance:"maxDistance",beautyRenderTarget:"beautyRenderTarget",normalRenderTarget:"normalRenderTarget",ssaoRenderTarget:"ssaoRenderTarget",blurRenderTarget:"blurRenderTarget",ssaoMaterial:"ssaoMaterial",normalMaterial:"normalMaterial",blurMaterial:"blurMaterial",depthRenderMaterial:"depthRenderMaterial",copyMaterial:"copyMaterial",fsQuad:"fsQuad",originalClearColor:"originalClearColor"},features:[ne([{provide:Li,useExisting:ae(()=>uh)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const el={defines:{MAX_STEP:0,PERSPECTIVE_CAMERA:!0,DISTANCE_ATTENUATION:!0,FRESNEL:!0,INFINITE_THICK:!1,SELECTIVE:!1},uniforms:{tDiffuse:{value:null},tNormal:{value:null},tMetalness:{value:null},tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new fe},cameraProjectionMatrix:{value:new Qe},cameraInverseProjectionMatrix:{value:new Qe},opacity:{value:.5},maxDistance:{value:180},cameraRange:{value:0},thickness:{value:.018}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}\n\n\t",fragmentShader:'\n\t\t// precision highp float;\n\t\tprecision highp sampler2D;\n\t\tvarying vec2 vUv;\n\t\tuniform sampler2D tDepth;\n\t\tuniform sampler2D tNormal;\n\t\tuniform sampler2D tMetalness;\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float cameraRange;\n\t\tuniform vec2 resolution;\n\t\tuniform float opacity;\n\t\tuniform float cameraNear;\n\t\tuniform float cameraFar;\n\t\tuniform float maxDistance;\n\t\tuniform float thickness;\n\t\tuniform mat4 cameraProjectionMatrix;\n\t\tuniform mat4 cameraInverseProjectionMatrix;\n\t\t#include <packing>\n\t\tfloat pointToLineDistance(vec3 x0, vec3 x1, vec3 x2) {\n\t\t\t//x0: point, x1: linePointA, x2: linePointB\n\t\t\t//https://mathworld.wolfram.com/Point-LineDistance3-Dimensional.html\n\t\t\treturn length(cross(x0-x1,x0-x2))/length(x2-x1);\n\t\t}\n\t\tfloat pointPlaneDistance(vec3 point,vec3 planePoint,vec3 planeNormal){\n\t\t\t// https://mathworld.wolfram.com/Point-PlaneDistance.html\n\t\t\t//// https://en.wikipedia.org/wiki/Plane_(geometry)\n\t\t\t//// http://paulbourke.net/geometry/pointlineplane/\n\t\t\tfloat a=planeNormal.x,b=planeNormal.y,c=planeNormal.z;\n\t\t\tfloat x0=point.x,y0=point.y,z0=point.z;\n\t\t\tfloat x=planePoint.x,y=planePoint.y,z=planePoint.z;\n\t\t\tfloat d=-(a*x+b*y+c*z);\n\t\t\tfloat distance=(a*x0+b*y0+c*z0+d)/sqrt(a*a+b*b+c*c);\n\t\t\treturn distance;\n\t\t}\n\t\tfloat getDepth( const in vec2 uv ) {\n\t\t\treturn texture2D( tDepth, uv ).x;\n\t\t}\n\t\tfloat getViewZ( const in float depth ) {\n\t\t\t#ifdef PERSPECTIVE_CAMERA\n\t\t\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#else\n\t\t\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#endif\n\t\t}\n\t\tvec3 getViewPosition( const in vec2 uv, const in float depth/*clip space*/, const in float clipW ) {\n\t\t\tvec4 clipPosition = vec4( ( vec3( uv, depth ) - 0.5 ) * 2.0, 1.0 );//ndc\n\t\t\tclipPosition *= clipW; //clip\n\t\t\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;//view\n\t\t}\n\t\tvec3 getViewNormal( const in vec2 uv ) {\n\t\t\treturn unpackRGBToNormal( texture2D( tNormal, uv ).xyz );\n\t\t}\n\t\tvec2 viewPositionToXY(vec3 viewPosition){\n\t\t\tvec2 xy;\n\t\t\tvec4 clip=cameraProjectionMatrix*vec4(viewPosition,1);\n\t\t\txy=clip.xy;//clip\n\t\t\tfloat clipW=clip.w;\n\t\t\txy/=clipW;//NDC\n\t\t\txy=(xy+1.)/2.;//uv\n\t\t\txy*=resolution;//screen\n\t\t\treturn xy;\n\t\t}\n\t\tvoid main(){\n\t\t\t#ifdef SELECTIVE\n\t\t\t\tfloat metalness=texture2D(tMetalness,vUv).r;\n\t\t\t\tif(metalness==0.) return;\n\t\t\t#endif\n\n\t\t\tfloat depth = getDepth( vUv );\n\t\t\tfloat viewZ = getViewZ( depth );\n\t\t\tif(-viewZ>=cameraFar) return;\n\n\t\t\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ+cameraProjectionMatrix[3][3];\n\t\t\tvec3 viewPosition=getViewPosition( vUv, depth, clipW );\n\n\t\t\tvec2 d0=gl_FragCoord.xy;\n\t\t\tvec2 d1;\n\n\t\t\tvec3 viewNormal=getViewNormal( vUv );\n\n\t\t\t#ifdef PERSPECTIVE_CAMERA\n\t\t\t\tvec3 viewIncidentDir=normalize(viewPosition);\n\t\t\t\tvec3 viewReflectDir=reflect(viewIncidentDir,viewNormal);\n\t\t\t#else\n\t\t\t\tvec3 viewIncidentDir=vec3(0,0,-1);\n\t\t\t\tvec3 viewReflectDir=reflect(viewIncidentDir,viewNormal);\n\t\t\t#endif\n\n\t\t\tfloat maxReflectRayLen=maxDistance/dot(-viewIncidentDir,viewNormal);\n\t\t\t// dot(a,b)==length(a)*length(b)*cos(theta) // https://www.mathsisfun.com/algebra/vectors-dot-product.html\n\t\t\t// if(a.isNormalized&&b.isNormalized) dot(a,b)==cos(theta)\n\t\t\t// maxDistance/maxReflectRayLen=cos(theta)\n\t\t\t// maxDistance/maxReflectRayLen==dot(a,b)\n\t\t\t// maxReflectRayLen==maxDistance/dot(a,b)\n\n\t\t\tvec3 d1viewPosition=viewPosition+viewReflectDir*maxReflectRayLen;\n\t\t\t#ifdef PERSPECTIVE_CAMERA\n\t\t\t\tif(d1viewPosition.z>-cameraNear){\n\t\t\t\t\t//https://tutorial.math.lamar.edu/Classes/CalcIII/EqnsOfLines.aspx\n\t\t\t\t\tfloat t=(-cameraNear-viewPosition.z)/viewReflectDir.z;\n\t\t\t\t\td1viewPosition=viewPosition+viewReflectDir*t;\n\t\t\t\t}\n\t\t\t#endif\n\t\t\td1=viewPositionToXY(d1viewPosition);\n\n\t\t\tfloat totalLen=length(d1-d0);\n\t\t\tfloat xLen=d1.x-d0.x;\n\t\t\tfloat yLen=d1.y-d0.y;\n\t\t\tfloat totalStep=max(abs(xLen),abs(yLen));\n\t\t\tfloat xSpan=xLen/totalStep;\n\t\t\tfloat ySpan=yLen/totalStep;\n\t\t\tfor(float i=0.;i<float(MAX_STEP);i++){\n\t\t\t\tif(i>=totalStep) break;\n\t\t\t\tvec2 xy=vec2(d0.x+i*xSpan,d0.y+i*ySpan);\n\t\t\t\tif(xy.x<0.||xy.x>resolution.x||xy.y<0.||xy.y>resolution.y) break;\n\t\t\t\tfloat s=length(xy-d0)/totalLen;\n\t\t\t\tvec2 uv=xy/resolution;\n\n\t\t\t\tfloat d = getDepth(uv);\n\t\t\t\tfloat vZ = getViewZ( d );\n\t\t\t\tif(-vZ>=cameraFar) continue;\n\t\t\t\tfloat cW = cameraProjectionMatrix[2][3] * vZ+cameraProjectionMatrix[3][3];\n\t\t\t\tvec3 vP=getViewPosition( uv, d, cW );\n\n\t\t\t\t#ifdef PERSPECTIVE_CAMERA\n\t\t\t\t\t// https://comp.nus.edu.sg/~lowkl/publications/lowk_persp_interp_techrep.pdf\n\t\t\t\t\tfloat recipVPZ=1./viewPosition.z;\n\t\t\t\t\tfloat viewReflectRayZ=1./(recipVPZ+s*(1./d1viewPosition.z-recipVPZ));\n\t\t\t\t#else\n\t\t\t\t\tfloat viewReflectRayZ=viewPosition.z+s*(d1viewPosition.z-viewPosition.z);\n\t\t\t\t#endif\n\n\t\t\t\t// if(viewReflectRayZ>vZ) continue; // will cause "npm run make-screenshot webgl_postprocessing_ssr" high probability hang.\n\t\t\t\t// https://github.com/mrdoob/three.js/pull/21539#issuecomment-821061164\n\t\t\t\tif(viewReflectRayZ<=vZ){\n\n\t\t\t\t\tbool hit;\n\t\t\t\t\t#ifdef INFINITE_THICK\n\t\t\t\t\t\thit=true;\n\t\t\t\t\t#else\n\t\t\t\t\t\tfloat away=pointToLineDistance(vP,viewPosition,d1viewPosition);\n\n\t\t\t\t\t\tfloat minThickness;\n\t\t\t\t\t\tvec2 xyNeighbor=xy;\n\t\t\t\t\t\txyNeighbor.x+=1.;\n\t\t\t\t\t\tvec2 uvNeighbor=xyNeighbor/resolution;\n\t\t\t\t\t\tvec3 vPNeighbor=getViewPosition(uvNeighbor,d,cW);\n\t\t\t\t\t\tminThickness=vPNeighbor.x-vP.x;\n\t\t\t\t\t\tminThickness*=3.;\n\t\t\t\t\t\tfloat tk=max(minThickness,thickness);\n\n\t\t\t\t\t\thit=away<=tk;\n\t\t\t\t\t#endif\n\n\t\t\t\t\tif(hit){\n\t\t\t\t\t\tvec3 vN=getViewNormal( uv );\n\t\t\t\t\t\tif(dot(viewReflectDir,vN)>=0.) continue;\n\t\t\t\t\t\tfloat distance=pointPlaneDistance(vP,viewPosition,viewNormal);\n\t\t\t\t\t\tif(distance>maxDistance) break;\n\t\t\t\t\t\tfloat op=opacity;\n\t\t\t\t\t\t#ifdef DISTANCE_ATTENUATION\n\t\t\t\t\t\t\tfloat ratio=1.-(distance/maxDistance);\n\t\t\t\t\t\t\tfloat attenuation=ratio*ratio;\n\t\t\t\t\t\t\top=opacity*attenuation;\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\t#ifdef FRESNEL\n\t\t\t\t\t\t\tfloat fresnelCoe=(dot(viewIncidentDir,viewReflectDir)+1.)/2.;\n\t\t\t\t\t\t\top*=fresnelCoe;\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\tvec4 reflectColor=texture2D(tDiffuse,uv);\n\t\t\t\t\t\tgl_FragColor.xyz=reflectColor.xyz;\n\t\t\t\t\t\tgl_FragColor.a=op;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t'},tC_defines={PERSPECTIVE_CAMERA:1},tC_uniforms={tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null}},tC_vertexShader="\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}\n\n\t",tC_fragmentShader="\n\n\t\tuniform sampler2D tDepth;\n\n\t\tuniform float cameraNear;\n\t\tuniform float cameraFar;\n\n\t\tvarying vec2 vUv;\n\n\t\t#include <packing>\n\n\t\tfloat getLinearDepth( const in vec2 uv ) {\n\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\n\t\t\t\tfloat fragCoordZ = texture2D( tDepth, uv ).x;\n\t\t\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );\n\t\t\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );\n\n\t\t\t#else\n\n\t\t\t\treturn texture2D( tDepth, uv ).x;\n\n\t\t\t#endif\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tfloat depth = getLinearDepth( vUv );\n\t\t\tfloat d = 1.0 - depth;\n\t\t\t// d=(d-.999)*1000.;\n\t\t\tgl_FragColor = vec4( vec3( d ), 1.0 );\n\n\t\t}\n\n\t",Xc={uniforms:{tDiffuse:{value:null},resolution:{value:new fe},opacity:{value:.5}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}\n\n\t",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec2 resolution;\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\t//reverse engineering from PhotoShop blur filter, then change coefficient\n\n\t\t\tvec2 texelSize = ( 1.0 / resolution );\n\n\t\t\tvec4 c=texture2D(tDiffuse,vUv);\n\n\t\t\tvec2 offset;\n\n\t\t\toffset=(vec2(-1,0))*texelSize;\n\t\t\tvec4 cl=texture2D(tDiffuse,vUv+offset);\n\n\t\t\toffset=(vec2(1,0))*texelSize;\n\t\t\tvec4 cr=texture2D(tDiffuse,vUv+offset);\n\n\t\t\toffset=(vec2(0,-1))*texelSize;\n\t\t\tvec4 cb=texture2D(tDiffuse,vUv+offset);\n\n\t\t\toffset=(vec2(0,1))*texelSize;\n\t\t\tvec4 ct=texture2D(tDiffuse,vUv+offset);\n\n\t\t\t// float coeCenter=.5;\n\t\t\t// float coeSide=.125;\n\t\t\tfloat coeCenter=.2;\n\t\t\tfloat coeSide=.2;\n\t\t\tfloat a=c.a*coeCenter+cl.a*coeSide+cr.a*coeSide+cb.a*coeSide+ct.a*coeSide;\n\t\t\tvec3 rgb=(c.rgb*c.a*coeCenter+cl.rgb*cl.a*coeSide+cr.rgb*cr.a*coeSide+cb.rgb*cb.a*coeSide+ct.rgb*ct.a*coeSide)/a;\n\t\t\tgl_FragColor=vec4(rgb,a);\n\n\t\t}\n\t"};let eH=(()=>{class i extends wn{constructor({renderer:t,scene:n,camera:r,width:s,height:o,selects:a,bouncing:l=!1,groundReflector:c}){super(),this.width=void 0!==s?s:512,this.height=void 0!==o?o:512,this.clear=!0,this.renderer=t,this.scene=n,this.camera=r,this.groundReflector=c,this.opacity=el.uniforms.opacity.value,this.output=0,this.maxDistance=el.uniforms.maxDistance.value,this.thickness=el.uniforms.thickness.value,this.tempColor=new Le,this._selects=a,this.selective=Array.isArray(this._selects),Object.defineProperty(this,"selects",{get(){return this._selects},set(u){this._selects!==u&&(this._selects=u,Array.isArray(u)?(this.selective=!0,this.ssrMaterial.defines.SELECTIVE=!0,this.ssrMaterial.needsUpdate=!0):(this.selective=!1,this.ssrMaterial.defines.SELECTIVE=!1,this.ssrMaterial.needsUpdate=!0))}}),this._bouncing=l,Object.defineProperty(this,"bouncing",{get(){return this._bouncing},set(u){this._bouncing!==u&&(this._bouncing=u,this.ssrMaterial.uniforms.tDiffuse.value=u?this.prevRenderTarget.texture:this.beautyRenderTarget.texture)}}),this.blur=!0,this._distanceAttenuation=el.defines.DISTANCE_ATTENUATION,Object.defineProperty(this,"distanceAttenuation",{get(){return this._distanceAttenuation},set(u){this._distanceAttenuation!==u&&(this._distanceAttenuation=u,this.ssrMaterial.defines.DISTANCE_ATTENUATION=u,this.ssrMaterial.needsUpdate=!0)}}),this._fresnel=el.defines.FRESNEL,Object.defineProperty(this,"fresnel",{get(){return this._fresnel},set(u){this._fresnel!==u&&(this._fresnel=u,this.ssrMaterial.defines.FRESNEL=u,this.ssrMaterial.needsUpdate=!0)}}),this._infiniteThick=el.defines.INFINITE_THICK,Object.defineProperty(this,"infiniteThick",{get(){return this._infiniteThick},set(u){this._infiniteThick!==u&&(this._infiniteThick=u,this.ssrMaterial.defines.INFINITE_THICK=u,this.ssrMaterial.needsUpdate=!0)}});const d=new rp;d.type=$_,d.minFilter=$t,d.magFilter=$t,this.beautyRenderTarget=new Gt(this.width,this.height,{minFilter:$t,magFilter:$t,depthTexture:d,depthBuffer:!0}),this.prevRenderTarget=new Gt(this.width,this.height,{minFilter:$t,magFilter:$t}),this.normalRenderTarget=new Gt(this.width,this.height,{minFilter:$t,magFilter:$t,type:mn}),this.metalnessRenderTarget=new Gt(this.width,this.height,{minFilter:$t,magFilter:$t}),this.ssrRenderTarget=new Gt(this.width,this.height,{minFilter:$t,magFilter:$t}),this.blurRenderTarget=this.ssrRenderTarget.clone(),this.blurRenderTarget2=this.ssrRenderTarget.clone(),this.ssrMaterial=new Pt({defines:Object.assign({},el.defines,{MAX_STEP:Math.sqrt(this.width*this.width+this.height*this.height)}),uniforms:gi.clone(el.uniforms),vertexShader:el.vertexShader,fragmentShader:el.fragmentShader,blending:Kt}),this.ssrMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.ssrMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.ssrMaterial.defines.SELECTIVE=this.selective,this.ssrMaterial.needsUpdate=!0,this.ssrMaterial.uniforms.tMetalness.value=this.metalnessRenderTarget.texture,this.ssrMaterial.uniforms.tDepth.value=this.beautyRenderTarget.depthTexture,this.ssrMaterial.uniforms.cameraNear.value=this.camera.near,this.ssrMaterial.uniforms.cameraFar.value=this.camera.far,this.ssrMaterial.uniforms.thickness.value=this.thickness,this.ssrMaterial.uniforms.resolution.value.set(this.width,this.height),this.ssrMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssrMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.normalMaterial=new Cp,this.normalMaterial.blending=Kt,this.metalnessOnMaterial=new $n({color:"white"}),this.metalnessOffMaterial=new $n({color:"black"}),this.blurMaterial=new Pt({defines:Object.assign({},Xc.defines),uniforms:gi.clone(Xc.uniforms),vertexShader:Xc.vertexShader,fragmentShader:Xc.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.blurMaterial.uniforms.resolution.value.set(this.width,this.height),this.blurMaterial2=new Pt({defines:Object.assign({},Xc.defines),uniforms:gi.clone(Xc.uniforms),vertexShader:Xc.vertexShader,fragmentShader:Xc.fragmentShader}),this.blurMaterial2.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.blurMaterial2.uniforms.resolution.value.set(this.width,this.height),this.depthRenderMaterial=new Pt({defines:Object.assign({},tC_defines),uniforms:gi.clone(tC_uniforms),vertexShader:tC_vertexShader,fragmentShader:tC_fragmentShader,blending:Kt}),this.depthRenderMaterial.uniforms.tDepth.value=this.beautyRenderTarget.depthTexture,this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.copyMaterial=new Pt({uniforms:gi.clone(Yr.uniforms),vertexShader:Yr.vertexShader,fragmentShader:Yr.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:Mf,blendDst:Y_,blendEquation:ws,blendSrcAlpha:Mf,blendDstAlpha:Y_,blendEquationAlpha:ws}),this.fsQuad=new xr(null),this.originalClearColor=new Le}dispose(){this.beautyRenderTarget.dispose(),this.prevRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.metalnessRenderTarget.dispose(),this.ssrRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.blurRenderTarget2.dispose(),this.normalMaterial.dispose(),this.metalnessOnMaterial.dispose(),this.metalnessOffMaterial.dispose(),this.blurMaterial.dispose(),this.blurMaterial2.dispose(),this.copyMaterial.dispose(),this.depthRenderMaterial.dispose(),this.fsQuad.dispose()}render(t,n){switch(t.setRenderTarget(this.beautyRenderTarget),t.clear(),this.groundReflector&&(this.groundReflector.visible=!1,this.groundReflector.doRender(this.renderer,this.scene,this.camera),this.groundReflector.visible=!0),t.render(this.scene,this.camera),this.groundReflector&&(this.groundReflector.visible=!1),this.renderOverride(t,this.normalMaterial,this.normalRenderTarget,0,0),this.selective&&this.renderMetalness(t,this.metalnessOnMaterial,this.metalnessRenderTarget,0,0),this.ssrMaterial.uniforms.opacity.value=this.opacity,this.ssrMaterial.uniforms.maxDistance.value=this.maxDistance,this.ssrMaterial.uniforms.thickness.value=this.thickness,this.renderPass(t,this.ssrMaterial,this.ssrRenderTarget),this.blur&&(this.renderPass(t,this.blurMaterial,this.blurRenderTarget),this.renderPass(t,this.blurMaterial2,this.blurRenderTarget2)),this.output){case i.OUTPUT.Default:this.bouncing?(this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.prevRenderTarget),this.copyMaterial.uniforms.tDiffuse.value=this.blur?this.blurRenderTarget2.texture:this.ssrRenderTarget.texture,this.copyMaterial.blending=Pa,this.renderPass(t,this.copyMaterial,this.prevRenderTarget),this.copyMaterial.uniforms.tDiffuse.value=this.prevRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n)):(this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n),this.copyMaterial.uniforms.tDiffuse.value=this.blur?this.blurRenderTarget2.texture:this.ssrRenderTarget.texture,this.copyMaterial.blending=Pa,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n));break;case i.OUTPUT.SSR:this.copyMaterial.uniforms.tDiffuse.value=this.blur?this.blurRenderTarget2.texture:this.ssrRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n),this.bouncing&&(this.copyMaterial.uniforms.tDiffuse.value=this.blur?this.blurRenderTarget2.texture:this.beautyRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.prevRenderTarget),this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=Pa,this.renderPass(t,this.copyMaterial,this.prevRenderTarget));break;case i.OUTPUT.Beauty:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Depth:this.renderPass(t,this.depthRenderMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Normal:this.copyMaterial.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Metalness:this.copyMaterial.uniforms.tDiffuse.value=this.metalnessRenderTarget.texture,this.copyMaterial.blending=Kt,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;default:console.warn("THREE.SSRPass: Unknown output type.")}}renderPass(t,n,r,s,o){this.originalClearColor.copy(t.getClearColor(this.tempColor));const a=t.getClearAlpha(this.tempColor),l=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,null!=s&&(t.setClearColor(s),t.setClearAlpha(o||0),t.clear()),this.fsQuad.material=n,this.fsQuad.render(t),t.autoClear=l,t.setClearColor(this.originalClearColor),t.setClearAlpha(a)}renderOverride(t,n,r,s,o){this.originalClearColor.copy(t.getClearColor(this.tempColor));const a=t.getClearAlpha(this.tempColor),l=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,o=n.clearAlpha||o,null!=(s=n.clearColor||s)&&(t.setClearColor(s),t.setClearAlpha(o||0),t.clear()),this.scene.overrideMaterial=n,t.render(this.scene,this.camera),this.scene.overrideMaterial=null,t.autoClear=l,t.setClearColor(this.originalClearColor),t.setClearAlpha(a)}renderMetalness(t,n,r,s,o){this.originalClearColor.copy(t.getClearColor(this.tempColor));const a=t.getClearAlpha(this.tempColor),l=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,o=n.clearAlpha||o,null!=(s=n.clearColor||s)&&(t.setClearColor(s),t.setClearAlpha(o||0),t.clear()),this.scene.traverseVisible(c=>{c._SSRPassBackupMaterial=c.material,c.material=this._selects.includes(c)?this.metalnessOnMaterial:this.metalnessOffMaterial}),t.render(this.scene,this.camera),this.scene.traverseVisible(c=>{c.material=c._SSRPassBackupMaterial}),t.autoClear=l,t.setClearColor(this.originalClearColor),t.setClearAlpha(a)}setSize(t,n){this.width=t,this.height=n,this.ssrMaterial.defines.MAX_STEP=Math.sqrt(t*t+n*n),this.ssrMaterial.needsUpdate=!0,this.beautyRenderTarget.setSize(t,n),this.prevRenderTarget.setSize(t,n),this.ssrRenderTarget.setSize(t,n),this.normalRenderTarget.setSize(t,n),this.metalnessRenderTarget.setSize(t,n),this.blurRenderTarget.setSize(t,n),this.blurRenderTarget2.setSize(t,n),this.ssrMaterial.uniforms.resolution.value.set(t,n),this.ssrMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssrMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.blurMaterial.uniforms.resolution.value.set(t,n),this.blurMaterial2.uniforms.resolution.value.set(t,n)}}return i.OUTPUT={Default:0,SSR:1,Beauty:3,Depth:4,Normal:5,Metalness:7},i})();class hh extends Yi{getType(){return eH}set width(e){this._objRef&&(this._objRef.width=e)}get width(){return this._objRef?.width}set height(e){this._objRef&&(this._objRef.height=e)}get height(){return this._objRef?.height}set clear(e){this._objRef&&(this._objRef.clear=e)}get clear(){return this._objRef?.clear}set renderer(e){this._objRef&&(this._objRef.renderer=e)}get renderer(){return this._objRef?.renderer}set scene(e){this._objRef&&(this._objRef.scene=e)}get scene(){return this._objRef?.scene}set camera(e){this._objRef&&(this._objRef.camera=e)}get camera(){return this._objRef?.camera}set groundReflector(e){this._objRef&&(this._objRef.groundReflector=e)}get groundReflector(){return this._objRef?.groundReflector}set opacity(e){this._objRef&&(this._objRef.opacity=e)}get opacity(){return this._objRef?.opacity}set output(e){this._objRef&&(this._objRef.output=e)}get output(){return this._objRef?.output}set maxDistance(e){this._objRef&&(this._objRef.maxDistance=e)}get maxDistance(){return this._objRef?.maxDistance}set thickness(e){this._objRef&&(this._objRef.thickness=e)}get thickness(){return this._objRef?.thickness}set tempColor(e){this._objRef&&(this._objRef.tempColor=Ye(this._objRef.tempColor,e))}get tempColor(){return this._objRef?.tempColor}set selective(e){this._objRef&&(this._objRef.selective=e)}get selective(){return this._objRef?.selective}set blur(e){this._objRef&&(this._objRef.blur=e)}get blur(){return this._objRef?.blur}set thickTolerance(e){this._objRef&&(this._objRef.thickTolerance=e)}get thickTolerance(){return this._objRef?.thickTolerance}set beautyRenderTarget(e){this._objRef&&(this._objRef.beautyRenderTarget=e)}get beautyRenderTarget(){return this._objRef?.beautyRenderTarget}set prevRenderTarget(e){this._objRef&&(this._objRef.prevRenderTarget=e)}get prevRenderTarget(){return this._objRef?.prevRenderTarget}set normalRenderTarget(e){this._objRef&&(this._objRef.normalRenderTarget=e)}get normalRenderTarget(){return this._objRef?.normalRenderTarget}set metalnessRenderTarget(e){this._objRef&&(this._objRef.metalnessRenderTarget=e)}get metalnessRenderTarget(){return this._objRef?.metalnessRenderTarget}set ssrRenderTarget(e){this._objRef&&(this._objRef.ssrRenderTarget=e)}get ssrRenderTarget(){return this._objRef?.ssrRenderTarget}set blurRenderTarget(e){this._objRef&&(this._objRef.blurRenderTarget=e)}get blurRenderTarget(){return this._objRef?.blurRenderTarget}set blurRenderTarget2(e){this._objRef&&(this._objRef.blurRenderTarget2=e)}get blurRenderTarget2(){return this._objRef?.blurRenderTarget2}set ssrMaterial(e){this._objRef&&(this._objRef.ssrMaterial=e)}get ssrMaterial(){return this._objRef?.ssrMaterial}set normalMaterial(e){this._objRef&&(this._objRef.normalMaterial=e)}get normalMaterial(){return this._objRef?.normalMaterial}set metalnessOnMaterial(e){this._objRef&&(this._objRef.metalnessOnMaterial=e)}get metalnessOnMaterial(){return this._objRef?.metalnessOnMaterial}set metalnessOffMaterial(e){this._objRef&&(this._objRef.metalnessOffMaterial=e)}get metalnessOffMaterial(){return this._objRef?.metalnessOffMaterial}set blurMaterial(e){this._objRef&&(this._objRef.blurMaterial=e)}get blurMaterial(){return this._objRef?.blurMaterial}set blurMaterial2(e){this._objRef&&(this._objRef.blurMaterial2=e)}get blurMaterial2(){return this._objRef?.blurMaterial2}set depthRenderMaterial(e){this._objRef&&(this._objRef.depthRenderMaterial=e)}get depthRenderMaterial(){return this._objRef?.depthRenderMaterial}set copyMaterial(e){this._objRef&&(this._objRef.copyMaterial=e)}get copyMaterial(){return this._objRef?.copyMaterial}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}set originalClearColor(e){this._objRef&&(this._objRef.originalClearColor=Ye(this._objRef.originalClearColor,e))}get originalClearColor(){return this._objRef?.originalClearColor}set dispose(e){this._objRef&&(this._objRef.dispose=e)}get dispose(){return this._objRef?.dispose}set renderPass(e){this._objRef&&(this._objRef.renderPass=e)}get renderPass(){return this._objRef?.renderPass}set renderOverride(e){this._objRef&&(this._objRef.renderOverride=e)}get renderOverride(){return this._objRef?.renderOverride}set renderMetalness(e){this._objRef&&(this._objRef.renderMetalness=e)}get renderMetalness(){return this._objRef?.renderMetalness}}hh.OUTPUT=eH.OUTPUT,hh.\u0275fac=function(){let i;return function(t){return(i||(i=le(hh)))(t||hh)}}(),hh.\u0275cmp=$({type:hh,selectors:[["th-sSRPass"]],inputs:{width:"width",height:"height",clear:"clear",renderer:"renderer",scene:"scene",camera:"camera",groundReflector:"groundReflector",opacity:"opacity",output:"output",maxDistance:"maxDistance",thickness:"thickness",tempColor:"tempColor",selective:"selective",blur:"blur",thickTolerance:"thickTolerance",beautyRenderTarget:"beautyRenderTarget",prevRenderTarget:"prevRenderTarget",normalRenderTarget:"normalRenderTarget",metalnessRenderTarget:"metalnessRenderTarget",ssrRenderTarget:"ssrRenderTarget",blurRenderTarget:"blurRenderTarget",blurRenderTarget2:"blurRenderTarget2",ssrMaterial:"ssrMaterial",normalMaterial:"normalMaterial",metalnessOnMaterial:"metalnessOnMaterial",metalnessOffMaterial:"metalnessOffMaterial",blurMaterial:"blurMaterial",blurMaterial2:"blurMaterial2",depthRenderMaterial:"depthRenderMaterial",copyMaterial:"copyMaterial",fsQuad:"fsQuad",originalClearColor:"originalClearColor",dispose:"dispose",renderPass:"renderPass",renderOverride:"renderOverride",renderMetalness:"renderMetalness"},features:[ne([{provide:Li,useExisting:ae(()=>hh)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class fh extends Ts{getType(){return K4}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set aspect(e){this._objRef&&(this._objRef.aspect=e)}get aspect(){return this._objRef?.aspect}set eyeSep(e){this._objRef&&(this._objRef.eyeSep=e)}get eyeSep(){return this._objRef?.eyeSep}set cameraL(e){this._objRef&&(this._objRef.cameraL=e)}get cameraL(){return this._objRef?.cameraL}set cameraR(e){this._objRef&&(this._objRef.cameraR=e)}get cameraR(){return this._objRef?.cameraR}}fh.\u0275fac=function(){let i;return function(t){return(i||(i=le(fh)))(t||fh)}}(),fh.\u0275cmp=$({type:fh,selectors:[["th-stereoCamera"]],inputs:{type:"type",aspect:"aspect",eyeSep:"eyeSep",cameraL:"cameraL",cameraR:"cameraR"},features:[ne([{provide:We,useExisting:ae(()=>fh)},{provide:Ts,useExisting:ae(()=>fh)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class R0e extends $G{constructor(e,t,n,r){super(e,t,n,r),this.sampleLevel=0,this.accumulate=!1}render(e,t,n,r){if(!1===this.accumulate)return super.render(e,t,n,r),void(this.accumulateIndex=-1);const s=I0e[5];void 0===this.sampleRenderTarget&&(this.sampleRenderTarget=new Gt(n.width,n.height,this.params),this.sampleRenderTarget.texture.name="TAARenderPass.sample"),void 0===this.holdRenderTarget&&(this.holdRenderTarget=new Gt(n.width,n.height,this.params),this.holdRenderTarget.texture.name="TAARenderPass.hold"),-1===this.accumulateIndex&&(super.render(e,this.holdRenderTarget,n,r),this.accumulateIndex=0);const o=e.autoClear;e.autoClear=!1;const a=1/s.length;if(this.accumulateIndex>=0&&this.accumulateIndex<s.length){this.copyUniforms.opacity.value=a,this.copyUniforms.tDiffuse.value=t.texture;const c=Math.pow(2,this.sampleLevel);for(let d=0;d<c;d++){const h=s[this.accumulateIndex];if(this.camera.setViewOffset&&this.camera.setViewOffset(n.width,n.height,.0625*h[0],.0625*h[1],n.width,n.height),e.setRenderTarget(t),e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(this.sampleRenderTarget),0===this.accumulateIndex&&e.clear(),this.fsQuad.render(e),this.accumulateIndex++,this.accumulateIndex>=s.length)break}this.camera.clearViewOffset&&this.camera.clearViewOffset()}const l=this.accumulateIndex*a;l>0&&(this.copyUniforms.opacity.value=1,this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture,e.setRenderTarget(t),e.clear(),this.fsQuad.render(e)),l<1&&(this.copyUniforms.opacity.value=1-l,this.copyUniforms.tDiffuse.value=this.holdRenderTarget.texture,e.setRenderTarget(t),0===l&&e.clear(),this.fsQuad.render(e)),e.autoClear=o}dispose(){super.dispose(),void 0!==this.sampleRenderTarget&&this.sampleRenderTarget.dispose(),void 0!==this.holdRenderTarget&&this.holdRenderTarget.dispose()}}const I0e=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]];class gg extends dh{getType(){return R0e}set accumulate(e){this._objRef&&(this._objRef.accumulate=e)}get accumulate(){return this._objRef?.accumulate}}gg.\u0275fac=function(){let i;return function(t){return(i||(i=le(gg)))(t||gg)}}(),gg.\u0275cmp=$({type:gg,selectors:[["th-tAARenderPass"]],inputs:{accumulate:"accumulate"},features:[ne([{provide:Li,useExisting:ae(()=>gg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class P0e extends Mt{constructor(e=50,t=10,n=!0,r=!0,s=!0,o=!0,a=!0){const l=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,3,16,17,18,7,19,20,21,11,22,23,24,15,25,26,27,18,28,29,30,21,31,32,33,24,34,35,36,27,37,38,39,30,40,41,0,33,42,43,4,36,44,45,8,39,46,47,12,12,13,14,15,48,49,50,51,52,53,54,55,56,57,58,59,15,25,26,27,51,60,61,62,55,63,64,65,59,66,67,68,27,37,38,39,62,69,70,71,65,72,73,74,68,75,76,77,39,46,47,12,71,78,79,48,74,80,81,52,77,82,83,56,56,57,58,59,84,85,86,87,88,89,90,91,92,93,94,95,59,66,67,68,87,96,97,98,91,99,100,101,95,102,103,104,68,75,76,77,98,105,106,107,101,108,109,110,104,111,112,113,77,82,83,56,107,114,115,84,110,116,117,88,113,118,119,92,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,123,136,137,120,127,138,139,124,131,140,141,128,135,142,143,132,132,133,134,135,144,145,146,147,148,149,150,151,68,152,153,154,135,142,143,132,147,155,156,144,151,157,158,148,154,159,160,68,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,164,177,178,161,168,179,180,165,172,181,182,169,176,183,184,173,173,174,175,176,185,186,187,188,189,190,191,192,193,194,195,196,176,183,184,173,188,197,198,185,192,199,200,189,196,201,202,193,203,203,203,203,204,205,206,207,208,208,208,208,209,210,211,212,203,203,203,203,207,213,214,215,208,208,208,208,212,216,217,218,203,203,203,203,215,219,220,221,208,208,208,208,218,222,223,224,203,203,203,203,221,225,226,204,208,208,208,208,224,227,228,209,209,210,211,212,229,230,231,232,233,234,235,236,237,238,239,240,212,216,217,218,232,241,242,243,236,244,245,246,240,247,248,249,218,222,223,224,243,250,251,252,246,253,254,255,249,256,257,258,224,227,228,209,252,259,260,229,255,261,262,233,258,263,264,237,265,265,265,265,266,267,268,269,270,271,272,273,92,119,118,113,265,265,265,265,269,274,275,276,273,277,278,279,113,112,111,104,265,265,265,265,276,280,281,282,279,283,284,285,104,103,102,95,265,265,265,265,282,286,287,266,285,288,289,270,95,94,93,92],c=[1.4,0,2.4,1.4,-.784,2.4,.784,-1.4,2.4,0,-1.4,2.4,1.3375,0,2.53125,1.3375,-.749,2.53125,.749,-1.3375,2.53125,0,-1.3375,2.53125,1.4375,0,2.53125,1.4375,-.805,2.53125,.805,-1.4375,2.53125,0,-1.4375,2.53125,1.5,0,2.4,1.5,-.84,2.4,.84,-1.5,2.4,0,-1.5,2.4,-.784,-1.4,2.4,-1.4,-.784,2.4,-1.4,0,2.4,-.749,-1.3375,2.53125,-1.3375,-.749,2.53125,-1.3375,0,2.53125,-.805,-1.4375,2.53125,-1.4375,-.805,2.53125,-1.4375,0,2.53125,-.84,-1.5,2.4,-1.5,-.84,2.4,-1.5,0,2.4,-1.4,.784,2.4,-.784,1.4,2.4,0,1.4,2.4,-1.3375,.749,2.53125,-.749,1.3375,2.53125,0,1.3375,2.53125,-1.4375,.805,2.53125,-.805,1.4375,2.53125,0,1.4375,2.53125,-1.5,.84,2.4,-.84,1.5,2.4,0,1.5,2.4,.784,1.4,2.4,1.4,.784,2.4,.749,1.3375,2.53125,1.3375,.749,2.53125,.805,1.4375,2.53125,1.4375,.805,2.53125,.84,1.5,2.4,1.5,.84,2.4,1.75,0,1.875,1.75,-.98,1.875,.98,-1.75,1.875,0,-1.75,1.875,2,0,1.35,2,-1.12,1.35,1.12,-2,1.35,0,-2,1.35,2,0,.9,2,-1.12,.9,1.12,-2,.9,0,-2,.9,-.98,-1.75,1.875,-1.75,-.98,1.875,-1.75,0,1.875,-1.12,-2,1.35,-2,-1.12,1.35,-2,0,1.35,-1.12,-2,.9,-2,-1.12,.9,-2,0,.9,-1.75,.98,1.875,-.98,1.75,1.875,0,1.75,1.875,-2,1.12,1.35,-1.12,2,1.35,0,2,1.35,-2,1.12,.9,-1.12,2,.9,0,2,.9,.98,1.75,1.875,1.75,.98,1.875,1.12,2,1.35,2,1.12,1.35,1.12,2,.9,2,1.12,.9,2,0,.45,2,-1.12,.45,1.12,-2,.45,0,-2,.45,1.5,0,.225,1.5,-.84,.225,.84,-1.5,.225,0,-1.5,.225,1.5,0,.15,1.5,-.84,.15,.84,-1.5,.15,0,-1.5,.15,-1.12,-2,.45,-2,-1.12,.45,-2,0,.45,-.84,-1.5,.225,-1.5,-.84,.225,-1.5,0,.225,-.84,-1.5,.15,-1.5,-.84,.15,-1.5,0,.15,-2,1.12,.45,-1.12,2,.45,0,2,.45,-1.5,.84,.225,-.84,1.5,.225,0,1.5,.225,-1.5,.84,.15,-.84,1.5,.15,0,1.5,.15,1.12,2,.45,2,1.12,.45,.84,1.5,.225,1.5,.84,.225,.84,1.5,.15,1.5,.84,.15,-1.6,0,2.025,-1.6,-.3,2.025,-1.5,-.3,2.25,-1.5,0,2.25,-2.3,0,2.025,-2.3,-.3,2.025,-2.5,-.3,2.25,-2.5,0,2.25,-2.7,0,2.025,-2.7,-.3,2.025,-3,-.3,2.25,-3,0,2.25,-2.7,0,1.8,-2.7,-.3,1.8,-3,-.3,1.8,-3,0,1.8,-1.5,.3,2.25,-1.6,.3,2.025,-2.5,.3,2.25,-2.3,.3,2.025,-3,.3,2.25,-2.7,.3,2.025,-3,.3,1.8,-2.7,.3,1.8,-2.7,0,1.575,-2.7,-.3,1.575,-3,-.3,1.35,-3,0,1.35,-2.5,0,1.125,-2.5,-.3,1.125,-2.65,-.3,.9375,-2.65,0,.9375,-2,-.3,.9,-1.9,-.3,.6,-1.9,0,.6,-3,.3,1.35,-2.7,.3,1.575,-2.65,.3,.9375,-2.5,.3,1.125,-1.9,.3,.6,-2,.3,.9,1.7,0,1.425,1.7,-.66,1.425,1.7,-.66,.6,1.7,0,.6,2.6,0,1.425,2.6,-.66,1.425,3.1,-.66,.825,3.1,0,.825,2.3,0,2.1,2.3,-.25,2.1,2.4,-.25,2.025,2.4,0,2.025,2.7,0,2.4,2.7,-.25,2.4,3.3,-.25,2.4,3.3,0,2.4,1.7,.66,.6,1.7,.66,1.425,3.1,.66,.825,2.6,.66,1.425,2.4,.25,2.025,2.3,.25,2.1,3.3,.25,2.4,2.7,.25,2.4,2.8,0,2.475,2.8,-.25,2.475,3.525,-.25,2.49375,3.525,0,2.49375,2.9,0,2.475,2.9,-.15,2.475,3.45,-.15,2.5125,3.45,0,2.5125,2.8,0,2.4,2.8,-.15,2.4,3.2,-.15,2.4,3.2,0,2.4,3.525,.25,2.49375,2.8,.25,2.475,3.45,.15,2.5125,2.9,.15,2.475,3.2,.15,2.4,2.8,.15,2.4,0,0,3.15,.8,0,3.15,.8,-.45,3.15,.45,-.8,3.15,0,-.8,3.15,0,0,2.85,.2,0,2.7,.2,-.112,2.7,.112,-.2,2.7,0,-.2,2.7,-.45,-.8,3.15,-.8,-.45,3.15,-.8,0,3.15,-.112,-.2,2.7,-.2,-.112,2.7,-.2,0,2.7,-.8,.45,3.15,-.45,.8,3.15,0,.8,3.15,-.2,.112,2.7,-.112,.2,2.7,0,.2,2.7,.45,.8,3.15,.8,.45,3.15,.112,.2,2.7,.2,.112,2.7,.4,0,2.55,.4,-.224,2.55,.224,-.4,2.55,0,-.4,2.55,1.3,0,2.55,1.3,-.728,2.55,.728,-1.3,2.55,0,-1.3,2.55,1.3,0,2.4,1.3,-.728,2.4,.728,-1.3,2.4,0,-1.3,2.4,-.224,-.4,2.55,-.4,-.224,2.55,-.4,0,2.55,-.728,-1.3,2.55,-1.3,-.728,2.55,-1.3,0,2.55,-.728,-1.3,2.4,-1.3,-.728,2.4,-1.3,0,2.4,-.4,.224,2.55,-.224,.4,2.55,0,.4,2.55,-1.3,.728,2.55,-.728,1.3,2.55,0,1.3,2.55,-1.3,.728,2.4,-.728,1.3,2.4,0,1.3,2.4,.224,.4,2.55,.4,.224,2.55,.728,1.3,2.55,1.3,.728,2.55,.728,1.3,2.4,1.3,.728,2.4,0,0,0,1.425,0,0,1.425,.798,0,.798,1.425,0,0,1.425,0,1.5,0,.075,1.5,.84,.075,.84,1.5,.075,0,1.5,.075,-.798,1.425,0,-1.425,.798,0,-1.425,0,0,-.84,1.5,.075,-1.5,.84,.075,-1.5,0,.075,-1.425,-.798,0,-.798,-1.425,0,0,-1.425,0,-1.5,-.84,.075,-.84,-1.5,.075,0,-1.5,.075,.798,-1.425,0,1.425,-.798,0,.84,-1.5,.075,1.5,-.84,.075];super(),t=Math.max(2,Math.floor(t));const h=3.15*(a?1:1.3)/2,f=e/h;let m=n?(8*t-4)*t:0;m+=r?(16*t-4)*t:0,m+=s?40*t*t:0;const _=new Uint32Array(3*m);let g=n?4:0;g+=r?8:0,g+=s?20:0,g*=(t+1)*(t+1);const p=new Float32Array(3*g),v=new Float32Array(3*g),b=new Float32Array(2*g),y=new Qe;y.set(-1,3,-3,1,3,-6,3,0,-3,3,0,0,1,0,0,0);const x=[],w=[],E=[],S=[],C=[],T=[],k=[],U=[],L=[],j=new R;let H,B,V,O,Q=0,oe=0;const be=new R,de=new Qe,X=new Qe,Y=new ii,re=new ii,J=new ii,D=new ii,ue=new R,Ee=new R,me=y.clone();me.transpose();const qe=(ht,xt,N)=>!(p[3*ht]===p[3*xt]&&p[3*ht+1]===p[3*xt+1]&&p[3*ht+2]===p[3*xt+2]||p[3*ht]===p[3*N]&&p[3*ht+1]===p[3*N+1]&&p[3*ht+2]===p[3*N+2]||p[3*xt]===p[3*N]&&p[3*xt+1]===p[3*N+1]&&p[3*xt+2]===p[3*N+2]);for(let ht=0;ht<3;ht++)T[ht]=new Qe;const we=n?32:28,Se=t+1;let it=0,Xe=0,At=0,yt=0,lt=0;for(let ht=s?0:20;ht<we;ht++)if(r||ht<20||ht>=28){for(let xt=0;xt<3;xt++){for(let N=0;N<4;N++)for(let F=0;F<4;F++)x[4*F+N]=c[3*l[16*ht+4*N+F]+xt],o&&ht>=20&&ht<28&&2!==xt&&(x[4*F+N]*=1.077),!a&&2===xt&&(x[4*F+N]*=1.3);de.set(x[0],x[1],x[2],x[3],x[4],x[5],x[6],x[7],x[8],x[9],x[10],x[11],x[12],x[13],x[14],x[15]),X.multiplyMatrices(de,y),T[xt].multiplyMatrices(me,X)}for(let xt=0;xt<=t;xt++){const N=xt/t;for(let F=0;F<=t;F++){const Ae=F/t;for(O=4,B=V=1;O--;)w[O]=B,E[O]=V,B*=N,V*=Ae,3===O?(S[O]=C[O]=0,Q=oe=1):(S[O]=Q*(3-O),C[O]=oe*(3-O),Q*=N,oe*=Ae);Y.fromArray(w),re.fromArray(E),J.fromArray(S),D.fromArray(C);for(let ke=0;ke<3;ke++)H=Y.clone(),H.applyMatrix4(T[ke]),k[ke]=H.dot(re),H=J.clone(),H.applyMatrix4(T[ke]),U[ke]=H.dot(re),H=Y.clone(),H.applyMatrix4(T[ke]),L[ke]=H.dot(D);ue.fromArray(U),Ee.fromArray(L),j.crossVectors(Ee,ue),j.normalize(),0===k[0]&&0===k[1]?be.set(0,k[2]>h?1:-1,0):be.set(j.x,j.z,-j.y),p[Xe++]=f*k[0],p[Xe++]=f*(k[2]-h),p[Xe++]=-f*k[1],v[At++]=be.x,v[At++]=be.y,v[At++]=be.z,b[yt++]=1-Ae,b[yt++]=1-N}}for(let xt=0;xt<t;xt++)for(let N=0;N<t;N++){const F=it*Se*Se+xt*Se+N,Ae=F+1,ke=Ae+Se,Ue=F+Se;qe(F,Ae,ke)&&(_[lt++]=F,_[lt++]=Ae,_[lt++]=ke),qe(F,ke,Ue)&&(_[lt++]=F,_[lt++]=ke,_[lt++]=Ue)}it++}this.setIndex(new Mi(_,1)),this.setAttribute("position",new Mi(p,3)),this.setAttribute("normal",new Mi(v,3)),this.setAttribute("uv",new Mi(b,2)),this.computeBoundingSphere()}}class _g extends Rt{getType(){return P0e}}_g.\u0275fac=function(){let i;return function(t){return(i||(i=le(_g)))(t||_g)}}(),_g.\u0275cmp=$({type:_g,selectors:[["th-teapotGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>_g)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class bg extends Ka{getType(){return yp}get type(){return this._objRef?.type}}bg.\u0275fac=function(){let i;return function(t){return(i||(i=le(bg)))(t||bg)}}(),bg.\u0275cmp=$({type:bg,selectors:[["th-tetrahedronGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>bg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class L0e extends cu{constructor(e,t={}){const n=t.font;if(void 0===n)super();else{const r=n.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),super(r,t)}this.type="TextGeometry"}}class vg extends $u{getType(){return L0e}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}}vg.\u0275fac=function(){let i;return function(t){return(i||(i=le(vg)))(t||vg)}}(),vg.\u0275cmp=$({type:vg,selectors:[["th-textGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>vg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class O0e extends wn{constructor(e,t){super();const n=Yr;this.map=e,this.opacity=void 0!==t?t:1,this.uniforms=gi.clone(n.uniforms),this.material=new Pt({uniforms:this.uniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,depthTest:!1,depthWrite:!1}),this.needsSwap=!1,this.fsQuad=new xr(null)}render(e,t,n){const r=e.autoClear;e.autoClear=!1,this.fsQuad.material=this.material,this.uniforms.opacity.value=this.opacity,this.uniforms.tDiffuse.value=this.map,this.material.transparent=this.opacity<1,e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(),this.fsQuad.render(e),e.autoClear=r}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class Ag extends Yi{getType(){return O0e}set map(e){this._objRef&&(this._objRef.map=e)}get map(){return this._objRef?.map}set opacity(e){this._objRef&&(this._objRef.opacity=e)}get opacity(){return this._objRef?.opacity}set uniforms(e){this._objRef&&Object.assign(this._objRef.uniforms,e)}get uniforms(){return this._objRef?.uniforms}set material(e){this._objRef&&(this._objRef.material=e)}get material(){return this._objRef?.material}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}}Ag.\u0275fac=function(){let i;return function(t){return(i||(i=le(Ag)))(t||Ag)}}(),Ag.\u0275cmp=$({type:Ag,selectors:[["th-texturePass"]],inputs:{map:"map",opacity:"opacity",uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[ne([{provide:Li,useExisting:ae(()=>Ag)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class yg extends Rt{getType(){return la}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}}yg.\u0275fac=function(){let i;return function(t){return(i||(i=le(yg)))(t||yg)}}(),yg.\u0275cmp=$({type:yg,selectors:[["th-torusGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>yg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class xg extends Rt{getType(){return xp}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}}xg.\u0275fac=function(){let i;return function(t){return(i||(i=le(xg)))(t||xg)}}(),xg.\u0275cmp=$({type:xg,selectors:[["th-torusKnotGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>xg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const AD={type:"change"},yD={type:"start"},xD={type:"end"};class V0e extends as{constructor(e,t){super();const n=this;this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:Zs.ROTATE,MIDDLE:Zs.DOLLY,RIGHT:Zs.PAN},this.target=new R;const s=1e-6,o=new R;let a=1,l=-1,c=-1,d=0,u=0,h=0;const f=new R,m=new fe,_=new fe,g=new R,p=new fe,v=new fe,b=new fe,y=new fe,x=[],w={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const D=n.domElement.getBoundingClientRect(),ue=n.domElement.ownerDocument.documentElement;n.screen.left=D.left+window.pageXOffset-ue.clientLeft,n.screen.top=D.top+window.pageYOffset-ue.clientTop,n.screen.width=D.width,n.screen.height=D.height};const E=function(){const D=new fe;return function(Ee,me){return D.set((Ee-n.screen.left)/n.screen.width,(me-n.screen.top)/n.screen.height),D}}(),S=function(){const D=new fe;return function(Ee,me){return D.set((Ee-.5*n.screen.width-n.screen.left)/(.5*n.screen.width),(n.screen.height+2*(n.screen.top-me))/n.screen.width),D}}();function C(D){!1!==n.enabled&&(0===x.length&&(n.domElement.setPointerCapture(D.pointerId),n.domElement.addEventListener("pointermove",T),n.domElement.addEventListener("pointerup",k)),function X(D){x.push(D)}(D),"touch"===D.pointerType?function Q(D){if(1===(re(D),x.length))l=3,_.copy(S(x[0].pageX,x[0].pageY)),m.copy(_);else{l=4;const ue=x[0].pageX-x[1].pageX,Ee=x[0].pageY-x[1].pageY;u=d=Math.sqrt(ue*ue+Ee*Ee),b.copy(E((x[0].pageX+x[1].pageX)/2,(x[0].pageY+x[1].pageY)/2)),y.copy(b)}n.dispatchEvent(yD)}(D):function H(D){if(-1===l)switch(D.button){case n.mouseButtons.LEFT:l=0;break;case n.mouseButtons.MIDDLE:l=1;break;case n.mouseButtons.RIGHT:l=2}const ue=-1!==c?c:l;0!==ue||n.noRotate?1!==ue||n.noZoom?2===ue&&!n.noPan&&(b.copy(E(D.pageX,D.pageY)),y.copy(b)):(p.copy(E(D.pageX,D.pageY)),v.copy(p)):(_.copy(S(D.pageX,D.pageY)),m.copy(_)),n.dispatchEvent(yD)}(D))}function T(D){!1!==n.enabled&&("touch"===D.pointerType?function oe(D){if(1===(re(D),x.length))m.copy(_),_.copy(S(D.pageX,D.pageY));else{const ue=function J(D){return w[(D.pointerId===x[0].pointerId?x[1]:x[0]).pointerId]}(D),Ee=D.pageX-ue.x,me=D.pageY-ue.y;u=Math.sqrt(Ee*Ee+me*me),y.copy(E((D.pageX+ue.x)/2,(D.pageY+ue.y)/2))}}(D):function B(D){const ue=-1!==c?c:l;0!==ue||n.noRotate?1!==ue||n.noZoom?2===ue&&!n.noPan&&y.copy(E(D.pageX,D.pageY)):v.copy(E(D.pageX,D.pageY)):(m.copy(_),_.copy(S(D.pageX,D.pageY)))}(D))}function k(D){!1!==n.enabled&&("touch"===D.pointerType?function be(D){switch(x.length){case 0:l=-1;break;case 1:l=3,_.copy(S(D.pageX,D.pageY)),m.copy(_);break;case 2:l=4;for(let ue=0;ue<x.length;ue++)if(x[ue].pointerId!==D.pointerId){const Ee=w[x[ue].pointerId];_.copy(S(Ee.x,Ee.y)),m.copy(_);break}}n.dispatchEvent(xD)}(D):function V(){l=-1,n.dispatchEvent(xD)}(),Y(D),0===x.length&&(n.domElement.releasePointerCapture(D.pointerId),n.domElement.removeEventListener("pointermove",T),n.domElement.removeEventListener("pointerup",k)))}function U(D){Y(D)}function L(D){!1!==n.enabled&&(window.removeEventListener("keydown",L),-1===c&&(D.code!==n.keys[0]||n.noRotate?D.code!==n.keys[1]||n.noZoom?D.code===n.keys[2]&&!n.noPan&&(c=2):c=1:c=0))}function j(){!1!==n.enabled&&(c=-1,window.addEventListener("keydown",L))}function O(D){if(!1!==n.enabled&&!0!==n.noZoom){switch(D.preventDefault(),D.deltaMode){case 2:p.y-=.025*D.deltaY;break;case 1:p.y-=.01*D.deltaY;break;default:p.y-=25e-5*D.deltaY}n.dispatchEvent(yD),n.dispatchEvent(xD)}}function de(D){!1!==n.enabled&&D.preventDefault()}function Y(D){delete w[D.pointerId];for(let ue=0;ue<x.length;ue++)if(x[ue].pointerId==D.pointerId)return void x.splice(ue,1)}function re(D){let ue=w[D.pointerId];void 0===ue&&(ue=new fe,w[D.pointerId]=ue),ue.set(D.pageX,D.pageY)}this.rotateCamera=function(){const D=new R,ue=new xi,Ee=new R,me=new R,qe=new R,Me=new R;return function(){Me.set(_.x-m.x,_.y-m.y,0);let Se=Me.length();Se?(f.copy(n.object.position).sub(n.target),Ee.copy(f).normalize(),me.copy(n.object.up).normalize(),qe.crossVectors(me,Ee).normalize(),me.setLength(_.y-m.y),qe.setLength(_.x-m.x),Me.copy(me.add(qe)),D.crossVectors(Me,f).normalize(),Se*=n.rotateSpeed,ue.setFromAxisAngle(D,Se),f.applyQuaternion(ue),n.object.up.applyQuaternion(ue),g.copy(D),h=Se):!n.staticMoving&&h&&(h*=Math.sqrt(1-n.dynamicDampingFactor),f.copy(n.object.position).sub(n.target),ue.setFromAxisAngle(g,h),f.applyQuaternion(ue),n.object.up.applyQuaternion(ue)),m.copy(_)}}(),this.zoomCamera=function(){let D;4===l?(D=d/u,d=u,n.object.isPerspectiveCamera?f.multiplyScalar(D):n.object.isOrthographicCamera?(n.object.zoom=ft.clamp(n.object.zoom/D,n.minZoom,n.maxZoom),a!==n.object.zoom&&n.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(D=1+(v.y-p.y)*n.zoomSpeed,1!==D&&D>0&&(n.object.isPerspectiveCamera?f.multiplyScalar(D):n.object.isOrthographicCamera?(n.object.zoom=ft.clamp(n.object.zoom/D,n.minZoom,n.maxZoom),a!==n.object.zoom&&n.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),n.staticMoving?p.copy(v):p.y+=(v.y-p.y)*this.dynamicDampingFactor)},this.panCamera=function(){const D=new fe,ue=new R,Ee=new R;return function(){if(D.copy(y).sub(b),D.lengthSq()){if(n.object.isOrthographicCamera){const Me=(n.object.top-n.object.bottom)/n.object.zoom/n.domElement.clientWidth;D.x*=(n.object.right-n.object.left)/n.object.zoom/n.domElement.clientWidth,D.y*=Me}D.multiplyScalar(f.length()*n.panSpeed),Ee.copy(f).cross(n.object.up).setLength(D.x),Ee.add(ue.copy(n.object.up).setLength(D.y)),n.object.position.add(Ee),n.target.add(Ee),n.staticMoving?b.copy(y):b.add(D.subVectors(y,b).multiplyScalar(n.dynamicDampingFactor))}}}(),this.checkDistances=function(){(!n.noZoom||!n.noPan)&&(f.lengthSq()>n.maxDistance*n.maxDistance&&(n.object.position.addVectors(n.target,f.setLength(n.maxDistance)),p.copy(v)),f.lengthSq()<n.minDistance*n.minDistance&&(n.object.position.addVectors(n.target,f.setLength(n.minDistance)),p.copy(v)))},this.update=function(){f.subVectors(n.object.position,n.target),n.noRotate||n.rotateCamera(),n.noZoom||n.zoomCamera(),n.noPan||n.panCamera(),n.object.position.addVectors(n.target,f),n.object.isPerspectiveCamera?(n.checkDistances(),n.object.lookAt(n.target),o.distanceToSquared(n.object.position)>s&&(n.dispatchEvent(AD),o.copy(n.object.position))):n.object.isOrthographicCamera?(n.object.lookAt(n.target),(o.distanceToSquared(n.object.position)>s||a!==n.object.zoom)&&(n.dispatchEvent(AD),o.copy(n.object.position),a=n.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){l=-1,c=-1,n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.up.copy(n.up0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),f.subVectors(n.object.position,n.target),n.object.lookAt(n.target),n.dispatchEvent(AD),o.copy(n.object.position),a=n.object.zoom},this.dispose=function(){n.domElement.removeEventListener("contextmenu",de),n.domElement.removeEventListener("pointerdown",C),n.domElement.removeEventListener("pointercancel",U),n.domElement.removeEventListener("wheel",O),n.domElement.removeEventListener("pointermove",T),n.domElement.removeEventListener("pointerup",k),window.removeEventListener("keydown",L),window.removeEventListener("keyup",j)},this.domElement.addEventListener("contextmenu",de),this.domElement.addEventListener("pointerdown",C),this.domElement.addEventListener("pointercancel",U),this.domElement.addEventListener("wheel",O,{passive:!1}),window.addEventListener("keydown",L),window.addEventListener("keyup",j),this.handleResize(),this.update()}}class Zc extends qn{getType(){return V0e}set object(e){this._objRef&&(this._objRef.object=e)}get object(){return this._objRef?.object}set domElement(e){this._objRef&&(this._objRef.domElement=e)}get domElement(){return this._objRef?.domElement}set enabled(e){this._objRef&&(this._objRef.enabled=e)}get enabled(){return this._objRef?.enabled}set screen(e){this._objRef&&(this._objRef.screen=e)}get screen(){return this._objRef?.screen}set rotateSpeed(e){this._objRef&&(this._objRef.rotateSpeed=e)}get rotateSpeed(){return this._objRef?.rotateSpeed}set zoomSpeed(e){this._objRef&&(this._objRef.zoomSpeed=e)}get zoomSpeed(){return this._objRef?.zoomSpeed}set panSpeed(e){this._objRef&&(this._objRef.panSpeed=e)}get panSpeed(){return this._objRef?.panSpeed}set noRotate(e){this._objRef&&(this._objRef.noRotate=e)}get noRotate(){return this._objRef?.noRotate}set noZoom(e){this._objRef&&(this._objRef.noZoom=e)}get noZoom(){return this._objRef?.noZoom}set noPan(e){this._objRef&&(this._objRef.noPan=e)}get noPan(){return this._objRef?.noPan}set noRoll(e){this._objRef&&(this._objRef.noRoll=e)}get noRoll(){return this._objRef?.noRoll}set staticMoving(e){this._objRef&&(this._objRef.staticMoving=e)}get staticMoving(){return this._objRef?.staticMoving}set dynamicDampingFactor(e){this._objRef&&(this._objRef.dynamicDampingFactor=e)}get dynamicDampingFactor(){return this._objRef?.dynamicDampingFactor}set minDistance(e){this._objRef&&(this._objRef.minDistance=e)}get minDistance(){return this._objRef?.minDistance}set maxDistance(e){this._objRef&&(this._objRef.maxDistance=e)}get maxDistance(){return this._objRef?.maxDistance}set minZoom(e){this._objRef&&(this._objRef.minZoom=e)}get minZoom(){return this._objRef?.minZoom}set maxZoom(e){this._objRef&&(this._objRef.maxZoom=e)}get maxZoom(){return this._objRef?.maxZoom}set keys(e){this._objRef&&(this._objRef.keys=e)}get keys(){return this._objRef?.keys}set mouseButtons(e){this._objRef&&(this._objRef.mouseButtons=e)}get mouseButtons(){return this._objRef?.mouseButtons}set target(e){this._objRef&&(this._objRef.target=Ye(this._objRef.target,e))}get target(){return this._objRef?.target}set position0(e){this._objRef&&(this._objRef.position0=Ye(this._objRef.position0,e))}get position0(){return this._objRef?.position0}set target0(e){this._objRef&&(this._objRef.target0=Ye(this._objRef.target0,e))}get target0(){return this._objRef?.target0}set up0(e){this._objRef&&(this._objRef.up0=Ye(this._objRef.up0,e))}get up0(){return this._objRef?.up0}}Zc.\u0275fac=function(){let i;return function(t){return(i||(i=le(Zc)))(t||Zc)}}(),Zc.\u0275cmp=$({type:Zc,selectors:[["th-trackballControls"]],inputs:{object:"object",domElement:"domElement",enabled:"enabled",screen:"screen",rotateSpeed:"rotateSpeed",zoomSpeed:"zoomSpeed",panSpeed:"panSpeed",noRotate:"noRotate",noZoom:"noZoom",noPan:"noPan",noRoll:"noRoll",staticMoving:"staticMoving",dynamicDampingFactor:"dynamicDampingFactor",minDistance:"minDistance",maxDistance:"maxDistance",minZoom:"minZoom",maxZoom:"maxZoom",keys:"keys",mouseButtons:"mouseButtons",target:"target",position0:"position0",target0:"target0",up0:"up0"},features:[ne([{provide:qn,useExisting:ae(()=>Zc)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class wg extends Rt{getType(){return wp}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}set tangents(e){this._objRef&&(this._objRef.tangents=e)}get tangents(){return this._objRef?.tangents}set normals(e){this._objRef&&(this._objRef.normals=e)}get normals(){return this._objRef?.normals}set binormals(e){this._objRef&&(this._objRef.binormals=e)}get binormals(){return this._objRef?.binormals}}wg.\u0275fac=function(){let i;return function(t){return(i||(i=le(wg)))(t||wg)}}(),wg.\u0275cmp=$({type:wg,selectors:[["th-tubeGeometry"]],inputs:{tangents:"tangents",normals:"normals",binormals:"binormals"},features:[ne([{provide:Rt,useExisting:ae(()=>wg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});const H0e={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Le(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};class Cg extends wn{constructor(e,t,n,r){super(),this.strength=void 0!==t?t:1,this.radius=n,this.threshold=r,this.resolution=void 0!==e?new fe(e.x,e.y):new fe(256,256),this.clearColor=new Le(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);this.renderTargetBright=new Gt(s,o),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let u=0;u<this.nMips;u++){const h=new Gt(s,o);h.texture.name="UnrealBloomPass.h"+u,h.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(h);const f=new Gt(s,o);f.texture.name="UnrealBloomPass.v"+u,f.texture.generateMipmaps=!1,this.renderTargetsVertical.push(f),s=Math.round(s/2),o=Math.round(o/2)}const a=H0e;this.highPassUniforms=gi.clone(a.uniforms),this.highPassUniforms.luminosityThreshold.value=r,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new Pt({uniforms:this.highPassUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const l=[3,5,7,9,11];s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);for(let u=0;u<this.nMips;u++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(l[u])),this.separableBlurMaterials[u].uniforms.texSize.value=new fe(s,o),s=Math.round(s/2),o=Math.round(o/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new R(1,1,1),new R(1,1,1),new R(1,1,1),new R(1,1,1),new R(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const d=Yr;this.copyUniforms=gi.clone(d.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new Pt({uniforms:this.copyUniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,blending:xf,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Le,this.oldClearAlpha=1,this.basic=new $n,this.fsQuad=new xr(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose();for(let e=0;e<this.separableBlurMaterials.length;e++)this.separableBlurMaterials[e].dispose();this.compositeMaterial.dispose(),this.materialCopy.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(e,t){let n=Math.round(e/2),r=Math.round(t/2);this.renderTargetBright.setSize(n,r);for(let s=0;s<this.nMips;s++)this.renderTargetsHorizontal[s].setSize(n,r),this.renderTargetsVertical[s].setSize(n,r),this.separableBlurMaterials[s].uniforms.texSize.value=new fe(n,r),n=Math.round(n/2),r=Math.round(r/2)}render(e,t,n,r,s){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),s&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=n.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=n.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let a=this.renderTargetBright;for(let l=0;l<this.nMips;l++)this.fsQuad.material=this.separableBlurMaterials[l],this.separableBlurMaterials[l].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[l].uniforms.direction.value=Cg.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[l]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[l].uniforms.colorTexture.value=this.renderTargetsHorizontal[l].texture,this.separableBlurMaterials[l].uniforms.direction.value=Cg.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[l]),e.clear(),this.fsQuad.render(e),a=this.renderTargetsVertical[l];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,s&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(n),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}getSeperableBlurMaterial(e){return new Pt({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new fe(.5,.5)},direction:{value:new fe(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat fSigma = float(SIGMA);\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}getCompositeMaterial(e){return new Pt({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}}Cg.BlurDirectionX=new fe(1,0),Cg.BlurDirectionY=new fe(0,1);class Kc extends Yi{getType(){return Cg}set resolution(e){this._objRef&&(this._objRef.resolution=Ye(this._objRef.resolution,e))}get resolution(){return this._objRef?.resolution}set strength(e){this._objRef&&(this._objRef.strength=e)}get strength(){return this._objRef?.strength}set radius(e){this._objRef&&(this._objRef.radius=e)}get radius(){return this._objRef?.radius}set threshold(e){this._objRef&&(this._objRef.threshold=e)}get threshold(){return this._objRef?.threshold}set clearColor(e){this._objRef&&(this._objRef.clearColor=Ye(this._objRef.clearColor,e))}get clearColor(){return this._objRef?.clearColor}set renderTargetsHorizontal(e){this._objRef&&(this._objRef.renderTargetsHorizontal=e)}get renderTargetsHorizontal(){return this._objRef?.renderTargetsHorizontal}set renderTargetsVertical(e){this._objRef&&(this._objRef.renderTargetsVertical=e)}get renderTargetsVertical(){return this._objRef?.renderTargetsVertical}set nMips(e){this._objRef&&(this._objRef.nMips=e)}get nMips(){return this._objRef?.nMips}set renderTargetBright(e){this._objRef&&(this._objRef.renderTargetBright=e)}get renderTargetBright(){return this._objRef?.renderTargetBright}set highPassUniforms(e){this._objRef&&(this._objRef.highPassUniforms=e)}get highPassUniforms(){return this._objRef?.highPassUniforms}set materialHighPassFilter(e){this._objRef&&(this._objRef.materialHighPassFilter=e)}get materialHighPassFilter(){return this._objRef?.materialHighPassFilter}set separableBlurMaterials(e){this._objRef&&(this._objRef.separableBlurMaterials=e)}get separableBlurMaterials(){return this._objRef?.separableBlurMaterials}set compositeMaterial(e){this._objRef&&(this._objRef.compositeMaterial=e)}get compositeMaterial(){return this._objRef?.compositeMaterial}set bloomTintColors(e){this._objRef&&(this._objRef.bloomTintColors=e)}get bloomTintColors(){return this._objRef?.bloomTintColors}set copyUniforms(e){this._objRef&&(this._objRef.copyUniforms=e)}get copyUniforms(){return this._objRef?.copyUniforms}set materialCopy(e){this._objRef&&(this._objRef.materialCopy=e)}get materialCopy(){return this._objRef?.materialCopy}set oldClearColor(e){this._objRef&&(this._objRef.oldClearColor=Ye(this._objRef.oldClearColor,e))}get oldClearColor(){return this._objRef?.oldClearColor}set oldClearAlpha(e){this._objRef&&(this._objRef.oldClearAlpha=e)}get oldClearAlpha(){return this._objRef?.oldClearAlpha}set basic(e){this._objRef&&(this._objRef.basic=e)}get basic(){return this._objRef?.basic}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}}Kc.\u0275fac=function(){let i;return function(t){return(i||(i=le(Kc)))(t||Kc)}}(),Kc.\u0275cmp=$({type:Kc,selectors:[["th-unrealBloomPass"]],inputs:{resolution:"resolution",strength:"strength",radius:"radius",threshold:"threshold",clearColor:"clearColor",renderTargetsHorizontal:"renderTargetsHorizontal",renderTargetsVertical:"renderTargetsVertical",nMips:"nMips",renderTargetBright:"renderTargetBright",highPassUniforms:"highPassUniforms",materialHighPassFilter:"materialHighPassFilter",separableBlurMaterials:"separableBlurMaterials",compositeMaterial:"compositeMaterial",bloomTintColors:"bloomTintColors",copyUniforms:"copyUniforms",materialCopy:"materialCopy",oldClearColor:"oldClearColor",oldClearAlpha:"oldClearAlpha",basic:"basic",fsQuad:"fsQuad"},features:[ne([{provide:Li,useExisting:ae(()=>Kc)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Mg extends ir{getType(){return _4}get isVideoTexture(){return this._objRef?.isVideoTexture}set magFilter(e){this._objRef&&(this._objRef.magFilter=e)}get magFilter(){return this._objRef?.magFilter}set minFilter(e){this._objRef&&(this._objRef.minFilter=e)}get minFilter(){return this._objRef?.minFilter}set generateMipmaps(e){this._objRef&&(this._objRef.generateMipmaps=e)}get generateMipmaps(){return this._objRef?.generateMipmaps}}Mg.\u0275fac=function(){let i;return function(t){return(i||(i=le(Mg)))(t||Mg)}}(),Mg.\u0275cmp=$({type:Mg,selectors:[["th-videoTexture"]],inputs:{magFilter:"magFilter",minFilter:"minFilter",generateMipmaps:"generateMipmaps"},features:[ne([{provide:Br,useExisting:ae(()=>Mg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class Eg extends Rt{getType(){return CR}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}}Eg.\u0275fac=function(){let i;return function(t){return(i||(i=le(Eg)))(t||Eg)}}(),Eg.\u0275cmp=$({type:Eg,selectors:[["th-wireframeGeometry"]],features:[ne([{provide:Rt,useExisting:ae(()=>Eg)}]),q],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(he(),ie(0))},encapsulation:2,changeDetection:0});class iC{transform(e){if(e)return e instanceof Do?e.objRef?.clone():e.clone()}}iC.\u0275fac=function(e){return new(e||iC)},iC.\u0275pipe=_i({name:"clone",type:iC,pure:!0});class Hl{transform(e){return Array.isArray(e)?new Le(...e):new Le(e)}}Hl.\u0275fac=function(e){return new(e||Hl)},Hl.\u0275pipe=_i({name:"color",type:Hl,pure:!0});class nC{transform(e){return new fe(...e)}}nC.\u0275fac=function(e){return new(e||nC)},nC.\u0275pipe=_i({name:"vector2",type:nC,pure:!0});class rC{transform(e){return new R(...e)}}rC.\u0275fac=function(e){return new(e||rC)},rC.\u0275pipe=_i({name:"vector3",type:rC,pure:!0});class sC{transform(e){return new ii(...e)}}sC.\u0275fac=function(e){return new(e||sC)},sC.\u0275pipe=_i({name:"vector4",type:sC,pure:!0});class oC{transform(e,t){return new oo(new R(...e),t)}}oC.\u0275fac=function(e){return new(e||oC)},oC.\u0275pipe=_i({name:"plane",type:oC,pure:!0});class $c extends Lo{constructor(){super(...arguments),this.clazz=Bx}}$c.\u0275fac=function(){let i;return function(t){return(i||(i=le($c)))(t||$c)}}(),$c.\u0275prov=He({token:$c,factory:$c.\u0275fac,providedIn:"root"});class aC extends ua{constructor(e){super(),this.service=e}}aC.\u0275fac=function(e){return new(e||aC)(I($c,16))},aC.\u0275pipe=_i({name:"loadTexture",type:aC,pure:!0});class lC extends ks{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}lC.\u0275fac=function(e){return new(e||lC)(I(ir,1),I(gt),I($c))},lC.\u0275dir=Ne({type:lC,selectors:[["","loadTexture",""]],features:[q]});class X0e extends Ep{constructor(e){super(e)}parse(e){e.length<19&&console.error("THREE.TGALoader: Not enough data to contain header.");let S=0;const C=new Uint8Array(e),T={id_length:C[S++],colormap_type:C[S++],image_type:C[S++],colormap_index:C[S++]|C[S++]<<8,colormap_length:C[S++]|C[S++]<<8,colormap_size:C[S++],origin:[C[S++]|C[S++]<<8,C[S++]|C[S++]<<8],width:C[S++]|C[S++]<<8,height:C[S++]|C[S++]<<8,pixel_size:C[S++],flags:C[S++]};(function t(B){switch(B.image_type){case 1:case 9:(B.colormap_length>256||24!==B.colormap_size||1!==B.colormap_type)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case 2:case 3:case 10:case 11:B.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case 0:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',B.image_type)}(B.width<=0||B.height<=0)&&console.error("THREE.TGALoader: Invalid image size."),8!==B.pixel_size&&16!==B.pixel_size&&24!==B.pixel_size&&32!==B.pixel_size&&console.error('THREE.TGALoader: Invalid pixel size "%s".',B.pixel_size)})(T),T.id_length+S>e.length&&console.error("THREE.TGALoader: No data."),S+=T.id_length;let k=!1,U=!1,L=!1;switch(T.image_type){case 9:k=!0,U=!0;break;case 1:U=!0;break;case 10:k=!0;break;case 2:break;case 11:k=!0,L=!0;break;case 3:L=!0}const j=new Uint8Array(T.width*T.height*4),H=function n(B,V,O,Q,oe){let be,de;const X=O.pixel_size>>3,Y=O.width*O.height*X;if(V&&(de=oe.subarray(Q,Q+=O.colormap_length*(O.colormap_size>>3))),B){be=new Uint8Array(Y);let re,J,D,ue=0;const Ee=new Uint8Array(X);for(;ue<Y;)if(re=oe[Q++],J=1+(127&re),128&re){for(D=0;D<X;++D)Ee[D]=oe[Q++];for(D=0;D<J;++D)be.set(Ee,ue+D*X);ue+=X*J}else{for(J*=X,D=0;D<J;++D)be[ue+D]=oe[Q++];ue+=J}}else be=oe.subarray(Q,Q+=V?O.width*O.height:Y);return{pixel_data:be,palettes:de}}(k,U,T,S,C);return function d(B,V,O,Q,oe){let be,de,X,Y,re,J;switch((48&T.flags)>>4){default:case 2:be=0,X=1,re=V,de=0,Y=1,J=O;break;case 0:be=0,X=1,re=V,de=O-1,Y=-1,J=-1;break;case 3:be=V-1,X=-1,re=-1,de=0,Y=1,J=O;break;case 1:be=V-1,X=-1,re=-1,de=O-1,Y=-1,J=-1}if(L)switch(T.pixel_size){case 8:!function l(B,V,O,Q,oe,be,de,X){let Y,J,D,re=0;const ue=T.width;for(D=V;D!==Q;D+=O)for(J=oe;J!==de;J+=be,re++)Y=X[re],B[4*(J+ue*D)+0]=Y,B[4*(J+ue*D)+1]=Y,B[4*(J+ue*D)+2]=Y,B[4*(J+ue*D)+3]=255}(B,de,Y,J,be,X,re,Q);break;case 16:!function c(B,V,O,Q,oe,be,de,X){let re,J,Y=0;const D=T.width;for(J=V;J!==Q;J+=O)for(re=oe;re!==de;re+=be,Y+=2)B[4*(re+D*J)+0]=X[Y+0],B[4*(re+D*J)+1]=X[Y+0],B[4*(re+D*J)+2]=X[Y+0],B[4*(re+D*J)+3]=X[Y+1]}(B,de,Y,J,be,X,re,Q);break;default:console.error("THREE.TGALoader: Format not supported.")}else switch(T.pixel_size){case 8:!function r(B,V,O,Q,oe,be,de,X,Y){const re=Y;let J,ue,Ee,D=0;const me=T.width;for(Ee=V;Ee!==Q;Ee+=O)for(ue=oe;ue!==de;ue+=be,D++)J=X[D],B[4*(ue+me*Ee)+3]=255,B[4*(ue+me*Ee)+2]=re[3*J+0],B[4*(ue+me*Ee)+1]=re[3*J+1],B[4*(ue+me*Ee)+0]=re[3*J+2]}(B,de,Y,J,be,X,re,Q,oe);break;case 16:!function s(B,V,O,Q,oe,be,de,X){let Y,J,D,re=0;const ue=T.width;for(D=V;D!==Q;D+=O)for(J=oe;J!==de;J+=be,re+=2)Y=X[re+0]+(X[re+1]<<8),B[4*(J+ue*D)+0]=(31744&Y)>>7,B[4*(J+ue*D)+1]=(992&Y)>>2,B[4*(J+ue*D)+2]=(31&Y)<<3,B[4*(J+ue*D)+3]=32768&Y?0:255}(B,de,Y,J,be,X,re,Q);break;case 24:!function o(B,V,O,Q,oe,be,de,X){let re,J,Y=0;const D=T.width;for(J=V;J!==Q;J+=O)for(re=oe;re!==de;re+=be,Y+=3)B[4*(re+D*J)+3]=255,B[4*(re+D*J)+2]=X[Y+0],B[4*(re+D*J)+1]=X[Y+1],B[4*(re+D*J)+0]=X[Y+2]}(B,de,Y,J,be,X,re,Q);break;case 32:!function a(B,V,O,Q,oe,be,de,X){let re,J,Y=0;const D=T.width;for(J=V;J!==Q;J+=O)for(re=oe;re!==de;re+=be,Y+=4)B[4*(re+D*J)+2]=X[Y+0],B[4*(re+D*J)+1]=X[Y+1],B[4*(re+D*J)+0]=X[Y+2],B[4*(re+D*J)+3]=X[Y+3]}(B,de,Y,J,be,X,re,Q);break;default:console.error("THREE.TGALoader: Format not supported.")}}(j,T.width,T.height,H.pixel_data,H.palettes),{data:j,width:T.width,height:T.height,flipY:!0,generateMipmaps:!0,minFilter:Ks}}}class Jc extends Lo{constructor(){super(...arguments),this.clazz=X0e}}Jc.\u0275fac=function(){let i;return function(t){return(i||(i=le(Jc)))(t||Jc)}}(),Jc.\u0275prov=He({token:Jc,factory:Jc.\u0275fac,providedIn:"root"});class cC extends ua{constructor(e){super(),this.service=e}}cC.\u0275fac=function(e){return new(e||cC)(I(Jc,16))},cC.\u0275pipe=_i({name:"loadTGATexture",type:cC,pure:!0});class dC extends ks{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}dC.\u0275fac=function(e){return new(e||dC)(I(_a,1),I(gt),I(Jc))},dC.\u0275dir=Ne({type:dC,selectors:[["","loadTGATexture",""]],features:[q]});class ed extends Lo{constructor(){super(...arguments),this.clazz=N4}}ed.\u0275fac=function(){let i;return function(t){return(i||(i=le(ed)))(t||ed)}}(),ed.\u0275prov=He({token:ed,factory:ed.\u0275fac,providedIn:"root"});class uC extends ua{constructor(e){super(),this.service=e}}uC.\u0275fac=function(e){return new(e||uC)(I(ed,16))},uC.\u0275pipe=_i({name:"loadCubeTexture",type:uC,pure:!0});class hC extends ks{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}hC.\u0275fac=function(e){return new(e||hC)(I(ir,1),I(gt),I(ed))},hC.\u0275dir=Ne({type:hC,selectors:[["","loadCubeTexture",""]],features:[q]});class Z0e extends kx{constructor(e){super(e)}parse(e,t){const n={mipmaps:[],width:0,height:0,format:null,mipmapCount:1};function f(re){return re.charCodeAt(0)+(re.charCodeAt(1)<<8)+(re.charCodeAt(2)<<16)+(re.charCodeAt(3)<<24)}function _(re,J,D,ue){const Ee=D*ue*4,me=new Uint8Array(re,J,Ee),qe=new Uint8Array(Ee);let Me=0,we=0;for(let Se=0;Se<ue;Se++)for(let it=0;it<D;it++){const Xe=me[we];we++;const At=me[we];we++;const yt=me[we];we++;const lt=me[we];we++,qe[Me]=yt,Me++,qe[Me]=At,Me++,qe[Me]=Xe,Me++,qe[Me]=lt,Me++}return qe}const g=f("DXT1"),p=f("DXT3"),v=f("DXT5"),b=f("ETC1"),O=new Int32Array(e,0,31);if(542327876!==O[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),n;let Q;const oe=O[21];let be=!1;switch(oe){case g:Q=8,n.format=Df;break;case p:Q=16,n.format=J_;break;case v:Q=16,n.format=Pf;break;case b:Q=8,n.format=Ey;break;default:if(!(32===O[22]&&16711680&O[23]&&65280&O[24]&&255&O[25]&&4278190080&O[26]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",function m(re){return String.fromCharCode(255&re,re>>8&255,re>>16&255,re>>24&255)}(oe)),n;be=!0,Q=64,n.format=Rn}n.mipmapCount=1,131072&O[2]&&!1!==t&&(n.mipmapCount=Math.max(1,O[7]));const de=O[28];if(n.isCubemap=!!(512&de),n.isCubemap&&(!(1024&de)||!(2048&de)||!(4096&de)||!(8192&de)||!(16384&de)||!(32768&de)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),n;n.width=O[4],n.height=O[3];let X=O[1]+4;const Y=n.isCubemap?6:1;for(let re=0;re<Y;re++){let J=n.width,D=n.height;for(let ue=0;ue<n.mipmapCount;ue++){let Ee,me;be?(Ee=_(e,X,J,D),me=Ee.length):(me=Math.max(4,J)/4*Math.max(4,D)/4*Q,Ee=new Uint8Array(e,X,me)),n.mipmaps.push({data:Ee,width:J,height:D}),X+=me,J=Math.max(J>>1,1),D=Math.max(D>>1,1)}}return n}}class td extends Lo{constructor(){super(...arguments),this.clazz=Z0e}}td.\u0275fac=function(){let i;return function(t){return(i||(i=le(td)))(t||td)}}(),td.\u0275prov=He({token:td,factory:td.\u0275fac,providedIn:"root"});class fC extends ua{constructor(e){super(),this.service=e}}fC.\u0275fac=function(e){return new(e||fC)(I(td,16))},fC.\u0275pipe=_i({name:"loadDDSTexture",type:fC,pure:!0});class pC extends ks{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}pC.\u0275fac=function(e){return new(e||pC)(I(Za,1),I(gt),I(td))},pC.\u0275dir=Ne({type:pC,selectors:[["","loadDDSTexture",""]],features:[q]});class K0e{constructor(e=4){this.pool=e,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(e){if(!this.workers[e]){const t=this.workerCreator();t.addEventListener("message",this._onMessage.bind(this,e)),this.workers[e]=t}}_getIdleWorker(){for(let e=0;e<this.pool;e++)if(!(this.workerStatus&1<<e))return e;return-1}_onMessage(e,t){const n=this.workersResolve[e];if(n&&n(t),this.queue.length){const{resolve:r,msg:s,transfer:o}=this.queue.shift();this.workersResolve[e]=r,this.workers[e].postMessage(s,o)}else this.workerStatus^=1<<e}setWorkerCreator(e){this.workerCreator=e}setWorkerLimit(e){this.pool=e}postMessage(e,t){return new Promise(n=>{const r=this._getIdleWorker();-1!==r?(this._initWorker(r),this.workerStatus|=1<<r,this.workersResolve[r]=n,this.workers[r].postMessage(e,t)):this.queue.push({resolve:n,msg:e,transfer:t})})}dispose(){this.workers.forEach(e=>e.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}class nve{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class D0{constructor(e,t,n,r){this._dataView=new DataView(e.buffer,e.byteOffset+t,n),this._littleEndian=r,this._offset=0}_nextUint8(){const e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){const e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){const e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){const e=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,e}_nextInt32(){const e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_skip(e){return this._offset+=e,this}_scan(e,t=0){const n=this._offset;let r=0;for(;this._dataView.getUint8(this._offset)!==t&&r<e;)r++,this._offset++;return r<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+n,r)}}new Uint8Array([0]);const Lr=[171,75,84,88,32,50,48,187,13,10,26,10];function hH(i){return typeof TextDecoder<"u"?(new TextDecoder).decode(i):Buffer.from(i).toString("utf8")}let SD,Ql,TD;const RD={env:{emscripten_notify_memory_growth:function(i){TD=new Uint8Array(Ql.exports.memory.buffer)}}};class ove{init(){return SD||(SD=typeof fetch<"u"?fetch("data:application/wasm;base64,"+fH).then(e=>e.arrayBuffer()).then(e=>WebAssembly.instantiate(e,RD)).then(this._init):WebAssembly.instantiate(Buffer.from(fH,"base64"),RD).then(this._init),SD)}_init(e){Ql=e.instance,RD.env.emscripten_notify_memory_growth(0)}decode(e,t=0){if(!Ql)throw new Error("ZSTDDecoder: Await .init() before decoding.");const n=e.byteLength,r=Ql.exports.malloc(n);TD.set(e,r),t=t||Number(Ql.exports.ZSTD_findDecompressedSize(r,n));const s=Ql.exports.malloc(t),o=Ql.exports.ZSTD_decompress(s,t,r,n),a=TD.slice(s,s+o);return Ql.exports.free(r),Ql.exports.free(s),a}}const fH="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ",ID=new WeakMap;let PD,DD=0,ave=(()=>{class i extends Ar{constructor(t){super(t),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new K0e,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(t){return this.transcoderPath=t,this}setWorkerLimit(t){return this.workerPool.setWorkerLimit(t),this}detectSupport(t){return this.workerConfig={astcSupported:t.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:t.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:t.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:t.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:t.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:t.extensions.has("WEBGL_compressed_texture_pvrtc")||t.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},t.capabilities.isWebGL2&&(this.workerConfig.etc1Supported=!1),this}init(){if(!this.transcoderPending){const t=new yr(this.manager);t.setPath(this.transcoderPath),t.setWithCredentials(this.withCredentials);const n=t.loadAsync("basis_transcoder.js"),r=new yr(this.manager);r.setPath(this.transcoderPath),r.setResponseType("arraybuffer"),r.setWithCredentials(this.withCredentials);const s=r.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([n,s]).then(([o,a])=>{const l=i.BasisWorker.toString(),c=["/* constants */","let _EngineFormat = "+JSON.stringify(i.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(i.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(i.BasisFormat),"/* basis_transcoder.js */",o,"/* worker */",l.substring(l.indexOf("{")+1,l.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([c])),this.transcoderBinary=a,this.workerPool.setWorkerCreator(()=>{const d=new Worker(this.workerSourceURL),u=this.transcoderBinary.slice(0);return d.postMessage({type:"init",config:this.workerConfig,transcoderBinary:u},[u]),d})}),DD>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),DD++}return this.transcoderPending}load(t,n,r,s){if(null===this.workerConfig)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const o=new yr(this.manager);o.setResponseType("arraybuffer"),o.setWithCredentials(this.withCredentials),o.load(t,a=>{if(ID.has(a))return ID.get(a).promise.then(n).catch(s);this._createTexture(a).then(l=>n?n(l):null).catch(s)},r,s)}_createTextureFrom(t,n){const{mipmaps:r,width:s,height:o,format:a,type:l,error:c,dfdTransferFn:d,dfdFlags:u}=t;if("error"===l)return Promise.reject(c);const h=n.layerCount>1?new dR(r,s,o,n.layerCount,a,Qr):new Eb(r,s,o,a,Qr);return h.minFilter=1===r.length?Ui:Ks,h.magFilter=Ui,h.generateMipmaps=!1,h.needsUpdate=!0,h.encoding=2===d?ui:$s,h.premultiplyAlpha=!!(1&u),h}_createTexture(t,n={}){var r=this;return ss(function*(){const s=function rve(i){const e=new Uint8Array(i.buffer,i.byteOffset,Lr.length);if(e[0]!==Lr[0]||e[1]!==Lr[1]||e[2]!==Lr[2]||e[3]!==Lr[3]||e[4]!==Lr[4]||e[5]!==Lr[5]||e[6]!==Lr[6]||e[7]!==Lr[7]||e[8]!==Lr[8]||e[9]!==Lr[9]||e[10]!==Lr[10]||e[11]!==Lr[11])throw new Error("Missing KTX 2.0 identifier.");const t=new nve,n=17*Uint32Array.BYTES_PER_ELEMENT,r=new D0(i,Lr.length,n,!0);t.vkFormat=r._nextUint32(),t.typeSize=r._nextUint32(),t.pixelWidth=r._nextUint32(),t.pixelHeight=r._nextUint32(),t.pixelDepth=r._nextUint32(),t.layerCount=r._nextUint32(),t.faceCount=r._nextUint32();const s=r._nextUint32();t.supercompressionScheme=r._nextUint32();const o=r._nextUint32(),a=r._nextUint32(),l=r._nextUint32(),c=r._nextUint32(),d=r._nextUint64(),u=r._nextUint64(),h=new D0(i,Lr.length+n,3*s*8,!0);for(let V=0;V<s;V++)t.levels.push({levelData:new Uint8Array(i.buffer,i.byteOffset+h._nextUint64(),h._nextUint64()),uncompressedByteLength:h._nextUint64()});const f=new D0(i,o,a,!0),m={vendorId:f._skip(4)._nextUint16(),descriptorType:f._nextUint16(),versionNumber:f._nextUint16(),descriptorBlockSize:f._nextUint16(),colorModel:f._nextUint8(),colorPrimaries:f._nextUint8(),transferFunction:f._nextUint8(),flags:f._nextUint8(),texelBlockDimension:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],bytesPlane:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],samples:[]},_=(m.descriptorBlockSize/4-6)/4;for(let V=0;V<_;V++){const O={bitOffset:f._nextUint16(),bitLength:f._nextUint8(),channelType:f._nextUint8(),samplePosition:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&O.channelType?(O.sampleLower=f._nextInt32(),O.sampleUpper=f._nextInt32()):(O.sampleLower=f._nextUint32(),O.sampleUpper=f._nextUint32()),m.samples[V]=O}t.dataFormatDescriptor.length=0,t.dataFormatDescriptor.push(m);const g=new D0(i,l,c,!0);for(;g._offset<c;){const V=g._nextUint32(),O=g._scan(V),Q=hH(O),oe=g._scan(V-O.byteLength);t.keyValue[Q]=Q.match(/^ktx/i)?hH(oe):oe,g._offset%4&&g._skip(4-g._offset%4)}if(u<=0)return t;const p=new D0(i,d,u,!0),v=p._nextUint16(),b=p._nextUint16(),y=p._nextUint32(),x=p._nextUint32(),w=p._nextUint32(),E=p._nextUint32(),S=[];for(let V=0;V<s;V++)S.push({imageFlags:p._nextUint32(),rgbSliceByteOffset:p._nextUint32(),rgbSliceByteLength:p._nextUint32(),alphaSliceByteOffset:p._nextUint32(),alphaSliceByteLength:p._nextUint32()});const C=d+p._offset,T=C+y,k=T+x,U=k+w,L=new Uint8Array(i.buffer,i.byteOffset+C,y),j=new Uint8Array(i.buffer,i.byteOffset+T,x),H=new Uint8Array(i.buffer,i.byteOffset+k,w),B=new Uint8Array(i.buffer,i.byteOffset+U,E);return t.globalData={endpointCount:v,selectorCount:b,imageDescs:S,endpointsData:L,selectorsData:j,tablesData:H,extendedData:B},t}(new Uint8Array(t));if(0!==s.vkFormat)return function cve(i){return BD.apply(this,arguments)}(s);const o=n,a=r.init().then(()=>r.workerPool.postMessage({type:"transcode",buffer:t,taskConfig:o},[t])).then(l=>r._createTextureFrom(l.data,s));return ID.set(t,{promise:a}),a})()}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),DD--,this}}return i.BasisFormat={ETC1S:0,UASTC_4x4:1},i.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16},i.EngineFormat={RGBAFormat:Rn,RGBA_ASTC_4x4_Format:Ry,RGBA_BPTC_Format:ib,RGBA_ETC2_EAC_Format:Ty,RGBA_PVRTC_4BPPV1_Format:Bf,RGBA_S3TC_DXT5_Format:Pf,RGB_ETC1_Format:Ey,RGB_ETC2_Format:Sy,RGB_PVRTC_4BPPV1_Format:kf,RGB_S3TC_DXT1_Format:Df},i.BasisWorker=function(){let e,t,n;const r=_EngineFormat,s=_TranscoderFormat,o=_BasisFormat;self.addEventListener("message",function(_){const g=_.data;switch(g.type){case"init":e=g.config,function a(_){t=new Promise(g=>{n={wasmBinary:_,onRuntimeInitialized:g},BASIS(n)}).then(()=>{n.initializeBasis(),void 0===n.KTX2File&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}(g.transcoderBinary);break;case"transcode":t.then(()=>{try{const{width:p,height:v,hasAlpha:b,mipmaps:y,format:x,dfdTransferFn:w,dfdFlags:E}=function l(_){const g=new n.KTX2File(new Uint8Array(_));function p(){g.close(),g.delete()}if(!g.isValid())throw p(),new Error("THREE.KTX2Loader:\tInvalid or unsupported .ktx2 file");const v=g.isUASTC()?o.UASTC_4x4:o.ETC1S,b=g.getWidth(),y=g.getHeight(),x=g.getLayers()||1,w=g.getLevels(),E=g.getHasAlpha(),S=g.getDFDTransferFunc(),C=g.getDFDFlags(),{transcoderFormat:T,engineFormat:k}=function h(_,g,p,v){let b,y;const x=_===o.ETC1S?d:u;for(let w=0;w<x.length;w++){const E=x[w];if(e[E.if]&&E.basisFormat.includes(_)&&!(v&&E.transcoderFormat.length<2)&&(!E.needsPowerOfTwo||f(g)&&f(p)))return b=E.transcoderFormat[v?1:0],y=E.engineFormat[v?1:0],{transcoderFormat:b,engineFormat:y}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),b=s.RGBA32,y=r.RGBAFormat,{transcoderFormat:b,engineFormat:y}}(v,b,y,E);if(!b||!y||!w)throw p(),new Error("THREE.KTX2Loader:\tInvalid texture");if(!g.startTranscoding())throw p(),new Error("THREE.KTX2Loader: .startTranscoding failed");const U=[];for(let L=0;L<w;L++){const j=[];let H,B;for(let V=0;V<x;V++){const O=g.getImageLevelInfo(L,V,0);H=O.origWidth<4?O.origWidth:O.width,B=O.origHeight<4?O.origHeight:O.height;const Q=new Uint8Array(g.getImageTranscodedSizeInBytes(L,V,0,T));if(!g.transcodeImage(Q,L,V,0,T,0,-1,-1))throw p(),new Error("THREE.KTX2Loader: .transcodeImage failed.");j.push(Q)}U.push({data:m(j),width:H,height:B})}return p(),{width:b,height:y,hasAlpha:E,mipmaps:U,format:k,dfdTransferFn:S,dfdFlags:C}}(g.buffer),S=[];for(let C=0;C<y.length;++C)S.push(y[C].data.buffer);self.postMessage({type:"transcode",id:g.id,width:p,height:v,hasAlpha:b,mipmaps:y,format:x,dfdTransferFn:w,dfdFlags:E},S)}catch(p){console.error(p),self.postMessage({type:"error",id:g.id,error:p.message})}})}});const c=[{if:"astcSupported",basisFormat:[o.UASTC_4x4],transcoderFormat:[s.ASTC_4x4,s.ASTC_4x4],engineFormat:[r.RGBA_ASTC_4x4_Format,r.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[s.BC7_M5,s.BC7_M5],engineFormat:[r.RGBA_BPTC_Format,r.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[s.BC1,s.BC3],engineFormat:[r.RGB_S3TC_DXT1_Format,r.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[s.ETC1,s.ETC2],engineFormat:[r.RGB_ETC2_Format,r.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[s.ETC1],engineFormat:[r.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[s.PVRTC1_4_RGB,s.PVRTC1_4_RGBA],engineFormat:[r.RGB_PVRTC_4BPPV1_Format,r.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],d=c.sort(function(_,g){return _.priorityETC1S-g.priorityETC1S}),u=c.sort(function(_,g){return _.priorityUASTC-g.priorityUASTC});function f(_){return _<=2||0==(_&_-1)&&0!==_}function m(_){let g=0;for(const b of _)g+=b.byteLength;const p=new Uint8Array(g);let v=0;for(const b of _)p.set(b,v),v+=b.byteLength;return p}},i})();const pH={109:Rn,97:Rn,37:Rn,43:Rn,103:If,83:If,16:If,22:If,100:Cl,76:Cl,15:Cl,9:Cl},kD={109:Un,97:mn,37:Qr,43:Qr,103:Un,83:mn,16:Qr,22:Qr,100:Un,76:mn,15:Qr,9:Qr},lve={43:ui,22:ui,15:ui};function BD(){return BD=ss(function*(i){const{vkFormat:e,pixelWidth:t,pixelHeight:n,pixelDepth:r}=i;if(void 0===pH[e])throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");const s=i.levels[0];let o,a;if(0===i.supercompressionScheme)o=s.levelData;else{if(2!==i.supercompressionScheme)throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");PD||(PD=new Promise(function(){var c=ss(function*(d){const u=new ove;yield u.init(),d(u)});return function(d){return c.apply(this,arguments)}}())),o=(yield PD).decode(s.levelData,s.uncompressedByteLength)}a=kD[e]===Un?new Float32Array(o.buffer,o.byteOffset,o.byteLength/Float32Array.BYTES_PER_ELEMENT):kD[e]===mn?new Uint16Array(o.buffer,o.byteOffset,o.byteLength/Uint16Array.BYTES_PER_ELEMENT):o;const l=0===r?new Fa(a,t,n):new cb(a,t,n,r);return l.type=kD[e],l.format=pH[e],l.encoding=lve[e]||$s,l.needsUpdate=!0,Promise.resolve(l)}),BD.apply(this,arguments)}class id extends Lo{constructor(){super(...arguments),this.clazz=ave,this.transcoderPath=""}setDecoderPath(e){this.transcoderPath=e}createLoaderInstance(){const e=super.createLoaderInstance();return e.setTranscoderPath(this.transcoderPath),e}}id.\u0275fac=function(){let i;return function(t){return(i||(i=le(id)))(t||id)}}(),id.\u0275prov=He({token:id,factory:id.\u0275fac,providedIn:"root"});class gC extends ua{constructor(e){super(),this.service=e}}gC.\u0275fac=function(e){return new(e||gC)(I(id,16))},gC.\u0275pipe=_i({name:"loadKTX2Texture",type:gC,pure:!0});class _C extends ks{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}_C.\u0275fac=function(e){return new(e||_C)(I(ir,1),I(gt),I(id))},_C.\u0275dir=Ne({type:_C,selectors:[["","loadKTX2Texture",""]],features:[q]});class dve extends kx{constructor(e){super(e)}parse(e,t){const n=new fve(e,1);return{mipmaps:n.mipmaps(t),width:n.pixelWidth,height:n.pixelHeight,format:n.glInternalFormat,isCubemap:6===n.numberOfFaces,mipmapCount:n.numberOfMipmapLevels}}}class fve{constructor(e,t){this.arrayBuffer=e;const n=new Uint8Array(this.arrayBuffer,0,12);if(171!==n[0]||75!==n[1]||84!==n[2]||88!==n[3]||32!==n[4]||49!==n[5]||49!==n[6]||187!==n[7]||13!==n[8]||10!==n[9]||26!==n[10]||10!==n[11])return void console.error("texture missing KTX identifier");const r=Uint32Array.BYTES_PER_ELEMENT,s=new DataView(this.arrayBuffer,12,13*r),a=67305985===s.getUint32(0,!0);this.glType=s.getUint32(1*r,a),this.glTypeSize=s.getUint32(2*r,a),this.glFormat=s.getUint32(3*r,a),this.glInternalFormat=s.getUint32(4*r,a),this.glBaseInternalFormat=s.getUint32(5*r,a),this.pixelWidth=s.getUint32(6*r,a),this.pixelHeight=s.getUint32(7*r,a),this.pixelDepth=s.getUint32(8*r,a),this.numberOfArrayElements=s.getUint32(9*r,a),this.numberOfFaces=s.getUint32(10*r,a),this.numberOfMipmapLevels=s.getUint32(11*r,a),this.bytesOfKeyValueData=s.getUint32(12*r,a),0===this.glType?(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0!==this.pixelHeight&&0===this.pixelDepth?0===this.numberOfArrayElements?this.numberOfFaces===t?this.loadType=0:console.warn("number of faces expected"+t+", but found "+this.numberOfFaces):console.warn("texture arrays not currently supported"):console.warn("only 2D textures currently supported")):console.warn("only compressed formats currently supported")}mipmaps(e){const t=[];let n=64+this.bytesOfKeyValueData,r=this.pixelWidth,s=this.pixelHeight;const o=e?this.numberOfMipmapLevels:1;for(let a=0;a<o;a++){const l=new Int32Array(this.arrayBuffer,n,1)[0];n+=4;for(let c=0;c<this.numberOfFaces;c++){const d=new Uint8Array(this.arrayBuffer,n,l);t.push({data:d,width:r,height:s}),n+=l,n+=3-(l+3)%4}r=Math.max(1,.5*r),s=Math.max(1,.5*s)}return t}}class nd extends Lo{constructor(){super(...arguments),this.clazz=dve}}nd.\u0275fac=function(){let i;return function(t){return(i||(i=le(nd)))(t||nd)}}(),nd.\u0275prov=He({token:nd,factory:nd.\u0275fac,providedIn:"root"});class bC extends ua{constructor(e){super(),this.service=e}}bC.\u0275fac=function(e){return new(e||bC)(I(nd,16))},bC.\u0275pipe=_i({name:"loadKTXTexture",type:bC,pure:!0});class vC extends ks{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}vC.\u0275fac=function(e){return new(e||vC)(I(Za,1),I(gt),I(nd))},vC.\u0275dir=Ne({type:vC,selectors:[["","loadKTXTexture",""]],features:[q]});class pve extends kx{constructor(e){super(e)}parse(e,t){const r=new Uint32Array(e,0,13),s={buffer:e,header:r,loadMipmaps:t};return 55727696===r[0]?function mve(i){const e=i.header;let t,n;const r=e[12],s=e[2],o=e[6],a=e[7],l=e[10],c=e[11];switch(s){case 0:t=2,n=eb;break;case 1:t=2,n=tb;break;case 2:t=4,n=kf;break;case 3:t=4,n=Bf;break;default:console.error("THREE.PVRLoader: Unsupported PVR format:",s)}return i.dataPtr=52+r,i.bpp=t,i.format=n,i.width=a,i.height=o,i.numSurfaces=l,i.numMipmaps=c,i.isCubemap=6===l,mH(i)}(s):559044176===r[11]?function gve(i){const e=i.header,t=e[0],n=e[1],r=e[2],s=e[3],l=e[12],h=255&e[4];let f,m;const _=e[10]>0;return 25===h?(m=_?Bf:kf,f=4):24===h?(m=_?tb:eb,f=2):console.error("THREE.PVRLoader: Unknown PVR format:",h),i.dataPtr=t,i.bpp=f,i.format=m,i.width=r,i.height=n,i.numSurfaces=l,i.numMipmaps=s+1,i.isCubemap=6===l,mH(i)}(s):void console.error("THREE.PVRLoader: Unknown PVR format.")}}function mH(i){const e={mipmaps:[],width:i.width,height:i.height,format:i.format,mipmapCount:i.numMipmaps,isCubemap:i.isCubemap},t=i.buffer;let n=i.dataPtr,r=0,s=0,o=0,a=0,l=0,c=0;const d=i.bpp,u=i.numSurfaces;2===d?(o=8,a=4):(o=4,a=4),s=o*a*d/8,e.mipmaps.length=i.numMipmaps*u;let h=0;for(;h<i.numMipmaps;){const f=i.width>>h,m=i.height>>h;l=f/o,c=m/a,l<2&&(l=2),c<2&&(c=2),r=l*c*s;for(let _=0;_<u;_++){const p={data:new Uint8Array(t,n,r),width:f,height:m};e.mipmaps[_*i.numMipmaps+h]=p,n+=r}h++}return e}class rd extends Lo{constructor(){super(...arguments),this.clazz=pve}}rd.\u0275fac=function(){let i;return function(t){return(i||(i=le(rd)))(t||rd)}}(),rd.\u0275prov=He({token:rd,factory:rd.\u0275fac,providedIn:"root"});class AC extends ua{constructor(e){super(),this.service=e}}AC.\u0275fac=function(e){return new(e||AC)(I(rd,16))},AC.\u0275pipe=_i({name:"loadPVRTexture",type:AC,pure:!0});class yC extends ks{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}yC.\u0275fac=function(e){return new(e||yC)(I(Za,1),I(gt),I(rd))},yC.\u0275dir=Ne({type:yC,selectors:[["","loadPVRTexture",""]],features:[q]});class _ve extends Ep{constructor(e){super(e),this.type=mn}parse(e){const C=Math.pow(2.7182818,2.2),U={l:0,c:0,lc:0};function L(M,P,G,ee,ve){for(;G<M;)P=P<<8|tt(ee,ve),G+=8;U.l=P>>(G-=M)&(1<<M)-1,U.c=P,U.lc=G}const j=new Array(59);function V(M){return 63&M}function O(M){return M>>6}const oe={c:0,lc:0};function be(M,P,G,ee){M=M<<8|tt(G,ee),P+=8,oe.c=M,oe.lc=P}const de={c:0,lc:0};function X(M,P,G,ee,ve,pe,Te,Be,Ve){if(M==P){ee<8&&(be(G,ee,ve,pe),G=oe.c,ee=oe.lc);let Fe=G>>(ee-=8);if(Fe=new Uint8Array([Fe])[0],Be.value+Fe>Ve)return!1;const Ze=Te[Be.value-1];for(;Fe-- >0;)Te[Be.value++]=Ze}else{if(!(Be.value<Ve))return!1;Te[Be.value++]=M}de.c=G,de.lc=ee}function Y(M){return 65535&M}function re(M){const P=Y(M);return P>32767?P-65536:P}const J={a:0,b:0};function D(M,P){const G=re(M),ve=re(P),pe=G+(1&ve)+(ve>>1),Be=pe-ve;J.a=pe,J.b=Be}function ue(M,P){const G=Y(M),ee=Y(P),ve=G-(ee>>1)&65535;J.a=ee+ve-32768&65535,J.b=ve}function Ee(M,P,G,ee,ve,pe,Te){const Be=Te<16384,Ve=G>ve?ve:G;let Ze,bt,Fe=1;for(;Fe<=Ve;)Fe<<=1;for(Fe>>=1,Ze=Fe,Fe>>=1;Fe>=1;){bt=0;const rt=bt+pe*(ve-Ze),st=pe*Fe,ei=pe*Ze,at=ee*Fe,Ct=ee*Ze;let pi,Ji,vn,Zi;for(;bt<=rt;bt+=ei){let Pi=bt;const Ci=bt+ee*(G-Ze);for(;Pi<=Ci;Pi+=Ct){const ki=Pi+at,Zr=Pi+st,hr=Zr+at;Be?(D(M[Pi+P],M[Zr+P]),pi=J.a,vn=J.b,D(M[ki+P],M[hr+P]),Ji=J.a,Zi=J.b,D(pi,Ji),M[Pi+P]=J.a,M[ki+P]=J.b,D(vn,Zi),M[Zr+P]=J.a,M[hr+P]=J.b):(ue(M[Pi+P],M[Zr+P]),pi=J.a,vn=J.b,ue(M[ki+P],M[hr+P]),Ji=J.a,Zi=J.b,ue(pi,Ji),M[Pi+P]=J.a,M[ki+P]=J.b,ue(vn,Zi),M[Zr+P]=J.a,M[hr+P]=J.b)}if(G&Fe){const ki=Pi+st;Be?D(M[Pi+P],M[ki+P]):ue(M[Pi+P],M[ki+P]),pi=J.a,M[ki+P]=J.b,M[Pi+P]=pi}}if(ve&Fe){let Pi=bt;const Ci=bt+ee*(G-Ze);for(;Pi<=Ci;Pi+=Ct){const ki=Pi+at;Be?D(M[Pi+P],M[ki+P]):ue(M[Pi+P],M[ki+P]),pi=J.a,M[ki+P]=J.b,M[Pi+P]=pi}}Ze=Fe,Fe>>=1}return bt}function qe(M,P,G,ee,ve,pe){const Be=G.value,Ve=$e(P,G),Fe=$e(P,G);G.value+=4;const Ze=$e(P,G);if(G.value+=4,Ve<0||Ve>=65537||Fe<0||Fe>=65537)throw new Error("Something wrong with HUF_ENCSIZE");const bt=new Array(65537),rt=new Array(16384);if(function k(M){for(let P=0;P<16384;P++)M[P]={},M[P].len=0,M[P].lit=0,M[P].p=null}(rt),function B(M,P,G,ee,ve,pe){const Te=P;let Be=0,Ve=0;for(;ee<=ve;ee++){if(Te.value-P.value>G)return!1;L(6,Be,Ve,M,Te);const Fe=U.l;if(Be=U.c,Ve=U.lc,pe[ee]=Fe,63==Fe){if(Te.value-P.value>G)throw new Error("Something wrong with hufUnpackEncTable");L(8,Be,Ve,M,Te);let Ze=U.l+6;if(Be=U.c,Ve=U.lc,ee+Ze>ve+1)throw new Error("Something wrong with hufUnpackEncTable");for(;Ze--;)pe[ee++]=0;ee--}else if(Fe>=59){let Ze=Fe-59+2;if(ee+Ze>ve+1)throw new Error("Something wrong with hufUnpackEncTable");for(;Ze--;)pe[ee++]=0;ee--}}!function H(M){for(let G=0;G<=58;++G)j[G]=0;for(let G=0;G<65537;++G)j[M[G]]+=1;let P=0;for(let G=58;G>0;--G){const ee=P+j[G]>>1;j[G]=P,P=ee}for(let G=0;G<65537;++G){const ee=M[G];ee>0&&(M[G]=ee|j[ee]++<<6)}}(pe)}(M,G,ee-(G.value-Be),Ve,Fe,bt),Ze>8*(ee-(G.value-Be)))throw new Error("Something wrong with hufUncompress");(function Q(M,P,G,ee){for(;P<=G;P++){const ve=O(M[P]),pe=V(M[P]);if(ve>>pe)throw new Error("Invalid table entry");if(pe>14){const Te=ee[ve>>pe-14];if(Te.len)throw new Error("Invalid table entry");if(Te.lit++,Te.p){const Be=Te.p;Te.p=new Array(Te.lit);for(let Ve=0;Ve<Te.lit-1;++Ve)Te.p[Ve]=Be[Ve]}else Te.p=new Array(1);Te.p[Te.lit-1]=P}else if(pe){let Te=0;for(let Be=1<<14-pe;Be>0;Be--){const Ve=ee[(ve<<14-pe)+Te];if(Ve.len||Ve.p)throw new Error("Invalid table entry");Ve.len=pe,Ve.lit=P,Te++}}}})(bt,Ve,Fe,rt),function me(M,P,G,ee,ve,pe,Te,Be,Ve){let Fe=0,Ze=0;const bt=Te,rt=Math.trunc(ee.value+(ve+7)/8);for(;ee.value<rt;)for(be(Fe,Ze,G,ee),Fe=oe.c,Ze=oe.lc;Ze>=14;){const at=P[Fe>>Ze-14&16383];if(at.len)Ze-=at.len,X(at.lit,pe,Fe,Ze,G,ee,Be,Ve,bt),Fe=de.c,Ze=de.lc;else{if(!at.p)throw new Error("hufDecode issues");let Ct;for(Ct=0;Ct<at.lit;Ct++){const pi=V(M[at.p[Ct]]);for(;Ze<pi&&ee.value<rt;)be(Fe,Ze,G,ee),Fe=oe.c,Ze=oe.lc;if(Ze>=pi&&O(M[at.p[Ct]])==(Fe>>Ze-pi&(1<<pi)-1)){Ze-=pi,X(at.p[Ct],pe,Fe,Ze,G,ee,Be,Ve,bt),Fe=de.c,Ze=de.lc;break}}if(Ct==at.lit)throw new Error("hufDecode issues")}}const st=8-ve&7;for(Fe>>=st,Ze-=st;Ze>0;){const ei=P[Fe<<14-Ze&16383];if(!ei.len)throw new Error("hufDecode issues");Ze-=ei.len,X(ei.lit,pe,Fe,Ze,G,ee,Be,Ve,bt),Fe=de.c,Ze=de.lc}}(bt,rt,M,G,Ze,Fe,pe,ve,{value:0})}function we(M){for(let P=1;P<M.length;P++)M[P]=M[P-1]+M[P]-128}function Se(M,P){let G=0,ee=Math.floor((M.length+1)/2),ve=0;const pe=M.length-1;for(;!(ve>pe||(P[ve++]=M[G++],ve>pe));)P[ve++]=M[ee++]}function it(M){let P=M.byteLength;const G=new Array;let ee=0;const ve=new DataView(M);for(;P>0;){const pe=ve.getInt8(ee++);if(pe<0){const Te=-pe;P-=Te+1;for(let Be=0;Be<Te;Be++)G.push(ve.getUint8(ee++))}else{const Te=pe;P-=2;const Be=ve.getUint8(ee++);for(let Ve=0;Ve<Te+1;Ve++)G.push(Be)}}return G}function At(M,P,G){let ee,ve=1;for(;ve<64;)ee=P[M.value],65280==ee?ve=64:ee>>8==255?ve+=255&ee:(G[ve]=ee,ve++),M.value++}function yt(M,P){P[0]=te(M[0]),P[1]=te(M[1]),P[2]=te(M[5]),P[3]=te(M[6]),P[4]=te(M[14]),P[5]=te(M[15]),P[6]=te(M[27]),P[7]=te(M[28]),P[8]=te(M[2]),P[9]=te(M[4]),P[10]=te(M[7]),P[11]=te(M[13]),P[12]=te(M[16]),P[13]=te(M[26]),P[14]=te(M[29]),P[15]=te(M[42]),P[16]=te(M[3]),P[17]=te(M[8]),P[18]=te(M[12]),P[19]=te(M[17]),P[20]=te(M[25]),P[21]=te(M[30]),P[22]=te(M[41]),P[23]=te(M[43]),P[24]=te(M[9]),P[25]=te(M[11]),P[26]=te(M[18]),P[27]=te(M[24]),P[28]=te(M[31]),P[29]=te(M[40]),P[30]=te(M[44]),P[31]=te(M[53]),P[32]=te(M[10]),P[33]=te(M[19]),P[34]=te(M[23]),P[35]=te(M[32]),P[36]=te(M[39]),P[37]=te(M[45]),P[38]=te(M[52]),P[39]=te(M[54]),P[40]=te(M[20]),P[41]=te(M[22]),P[42]=te(M[33]),P[43]=te(M[38]),P[44]=te(M[46]),P[45]=te(M[51]),P[46]=te(M[55]),P[47]=te(M[60]),P[48]=te(M[21]),P[49]=te(M[34]),P[50]=te(M[37]),P[51]=te(M[47]),P[52]=te(M[50]),P[53]=te(M[56]),P[54]=te(M[59]),P[55]=te(M[61]),P[56]=te(M[35]),P[57]=te(M[36]),P[58]=te(M[48]),P[59]=te(M[49]),P[60]=te(M[57]),P[61]=te(M[58]),P[62]=te(M[62]),P[63]=te(M[63])}function lt(M){const P=.5*Math.cos(.7853975),G=.5*Math.cos(3.14159/16),ee=.5*Math.cos(3.14159/8),ve=.5*Math.cos(3*3.14159/16),pe=.5*Math.cos(.981746875),Te=.5*Math.cos(3*3.14159/8),Be=.5*Math.cos(1.374445625),Ve=new Array(4),Fe=new Array(4),Ze=new Array(4),bt=new Array(4);for(let rt=0;rt<8;++rt){const st=8*rt;Ve[0]=ee*M[st+2],Ve[1]=Te*M[st+2],Ve[2]=ee*M[st+6],Ve[3]=Te*M[st+6],Fe[0]=G*M[st+1]+ve*M[st+3]+pe*M[st+5]+Be*M[st+7],Fe[1]=ve*M[st+1]-Be*M[st+3]-G*M[st+5]-pe*M[st+7],Fe[2]=pe*M[st+1]-G*M[st+3]+Be*M[st+5]+ve*M[st+7],Fe[3]=Be*M[st+1]-pe*M[st+3]+ve*M[st+5]-G*M[st+7],Ze[0]=P*(M[st+0]+M[st+4]),Ze[3]=P*(M[st+0]-M[st+4]),Ze[1]=Ve[0]+Ve[3],Ze[2]=Ve[1]-Ve[2],bt[0]=Ze[0]+Ze[1],bt[1]=Ze[3]+Ze[2],bt[2]=Ze[3]-Ze[2],bt[3]=Ze[0]-Ze[1],M[st+0]=bt[0]+Fe[0],M[st+1]=bt[1]+Fe[1],M[st+2]=bt[2]+Fe[2],M[st+3]=bt[3]+Fe[3],M[st+4]=bt[3]-Fe[3],M[st+5]=bt[2]-Fe[2],M[st+6]=bt[1]-Fe[1],M[st+7]=bt[0]-Fe[0]}for(let rt=0;rt<8;++rt)Ve[0]=ee*M[16+rt],Ve[1]=Te*M[16+rt],Ve[2]=ee*M[48+rt],Ve[3]=Te*M[48+rt],Fe[0]=G*M[8+rt]+ve*M[24+rt]+pe*M[40+rt]+Be*M[56+rt],Fe[1]=ve*M[8+rt]-Be*M[24+rt]-G*M[40+rt]-pe*M[56+rt],Fe[2]=pe*M[8+rt]-G*M[24+rt]+Be*M[40+rt]+ve*M[56+rt],Fe[3]=Be*M[8+rt]-pe*M[24+rt]+ve*M[40+rt]-G*M[56+rt],Ze[0]=P*(M[rt]+M[32+rt]),Ze[3]=P*(M[rt]-M[32+rt]),Ze[1]=Ve[0]+Ve[3],Ze[2]=Ve[1]-Ve[2],bt[0]=Ze[0]+Ze[1],bt[1]=Ze[3]+Ze[2],bt[2]=Ze[3]-Ze[2],bt[3]=Ze[0]-Ze[1],M[0+rt]=bt[0]+Fe[0],M[8+rt]=bt[1]+Fe[1],M[16+rt]=bt[2]+Fe[2],M[24+rt]=bt[3]+Fe[3],M[32+rt]=bt[3]-Fe[3],M[40+rt]=bt[2]-Fe[2],M[48+rt]=bt[1]-Fe[1],M[56+rt]=bt[0]-Fe[0]}function ht(M){for(let P=0;P<64;++P){const G=M[0][P],ee=M[1][P],ve=M[2][P];M[0][P]=G+1.5747*ve,M[1][P]=G-.1873*ee-.4682*ve,M[2][P]=G+1.8556*ee}}function xt(M,P,G){for(let ee=0;ee<64;++ee)P[G+ee]=cs.toHalfFloat(N(M[ee]))}function N(M){return M<=1?Math.sign(M)*Math.pow(Math.abs(M),2.2):Math.sign(M)*Math.pow(C,Math.abs(M)-1)}function F(M){return new DataView(M.array.buffer,M.offset.value,M.size)}function Ae(M){const P=M.viewer.buffer.slice(M.offset.value,M.offset.value+M.size),G=new Uint8Array(it(P)),ee=new Uint8Array(G.length);return we(G),Se(G,ee),new DataView(ee.buffer)}function ke(M){const G=jc(M.array.slice(M.offset.value,M.offset.value+M.size)),ee=new Uint8Array(G.length);return we(G),Se(G,ee),new DataView(ee.buffer)}function Ue(M){const P=M.viewer,G={value:M.offset.value},ee=new Uint16Array(M.width*M.scanlineBlockSize*(M.channels*M.type)),ve=new Uint8Array(8192);let pe=0;const Te=new Array(M.channels);for(let ei=0;ei<M.channels;ei++)Te[ei]={},Te[ei].start=pe,Te[ei].end=Te[ei].start,Te[ei].nx=M.width,Te[ei].ny=M.lines,Te[ei].size=M.type,pe+=Te[ei].nx*Te[ei].ny*Te[ei].size;const Be=Ge(P,G),Ve=Ge(P,G);if(Ve>=8192)throw new Error("Something is wrong with PIZ_COMPRESSION BITMAP_SIZE");if(Be<=Ve)for(let ei=0;ei<Ve-Be+1;ei++)ve[ei+Be]=Lt(P,G);const Fe=new Uint16Array(65536),Ze=function T(M,P){let G=0;for(let ve=0;ve<65536;++ve)(0==ve||M[ve>>3]&1<<(7&ve))&&(P[G++]=ve);const ee=G-1;for(;G<65536;)P[G++]=0;return ee}(ve,Fe),bt=$e(P,G);qe(M.array,P,G,bt,ee,pe);for(let ei=0;ei<M.channels;++ei){const at=Te[ei];for(let Ct=0;Ct<Te[ei].size;++Ct)Ee(ee,at.start+Ct,at.nx,at.size,at.ny,at.nx*at.size,Ze)}!function Me(M,P,G){for(let ee=0;ee<G;++ee)P[ee]=M[P[ee]]}(Fe,ee,pe);let rt=0;const st=new Uint8Array(ee.buffer.byteLength);for(let ei=0;ei<M.lines;ei++)for(let at=0;at<M.channels;at++){const Ct=Te[at],pi=Ct.nx*Ct.size,Ji=new Uint8Array(ee.buffer,2*Ct.end,2*pi);st.set(Ji,rt),rt+=2*pi,Ct.end+=pi}return new DataView(st.buffer)}function et(M){const G=jc(M.array.slice(M.offset.value,M.offset.value+M.size)),ee=M.lines*M.channels*M.width,ve=1==M.type?new Uint16Array(ee):new Uint32Array(ee);let pe=0,Te=0;const Be=new Array(4);for(let Ve=0;Ve<M.lines;Ve++)for(let Fe=0;Fe<M.channels;Fe++){let Ze=0;switch(M.type){case 1:Be[0]=pe,Be[1]=Be[0]+M.width,pe=Be[1]+M.width;for(let bt=0;bt<M.width;++bt)Ze+=G[Be[0]++]<<8|G[Be[1]++],ve[Te]=Ze,Te++;break;case 2:Be[0]=pe,Be[1]=Be[0]+M.width,Be[2]=Be[1]+M.width,pe=Be[2]+M.width;for(let bt=0;bt<M.width;++bt)Ze+=G[Be[0]++]<<24|G[Be[1]++]<<16|G[Be[2]++]<<8,ve[Te]=Ze,Te++}}return new DataView(ve.buffer)}function Z(M){const P=M.viewer,G={value:M.offset.value},ee=new Uint8Array(M.width*M.lines*(M.channels*M.type*2)),ve={version:It(P,G),unknownUncompressedSize:It(P,G),unknownCompressedSize:It(P,G),acCompressedSize:It(P,G),dcCompressedSize:It(P,G),rleCompressedSize:It(P,G),rleUncompressedSize:It(P,G),rleRawSize:It(P,G),totalAcUncompressedCount:It(P,G),totalDcUncompressedCount:It(P,G),acCompression:It(P,G)};if(ve.version<2)throw new Error("EXRLoader.parse: "+z.compression+" version "+ve.version+" is unsupported");const pe=new Array;let Te=Ge(P,G)-2;for(;Te>0;){const at=Ie(P.buffer,G),Ct=Lt(P,G),pi=Ct>>2&3,vn=new Int8Array([(Ct>>4)-1])[0],Zi=Lt(P,G);pe.push({name:at,index:vn,type:Zi,compression:pi}),Te-=at.length+3}const Be=z.channels,Ve=new Array(M.channels);for(let at=0;at<M.channels;++at){const Ct=Ve[at]={},pi=Be[at];Ct.name=pi.name,Ct.compression=0,Ct.decoded=!1,Ct.type=pi.pixelType,Ct.pLinear=pi.pLinear,Ct.width=M.width,Ct.height=M.lines}const Fe={idx:new Array(3)};for(let at=0;at<M.channels;++at){const Ct=Ve[at];for(let pi=0;pi<pe.length;++pi){const Ji=pe[pi];Ct.name==Ji.name&&(Ct.compression=Ji.compression,Ji.index>=0&&(Fe.idx[Ji.index]=at),Ct.offset=at)}}let Ze,bt,rt;if(ve.acCompressedSize>0)switch(ve.acCompression){case 0:Ze=new Uint16Array(ve.totalAcUncompressedCount),qe(M.array,P,G,ve.acCompressedSize,Ze,ve.totalAcUncompressedCount);break;case 1:const Ct=jc(M.array.slice(G.value,G.value+ve.totalAcUncompressedCount));Ze=new Uint16Array(Ct.buffer),G.value+=ve.totalAcUncompressedCount}ve.dcCompressedSize>0&&(bt=new Uint16Array(ke({array:M.array,offset:G,size:ve.dcCompressedSize}).buffer),G.value+=ve.dcCompressedSize),ve.rleRawSize>0&&(rt=it(jc(M.array.slice(G.value,G.value+ve.rleCompressedSize)).buffer),G.value+=ve.rleCompressedSize);let st=0;const ei=new Array(Ve.length);for(let at=0;at<ei.length;++at)ei[at]=new Array;for(let at=0;at<M.lines;++at)for(let Ct=0;Ct<Ve.length;++Ct)ei[Ct].push(st),st+=Ve[Ct].width*M.type*2;!function Xe(M,P,G,ee,ve,pe){let Te=new DataView(pe.buffer);const Be=G[M.idx[0]].width,Ve=G[M.idx[0]].height,Ze=Math.floor(Be/8),bt=Math.ceil(Be/8),rt=Math.ceil(Ve/8),st=Be-8*(bt-1),ei=Ve-8*(rt-1),at={value:0},Ct=new Array(3),pi=new Array(3),Ji=new Array(3),vn=new Array(3),Zi=new Array(3);for(let Ci=0;Ci<3;++Ci)Zi[Ci]=P[M.idx[Ci]],Ct[Ci]=Ci<1?0:Ct[Ci-1]+bt*rt,pi[Ci]=new Float32Array(64),Ji[Ci]=new Uint16Array(64),vn[Ci]=new Uint16Array(64*bt);for(let Ci=0;Ci<rt;++Ci){let ki=8;Ci==rt-1&&(ki=ei);let Zr=8;for(let Fi=0;Fi<bt;++Fi){Fi==bt-1&&(Zr=st);for(let dn=0;dn<3;++dn)Ji[dn].fill(0),Ji[dn][0]=ve[Ct[dn]++],At(at,ee,Ji[dn]),yt(Ji[dn],pi[dn]),lt(pi[dn]);ht(pi);for(let dn=0;dn<3;++dn)xt(pi[dn],vn[dn],64*Fi)}let hr=0;for(let Fi=0;Fi<3;++Fi){const dn=G[M.idx[Fi]].type;for(let Yl=8*Ci;Yl<8*Ci+ki;++Yl){hr=Zi[Fi][Yl];for(let uv=0;uv<Ze;++uv){const sl=64*uv+8*(7&Yl);Te.setUint16(hr+0*dn,vn[Fi][sl+0],!0),Te.setUint16(hr+2*dn,vn[Fi][sl+1],!0),Te.setUint16(hr+4*dn,vn[Fi][sl+2],!0),Te.setUint16(hr+6*dn,vn[Fi][sl+3],!0),Te.setUint16(hr+8*dn,vn[Fi][sl+4],!0),Te.setUint16(hr+10*dn,vn[Fi][sl+5],!0),Te.setUint16(hr+12*dn,vn[Fi][sl+6],!0),Te.setUint16(hr+14*dn,vn[Fi][sl+7],!0),hr+=16*dn}}if(Ze!=bt)for(let Yl=8*Ci;Yl<8*Ci+ki;++Yl){const uv=Zi[Fi][Yl]+8*Ze*2*dn,sl=64*Ze+8*(7&Yl);for(let fM=0;fM<Zr;++fM)Te.setUint16(uv+2*fM*dn,vn[Fi][sl+fM],!0)}}}const Pi=new Uint16Array(Be);Te=new DataView(pe.buffer);for(let Ci=0;Ci<3;++Ci){G[M.idx[Ci]].decoded=!0;const ki=G[M.idx[Ci]].type;if(2==G[Ci].type)for(let Zr=0;Zr<Ve;++Zr){const hr=Zi[Ci][Zr];for(let Fi=0;Fi<Be;++Fi)Pi[Fi]=Te.getUint16(hr+2*Fi*ki,!0);for(let Fi=0;Fi<Be;++Fi)Te.setFloat32(hr+2*Fi*ki,te(Pi[Fi]),!0)}}}(Fe,ei,Ve,Ze,bt,ee);for(let at=0;at<Ve.length;++at){const Ct=Ve[at];if(!Ct.decoded){if(2!==Ct.compression)throw new Error("EXRLoader.parse: unsupported channel compression");{let pi=0,Ji=0;for(let vn=0;vn<M.lines;++vn){let Zi=ei[at][pi];for(let Pi=0;Pi<Ct.width;++Pi){for(let Ci=0;Ci<2*Ct.type;++Ci)ee[Zi++]=rt[Ji+Ci*Ct.width*Ct.height];Ji++}pi++}}}}return new DataView(ee.buffer)}function Ie(M,P){const G=new Uint8Array(M);let ee=0;for(;0!=G[P.value+ee];)ee+=1;const ve=(new TextDecoder).decode(G.slice(P.value,P.value+ee));return P.value=P.value+ee+1,ve}function pt(M,P){const G=M.getInt32(P.value,!0);return P.value=P.value+4,G}function $e(M,P){const G=M.getUint32(P.value,!0);return P.value=P.value+4,G}function tt(M,P){const G=M[P.value];return P.value=P.value+1,G}function Lt(M,P){const G=M.getUint8(P.value);return P.value=P.value+1,G}const It=function(M,P){let G;return G="getBigInt64"in DataView.prototype?Number(M.getBigInt64(P.value,!0)):M.getUint32(P.value+4,!0)+Number(M.getUint32(P.value,!0)<<32),P.value+=8,G};function Jt(M,P){const G=M.getFloat32(P.value,!0);return P.value+=4,G}function se(M,P){return cs.toHalfFloat(Jt(M,P))}function te(M){const P=(31744&M)>>10,G=1023&M;return(M>>15?-1:1)*(P?31===P?G?NaN:1/0:Math.pow(2,P-15)*(1+G/1024):G/1024*6103515625e-14)}function Ge(M,P){const G=M.getUint16(P.value,!0);return P.value+=2,G}function mt(M,P){return te(Ge(M,P))}function Go(M,P,G,ee,ve){return"string"===ee||"stringvector"===ee||"iccProfile"===ee?function ye(M,P,G){const ee=(new TextDecoder).decode(new Uint8Array(M).slice(P.value,P.value+G));return P.value=P.value+G,ee}(P,G,ve):"chlist"===ee?function Dt(M,P,G,ee){const ve=G.value,pe=[];for(;G.value<ve+ee-1;){const Te=Ie(P,G),Be=pt(M,G),Ve=Lt(M,G);G.value+=3;const Fe=pt(M,G),Ze=pt(M,G);pe.push({name:Te,pixelType:Be,pLinear:Ve,xSampling:Fe,ySampling:Ze})}return G.value+=1,pe}(M,P,G,ve):"chromaticities"===ee?function rn(M,P){return{redX:Jt(M,P),redY:Jt(M,P),greenX:Jt(M,P),greenY:Jt(M,P),blueX:Jt(M,P),blueY:Jt(M,P),whiteX:Jt(M,P),whiteY:Jt(M,P)}}(M,G):"compression"===ee?function bn(M,P){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][Lt(M,P)]}(M,G):"box2i"===ee?function Sr(M,P){return{xMin:$e(M,P),yMin:$e(M,P),xMax:$e(M,P),yMax:$e(M,P)}}(M,G):"lineOrder"===ee?function rl(M,P){return["INCREASING_Y"][Lt(M,P)]}(M,G):"float"===ee?Jt(M,G):"v2f"===ee?function Bn(M,P){return[Jt(M,P),Jt(M,P)]}(M,G):"v3f"===ee?function Ns(M,P){return[Jt(M,P),Jt(M,P),Jt(M,P)]}(M,G):"int"===ee?pt(M,G):"rational"===ee?function Je(M,P){return[pt(M,P),$e(M,P)]}(M,G):"timecode"===ee?function ct(M,P){return[$e(M,P),$e(M,P)]}(M,G):"preview"===ee?(G.value+=ve,"skipped"):void(G.value+=ve)}const Lg=new DataView(e),Z2=new Uint8Array(e),yh={value:0},z=function Bg(M,P,G){const ee={};if(20000630!=M.getUint32(0,!0))throw new Error("THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.");ee.version=M.getUint8(4);const ve=M.getUint8(5);ee.spec={singleTile:!!(2&ve),longName:!!(4&ve),deepFormat:!!(8&ve),multiPart:!!(16&ve)},G.value=8;let pe=!0;for(;pe;){const Te=Ie(P,G);if(0==Te)pe=!1;else{const Be=Ie(P,G),Fe=Go(M,P,G,Be,$e(M,G));void 0===Fe?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${Be}'.`):ee[Te]=Fe}}if(-5&ve)throw console.error("EXRHeader:",ee),new Error("THREE.EXRLoader: provided file is currently unsupported.");return ee}(Lg,e,yh),ce=function hM(M,P,G,ee,ve){const pe={size:0,viewer:P,array:G,offset:ee,width:M.dataWindow.xMax-M.dataWindow.xMin+1,height:M.dataWindow.yMax-M.dataWindow.yMin+1,channels:M.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:M.channels[0].pixelType,uncompress:null,getter:null,format:null,encoding:null};switch(M.compression){case"NO_COMPRESSION":pe.lines=1,pe.uncompress=F;break;case"RLE_COMPRESSION":pe.lines=1,pe.uncompress=Ae;break;case"ZIPS_COMPRESSION":pe.lines=1,pe.uncompress=ke;break;case"ZIP_COMPRESSION":pe.lines=16,pe.uncompress=ke;break;case"PIZ_COMPRESSION":pe.lines=32,pe.uncompress=Ue;break;case"PXR24_COMPRESSION":pe.lines=16,pe.uncompress=et;break;case"DWAA_COMPRESSION":pe.lines=32,pe.uncompress=Z;break;case"DWAB_COMPRESSION":pe.lines=256,pe.uncompress=Z;break;default:throw new Error("EXRLoader.parse: "+M.compression+" is unsupported")}if(pe.scanlineBlockSize=pe.lines,1==pe.type)switch(ve){case Un:pe.getter=mt,pe.inputSize=2;break;case mn:pe.getter=Ge,pe.inputSize=2}else{if(2!=pe.type)throw new Error("EXRLoader.parse: unsupported pixelType "+pe.type+" for "+M.compression+".");switch(ve){case Un:pe.getter=Jt,pe.inputSize=4;break;case mn:pe.getter=se,pe.inputSize=4}}pe.blockCount=(M.dataWindow.yMax+1)/pe.scanlineBlockSize;for(let Be=0;Be<pe.blockCount;Be++)It(P,ee);pe.outputChannels=3==pe.channels?4:pe.channels;const Te=pe.width*pe.height*pe.outputChannels;switch(ve){case Un:pe.byteArray=new Float32Array(Te),pe.channels<pe.outputChannels&&pe.byteArray.fill(1,0,Te);break;case mn:pe.byteArray=new Uint16Array(Te),pe.channels<pe.outputChannels&&pe.byteArray.fill(15360,0,Te);break;default:console.error("THREE.EXRLoader: unsupported type: ",ve)}return pe.bytesPerLine=pe.width*pe.inputSize*pe.channels,4==pe.outputChannels?(pe.format=Rn,pe.encoding=$s):(pe.format=Cl,pe.encoding=$s),pe}(z,Lg,Z2,yh,this.type),De={value:0},_e={R:0,G:1,B:2,A:3,Y:0};for(let M=0;M<ce.height/ce.scanlineBlockSize;M++){const P=$e(Lg,yh);ce.size=$e(Lg,yh),ce.lines=P+ce.scanlineBlockSize>ce.height?ce.height-P:ce.scanlineBlockSize;const ee=ce.size<ce.lines*ce.bytesPerLine?ce.uncompress(ce):F(ce);yh.value+=ce.size;for(let ve=0;ve<ce.scanlineBlockSize;ve++){const pe=ve+M*ce.scanlineBlockSize;if(pe>=ce.height)break;for(let Te=0;Te<ce.channels;Te++){const Be=_e[z.channels[Te].name];for(let Ve=0;Ve<ce.width;Ve++)De.value=(ve*(ce.channels*ce.width)+Te*ce.width+Ve)*ce.inputSize,ce.byteArray[ce.width*ce.outputChannels*(ce.height-1-pe)+Ve*ce.outputChannels+Be]=ce.getter(ee,De)}}}return{header:z,width:ce.width,height:ce.height,data:ce.byteArray,format:ce.format,encoding:ce.encoding,type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,r){return super.load(e,function s(o,a){o.encoding=a.encoding,o.minFilter=Ui,o.magFilter=Ui,o.generateMipmaps=!1,o.flipY=!1,t&&t(o,a)},n,r)}}class sd extends Lo{constructor(){super(...arguments),this.clazz=_ve}}sd.\u0275fac=function(){let i;return function(t){return(i||(i=le(sd)))(t||sd)}}(),sd.\u0275prov=He({token:sd,factory:sd.\u0275fac,providedIn:"root"});class xC extends ua{constructor(e){super(),this.service=e}}xC.\u0275fac=function(e){return new(e||xC)(I(sd,16))},xC.\u0275pipe=_i({name:"loadEXRTexture",type:xC,pure:!0});class wC extends ks{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}wC.\u0275fac=function(e){return new(e||wC)(I(_a,1),I(gt),I(sd))},wC.\u0275dir=Ne({type:wC,selectors:[["","loadEXRTexture",""]],features:[q]});class bve extends Ep{constructor(e){super(e),this.type=mn}parse(e){const a=function(b,y){switch(b){case 1:console.error("THREE.RGBELoader Read Error: "+(y||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(y||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(y||""));break;default:console.error("THREE.RGBELoader: Error: "+(y||""))}return-1},h=function(b,y,x){y=y||1024;let E=b.pos,S=-1,C=0,T="",k=String.fromCharCode.apply(null,new Uint16Array(b.subarray(E,E+128)));for(;0>(S=k.indexOf("\n"))&&C<y&&E<b.byteLength;)T+=k,C+=k.length,E+=128,k+=String.fromCharCode.apply(null,new Uint16Array(b.subarray(E,E+128)));return-1<S&&(!1!==x&&(b.pos+=C+S+1),T+k.slice(0,S))},_=function(b,y,x,w){const S=Math.pow(2,b[y+3]-128)/255;x[w+0]=b[y+0]*S,x[w+1]=b[y+1]*S,x[w+2]=b[y+2]*S,x[w+3]=1},g=function(b,y,x,w){const S=Math.pow(2,b[y+3]-128)/255;x[w+0]=cs.toHalfFloat(Math.min(b[y+0]*S,65504)),x[w+1]=cs.toHalfFloat(Math.min(b[y+1]*S,65504)),x[w+2]=cs.toHalfFloat(Math.min(b[y+2]*S,65504)),x[w+3]=cs.toHalfFloat(1)},p=new Uint8Array(e);p.pos=0;const v=function(b){const x=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,w=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,E=/^\s*FORMAT=(\S+)\s*$/,S=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,C={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let T,k;if(b.pos>=b.byteLength||!(T=h(b)))return a(1,"no header found");if(!(k=T.match(/^#\?(\S+)/)))return a(3,"bad initial token");for(C.valid|=1,C.programtype=k[1],C.string+=T+"\n";T=h(b),!1!==T;)if(C.string+=T+"\n","#"!==T.charAt(0)){if((k=T.match(x))&&(C.gamma=parseFloat(k[1])),(k=T.match(w))&&(C.exposure=parseFloat(k[1])),(k=T.match(E))&&(C.valid|=2,C.format=k[1]),(k=T.match(S))&&(C.valid|=4,C.height=parseInt(k[1],10),C.width=parseInt(k[2],10)),2&C.valid&&4&C.valid)break}else C.comments+=T+"\n";return 2&C.valid?4&C.valid?C:a(3,"missing image size specifier"):a(3,"missing format specifier")}(p);if(-1!==v){const b=v.width,y=v.height,x=function(b,y,x){const w=y;if(w<8||w>32767||2!==b[0]||2!==b[1]||128&b[2])return new Uint8Array(b);if(w!==(b[2]<<8|b[3]))return a(3,"wrong scanline width");const E=new Uint8Array(4*y*x);if(!E.length)return a(4,"unable to allocate buffer space");let S=0,C=0;const T=4*w,k=new Uint8Array(4),U=new Uint8Array(T);let L=x;for(;L>0&&C<b.byteLength;){if(C+4>b.byteLength)return a(1);if(k[0]=b[C++],k[1]=b[C++],k[2]=b[C++],k[3]=b[C++],2!=k[0]||2!=k[1]||(k[2]<<8|k[3])!=w)return a(3,"bad rgbe scanline format");let H,j=0;for(;j<T&&C<b.byteLength;){H=b[C++];const V=H>128;if(V&&(H-=128),0===H||j+H>T)return a(3,"bad scanline data");if(V){const O=b[C++];for(let Q=0;Q<H;Q++)U[j++]=O}else U.set(b.subarray(C,C+H),j),j+=H,C+=H}const B=w;for(let V=0;V<B;V++){let O=0;E[S]=U[V+O],O+=w,E[S+1]=U[V+O],O+=w,E[S+2]=U[V+O],O+=w,E[S+3]=U[V+O],S+=4}L--}return E}(p.subarray(p.pos),b,y);if(-1!==x){let w,E,S;switch(this.type){case Un:S=x.length/4;const C=new Float32Array(4*S);for(let k=0;k<S;k++)_(x,4*k,C,4*k);w=C,E=Un;break;case mn:S=x.length/4;const T=new Uint16Array(4*S);for(let k=0;k<S;k++)g(x,4*k,T,4*k);w=T,E=mn;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:b,height:y,data:w,header:v.string,gamma:v.gamma,exposure:v.exposure,type:E}}}return null}setDataType(e){return this.type=e,this}load(e,t,n,r){return super.load(e,function s(o,a){switch(o.type){case Un:case mn:o.encoding=$s,o.minFilter=Ui,o.magFilter=Ui,o.generateMipmaps=!1,o.flipY=!0}t&&t(o,a)},n,r)}}class od extends Lo{constructor(){super(...arguments),this.clazz=bve}}od.\u0275fac=function(){let i;return function(t){return(i||(i=le(od)))(t||od)}}(),od.\u0275prov=He({token:od,factory:od.\u0275fac,providedIn:"root"});class CC extends ua{constructor(e){super(),this.service=e}}CC.\u0275fac=function(e){return new(e||CC)(I(od,16))},CC.\u0275pipe=_i({name:"loadRGBETexture",type:CC,pure:!0});class MC extends ks{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}MC.\u0275fac=function(e){return new(e||MC)(I(_a,1),I(gt),I(od))},MC.\u0275dir=Ne({type:MC,selectors:[["","loadRGBETexture",""]],features:[q]});class vve extends Ep{constructor(e){super(e),this.type=mn,this.maxRange=7}setDataType(e){return this.type=e,this}setMaxRange(e){return this.maxRange=e,this}loadCubemap(e,t,n,r){const s=new Jd;let o=0;const a=this;function l(c){a.load(e[c],function(d){s.images[c]=d,o++,6===o&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s.type=this.type,s.format=Rn,s.minFilter=Ui,s.generateMipmaps=!1,s}parse(e){const t=ri.decode(e),n=ri.toRGBA8(t)[0],r=new Uint8Array(n),s=t.width*t.height*4,o=this.type===mn?new Uint16Array(s):new Float32Array(s);for(let a=0;a<r.length;a+=4){const l=r[a+0]/255,c=r[a+1]/255,d=r[a+2]/255,u=r[a+3]/255;this.type===mn?(o[a+0]=cs.toHalfFloat(Math.min(l*u*this.maxRange,65504)),o[a+1]=cs.toHalfFloat(Math.min(c*u*this.maxRange,65504)),o[a+2]=cs.toHalfFloat(Math.min(d*u*this.maxRange,65504)),o[a+3]=cs.toHalfFloat(1)):(o[a+0]=l*u*this.maxRange,o[a+1]=c*u*this.maxRange,o[a+2]=d*u*this.maxRange,o[a+3]=1)}return{width:t.width,height:t.height,data:o,format:Rn,type:this.type,flipY:!0}}}var e,t,i,ri={toRGBA8:function(i){var e=i.width,t=i.height;if(null==i.tabs.acTL)return[ri.toRGBA8.decodeImage(i.data,e,t,i).buffer];var n=[];null==i.frames[0].data&&(i.frames[0].data=i.data);for(var r=e*t*4,s=new Uint8Array(r),o=new Uint8Array(r),a=new Uint8Array(r),l=0;l<i.frames.length;l++){var c=i.frames[l],d=c.rect.x,u=c.rect.y,h=c.rect.width,f=c.rect.height,m=ri.toRGBA8.decodeImage(c.data,h,f,i);if(0!=l)for(var _=0;_<r;_++)a[_]=s[_];if(0==c.blend?ri._copyTile(m,h,f,s,e,t,d,u,0):1==c.blend&&ri._copyTile(m,h,f,s,e,t,d,u,1),n.push(s.buffer.slice(0)),1==c.dispose)ri._copyTile(o,h,f,s,e,t,d,u,0);else if(2==c.dispose)for(_=0;_<r;_++)s[_]=a[_]}return n}};ri.toRGBA8.decodeImage=function(i,e,t,n){var r=e*t,s=ri.decode._getBPP(n),o=Math.ceil(e*s/8),a=new Uint8Array(4*r),l=new Uint32Array(a.buffer),c=n.ctype,d=n.depth,u=ri._bin.readUshort;if(6==c){var h=r<<2;if(8==d)for(var f=0;f<h;f+=4)a[f]=i[f],a[f+1]=i[f+1],a[f+2]=i[f+2],a[f+3]=i[f+3];if(16==d)for(f=0;f<h;f++)a[f]=i[f<<1]}else if(2==c){var m=n.tabs.tRNS;if(null==m){if(8==d)for(f=0;f<r;f++)l[f]=255<<24|i[2+(_=3*f)]<<16|i[_+1]<<8|i[_];if(16==d)for(f=0;f<r;f++)l[f]=255<<24|i[4+(_=6*f)]<<16|i[_+2]<<8|i[_]}else{var g=m[0],p=m[1],v=m[2];if(8==d)for(f=0;f<r;f++){var b=f<<2;l[f]=255<<24|i[2+(_=3*f)]<<16|i[_+1]<<8|i[_],i[_]==g&&i[_+1]==p&&i[_+2]==v&&(a[b+3]=0)}if(16==d)for(f=0;f<r;f++){var _;b=f<<2,l[f]=255<<24|i[4+(_=6*f)]<<16|i[_+2]<<8|i[_],u(i,_)==g&&u(i,_+2)==p&&u(i,_+4)==v&&(a[b+3]=0)}}}else if(3==c){var y=n.tabs.PLTE,x=n.tabs.tRNS,w=x?x.length:0;if(1==d)for(var E=0;E<t;E++){var S=E*o,C=E*e;for(f=0;f<e;f++)a[b=C+f<<2]=y[k=3*(T=i[S+(f>>3)]>>7-((7&f)<<0)&1)],a[b+1]=y[k+1],a[b+2]=y[k+2],a[b+3]=T<w?x[T]:255}if(2==d)for(E=0;E<t;E++)for(S=E*o,C=E*e,f=0;f<e;f++)a[b=C+f<<2]=y[k=3*(T=i[S+(f>>2)]>>6-((3&f)<<1)&3)],a[b+1]=y[k+1],a[b+2]=y[k+2],a[b+3]=T<w?x[T]:255;if(4==d)for(E=0;E<t;E++)for(S=E*o,C=E*e,f=0;f<e;f++)a[b=C+f<<2]=y[k=3*(T=i[S+(f>>1)]>>4-((1&f)<<2)&15)],a[b+1]=y[k+1],a[b+2]=y[k+2],a[b+3]=T<w?x[T]:255;if(8==d)for(f=0;f<r;f++){var T,k;a[b=f<<2]=y[k=3*(T=i[f])],a[b+1]=y[k+1],a[b+2]=y[k+2],a[b+3]=T<w?x[T]:255}}else if(4==c){if(8==d)for(f=0;f<r;f++)a[b=f<<2]=L=i[U=f<<1],a[b+1]=L,a[b+2]=L,a[b+3]=i[U+1];if(16==d)for(f=0;f<r;f++){var U;a[b=f<<2]=L=i[U=f<<2],a[b+1]=L,a[b+2]=L,a[b+3]=i[U+2]}}else if(0==c)for(g=n.tabs.tRNS?n.tabs.tRNS:-1,E=0;E<t;E++){var j=E*o,H=E*e;if(1==d)for(var B=0;B<e;B++)l[H+B]=(V=(L=255*(i[j+(B>>>3)]>>>7-(7&B)&1))==255*g?0:255)<<24|L<<16|L<<8|L;else if(2==d)for(B=0;B<e;B++)l[H+B]=(V=(L=85*(i[j+(B>>>2)]>>>6-((3&B)<<1)&3))==85*g?0:255)<<24|L<<16|L<<8|L;else if(4==d)for(B=0;B<e;B++)l[H+B]=(V=(L=17*(i[j+(B>>>1)]>>>4-((1&B)<<2)&15))==17*g?0:255)<<24|L<<16|L<<8|L;else if(8==d)for(B=0;B<e;B++)l[H+B]=(V=(L=i[j+B])==g?0:255)<<24|L<<16|L<<8|L;else if(16==d)for(B=0;B<e;B++){var L=i[j+(B<<1)],V=u(i,j+(B<<1))==g?0:255;l[H+B]=V<<24|L<<16|L<<8|L}}return a},ri.decode=function(i){for(var c,u,h,f,e=new Uint8Array(i),t=8,n=ri._bin,r=n.readUshort,s=n.readUint,o={tabs:{},frames:[]},a=new Uint8Array(e.length),l=0,d=0,m=[137,80,78,71,13,10,26,10],_=0;_<8;_++)if(e[_]!=m[_])throw new Error("The input is not a PNG file!");for(;t<e.length;){var g=n.readUint(e,t),p=n.readASCII(e,t+=4,4);if(t+=4,"IHDR"==p)ri.decode._IHDR(e,t,o);else if("CgBI"==p)o.tabs[p]=e.slice(t,t+4);else if("IDAT"==p){for(_=0;_<g;_++)a[l+_]=e[t+_];l+=g}else if("acTL"==p)o.tabs[p]={num_frames:s(e,t),num_plays:s(e,t+4)},c=new Uint8Array(e.length);else if("fcTL"==p){0!=d&&((v=o.frames[o.frames.length-1]).data=ri.decode._decompress(o,c.slice(0,d),v.rect.width,v.rect.height),d=0);var b={x:s(e,t+12),y:s(e,t+16),width:s(e,t+4),height:s(e,t+8)},y=r(e,t+22);y=r(e,t+20)/(0==y?100:y);var x={rect:b,delay:Math.round(1e3*y),dispose:e[t+24],blend:e[t+25]};o.frames.push(x)}else if("fdAT"==p){for(_=0;_<g-4;_++)c[d+_]=e[t+_+4];d+=g-4}else if("pHYs"==p)o.tabs[p]=[n.readUint(e,t),n.readUint(e,t+4),e[t+8]];else if("cHRM"==p)for(o.tabs[p]=[],_=0;_<8;_++)o.tabs[p].push(n.readUint(e,t+4*_));else if("tEXt"==p||"zTXt"==p){null==o.tabs[p]&&(o.tabs[p]={});var w=n.nextZero(e,t);h=n.readASCII(e,t,w-t);var E=t+g-w-1;"tEXt"==p?u=n.readASCII(e,w+1,E):(f=ri.decode._inflate(e.slice(w+2,w+2+E)),u=n.readUTF8(f,0,f.length)),o.tabs[p][h]=u}else if("iTXt"==p){null==o.tabs[p]&&(o.tabs[p]={}),w=0;var S=t;w=n.nextZero(e,S),h=n.readASCII(e,S,w-S);var C=e[S=w+1];w=n.nextZero(e,S+=2),n.readASCII(e,S,w-S),w=n.nextZero(e,S=w+1),n.readUTF8(e,S,w-S),E=g-((S=w+1)-t),0==C?u=n.readUTF8(e,S,E):(f=ri.decode._inflate(e.slice(S,S+E)),u=n.readUTF8(f,0,f.length)),o.tabs[p][h]=u}else if("PLTE"==p)o.tabs[p]=n.readBytes(e,t,g);else if("hIST"==p){var T=o.tabs.PLTE.length/3;for(o.tabs[p]=[],_=0;_<T;_++)o.tabs[p].push(r(e,t+2*_))}else if("tRNS"==p)3==o.ctype?o.tabs[p]=n.readBytes(e,t,g):0==o.ctype?o.tabs[p]=r(e,t):2==o.ctype&&(o.tabs[p]=[r(e,t),r(e,t+2),r(e,t+4)]);else if("gAMA"==p)o.tabs[p]=n.readUint(e,t)/1e5;else if("sRGB"==p)o.tabs[p]=e[t];else if("bKGD"==p)0==o.ctype||4==o.ctype?o.tabs[p]=[r(e,t)]:2==o.ctype||6==o.ctype?o.tabs[p]=[r(e,t),r(e,t+2),r(e,t+4)]:3==o.ctype&&(o.tabs[p]=e[t]);else if("IEND"==p)break;n.readUint(e,t+=g),t+=4}var v;return 0!=d&&((v=o.frames[o.frames.length-1]).data=ri.decode._decompress(o,c.slice(0,d),v.rect.width,v.rect.height)),o.data=ri.decode._decompress(o,a,o.width,o.height),delete o.compress,delete o.interlace,delete o.filter,o},ri.decode._decompress=function(i,e,t,n){var r=ri.decode._getBPP(i),s=Math.ceil(t*r/8),o=new Uint8Array((s+1+i.interlace)*n);return e=i.tabs.CgBI?ri.inflateRaw(e,o):ri.decode._inflate(e,o),0==i.interlace?e=ri.decode._filterZero(e,i,0,t,n):1==i.interlace&&(e=ri.decode._readInterlace(e,i)),e},ri.decode._inflate=function(i,e){return ri.inflateRaw(new Uint8Array(i.buffer,2,i.length-6),e)},ri.inflateRaw=((i={H:{}}).H.N=function(e,t){var f,m,n=Uint8Array,r=0,s=0,o=0,a=0,l=0,c=0,d=0,u=0,h=0;if(3==e[0]&&0==e[1])return t||new n(0);var _=i.H,g=_.b,p=_.e,v=_.R,b=_.n,y=_.A,x=_.Z,w=_.m,E=null==t;for(E&&(t=new n(e.length>>>2<<5));0==r;)if(r=g(e,h,1),s=g(e,h+1,2),h+=3,0!=s){if(E&&(t=i.H.W(t,u+(1<<17))),1==s&&(f=w.J,m=w.h,c=511,d=31),2==s){o=p(e,h,5)+257,a=p(e,h+5,5)+1,l=p(e,h+10,4)+4,h+=14;for(var T=1,k=0;k<38;k+=2)w.Q[k]=0,w.Q[k+1]=0;for(k=0;k<l;k++){var U=p(e,h+3*k,3);w.Q[1+(w.X[k]<<1)]=U,U>T&&(T=U)}h+=3*l,b(w.Q,T),y(w.Q,T,w.u),f=w.w,m=w.d,h=v(w.u,(1<<T)-1,o+a,e,h,w.v);var L=_.V(w.v,0,o,w.C);c=(1<<L)-1;var j=_.V(w.v,o,a,w.D);d=(1<<j)-1,b(w.C,L),y(w.C,L,f),b(w.D,j),y(w.D,j,m)}for(;;){var H=f[x(e,h)&c];h+=15&H;var B=H>>>4;if(B>>>8){if(256==B)break;var V=u+B-254;if(B>264){var O=w.q[B-257];V=u+(O>>>3)+p(e,h,7&O),h+=7&O}var Q=m[x(e,h)&d],be=w.c[Q>>>4],de=(be>>>4)+g(e,h+=15&Q,15&be);for(h+=15&be;u<V;)t[u]=t[u++-de],t[u]=t[u++-de],t[u]=t[u++-de],t[u]=t[u++-de];u=V}else t[u++]=B}}else{7&h&&(h+=8-(7&h));var S=4+(h>>>3),C=e[S-4]|e[S-3]<<8;E&&(t=i.H.W(t,u+C)),t.set(new n(e.buffer,e.byteOffset+S,C),u),h=S+C<<3,u+=C}return t.length==u?t:t.slice(0,u)},i.H.W=function(e,t){var n=e.length;if(t<=n)return e;var r=new Uint8Array(n<<1);return r.set(e,0),r},i.H.R=function(e,t,n,r,s,o){for(var a=i.H.e,l=i.H.Z,c=0;c<n;){var d=e[l(r,s)&t];s+=15&d;var u=d>>>4;if(u<=15)o[c]=u,c++;else{var h=0,f=0;16==u?(f=3+a(r,s,2),s+=2,h=o[c-1]):17==u?(f=3+a(r,s,3),s+=3):18==u&&(f=11+a(r,s,7),s+=7);for(var m=c+f;c<m;)o[c]=h,c++}}return s},i.H.V=function(e,t,n,r){for(var s=0,o=0,a=r.length>>>1;o<n;){var l=e[o+t];r[o<<1]=0,r[1+(o<<1)]=l,l>s&&(s=l),o++}for(;o<a;)r[o<<1]=0,r[1+(o<<1)]=0,o++;return s},i.H.n=function(e,t){for(var s,o,a,c,n=i.H.m,r=e.length,d=n.j,l=0;l<=t;l++)d[l]=0;for(l=1;l<r;l+=2)d[e[l]]++;var u=n.K;for(s=0,d[0]=0,o=1;o<=t;o++)u[o]=s=s+d[o-1]<<1;for(a=0;a<r;a+=2)0!=(c=e[a+1])&&(e[a]=u[c],u[c]++)},i.H.A=function(e,t,n){for(var r=e.length,o=i.H.m.r,a=0;a<r;a+=2)if(0!=e[a+1])for(var c=e[a+1],d=a>>1<<4|c,u=t-c,h=e[a]<<u,f=h+(1<<u);h!=f;)n[o[h]>>>15-t]=d,h++},i.H.l=function(e,t){for(var n=i.H.m.r,r=15-t,s=0;s<e.length;s+=2)e[s]=n[e[s]<<t-e[s+1]]>>>r},i.H.M=function(e,t,n){var r=t>>>3;e[r]|=n<<=7&t,e[r+1]|=n>>>8},i.H.I=function(e,t,n){var r=t>>>3;e[r]|=n<<=7&t,e[r+1]|=n>>>8,e[r+2]|=n>>>16},i.H.e=function(e,t,n){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<n)-1},i.H.b=function(e,t,n){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<n)-1},i.H.Z=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},i.H.i=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},i.H.m=(e=Uint16Array,t=Uint32Array,{K:new e(16),j:new e(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new e(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new t(32),J:new e(512),_:[],h:new e(32),$:[],w:new e(32768),C:[],v:[],d:new e(32768),D:[],u:new e(512),Q:[],r:new e(32768),s:new t(286),Y:new t(30),a:new t(19),t:new t(15e3),k:new e(65536),g:new e(32768)}),function(){for(var e=i.H.m,n=0;n<32768;n++){var r=n;e.r[n]=((r=(4278255360&(r=(4042322160&(r=(3435973836&(r=(2863311530&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8)>>>16|r<<16)>>>17}function s(o,a,l){for(;0!=a--;)o.push(0,l)}for(n=0;n<32;n++)e.q[n]=e.S[n]<<3|e.T[n],e.c[n]=e.p[n]<<4|e.z[n];s(e._,144,8),s(e._,112,9),s(e._,24,7),s(e._,8,8),i.H.n(e._,9),i.H.A(e._,9,e.J),i.H.l(e._,9),s(e.$,32,5),i.H.n(e.$,5),i.H.A(e.$,5,e.h),i.H.l(e.$,5),s(e.Q,19,0),s(e.C,286,0),s(e.D,30,0),s(e.v,320,0)}(),i.H.N),ri.decode._readInterlace=function(i,e){for(var t=e.width,n=e.height,r=ri.decode._getBPP(e),s=r>>3,o=Math.ceil(t*r/8),a=new Uint8Array(n*o),l=0,c=[0,0,4,0,2,0,1],d=[0,4,0,2,0,1,0],u=[8,8,8,4,4,2,2],h=[8,8,4,4,2,2,1],f=0;f<7;){for(var m=u[f],_=h[f],g=0,p=0,v=c[f];v<n;)v+=m,p++;for(var b=d[f];b<t;)b+=_,g++;var y=Math.ceil(g*r/8);ri.decode._filterZero(i,e,l,g,p);for(var x=0,w=c[f];w<n;){for(var S=d[f],C=l+x*y<<3;S<t;){if(1==r&&(a[w*o+(S>>3)]|=(i[C>>3]>>7-(7&C)&1)<<7-((7&S)<<0)),2==r&&(a[w*o+(S>>2)]|=(i[C>>3]>>6-(7&C)&3)<<6-((3&S)<<1)),4==r&&(a[w*o+(S>>1)]|=(i[C>>3]>>4-(7&C)&15)<<4-((1&S)<<2)),r>=8)for(var T=w*o+S*s,k=0;k<s;k++)a[T+k]=i[(C>>3)+k];C+=r,S+=_}x++,w+=m}g*p!=0&&(l+=p*(1+y)),f+=1}return a},ri.decode._getBPP=function(i){return[1,null,3,1,2,null,4][i.ctype]*i.depth},ri.decode._filterZero=function(i,e,t,n,r){var s=ri.decode._getBPP(e),o=Math.ceil(n*s/8),a=ri.decode._paeth;s=Math.ceil(s/8);var l,c,d=i[t],u=0;if(d>1&&(i[t]=[0,0,1][d-2]),3==d)for(u=s;u<o;u++)i[u+1]=i[u+1]+(i[u+1-s]>>>1)&255;for(var h=0;h<r;h++)if(u=0,0==(d=i[(c=(l=t+h*o)+h+1)-1]))for(;u<o;u++)i[l+u]=i[c+u];else if(1==d){for(;u<s;u++)i[l+u]=i[c+u];for(;u<o;u++)i[l+u]=i[c+u]+i[l+u-s]}else if(2==d)for(;u<o;u++)i[l+u]=i[c+u]+i[l+u-o];else if(3==d){for(;u<s;u++)i[l+u]=i[c+u]+(i[l+u-o]>>>1);for(;u<o;u++)i[l+u]=i[c+u]+(i[l+u-o]+i[l+u-s]>>>1)}else{for(;u<s;u++)i[l+u]=i[c+u]+a(0,i[l+u-o],0);for(;u<o;u++)i[l+u]=i[c+u]+a(i[l+u-s],i[l+u-o],i[l+u-s-o])}return i},ri.decode._paeth=function(i,e,t){var n=i+e-t,r=n-i,s=n-e,o=n-t;return r*r<=s*s&&r*r<=o*o?i:s*s<=o*o?e:t},ri.decode._IHDR=function(i,e,t){var n=ri._bin;t.width=n.readUint(i,e),t.height=n.readUint(i,e+=4),t.depth=i[e+=4],e++,t.ctype=i[e],e++,t.compress=i[e],e++,t.filter=i[e],e++,t.interlace=i[e],e++},ri._bin={nextZero:function(i,e){for(;0!=i[e];)e++;return e},readUshort:function(i,e){return i[e]<<8|i[e+1]},writeUshort:function(i,e,t){i[e]=t>>8&255,i[e+1]=255&t},readUint:function(i,e){return 16777216*i[e]+(i[e+1]<<16|i[e+2]<<8|i[e+3])},writeUint:function(i,e,t){i[e]=t>>24&255,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=255&t},readASCII:function(i,e,t){for(var n="",r=0;r<t;r++)n+=String.fromCharCode(i[e+r]);return n},writeASCII:function(i,e,t){for(var n=0;n<t.length;n++)i[e+n]=t.charCodeAt(n)},readBytes:function(i,e,t){for(var n=[],r=0;r<t;r++)n.push(i[e+r]);return n},pad:function(i){return i.length<2?"0"+i:i},readUTF8:function(i,e,t){for(var r,n="",s=0;s<t;s++)n+="%"+ri._bin.pad(i[e+s].toString(16));try{r=decodeURIComponent(n)}catch{return ri._bin.readASCII(i,e,t)}return r}},ri._copyTile=function(i,e,t,n,r,s,o,a,l){for(var c=Math.min(e,r),d=Math.min(t,s),u=0,h=0,f=0;f<d;f++)for(var m=0;m<c;m++)if(o>=0&&a>=0?(u=f*e+m<<2,h=(a+f)*r+o+m<<2):(u=(-a+f)*e-o+m<<2,h=f*r+m<<2),0==l)n[h]=i[u],n[h+1]=i[u+1],n[h+2]=i[u+2],n[h+3]=i[u+3];else if(1==l){var g=i[u]*(_=.00392156862745098*i[u+3]),p=i[u+1]*_,v=i[u+2]*_,y=n[h]*(b=n[h+3]*(1/255)),x=n[h+1]*b,w=n[h+2]*b,E=1-_,S=_+b*E,C=0==S?0:1/S;n[h+3]=255*S,n[h+0]=(g+y*E)*C,n[h+1]=(p+x*E)*C,n[h+2]=(v+w*E)*C}else if(2==l)g=i[u],p=i[u+1],v=i[u+2],y=n[h],x=n[h+1],w=n[h+2],(_=i[u+3])==(b=n[h+3])&&g==y&&p==x&&v==w?(n[h]=0,n[h+1]=0,n[h+2]=0,n[h+3]=0):(n[h]=g,n[h+1]=p,n[h+2]=v,n[h+3]=_);else if(3==l){var _,b;if(g=i[u],p=i[u+1],v=i[u+2],y=n[h],x=n[h+1],w=n[h+2],(_=i[u+3])==(b=n[h+3])&&g==y&&p==x&&v==w)continue;if(_<220&&b>20)return!1}return!0};class ad extends Lo{constructor(){super(...arguments),this.clazz=vve}}ad.\u0275fac=function(){let i;return function(t){return(i||(i=le(ad)))(t||ad)}}(),ad.\u0275prov=He({token:ad,factory:ad.\u0275fac,providedIn:"root"});class EC extends ua{constructor(e){super(),this.service=e}}EC.\u0275fac=function(e){return new(e||EC)(I(ad,16))},EC.\u0275pipe=_i({name:"loadRGBMTexture",type:EC,pure:!0});class SC extends ks{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}SC.\u0275fac=function(e){return new(e||SC)(I(_a,1),I(gt),I(ad))},SC.\u0275dir=Ne({type:SC,selectors:[["","loadRGBMTexture",""]],features:[q]});class Ave extends Ep{constructor(e){super(e),this.type=mn}parse(e){const t=vt.decode(e);vt.decodeImage(e,t[0]);const n=vt.toRGBA(t[0],this.type);return{width:t[0].width,height:t[0].height,data:n,format:Rn,type:this.type,flipY:!0}}setDataType(e){return this.type=e,this}}const vt={decode:function(i,e){null==e&&(e={parseMN:!0,debug:!1});var t=new Uint8Array(i),n=0,s="II"==vt._binBE.readASCII(t,n,2)?vt._binLE:vt._binBE;s.readUshort(t,n+=2);for(var o=s.readUint(t,n+=2),a=[];;){var l=s.readUshort(t,o),c=s.readUshort(t,o+4);if(0!=l&&(c<1||13<c)){console.log("error in TIFF");break}if(vt._readIFD(s,t,o,a,0,e),0==(o=s.readUint(t,o+2+12*l)))break}return a},decodeImage:function(i,e,t){if(!e.data){var n=new Uint8Array(i),r=vt._binBE.readASCII(n,0,2);if(null!=e.t256){e.isLE="II"==r,e.width=e.t256[0],e.height=e.t257[0];var a,s=e.t259?e.t259[0]:1,o=e.t266?e.t266[0]:1;e.t284&&2==e.t284[0]&&console.log("PlanarConfiguration 2 should not be used!"),7==s&&e.t258&&e.t258.length>3&&(e.t258=e.t258.slice(0,3)),a=e.t258?Math.min(32,e.t258[0])*e.t258.length:e.t277?e.t277[0]:1,1==s&&null!=e.t279&&e.t278&&32803==e.t262[0]&&(a=Math.round(8*e.t279[0]/(e.width*e.t278[0])));var l=8*Math.ceil(e.width*a/8),c=e.t273;null==c&&(c=e.t324);var d=e.t279;1==s&&1==c.length&&(d=[e.height*(l>>>3)]),null==d&&(d=e.t325);var u=new Uint8Array(e.height*(l>>>3)),h=0;if(null!=e.t322){for(var f=e.t322[0],m=e.t323[0],_=Math.floor((e.width+f-1)/f),g=Math.floor((e.height+m-1)/m),p=new Uint8Array(0|Math.ceil(f*m*a/8)),v=0;v<g;v++)for(var b=0;b<_;b++){for(var y=v*_+b,x=0;x<p.length;x++)p[x]=0;vt.decode._decompress(e,t,n,c[y],d[y],s,p,0,o),6==s?u=p:vt._copyTile(p,0|Math.ceil(f*a/8),m,u,0|Math.ceil(e.width*a/8),e.height,0|Math.ceil(b*f*a/8),v*m)}h=8*u.length}else{var w=e.t278?e.t278[0]:e.height;for(w=Math.min(w,e.height),y=0;y<c.length;y++)vt.decode._decompress(e,t,n,c[y],d[y],s,u,0|Math.ceil(h/8),o),h+=l*w;h=Math.min(h,8*u.length)}e.data=new Uint8Array(u.buffer,0,0|Math.ceil(h/8))}}}};vt.decode._decompress=function(i,e,t,n,r,s,o,a){34676==s?vt.decode._decodeLogLuv32(i,t,n,r,o,a):console.log("Unsupported compression",s);var l=i.t258?Math.min(32,i.t258[0]):1,c=i.t277?i.t277[0]:1,d=l*c>>>3,u=i.t278?i.t278[0]:i.height,h=Math.ceil(l*c*i.width/8);if(16==l&&!i.isLE&&null==i.t33422)for(var f=0;f<u;f++)for(var m=a+f*h,_=1;_<h;_+=2){var g=o[m+_];o[m+_]=o[m+_-1],o[m+_-1]=g}if(i.t317&&2==i.t317[0])for(f=0;f<u;f++){var p=a+f*h;if(16==l)for(var v=d;v<h;v+=2){var b=(o[p+v+1]<<8|o[p+v])+(o[p+v-d+1]<<8|o[p+v-d]);o[p+v]=255&b,o[p+v+1]=b>>>8&255}else if(3==c)for(v=3;v<h;v+=3)o[p+v]=o[p+v]+o[p+v-3]&255,o[p+v+1]=o[p+v+1]+o[p+v-2]&255,o[p+v+2]=o[p+v+2]+o[p+v-1]&255;else for(v=d;v<h;v++)o[p+v]=o[p+v]+o[p+v-d]&255}},vt.decode._decodeLogLuv32=function(i,e,t,n,r,s){for(var o=i.width,a=4*o,l=0,c=new Uint8Array(a);l<n;){for(var d=0;d<a;){var u=e[t+l];if(l++,u<128){for(var h=0;h<u;h++)c[d+h]=e[t+l+h];d+=u,l+=u}else{for(u-=126,h=0;h<u;h++)c[d+h]=e[t+l];d+=u,l++}}for(var f=0;f<o;f++)r[s+0]=c[f],r[s+1]=c[f+o],r[s+2]=c[f+2*o],r[s+4]=c[f+3*o],s+=6}},vt.tags={},vt._types=function(){var i=new Array(250);return i.fill(0),{basic:{main:i=i.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rest:{33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7}},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}}(),vt._readIFD=function(i,e,t,n,r,s){var o=i.readUshort(e,t);t+=2;var a={};s.debug&&console.log("   ".repeat(r),n.length-1,">>>----------------");for(var l=0;l<o;l++){var c=i.readUshort(e,t),d=i.readUshort(e,t+=2),u=i.readUint(e,t+=2),h=i.readUint(e,t+=4);t+=4;var f=[];if((1==d||7==d)&&(f=new Uint8Array(e.buffer,u<5?t-4:h,u)),2==d){var m=u<5?t-4:h,_=e[m],g=Math.max(0,Math.min(u-1,e.length-m));_<128||0==g?f.push(i.readASCII(e,m,g)):f=new Uint8Array(e.buffer,m,g)}if(3==d)for(var p=0;p<u;p++)f.push(i.readUshort(e,(u<3?t-4:h)+2*p));if(4==d||13==d)for(p=0;p<u;p++)f.push(i.readUint(e,(u<2?t-4:h)+4*p));if(5==d||10==d){var v=5==d?i.readUint:i.readInt;for(p=0;p<u;p++)f.push([v(e,h+8*p),v(e,h+8*p+4)])}if(8==d)for(p=0;p<u;p++)f.push(i.readShort(e,(u<3?t-4:h)+2*p));if(9==d)for(p=0;p<u;p++)f.push(i.readInt(e,(u<2?t-4:h)+4*p));if(11==d)for(p=0;p<u;p++)f.push(i.readFloat(e,h+4*p));if(12==d)for(p=0;p<u;p++)f.push(i.readDouble(e,h+8*p));if(0==u||0!=f.length){if(s.debug&&console.log("   ".repeat(r),c,d,vt.tags[c],f),a["t"+c]=f,330==c||34665==c||34853==c||50740==c&&i.readUshort(e,i.readUint(f,0))<300||61440==c){var b=50740==c?[i.readUint(f,0)]:f,y=[];for(p=0;p<b.length;p++)vt._readIFD(i,e,b[p],y,r+1,s);330==c&&(a.subIFD=y),34665==c&&(a.exifIFD=y[0]),34853==c&&(a.gpsiIFD=y[0]),50740==c&&(a.dngPrvt=y[0]),61440==c&&(a.fujiIFD=y[0])}if(37500==c&&s.parseMN){var x=f;if("Nikon"==i.readASCII(x,0,5))a.makerNote=vt.decode(x.slice(10).buffer)[0];else if(i.readUshort(e,h)<300&&i.readUshort(e,h+4)<=12){var w=[];vt._readIFD(i,e,h,w,r+1,s),a.makerNote=w[0]}}}else if(console.log(c,"unknown TIFF tag type: ",d,"num:",u),0==l)return}return n.push(a),s.debug&&console.log("   ".repeat(r),"<<<---------------"),t},vt.toRGBA=function(i,e){const t=i.width,n=i.height,r=t*n,s=i.data;let o;switch(e){case mn:o=new Uint16Array(4*r);break;case Un:o=new Float32Array(4*r);break;default:console.error("THREE.LogLuvLoader: Unsupported texture data type:",e)}let a=i.t262?i.t262[0]:2;const l=i.t258?Math.min(32,i.t258[0]):1;if(null==i.t262&&1==l&&(a=0),32845==a)for(let c=0;c<n;c++)for(let d=0;d<t;d++){const u=6*(c*t+d),h=4*(c*t+d);let f=s[u+1]<<8|s[u];f=Math.pow(2,(f+.5)/256-64);const m=(s[u+3]+.5)/410,_=(s[u+5]+.5)/410,g=9*m/(6*m-16*_+12),p=4*_/(6*m-16*_+12),b=g*f/p,x=(1-g-p)*f/p,w=2.69*b-1.276*f-.414*x,E=-1.022*b+1.978*f+.044*x,S=.061*b-.224*f+1.163*x;e===mn?(o[h]=cs.toHalfFloat(Math.min(w,65504)),o[h+1]=cs.toHalfFloat(Math.min(E,65504)),o[h+2]=cs.toHalfFloat(Math.min(S,65504)),o[h+3]=cs.toHalfFloat(1)):(o[h]=w,o[h+1]=E,o[h+2]=S,o[h+3]=1)}else console.log("Unsupported Photometric interpretation: "+a);return o},vt._binBE={nextZero:function(i,e){for(;0!=i[e];)e++;return e},readUshort:function(i,e){return i[e]<<8|i[e+1]},readShort:function(i,e){var t=vt._binBE.ui8;return t[0]=i[e+1],t[1]=i[e+0],vt._binBE.i16[0]},readInt:function(i,e){var t=vt._binBE.ui8;return t[0]=i[e+3],t[1]=i[e+2],t[2]=i[e+1],t[3]=i[e+0],vt._binBE.i32[0]},readUint:function(i,e){var t=vt._binBE.ui8;return t[0]=i[e+3],t[1]=i[e+2],t[2]=i[e+1],t[3]=i[e+0],vt._binBE.ui32[0]},readASCII:function(i,e,t){for(var n="",r=0;r<t;r++)n+=String.fromCharCode(i[e+r]);return n},readFloat:function(i,e){for(var t=vt._binBE.ui8,n=0;n<4;n++)t[n]=i[e+3-n];return vt._binBE.fl32[0]},readDouble:function(i,e){for(var t=vt._binBE.ui8,n=0;n<8;n++)t[n]=i[e+7-n];return vt._binBE.fl64[0]},writeUshort:function(i,e,t){i[e]=t>>8&255,i[e+1]=255&t},writeInt:function(i,e,t){var n=vt._binBE.ui8;vt._binBE.i32[0]=t,i[e+3]=n[0],i[e+2]=n[1],i[e+1]=n[2],i[e+0]=n[3]},writeUint:function(i,e,t){i[e]=t>>24&255,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=t>>0&255},writeASCII:function(i,e,t){for(var n=0;n<t.length;n++)i[e+n]=t.charCodeAt(n)},writeDouble:function(i,e,t){vt._binBE.fl64[0]=t;for(var n=0;n<8;n++)i[e+n]=vt._binBE.ui8[7-n]}},vt._binBE.ui8=new Uint8Array(8),vt._binBE.i16=new Int16Array(vt._binBE.ui8.buffer),vt._binBE.i32=new Int32Array(vt._binBE.ui8.buffer),vt._binBE.ui32=new Uint32Array(vt._binBE.ui8.buffer),vt._binBE.fl32=new Float32Array(vt._binBE.ui8.buffer),vt._binBE.fl64=new Float64Array(vt._binBE.ui8.buffer),vt._binLE={nextZero:vt._binBE.nextZero,readUshort:function(i,e){return i[e+1]<<8|i[e]},readShort:function(i,e){var t=vt._binBE.ui8;return t[0]=i[e+0],t[1]=i[e+1],vt._binBE.i16[0]},readInt:function(i,e){var t=vt._binBE.ui8;return t[0]=i[e+0],t[1]=i[e+1],t[2]=i[e+2],t[3]=i[e+3],vt._binBE.i32[0]},readUint:function(i,e){var t=vt._binBE.ui8;return t[0]=i[e+0],t[1]=i[e+1],t[2]=i[e+2],t[3]=i[e+3],vt._binBE.ui32[0]},readASCII:vt._binBE.readASCII,readFloat:function(i,e){for(var t=vt._binBE.ui8,n=0;n<4;n++)t[n]=i[e+n];return vt._binBE.fl32[0]},readDouble:function(i,e){for(var t=vt._binBE.ui8,n=0;n<8;n++)t[n]=i[e+n];return vt._binBE.fl64[0]},writeUshort:function(i,e,t){i[e]=255&t,i[e+1]=t>>8&255},writeInt:function(i,e,t){var n=vt._binBE.ui8;vt._binBE.i32[0]=t,i[e+0]=n[0],i[e+1]=n[1],i[e+2]=n[2],i[e+3]=n[3]},writeUint:function(i,e,t){i[e]=t>>>0&255,i[e+1]=t>>>8&255,i[e+2]=t>>>16&255,i[e+3]=t>>>24&255},writeASCII:vt._binBE.writeASCII},vt._copyTile=function(i,e,t,n,r,s,o,a){for(var l=Math.min(e,r-o),c=Math.min(t,s-a),d=0;d<c;d++)for(var u=(a+d)*r+o,h=d*e,f=0;f<l;f++)n[u+f]=i[h+f]};class ld extends Lo{constructor(){super(...arguments),this.clazz=Ave}}ld.\u0275fac=function(){let i;return function(t){return(i||(i=le(ld)))(t||ld)}}(),ld.\u0275prov=He({token:ld,factory:ld.\u0275fac,providedIn:"root"});class TC extends ua{constructor(e){super(),this.service=e}}TC.\u0275fac=function(e){return new(e||TC)(I(ld,16))},TC.\u0275pipe=_i({name:"loadLogLuvTexture",type:TC,pure:!0});class RC extends ks{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}}RC.\u0275fac=function(e){return new(e||RC)(I(_a,1),I(gt),I(ld))},RC.\u0275dir=Ne({type:RC,selectors:[["","loadLogLuvTexture",""]],features:[q]});const IC=new Le;class yve extends Ar{constructor(e){super(e),this.propertyNameMapping={},this.customPropertyMapping={}}load(e,t,n,r){const s=this,o=new yr(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(a))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}setPropertyNameMapping(e){this.propertyNameMapping=e}setCustomPropertyNameMapping(e){this.customPropertyMapping=e}parse(e){function t(g){let v="",b=0;const y=/^ply([\s\S]*)end_header(\r\n|\r|\n)/.exec(g);null!==y&&(v=y[1],b=new Blob([y[0]]).size);const x={comments:[],elements:[],headerLength:b,objInfo:""},w=v.split(/\r\n|\r|\n/);let E;function S(C,T){const k={type:C[0]};return"list"===k.type?(k.name=C[3],k.countType=C[1],k.itemType=C[2]):k.name=C[1],k.name in T&&(k.name=T[k.name]),k}for(let C=0;C<w.length;C++){let T=w[C];if(T=T.trim(),""===T)continue;const k=T.split(/\s+/),U=k.shift();switch(T=k.join(" "),U){case"format":x.format=k[0],x.version=k[1];break;case"comment":x.comments.push(T);break;case"element":void 0!==E&&x.elements.push(E),E={},E.name=k[0],E.count=parseInt(k[1]),E.properties=[];break;case"property":E.properties.push(S(k,_.propertyNameMapping));break;case"obj_info":x.objInfo=T;break;default:console.log("unhandled",U,k)}}return void 0!==E&&x.elements.push(E),x}function n(g,p){switch(p){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(g);case"float":case"double":case"float32":case"float64":return parseFloat(g)}}function r(g,p){const v=p.split(/\s+/),b={};for(let y=0;y<g.length;y++)if("list"===g[y].type){const x=[],w=n(v.shift(),g[y].countType);for(let E=0;E<w;E++)x.push(n(v.shift(),g[y].itemType));b[g[y].name]=x}else b[g[y].name]=n(v.shift(),g[y].type);return b}function s(){const g={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]};for(const p of Object.keys(_.customPropertyMapping))g[p]=[];return g}function o(g){const p=g.map(b=>b.name);function v(b){for(let y=0,x=b.length;y<x;y++){const w=b[y];if(p.includes(w))return w}return null}return{attrX:v(["x","px","posx"])||"x",attrY:v(["y","py","posy"])||"y",attrZ:v(["z","pz","posz"])||"z",attrNX:v(["nx","normalx"]),attrNY:v(["ny","normaly"]),attrNZ:v(["nz","normalz"]),attrS:v(["s","u","texture_u","tx"]),attrT:v(["t","v","texture_v","ty"]),attrR:v(["red","diffuse_red","r","diffuse_r"]),attrG:v(["green","diffuse_green","g","diffuse_g"]),attrB:v(["blue","diffuse_blue","b","diffuse_b"])}}function a(g,p){const v=s();let b,x="";null!==(b=/end_header\s([\s\S]*)$/.exec(g))&&(x=b[1]);const w=x.split(/\r\n|\r|\n/);let E=0,S=0,C=p.elements[E],T=o(C.properties);for(let k=0;k<w.length;k++){let U=w[k];if(U=U.trim(),""===U)continue;S>=C.count&&(E++,S=0,C=p.elements[E],T=o(C.properties));const L=r(C.properties,U);c(v,C.name,L,T),S++}return l(v)}function l(g){let p=new Mt;g.indices.length>0&&p.setIndex(g.indices),p.setAttribute("position",new Ke(g.vertices,3)),g.normals.length>0&&p.setAttribute("normal",new Ke(g.normals,3)),g.uvs.length>0&&p.setAttribute("uv",new Ke(g.uvs,2)),g.colors.length>0&&p.setAttribute("color",new Ke(g.colors,3)),g.faceVertexUvs.length>0&&(p=p.toNonIndexed(),p.setAttribute("uv",new Ke(g.faceVertexUvs,2)));for(const v of Object.keys(_.customPropertyMapping))g[v].length>0&&p.setAttribute(v,new Ke(g[v],_.customPropertyMapping[v].length));return p.computeBoundingSphere(),p}function c(g,p,v,b){if("vertex"===p){g.vertices.push(v[b.attrX],v[b.attrY],v[b.attrZ]),null!==b.attrNX&&null!==b.attrNY&&null!==b.attrNZ&&g.normals.push(v[b.attrNX],v[b.attrNY],v[b.attrNZ]),null!==b.attrS&&null!==b.attrT&&g.uvs.push(v[b.attrS],v[b.attrT]),null!==b.attrR&&null!==b.attrG&&null!==b.attrB&&(IC.setRGB(v[b.attrR]/255,v[b.attrG]/255,v[b.attrB]/255).convertSRGBToLinear(),g.colors.push(IC.r,IC.g,IC.b));for(const y of Object.keys(_.customPropertyMapping))for(const x of _.customPropertyMapping[y])g[y].push(v[x])}else if("face"===p){const y=v.vertex_indices||v.vertex_index,x=v.texcoord;3===y.length?(g.indices.push(y[0],y[1],y[2]),x&&6===x.length&&(g.faceVertexUvs.push(x[0],x[1]),g.faceVertexUvs.push(x[2],x[3]),g.faceVertexUvs.push(x[4],x[5]))):4===y.length&&(g.indices.push(y[0],y[1],y[3]),g.indices.push(y[1],y[2],y[3]))}}function d(g,p){const v={};let b=0;for(let y=0;y<p.length;y++){const x=p[y],w=x.valueReader;if("list"===x.type){const E=[],S=x.countReader.read(g+b);b+=x.countReader.size;for(let C=0;C<S;C++)E.push(w.read(g+b)),b+=w.size;v[x.name]=E}else v[x.name]=w.read(g+b),b+=w.size}return[v,b]}function u(g,p,v){function b(y,x,w){switch(x){case"int8":case"char":return{read:E=>y.getInt8(E),size:1};case"uint8":case"uchar":return{read:E=>y.getUint8(E),size:1};case"int16":case"short":return{read:E=>y.getInt16(E,w),size:2};case"uint16":case"ushort":return{read:E=>y.getUint16(E,w),size:2};case"int32":case"int":return{read:E=>y.getInt32(E,w),size:4};case"uint32":case"uint":return{read:E=>y.getUint32(E,w),size:4};case"float32":case"float":return{read:E=>y.getFloat32(E,w),size:4};case"float64":case"double":return{read:E=>y.getFloat64(E,w),size:8}}}for(let y=0,x=g.length;y<x;y++){const w=g[y];"list"===w.type?(w.countReader=b(p,w.countType,v),w.valueReader=b(p,w.itemType,v)):w.valueReader=b(p,w.type,v)}}let m;const _=this;if(e instanceof ArrayBuffer){const g=new Uint8Array(e),p=function f(g){let p=0,v=!0,b="";const y=[];do{const x=String.fromCharCode(g[p++]);"\n"!==x&&"\r"!==x?b+=x:("end_header"===b&&(v=!1),""!==b&&(y.push(b),b=""))}while(v&&p<g.length);return y.join("\r")+"\r"}(g),v=t(p);m="ascii"===v.format?a((new TextDecoder).decode(g),v):function h(g,p){const v=s(),b="binary_little_endian"===p.format,y=new DataView(g,p.headerLength);let x,w=0;for(let E=0;E<p.elements.length;E++){const S=p.elements[E],C=S.properties,T=o(C);u(C,y,b);for(let k=0;k<S.count;k++)x=d(w,C),w+=x[1],c(v,S.name,x[0],T)}return l(v)}(e,v)}else m=a(e,t(e));return m}}class cd extends za{constructor(){super(...arguments),this.clazz=yve}}cd.\u0275fac=function(){let i;return function(t){return(i||(i=le(cd)))(t||cd)}}(),cd.\u0275prov=He({token:cd,factory:cd.\u0275fac,providedIn:"root"});class DC extends Wx{constructor(e){super(),this.service=e}}DC.\u0275fac=function(e){return new(e||DC)(I(cd,16))},DC.\u0275pipe=_i({name:"loadPLY",type:DC,pure:!0});class P0 extends Su{constructor(e,t,n){super(e,t),this.host=e,this.zone=t,this.service=n}getRefFromResponse(e){return e.computeVertexNormals(),e}load(){var e=this;return ss(function*(){if(!e.initialized)return;if(void 0===e._url)throw new Error("missing url");const t=e._url,n=Nb(e.onProgress$)?s=>{e.onProgress$?.next(s)}:void 0,r=yield e.zone.runOutsideAngular(()=>e.service.load(t,n));e.host.objRef=e.getRefFromResponse(r),e.onLoaded$&&void 0!==r&&e.onLoaded$?.next(r)})()}}P0.\u0275fac=function(e){return new(e||P0)(I(Rt,1),I(gt),I(cd))},P0.\u0275dir=Ne({type:P0,selectors:[["","loadPLY",""]],features:[q]});class ph{constructor(e,t){this.host=e,this.parent=t,this.host.autoAddToParent=!1,this.host.autoDispose=!1,this.host.objRef=D5()}set refById(e){this.id=e,this.subscription?.unsubscribe(),this.subscription=this.parent.objRef$.subscribe(t=>{this.parentObj=t,this.applyRef()})}applyRef(){if(!this.parentObj||void 0===this.id)return;const e=this.findById(this.parentObj,this.id);e&&this.setRef(this.host,e)}findById(e,t){if((e.name??e.uuid)===t)return e;for(const n of e.children){const r=this.findById(n,t);if(void 0!==r)return r}}setRef(e,t){const n=e.objRef;n&&JR(n)&&(n.objRef=t,e.objRef=n)}ngOnDestroy(){this.subscription?.unsubscribe()}}ph.\u0275fac=function(e){return new(e||ph)(I(We,2),I(We,4))},ph.\u0275dir=Ne({type:ph,selectors:[["","refById",""]],inputs:{refById:"refById"}});const xve=["outerRef"],wve=["innerRef"];function Cve(i,e){1&i&&u_(0)}function Mve(i,e){if(1&i){const t=ys();ge(0,"div",3,4),ut("onResize",function(){return nr(t),rr(di().onResize())}),ge(2,"div",5,6)(4,"div",7),Bt(5,Cve,1,0,"ng-container",8),Re()()()}if(2&i){const t=di(),n=qt(4);W("ngStyle",t.styles),K(2),W("ngStyle",t.transformInnerStyles),K(2),yo(t.style),W("className",t.className),K(1),W("ngTemplateOutlet",n)}}function Eve(i,e){1&i&&u_(0)}function Sve(i,e){if(1&i&&(ge(0,"div",9,4),Bt(2,Eve,1,0,"ng-container",8),Re()),2&i){const t=di(),n=qt(4);W("ngStyle",t.styles)("className",t.className),K(2),W("ngTemplateOutlet",n)}}function Tve(i,e){1&i&&ie(0)}const k0=new R,LD=new R,Ive=new R;function Dve(i,e,t){const n=k0.setFromMatrixPosition(i.matrixWorld);n.project(e);const r=t.width/2,s=t.height/2;return[n.x*r+r,-n.y*s+s]}const FD=i=>Math.abs(i)<1e-10?0:i;function gH(i,e,t=""){let n="matrix3d(";for(let r=0;16!==r;r++)n+=FD(e[r]*i.elements[r])+(15!==r?",":")");return t+n}const Fve=(i=>e=>gH(e,i))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]);class B0 extends $a{constructor(e,t){super(t),this.view=e,this.DoubleSide=os,this.FRAGMENT_SHADER=jve,this.VERTEX_SHADER=Nve,this.prepend=!1,this.center=!1,this.fullscreen=!1,this.eps=.001,this.sprite=!1,this.transform=!1,this.zIndexRange=[16777271,0],this.onOcclude=new Tt,this.calculatePosition=Dve,this.as="div",this.pointerEvents="auto",this.transformInnerStyles=this.computeInnerStyles(),this.styles=null,this.oldZoom=0,this.oldPosition=[0,0],this.notOccluded=!0,this.raycaster=Et(Qx)}ngOnInit(){super.ngOnInit(),this.styles=this.computeStyles()}ngAfterViewInit(){this.el=document.createElement(this.as),this.frameSubscription=this.view.onRender.subscribe(()=>this.onFrame()),this.transformOuterRef&&this.el.appendChild(this.transformOuterRef.nativeElement),this.el&&!this.target&&this.appendElement(this.el)}onResize(){this.styles=this.computeStyles()}ngOnChanges(e){super.ngOnChanges(e)}appendElement(e){if(this.el&&this.objRef&&this.view.hostElement&&this.view.camera){if(this.target=this.portal??this.view.hostElement.nativeElement,this.view.scene?.objRef?.updateMatrixWorld(),this.transform)e.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const t=this.calculatePosition(this.objRef,this.view.camera.objRef,this.getSize());e.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${t[0]}px,${t[1]}px,0);transform-origin:0 0;`}this.target&&(this.prepend?this.target.prepend(e):this.target.appendChild(e))}}onFrame(){const e=this.view.camera?.objRef,t=this.view.scene?.objRef,n=this._objRef,r=this.getSize();if(!(e&&n&&t&&this.el))return;e.updateMatrixWorld(),n.updateWorldMatrix(!0,!1);const s=this.transform?this.oldPosition:this.calculatePosition(n,e,r);if(this.transform||Math.abs(this.oldZoom-e.zoom)>this.eps||Math.abs(this.oldPosition[0]-s[0])>this.eps||Math.abs(this.oldPosition[1]-s[1])>this.eps){const o=function Pve(i,e){const t=k0.setFromMatrixPosition(i.matrixWorld),n=LD.setFromMatrixPosition(e.matrixWorld),r=t.sub(n),s=e.getWorldDirection(Ive);return r.angleTo(s)>Math.PI/2}(n,e);let a=!1;"boolean"==typeof this.occlude?!0===this.occlude&&(a=[t]):Array.isArray(this.occlude)&&(a=this.occlude.map(c=>c.objRef??c));const l=this.notOccluded;if(this.notOccluded=a?!o&&function kve(i,e,t,n){const r=k0.setFromMatrixPosition(i.matrixWorld),s=r.clone();s.project(e),t.setFromCamera(s,e);const o=t.intersectObjects(n,!0);if(o.length){const a=o[0].distance;return r.distanceTo(t.ray.origin)<a}return!0}(n,e,this.raycaster,a):!o,l!==this.notOccluded&&(this.onOcclude.length>0?this.onOcclude.next(!this.notOccluded):this.el.style.display=this.notOccluded?"block":"none"),this.el.style.zIndex=`${function Lve(i,e,t){if(e instanceof In||e instanceof La){const n=k0.setFromMatrixPosition(i.matrixWorld),r=LD.setFromMatrixPosition(e.matrixWorld),s=n.distanceTo(r),o=(t[1]-t[0])/(e.far-e.near);return Math.round(o*s+(t[1]-o*e.far))}}(n,e,this.zIndexRange)}`,this.transform){const[c,d]=[r.width/2,r.height/2],u=e.projectionMatrix.elements[5]*d,{isOrthographicCamera:h,top:f,left:m,bottom:_,right:g}=e,p=Fve(e.matrixWorldInverse),v=h?`scale(${u})translate(${FD(-(g+m)/2)}px,${FD((f+_)/2)}px)`:`translateZ(${u}px)`;let b=n.matrixWorld;this.sprite&&(b=e.matrixWorldInverse.clone().transpose().copyPosition(b).scale(n.scale),b.elements[3]=b.elements[7]=b.elements[11]=0,b.elements[15]=1),this.el.style.width=r.width+"px",this.el.style.height=r.height+"px",this.el.style.perspective=h?"":`${u}px`,this.transformOuterRef&&this.transformInnerRef&&(this.transformOuterRef.nativeElement.style.transform=`${v}${p}translate(${c}px,${d}px)`,this.transformInnerRef.nativeElement.style.transform=((e,t)=>gH(e,(i=>[1/i,1/i,1/i,1,-1/i,-1/i,-1/i,-1,1/i,1/i,1/i,1,1,1,1,1])(t),"translate(-50%,-50%)"))(b,1/((this.distanceFactor||10)/400)))}else{const c=void 0===this.distanceFactor?1:function Bve(i,e){if(e instanceof La)return e.zoom;if(e instanceof In){const t=k0.setFromMatrixPosition(i.matrixWorld),n=LD.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,s=t.distanceTo(n);return 1/(2*Math.tan(r/2)*s)}return 1}(n,e)*this.distanceFactor;this.el.style.transform=`translate3d(${s[0]}px,${s[1]}px,0) scale(${c})`}this.oldPosition=s,this.oldZoom=e.zoom}}ngOnDestroy(){this.el?.remove(),this.frameSubscription?.unsubscribe()}computeStyles(){const e=this.getSize();return this.transform?{position:"absolute",top:0,left:0,width:e.width+"px",height:e.height+"px",transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:this.center?"translate3d(-50%,-50%,0)":"none",...this.fullscreen&&{top:-e.height/2+"px",left:-e.width/2+"px",width:e.width+"px",height:e.height+"px"},...this.style}}computeInnerStyles(){return{position:"absolute",pointerEvents:this.pointerEvents}}getSize(){return this.view.viewPort??this.view.hostElement.nativeElement.getBoundingClientRect()??{width:0,height:0}}}B0.\u0275fac=function(e){return new(e||B0)(I(Ds),I(We,4))},B0.\u0275cmp=$({type:B0,selectors:[["th-html"]],viewQuery:function(e,t){if(1&e&&(ji(xve,5),ji(wve,5)),2&e){let n;Ot(n=Nt())&&(t.transformOuterRef=n.first),Ot(n=Nt())&&(t.transformInnerRef=n.first)}},inputs:{prepend:"prepend",center:"center",fullscreen:"fullscreen",portal:"portal",distanceFactor:"distanceFactor",sprite:"sprite",transform:"transform",zIndexRange:"zIndexRange",style:"style",className:"className",occlude:"occlude",calculatePosition:"calculatePosition",as:"as",wrapperClass:"wrapperClass",pointerEvents:"pointerEvents"},outputs:{onOcclude:"onOcclude"},features:[q,Cr],ngContentSelectors:["*"],decls:5,vars:2,consts:[[3,"ngStyle","onResize",4,"ngIf","ngIfElse"],["noTransform",""],["tempOutlet",""],[3,"ngStyle","onResize"],["outerRef",""],[3,"ngStyle"],["innerRef",""],[3,"className"],[4,"ngTemplateOutlet"],[3,"ngStyle","className"]],template:function(e,t){if(1&e&&(he(),Bt(0,Mve,6,6,"div",0),Bt(1,Sve,3,3,"ng-template",null,1,Fd),Bt(3,Tve,1,0,"ng-template",null,2,Fd)),2&e){const n=qt(2);W("ngIf",t.transform)("ngIfElse",n)}},dependencies:[nc,pS,M3,Rc],encapsulation:2,changeDetection:0});const Nve='\n/*\n  This shader is from the THREE\'s SpriteMaterial.\n  We need to turn the backing plane into a Sprite\n  (make it always face the camera) if "transfrom" \n  is false. \n*/\n#include <common>\nvoid main() {\n  vec2 center = vec2(0., 1.);\n  float rotation = 0.0;\n  \n  // This is somewhat arbitrary, but it seems to work well\n  // Need to figure out how to derive this dynamically if it even matters\n  float size = 0.03;\n  vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n  vec2 scale;\n  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n  bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n  if ( isPerspective ) scale *= - mvPosition.z;\n  vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n  vec2 rotatedPosition;\n  rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n  rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n  mvPosition.xy += rotatedPosition;\n  gl_Position = projectionMatrix * mvPosition;\n}\n',jve="\nvoid main() {\n  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n}\n",OD=function(i){return[0,i,0]},Uve=function(){return[0,1,0]},Vve=function(){return{background:"lightblue",borderRadius:"1em",padding:"1em",display:"flex",flexDirection:"column"}},_H=function(i){return[i,0,0]},zve=function(i){return[i,.05,0]},Gve=function(){return[.17,.17,.17]},Hve=function(){return[4,10,2]},Qve=function(){return[100,100]},Wve=function(){return[55,2,.1,100]},qve=function(i,e){return[i,0,e]},Yve=function(){return[0,0,0]};class L0{constructor(e){this.Math=Math,this.sprite=!1,this.glbPath=`${Ps}mac-draco.glb`,this.clock=new Au(!0),this.plane=new oo(new R(0,1,0),3),this.rotation=[0,0,0],this.position=[0,0,0],e.setDecoderPath("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/jsm/libs/draco/gltf/"),e.setCrossOrigin("no-cors"),this.calcPose()}onBeforeRender(){this.calcPose()}calcPose(){const e=this.clock.getElapsedTime();this.rotation=[ft.lerp(this.rotation[0],Math.cos(e/2)/20+.25,.1),ft.lerp(this.rotation[1],Math.sin(e/4)/20,.1),ft.lerp(this.rotation[2],Math.sin(e/8)/20,.1)],this.position=[0,ft.lerp(this.position[1],(-2+Math.sin(e/2))/2,.1),0]}}L0.\u0275fac=function(e){return new(e||L0)(I(Ga))},L0.\u0275cmp=$({type:L0,selectors:[["app-html-example"]],decls:17,vars:56,consts:[[3,"thStats","shadow","onRender"],[3,"rotation","position"],["loadGLTF","",3,"castShadow","url","position","rotation"],[3,"refById"],[3,"rotation","position","scale","sprite","transform","occlude"],["src","./multi-view-postprocessing-example",2,"width","1960px","height","1280px"],[3,"castShadow","position","lookAt","color","intensity"],["light",""],[3,"receiveShadow","rotation","position"],[3,"args"],[3,"color"],[3,"args","position","lookAt"]],template:function(e,t){1&e&&(ge(0,"th-canvas",0),ut("onRender",function(){return t.onBeforeRender()}),ge(1,"th-scene"),je(2,"th-ambientLight"),ge(3,"th-group",1)(4,"th-object3D",2)(5,"th-mesh",3)(6,"th-html",4),je(7,"iframe",5),Re()()()(),je(8,"th-directionalLight",6,7),On(10,"color"),ge(11,"th-mesh",8),je(12,"th-planeGeometry",9)(13,"th-meshBasicMaterial",10),On(14,"color"),Re(),ge(15,"th-perspectiveCamera",11),je(16,"th-orbitControls"),Re()()()),2&e&&(W("thStats",!0)("shadow",!0),K(3),W("rotation",Ht(34,OD,t.Math.PI))("position",Ce(36,Uve)),K(1),W("castShadow",!0)("url",t.glbPath)("position",t.position)("rotation",t.rotation),K(1),W("refById","Cube008_2"),K(1),yo(Ce(37,Vve)),W("rotation",Ht(38,_H,-1*t.Math.PI/2))("position",Ht(40,zve,-.04))("scale",Ce(42,Gve))("sprite",t.sprite)("transform",!0)("occlude",!0),K(2),W("castShadow",!0)("position",Ce(43,Hve))("lookAt",Ht(44,OD,-3))("color",Zn(10,30,"#ffffff"))("intensity",.75),K(3),W("receiveShadow",!0)("rotation",Ht(46,_H,3*t.Math.PI/2))("position",Ht(48,OD,-3)),K(1),W("args",Ce(50,Qve)),K(1),W("color",Zn(14,32,"#efefef")),K(2),W("args",Ce(51,Wve))("position",$o(52,qve,-5,-15))("lookAt",Ce(55,Yve)))},dependencies:[Pr,qi,We,hs,Wn,Pn,$a,Ki,ha,Po,Di,Bs,fs,ph,B0,Hl],encapsulation:2,changeDetection:0}),Math.sqrt(3),Math.sqrt(3);const tl=1/6,Wl=(Math.sqrt(5),Math.sqrt(5),i=>0|Math.floor(i)),ND=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);const Jve=["canvas"],eAe=["light"],tAe=["instancedMesh"],iAe=function(){return[0,0,30]},nAe=function(){return[0,0,0]},rAe=function(){return["#808080"]},sAe=function(i){return[void 0,void 0,i]},oAe=function(i,e,t){return[i,e,t]},vH=function(){return["#9C1E15"]},aAe=function(i){return[0,0,i]},lAe=function(i,e){return[i,e]};class O0{constructor(){this.SIZE=1.5,this.NX=20,this.NY=20,this.PADDING=1,this.SIZEP=this.SIZE+this.PADDING,this.W=this.NX*this.SIZEP-this.PADDING,this.H=this.NY*this.SIZEP-this.PADDING,this.NUM_INSTANCES=this.NX*this.NY,this.dummy=new Qt,this.simplexNoise=function $ve(i=Math.random){const e=function jD(i){const t=new Uint8Array(512);for(let n=0;n<256;n++)t[n]=n;for(let n=0;n<255;n++){const r=n+~~(i()*(256-n)),s=t[n];t[n]=t[r],t[r]=s}for(let n=256;n<512;n++)t[n]=t[n-256];return t}(i),t=new Float64Array(e).map(s=>ND[s%12*3]),n=new Float64Array(e).map(s=>ND[s%12*3+1]),r=new Float64Array(e).map(s=>ND[s%12*3+2]);return function(o,a,l){let c,d,u,h;const f=.3333333333333333*(o+a+l),m=Wl(o+f),_=Wl(a+f),g=Wl(l+f),p=(m+_+g)*tl,x=o-(m-p),w=a-(_-p),E=l-(g-p);let S,C,T,k,U,L;x>=w?w>=E?(S=1,C=0,T=0,k=1,U=1,L=0):x>=E?(S=1,C=0,T=0,k=1,U=0,L=1):(S=0,C=0,T=1,k=1,U=0,L=1):w<E?(S=0,C=0,T=1,k=0,U=1,L=1):x<E?(S=0,C=1,T=0,k=0,U=1,L=1):(S=0,C=1,T=0,k=1,U=1,L=0);const j=x-S+tl,H=w-C+tl,B=E-T+tl,V=x-k+2*tl,O=w-U+2*tl,Q=E-L+2*tl,oe=x-1+.5,be=w-1+.5,de=E-1+.5,X=255&m,Y=255&_,re=255&g;let J=.6-x*x-w*w-E*E;if(J<0)c=0;else{const me=X+e[Y+e[re]];J*=J,c=J*J*(t[me]*x+n[me]*w+r[me]*E)}let D=.6-j*j-H*H-B*B;if(D<0)d=0;else{const me=X+S+e[Y+C+e[re+T]];D*=D,d=D*D*(t[me]*j+n[me]*H+r[me]*B)}let ue=.6-V*V-O*O-Q*Q;if(ue<0)u=0;else{const me=X+k+e[Y+U+e[re+L]];ue*=ue,u=ue*ue*(t[me]*V+n[me]*O+r[me]*Q)}let Ee=.6-oe*oe-be*be-de*de;if(Ee<0)h=0;else{const me=X+1+e[Y+1+e[re+1]];Ee*=Ee,h=Ee*Ee*(t[me]*oe+n[me]*be+r[me]*de)}return 32*(c+d+u+h)}}(),this.pointerPN={x:0,y:0}}ngOnInit(){this.light?.shadow&&(this.light.shadow.mapSize.width=1024,this.light.shadow.mapSize.height=1024)}onRender(){this.updateLightPosition(),this.updateInstanceMatrix()}updateLightPosition(){const e=this.light?.position;e&&(e.x=this.pointerPN.x*this.W,e.y=this.pointerPN.y*this.H)}updateInstanceMatrix(){if(!this.instancedMesh||!this.instancedMesh.objRef)return;const e=-this.W/2+this.PADDING,t=-this.H/2+this.PADDING,n=1e-4*Date.now(),r=.1*this.pointerPN.x,s=.1*this.pointerPN.y;let a,l,c,d,u,h;for(let f=0;f<this.NX;f++)for(let m=0;m<this.NY;m++)a=e+f*this.SIZEP,l=t+m*this.SIZEP,c=.005*a+r,d=.005*l+s,u=this.simplexNoise(c,d,n)*Math.PI,h=this.simplexNoise(d,c,n)*Math.PI,this.dummy.position.set(a,l,-10),this.dummy.rotation.set(u,h,0),this.dummy.updateMatrix(),this.instancedMesh?.objRef?.setMatrixAt(f*this.NY+m,this.dummy.matrix);this.instancedMesh.objRef.instanceMatrix.needsUpdate=!0}onMouseMove(e){if(!this.canvas||!this.canvas.hostElement.nativeElement)return;const t=this.canvas.hostElement.nativeElement;this.pointerPN.x=(e.clientX-t.offsetLeft+window.scrollX)/t.clientWidth*2-1,this.pointerPN.y=-(e.clientY-t.offsetTop+window.scrollY)/t.clientHeight*2+1}}O0.\u0275fac=function(e){return new(e||O0)},O0.\u0275cmp=$({type:O0,selectors:[["app-instanced-mesh-example"]],viewQuery:function(e,t){if(1&e&&(ji(Jve,5),ji(eAe,5),ji(tAe,5)),2&e){let n;Ot(n=Nt())&&(t.canvas=n.first),Ot(n=Nt())&&(t.light=n.first),Ot(n=Nt())&&(t.instancedMesh=n.first)}},hostBindings:function(e,t){1&e&&ut("mousemove",function(r){return t.onMouseMove(r)},0,tA)},decls:15,vars:31,consts:[[3,"shadow","onRender"],["canvas",""],[3,"position","lookAt"],[3,"color"],[3,"castShadow"],["light",""],[3,"args","count","castShadow","receiveShadow"],["instancedMesh",""],[3,"args"],[3,"position","receiveShadow"]],template:function(e,t){1&e&&(ge(0,"th-canvas",0,1),ut("onRender",function(){return t.onRender()}),ge(2,"th-scene")(3,"th-perspectiveCamera",2),je(4,"th-orbitControls"),Re(),je(5,"th-ambientLight",3)(6,"th-pointLight",4,5),ge(8,"th-instancedMesh",6,7),je(10,"th-boxGeometry",8)(11,"th-meshPhongMaterial",3),Re(),ge(12,"th-mesh",9),je(13,"th-planeGeometry",8)(14,"th-meshPhongMaterial",3),Re()()()),2&e&&(W("shadow",!0),K(3),W("position",Ce(15,iAe))("lookAt",Ce(16,nAe)),K(2),W("color",Ce(17,rAe)),K(1),W("castShadow",!0),K(2),W("args",Ht(18,sAe,t.NUM_INSTANCES))("count",t.NUM_INSTANCES)("castShadow",!0)("receiveShadow",!0),K(2),W("args",Bd(20,oAe,t.SIZE,t.SIZE,t.SIZE)),K(1),W("color",Ce(24,vH)),K(1),W("position",Ht(25,aAe,-10-t.SIZE))("receiveShadow",!0),K(1),W("args",$o(27,lAe,2*t.W,2*t.H)),K(1),W("color",Ce(30,vH)))},dependencies:[Pr,qi,ps,Wn,rh,Pn,Ki,lo,Ha,Po,Di],encapsulation:2,changeDetection:0});const cAe=function(){return[2,2,2]},dAe=function(){return[1,1,1]},uAe=function(){return{color:"purple"}},hAe=function(i){return[i,0,0]},fAe=function(){return[2,0,0]},pAe=function(){return[75,2,.1,1e3]},mAe=function(){return[1,1,5]};class N0{constructor(){this.selected=!1,this.rotation=[0,0,0],this.position=[0,0,0]}}N0.\u0275fac=function(e){return new(e||N0)},N0.\u0275cmp=$({type:N0,selectors:[["app-box"]],inputs:{rotation:"rotation",position:"position"},decls:3,vars:7,consts:[[3,"rotation","position","scale","onClick"],[3,"args"]],template:function(e,t){1&e&&(ge(0,"th-mesh",0),ut("onClick",function(){return t.selected=!t.selected}),je(1,"th-boxGeometry")(2,"th-meshBasicMaterial",1),Re()),2&e&&(W("rotation",t.rotation)("position",t.position)("scale",t.selected?Ce(4,cAe):Ce(5,dAe)),K(2),W("args",Ce(6,uAe)))},dependencies:[Pn,ha,Ha,Qa],encapsulation:2,changeDetection:0});class j0{constructor(){this.rotation=[0,0,0]}onBeforeRender(){this.rotation=[0,this.rotation[2]+.01,this.rotation[2]+.01]}}j0.\u0275fac=function(e){return new(e||j0)},j0.\u0275cmp=$({type:j0,selectors:[["app-introductory-example"]],decls:6,vars:11,consts:[[3,"onRender"],[3,"position","rotation"],[3,"args","position"]],template:function(e,t){1&e&&(ge(0,"th-canvas",0),ut("onRender",function(){return t.onBeforeRender()}),ge(1,"th-scene"),je(2,"app-box",1)(3,"app-box",1)(4,"th-ambientLight")(5,"th-perspectiveCamera",2),Re()()),2&e&&(K(2),W("position",Ht(6,hAe,-2))("rotation",t.rotation),K(1),W("position",Ce(8,fAe))("rotation",t.rotation),K(2),W("args",Ce(9,pAe))("position",Ce(10,mAe)))},dependencies:[qi,Wn,Ki,Di,N0],encapsulation:2,changeDetection:0});const gAe=function(){return[0,1,0]},_Ae=function(){return[100,100,100]},bAe=function(i){return[0,0,i]},vAe=function(){return[10,10]},AH=function(){return[10,10,10]},AAe=function(){return[45,2,.1,100]},yAe=function(){return[0,0,0]};class U0{constructor(){this.assetPath1=`${Ps}DamagedHelmet.glb`,this.assetPath2=`${Ps}BoomBox.glb`,this.rotation=[0,0,0]}onBeforeRender(){this.rotation=[0,this.rotation[1]+.01,0]}}U0.\u0275fac=function(e){return new(e||U0)},U0.\u0275cmp=$({type:U0,selectors:[["app-loader-example"]],decls:8,vars:22,consts:[[3,"onRender"],[3,"thStats"],["loadGLTF","",3,"url","rotation","position"],["loadGLTF","",3,"url","scale","rotation","position"],[3,"args"],[3,"position"],[3,"args","position","lookAt"]],template:function(e,t){1&e&&(ge(0,"th-canvas",0),ut("onRender",function(){return t.onBeforeRender()}),ge(1,"th-scene",1),je(2,"th-ambientLight"),ge(3,"th-object3D",2),je(4,"th-object3D",3),Re(),je(5,"th-gridHelper",4)(6,"th-pointLight",5)(7,"th-perspectiveCamera",6),Re()()),2&e&&(K(1),W("thStats",!0),K(2),W("url",t.assetPath1)("rotation",t.rotation)("position",Ce(13,gAe)),K(1),W("url",t.assetPath2)("scale",Ce(14,_Ae))("rotation",t.rotation)("position",Ht(15,bAe,-3)),K(1),W("args",Ce(17,vAe)),K(1),W("position",Ce(18,AH)),K(1),W("args",Ce(19,AAe))("position",Ce(20,AH))("lookAt",Ce(21,yAe)))},dependencies:[qi,We,Is,ps,Wn,Ki,Di,Bs,fs],encapsulation:2,changeDetection:0});const xAe=["slider"],wAe=function(){return[35,2,.1,100]},CAe=function(){return[0,0,6]},MAe=function(i,e){return{x:0,y:0,width:i,height:e}},EAe=function(){return["#ffffff","#444444",1]},SAe=function(i){return[i,2,2]},TAe=function(){return[1,3]},RAe=function(i,e,t){return{x:i,y:0,width:e,height:t}};class V0{constructor(){this.sliderPos=0,this.controlsEnabled=!0,this.colorLeft=new Le(12375183),this.colorRight=new Le(9419988)}ngOnInit(){!this.slider||!this.canvas||!this.canvas.rendererCanvas||(this.slider.nativeElement.style.touchAction="none",this.sliderPos=(this.canvas.rendererCanvas.clientWidth||0)/2)}onPointerMove(e){if(this.controlsEnabled||!this.canvas||!this.canvas.rendererCanvas||!this.slider||!1===e.isPrimary)return;const n=this.canvas.rendererCanvas.getBoundingClientRect();this.sliderPos=Math.max(n.left,Math.min(n.right,e.pageX))-n.left,this.slider.nativeElement.style.left=this.sliderPos-this.slider.nativeElement.offsetWidth/2+"px"}onPointerUp(){this.controlsEnabled=!0}onSliderPointerDown(e){!1!==e.isPrimary&&(this.controlsEnabled=!1)}}V0.\u0275fac=function(e){return new(e||V0)},V0.\u0275cmp=$({type:V0,selectors:[["app-multi-scene-example"]],viewQuery:function(e,t){if(1&e&&(ji(xAe,7),ji(Di,7)),2&e){let n;Ot(n=Nt())&&(t.slider=n.first),Ot(n=Nt())&&(t.canvas=n.first)}},hostBindings:function(e,t){1&e&&ut("pointermove",function(r){return t.onPointerMove(r)},0,H1)("pointerup",function(){return t.onPointerUp()},!1,H1)},decls:20,vars:32,consts:[[1,"slider",3,"pointerdown"],["slider",""],[3,"disableDefaultView"],["thecanvas",""],[3,"args","position"],["cam",""],[3,"scissor","scissorTest","clearColor","camera"],[3,"background"],["light",""],[3,"args"],["geo",""],[3,"objRef"],[3,"geometry"],[3,"wireframe"]],template:function(e,t){if(1&e&&(ge(0,"div",0,1),ut("pointerdown",function(r){return t.onSliderPointerDown(r)}),Re(),ge(2,"th-canvas",2,3)(4,"th-perspectiveCamera",4,5),je(6,"th-orbitControls"),Re(),ge(7,"th-view",6)(8,"th-scene",7),je(9,"th-hemisphereLight",4,8),ge(11,"th-mesh"),je(12,"th-meshStandardMaterial")(13,"th-icosahedronGeometry",9,10),Re()()(),ge(15,"th-view",6)(16,"th-scene",7),je(17,"th-hemisphereLight",11),ge(18,"th-mesh",12),je(19,"th-meshStandardMaterial",13),Re()()()()),2&e){const n=qt(3),r=qt(5),s=qt(10),o=qt(14);K(2),W("disableDefaultView",!0),K(2),W("args",Ce(19,wAe))("position",Ce(20,CAe)),K(3),W("scissor",$o(21,MAe,t.sliderPos,(null==n.rendererCanvas?null:n.rendererCanvas.height)||0))("scissorTest",!0)("clearColor",t.colorLeft)("camera",r),K(1),W("background",t.colorLeft),K(1),W("args",Ce(24,EAe))("position",Ht(25,SAe,-2)),K(4),W("args",Ce(27,TAe)),K(2),W("scissor",Bd(28,RAe,t.sliderPos,(null==n.rendererCanvas?null:n.rendererCanvas.width)||0,(null==n.rendererCanvas?null:n.rendererCanvas.height)||0))("scissorTest",!0)("clearColor",t.colorRight)("camera",r),K(1),W("background",t.colorRight),K(1),W("objRef",null==s.objRef?null:s.objRef.clone()),K(1),W("geometry",o.objRef),K(1),W("wireframe",!0)}},dependencies:[Pr,qi,Ll,Pn,Ki,Gl,nh,Di,Ds],styles:[".container[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.slider[_ngcontent-%COMP%]{position:absolute;cursor:ew-resize;width:40px;height:40px;background-color:#f32196;opacity:.7;border-radius:50%;top:calc(50% - 20px);left:calc(50% - 20px)}"],changeDetection:0});const yH={uniforms:{tDiffuse:{value:null},amount:{value:.005},angle:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float amount;\n\t\tuniform float angle;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec2 offset = amount * vec2( cos(angle), sin(angle));\n\t\t\tvec4 cr = texture2D(tDiffuse, vUv + offset);\n\t\t\tvec4 cga = texture2D(tDiffuse, vUv);\n\t\t\tvec4 cb = texture2D(tDiffuse, vUv - offset);\n\t\t\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);\n\n\t\t}"},IAe=["thecanvas"],DAe=function(i,e){return{x:0,y:0,width:i,height:e}},PAe=function(){return[0,0,1]},kAe=function(){return["#ffffff"]},BAe=function(){return[0,0,0]},kC=function(i){return[i,0,0]},LAe=function(){return[200,32,16]},FAe=function(){return["#fac400"]},OAe=function(){return["#f83f0d"]},NAe=function(){return[400,0,0]},UD=function(i,e,t,n){return{x:i,y:e,width:t,height:n}},jAe=function(i){return[i]},UAe=function(){return{value:.055}},VAe=function(i){return{amount:i}},zAe=function(){return[.35,.5,2048,!0]};class z0{constructor(){this.Math=Math,this.RGBShiftShader=yH,this.DotScreenShader=fD,this.canvasWidth=128,this.canvasHeight=128,this.mouseX=0,this.mouseY=0,this.view1={left:0,bottom:0,width:.5,height:1,background:new Le(.5,.5,.7),eye:[0,300,1800],up:[0,1,0],fov:30,updateCamera:(e,t)=>{this.updateSize(),e.position.x+=.05*this.mouseX,e.position.x=Math.max(Math.min(e.position.x,2e3),-2e3),e.lookAt(t.position),e.updateProjectionMatrix()}},this.view2={left:.5,bottom:0,width:.5,height:.5,background:new Le(.7,.5,.5),eye:[0,1800,0],up:[0,0,1],fov:45,updateCamera:(e,t)=>{this.updateSize(),e.position.x-=.05*this.mouseX,e.position.x=Math.max(Math.min(e.position.x,2e3),-2e3),e.lookAt(e.position.clone().setY(0)),e.updateProjectionMatrix()}},this.view3={left:.5,bottom:.5,width:.5,height:.5,background:new Le(.5,.7,.7),eye:[1400,800,1400],up:[0,1,0],fov:60,updateCamera:(e,t)=>{this.updateSize(),e.position.y-=.05*this.mouseX,e.position.y=Math.max(Math.min(e.position.y,1600),-1600),e.lookAt(t.position),e.updateProjectionMatrix()}}}ngOnInit(){!this.canvas||!this.canvas.rendererCanvas||(this.shadowTexture=new wx(this.canvas.rendererCanvas))}updateSize(){!this.canvas||!this.canvas.rendererCanvas||(this.canvasWidth=this.canvas.rendererCanvas.width,this.canvasHeight=this.canvas.rendererCanvas.height)}onMouseMove(e){if(!this.canvas||!this.canvas.rendererCanvas)return;const t=this.canvas.rendererCanvas.getBoundingClientRect();this.mouseX=e.clientX-t.left-t.width/2,this.mouseY=e.clientY-t.right-t.height/2}}z0.\u0275fac=function(e){return new(e||z0)},z0.\u0275cmp=$({type:z0,selectors:[["app-multi-view-postprocessing-example"]],viewQuery:function(e,t){if(1&e&&ji(IAe,7),2&e){let n;Ot(n=Nt())&&(t.canvas=n.first)}},hostBindings:function(e,t){1&e&&ut("mousemove",function(r){return t.onMouseMove(r)},0,tA)},decls:32,vars:95,consts:[[3,"disableDefaultView","viewPort"],["thecanvas",""],["scene",""],[3,"position","args"],[3,"position","rotation"],[3,"args"],["geo",""],[3,"flatShading","shininess","specular","color"],["mat",""],[3,"position","rotation","geometry","material"],[3,"scene","viewPort","scissor","scissorTest","onRender"],["thview1",""],[3,"position","up","fov","aspect","near","far"],["camera1",""],[3,"clearColor"],[3,"strength"],[3,"args","uniforms"],[3,"scene","viewPort","scissor","scissorTest","clearColor","onRender"],["thview2",""],["camera2",""],["thview3",""],["camera3",""]],template:function(e,t){if(1&e){const n=ys();ge(0,"th-canvas",0,1)(2,"th-scene",null,2),je(4,"th-directionalLight",3),ge(5,"th-mesh",4),je(6,"th-sphereGeometry",5,6)(8,"th-meshPhongMaterial",7,8),Re(),je(10,"th-mesh",9)(11,"th-mesh",9),Re(),ge(12,"th-view",10,11),ut("onRender",function(){nr(n);const s=qt(15),o=qt(3);return rr(t.view1.updateCamera(s.objRef,o.objRef))}),je(14,"th-perspectiveCamera",12,13),ge(16,"th-effectComposer"),je(17,"th-renderPass",14)(18,"th-unrealBloomPass",15)(19,"th-shaderPass",16)(20,"th-glitchPass"),Re()(),ge(21,"th-view",17,18),ut("onRender",function(){nr(n);const s=qt(24),o=qt(3);return rr(t.view2.updateCamera(s.objRef,o.objRef))}),je(23,"th-perspectiveCamera",12,19),ge(25,"th-effectComposer"),je(26,"th-renderPass")(27,"th-filmPass",5),Re()(),ge(28,"th-view",17,20),ut("onRender",function(){nr(n);const s=qt(31),o=qt(3);return rr(t.view3.updateCamera(s.objRef,o.objRef))}),je(30,"th-perspectiveCamera",12,21),Re()()}if(2&e){const n=qt(3),r=qt(7),s=qt(9),o=qt(13),a=qt(22),l=qt(29);W("disableDefaultView",!0)("viewPort",$o(56,DAe,.5*t.canvasWidth,t.canvasHeight)),K(4),W("position",Ce(59,PAe))("args",Ce(60,kAe)),K(1),W("position",Ce(61,BAe))("rotation",Ht(62,kC,-t.Math.PI/2)),K(1),W("args",Ce(64,LAe)),K(2),W("flatShading",!1)("shininess",30)("specular",Ce(65,FAe))("color",Ce(66,OAe)),K(2),W("position",Ht(67,kC,-400))("rotation",Ht(69,kC,-t.Math.PI/2))("geometry",r.objRef)("material",s.objRef),K(1),W("position",Ce(71,NAe))("rotation",Ht(72,kC,-t.Math.PI/2))("geometry",r.objRef)("material",s.objRef),K(1),W("scene",n)("viewPort",v_(74,UD,t.view1.left*t.canvasWidth,t.view1.bottom*t.canvasHeight,t.view1.width*t.canvasWidth,t.view1.height*t.canvasHeight))("scissor",o.viewPort)("scissorTest",!0),K(2),W("position",t.view1.eye)("up",t.view1.up)("fov",t.view1.fov)("aspect",t.view1.width*t.canvasWidth/(t.view1.height*t.canvasHeight))("near",1)("far",1e4),K(3),W("clearColor",t.view1.background),K(1),W("strength",.2),K(1),W("args",Ht(79,jAe,t.RGBShiftShader))("uniforms",Ht(82,VAe,Ce(81,UAe))),K(2),W("scene",n)("viewPort",v_(84,UD,t.view2.left*t.canvasWidth,t.view2.bottom*t.canvasHeight,t.view2.width*t.canvasWidth,t.view2.height*t.canvasHeight))("scissor",a.viewPort)("scissorTest",!0)("clearColor",t.view2.background),K(2),W("position",t.view2.eye)("up",t.view2.up)("fov",t.view2.fov)("aspect",t.view2.width*t.canvasWidth/(t.view2.height*t.canvasHeight))("near",1)("far",1e4),K(4),W("args",Ce(89,zAe)),K(1),W("scene",n)("viewPort",v_(90,UD,t.view3.left*t.canvasWidth,t.view3.bottom*t.canvasHeight,t.view3.width*t.canvasWidth,t.view3.height*t.canvasHeight))("scissor",l.viewPort)("scissorTest",!0)("clearColor",t.view3.background),K(2),W("position",t.view3.eye)("up",t.view3.up)("fov",t.view3.fov)("aspect",t.view3.width*t.canvasWidth/(t.view3.height*t.canvasHeight))("near",1)("far",1e4)}},dependencies:[qi,hs,Pn,Ki,lo,Ja,Vl,Ju,ih,zc,zl,Kc,Di,Ds],encapsulation:2,changeDetection:0});let xH=(()=>{class i{constructor(t,n){this._renderer=t,this._elementRef=n,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,n){this._renderer.setProperty(this._elementRef.nativeElement,t,n)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return i.\u0275fac=function(t){return new(t||i)(I(pl),I(Ft))},i.\u0275dir=Ne({type:i}),i})(),mh=(()=>{class i extends xH{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=le(i)))(n||i)}}(),i.\u0275dir=Ne({type:i,features:[q]}),i})();const fo=new Oe("NgValueAccessor"),GAe={provide:fo,useExisting:ae(()=>VD),multi:!0};let VD=(()=>{class i extends mh{writeValue(t){this.setProperty("checked",t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=le(i)))(n||i)}}(),i.\u0275dir=Ne({type:i,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,n){1&t&&ut("change",function(s){return n.onChange(s.target.checked)})("blur",function(){return n.onTouched()})},features:[ne([GAe]),q]}),i})();const HAe={provide:fo,useExisting:ae(()=>BC),multi:!0},WAe=new Oe("CompositionEventMode");let BC=(()=>{class i extends xH{constructor(t,n,r){super(t,n),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function QAe(){const i=Sa()?Sa().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return i.\u0275fac=function(t){return new(t||i)(I(pl),I(Ft),I(WAe,8))},i.\u0275dir=Ne({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,n){1&t&&ut("input",function(s){return n._handleInput(s.target.value)})("blur",function(){return n.onTouched()})("compositionstart",function(){return n._compositionStart()})("compositionend",function(s){return n._compositionEnd(s.target.value)})},features:[ne([HAe]),q]}),i})();const Xr=new Oe("NgValidators"),ud=new Oe("NgAsyncValidators");function PH(i){return null!=i}function kH(i){return h_(i)?En(i):i}function BH(i){let e={};return i.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function LH(i,e){return e.map(t=>t(i))}function FH(i){return i.map(e=>function XAe(i){return!i.validate}(e)?e:t=>e.validate(t))}function zD(i){return null!=i?function OH(i){if(!i)return null;const e=i.filter(PH);return 0==e.length?null:function(t){return BH(LH(t,e))}}(FH(i)):null}function GD(i){return null!=i?function NH(i){if(!i)return null;const e=i.filter(PH);return 0==e.length?null:function(t){return YV(LH(t,e).map(kH)).pipe(wt(BH))}}(FH(i)):null}function jH(i,e){return null===i?[e]:Array.isArray(i)?[...i,e]:[i,e]}function HD(i){return i?Array.isArray(i)?i:[i]:[]}function FC(i,e){return Array.isArray(i)?i.includes(e):i===e}function zH(i,e){const t=HD(e);return HD(i).forEach(r=>{FC(t,r)||t.push(r)}),t}function GH(i,e){return HD(e).filter(t=>!FC(i,t))}class HH{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=zD(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=GD(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class gs extends HH{get formDirective(){return null}get path(){return null}}class hd extends HH{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class QH{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let QD=(()=>{class i extends QH{constructor(t){super(t)}}return i.\u0275fac=function(t){return new(t||i)(I(hd,2))},i.\u0275dir=Ne({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,n){2&t&&Ei("ng-untouched",n.isUntouched)("ng-touched",n.isTouched)("ng-pristine",n.isPristine)("ng-dirty",n.isDirty)("ng-valid",n.isValid)("ng-invalid",n.isInvalid)("ng-pending",n.isPending)},features:[q]}),i})();const G0="VALID",NC="INVALID",Sg="PENDING",H0="DISABLED";function jC(i){return null!=i&&!Array.isArray(i)&&"object"==typeof i}class XH{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===G0}get invalid(){return this.status===NC}get pending(){return this.status==Sg}get disabled(){return this.status===H0}get enabled(){return this.status!==H0}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(zH(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(zH(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(GH(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(GH(e,this._rawAsyncValidators))}hasValidator(e){return FC(this._rawValidators,e)}hasAsyncValidator(e){return FC(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Sg,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=H0,this.errors=null,this._forEachChild(n=>{n.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=G0,this._forEachChild(n=>{n.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===G0||this.status===Sg)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?H0:G0}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Sg,this._hasOwnPendingAsyncValidator=!0;const t=kH(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((n,r)=>n&&n._find(r),this)}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Tt,this.statusChanges=new Tt}_calculateStatus(){return this._allControlsDisabled()?H0:this.errors?NC:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Sg)?Sg:this._anyControlsHaveStatus(NC)?NC:G0}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){jC(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function nye(i){return Array.isArray(i)?zD(i):i||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function rye(i){return Array.isArray(i)?GD(i):i||null}(this._rawAsyncValidators)}}const Q0=new Oe("CallSetDisabledState",{providedIn:"root",factory:()=>$D}),$D="always";function W0(i,e,t=$D){(function JD(i,e){const t=function UH(i){return i._rawValidators}(i);null!==e.validator?i.setValidators(jH(t,e.validator)):"function"==typeof t&&i.setValidators([t]);const n=function VH(i){return i._rawAsyncValidators}(i);null!==e.asyncValidator?i.setAsyncValidators(jH(n,e.asyncValidator)):"function"==typeof n&&i.setAsyncValidators([n]);const r=()=>i.updateValueAndValidity();zC(e._rawValidators,r),zC(e._rawAsyncValidators,r)})(i,e),e.valueAccessor.writeValue(i.value),(i.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(i.disabled),function aye(i,e){e.valueAccessor.registerOnChange(t=>{i._pendingValue=t,i._pendingChange=!0,i._pendingDirty=!0,"change"===i.updateOn&&ZH(i,e)})}(i,e),function cye(i,e){const t=(n,r)=>{e.valueAccessor.writeValue(n),r&&e.viewToModelUpdate(n)};i.registerOnChange(t),e._registerOnDestroy(()=>{i._unregisterOnChange(t)})}(i,e),function lye(i,e){e.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,"blur"===i.updateOn&&i._pendingChange&&ZH(i,e),"submit"!==i.updateOn&&i.markAsTouched()})}(i,e),function oye(i,e){if(e.valueAccessor.setDisabledState){const t=n=>{e.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(t),e._registerOnDestroy(()=>{i._unregisterOnDisabledChange(t)})}}(i,e)}function zC(i,e){i.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function ZH(i,e){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function JH(i,e){const t=i.indexOf(e);t>-1&&i.splice(t,1)}function e8(i){return"object"==typeof i&&null!==i&&2===Object.keys(i).length&&"value"in i&&"disabled"in i}const t8=class extends XH{constructor(e=null,t,n){super(function XD(i){return(jC(i)?i.validators:i)||null}(t),function ZD(i,e){return(jC(e)?e.asyncValidators:i)||null}(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),jC(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=e8(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){JH(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){JH(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){e8(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},_ye={provide:hd,useExisting:ae(()=>HC)},s8=(()=>Promise.resolve())();let HC=(()=>{class i extends hd{constructor(t,n,r,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new t8,this._registered=!1,this.update=new Tt,this._parent=t,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=function n2(i,e){if(!e)return null;let t,n,r;return Array.isArray(e),e.forEach(s=>{s.constructor===BC?t=s:function hye(i){return Object.getPrototypeOf(i.constructor)===mh}(s)?n=s:r=s}),r||n||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const n=t.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function t2(i,e){if(!i.hasOwnProperty("model"))return!1;const t=i.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){W0(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){s8.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const n=t.isDisabled.currentValue,r=0!==n&&hf(n);s8.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function UC(i,e){return[...e.path,i]}(t,this._parent):[t]}}return i.\u0275fac=function(t){return new(t||i)(I(gs,9),I(Xr,10),I(ud,10),I(fo,10),I(sr,8),I(Q0,8))},i.\u0275dir=Ne({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[ne([_ye]),q,Cr]}),i})(),a8=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({}),i})();const xye={provide:fo,useExisting:ae(()=>s2),multi:!0};let s2=(()=>{class i extends mh{writeValue(t){this.setProperty("value",parseFloat(t))}registerOnChange(t){this.onChange=n=>{t(""==n?null:parseFloat(n))}}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=le(i)))(n||i)}}(),i.\u0275dir=Ne({type:i,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,n){1&t&&ut("change",function(s){return n.onChange(s.target.value)})("input",function(s){return n.onChange(s.target.value)})("blur",function(){return n.onTouched()})},features:[ne([xye]),q]}),i})();const Tye={provide:fo,useExisting:ae(()=>QC),multi:!0};function f8(i,e){return null==i?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${i}: ${e}`.slice(0,50))}let QC=(()=>{class i extends mh{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const r=f8(this._getOptionId(t),t);this.setProperty("value",r)}registerOnChange(t){this.onChange=n=>{this.value=this._getOptionValue(n),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const n of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(n),t))return n;return null}_getOptionValue(t){const n=function Rye(i){return i.split(":")[0]}(t);return this._optionMap.has(n)?this._optionMap.get(n):t}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=le(i)))(n||i)}}(),i.\u0275dir=Ne({type:i,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,n){1&t&&ut("change",function(s){return n.onChange(s.target.value)})("blur",function(){return n.onTouched()})},inputs:{compareWith:"compareWith"},features:[ne([Tye]),q]}),i})(),p8=(()=>{class i{constructor(t,n,r){this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(f8(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(pl),I(QC,9))},i.\u0275dir=Ne({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),i})();const Iye={provide:fo,useExisting:ae(()=>c2),multi:!0};function m8(i,e){return null==i?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${i}: ${e}`.slice(0,50))}let c2=(()=>{class i extends mh{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let n;if(this.value=t,Array.isArray(t)){const r=t.map(s=>this._getOptionId(s));n=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else n=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(n)}registerOnChange(t){this.onChange=n=>{const r=[],s=n.selectedOptions;if(void 0!==s){const o=s;for(let a=0;a<o.length;a++){const c=this._getOptionValue(o[a].value);r.push(c)}}else{const o=n.options;for(let a=0;a<o.length;a++){const l=o[a];if(l.selected){const c=this._getOptionValue(l.value);r.push(c)}}}this.value=r,t(r)}}_registerOption(t){const n=(this._idCounter++).toString();return this._optionMap.set(n,t),n}_getOptionId(t){for(const n of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(n)._value,t))return n;return null}_getOptionValue(t){const n=function Dye(i){return i.split(":")[0]}(t);return this._optionMap.has(n)?this._optionMap.get(n)._value:t}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=le(i)))(n||i)}}(),i.\u0275dir=Ne({type:i,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,n){1&t&&ut("change",function(s){return n.onChange(s.target)})("blur",function(){return n.onTouched()})},inputs:{compareWith:"compareWith"},features:[ne([Iye]),q]}),i})(),g8=(()=>{class i{constructor(t,n,r){this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(m8(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(m8(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(pl),I(c2,9))},i.\u0275dir=Ne({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),i})(),Uye=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[a8]}),i})(),zye=(()=>{class i{static withConfig(t){return{ngModule:i,providers:[{provide:Q0,useValue:t.callSetDisabledState??$D}]}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[Uye]}),i})();function Gye(i,e){1&i&&je(0,"th-orbitControls")}function Hye(i,e){1&i&&je(0,"th-mapControls")}function Qye(i,e){1&i&&je(0,"th-arcballControls")}function Wye(i,e){1&i&&je(0,"th-transformControls",17),2&i&&(di(),W("object",qt(26).objRef))}const qye=function(i){return[i]},Yye=function(i,e,t){return[i,e,t]};function Xye(i,e){if(1&i&&je(0,"th-dragControls",10),2&i){di();const t=qt(26),n=qt(30),r=qt(22);W("args",Bd(3,Yye,Ht(1,qye,t.objRef),n.objRef,r.hostElement.nativeElement))}}function Zye(i,e){1&i&&je(0,"th-flyControls")}function Kye(i,e){1&i&&je(0,"th-trackballControls")}function $ye(i,e){1&i&&je(0,"th-firstPersonControls")}const Jye=function(){return[2,2,2]},exe=function(){return[1,1,1]},txe=function(){return[10,10]},E8=function(){return[10,10,10]},ixe=function(){return[45,2,.1,100]},nxe=function(){return[0,0,0]};class Y0{constructor(){this.controlType="orbit",this.renderOnDemand=!0,this.selected=!1,this.glbPath=`${Ps}DamagedHelmet.glb`}}Y0.\u0275fac=function(e){return new(e||Y0)},Y0.\u0275cmp=$({type:Y0,selectors:[["app-on-demand-example"]],decls:39,vars:27,consts:[[1,"control-panel"],["id","ondemand","type","checkbox",3,"ngModel","ngModelChange"],["for","ondemand"],[1,"form-control",3,"ngModel","ngModelChange"],[1,"works-on-demand"],[1,"needs-loop"],[3,"thStats","renderOnDemand"],["canvas",""],["loadGLTF","",3,"url","scale","onClick"],["model",""],[3,"args"],[3,"position"],[3,"ngSwitch","args","position","lookAt"],["camera",""],[4,"ngSwitchCase"],[3,"object",4,"ngSwitchCase"],[3,"args",4,"ngSwitchCase"],[3,"object"]],template:function(e,t){1&e&&(ge(0,"div",0)(1,"input",1),ut("ngModelChange",function(r){return t.renderOnDemand=r}),Re(),ge(2,"label",2),bi(3,"Render On-Demand"),Re(),ge(4,"select",3),ut("ngModelChange",function(r){return t.controlType=r}),ge(5,"option",4),bi(6,"orbit"),Re(),ge(7,"option",4),bi(8,"map"),Re(),ge(9,"option",4),bi(10,"arcball"),Re(),ge(11,"option",4),bi(12,"transform"),Re(),ge(13,"option",4),bi(14,"drag"),Re(),ge(15,"option",5),bi(16,"fly"),Re(),ge(17,"option",5),bi(18,"trackball"),Re(),ge(19,"option",5),bi(20,"firstpersion"),Re()()(),ge(21,"th-canvas",6,7)(23,"th-scene"),je(24,"th-ambientLight"),ge(25,"th-object3D",8,9),ut("onClick",function(){return t.selected=!t.selected}),Re(),je(27,"th-gridHelper",10)(28,"th-pointLight",11),ge(29,"th-perspectiveCamera",12,13),Bt(31,Gye,1,0,"th-orbitControls",14),Bt(32,Hye,1,0,"th-mapControls",14),Bt(33,Qye,1,0,"th-arcballControls",14),Bt(34,Wye,1,1,"th-transformControls",15),Bt(35,Xye,1,7,"th-dragControls",16),Bt(36,Zye,1,0,"th-flyControls",14),Bt(37,Kye,1,0,"th-trackballControls",14),Bt(38,$ye,1,0,"th-firstPersonControls",14),Re()()()),2&e&&(K(1),W("ngModel",t.renderOnDemand),K(3),W("ngModel",t.controlType),K(17),W("thStats",!0)("renderOnDemand",t.renderOnDemand),K(4),W("url",t.glbPath)("scale",t.selected?Ce(20,Jye):Ce(21,exe)),K(2),W("args",Ce(22,txe)),K(1),W("position",Ce(23,E8)),K(1),W("ngSwitch",t.controlType)("args",Ce(24,ixe))("position",Ce(25,E8))("lookAt",Ce(26,nxe)),K(2),W("ngSwitchCase","orbit"),K(1),W("ngSwitchCase","map"),K(1),W("ngSwitchCase","arcball"),K(1),W("ngSwitchCase","transform"),K(1),W("ngSwitchCase","drag"),K(1),W("ngSwitchCase","fly"),K(1),W("ngSwitchCase","trackball"),K(1),W("ngSwitchCase","firstpersion"))},dependencies:[UA,w3,Hu,Qu,Ku,eh,th,Pr,oh,Zc,qi,We,Is,ps,Wn,Ki,Di,Bs,Qa,Rc,fs,p8,g8,VD,QC,QD,HC],styles:[".needs-loop[_ngcontent-%COMP%]{color:red}.works-on-demand[_ngcontent-%COMP%]{color:green}.control-panel[_ngcontent-%COMP%]{display:flex;gap:1em;margin:1em}"],changeDetection:0});class il{constructor(e,t,n,r,s="div"){this.parent=e,this.object=t,this.property=n,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement("div"),this.domElement.classList.add("controller"),this.domElement.classList.add(r),this.$name=document.createElement("div"),this.$name.classList.add("name"),il.nextNameID=il.nextNameID||0,this.$name.id="lil-gui-name-"+ ++il.nextNameID,this.$widget=document.createElement(s),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(n)}name(e){return this._name=e,this.$name.innerHTML=e,this}onChange(e){return this._onChange=e,this}_callOnChange(){this.parent._callOnChange(this),void 0!==this._onChange&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),void 0!==this._onFinishChange&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(e=!0){return this.disable(!e)}disable(e=!0){return e===this._disabled||(this._disabled=e,this.domElement.classList.toggle("disabled",e),this.$disable.toggleAttribute("disabled",e)),this}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(e){const t=this.parent.add(this.object,this.property,e);return t.name(this._name),this.destroy(),t}min(e){return this}max(e){return this}step(e){return this}decimals(e){return this}listen(e=!0){return this._listening=e,void 0!==this._listenCallbackID&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const e=this.save();e!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=e}getValue(){return this.object[this.property]}setValue(e){return this.object[this.property]=e,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(e){return this.setValue(e),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class rxe extends il{constructor(e,t,n){super(e,t,n,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function u2(i){let e,t;return(e=i.match(/(#|0x)?([a-f0-9]{6})/i))?t=e[2]:(e=i.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?t=parseInt(e[1]).toString(16).padStart(2,0)+parseInt(e[2]).toString(16).padStart(2,0)+parseInt(e[3]).toString(16).padStart(2,0):(e=i.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(t=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),!!t&&"#"+t}const sxe={isPrimitive:!0,match:i=>"string"==typeof i,fromHexString:u2,toHexString:u2},X0={isPrimitive:!0,match:i=>"number"==typeof i,fromHexString:i=>parseInt(i.substring(1),16),toHexString:i=>"#"+i.toString(16).padStart(6,0)},oxe={isPrimitive:!1,match:Array.isArray,fromHexString(i,e,t=1){const n=X0.fromHexString(i);e[0]=(n>>16&255)/255*t,e[1]=(n>>8&255)/255*t,e[2]=(255&n)/255*t},toHexString:([i,e,t],n=1)=>X0.toHexString(i*(n=255/n)<<16^e*n<<8^t*n<<0)},axe=[sxe,X0,oxe,{isPrimitive:!1,match:i=>Object(i)===i,fromHexString(i,e,t=1){const n=X0.fromHexString(i);e.r=(n>>16&255)/255*t,e.g=(n>>8&255)/255*t,e.b=(255&n)/255*t},toHexString:({r:i,g:e,b:t},n=1)=>X0.toHexString(i*(n=255/n)<<16^e*n<<8^t*n<<0)}];class cxe extends il{constructor(e,t,n,r){super(e,t,n,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=function lxe(i){return axe.find(e=>e.match(i))}(this.initialValue),this._rgbScale=r,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const s=u2(this.$text.value);s&&this._setValueFromHexString(s)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(e){if(this._format.isPrimitive){const t=this._format.fromHexString(e);this.setValue(t)}else this._format.fromHexString(e,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(e){return this._setValueFromHexString(e),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class h2 extends il{constructor(e,t,n){super(e,t,n,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",r=>{r.preventDefault(),this.getValue().call(this.object)}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class dxe extends il{constructor(e,t,n,r,s,o){super(e,t,n,"number"),this._initInput(),this.min(r),this.max(s);const a=void 0!==o;this.step(a?o:this._getImplicitStep(),a),this.updateDisplay()}decimals(e){return this._decimals=e,this.updateDisplay(),this}min(e){return this._min=e,this._onUpdateMinMax(),this}max(e){return this._max=e,this._onUpdateMinMax(),this}step(e,t=!0){return this._step=e,this._stepExplicit=t,this}updateDisplay(){const e=this.getValue();if(this._hasSlider){let t=(e-this._min)/(this._max-this._min);t=Math.max(0,Math.min(t,1)),this.$fill.style.width=100*t+"%"}return this._inputFocused||(this.$input.value=void 0===this._decimals?e:e.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$disable=this.$input;const t=p=>{const v=parseFloat(this.$input.value);isNaN(v)||(this._snapClampSetValue(v+p),this.$input.value=this.getValue())};let o,a,l,c,d,s=!1;const f=p=>{if(s){const v=p.clientX-o;Math.abs(p.clientY-a)>5?(p.preventDefault(),this.$input.blur(),s=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(v)>5&&m()}s||(d-=(p.clientY-l)*this._step*this._arrowKeyMultiplier(p),c+d>this._max?d=this._max-c:c+d<this._min&&(d=this._min-c),this._snapClampSetValue(c+d)),l=p.clientY},m=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",m)};this.$input.addEventListener("input",()=>{let p=parseFloat(this.$input.value);isNaN(p)||(this._stepExplicit&&(p=this._snap(p)),this.setValue(this._clamp(p)))}),this.$input.addEventListener("keydown",p=>{"Enter"===p.code&&this.$input.blur(),"ArrowUp"===p.code&&(p.preventDefault(),t(this._step*this._arrowKeyMultiplier(p))),"ArrowDown"===p.code&&(p.preventDefault(),t(this._step*this._arrowKeyMultiplier(p)*-1))}),this.$input.addEventListener("wheel",p=>{this._inputFocused&&(p.preventDefault(),t(this._step*this._normalizeMouseWheel(p)))},{passive:!1}),this.$input.addEventListener("mousedown",p=>{o=p.clientX,a=l=p.clientY,s=!0,c=this.getValue(),d=0,window.addEventListener("mousemove",f),window.addEventListener("mouseup",m)}),this.$input.addEventListener("focus",()=>{this._inputFocused=!0}),this.$input.addEventListener("blur",()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()})}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const t=p=>{const v=this.$slider.getBoundingClientRect();let b=((p,v,b,y,x)=>(p-v)/(b-v)*(this._max-y)+y)(p,v.left,v.right,this._min);this._snapClampSetValue(b)},r=p=>{t(p.clientX)},s=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",s)};let a,l,o=!1;const c=p=>{p.preventDefault(),this._setDraggingStyle(!0),t(p.touches[0].clientX),o=!1},u=p=>{if(o){const b=p.touches[0].clientY-l;Math.abs(p.touches[0].clientX-a)>Math.abs(b)?c(p):(window.removeEventListener("touchmove",u),window.removeEventListener("touchend",h))}else p.preventDefault(),t(p.touches[0].clientX)},h=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",u),window.removeEventListener("touchend",h)},f=this._callOnFinishChange.bind(this);let _;this.$slider.addEventListener("mousedown",p=>{this._setDraggingStyle(!0),t(p.clientX),window.addEventListener("mousemove",r),window.addEventListener("mouseup",s)}),this.$slider.addEventListener("touchstart",p=>{p.touches.length>1||(this._hasScrollBar?(a=p.touches[0].clientX,l=p.touches[0].clientY,o=!0):c(p),window.addEventListener("touchmove",u,{passive:!1}),window.addEventListener("touchend",h))},{passive:!1}),this.$slider.addEventListener("wheel",p=>{if(Math.abs(p.deltaX)<Math.abs(p.deltaY)&&this._hasScrollBar)return;p.preventDefault();const b=this._normalizeMouseWheel(p)*this._step;this._snapClampSetValue(this.getValue()+b),this.$input.value=this.getValue(),clearTimeout(_),_=setTimeout(f,400)},{passive:!1})}_setDraggingStyle(e,t="horizontal"){this.$slider&&this.$slider.classList.toggle("active",e),document.body.classList.toggle("lil-gui-dragging",e),document.body.classList.toggle(`lil-gui-${t}`,e)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(e){let{deltaX:t,deltaY:n}=e;return Math.floor(e.deltaY)!==e.deltaY&&e.wheelDelta&&(t=0,n=-e.wheelDelta/120,n*=this._stepExplicit?1:10),t+-n}_arrowKeyMultiplier(e){let t=this._stepExplicit?1:10;return e.shiftKey?t*=10:e.altKey&&(t/=10),t}_snap(e){const t=Math.round(e/this._step)*this._step;return parseFloat(t.toPrecision(15))}_clamp(e){return e<this._min&&(e=this._min),e>this._max&&(e=this._max),e}_snapClampSetValue(e){this.setValue(this._clamp(this._snap(e)))}get _hasScrollBar(){const e=this.parent.root.$children;return e.scrollHeight>e.clientHeight}get _hasMin(){return void 0!==this._min}get _hasMax(){return void 0!==this._max}}class uxe extends il{constructor(e,t,n,r){super(e,t,n,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this._values=Array.isArray(r)?r:Object.values(r),this._names=Array.isArray(r)?r:Object.keys(r),this._names.forEach(s=>{const o=document.createElement("option");o.innerHTML=s,this.$select.appendChild(o)}),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.updateDisplay()}updateDisplay(){const e=this.getValue(),t=this._values.indexOf(e);return this.$select.selectedIndex=t,this.$display.innerHTML=-1===t?e:this._names[t],this}}class hxe extends il{constructor(e,t,n){super(e,t,n,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",r=>{"Enter"===r.code&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}let S8=!1;class f2{constructor({parent:e,autoPlace:t=void 0===e,container:n,width:r,title:s="Controls",injectStyles:o=!0,touchStyles:a=!0}={}){if(this.parent=e,this.root=e?e.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",l=>{("Enter"===l.code||"Space"===l.code)&&(l.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(s),a&&this.domElement.classList.add("allow-touch-styles"),this.parent)return this.parent.children.push(this),this.parent.folders.push(this),void this.parent.$children.appendChild(this.domElement);this.domElement.classList.add("root"),!S8&&o&&(function pxe(i){const e=document.createElement("style");e.innerHTML=i;const t=document.querySelector("head link[rel=stylesheet], head style");t?document.head.insertBefore(e,t):document.head.appendChild(e)}('.lil-gui {\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  line-height: 1;\n  font-weight: normal;\n  font-style: normal;\n  text-align: left;\n  background-color: var(--background-color);\n  color: var(--text-color);\n  user-select: none;\n  -webkit-user-select: none;\n  touch-action: manipulation;\n  --background-color: #1f1f1f;\n  --text-color: #ebebeb;\n  --title-background-color: #111111;\n  --title-text-color: #ebebeb;\n  --widget-color: #424242;\n  --hover-color: #4f4f4f;\n  --focus-color: #595959;\n  --number-color: #2cc9ff;\n  --string-color: #a2db3c;\n  --font-size: 11px;\n  --input-font-size: 11px;\n  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;\n  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;\n  --padding: 4px;\n  --spacing: 4px;\n  --widget-height: 20px;\n  --name-width: 45%;\n  --slider-knob-width: 2px;\n  --slider-input-width: 27%;\n  --color-input-width: 27%;\n  --slider-input-min-width: 45px;\n  --color-input-min-width: 45px;\n  --folder-indent: 7px;\n  --widget-padding: 0 0 0 3px;\n  --widget-border-radius: 2px;\n  --checkbox-size: calc(0.75 * var(--widget-height));\n  --scrollbar-width: 5px;\n}\n.lil-gui, .lil-gui * {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n.lil-gui.root {\n  width: var(--width, 245px);\n  display: flex;\n  flex-direction: column;\n}\n.lil-gui.root > .title {\n  background: var(--title-background-color);\n  color: var(--title-text-color);\n}\n.lil-gui.root > .children {\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.lil-gui.root > .children::-webkit-scrollbar {\n  width: var(--scrollbar-width);\n  height: var(--scrollbar-width);\n  background: var(--background-color);\n}\n.lil-gui.root > .children::-webkit-scrollbar-thumb {\n  border-radius: var(--scrollbar-width);\n  background: var(--focus-color);\n}\n@media (pointer: coarse) {\n  .lil-gui.allow-touch-styles {\n    --widget-height: 28px;\n    --padding: 6px;\n    --spacing: 6px;\n    --font-size: 13px;\n    --input-font-size: 16px;\n    --folder-indent: 10px;\n    --scrollbar-width: 7px;\n    --slider-input-min-width: 50px;\n    --color-input-min-width: 65px;\n  }\n}\n.lil-gui.force-touch-styles {\n  --widget-height: 28px;\n  --padding: 6px;\n  --spacing: 6px;\n  --font-size: 13px;\n  --input-font-size: 16px;\n  --folder-indent: 10px;\n  --scrollbar-width: 7px;\n  --slider-input-min-width: 50px;\n  --color-input-min-width: 65px;\n}\n.lil-gui.autoPlace {\n  max-height: 100%;\n  position: fixed;\n  top: 0;\n  right: 15px;\n  z-index: 1001;\n}\n\n.lil-gui .controller {\n  display: flex;\n  align-items: center;\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n}\n.lil-gui .controller.disabled {\n  opacity: 0.5;\n}\n.lil-gui .controller.disabled, .lil-gui .controller.disabled * {\n  pointer-events: none !important;\n}\n.lil-gui .controller > .name {\n  min-width: var(--name-width);\n  flex-shrink: 0;\n  white-space: pre;\n  padding-right: var(--spacing);\n  line-height: var(--widget-height);\n}\n.lil-gui .controller .widget {\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  min-height: var(--widget-height);\n}\n.lil-gui .controller.string input {\n  color: var(--string-color);\n}\n.lil-gui .controller.boolean .widget {\n  cursor: pointer;\n}\n.lil-gui .controller.color .display {\n  width: 100%;\n  height: var(--widget-height);\n  border-radius: var(--widget-border-radius);\n  position: relative;\n}\n@media (hover: hover) {\n  .lil-gui .controller.color .display:hover:before {\n    content: " ";\n    display: block;\n    position: absolute;\n    border-radius: var(--widget-border-radius);\n    border: 1px solid #fff9;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n  }\n}\n.lil-gui .controller.color input[type=color] {\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n}\n.lil-gui .controller.color input[type=text] {\n  margin-left: var(--spacing);\n  font-family: var(--font-family-mono);\n  min-width: var(--color-input-min-width);\n  width: var(--color-input-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.option select {\n  opacity: 0;\n  position: absolute;\n  width: 100%;\n  max-width: 100%;\n}\n.lil-gui .controller.option .display {\n  position: relative;\n  pointer-events: none;\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  line-height: var(--widget-height);\n  max-width: 100%;\n  overflow: hidden;\n  word-break: break-all;\n  padding-left: 0.55em;\n  padding-right: 1.75em;\n  background: var(--widget-color);\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .display.focus {\n    background: var(--focus-color);\n  }\n}\n.lil-gui .controller.option .display.active {\n  background: var(--focus-color);\n}\n.lil-gui .controller.option .display:after {\n  font-family: "lil-gui";\n  content: "\u2195";\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  padding-right: 0.375em;\n}\n.lil-gui .controller.option .widget,\n.lil-gui .controller.option select {\n  cursor: pointer;\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .widget:hover .display {\n    background: var(--hover-color);\n  }\n}\n.lil-gui .controller.number input {\n  color: var(--number-color);\n}\n.lil-gui .controller.number.hasSlider input {\n  margin-left: var(--spacing);\n  width: var(--slider-input-width);\n  min-width: var(--slider-input-min-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.number .slider {\n  width: 100%;\n  height: var(--widget-height);\n  background-color: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  padding-right: var(--slider-knob-width);\n  overflow: hidden;\n  cursor: ew-resize;\n  touch-action: pan-y;\n}\n@media (hover: hover) {\n  .lil-gui .controller.number .slider:hover {\n    background-color: var(--hover-color);\n  }\n}\n.lil-gui .controller.number .slider.active {\n  background-color: var(--focus-color);\n}\n.lil-gui .controller.number .slider.active .fill {\n  opacity: 0.95;\n}\n.lil-gui .controller.number .fill {\n  height: 100%;\n  border-right: var(--slider-knob-width) solid var(--number-color);\n  box-sizing: content-box;\n}\n\n.lil-gui-dragging .lil-gui {\n  --hover-color: var(--widget-color);\n}\n.lil-gui-dragging * {\n  cursor: ew-resize !important;\n}\n\n.lil-gui-dragging.lil-gui-vertical * {\n  cursor: ns-resize !important;\n}\n\n.lil-gui .title {\n  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);\n  height: var(--title-height);\n  line-height: calc(var(--title-height) - 4px);\n  font-weight: 600;\n  padding: 0 var(--padding);\n  -webkit-tap-highlight-color: transparent;\n  cursor: pointer;\n  outline: none;\n  text-decoration-skip: objects;\n}\n.lil-gui .title:before {\n  font-family: "lil-gui";\n  content: "\u25be";\n  padding-right: 2px;\n  display: inline-block;\n}\n.lil-gui .title:active {\n  background: var(--title-background-color);\n  opacity: 0.75;\n}\n@media (hover: hover) {\n  body:not(.lil-gui-dragging) .lil-gui .title:hover {\n    background: var(--title-background-color);\n    opacity: 0.85;\n  }\n  .lil-gui .title:focus {\n    text-decoration: underline var(--focus-color);\n  }\n}\n.lil-gui.root > .title:focus {\n  text-decoration: none !important;\n}\n.lil-gui.closed > .title:before {\n  content: "\u25b8";\n}\n.lil-gui.closed > .children {\n  transform: translateY(-7px);\n  opacity: 0;\n}\n.lil-gui.closed:not(.transition) > .children {\n  display: none;\n}\n.lil-gui.transition > .children {\n  transition-duration: 300ms;\n  transition-property: height, opacity, transform;\n  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);\n  overflow: hidden;\n  pointer-events: none;\n}\n.lil-gui .children:empty:before {\n  content: "Empty";\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n  display: block;\n  height: var(--widget-height);\n  font-style: italic;\n  line-height: var(--widget-height);\n  opacity: 0.5;\n}\n.lil-gui.root > .children > .lil-gui > .title {\n  border: 0 solid var(--widget-color);\n  border-width: 1px 0;\n  transition: border-color 300ms;\n}\n.lil-gui.root > .children > .lil-gui.closed > .title {\n  border-bottom-color: transparent;\n}\n.lil-gui + .controller {\n  border-top: 1px solid var(--widget-color);\n  margin-top: 0;\n  padding-top: var(--spacing);\n}\n.lil-gui .lil-gui .lil-gui > .title {\n  border: none;\n}\n.lil-gui .lil-gui .lil-gui > .children {\n  border: none;\n  margin-left: var(--folder-indent);\n  border-left: 2px solid var(--widget-color);\n}\n.lil-gui .lil-gui .controller {\n  border: none;\n}\n\n.lil-gui input {\n  -webkit-tap-highlight-color: transparent;\n  border: 0;\n  outline: none;\n  font-family: var(--font-family);\n  font-size: var(--input-font-size);\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  background: var(--widget-color);\n  color: var(--text-color);\n  width: 100%;\n}\n@media (hover: hover) {\n  .lil-gui input:hover {\n    background: var(--hover-color);\n  }\n  .lil-gui input:active {\n    background: var(--focus-color);\n  }\n}\n.lil-gui input:disabled {\n  opacity: 1;\n}\n.lil-gui input[type=text],\n.lil-gui input[type=number] {\n  padding: var(--widget-padding);\n}\n.lil-gui input[type=text]:focus,\n.lil-gui input[type=number]:focus {\n  background: var(--focus-color);\n}\n.lil-gui input::-webkit-outer-spin-button,\n.lil-gui input::-webkit-inner-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n.lil-gui input[type=number] {\n  -moz-appearance: textfield;\n}\n.lil-gui input[type=checkbox] {\n  appearance: none;\n  -webkit-appearance: none;\n  height: var(--checkbox-size);\n  width: var(--checkbox-size);\n  border-radius: var(--widget-border-radius);\n  text-align: center;\n  cursor: pointer;\n}\n.lil-gui input[type=checkbox]:checked:before {\n  font-family: "lil-gui";\n  content: "\u2713";\n  font-size: var(--checkbox-size);\n  line-height: var(--checkbox-size);\n}\n@media (hover: hover) {\n  .lil-gui input[type=checkbox]:focus {\n    box-shadow: inset 0 0 0 1px var(--focus-color);\n  }\n}\n.lil-gui button {\n  -webkit-tap-highlight-color: transparent;\n  outline: none;\n  cursor: pointer;\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  color: var(--text-color);\n  width: 100%;\n  height: var(--widget-height);\n  text-transform: none;\n  background: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  border: 1px solid var(--widget-color);\n  text-align: center;\n  line-height: calc(var(--widget-height) - 4px);\n}\n@media (hover: hover) {\n  .lil-gui button:hover {\n    background: var(--hover-color);\n    border-color: var(--hover-color);\n  }\n  .lil-gui button:focus {\n    border-color: var(--focus-color);\n  }\n}\n.lil-gui button:active {\n  background: var(--focus-color);\n}\n\n@font-face {\n  font-family: "lil-gui";\n  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");\n}'),S8=!0),n?n.appendChild(this.domElement):t&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),r&&this.domElement.style.setProperty("--width",r+"px"),this.domElement.addEventListener("keydown",l=>l.stopPropagation()),this.domElement.addEventListener("keyup",l=>l.stopPropagation())}add(e,t,n,r,s){if(Object(n)===n)return new uxe(this,e,t,n);const o=e[t];switch(typeof o){case"number":return new dxe(this,e,t,n,r,s);case"boolean":return new rxe(this,e,t);case"string":return new hxe(this,e,t);case"function":return new h2(this,e,t)}console.error("gui.add failed\n\tproperty:",t,"\n\tobject:",e,"\n\tvalue:",o)}addColor(e,t,n=1){return new cxe(this,e,t,n)}addFolder(e){return new f2({parent:this,title:e})}load(e,t=!0){return e.controllers&&this.controllers.forEach(n=>{n instanceof h2||n._name in e.controllers&&n.load(e.controllers[n._name])}),t&&e.folders&&this.folders.forEach(n=>{n._title in e.folders&&n.load(e.folders[n._title])}),this}save(e=!0){const t={controllers:{},folders:{}};return this.controllers.forEach(n=>{if(!(n instanceof h2)){if(n._name in t.controllers)throw new Error(`Cannot save GUI with duplicate property "${n._name}"`);t.controllers[n._name]=n.save()}}),e&&this.folders.forEach(n=>{if(n._title in t.folders)throw new Error(`Cannot save GUI with duplicate folder "${n._title}"`);t.folders[n._title]=n.save()}),t}open(e=!0){return this._closed=!e,this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(e=!0){return this._closed=!e,this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{this.$children.style.height=this.$children.clientHeight+"px",this.domElement.classList.add("transition");const n=s=>{s.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",n))};this.$children.addEventListener("transitionend",n);const r=e?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!e),requestAnimationFrame(()=>{this.$children.style.height=r+"px"})}),this}title(e){return this._title=e,this.$title.innerHTML=e,this}reset(e=!0){return(e?this.controllersRecursive():this.controllers).forEach(n=>n.reset()),this}onChange(e){return this._onChange=e,this}_callOnChange(e){this.parent&&this.parent._callOnChange(e),void 0!==this._onChange&&this._onChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(e){this.parent&&this.parent._callOnFinishChange(e),void 0!==this._onFinishChange&&this._onFinishChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(e=>e.destroy())}controllersRecursive(){let e=Array.from(this.controllers);return this.folders.forEach(t=>{e=e.concat(t.controllersRecursive())}),e}foldersRecursive(){let e=Array.from(this.folders);return this.folders.forEach(t=>{e=e.concat(t.foldersRecursive())}),e}}const mxe=f2,gxe=["outlinePass"],p2=function(i,e,t){return[i,e,t]};function _xe(i,e){if(1&i){const t=ys();ge(0,"th-mesh",14),ut("onMouseEnter",function(r){return nr(t),rr(di().onHover(r))})("onMouseExit",function(){return nr(t),rr(di().onBlur())})("onPointerDown",function(r){return nr(t),rr(di().onPointerDown(r))}),je(1,"th-meshPhongMaterial",15),Re()}if(2&i){const t=e.$implicit;di(),W("geometry",qt(11).objRef)("position",Bd(7,p2,t.x,t.y,t.z))("scale",Bd(11,p2,t.scale,t.scale,t.scale))("receiveShadow",!0)("castShadow",!0),K(1),W("flatShading",!0)("color",t.color)}}const bxe=function(){return["#ffffff"]},vxe=function(){return[0,0,8]},Axe=function(){return["#aaaaaa"]},yxe=function(){return["#ddffdd"]},xxe=function(){return[3,48,24]};class Z0{constructor(e){this.elem=e,this.outlinePassResolution=new fe(window.innerWidth,window.innerHeight),this.meshData=[],this.visibleEdgeColor="#ffffff",this.hiddenEdgeColor="#190a05",this.edgeStrength=3,this.edgeGlow=.5,this.edgeThickness=1,this.pulsePeriod=1,this.initGUI(),this.initMeshData()}initGUI(){const e=new mxe({title:"Settings",injectStyles:!0,container:this.elem.nativeElement,autoPlace:!0});e.add(this,"edgeStrength",.01,10),e.add(this,"edgeGlow",0,2),e.add(this,"edgeThickness",1,4),e.add(this,"pulsePeriod",0,5),e.addColor(this,"visibleEdgeColor"),e.addColor(this,"hiddenEdgeColor")}ngOnInit(){this.outlinePassResolution=new fe(window.innerWidth,window.innerHeight),this.outlinePass&&(this.outlinePass.resolution=this.outlinePassResolution)}initMeshData(){for(let e=0;e<20;e++)this.meshData.push({color:(new Le).setHSL(Math.random(),1,.3),x:4*Math.random()-2,y:4*Math.random()-2,z:4*Math.random()-2,scale:.3*Math.random()+.1})}onHover(e){e.component.objRef&&(this.outlinePass.selectedObjects=[e.component.objRef])}onBlur(){this.outlinePass.selectedObjects=[]}onPointerDown(e){e.component.material?.color.set("#ff0000")}}Z0.\u0275fac=function(e){return new(e||Z0)(I(Ft))},Z0.\u0275cmp=$({type:Z0,selectors:[["app-outline-pass-events-example"]],viewQuery:function(e,t){if(1&e&&ji(gxe,7),2&e){let n;Ot(n=Nt())&&(t.outlinePass=n.first)}},decls:19,vars:32,consts:[[3,"shadow","thStats"],["thecanvas",""],[3,"background"],["scene",""],[3,"position","fov","near","far"],["camera",""],[3,"color"],[3,"color","intensity"],["light",""],[3,"args"],["geometry",""],[3,"geometry","position","scale","receiveShadow","castShadow","onMouseEnter","onMouseExit","onPointerDown",4,"ngFor","ngForOf"],[3,"args","visibleEdgeColor","hiddenEdgeColor","edgeStrength","edgeGlow","edgeThickness","pulsePeriod"],["outlinePass",""],[3,"geometry","position","scale","receiveShadow","castShadow","onMouseEnter","onMouseExit","onPointerDown"],[3,"flatShading","color"]],template:function(e,t){if(1&e&&(ge(0,"th-canvas",0,1)(2,"th-scene",2,3)(4,"th-perspectiveCamera",4,5),je(6,"th-orbitControls"),Re(),je(7,"th-ambientLight",6)(8,"th-directionalLight",7,8)(10,"th-sphereGeometry",9,10),Bt(12,_xe,2,15,"th-mesh",11),Re(),ge(13,"th-effectComposer"),je(14,"th-renderPass")(15,"th-outlinePass",12,13),On(17,"color"),On(18,"color"),Re()()),2&e){const n=qt(3),r=qt(5);W("shadow",!0)("thStats",!0),K(2),W("background",Ce(23,bxe)),K(2),W("position",Ce(24,vxe))("fov",45)("near",.1)("far",100),K(3),W("color",Ce(25,Axe)),K(1),W("color",Ce(26,yxe))("intensity",.6),K(2),W("args",Ce(27,xxe)),K(2),W("ngForOf",t.meshData),K(3),W("args",Bd(28,p2,t.outlinePassResolution,n.objRef,r.objRef))("visibleEdgeColor",Zn(17,19,t.visibleEdgeColor))("hiddenEdgeColor",Zn(18,21,t.hiddenEdgeColor))("edgeStrength",t.edgeStrength)("edgeGlow",t.edgeGlow)("edgeThickness",t.edgeThickness)("pulsePeriod",t.pulsePeriod)}},dependencies:[yl,Pr,qi,hs,Wn,Pn,Ki,lo,Ja,Vl,lh,zc,Di,Qa,fs,Hl],styles:["[_nghost-%COMP%]     .lil-gui{position:fixed;right:0;z-index:9999}"]});const wxe=["camera"],Cxe=function(){return["#72645b",2,15]},Mxe=function(i){return[0,i,0]},T8=function(i){return[i,0,0]},Exe=function(){return[40,40]},Sxe=function(){return{color:"#999999",specular:"#101010"}},Txe=function(i){return[0,i,.3]},Rxe=function(){return[.001,.001,.001]},Ixe=function(){return{color:"#0055ff",flatShading:!0}},Dxe=function(){return["#443333","#111122"]},Pxe=function(){return[1,1,1]},kxe=function(i){return[.5,1,i]},Bxe=function(){return[35,2,1,15]};class K0{constructor(){this.Math=Math,this.cameraPosition=new R(3,.15,3),this.assetPath=`${Ps}dolphins.ply`}onBeforeRender(){const e=5e-4*Date.now();this.camera&&(this.camera.position=new R(2.5*Math.sin(e),.15,2.5*Math.cos(e)),this.camera.lookAt=[0,.1,0])}}K0.\u0275fac=function(e){return new(e||K0)},K0.\u0275cmp=$({type:K0,selectors:[["app-plyloader-example"]],viewQuery:function(e,t){if(1&e&&ji(wxe,5),2&e){let n;Ot(n=Nt())&&(t.camera=n.first)}},decls:17,vars:55,consts:[[3,"shadow","onRender"],[3,"background","fog"],[3,"position","rotation","receiveShadow"],[3,"args"],[3,"rotation","position","scale","castShadow","receiveShadow"],["loadPLY","",3,"url"],[3,"castShadow","position","color","intensity","receiveShadow"],["camera",""]],template:function(e,t){1&e&&(ge(0,"th-canvas",0),ut("onRender",function(){return t.onBeforeRender()}),ge(1,"th-scene",1),On(2,"color"),On(3,"fog"),ge(4,"th-mesh",2),je(5,"th-planeGeometry",3)(6,"th-meshPhongMaterial",3),Re(),ge(7,"th-mesh",4),je(8,"th-bufferGeometry",5)(9,"th-meshStandardMaterial",3),Re(),je(10,"th-hemisphereLight",3)(11,"th-directionalLight",6),On(12,"color"),je(13,"th-directionalLight",6),On(14,"color"),je(15,"th-perspectiveCamera",3,7),Re()()),2&e&&(W("shadow",!0),K(1),W("background",Zn(2,29,"#72645b"))("fog",Zn(3,31,Ce(37,Cxe))),K(3),W("position",Ht(38,Mxe,-.5))("rotation",Ht(40,T8,-t.Math.PI/2))("receiveShadow",!0),K(1),W("args",Ce(42,Exe)),K(1),W("args",Ce(43,Sxe)),K(1),W("rotation",Ht(44,T8,-t.Math.PI/2))("position",Ht(46,Txe,-.2))("scale",Ce(48,Rxe))("castShadow",!0)("receiveShadow",!0),K(1),W("url",t.assetPath),K(1),W("args",Ce(49,Ixe)),K(1),W("args",Ce(50,Dxe)),K(1),W("castShadow",!0)("position",Ce(51,Pxe))("color",Zn(12,33,"#ffffff"))("intensity",1.35)("castShadow",!0)("receiveShadow",!0),K(2),W("castShadow",!0)("position",Ht(52,kxe,-1))("color",Zn(14,35,"#ffaa00"))("intensity",1)("castShadow",!0)("receiveShadow",!0),K(2),W("args",Ce(54,Bxe)))},dependencies:[qi,Ll,hs,Pn,Ki,Gl,lo,Rt,Po,Di,P0,Hl,Dp],encapsulation:2,changeDetection:0});const Lxe=["object"],Fxe=["light"];function Oxe(i,e){if(1&i&&(ge(0,"th-mesh",14),je(1,"th-meshPhongMaterial",15),Re()),2&i){const t=e.$implicit;di(),W("geometry",qt(15).objRef)("position",t.pos)("rotation",t.rotation)("scale",t.scale),K(1),W("flatShading",!0)("color",t.color)}}const Nxe=function(i){return[i]},jxe=function(i){return{value:i}},Uxe=function(i){return{amount:i}},R8=function(){return["#ffffff"]},Vxe=function(i){return[0,0,i]},zxe=function(){return["#222222"]},Gxe=function(){return[1,4,4]};class $0{constructor(){this.DotScreenShader=fD,this.RGBShiftShader=yH,this.shiftAmount=.0015,this.zDist=400,this.meshData=[],this.initMeshData()}ngOnInit(){this.light?.position?.set(1,1,1)}initMeshData(){for(let e=0;e<100;e++){const t=50*Math.random();this.meshData.push({pos:new R(Math.random()-.5,Math.random()-.5,Math.random()-.5).normalize().multiplyScalar(Math.random()*this.zDist),rotation:new ro(2*Math.random(),2*Math.random(),2*Math.random()),scale:new R(t,t,t),color:new Le(16777215*Math.random())})}}animate(){this.object?.objRef?.rotation&&(this.object.objRef.rotation.x+=.005,this.object.objRef.rotation.y+=.01)}}$0.\u0275fac=function(e){return new(e||$0)},$0.\u0275cmp=$({type:$0,selectors:[["app-post-processing-example"]],viewQuery:function(e,t){if(1&e&&(ji(Lxe,7),ji(Fxe,7)),2&e){let n;Ot(n=Nt())&&(t.object=n.first),Ot(n=Nt())&&(t.light=n.first)}},decls:19,vars:30,consts:[["for","shift"],["id","shift","type","range",3,"ngModel","min","max","step","ngModelChange"],[3,"shadow","thStats","onRender"],["thecanvas",""],[3,"strength"],[3,"args","uniforms"],[3,"background"],[3,"position","fov","near","far"],[3,"color"],["light",""],[3,"args"],["geometry",""],["object",""],[3,"geometry","position","rotation","scale",4,"ngFor","ngForOf"],[3,"geometry","position","rotation","scale"],[3,"flatShading","color"]],template:function(e,t){1&e&&(ge(0,"label",0),bi(1,"Shift Amount"),Re(),ge(2,"input",1),ut("ngModelChange",function(r){return t.shiftAmount=r}),Re(),ge(3,"th-canvas",2,3),ut("onRender",function(){return t.animate()}),ge(5,"th-effectComposer"),je(6,"th-renderPass")(7,"th-unrealBloomPass",4)(8,"th-shaderPass",5),Re(),ge(9,"th-scene",6),je(10,"th-perspectiveCamera",7)(11,"th-ambientLight",8)(12,"th-directionalLight",8,9)(14,"th-sphereGeometry",10,11),ge(16,"th-object3D",null,12),Bt(18,Oxe,2,6,"th-mesh",13),Re()()()),2&e&&(K(2),W("ngModel",t.shiftAmount)("min",.0015)("max",.2)("step",.005),K(1),W("shadow",!0)("thStats",!0),K(4),W("strength",1),K(1),W("args",Ht(18,Nxe,t.RGBShiftShader))("uniforms",Ht(22,Uxe,Ht(20,jxe,t.shiftAmount))),K(1),W("background",Ce(24,R8)),K(1),W("position",Ht(25,Vxe,t.zDist))("fov",70)("near",1)("far",1e3),K(1),W("color",Ce(27,zxe)),K(1),W("color",Ce(28,R8)),K(2),W("args",Ce(29,Gxe)),K(4),W("ngForOf",t.meshData))},dependencies:[yl,qi,We,hs,Wn,Pn,Ki,lo,Ja,Vl,zc,zl,Kc,Di,fs,BC,s2,QD,HC],styles:["label[_ngcontent-%COMP%]{margin-right:.5em}"],changeDetection:0});const m2=function(i){return[0,i,0]},Hxe=function(){return[0,1,0]},Qxe=function(){return[4,10,2]},Wxe=function(i){return[i,0,0]},qxe=function(){return[100,100]},Yxe=function(){return[55,2,.1,100]},Xxe=function(i,e){return[i,0,e]},Zxe=function(){return[0,0,0]};class J0{constructor(e){this.Math=Math,this.selected=!1,this.glbPath=`${Ps}mac-draco.glb`,this.clock=new Au(!0),this.plane=new oo(new R(0,1,0),3),this.rotation=[0,0,0],this.position=[0,0,0],this.uniforms={time:{value:1}},this.fragmentShader1="\nuniform float time;\nvarying vec2 vUv;\n\nvoid main( void ) {\n  vec2 position = - 1.0 + 2.0 * vUv;\n\n  float red = abs( sin( position.x * position.y + time / 5.0 ) );\n  float green = abs( sin( position.x * position.y + time / 4.0 ) );\n  float blue = abs( sin( position.x * position.y + time / 3.0 ) );\n  gl_FragColor = vec4( red, green, blue, 1.0 );\n\n}\n",this.fragmentShader2="\n  uniform float time;\n  varying vec2 vUv;\n\n  void main( void ) {\n    vec2 position = vUv;\n    float color = 0.0;\n    color += sin( position.x * cos( time / 15.0 ) * 80.0 ) + cos( position.y * cos( time / 15.0 ) * 10.0 );\n    color += sin( position.y * sin( time / 10.0 ) * 40.0 ) + cos( position.x * sin( time / 25.0 ) * 40.0 );\n    color += sin( position.x * sin( time / 5.0 ) * 10.0 ) + sin( position.y * sin( time / 35.0 ) * 80.0 );\n    color *= sin( time / 10.0 ) * 0.5;\n    gl_FragColor = vec4( vec3( color, color * 0.5, sin( color + time / 3.0 ) * 0.75 ), 1.0 );\n  }\n  ",this.vertexShader="varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    gl_Position = projectionMatrix * mvPosition;\n  }\n  ",e.setDecoderPath("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/jsm/libs/draco/gltf/"),e.setCrossOrigin("no-cors"),this.calcPose()}onBeforeRender(){this.calcPose(),this.calcUniforms()}calcPose(){const e=this.clock.getElapsedTime();this.rotation=[ft.lerp(this.rotation[0],Math.cos(e/2)/20+.25,.1),ft.lerp(this.rotation[1],Math.sin(e/4)/20,.1),ft.lerp(this.rotation[2],Math.sin(e/8)/20,.1)],this.position=[0,ft.lerp(this.position[1],(-2+Math.sin(e/2))/2,.1),0]}calcUniforms(){this.uniforms.time.value=1+5*this.clock.getElapsedTime()}}J0.\u0275fac=function(e){return new(e||J0)(I(Ga))},J0.\u0275cmp=$({type:J0,selectors:[["app-ref-by-id-example"]],decls:17,vars:45,consts:[[3,"thStats","shadow","onRender"],[3,"rotation","position"],["loadGLTF","",3,"castShadow","url","position","rotation","onClick"],[3,"refById"],[3,"vertexShader","fragmentShader","uniforms"],["shader",""],[3,"castShadow","position","lookAt","color","intensity"],["light",""],[3,"receiveShadow","rotation","position"],[3,"args"],[3,"color"],[3,"args","position","lookAt"]],template:function(e,t){if(1&e){const n=ys();ge(0,"th-canvas",0),ut("onRender",function(){return t.onBeforeRender()}),ge(1,"th-scene"),je(2,"th-ambientLight"),ge(3,"th-group",1)(4,"th-object3D",2),ut("onClick",function(){nr(n);const s=qt(7);return t.selected=!t.selected,rr(s.needsUpdate=!0)}),ge(5,"th-mesh",3),je(6,"th-shaderMaterial",4,5),Re()()(),je(8,"th-directionalLight",6,7),On(10,"color"),ge(11,"th-mesh",8),je(12,"th-planeGeometry",9)(13,"th-meshBasicMaterial",10),On(14,"color"),Re(),ge(15,"th-perspectiveCamera",11),je(16,"th-orbitControls"),Re()()()}2&e&&(W("thStats",!0)("shadow",!0),K(3),W("rotation",Ht(29,m2,t.Math.PI))("position",Ce(31,Hxe)),K(1),W("castShadow",!0)("url",t.glbPath)("position",t.position)("rotation",t.rotation),K(1),W("refById","Cube008_2"),K(1),W("vertexShader",t.vertexShader)("fragmentShader",t.selected?t.fragmentShader1:t.fragmentShader2)("uniforms",t.uniforms),K(2),W("castShadow",!0)("position",Ce(32,Qxe))("lookAt",Ht(33,m2,-3))("color",Zn(10,25,"#ffffff"))("intensity",.75),K(3),W("receiveShadow",!0)("rotation",Ht(35,Wxe,3*t.Math.PI/2))("position",Ht(37,m2,-3)),K(1),W("args",Ce(39,qxe)),K(1),W("color",Zn(14,27,"#efefef")),K(2),W("args",Ce(40,Yxe))("position",$o(41,Xxe,-5,-15))("lookAt",Ce(44,Zxe)))},dependencies:[Pr,qi,We,hs,Wn,Pn,$a,Ki,qc,ha,Po,Di,Bs,Qa,fs,ph,Hl],encapsulation:2,changeDetection:0});const g2=function(){return[0,0,0]},Kxe=function(){return[2,2,2]},$xe=function(){return[1,1,1]},Jxe=function(i,e){return[i,e]},ewe=function(){return[10,10]},I8=function(){return[10,10,10]},twe=function(){return[45,2,.1,100]};class Tg extends Pn{constructor(e){super(e)}ngOnInit(){super.ngOnInit(),this.objRef&&(this.objRef.material=new ja({color:"green"}),this.objRef.geometry=new tn(1,1,1))}}Tg.\u0275fac=function(e){return new(e||Tg)(I(We,4))},Tg.\u0275cmp=$({type:Tg,selectors:[["th-box"]],features:[ne(function Y0e(i){return[{provide:We,useExisting:ae(()=>i)}]}(Tg)),q],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});class ev{constructor(){this.THREE=wh,this.box=new io(new R(0,0,0),new R(1.5,1.5,1.5)),this.color=new Le(1,0,0),this.rotation=[0,0,0],this.material=new ja,this.selected=!1,this.material.color.set("green"),setInterval(()=>{0!==this.material.color.r?(this.material=new ja,this.material.color.set("green")):(this.material=new ja,this.material.color.set("red"))},200)}onBeforeRender(){this.rotation=[0,this.rotation[2]+.01,this.rotation[2]+.01]}ngOnInit(){}}ev.\u0275fac=function(e){return new(e||ev)},ev.\u0275cmp=$({type:ev,selectors:[["app-simple-example"]],features:[ne([zb()])],decls:8,vars:24,consts:[[3,"onRender"],[3,"position","material","rotation","scale","onClick"],[3,"args","material","position"],[3,"args"],[3,"position"],[3,"args","position","lookAt"]],template:function(e,t){1&e&&(ge(0,"th-canvas",0),ut("onRender",function(){return t.onBeforeRender()}),ge(1,"th-scene"),je(2,"th-ambientLight"),ge(3,"th-box",1),ut("onClick",function(){return t.selected=!t.selected}),Re(),je(4,"th-box3Helper",2)(5,"th-gridHelper",3)(6,"th-pointLight",4)(7,"th-perspectiveCamera",5),Re()()),2&e&&(K(3),W("position",Ce(12,g2))("material",t.material)("rotation",t.rotation)("scale",t.selected?Ce(13,Kxe):Ce(14,$xe)),K(1),W("args",$o(15,Jxe,t.box,t.color))("material",t.material)("position",Ce(18,g2)),K(1),W("args",Ce(19,ewe)),K(1),W("position",Ce(20,I8)),K(1),W("args",Ce(21,twe))("position",Ce(22,I8))("lookAt",Ce(23,g2)))},dependencies:[qi,Is,Xu,ps,Wn,Ki,Di,Qa,Tg],encapsulation:2,changeDetection:0});const iwe=["thecanvas"],nwe=function(i,e,t,n){return{x:i,y:e,width:t,height:n}};function rwe(i,e){if(1&i){const t=ys();ge(0,"th-view",11,12),ut("onRender",function(){const s=nr(t).$implicit,o=qt(3);di();const a=qt(3);return rr(s.updateCamera(o.objRef,a.objRef))}),je(2,"th-perspectiveCamera",13,14),Re()}if(2&i){const t=e.$implicit,n=qt(1),r=di();W("scene",qt(3))("viewPort",v_(11,nwe,t.left*r.canvasWidth,t.bottom*r.canvasHeight,t.width*r.canvasWidth,t.height*r.canvasHeight))("scissor",n.viewPort)("scissorTest",!0)("clearColor",t.background),K(2),W("position",t.eye)("up",t.up)("fov",t.fov)("aspect",t.width*r.canvasWidth/(t.height*r.canvasHeight))("near",1)("far",1e4)}}const swe=function(i,e){return{x:0,y:0,width:i,height:e}},owe=function(){return[0,0,1]},awe=function(){return["#ffffff"]},lwe=function(){return[0,0,0]},WC=function(i){return[i,0,0]},cwe=function(){return[200,32,16]},dwe=function(){return["#fac400"]},uwe=function(){return["#f83f0d"]},hwe=function(){return[400,0,0]};class tv{constructor(){this.Math=Math,this.canvasWidth=128,this.canvasHeight=128,this.mouseX=0,this.mouseY=0,this.views=[{left:0,bottom:0,width:.5,height:1,background:new Le(.5,.5,.7),eye:[0,300,1800],up:[0,1,0],fov:30,updateCamera:(e,t)=>{this.updateSize(),e.position.x+=.05*this.mouseX,e.position.x=Math.max(Math.min(e.position.x,2e3),-2e3),e.lookAt(t.position),e.updateProjectionMatrix()}},{left:.5,bottom:0,width:.5,height:.5,background:new Le(.7,.5,.5),eye:[0,1800,0],up:[0,0,1],fov:45,updateCamera:(e,t)=>{this.updateSize(),e.position.x-=.05*this.mouseX,e.position.x=Math.max(Math.min(e.position.x,2e3),-2e3),e.lookAt(e.position.clone().setY(0)),e.updateProjectionMatrix()}},{left:.5,bottom:.5,width:.5,height:.5,background:new Le(.5,.7,.7),eye:[1400,800,1400],up:[0,1,0],fov:60,updateCamera:(e,t)=>{this.updateSize(),e.position.y-=.05*this.mouseX,e.position.y=Math.max(Math.min(e.position.y,1600),-1600),e.lookAt(t.position),e.updateProjectionMatrix()}}]}ngOnInit(){!this.canvas||!this.canvas.rendererCanvas||(this.shadowTexture=new wx(this.canvas.rendererCanvas))}updateSize(){!this.canvas||!this.canvas.rendererCanvas||(this.canvasWidth=this.canvas.rendererCanvas.width,this.canvasHeight=this.canvas.rendererCanvas.height)}onMouseMove(e){if(!this.canvas||!this.canvas.rendererCanvas)return;const t=this.canvas.rendererCanvas.getBoundingClientRect();this.mouseX=e.clientX-t.left-t.width/2,this.mouseY=e.clientY-t.right-t.height/2}}tv.\u0275fac=function(e){return new(e||tv)},tv.\u0275cmp=$({type:tv,selectors:[["app-views-example"]],viewQuery:function(e,t){if(1&e&&ji(iwe,7),2&e){let n;Ot(n=Nt())&&(t.canvas=n.first)}},hostBindings:function(e,t){1&e&&ut("mousemove",function(r){return t.onMouseMove(r)},0,tA)},decls:13,vars:38,consts:[[3,"disableDefaultView","viewPort"],["thecanvas",""],["scene",""],[3,"position","args"],[3,"position","rotation"],[3,"args"],["geo",""],[3,"flatShading","shininess","specular","color"],["mat",""],[3,"position","rotation","geometry","material"],[3,"scene","viewPort","scissor","scissorTest","clearColor","onRender",4,"ngFor","ngForOf"],[3,"scene","viewPort","scissor","scissorTest","clearColor","onRender"],["thview",""],[3,"position","up","fov","aspect","near","far"],["camera",""]],template:function(e,t){if(1&e&&(ge(0,"th-canvas",0,1)(2,"th-scene",null,2),je(4,"th-directionalLight",3),ge(5,"th-mesh",4),je(6,"th-sphereGeometry",5,6)(8,"th-meshPhongMaterial",7,8),Re(),je(10,"th-mesh",9)(11,"th-mesh",9),Re(),Bt(12,rwe,4,16,"th-view",10),Re()),2&e){const n=qt(7),r=qt(9);W("disableDefaultView",!0)("viewPort",$o(20,swe,.5*t.canvasWidth,t.canvasHeight)),K(4),W("position",Ce(23,owe))("args",Ce(24,awe)),K(1),W("position",Ce(25,lwe))("rotation",Ht(26,WC,-t.Math.PI/2)),K(1),W("args",Ce(28,cwe)),K(2),W("flatShading",!1)("shininess",30)("specular",Ce(29,dwe))("color",Ce(30,uwe)),K(2),W("position",Ht(31,WC,-400))("rotation",Ht(33,WC,-t.Math.PI/2))("geometry",n.objRef)("material",r.objRef),K(1),W("position",Ce(35,hwe))("rotation",Ht(36,WC,-t.Math.PI/2))("geometry",n.objRef)("material",r.objRef),K(1),W("ngForOf",t.views)}},dependencies:[yl,qi,hs,Pn,Ki,lo,Ja,Di,Ds],changeDetection:0});const fwe=function(){return[0,1,0]},pwe=function(){return[0,0,.2]},mwe=function(){return[0,0]},gwe=function(){return[10,10]},D8=function(){return[10,10,10]},_we=function(){return[45,2,.1,100]},bwe=function(){return[0,0,0]};class iv{constructor(){this.assetPath1=`${Ps}DamagedHelmet.glb`,this.assetPath2=`${Ps}BoomBox.glb`,this.rotation=[0,0,0]}onBeforeRender(){this.rotation=[0,this.rotation[1]+.01,0]}resetRotation(){this.rotation=[0,0,0]}}function vwe(i,e){if(1&i&&(ge(0,"th-cSS3DObject",8)(1,"div",11)(2,"div",12),bi(3),Re(),ge(4,"div",13),bi(5),Re(),ge(6,"div",14),bi(7),je(8,"br"),bi(9),Re()()()),2&i){const t=e.$implicit,n=e.index,r=di();W("position",r.poses[n].position),K(1),Pd("background","rgba(0,127,127,"+(.5*r.Math.random()+.25)+")"),K(2),tc(" ",n+1," "),K(2),tc(" ",t[0]," "),K(2),tc(" ",t[1]," "),K(2),tc(" ",t[2]," ")}}iv.\u0275fac=function(e){return new(e||iv)},iv.\u0275cmp=$({type:iv,selectors:[["app-multi-renderer-example"]],features:[ne([zb(),G5()])],decls:13,vars:19,consts:[[3,"onRender"],[3,"thStats"],["loadGLTF","",3,"url","rotation","position"],[3,"position","center"],[1,"label"],[3,"pointerdown"],[3,"args"],[3,"position"],[3,"args","position","lookAt"]],template:function(e,t){1&e&&(ge(0,"th-canvas",0),ut("onRender",function(){return t.onBeforeRender()}),ge(1,"th-scene",1),je(2,"th-ambientLight"),ge(3,"th-object3D",2)(4,"th-cSS2DObject",3)(5,"div",4),bi(6," A Helmet "),ge(7,"button",5),ut("pointerdown",function(){return t.resetRotation()}),bi(8,"Reset"),Re()()()(),je(9,"th-gridHelper",6)(10,"th-pointLight",7),ge(11,"th-perspectiveCamera",8),je(12,"th-orbitControls"),Re()()()),2&e&&(K(1),W("thStats",!0),K(2),W("url",t.assetPath1)("rotation",t.rotation)("position",Ce(11,fwe)),K(1),W("position",Ce(12,pwe))("center",Ce(13,mwe)),K(5),W("args",Ce(14,gwe)),K(1),W("position",Ce(15,D8)),K(1),W("args",Ce(16,_we))("position",Ce(17,D8))("lookAt",Ce(18,bwe)))},dependencies:[Pr,qi,We,Is,ps,Wn,Ki,Nu,Di,Bs,fs],styles:[".label{background-color:#d3d3d3;border-radius:5px;line-height:1rem;padding:.5rem;display:inline-block}"],changeDetection:0});const Awe=function(){return[10,10,10]},ywe=function(){return[45,2,1,1e4]},xwe=function(){return[0,0,3e3]},wwe=function(){return[0,0,0]};class nv{constructor(){this.Math=Math,this.table=[["H","Hydrogen","1.00794",1,1],["He","Helium","4.002602",18,1],["Li","Lithium","6.941",1,2],["Be","Beryllium","9.012182",2,2],["B","Boron","10.811",13,2],["C","Carbon","12.0107",14,2],["N","Nitrogen","14.0067",15,2],["O","Oxygen","15.9994",16,2],["F","Fluorine","18.9984032",17,2],["Ne","Neon","20.1797",18,2],["Na","Sodium","22.98976...",1,3],["Mg","Magnesium","24.305",2,3],["Al","Aluminium","26.9815386",13,3],["Si","Silicon","28.0855",14,3],["P","Phosphorus","30.973762",15,3],["S","Sulfur","32.065",16,3],["Cl","Chlorine","35.453",17,3],["Ar","Argon","39.948",18,3],["K","Potassium","39.948",1,4],["Ca","Calcium","40.078",2,4],["Sc","Scandium","44.955912",3,4],["Ti","Titanium","47.867",4,4],["V","Vanadium","50.9415",5,4],["Cr","Chromium","51.9961",6,4],["Mn","Manganese","54.938045",7,4],["Fe","Iron","55.845",8,4],["Co","Cobalt","58.933195",9,4],["Ni","Nickel","58.6934",10,4],["Cu","Copper","63.546",11,4],["Zn","Zinc","65.38",12,4],["Ga","Gallium","69.723",13,4],["Ge","Germanium","72.63",14,4],["As","Arsenic","74.9216",15,4],["Se","Selenium","78.96",16,4],["Br","Bromine","79.904",17,4],["Kr","Krypton","83.798",18,4],["Rb","Rubidium","85.4678",1,5],["Sr","Strontium","87.62",2,5],["Y","Yttrium","88.90585",3,5],["Zr","Zirconium","91.224",4,5],["Nb","Niobium","92.90628",5,5],["Mo","Molybdenum","95.96",6,5],["Tc","Technetium","(98)",7,5],["Ru","Ruthenium","101.07",8,5],["Rh","Rhodium","102.9055",9,5],["Pd","Palladium","106.42",10,5],["Ag","Silver","107.8682",11,5],["Cd","Cadmium","112.411",12,5],["In","Indium","114.818",13,5],["Sn","Tin","118.71",14,5],["Sb","Antimony","121.76",15,5],["Te","Tellurium","127.6",16,5],["I","Iodine","126.90447",17,5],["Xe","Xenon","131.293",18,5],["Cs","Caesium","132.9054",1,6],["Ba","Barium","132.9054",2,6],["La","Lanthanum","138.90547",4,9],["Ce","Cerium","140.116",5,9],["Pr","Praseodymium","140.90765",6,9],["Nd","Neodymium","144.242",7,9],["Pm","Promethium","(145)",8,9],["Sm","Samarium","150.36",9,9],["Eu","Europium","151.964",10,9],["Gd","Gadolinium","157.25",11,9],["Tb","Terbium","158.92535",12,9],["Dy","Dysprosium","162.5",13,9],["Ho","Holmium","164.93032",14,9],["Er","Erbium","167.259",15,9],["Tm","Thulium","168.93421",16,9],["Yb","Ytterbium","173.054",17,9],["Lu","Lutetium","174.9668",18,9],["Hf","Hafnium","178.49",4,6],["Ta","Tantalum","180.94788",5,6],["W","Tungsten","183.84",6,6],["Re","Rhenium","186.207",7,6],["Os","Osmium","190.23",8,6],["Ir","Iridium","192.217",9,6],["Pt","Platinum","195.084",10,6],["Au","Gold","196.966569",11,6],["Hg","Mercury","200.59",12,6],["Tl","Thallium","204.3833",13,6],["Pb","Lead","207.2",14,6],["Bi","Bismuth","208.9804",15,6],["Po","Polonium","(209)",16,6],["At","Astatine","(210)",17,6],["Rn","Radon","(222)",18,6],["Fr","Francium","(223)",1,7],["Ra","Radium","(226)",2,7],["Ac","Actinium","(227)",4,10],["Th","Thorium","232.03806",5,10],["Pa","Protactinium","231.0588",6,10],["U","Uranium","238.02891",7,10],["Np","Neptunium","(237)",8,10],["Pu","Plutonium","(244)",9,10],["Am","Americium","(243)",10,10],["Cm","Curium","(247)",11,10],["Bk","Berkelium","(247)",12,10],["Cf","Californium","(251)",13,10],["Es","Einstenium","(252)",14,10],["Fm","Fermium","(257)",15,10],["Md","Mendelevium","(258)",16,10],["No","Nobelium","(259)",17,10],["Lr","Lawrencium","(262)",18,10],["Rf","Rutherfordium","(267)",4,7],["Db","Dubnium","(268)",5,7],["Sg","Seaborgium","(271)",6,7],["Bh","Bohrium","(272)",7,7],["Hs","Hassium","(270)",8,7],["Mt","Meitnerium","(276)",9,7],["Ds","Darmstadium","(281)",10,7],["Rg","Roentgenium","(280)",11,7],["Cn","Copernicium","(285)",12,7],["Nh","Nihonium","(286)",13,7],["Fl","Flerovium","(289)",14,7],["Mc","Moscovium","(290)",15,7],["Lv","Livermorium","(293)",16,7],["Ts","Tennessine","(294)",17,7],["Og","Oganesson","(294)",18,7]],this.poses=[],this.createRandomPoses()}createRandomPoses(){this.poses=[];for(let e=0;e<this.table.length;e++){const t=new Qt;t.position.set(4e3*Math.random()-2e3,4e3*Math.random()-2e3,4e3*Math.random()-2e3),this.poses.push(t)}}createTablePoses(){this.poses=this.table.map(e=>{const t=new Qt;return t.position.x=140*e[3]-1330,t.position.y=-180*e[4]+990,t})}createSpherePoses(){const e=new R,t=this.table.length;this.poses=this.table.map((n,r)=>{const s=Math.acos(2*r/t-1),o=Math.sqrt(t*Math.PI)*s,a=new Qt;return a.position.setFromSphericalCoords(800,s,o),e.copy(a.position).multiplyScalar(2),a.lookAt(e),a})}createHelixPoses(){const e=new R;this.poses=this.table.map((t,n)=>{const r=.175*n+Math.PI,s=-8*n+450,o=new Qt;return o.position.setFromCylindricalCoords(900,r,s),e.x=2*o.position.x,e.y=o.position.y,e.z=2*o.position.z,o.lookAt(e),o})}createGridPoses(){new R,this.poses=this.table.map((t,n)=>{const r=new Qt;return r.position.x=n%5*400-800,r.position.y=-Math.floor(n/5)%5*400+800,r.position.z=1e3*Math.floor(n/25)-2e3,r})}}nv.\u0275fac=function(e){return new(e||nv)},nv.\u0275cmp=$({type:nv,selectors:[["app-css3d-multi-renderer-example"]],features:[ne([tI()])],decls:16,vars:13,consts:[["id","menu"],["id","table",3,"click"],["id","sphere",3,"click"],["id","helix",3,"click"],["id","grid",3,"click"],[1,"canvas-background",3,"renderOnDemand"],[3,"thStats"],[3,"position",4,"ngFor","ngForOf"],[3,"position"],[3,"args","position","lookAt"],[3,"minDistance","maxDistance"],[1,"element"],[1,"number"],[1,"symbol"],[1,"details"]],template:function(e,t){1&e&&(ge(0,"div",0)(1,"button",1),ut("click",function(){return t.createTablePoses()}),bi(2,"TABLE"),Re(),ge(3,"button",2),ut("click",function(){return t.createSpherePoses()}),bi(4,"SPHERE"),Re(),ge(5,"button",3),ut("click",function(){return t.createHelixPoses()}),bi(6,"HELIX"),Re(),ge(7,"button",4),ut("click",function(){return t.createGridPoses()}),bi(8,"GRID"),Re()(),ge(9,"th-canvas",5)(10,"th-scene",6),je(11,"th-ambientLight"),Bt(12,vwe,10,7,"th-cSS3DObject",7),je(13,"th-pointLight",8),ge(14,"th-perspectiveCamera",9),je(15,"th-trackballControls",10),Re()()()),2&e&&(K(9),W("renderOnDemand",!0),K(1),W("thStats",!0),K(2),W("ngForOf",t.table),K(1),W("position",Ce(9,Awe)),K(1),W("args",Ce(10,ywe))("position",Ce(11,xwe))("lookAt",Ce(12,wwe)),K(1),W("minDistance",500)("maxDistance",6e3))},dependencies:[yl,Zc,qi,ps,Wn,Ki,Vc,Di,Rc,fs],styles:[".canvas-background[_ngcontent-%COMP%]{background-color:#000}a[_ngcontent-%COMP%]{color:#8ff}#menu[_ngcontent-%COMP%]{position:absolute;bottom:20px;width:100%;text-align:center;z-index:10}.element[_ngcontent-%COMP%]{width:120px;height:160px;box-shadow:0 0 12px #00ffff80;border:1px solid rgba(127,255,255,.25);font-family:Helvetica,sans-serif;text-align:center;line-height:normal;cursor:default}.element[_ngcontent-%COMP%]:hover{box-shadow:0 0 12px #00ffffbf;border:1px solid rgba(127,255,255,.75)}.element[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{position:absolute;top:20px;right:20px;font-size:12px;color:#7fffffbf}.element[_ngcontent-%COMP%]   .symbol[_ngcontent-%COMP%]{position:absolute;top:40px;left:0;right:0;font-size:60px;font-weight:700;color:#ffffffbf;text-shadow:0 0 10px rgba(0,255,255,.95)}.element[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{position:absolute;bottom:15px;left:0;right:0;font-size:12px;color:#7fffffbf}button[_ngcontent-%COMP%]{color:#7fffffbf;background:transparent;outline:1px solid rgba(127,255,255,.75);border:0px;padding:5px 10px;cursor:pointer}button[_ngcontent-%COMP%]:hover{background-color:#00ffff80}button[_ngcontent-%COMP%]:active{color:#000;background-color:#00ffffbf}"],changeDetection:0});const _2=function(i){return[0,i,0]},Cwe=function(){return[0,1,0]},P8=function(i){return[i,0,0]},Mwe=function(i){return[0,.04,i]},Ewe=function(){return[.0043,.0043,.0043]},Swe=function(){return[1960,1280]},Twe=function(){return[4,10,2]},Rwe=function(){return[100,100]},Iwe=function(){return[55,2,.1,100]},Dwe=function(i,e){return[i,0,e]},Pwe=function(){return[0,0,0]};class rv{constructor(e){this.THREE=wh,this.Math=Math,this.sprite=!1,this.glbPath=`${Ps}mac-draco.glb`,this.clock=new Au(!0),this.rotation=[0,0,0],this.position=[0,0,0],this.webGlRenderer=Et(Eu),e.setDecoderPath("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/jsm/libs/draco/gltf/"),e.setCrossOrigin("no-cors"),this.webGlRenderer.domElement.style.pointerEvents="none",this.webGlRenderer.domElement.style.zIndex="1",this.calcPose()}onBeforeRender(){this.calcPose()}calcPose(){const e=this.clock.getElapsedTime();this.rotation=[ft.lerp(this.rotation[0],Math.cos(e/2)/20+.25,.1),ft.lerp(this.rotation[1],Math.sin(e/4)/20,.1),ft.lerp(this.rotation[2],Math.sin(e/8)/20,.1)],this.position=[0,ft.lerp(this.position[1],(-2+Math.sin(e/2))/2,.1),0]}}rv.\u0275fac=function(e){return new(e||rv)(I(Ga))},rv.\u0275cmp=$({type:rv,selectors:[["app-html-with-css3d-example"]],features:[ne([zb(),tI()])],decls:23,vars:58,consts:[[3,"thStats","shadow","onRender"],[3,"rotation","position"],["loadGLTF","",3,"castShadow","url","position","rotation"],[3,"refById"],[3,"rotation","position","scale"],["holder",""],[3,"args"],[3,"opacity","blending","side","color"],["src","./multi-view-postprocessing-example",2,"width","1960px","height","1280px"],[3,"castShadow","position","lookAt","color","intensity"],["light",""],[3,"receiveShadow","rotation","position"],[3,"color"],[3,"args","position","lookAt"]],template:function(e,t){1&e&&(ge(0,"th-canvas",0),ut("onRender",function(){return t.onBeforeRender()}),ge(1,"th-scene"),je(2,"th-ambientLight"),ge(3,"th-group",1)(4,"th-object3D",2)(5,"th-mesh",3)(6,"th-group",4,5)(8,"th-mesh"),je(9,"th-planeGeometry",6)(10,"th-meshBasicMaterial",7),On(11,"color"),Re(),ge(12,"th-cSS3DObject"),je(13,"iframe",8),Re()()()()(),je(14,"th-directionalLight",9,10),On(16,"color"),ge(17,"th-mesh",11),je(18,"th-planeGeometry",6)(19,"th-meshBasicMaterial",12),On(20,"color"),Re(),ge(21,"th-perspectiveCamera",13),je(22,"th-orbitControls"),Re()()()),2&e&&(W("thStats",!0)("shadow",!0),K(3),W("rotation",Ht(36,_2,t.Math.PI))("position",Ce(38,Cwe)),K(1),W("castShadow",!0)("url",t.glbPath)("position",t.position)("rotation",t.rotation),K(1),W("refById","Cube008_2"),K(1),W("rotation",Ht(39,P8,-1*t.Math.PI/2))("position",Ht(41,Mwe,-.02))("scale",Ce(43,Ewe)),K(3),W("args",Ce(44,Swe)),K(1),W("opacity",0)("blending",t.THREE.NoBlending)("side",t.THREE.DoubleSide)("color",Zn(11,30,"black")),K(4),W("castShadow",!0)("position",Ce(45,Twe))("lookAt",Ht(46,_2,-3))("color",Zn(16,32,"#ffffff"))("intensity",.75),K(3),W("receiveShadow",!0)("rotation",Ht(48,P8,3*t.Math.PI/2))("position",Ht(50,_2,-3)),K(1),W("args",Ce(52,Rwe)),K(1),W("color",Zn(20,34,"#efefef")),K(2),W("args",Ce(53,Iwe))("position",$o(54,Dwe,-5,-15))("lookAt",Ce(57,Pwe)))},dependencies:[Pr,qi,We,hs,Wn,Pn,$a,Ki,Vc,ha,Po,Di,Bs,fs,ph,Hl],encapsulation:2,changeDetection:0});const qC=[{path:"basic-example",data:{title:"Basic Example",exampleComponent:Yb,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/basic-example/basic-example.component.ts"]}},{path:"simple-example",data:{title:"Simple Example",exampleComponent:ev,declarations:["SimpleExampleComponent","Box"],codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/simple-example/simple-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/simple-example/simple-example.component.ts"]}},{path:"introductory-example",data:{title:"Introductory Example",exampleComponent:j0,declarations:["IntroductoryExampleComponent","Box"],codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/introductory-example/introductory-example.component.ts"]}},{path:"controls-example",data:{title:"Controls Example",exampleComponent:Xb,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/controls-example/controls-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/controls-example/controls-example.component.ts"]}},{path:"loader-example",data:{title:"Loader Example",exampleComponent:U0,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/loader-example/loader-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/loader-example/loader-example.component.ts"]}},{path:"dynamic loader-example",data:{title:"Dynamic Loader Example",exampleComponent:Zb,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/dynamic-loader-example/dynamic-loader-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/dynamic-loader-example/dynamic-loader-example.component.ts"]}},{path:"events-example",data:{title:"Events Example",exampleComponent:$b,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/events-example/events-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/events-example/events-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/events-example/events-example.component.scss"]}},{path:"instanced-mesh-example",data:{title:"Instanced Mesh Example",exampleComponent:O0,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/instanced-mesh-example/instanced-mesh-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/instanced-mesh-example/instanced-mesh-example.component.ts"]}},{path:"post-processing-example",data:{title:"Post Processing Example",exampleComponent:$0,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/post-processing-example/post-processing-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/post-processing-example/post-processing-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/post-processing-example/post-processing-example.component.scss"]}},{path:"views-example",data:{title:"Multiple Views Example",exampleComponent:tv,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/views-example/views-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/views-example/views-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/views-example/views-example.component.scss"]}},{path:"multi-scene-example",data:{title:"Multiple Scenes Example",codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-scene-example/multi-scene-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-scene-example/multi-scene-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-scene-example/multi-scene-example.component.scss"],exampleComponent:V0}},{path:"multi-view-postprocessing-example",data:{title:"Multiple View Post Processing Example",exampleComponent:z0,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-view-postprocessing-example/multi-view-postprocessing-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-view-postprocessing-example/multi-view-postprocessing-example.component.ts"]}},{path:"animation-example",data:{title:"Animation Example",exampleComponent:qb,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/animation-example/animation-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/animation-example/animation-example.component.ts"]}},{path:"plyloader-example",data:{title:"PLY Loader Example",exampleComponent:K0,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/plyloader-example/plyloader-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/plyloader-example/plyloader-example.component.ts"]}},{path:"on-demand-example",data:{title:"On-Demand Rendering Example",exampleComponent:Y0,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/on-demand-example/on-demand-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/on-demand-example/on-demand-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/on-demand-example/on-demand-example.component.scss"]}},{path:"ref-by-id-example",data:{title:"Ref By Id Example",exampleComponent:J0,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/ref-by-id-example/ref-by-id-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/ref-by-id-example/ref-by-id-example.component.ts"]}},{path:"html-example",data:{title:"Html Content Example",exampleComponent:L0,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/html-example/html-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/html-example/html-example.component.ts"]}},{path:"outline-pass-events-example",data:{title:"Render Pass + Events Example",exampleComponent:Z0,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/outline-pass-events-example/outline-pass-events-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/outline-pass-events-example/outline-pass-events-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/outline-pass-events-example/outline-pass-events-example.component.scss"]}},{path:"multi-renderer-example",data:{title:"Multi Renderer Example: WebGL + CSS2D",exampleComponent:iv,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-renderer-example/multi-renderer-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-renderer-example/multi-renderer-example.component.ts"]}},{path:"css3d-renderer-example",data:{title:"CSS3D Renderer Example",exampleComponent:nv,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/css3d-renderer-example/css3d-renderer-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/css3d-renderer-example/css3d-renderer-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/css3d-renderer-example/css3d-renderer-example.component.scss"]}},{path:"html-with-css3d-example",data:{title:"Html with CSS3D Example",exampleComponent:rv,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/html-with-css3d-example/html-with-css3d-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/html-with-css3d-example/html-with-css3d-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/html-with-css3d-example/html-with-css3d-example.component.scss"]}}];qC.forEach(i=>i.component=_0);const kwe=[];qC.forEach(i=>{kwe.push(i.component)});class Rg{}Rg.\u0275fac=function(e){return new(e||Rg)},Rg.\u0275mod=li({type:Rg}),Rg.\u0275inj=si({imports:[fj.forRoot(qC),fj]});let Lwe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[xn,xn]}),i})();const B8=["*"],F8=["unscopedContent"],Fwe=["text"],Owe=[[["","matListItemAvatar",""],["","matListItemIcon",""]],[["","matListItemTitle",""]],[["","matListItemLine",""]],"*",[["","matListItemMeta",""]],[["mat-divider"]]],Nwe=["[matListItemAvatar],[matListItemIcon]","[matListItemTitle]","[matListItemLine]","*","[matListItemMeta]","mat-divider"],O8=new Oe("ListOption");let N8=(()=>{class i{constructor(t){this._elementRef=t}}return i.\u0275fac=function(t){return new(t||i)(I(Ft))},i.\u0275dir=Ne({type:i,selectors:[["","matListItemTitle",""]],hostAttrs:[1,"mat-mdc-list-item-title","mdc-list-item__primary-text"]}),i})(),j8=(()=>{class i{constructor(t){this._elementRef=t}}return i.\u0275fac=function(t){return new(t||i)(I(Ft))},i.\u0275dir=Ne({type:i,selectors:[["","matListItemLine",""]],hostAttrs:[1,"mat-mdc-list-item-line","mdc-list-item__secondary-text"]}),i})(),iCe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=Ne({type:i,selectors:[["","matListItemMeta",""]],hostAttrs:[1,"mat-mdc-list-item-meta","mdc-list-item__end"]}),i})(),U8=(()=>{class i{constructor(t){this._listOption=t}_isAlignedAtStart(){return!this._listOption||"after"===this._listOption?._getTogglePosition()}}return i.\u0275fac=function(t){return new(t||i)(I(O8,8))},i.\u0275dir=Ne({type:i,hostVars:4,hostBindings:function(t,n){2&t&&Ei("mdc-list-item__start",n._isAlignedAtStart())("mdc-list-item__end",!n._isAlignedAtStart())}}),i})(),nCe=(()=>{class i extends U8{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=le(i)))(n||i)}}(),i.\u0275dir=Ne({type:i,selectors:[["","matListItemAvatar",""]],hostAttrs:[1,"mat-mdc-list-item-avatar"],features:[q]}),i})(),rCe=(()=>{class i extends U8{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=le(i)))(n||i)}}(),i.\u0275dir=Ne({type:i,selectors:[["","matListItemIcon",""]],hostAttrs:[1,"mat-mdc-list-item-icon"],features:[q]}),i})();const sCe=new Oe("MAT_LIST_CONFIG");let Ig=(()=>{class i{constructor(){this._isNonInteractive=!0,this._disableRipple=!1,this._disabled=!1,this._defaultOptions=Et(sCe,{optional:!0})}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=Qi(t)}get disabled(){return this._disabled}set disabled(t){this._disabled=Qi(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=Ne({type:i,hostVars:1,hostBindings:function(t,n){2&t&&pn("aria-disabled",n.disabled)},inputs:{disableRipple:"disableRipple",disabled:"disabled"}}),i})(),b2=(()=>{class i{set lines(t){this._explicitLines=ms(t,null),this._updateItemLines(!1)}get disableRipple(){return this.disabled||this._disableRipple||this._noopAnimations||!!this._listBase?.disableRipple}set disableRipple(t){this._disableRipple=Qi(t)}get disabled(){return this._disabled||!!this._listBase?.disabled}set disabled(t){this._disabled=Qi(t)}get rippleDisabled(){return this.disableRipple||!!this.rippleConfig.disabled}constructor(t,n,r,s,o,a){this._elementRef=t,this._ngZone=n,this._listBase=r,this._platform=s,this._explicitLines=null,this._disableRipple=!1,this._disabled=!1,this._subscriptions=new un,this._rippleRenderer=null,this._hasUnscopedTextContent=!1,this.rippleConfig=o||{},this._hostElement=this._elementRef.nativeElement,this._noopAnimations="NoopAnimations"===a,r&&!r._isNonInteractive&&this._initInteractiveListItem(),"button"===this._hostElement.nodeName.toLowerCase()&&!this._hostElement.hasAttribute("type")&&this._hostElement.setAttribute("type","button")}ngAfterViewInit(){this._monitorProjectedLinesAndTitle(),this._updateItemLines(!0)}ngOnDestroy(){this._subscriptions.unsubscribe(),null!==this._rippleRenderer&&this._rippleRenderer._removeTriggerEvents()}_hasIconOrAvatar(){return!(!this._avatars.length&&!this._icons.length)}_initInteractiveListItem(){this._hostElement.classList.add("mat-mdc-list-item-interactive"),this._rippleRenderer=new Np(this,this._ngZone,this._hostElement,this._platform),this._rippleRenderer.setupTriggerEvents(this._hostElement)}_monitorProjectedLinesAndTitle(){this._ngZone.runOutsideAngular(()=>{this._subscriptions.add(bd(this._lines.changes,this._titles.changes).subscribe(()=>this._updateItemLines(!1)))})}_updateItemLines(t){if(!this._lines||!this._titles||!this._unscopedContent)return;t&&this._checkDomForUnscopedTextContent();const n=this._explicitLines??this._inferLinesFromContent(),r=this._unscopedContent.nativeElement;if(this._hostElement.classList.toggle("mat-mdc-list-item-single-line",n<=1),this._hostElement.classList.toggle("mdc-list-item--with-one-line",n<=1),this._hostElement.classList.toggle("mdc-list-item--with-two-lines",2===n),this._hostElement.classList.toggle("mdc-list-item--with-three-lines",3===n),this._hasUnscopedTextContent){const s=0===this._titles.length&&1===n;r.classList.toggle("mdc-list-item__primary-text",s),r.classList.toggle("mdc-list-item__secondary-text",!s)}else r.classList.remove("mdc-list-item__primary-text"),r.classList.remove("mdc-list-item__secondary-text")}_inferLinesFromContent(){let t=this._titles.length+this._lines.length;return this._hasUnscopedTextContent&&(t+=1),t}_checkDomForUnscopedTextContent(){this._hasUnscopedTextContent=Array.from(this._unscopedContent.nativeElement.childNodes).filter(t=>t.nodeType!==t.COMMENT_NODE).some(t=>!(!t.textContent||!t.textContent.trim()))}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(gt),I(Ig,8),I(Yn),I(ow,8),I(rs,8))},i.\u0275dir=Ne({type:i,contentQueries:function(t,n,r){if(1&t&&(Nn(r,nCe,4),Nn(r,rCe,4)),2&t){let s;Ot(s=Nt())&&(n._avatars=s),Ot(s=Nt())&&(n._icons=s)}},hostVars:3,hostBindings:function(t,n){2&t&&(pn("aria-disabled",n.disabled),Ei("mdc-list-item--disabled",n.disabled))},inputs:{lines:"lines",disableRipple:"disableRipple",disabled:"disabled"}}),i})(),oCe=(()=>{class i extends b2{get activated(){return this._activated}set activated(t){this._activated=Qi(t)}constructor(t,n,r,s,o,a){super(t,n,r,s,o,a),this._activated=!1}_getAriaCurrent(){return"A"===this._hostElement.nodeName&&this._activated?"page":null}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(gt),I(Ig,8),I(Yn),I(ow,8),I(rs,8))},i.\u0275cmp=$({type:i,selectors:[["mat-list-item"],["a","mat-list-item",""],["button","mat-list-item",""]],contentQueries:function(t,n,r){if(1&t&&(Nn(r,j8,5),Nn(r,N8,5),Nn(r,iCe,5)),2&t){let s;Ot(s=Nt())&&(n._lines=s),Ot(s=Nt())&&(n._titles=s),Ot(s=Nt())&&(n._meta=s)}},viewQuery:function(t,n){if(1&t&&(ji(F8,5),ji(Fwe,5)),2&t){let r;Ot(r=Nt())&&(n._unscopedContent=r.first),Ot(r=Nt())&&(n._itemText=r.first)}},hostAttrs:[1,"mat-mdc-list-item","mdc-list-item"],hostVars:11,hostBindings:function(t,n){2&t&&(pn("aria-current",n._getAriaCurrent()),Ei("mdc-list-item--activated",n.activated)("mdc-list-item--with-leading-avatar",0!==n._avatars.length)("mdc-list-item--with-leading-icon",0!==n._icons.length)("mdc-list-item--with-trailing-meta",0!==n._meta.length)("_mat-animation-noopable",n._noopAnimations))},inputs:{activated:"activated"},exportAs:["matListItem"],features:[q],ngContentSelectors:Nwe,decls:10,vars:0,consts:[[1,"mdc-list-item__content"],[1,"mat-mdc-list-item-unscoped-content",3,"cdkObserveContent"],["unscopedContent",""],[1,"mat-mdc-focus-indicator"]],template:function(t,n){1&t&&(he(Owe),ie(0),ge(1,"span",0),ie(2,1),ie(3,2),ge(4,"span",1,2),ut("cdkObserveContent",function(){return n._updateItemLines(!0)}),ie(6,3),Re()(),ie(7,4),ie(8,5),je(9,"div",3))},dependencies:[wI],encapsulation:2,changeDetection:0}),i})(),lCe=(()=>{class i extends Ig{constructor(){super(...arguments),this._isNonInteractive=!1}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=le(i)))(n||i)}}(),i.\u0275cmp=$({type:i,selectors:[["mat-nav-list"]],hostAttrs:["role","navigation",1,"mat-mdc-nav-list","mat-mdc-list-base","mdc-list"],exportAs:["matNavList"],features:[ne([{provide:Ig,useExisting:i}]),q],ngContentSelectors:B8,decls:1,vars:0,template:function(t,n){1&t&&(he(),ie(0))},styles:['.mdc-list-item--with-leading-avatar .mdc-list-item__start{width:40px;height:40px}.mdc-list-item--with-leading-icon .mdc-list-item__start{width:24px;height:24px}.mdc-list-item--with-leading-thumbnail .mdc-list-item__start{width:40px;height:40px}.mdc-list-item--with-leading-image .mdc-list-item__start{width:56px;height:56px}.mdc-list-item--with-leading-video .mdc-list-item__start{width:100px;height:56px}.mdc-list-item--with-leading-checkbox .mdc-list-item__start{width:40px;height:40px}.mdc-list-item--with-leading-radio .mdc-list-item__start{width:40px;height:40px}.mdc-list-item--with-leading-switch .mdc-list-item__start{width:36px;height:20px}.mdc-list-item--with-trailing-icon .mdc-list-item__end{width:24px;height:24px}.mdc-list-item--with-trailing-checkbox .mdc-list-item__end{width:40px;height:40px}.mdc-list-item--with-trailing-radio .mdc-list-item__end{width:40px;height:40px}.mdc-list-item--with-trailing-switch .mdc-list-item__end{width:36px;height:20px}.mdc-list-divider{height:1px}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-list-divider::after{content:"";display:block;border-bottom-width:1px;border-bottom-style:solid}}.mdc-list{margin:0;padding:8px 0;list-style-type:none}.mdc-list:focus{outline:none}.mdc-list-item__wrapper{display:block}.mdc-list-item{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;align-items:stretch;cursor:pointer}.mdc-list-item:focus{outline:none}.mdc-list-item.mdc-list-item--with-one-line{height:48px}.mdc-list-item.mdc-list-item--with-two-lines{height:64px}.mdc-list-item.mdc-list-item--with-three-lines{height:88px}.mdc-list-item.mdc-list-item--with-one-line .mdc-list-item__start{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--with-three-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--with-one-line .mdc-list-item__end{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-two-lines .mdc-list-item__end{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--disabled,.mdc-list-item.mdc-list-item--non-interactive{cursor:auto}.mdc-list-item:not(.mdc-list-item--selected):focus::before,.mdc-list-item.mdc-ripple-upgraded--background-focused::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-list-item:not(.mdc-list-item--selected):focus::before,.mdc-list-item.mdc-ripple-upgraded--background-focused::before{border-color:CanvasText}}.mdc-list-item.mdc-list-item--selected::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:3px double rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-list-item.mdc-list-item--selected::before{border-color:CanvasText}}.mdc-list-item.mdc-list-item--selected:focus::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:3px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-list-item.mdc-list-item--selected:focus::before{border-color:CanvasText}}a.mdc-list-item{color:inherit;text-decoration:none}.mdc-list-item__start{fill:currentColor;flex-shrink:0;pointer-events:none}.mdc-list-item__end{flex-shrink:0;pointer-events:none}.mdc-list-item__content{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;align-self:center;flex:1;pointer-events:none}.mdc-list-item--with-two-lines .mdc-list-item__content,.mdc-list-item--with-three-lines .mdc-list-item__content{align-self:stretch}.mdc-list-item__content[for]{pointer-events:none}.mdc-list-item__primary-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.mdc-list-item--with-two-lines .mdc-list-item__primary-text,.mdc-list-item--with-three-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before,.mdc-list-item--with-three-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after,.mdc-list-item--with-three-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item__secondary-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;margin-top:0;line-height:normal}.mdc-list-item__secondary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list-item--with-three-lines .mdc-list-item__secondary-text{white-space:normal;line-height:20px}.mdc-list-item--with-overline .mdc-list-item__secondary-text{white-space:nowrap;line-height:auto}.mdc-list-item__overline-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:24px;content:"";vertical-align:0}.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-three-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-three-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-three-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-avatar.mdc-list-item,.mdc-list-item--with-leading-avatar.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-avatar .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-avatar .mdc-list-item__start,.mdc-list-item--with-leading-avatar .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-avatar.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-avatar .mdc-list-item__start{border-radius:50%}.mdc-list-item--with-leading-icon.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-icon.mdc-list-item,.mdc-list-item--with-leading-icon.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-icon .mdc-list-item__start{margin-left:16px;margin-right:32px}[dir=rtl] .mdc-list-item--with-leading-icon .mdc-list-item__start,.mdc-list-item--with-leading-icon .mdc-list-item__start[dir=rtl]{margin-left:32px;margin-right:16px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-icon.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-thumbnail.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-thumbnail.mdc-list-item,.mdc-list-item--with-leading-thumbnail.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-thumbnail .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-thumbnail .mdc-list-item__start,.mdc-list-item--with-leading-thumbnail .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-image.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-image.mdc-list-item,.mdc-list-item--with-leading-image.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-image .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-image .mdc-list-item__start,.mdc-list-item--with-leading-image .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-image.mdc-list-item--with-one-line{height:72px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:8px}.mdc-list-item--with-leading-video.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-video.mdc-list-item,.mdc-list-item--with-leading-video.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-video .mdc-list-item__start{margin-left:0;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-video .mdc-list-item__start,.mdc-list-item--with-leading-video .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:0}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-video.mdc-list-item--with-one-line{height:72px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-checkbox.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-checkbox.mdc-list-item,.mdc-list-item--with-leading-checkbox.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-checkbox .mdc-list-item__start{margin-left:8px;margin-right:24px}[dir=rtl] .mdc-list-item--with-leading-checkbox .mdc-list-item__start,.mdc-list-item--with-leading-checkbox .mdc-list-item__start[dir=rtl]{margin-left:24px;margin-right:8px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:8px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-radio.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-radio.mdc-list-item,.mdc-list-item--with-leading-radio.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-radio .mdc-list-item__start{margin-left:8px;margin-right:24px}[dir=rtl] .mdc-list-item--with-leading-radio .mdc-list-item__start,.mdc-list-item--with-leading-radio .mdc-list-item__start[dir=rtl]{margin-left:24px;margin-right:8px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:8px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-switch.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-switch.mdc-list-item,.mdc-list-item--with-leading-switch.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-switch .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-switch .mdc-list-item__start,.mdc-list-item--with-leading-switch .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-switch.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-trailing-icon.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-icon.mdc-list-item,.mdc-list-item--with-trailing-icon.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-icon .mdc-list-item__end{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-trailing-icon .mdc-list-item__end,.mdc-list-item--with-trailing-icon .mdc-list-item__end[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end{align-self:flex-start;margin-top:0}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:0}.mdc-list-item--with-trailing-meta.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-meta.mdc-list-item,.mdc-list-item--with-trailing-meta.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-meta .mdc-list-item__end{margin-left:28px;margin-right:16px}[dir=rtl] .mdc-list-item--with-trailing-meta .mdc-list-item__end,.mdc-list-item--with-trailing-meta .mdc-list-item__end[dir=rtl]{margin-left:16px;margin-right:28px}.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-trailing-checkbox.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-checkbox.mdc-list-item,.mdc-list-item--with-trailing-checkbox.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-checkbox .mdc-list-item__end{margin-left:24px;margin-right:8px}[dir=rtl] .mdc-list-item--with-trailing-checkbox .mdc-list-item__end,.mdc-list-item--with-trailing-checkbox .mdc-list-item__end[dir=rtl]{margin-left:8px;margin-right:24px}.mdc-list-item--with-trailing-checkbox.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:8px}.mdc-list-item--with-trailing-radio.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-radio.mdc-list-item,.mdc-list-item--with-trailing-radio.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-radio .mdc-list-item__end{margin-left:24px;margin-right:8px}[dir=rtl] .mdc-list-item--with-trailing-radio .mdc-list-item__end,.mdc-list-item--with-trailing-radio .mdc-list-item__end[dir=rtl]{margin-left:8px;margin-right:24px}.mdc-list-item--with-trailing-radio.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:8px}.mdc-list-item--with-trailing-switch.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-switch.mdc-list-item,.mdc-list-item--with-trailing-switch.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-switch .mdc-list-item__end{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-trailing-switch .mdc-list-item__end,.mdc-list-item--with-trailing-switch .mdc-list-item__end[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-trailing-switch.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:16px}.mdc-list-item--with-overline.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-overline.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list-item--with-overline.mdc-list-item--with-three-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-overline.mdc-list-item--with-three-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list-item{padding-left:16px;padding-right:16px}[dir=rtl] .mdc-list-item,.mdc-list-item[dir=rtl]{padding-left:16px;padding-right:16px}.mdc-list-group .mdc-deprecated-list{padding:0}.mdc-list-group__subheader{margin:calc((3rem - 1.5rem)/2) 16px}.mdc-list-divider{padding:0;background-clip:content-box}.mdc-list-divider.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-text.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-icon.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-image.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-switch.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-radio.mdc-list-divider--with-leading-inset{padding-left:16px;padding-right:auto}[dir=rtl] .mdc-list-divider.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-text.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-icon.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-image.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-avatar.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-switch.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-radio.mdc-list-divider--with-leading-inset,.mdc-list-divider.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-text.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-icon.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-image.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-switch.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-radio.mdc-list-divider--with-leading-inset[dir=rtl]{padding-left:auto;padding-right:16px}.mdc-list-divider.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-text.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-icon.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-image.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-switch.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-radio.mdc-list-divider--with-trailing-inset{padding-left:auto;padding-right:16px}[dir=rtl] .mdc-list-divider.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-text.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-icon.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-image.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-avatar.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-switch.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-radio.mdc-list-divider--with-trailing-inset,.mdc-list-divider.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-text.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-icon.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-image.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-switch.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-radio.mdc-list-divider--with-trailing-inset[dir=rtl]{padding-left:16px;padding-right:auto}.mdc-list-divider--with-leading-video.mdc-list-divider--with-leading-inset{padding-left:0px;padding-right:auto}[dir=rtl] .mdc-list-divider--with-leading-video.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-video.mdc-list-divider--with-leading-inset[dir=rtl]{padding-left:auto;padding-right:0px}[dir=rtl] .mdc-list-divider,.mdc-list-divider[dir=rtl]{padding:0}.cdk-high-contrast-active a.mdc-list-item--activated::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active a.mdc-list-item--activated [dir=rtl]::after{right:auto;left:16px}.mat-mdc-list-base{display:block}.mat-mdc-list-base .mdc-list-item__start,.mat-mdc-list-base .mdc-list-item__end,.mat-mdc-list-base .mdc-list-item__content{pointer-events:auto}.mat-mdc-list-item,.mat-mdc-list-option{width:100%;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-list-item:not(.mat-mdc-list-item-interactive),.mat-mdc-list-option:not(.mat-mdc-list-item-interactive){cursor:default}.mat-mdc-list-item .mat-divider-inset,.mat-mdc-list-option .mat-divider-inset{position:absolute;left:0;right:0;bottom:0}.mat-mdc-list-item .mat-mdc-list-item-avatar~.mat-divider-inset,.mat-mdc-list-option .mat-mdc-list-item-avatar~.mat-divider-inset{margin-left:72px}[dir=rtl] .mat-mdc-list-item .mat-mdc-list-item-avatar~.mat-divider-inset,[dir=rtl] .mat-mdc-list-option .mat-mdc-list-item-avatar~.mat-divider-inset{margin-right:72px}.mat-mdc-list-item-interactive::before{top:0;left:0;right:0;bottom:0;position:absolute;content:"";opacity:0;pointer-events:none}.mat-mdc-list-item>.mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-list-item:focus>.mat-mdc-focus-indicator::before{content:""}.mat-mdc-list-item.mdc-list-item--with-three-lines .mat-mdc-list-item-line.mdc-list-item__secondary-text{white-space:nowrap;line-height:normal}.mat-mdc-list-item.mdc-list-item--with-three-lines .mat-mdc-list-item-unscoped-content.mdc-list-item__secondary-text{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}mat-action-list button{background:none;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:rgba(0,0,0,0);text-align:left}[dir=rtl] mat-action-list button{text-align:right}mat-action-list button::-moz-focus-inner{border:0}'],encapsulation:2,changeDetection:0}),i})(),v2=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[nw,Ta,xn,l0,HV,Lwe]}),i})();const hCe=["*",[["mat-toolbar-row"]]],fCe=["*","mat-toolbar-row"],pCe=sw(class{constructor(i){this._elementRef=i}});let mCe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=Ne({type:i,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),i})(),gCe=(()=>{class i extends pCe{constructor(t,n,r){super(t),this._platform=n,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(Yn),I(ti))},i.\u0275cmp=$({type:i,selectors:[["mat-toolbar"]],contentQueries:function(t,n,r){if(1&t&&Nn(r,mCe,5),2&t){let s;Ot(s=Nt())&&(n._toolbarRows=s)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(t,n){2&t&&Ei("mat-toolbar-multiple-rows",n._toolbarRows.length>0)("mat-toolbar-single-row",0===n._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[q],ngContentSelectors:fCe,decls:2,vars:0,template:function(t,n){1&t&&(he(hCe),ie(0),ie(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color: inherit;--mdc-outlined-button-label-text-color: inherit}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}"],encapsulation:2,changeDetection:0}),i})(),A2=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[xn,xn]}),i})();const YC=["*"],_Ce=["content"];function bCe(i,e){if(1&i){const t=ys();ge(0,"div",2),ut("click",function(){return nr(t),rr(di()._onBackdropClicked())}),Re()}2&i&&Ei("mat-drawer-shown",di()._isShowingBackdrop())}function vCe(i,e){1&i&&(ge(0,"mat-drawer-content"),ie(1,2),Re())}const ACe=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],yCe=["mat-drawer","mat-drawer-content","*"];function xCe(i,e){if(1&i){const t=ys();ge(0,"div",2),ut("click",function(){return nr(t),rr(di()._onBackdropClicked())}),Re()}2&i&&Ei("mat-drawer-shown",di()._isShowingBackdrop())}function wCe(i,e){1&i&&(ge(0,"mat-sidenav-content"),ie(1,2),Re())}const CCe=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],MCe=["mat-sidenav","mat-sidenav-content","*"],z8={transformDrawer:h0("transform",[ku("open, open-instant",Ls({transform:"none",visibility:"visible"})),ku("void",Ls({"box-shadow":"none",visibility:"hidden"})),Ul("void => open-instant",Pc("0ms")),Ul("void <=> open, open-instant => void",Pc("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},SCe=new Oe("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function TCe(){return!1}}),y2=new Oe("MAT_DRAWER_CONTAINER");let XC=(()=>{class i extends Bu{constructor(t,n,r,s,o){super(r,s,o),this._changeDetectorRef=t,this._container=n}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return i.\u0275fac=function(t){return new(t||i)(I(sr),I(ae(()=>H8)),I(Ft),I(Up),I(gt))},i.\u0275cmp=$({type:i,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(t,n){2&t&&Pd("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[ne([{provide:Bu,useExisting:i}]),q],ngContentSelectors:YC,decls:1,vars:0,template:function(t,n){1&t&&(he(),ie(0))},encapsulation:2,changeDetection:0}),i})(),G8=(()=>{class i{get position(){return this._position}set position(t){(t="end"===t?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(t),this._position=t,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(t){this._disableClose=Qi(t)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(t){("true"===t||"false"===t||null==t)&&(t=Qi(t)),this._autoFocus=t}get opened(){return this._opened}set opened(t){this.toggle(Qi(t))}constructor(t,n,r,s,o,a,l,c){this._elementRef=t,this._focusTrapFactory=n,this._focusMonitor=r,this._platform=s,this._ngZone=o,this._interactivityChecker=a,this._doc=l,this._container=c,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new Wt,this._animationEnd=new Wt,this._animationState="void",this.openedChange=new Tt(!0),this._openedStream=this.openedChange.pipe(jn(d=>d),wt(()=>{})),this.openedStart=this._animationStarted.pipe(jn(d=>d.fromState!==d.toState&&0===d.toState.indexOf("open")),DS(void 0)),this._closedStream=this.openedChange.pipe(jn(d=>!d),wt(()=>{})),this.closedStart=this._animationStarted.pipe(jn(d=>d.fromState!==d.toState&&"void"===d.toState),DS(void 0)),this._destroyed=new Wt,this.onPositionChanged=new Tt,this._modeChanged=new Wt,this.openedChange.subscribe(d=>{d?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{Dc(this._elementRef.nativeElement,"keydown").pipe(jn(d=>27===d.keyCode&&!this.disableClose&&!Jx(d)),yn(this._destroyed)).subscribe(d=>this._ngZone.run(()=>{this.close(),d.stopPropagation(),d.preventDefault()}))}),this._animationEnd.pipe(xI((d,u)=>d.fromState===u.fromState&&d.toState===u.toState)).subscribe(d=>{const{fromState:u,toState:h}=d;(0===h.indexOf("open")&&"void"===u||"void"===h&&0===u.indexOf("open"))&&this.openedChange.emit(this._opened)})}_forceFocus(t,n){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{t.removeEventListener("blur",r),t.removeEventListener("mousedown",r),t.removeAttribute("tabindex")};t.addEventListener("blur",r),t.addEventListener("mousedown",r)})),t.focus(n)}_focusByCssSelector(t,n){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,n)}_takeFocus(){if(!this._focusTrap)return;const t=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(n=>{!n&&"function"==typeof this._elementRef.nativeElement.focus&&t.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(t){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,t):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const t=this._doc.activeElement;return!!t&&this._elementRef.nativeElement.contains(t)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(t){return this.toggle(!0,t)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(t=!this.opened,n){t&&n&&(this._openedVia=n);const r=this._setOpen(t,!t&&this._isFocusWithinDrawer(),this._openedVia||"program");return t||(this._openedVia=null),r}_setOpen(t,n,r){return this._opened=t,t?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",n&&this._restoreFocus(r)),this._updateFocusTrapState(),new Promise(s=>{this.openedChange.pipe(bs(1)).subscribe(o=>s(o?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_updatePositionInParent(t){const n=this._elementRef.nativeElement,r=n.parentNode;"end"===t?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),r.insertBefore(this._anchor,n)),r.appendChild(n)):this._anchor&&this._anchor.parentNode.insertBefore(n,this._anchor)}}return i.\u0275fac=function(t){return new(t||i)(I(Ft),I(xhe),I(CI),I(Yn),I(gt),I(SV),I(ti,8),I(y2,8))},i.\u0275cmp=$({type:i,selectors:[["mat-drawer"]],viewQuery:function(t,n){if(1&t&&ji(_Ce,5),2&t){let r;Ot(r=Nt())&&(n._content=r.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(t,n){1&t&&pE("@transform.start",function(s){return n._animationStarted.next(s)})("@transform.done",function(s){return n._animationEnd.next(s)}),2&t&&(pn("align",null),AE("@transform",n._animationState),Ei("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:YC,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,n){1&t&&(he(),ge(0,"div",0,1),ie(2),Re())},dependencies:[Bu],encapsulation:2,data:{animation:[z8.transformDrawer]},changeDetection:0}),i})(),H8=(()=>{class i{get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(t){this._autosize=Qi(t)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(t){this._backdropOverride=null==t?null:Qi(t)}get scrollable(){return this._userContent||this._content}constructor(t,n,r,s,o,a=!1,l){this._dir=t,this._element=n,this._ngZone=r,this._changeDetectorRef=s,this._animationMode=l,this._drawers=new Ld,this.backdropClick=new Tt,this._destroyed=new Wt,this._doCheckSubject=new Wt,this._contentMargins={left:null,right:null},this._contentMarginChanges=new Wt,t&&t.change.pipe(yn(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),o.change().pipe(yn(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=a}ngAfterContentInit(){this._allDrawers.changes.pipe(sc(this._allDrawers),yn(this._destroyed)).subscribe(t=>{this._drawers.reset(t.filter(n=>!n._container||n._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(sc(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(t=>{this._watchDrawerToggle(t),this._watchDrawerPosition(t),this._watchDrawerMode(t)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(tw(10),yn(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(t=>t.open())}close(){this._drawers.forEach(t=>t.close())}updateContentMargins(){let t=0,n=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._getWidth();else if("push"==this._left.mode){const r=this._left._getWidth();t+=r,n-=r}if(this._right&&this._right.opened)if("side"==this._right.mode)n+=this._right._getWidth();else if("push"==this._right.mode){const r=this._right._getWidth();n+=r,t-=r}t=t||null,n=n||null,(t!==this._contentMargins.left||n!==this._contentMargins.right)&&(this._contentMargins={left:t,right:n},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(t){t._animationStarted.pipe(jn(n=>n.fromState!==n.toState),yn(this._drawers.changes)).subscribe(n=>{"open-instant"!==n.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==t.mode&&t.openedChange.pipe(yn(this._drawers.changes)).subscribe(()=>this._setContainerClass(t.opened))}_watchDrawerPosition(t){t&&t.onPositionChanged.pipe(yn(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(bs(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(t){t&&t._modeChanged.pipe(yn(bd(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(t){const n=this._element.nativeElement.classList,r="mat-drawer-container-has-open";t?n.add(r):n.remove(r)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(t=>{"end"==t.position?this._end=t:this._start=t}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(t=>t&&!t.disableClose&&this._canHaveBackdrop(t)).forEach(t=>t._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(t){return"side"!==t.mode||!!this._backdropOverride}_isDrawerOpen(t){return null!=t&&t.opened}}return i.\u0275fac=function(t){return new(t||i)(I(Wa,8),I(Ft),I(gt),I(sr),I(Lu),I(SCe),I(rs,8))},i.\u0275cmp=$({type:i,selectors:[["mat-drawer-container"]],contentQueries:function(t,n,r){if(1&t&&(Nn(r,XC,5),Nn(r,G8,5)),2&t){let s;Ot(s=Nt())&&(n._content=s.first),Ot(s=Nt())&&(n._allDrawers=s)}},viewQuery:function(t,n){if(1&t&&ji(XC,5),2&t){let r;Ot(r=Nt())&&(n._userContent=r.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,n){2&t&&Ei("mat-drawer-container-explicit-backdrop",n._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[ne([{provide:y2,useExisting:i}])],ngContentSelectors:yCe,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,n){1&t&&(he(ACe),Bt(0,bCe,1,2,"div",0),ie(1),ie(2,1),Bt(3,vCe,2,0,"mat-drawer-content",1)),2&t&&(W("ngIf",n.hasBackdrop),K(3),W("ngIf",!n._content))},dependencies:[nc,XC],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),i})(),x2=(()=>{class i extends XC{constructor(t,n,r,s,o){super(t,n,r,s,o)}}return i.\u0275fac=function(t){return new(t||i)(I(sr),I(ae(()=>W8)),I(Ft),I(Up),I(gt))},i.\u0275cmp=$({type:i,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(t,n){2&t&&Pd("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[ne([{provide:Bu,useExisting:i}]),q],ngContentSelectors:YC,decls:1,vars:0,template:function(t,n){1&t&&(he(),ie(0))},encapsulation:2,changeDetection:0}),i})(),Q8=(()=>{class i extends G8{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(t){this._fixedInViewport=Qi(t)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(t){this._fixedTopGap=ms(t)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(t){this._fixedBottomGap=ms(t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=le(i)))(n||i)}}(),i.\u0275cmp=$({type:i,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(t,n){2&t&&(pn("align",null),Pd("top",n.fixedInViewport?n.fixedTopGap:null,"px")("bottom",n.fixedInViewport?n.fixedBottomGap:null,"px"),Ei("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened)("mat-sidenav-fixed",n.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[q],ngContentSelectors:YC,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,n){1&t&&(he(),ge(0,"div",0,1),ie(2),Re())},dependencies:[Bu],encapsulation:2,data:{animation:[z8.transformDrawer]},changeDetection:0}),i})(),W8=(()=>{class i extends H8{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=le(i)))(n||i)}}(),i.\u0275cmp=$({type:i,selectors:[["mat-sidenav-container"]],contentQueries:function(t,n,r){if(1&t&&(Nn(r,x2,5),Nn(r,Q8,5)),2&t){let s;Ot(s=Nt())&&(n._content=s.first),Ot(s=Nt())&&(n._allDrawers=s)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(t,n){2&t&&Ei("mat-drawer-container-explicit-backdrop",n._backdropOverride)},exportAs:["matSidenavContainer"],features:[ne([{provide:y2,useExisting:i}]),q],ngContentSelectors:MCe,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,n){1&t&&(he(CCe),Bt(0,xCe,1,2,"div",0),ie(1),ie(2,1),Bt(3,wCe,2,0,"mat-sidenav-content",1)),2&t&&(W("ngIf",n.hasBackdrop),K(3),W("ngIf",!n._content))},dependencies:[nc,x2],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),i})(),RCe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[Ta,xn,m0,m0,xn]}),i})();function ICe(i,e){if(1&i&&(ge(0,"a",10),bi(1),Re()),2&i){const t=e.$implicit;W("routerLink",t.path),K(1),pA(t.data.title)}}function DCe(i,e){if(1&i){const t=ys();ge(0,"button",11),ut("click",function(){return nr(t),di(),rr(qt(2).toggle())}),ge(1,"mat-icon",12),bi(2,"menu"),Re()()}}function PCe(i,e){if(1&i){const t=ys();ge(0,"button",13),ut("click",function(r){return nr(t),rr(di().editorService.toCodeSandbox(r))}),ge(1,"mat-icon"),bi(2,"crop_din"),Re(),bi(3," CodeSandbox "),Re()}}function kCe(i,e){if(1&i){const t=ys();ge(0,"button",13),ut("click",function(r){return nr(t),rr(di().editorService.toStackblitz(r))}),ge(1,"mat-icon"),bi(2,"bolt"),Re(),bi(3," Stackblitz "),Re()}}class sv{constructor(e,t){this.breakpointObserver=e,this.editorService=t,this.routes=qC,this.isHandset$=this.breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)").pipe(wt(n=>n.matches),function Bwe(i,e,t){let n,r=!1;return i&&"object"==typeof i?({bufferSize:n=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=i):n=i??1/0,SM({connector:()=>new $R(n,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}())}}sv.\u0275fac=function(e){return new(e||sv)(I(xV),I(Kx))},sv.\u0275cmp=$({type:sv,selectors:[["app-navigation-shell"]],decls:21,vars:15,consts:[[1,"sidenav-container"],["fixedInViewport","",1,"sidenav",3,"mode","opened"],["drawer",""],["mat-list-item","",3,"routerLink",4,"ngFor","ngForOf"],[1,"content"],["color","primary"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click",4,"ngIf"],[1,"toolbar-spacer"],["mat-button","","href","#",3,"click",4,"ngIf"],[1,"main-route-content"],["mat-list-item","",3,"routerLink"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click"],["aria-label","Side nav toggle icon"],["mat-button","","href","#",3,"click"]],template:function(e,t){1&e&&(ge(0,"mat-sidenav-container",0)(1,"mat-sidenav",1,2),On(3,"async"),On(4,"async"),On(5,"async"),ge(6,"mat-toolbar"),bi(7,"ngx-three"),Re(),ge(8,"mat-nav-list"),Bt(9,ICe,2,2,"a",3),Re()(),ge(10,"mat-sidenav-content",4)(11,"mat-toolbar",5),Bt(12,DCe,3,0,"button",6),On(13,"async"),ge(14,"span"),bi(15,"ngx-three-demo"),Re(),je(16,"span",7),Bt(17,PCe,4,0,"button",8),Bt(18,kCe,4,0,"button",8),Re(),ge(19,"div",9),je(20,"router-outlet"),Re()()()),2&e&&(K(1),W("mode",Zn(4,9,t.isHandset$)?"over":"side")("opened",!1===Zn(5,11,t.isHandset$)),pn("role",Zn(3,7,t.isHandset$)?"dialog":"navigation"),K(8),W("ngForOf",t.routes),K(3),W("ngIf",Zn(13,13,t.isHandset$)),K(5),W("ngIf",t.editorService.urls.length),K(1),W("ngIf",t.editorService.urls.length))},dependencies:[yl,nc,QS,_y,qV,Khe,lCe,oCe,mz,gCe,Q8,W8,x2,mS],styles:[".sidenav-container[_ngcontent-%COMP%]{height:100%}.sidenav[_ngcontent-%COMP%]{width:200px}.sidenav[_ngcontent-%COMP%]   .mat-toolbar[_ngcontent-%COMP%]{background:inherit}.mat-toolbar.mat-primary[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1}.content[_ngcontent-%COMP%]{height:100vh}.main-route-content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:last-child{display:block;height:100%}.toolbar-spacer[_ngcontent-%COMP%]{flex:1 1 auto}"],changeDetection:0});class ov{constructor(){this.title="ngx-three-demo"}}ov.\u0275fac=function(e){return new(e||ov)},ov.\u0275cmp=$({type:ov,selectors:[["app-root"]],decls:1,vars:0,template:function(e,t){1&e&&je(0,"app-navigation-shell")},dependencies:[sv]});const q8=gV();class BCe{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=cr(-this._previousScrollPosition.left),e.style.top=cr(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,n=e.style,r=this._document.body.style,s=n.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,n.left=this._previousHTMLStyles.left,n.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),q8&&(n.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),q8&&(n.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,n=this._viewportRuler.getViewportSize();return t.scrollHeight>n.height||t.scrollWidth>n.width}}class LCe{constructor(e,t,n,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=n,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class Y8{enable(){}disable(){}attach(){}}function w2(i,e){return e.some(t=>i.bottom<t.top||i.top>t.bottom||i.right<t.left||i.left>t.right)}function X8(i,e){return e.some(t=>i.top<t.top||i.bottom>t.bottom||i.left<t.left||i.right>t.right)}class FCe{constructor(e,t,n,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=n,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:n,height:r}=this._viewportRuler.getViewportSize();w2(t,[{width:n,height:r,bottom:r,right:n,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let OCe=(()=>{class i{constructor(t,n,r,s){this._scrollDispatcher=t,this._viewportRuler=n,this._ngZone=r,this.noop=()=>new Y8,this.close=o=>new LCe(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new BCe(this._viewportRuler,this._document),this.reposition=o=>new FCe(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}}return i.\u0275fac=function(t){return new(t||i)(xe(Up),xe(Lu),xe(gt),xe(ti))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class NCe{constructor(e){if(this.scrollStrategy=new Y8,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const n of t)void 0!==e[n]&&(this[n]=e[n])}}}class jCe{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let Z8=(()=>{class i{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const n=this._attachedOverlays.indexOf(t);n>-1&&this._attachedOverlays.splice(n,1),0===this._attachedOverlays.length&&this.detach()}}return i.\u0275fac=function(t){return new(t||i)(xe(ti))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),UCe=(()=>{class i extends Z8{constructor(t,n){super(t),this._ngZone=n,this._keydownListener=r=>{const s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){const a=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>a.next(r)):a.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return i.\u0275fac=function(t){return new(t||i)(xe(ti),xe(gt,8))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),VCe=(()=>{class i extends Z8{constructor(t,n,r){super(t),this._platform=n,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=Ic(s)},this._clickListener=s=>{const o=Ic(s),a="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;const l=this._attachedOverlays.slice();for(let c=l.length-1;c>-1;c--){const d=l[c];if(d._outsidePointerEvents.observers.length<1||!d.hasAttached())continue;if(d.overlayElement.contains(o)||d.overlayElement.contains(a))break;const u=d._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>u.next(s)):u.next(s)}}}add(t){if(super.add(t),!this._isAttached){const n=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(n)):this._addEventListeners(n),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=n.style.cursor,n.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}}return i.\u0275fac=function(t){return new(t||i)(xe(ti),xe(Yn),xe(gt,8))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),K8=(()=>{class i{constructor(t,n){this._platform=n,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||_I()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const n=this._document.createElement("div");n.classList.add(t),_I()?n.setAttribute("platform","test"):this._platform.isBrowser||n.setAttribute("platform","server"),this._document.body.appendChild(n),this._containerElement=n}}return i.\u0275fac=function(t){return new(t||i)(xe(ti),xe(Yn))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class zCe{constructor(e,t,n,r,s,o,a,l,c,d=!1){this._portalOutlet=e,this._host=t,this._pane=n,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=l,this._outsideClickDispatcher=c,this._animationsDisabled=d,this._backdropElement=null,this._backdropClick=new Wt,this._attachments=new Wt,this._detachments=new Wt,this._locationChanges=un.EMPTY,this._backdropClickHandler=u=>this._backdropClick.next(u),this._backdropTransitionendHandler=u=>{this._disposeBackdrop(u.target)},this._keydownEvents=new Wt,this._outsidePointerEvents=new Wt,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(bs(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=cr(this._config.width),e.height=cr(this._config.height),e.minWidth=cr(this._config.minWidth),e.minHeight=cr(this._config.minHeight),e.maxWidth=cr(this._config.maxWidth),e.maxHeight=cr(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,n){const r=iw(t||[]).filter(s=>!!s);r.length&&(n?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(yn(bd(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const $8="cdk-overlay-connected-position-bounding-box",GCe=/([A-Za-z%]+)$/;class HCe{get positions(){return this._preferredPositions}constructor(e,t,n,r,s){this._viewportRuler=t,this._document=n,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Wt,this._resizeSubscription=un.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._validatePositions(),e.hostElement.classList.add($8),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,n=this._viewportRect,r=this._containerRect,s=[];let o;for(let a of this._preferredPositions){let l=this._getOriginPoint(e,r,a),c=this._getOverlayPoint(l,t,a),d=this._getOverlayFit(c,t,n,a);if(d.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(a,l);this._canFitWithFlexibleDimensions(d,c,n)?s.push({position:a,origin:l,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(l,a)}):(!o||o.overlayFit.visibleArea<d.visibleArea)&&(o={overlayFit:d,overlayPoint:c,originPoint:l,position:a,overlayRect:t})}if(s.length){let a=null,l=-1;for(const c of s){const d=c.boundingBoxRect.width*c.boundingBoxRect.height*(c.position.weight||1);d>l&&(l=d,a=c)}return this._isPushed=!1,void this._applyPosition(a.position,a.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&_h(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove($8),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,n){let r,s;if("center"==n.originX)r=e.left+e.width/2;else{const o=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;r="start"==n.originX?o:a}return t.left<0&&(r-=t.left),s="center"==n.originY?e.top+e.height/2:"top"==n.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,n){let r,s;return r="center"==n.overlayX?-t.width/2:"start"===n.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==n.overlayY?-t.height/2:"top"==n.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,n,r){const s=eQ(t);let{x:o,y:a}=e,l=this._getOffset(r,"x"),c=this._getOffset(r,"y");l&&(o+=l),c&&(a+=c);let h=0-a,f=a+s.height-n.height,m=this._subtractOverflows(s.width,0-o,o+s.width-n.width),_=this._subtractOverflows(s.height,h,f),g=m*_;return{visibleArea:g,isCompletelyWithinViewport:s.width*s.height===g,fitsInViewportVertically:_===s.height,fitsInViewportHorizontally:m==s.width}}_canFitWithFlexibleDimensions(e,t,n){if(this._hasFlexibleDimensions){const r=n.bottom-t.y,s=n.right-t.x,o=J8(this._overlayRef.getConfig().minHeight),a=J8(this._overlayRef.getConfig().minWidth);return(e.fitsInViewportVertically||null!=o&&o<=r)&&(e.fitsInViewportHorizontally||null!=a&&a<=s)}return!1}_pushOverlayOnScreen(e,t,n){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=eQ(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),a=Math.max(e.y+r.height-s.height,0),l=Math.max(s.top-n.top-e.y,0),c=Math.max(s.left-n.left-e.x,0);let d=0,u=0;return d=r.width<=s.width?c||-o:e.x<this._viewportMargin?s.left-n.left-e.x:0,u=r.height<=s.height?l||-a:e.y<this._viewportMargin?s.top-n.top-e.y:0,this._previousPushAmount={x:d,y:u},{x:e.x+d,y:e.y+u}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const n=this._getScrollVisibility(),r=new jCe(e,n);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let n,r=e.overlayY;n="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${n} ${r}`}_calculateBoundingBoxRect(e,t){const n=this._viewportRect,r=this._isRtl();let s,o,a,d,u,h;if("top"===t.overlayY)o=e.y,s=n.height-o+this._viewportMargin;else if("bottom"===t.overlayY)a=n.height-e.y+2*this._viewportMargin,s=n.height-a+this._viewportMargin;else{const f=Math.min(n.bottom-e.y+n.top,e.y),m=this._lastBoundingBoxSize.height;s=2*f,o=e.y-f,s>m&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-m/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)h=n.width-e.x+this._viewportMargin,d=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)u=e.x,d=n.right-e.x;else{const f=Math.min(n.right-e.x+n.left,e.x),m=this._lastBoundingBoxSize.width;d=2*f,u=e.x-f,d>m&&!this._isInitialRender&&!this._growAfterOpen&&(u=e.x-m/2)}return{top:o,left:u,bottom:a,right:h,width:d,height:s}}_setBoundingBoxStyles(e,t){const n=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=cr(n.height),r.top=cr(n.top),r.bottom=cr(n.bottom),r.width=cr(n.width),r.left=cr(n.left),r.right=cr(n.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=cr(s)),o&&(r.maxWidth=cr(o))}this._lastBoundingBoxSize=n,_h(this._boundingBox.style,r)}_resetBoundingBoxStyles(){_h(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){_h(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const n={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const d=this._viewportRuler.getViewportScrollPosition();_h(n,this._getExactOverlayY(t,e,d)),_h(n,this._getExactOverlayX(t,e,d))}else n.position="static";let a="",l=this._getOffset(t,"x"),c=this._getOffset(t,"y");l&&(a+=`translateX(${l}px) `),c&&(a+=`translateY(${c}px)`),n.transform=a.trim(),o.maxHeight&&(r?n.maxHeight=cr(o.maxHeight):s&&(n.maxHeight="")),o.maxWidth&&(r?n.maxWidth=cr(o.maxWidth):s&&(n.maxWidth="")),_h(this._pane.style,n)}_getExactOverlayY(e,t,n){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,n)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=cr(s.y),r}_getExactOverlayX(e,t,n){let o,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,n)),o=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===o?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=cr(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),n=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:X8(e,n),isOriginOutsideView:w2(e,n),isOverlayClipped:X8(t,n),isOverlayOutsideView:w2(t,n)}}_subtractOverflows(e,...t){return t.reduce((n,r)=>n-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+e-this._viewportMargin,bottom:n.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&iw(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof Ft)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,n=e.height||0;return{top:e.y,bottom:e.y+n,left:e.x,right:e.x+t,height:n,width:t}}}function _h(i,e){for(let t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}function J8(i){if("number"!=typeof i&&null!=i){const[e,t]=i.split(GCe);return t&&"px"!==t?null:parseFloat(e)}return i||null}function eQ(i){return{top:Math.floor(i.top),right:Math.floor(i.right),bottom:Math.floor(i.bottom),left:Math.floor(i.left),width:Math.floor(i.width),height:Math.floor(i.height)}}const tQ="cdk-global-overlay-wrapper";class QCe{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(tQ),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:a}=n,l=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),c=!("100%"!==s&&"100vh"!==s||a&&"100%"!==a&&"100vh"!==a),d=this._xPosition,u=this._xOffset,h="rtl"===this._overlayRef.getConfig().direction;let f="",m="",_="";l?_="flex-start":"center"===d?(_="center",h?m=u:f=u):h?"left"===d||"end"===d?(_="flex-end",f=u):("right"===d||"start"===d)&&(_="flex-start",m=u):"left"===d||"start"===d?(_="flex-start",f=u):("right"===d||"end"===d)&&(_="flex-end",m=u),e.position=this._cssPosition,e.marginLeft=l?"0":f,e.marginTop=c?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=l?"0":m,t.justifyContent=_,t.alignItems=c?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,n=t.style;t.classList.remove(tQ),n.justifyContent=n.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let WCe=(()=>{class i{constructor(t,n,r,s){this._viewportRuler=t,this._document=n,this._platform=r,this._overlayContainer=s}global(){return new QCe}flexibleConnectedTo(t){return new HCe(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return i.\u0275fac=function(t){return new(t||i)(xe(Lu),xe(ti),xe(Yn),xe(K8))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),qCe=0,C2=(()=>{class i{constructor(t,n,r,s,o,a,l,c,d,u,h,f){this.scrollStrategies=t,this._overlayContainer=n,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=a,this._ngZone=l,this._document=c,this._directionality=d,this._location=u,this._outsideClickDispatcher=h,this._animationsModuleType=f}create(t){const n=this._createHostElement(),r=this._createPaneElement(n),s=this._createPortalOutlet(r),o=new NCe(t);return o.direction=o.direction||this._directionality.value,new zCe(s,n,r,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const n=this._document.createElement("div");return n.id="cdk-overlay-"+qCe++,n.classList.add("cdk-overlay-pane"),t.appendChild(n),n}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(uf)),new Zfe(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return i.\u0275fac=function(t){return new(t||i)(xe(OCe),xe(K8),xe(Jl),xe(WCe),xe(UCe),xe(zr),xe(gt),xe(ti),xe(Wa),xe(IA),xe(VCe),xe(rs,8))},i.\u0275prov=He({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const ZCe={provide:new Oe("cdk-connected-overlay-scroll-strategy"),deps:[C2],useFactory:function XCe(i){return()=>i.scrollStrategies.reposition()}};let KCe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({providers:[C2,ZCe],imports:[s0,yz,Iz,Iz]}),i})(),rMe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[xn,Ta,nw,xn]}),i})();const cMe={provide:new Oe("mat-select-scroll-strategy"),deps:[C2],useFactory:function lMe(i){return()=>i.scrollStrategies.reposition()}};let iQ=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({providers:[cMe],imports:[Ta,KCe,QV,xn,m0,rMe,QV,xn]}),i})(),sQ=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({imports:[xn,Ta,l0]}),i})();const bMe=[SI,v2,kI,vz,A2,iQ,Vz,sQ];class Dg{}function oQ(i){return new Pe(3e3,!1)}function JMe(){return typeof window<"u"&&typeof window.document<"u"}function M2(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function fd(i){switch(i.length){case 0:return new f0;case 1:return i[0];default:return new Sz(i)}}function aQ(i,e,t,n,r=new Map,s=new Map){const o=[],a=[];let l=-1,c=null;if(n.forEach(d=>{const u=d.get("offset"),h=u==l,f=h&&c||new Map;d.forEach((m,_)=>{let g=_,p=m;if("offset"!==_)switch(g=e.normalizePropertyName(g,o),p){case"!":p=r.get(_);break;case jl:p=s.get(_);break;default:p=e.normalizeStyleValue(_,g,p,o)}f.set(g,p)}),h||a.push(f),c=f,l=u}),o.length)throw function VMe(i){return new Pe(3502,!1)}();return a}function E2(i,e,t,n){switch(e){case"start":i.onStart(()=>n(t&&S2(t,"start",i)));break;case"done":i.onDone(()=>n(t&&S2(t,"done",i)));break;case"destroy":i.onDestroy(()=>n(t&&S2(t,"destroy",i)))}}function S2(i,e,t){const s=T2(i.element,i.triggerName,i.fromState,i.toState,e||i.phaseName,t.totalTime??i.totalTime,!!t.disabled),o=i._data;return null!=o&&(s._data=o),s}function T2(i,e,t,n,r="",s=0,o){return{element:i,triggerName:e,fromState:t,toState:n,phaseName:r,totalTime:s,disabled:!!o}}function po(i,e,t){let n=i.get(e);return n||i.set(e,n=t),n}function lQ(i){const e=i.indexOf(":");return[i.substring(1,e),i.slice(e+1)]}Dg.\u0275fac=function(e){return new(e||Dg)},Dg.\u0275mod=li({type:Dg}),Dg.\u0275inj=si({imports:[bMe,SI,v2,kI,vz,A2,iQ,Vz,sQ]});let R2=(i,e)=>!1,cQ=(i,e,t)=>[],dQ=null;function I2(i){const e=i.parentNode||i.host;return e===dQ?null:e}(M2()||typeof Element<"u")&&(JMe()?(dQ=(()=>document.documentElement)(),R2=(i,e)=>{for(;e;){if(e===i)return!0;e=I2(e)}return!1}):R2=(i,e)=>i.contains(e),cQ=(i,e,t)=>{if(t)return Array.from(i.querySelectorAll(e));const n=i.querySelector(e);return n?[n]:[]});let bh=null,uQ=!1;const hQ=R2,fQ=cQ;let pQ=(()=>{class i{validateStyleProperty(t){return function t1e(i){bh||(bh=function i1e(){return typeof document<"u"?document.body:null}()||{},uQ=!!bh.style&&"WebkitAppearance"in bh.style);let e=!0;return bh.style&&!function e1e(i){return"ebkit"==i.substring(1,6)}(i)&&(e=i in bh.style,!e&&uQ&&(e="Webkit"+i.charAt(0).toUpperCase()+i.slice(1)in bh.style)),e}(t)}matchesElement(t,n){return!1}containsElement(t,n){return hQ(t,n)}getParentElement(t){return I2(t)}query(t,n,r){return fQ(t,n,r)}computeStyle(t,n,r){return r||""}animate(t,n,r,s,o,a=[],l){return new f0(r,s)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})(),D2=(()=>{class i{}return i.NOOP=new pQ,i})();const P2="ng-enter",ZC="ng-leave",KC="ng-trigger",$C=".ng-trigger",gQ="ng-animating",k2=".ng-animating";function ql(i){if("number"==typeof i)return i;const e=i.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:B2(parseFloat(e[1]),e[2])}function B2(i,e){return"s"===e?1e3*i:i}function JC(i,e,t){return i.hasOwnProperty("duration")?i:function s1e(i,e,t){let r,s=0,o="";if("string"==typeof i){const a=i.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(oQ()),{duration:0,delay:0,easing:""};r=B2(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=B2(parseFloat(l),a[4]));const c=a[5];c&&(o=c)}else r=i;if(!t){let a=!1,l=e.length;r<0&&(e.push(function vMe(){return new Pe(3100,!1)}()),a=!0),s<0&&(e.push(function AMe(){return new Pe(3101,!1)}()),a=!0),a&&e.splice(l,0,oQ())}return{duration:r,delay:s,easing:o}}(i,e,t)}function av(i,e={}){return Object.keys(i).forEach(t=>{e[t]=i[t]}),e}function _Q(i){const e=new Map;return Object.keys(i).forEach(t=>{e.set(t,i[t])}),e}function pd(i,e=new Map,t){if(t)for(let[n,r]of t)e.set(n,r);for(let[n,r]of i)e.set(n,r);return e}function vQ(i,e,t){return t?e+":"+t+";":""}function AQ(i){let e="";for(let t=0;t<i.style.length;t++){const n=i.style.item(t);e+=vQ(0,n,i.style.getPropertyValue(n))}for(const t in i.style)i.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=vQ(0,c1e(t),i.style[t]));i.setAttribute("style",e)}function nl(i,e,t){i.style&&(e.forEach((n,r)=>{const s=F2(r);t&&!t.has(r)&&t.set(r,i.style[s]),i.style[s]=n}),M2()&&AQ(i))}function vh(i,e){i.style&&(e.forEach((t,n)=>{const r=F2(n);i.style[r]=""}),M2()&&AQ(i))}function lv(i){return Array.isArray(i)?1==i.length?i[0]:Mz(i):i}const L2=new RegExp("{{\\s*(.+?)\\s*}}","g");function yQ(i){let e=[];if("string"==typeof i){let t;for(;t=L2.exec(i);)e.push(t[1]);L2.lastIndex=0}return e}function cv(i,e,t){const n=i.toString(),r=n.replace(L2,(s,o)=>{let a=e[o];return null==a&&(t.push(function xMe(i){return new Pe(3003,!1)}()),a=""),a.toString()});return r==n?i:r}function eM(i){const e=[];let t=i.next();for(;!t.done;)e.push(t.value),t=i.next();return e}const l1e=/-+([a-z0-9])/g;function F2(i){return i.replace(l1e,(...e)=>e[1].toUpperCase())}function c1e(i){return i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function mo(i,e,t){switch(e.type){case 7:return i.visitTrigger(e,t);case 0:return i.visitState(e,t);case 1:return i.visitTransition(e,t);case 2:return i.visitSequence(e,t);case 3:return i.visitGroup(e,t);case 4:return i.visitAnimate(e,t);case 5:return i.visitKeyframes(e,t);case 6:return i.visitStyle(e,t);case 8:return i.visitReference(e,t);case 9:return i.visitAnimateChild(e,t);case 10:return i.visitAnimateRef(e,t);case 11:return i.visitQuery(e,t);case 12:return i.visitStagger(e,t);default:throw function wMe(i){return new Pe(3004,!1)}()}}function xQ(i,e){return window.getComputedStyle(i)[e]}function m1e(i,e){const t=[];return"string"==typeof i?i.split(/\s*,\s*/).forEach(n=>function g1e(i,e,t){if(":"==i[0]){const l=function _1e(i,e){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function OMe(i){return new Pe(3016,!1)}()),"* => *"}}(i,t);if("function"==typeof l)return void e.push(l);i=l}const n=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function FMe(i){return new Pe(3015,!1)}()),e;const r=n[1],s=n[2],o=n[3];e.push(wQ(r,o));"<"==s[0]&&!("*"==r&&"*"==o)&&e.push(wQ(o,r))}(n,t,e)):t.push(i),t}const rM=new Set(["true","1"]),sM=new Set(["false","0"]);function wQ(i,e){const t=rM.has(i)||sM.has(i),n=rM.has(e)||sM.has(e);return(r,s)=>{let o="*"==i||i==r,a="*"==e||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?rM.has(i):sM.has(i)),!a&&n&&"boolean"==typeof s&&(a=s?rM.has(e):sM.has(e)),o&&a}}const b1e=new RegExp("s*:selfs*,?","g");function O2(i,e,t,n){return new v1e(i).build(e,t,n)}class v1e{constructor(e){this._driver=e}build(e,t,n){const r=new x1e(t);return this._resetContextStyleTimingState(r),mo(this,lv(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function MMe(){return new Pe(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(d=>{l.name=d,s.push(this.visitState(l,t))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,t);n+=l.queryCount,r+=l.depCount,o.push(l)}else t.errors.push(function EMe(){return new Pe(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:n,depCount:r,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){const s=new Set,o=r||{};n.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{yQ(l).forEach(c=>{o.hasOwnProperty(c)||s.add(c)})})}),s.size&&(eM(s.values()),t.errors.push(function SMe(i,e){return new Pe(3008,!1)}()))}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=mo(this,lv(e.animation),t);return{type:1,matchers:m1e(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:Ah(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>mo(this,n,t)),options:Ah(e.options)}}visitGroup(e,t){const n=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=n;const a=mo(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:3,steps:s,options:Ah(e.options)}}visitAnimate(e,t){const n=function C1e(i,e){if(i.hasOwnProperty("duration"))return i;if("number"==typeof i)return N2(JC(i,e).duration,0,"");const t=i;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=N2(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=JC(t,e);return N2(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let r,s=e.styles?e.styles:Ls({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const c={};n.easing&&(c.easing=n.easing),o=Ls(c)}t.currentTime+=n.duration+n.delay;const l=this.visitStyle(o,t);l.isEmptyStep=a,r=l}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of r)"string"==typeof a?a===jl?n.push(a):t.errors.push(new Pe(3002,!1)):n.push(_Q(a));let s=!1,o=null;return n.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let l of a.values())if(l.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:n,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;n&&s>0&&(s-=n.duration+n.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,l)=>{const c=t.collectedStyles.get(t.currentQuerySelector),d=c.get(l);let u=!0;d&&(s!=r&&s>=d.startTime&&r<=d.endTime&&(t.errors.push(function RMe(i,e,t,n,r){return new Pe(3010,!1)}()),u=!1),s=d.startTime),u&&c.set(l,{startTime:s,endTime:r}),t.options&&function a1e(i,e,t){const n=e.params||{},r=yQ(i);r.length&&r.forEach(s=>{n.hasOwnProperty(s)||t.push(function yMe(i){return new Pe(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function IMe(){return new Pe(3011,!1)}()),n;let s=0;const o=[];let a=!1,l=!1,c=0;const d=e.steps.map(p=>{const v=this._makeStyleAst(p,t);let b=null!=v.offset?v.offset:function w1e(i){if("string"==typeof i)return null;let e=null;if(Array.isArray(i))i.forEach(t=>{if(t instanceof Map&&t.has("offset")){const n=t;e=parseFloat(n.get("offset")),n.delete("offset")}});else if(i instanceof Map&&i.has("offset")){const t=i;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(v.styles),y=0;return null!=b&&(s++,y=v.offset=b),l=l||y<0||y>1,a=a||y<c,c=y,o.push(y),v});l&&t.errors.push(function DMe(){return new Pe(3012,!1)}()),a&&t.errors.push(function PMe(){return new Pe(3200,!1)}());const u=e.steps.length;let h=0;s>0&&s<u?t.errors.push(function kMe(){return new Pe(3202,!1)}()):0==s&&(h=1/(u-1));const f=u-1,m=t.currentTime,_=t.currentAnimateTimings,g=_.duration;return d.forEach((p,v)=>{const b=h>0?v==f?1:h*v:o[v],y=b*g;t.currentTime=m+_.delay+y,_.duration=y,this._validateStyleAst(p,t),p.offset=b,n.styles.push(p)}),n}visitReference(e,t){return{type:8,animation:mo(this,lv(e.animation),t),options:Ah(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Ah(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Ah(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function A1e(i){const e=!!i.split(/\s*,\s*/).find(t=>":self"==t);return e&&(i=i.replace(b1e,"")),i=i.replace(/@\*/g,$C).replace(/@\w+/g,t=>$C+"-"+t.slice(1)).replace(/:animating/g,k2),[i,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+s:s,po(t.collectedStyles,t.currentQuerySelector,new Map);const a=mo(this,lv(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:Ah(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function BMe(){return new Pe(3013,!1)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:JC(e.timings,t.errors,!0);return{type:12,animation:mo(this,lv(e.animation),t),timings:n,options:null}}}class x1e{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Ah(i){return i?(i=av(i)).params&&(i.params=function y1e(i){return i?av(i):null}(i.params)):i={},i}function N2(i,e,t){return{duration:i,delay:e,easing:t}}function j2(i,e,t,n,r,s,o=null,a=!1){return{type:1,element:i,keyframes:e,preStyleProps:t,postStyleProps:n,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class oM{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const S1e=new RegExp(":enter","g"),R1e=new RegExp(":leave","g");function U2(i,e,t,n,r,s=new Map,o=new Map,a,l,c=[]){return(new I1e).buildKeyframes(i,e,t,n,r,s,o,a,l,c)}class I1e{buildKeyframes(e,t,n,r,s,o,a,l,c,d=[]){c=c||new oM;const u=new V2(e,t,c,r,s,d,[]);u.options=l;const h=l.delay?ql(l.delay):0;u.currentTimeline.delayNextStep(h),u.currentTimeline.setStyles([o],null,u.errors,l),mo(this,n,u);const f=u.timelines.filter(m=>m.containsAnimation());if(f.length&&a.size){let m;for(let _=f.length-1;_>=0;_--){const g=f[_];if(g.element===t){m=g;break}}m&&!m.allowOnlyTimelineStyles()&&m.setStyles([a],null,u.errors,l)}return f.length?f.map(m=>m.buildKeyframes()):[j2(t,[],[],[],0,h,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(n,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,n),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,n){for(const r of e){const s=r?.delay;if(s){const o="number"==typeof s?s:ql(cv(s,r?.params??{},t.errors));n.delayNextStep(o)}}}_visitSubInstructions(e,t,n){let s=t.currentTimeline.currentTime;const o=null!=n.duration?ql(n.duration):null,a=null!=n.delay?ql(n.delay):null;return 0!==o&&e.forEach(l=>{const c=t.appendInstructionToTimeline(l,o,a);s=Math.max(s,c.duration+c.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),mo(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=aM);const o=ql(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>mo(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?ql(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),mo(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return JC(t.params?cv(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(n.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.hasCurrentStyleProperties()&&n.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(s):n.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,r=t.currentTimeline.duration,s=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?ql(r.delay):0;s&&(6===t.previousNode.type||0==n&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=aM);let o=n;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((c,d)=>{t.currentQueryIndex=d;const u=t.createSubContext(e.options,c);s&&u.delayNextStep(s),c===t.element&&(l=u.currentTimeline),mo(this,e.animation,u),u.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,u.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let l=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=n.currentStaggerTime}const d=t.currentTimeline;l&&d.delayNextStep(l);const u=d.currentTime;mo(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-u+(r.startTime-n.currentTimeline.startTime)}}const aM={};class V2{constructor(e,t,n,r,s,o,a,l){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=aM,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new lM(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let r=this.options;null!=n.duration&&(r.duration=ql(n.duration)),null!=n.delay&&(r.delay=ql(n.delay));const s=n.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=cv(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(r=>{n[r]=t[r]})}}return e}createSubContext(e=null,t,n){const r=t||this.element,s=new V2(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=aM,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},s=new D1e(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(S1e,"."+this._enterClassName)).replace(R1e,"."+this._leaveClassName);let c=this._driver.query(this.element,e,1!=n);0!==n&&(c=n<0?c.slice(c.length+n,c.length):c.slice(0,n)),a.push(...c)}return!s&&0==a.length&&o.push(function LMe(i){return new Pe(3014,!1)}()),a}}class lM{constructor(e,t,n,r){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new lM(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,n]of this._globalTimelineStyles)this._backFill.set(t,n||jl),this._currentKeyframe.set(t,jl);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function P1e(i,e){const t=new Map;let n;return i.forEach(r=>{if("*"===r){n=n||e.keys();for(let s of n)t.set(s,jl)}else pd(r,t)}),t}(e,this._globalTimelineStyles);for(let[a,l]of o){const c=cv(l,s,n);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??jl),this._updateStyle(a,c)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,n)=>{const r=this._styleSummary.get(n);(!r||t.time>r.time)&&this._updateStyle(n,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const c=pd(a,new Map,this._backFill);c.forEach((d,u)=>{"!"===d?e.add(u):d===jl&&t.add(u)}),n||c.set("offset",l/this.duration),r.push(c)});const s=e.size?eM(e.values()):[],o=t.size?eM(t.values()):[];if(n){const a=r[0],l=new Map(a);a.set("offset",0),l.set("offset",1),r=[a,l]}return j2(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class D1e extends lM{constructor(e,t,n,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=n,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=n+t,a=t/o,l=pd(e[0]);l.set("offset",0),s.push(l);const c=pd(e[0]);c.set("offset",EQ(a)),s.push(c);const d=e.length-1;for(let u=1;u<=d;u++){let h=pd(e[u]);const f=h.get("offset");h.set("offset",EQ((t+f*n)/o)),s.push(h)}n=o,t=0,r="",e=s}return j2(this.element,e,this.preStyleProps,this.postStyleProps,n,t,r,!0)}}function EQ(i,e=3){const t=Math.pow(10,e-1);return Math.round(i*t)/t}class z2{}const k1e=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class B1e extends z2{normalizePropertyName(e,t){return F2(e)}normalizeStyleValue(e,t,n,r){let s="";const o=n.toString().trim();if(k1e.has(t)&&0!==n&&"0"!==n)if("number"==typeof n)s="px";else{const a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function CMe(i,e){return new Pe(3005,!1)}())}return o+s}}function SQ(i,e,t,n,r,s,o,a,l,c,d,u,h){return{type:0,element:i,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:n,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:d,totalTime:u,errors:h}}const G2={};class TQ{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,r){return function L1e(i,e,t,n,r){return i.some(s=>s(e,t,n,r))}(this.ast.matchers,e,t,n,r)}buildStyles(e,t,n){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,n):new Map}build(e,t,n,r,s,o,a,l,c,d){const u=[],h=this.ast.options&&this.ast.options.params||G2,m=this.buildStyles(n,a&&a.params||G2,u),_=l&&l.params||G2,g=this.buildStyles(r,_,u),p=new Set,v=new Map,b=new Map,y="void"===r,x={params:F1e(_,h),delay:this.ast.options?.delay},w=d?[]:U2(e,t,this.ast.animation,s,o,m,g,x,c,u);let E=0;if(w.forEach(C=>{E=Math.max(C.duration+C.delay,E)}),u.length)return SQ(t,this._triggerName,n,r,y,m,g,[],[],v,b,E,u);w.forEach(C=>{const T=C.element,k=po(v,T,new Set);C.preStyleProps.forEach(L=>k.add(L));const U=po(b,T,new Set);C.postStyleProps.forEach(L=>U.add(L)),T!==t&&p.add(T)});const S=eM(p.values());return SQ(t,this._triggerName,n,r,y,m,g,w,S,v,b,E)}}function F1e(i,e){const t=av(e);for(const n in i)i.hasOwnProperty(n)&&null!=i[n]&&(t[n]=i[n]);return t}class O1e{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n=new Map,r=av(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(r[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=cv(o,r,t));const l=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,l,o,t),n.set(a,o)})}),n}}class j1e{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new O1e(r.style,r.options&&r.options.params||{},n))}),RQ(this.states,"true","1"),RQ(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new TQ(e,r,this.states))}),this.fallbackTransition=function U1e(i,e,t){return new TQ(i,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,r){return this.transitionFactories.find(o=>o.match(e,t,n,r))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function RQ(i,e,t){i.has(e)?i.has(t)||i.set(t,i.get(e)):i.has(t)&&i.set(e,i.get(t))}const V1e=new oM;class z1e{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const n=[],s=O2(this._driver,t,n,[]);if(n.length)throw function zMe(i){return new Pe(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,n){const r=e.element,s=aQ(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const r=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=U2(this._driver,t,s,P2,ZC,new Map,new Map,n,V1e,r),o.forEach(d=>{const u=po(a,d.element,new Map);d.postStyleProps.forEach(h=>u.set(h,null))})):(r.push(function GMe(){return new Pe(3300,!1)}()),o=[]),r.length)throw function HMe(i){return new Pe(3504,!1)}();a.forEach((d,u)=>{d.forEach((h,f)=>{d.set(f,this._driver.computeStyle(u,f,jl))})});const c=fd(o.map(d=>{const u=a.get(d.element);return this._buildPlayer(d,new Map,u)}));return this._playersById.set(e,c),c.onDestroy(()=>this.destroy(e)),this.players.push(c),c}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function QMe(i){return new Pe(3301,!1)}();return t}listen(e,t,n,r){const s=T2(t,"","","");return E2(this._getPlayer(e),n,s,r),()=>{}}command(e,t,n,r){if("register"==n)return void this.register(e,r[0]);if("create"==n)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(n){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const IQ="ng-animate-queued",H2="ng-animate-disabled",q1e=[],DQ={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Y1e={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Vo="__ng_removed";class Q2{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function $1e(i){return i??null}(n?e.value:e),n){const s=av(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(r=>{null==n[r]&&(n[r]=t[r])})}}}const dv="void",W2=new Q2(dv);class X1e{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,zo(t,this._hostClassName)}listen(e,t,n,r){if(!this._triggers.has(t))throw function WMe(i,e){return new Pe(3302,!1)}();if(null==n||0==n.length)throw function qMe(i){return new Pe(3303,!1)}();if(!function J1e(i){return"start"==i||"done"==i}(n))throw function YMe(i,e){return new Pe(3400,!1)}();const s=po(this._elementListeners,e,[]),o={name:t,phase:n,callback:r};s.push(o);const a=po(this._engine.statesByElement,e,new Map);return a.has(t)||(zo(e,KC),zo(e,KC+"-"+t),a.set(t,W2)),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function XMe(i){return new Pe(3401,!1)}();return t}trigger(e,t,n,r=!0){const s=this._getTrigger(t),o=new q2(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(zo(e,KC),zo(e,KC+"-"+t),this._engine.statesByElement.set(e,a=new Map));let l=a.get(t);const c=new Q2(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(t,c),l||(l=W2),c.value!==dv&&l.value===c.value){if(!function iEe(i,e){const t=Object.keys(i),n=Object.keys(e);if(t.length!=n.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||i[s]!==e[s])return!1}return!0}(l.params,c.params)){const _=[],g=s.matchStyles(l.value,l.params,_),p=s.matchStyles(c.value,c.params,_);_.length?this._engine.reportError(_):this._engine.afterFlush(()=>{vh(e,g),nl(e,p)})}return}const h=po(this._engine.playersByElement,e,[]);h.forEach(_=>{_.namespaceId==this.id&&_.triggerName==t&&_.queued&&_.destroy()});let f=s.matchTransition(l.value,c.value,e,c.params),m=!1;if(!f){if(!r)return;f=s.fallbackTransition,m=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:l,toState:c,player:o,isFallbackTransition:m}),m||(zo(e,IQ),o.onStart(()=>{Pg(e,IQ)})),o.onDone(()=>{let _=this.players.indexOf(o);_>=0&&this.players.splice(_,1);const g=this._engine.playersByElement.get(e);if(g){let p=g.indexOf(o);p>=0&&g.splice(p,1)}}),this.players.push(o),h.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,$C,!0);n.forEach(r=>{if(r[Vo])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,n,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((l,c)=>{if(o.set(c,l.value),this._triggers.has(c)){const d=this.trigger(e,c,dv,r);d&&a.push(d)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),n&&fd(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const l=this._triggers.get(o).fallbackTransition,c=n.get(o)||W2,d=new Q2(dv),u=new q2(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:l,fromState:c,toState:d,player:u,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(n.totalAnimations){const s=n.players.length?n.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(n.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)n.markElementAsRemoved(this.id,e,!1,t);else{const s=e[Vo];(!s||s===DQ)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){zo(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const s=n.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==n.triggerName){const l=T2(s,n.triggerName,n.fromState.value,n.toState.value);l._data=e,E2(n.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(n)}),this._queue=[],t.sort((n,r)=>{const s=n.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(n.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(n=>n.element===e)||t,t}}class Z1e{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new X1e(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,r=this.namespacesByHostElement;if(n.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const l=r.get(a);if(l){const c=n.indexOf(l);n.splice(c+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||n.unshift(e)}else n.push(e);return r.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}destroy(e,t){if(!e)return;const n=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(n);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>n.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n)for(let r of n.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,n,r){if(cM(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,n,r),!0}return!1}insertNode(e,t,n,r){if(!cM(t))return;const s=t[Vo];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),zo(e,H2)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Pg(e,H2))}removeNode(e,t,n,r){if(cM(t)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,n,r,s){this.collectedLeaveElements.push(t),t[Vo]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,n,r,s){return cM(t)?this._fetchNamespace(e).listen(t,n,r,s):()=>{}}_buildInstruction(e,t,n,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,$C,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,k2,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return fd(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[Vo];if(t&&t.setForRemoval){if(e[Vo]=DQ,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(H2)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,r)=>this._balanceNamespaceList(n,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)zo(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let r=0;r<n.length;r++)n[r]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?fd(t).onDone(()=>{n.forEach(r=>r())}):n.forEach(r=>r())}}reportError(e){throw function ZMe(i){return new Pe(3402,!1)}()}_flushAnimations(e,t){const n=new oM,r=[],s=new Map,o=[],a=new Map,l=new Map,c=new Map,d=new Set;this.disabledNodes.forEach(B=>{d.add(B);const V=this.driver.query(B,".ng-animate-queued",!0);for(let O=0;O<V.length;O++)d.add(V[O])});const u=this.bodyNode,h=Array.from(this.statesByElement.keys()),f=BQ(h,this.collectedEnterElements),m=new Map;let _=0;f.forEach((B,V)=>{const O=P2+_++;m.set(V,O),B.forEach(Q=>zo(Q,O))});const g=[],p=new Set,v=new Set;for(let B=0;B<this.collectedLeaveElements.length;B++){const V=this.collectedLeaveElements[B],O=V[Vo];O&&O.setForRemoval&&(g.push(V),p.add(V),O.hasAnimation?this.driver.query(V,".ng-star-inserted",!0).forEach(Q=>p.add(Q)):v.add(V))}const b=new Map,y=BQ(h,Array.from(p));y.forEach((B,V)=>{const O=ZC+_++;b.set(V,O),B.forEach(Q=>zo(Q,O))}),e.push(()=>{f.forEach((B,V)=>{const O=m.get(V);B.forEach(Q=>Pg(Q,O))}),y.forEach((B,V)=>{const O=b.get(V);B.forEach(Q=>Pg(Q,O))}),g.forEach(B=>{this.processLeaveNode(B)})});const x=[],w=[];for(let B=this._namespaceList.length-1;B>=0;B--)this._namespaceList[B].drainQueuedTransitions(t).forEach(O=>{const Q=O.player,oe=O.element;if(x.push(Q),this.collectedEnterElements.length){const D=oe[Vo];if(D&&D.setForMove){if(D.previousTriggersValues&&D.previousTriggersValues.has(O.triggerName)){const ue=D.previousTriggersValues.get(O.triggerName),Ee=this.statesByElement.get(O.element);if(Ee&&Ee.has(O.triggerName)){const me=Ee.get(O.triggerName);me.value=ue,Ee.set(O.triggerName,me)}}return void Q.destroy()}}const be=!u||!this.driver.containsElement(u,oe),de=b.get(oe),X=m.get(oe),Y=this._buildInstruction(O,n,X,de,be);if(Y.errors&&Y.errors.length)return void w.push(Y);if(be)return Q.onStart(()=>vh(oe,Y.fromStyles)),Q.onDestroy(()=>nl(oe,Y.toStyles)),void r.push(Q);if(O.isFallbackTransition)return Q.onStart(()=>vh(oe,Y.fromStyles)),Q.onDestroy(()=>nl(oe,Y.toStyles)),void r.push(Q);const re=[];Y.timelines.forEach(D=>{D.stretchStartingKeyframe=!0,this.disabledNodes.has(D.element)||re.push(D)}),Y.timelines=re,n.append(oe,Y.timelines),o.push({instruction:Y,player:Q,element:oe}),Y.queriedElements.forEach(D=>po(a,D,[]).push(Q)),Y.preStyleProps.forEach((D,ue)=>{if(D.size){let Ee=l.get(ue);Ee||l.set(ue,Ee=new Set),D.forEach((me,qe)=>Ee.add(qe))}}),Y.postStyleProps.forEach((D,ue)=>{let Ee=c.get(ue);Ee||c.set(ue,Ee=new Set),D.forEach((me,qe)=>Ee.add(qe))})});if(w.length){const B=[];w.forEach(V=>{B.push(function KMe(i,e){return new Pe(3505,!1)}())}),x.forEach(V=>V.destroy()),this.reportError(B)}const E=new Map,S=new Map;o.forEach(B=>{const V=B.element;n.has(V)&&(S.set(V,V),this._beforeAnimationBuild(B.player.namespaceId,B.instruction,E))}),r.forEach(B=>{const V=B.element;this._getPreviousPlayers(V,!1,B.namespaceId,B.triggerName,null).forEach(Q=>{po(E,V,[]).push(Q),Q.destroy()})});const C=g.filter(B=>FQ(B,l,c)),T=new Map;kQ(T,this.driver,v,c,jl).forEach(B=>{FQ(B,l,c)&&C.push(B)});const U=new Map;f.forEach((B,V)=>{kQ(U,this.driver,new Set(B),l,"!")}),C.forEach(B=>{const V=T.get(B),O=U.get(B);T.set(B,new Map([...Array.from(V?.entries()??[]),...Array.from(O?.entries()??[])]))});const L=[],j=[],H={};o.forEach(B=>{const{element:V,player:O,instruction:Q}=B;if(n.has(V)){if(d.has(V))return O.onDestroy(()=>nl(V,Q.toStyles)),O.disabled=!0,O.overrideTotalTime(Q.totalTime),void r.push(O);let oe=H;if(S.size>1){let de=V;const X=[];for(;de=de.parentNode;){const Y=S.get(de);if(Y){oe=Y;break}X.push(de)}X.forEach(Y=>S.set(Y,oe))}const be=this._buildAnimation(O.namespaceId,Q,E,s,U,T);if(O.setRealPlayer(be),oe===H)L.push(O);else{const de=this.playersByElement.get(oe);de&&de.length&&(O.parentPlayer=fd(de)),r.push(O)}}else vh(V,Q.fromStyles),O.onDestroy(()=>nl(V,Q.toStyles)),j.push(O),d.has(V)&&r.push(O)}),j.forEach(B=>{const V=s.get(B.element);if(V&&V.length){const O=fd(V);B.setRealPlayer(O)}}),r.forEach(B=>{B.parentPlayer?B.syncPlayerEvents(B.parentPlayer):B.destroy()});for(let B=0;B<g.length;B++){const V=g[B],O=V[Vo];if(Pg(V,ZC),O&&O.hasAnimation)continue;let Q=[];if(a.size){let be=a.get(V);be&&be.length&&Q.push(...be);let de=this.driver.query(V,k2,!0);for(let X=0;X<de.length;X++){let Y=a.get(de[X]);Y&&Y.length&&Q.push(...Y)}}const oe=Q.filter(be=>!be.destroyed);oe.length?eEe(this,V,oe):this.processLeaveNode(V)}return g.length=0,L.forEach(B=>{this.players.push(B),B.onDone(()=>{B.destroy();const V=this.players.indexOf(B);this.players.splice(V,1)}),B.play()}),L}elementContainsData(e,t){let n=!1;const r=t[Vo];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,r,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const l=!s||s==dv;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||o.push(c)})}}return(n||r)&&(o=o.filter(a=>!(n&&n!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,n){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const l of t.timelines){const c=l.element,d=c!==s,u=po(n,c,[]);this._getPreviousPlayers(c,d,o,a,t.toState).forEach(f=>{const m=f.getRealPlayer();m.beforeDestroy&&m.beforeDestroy(),f.destroy(),u.push(f)})}vh(s,t.fromStyles)}_buildAnimation(e,t,n,r,s,o){const a=t.triggerName,l=t.element,c=[],d=new Set,u=new Set,h=t.timelines.map(m=>{const _=m.element;d.add(_);const g=_[Vo];if(g&&g.removedBeforeQueried)return new f0(m.duration,m.delay);const p=_!==l,v=function tEe(i){const e=[];return LQ(i,e),e}((n.get(_)||q1e).map(E=>E.getRealPlayer())).filter(E=>!!E.element&&E.element===_),b=s.get(_),y=o.get(_),x=aQ(0,this._normalizer,0,m.keyframes,b,y),w=this._buildPlayer(m,x,v);if(m.subTimeline&&r&&u.add(_),p){const E=new q2(e,a,_);E.setRealPlayer(w),c.push(E)}return w});c.forEach(m=>{po(this.playersByQueriedElement,m.element,[]).push(m),m.onDone(()=>function K1e(i,e,t){let n=i.get(e);if(n){if(n.length){const r=n.indexOf(t);n.splice(r,1)}0==n.length&&i.delete(e)}return n}(this.playersByQueriedElement,m.element,m))}),d.forEach(m=>zo(m,gQ));const f=fd(h);return f.onDestroy(()=>{d.forEach(m=>Pg(m,gQ)),nl(l,t.toStyles)}),u.forEach(m=>{po(r,m,[]).push(f)}),f}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new f0(e.duration,e.delay)}}class q2{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new f0,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,n)=>{t.forEach(r=>E2(e,n,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){po(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function cM(i){return i&&1===i.nodeType}function PQ(i,e){const t=i.style.display;return i.style.display=e??"none",t}function kQ(i,e,t,n,r){const s=[];t.forEach(l=>s.push(PQ(l)));const o=[];n.forEach((l,c)=>{const d=new Map;l.forEach(u=>{const h=e.computeStyle(c,u,r);d.set(u,h),(!h||0==h.length)&&(c[Vo]=Y1e,o.push(c))}),i.set(c,d)});let a=0;return t.forEach(l=>PQ(l,s[a++])),o}function BQ(i,e){const t=new Map;if(i.forEach(a=>t.set(a,[])),0==e.length)return t;const r=new Set(e),s=new Map;function o(a){if(!a)return 1;let l=s.get(a);if(l)return l;const c=a.parentNode;return l=t.has(c)?c:r.has(c)?1:o(c),s.set(a,l),l}return e.forEach(a=>{const l=o(a);1!==l&&t.get(l).push(a)}),t}function zo(i,e){i.classList?.add(e)}function Pg(i,e){i.classList?.remove(e)}function eEe(i,e,t){fd(t).onDone(()=>i.processLeaveNode(e))}function LQ(i,e){for(let t=0;t<i.length;t++){const n=i[t];n instanceof Sz?LQ(n.players,e):e.push(n)}}function FQ(i,e,t){const n=t.get(i);if(!n)return!1;let r=e.get(i);return r?n.forEach(s=>r.add(s)):e.set(i,n),t.delete(i),!0}class dM{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new Z1e(e,t,n),this._timelineEngine=new z1e(e,t,n),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,n,r,s){const o=e+"-"+r;let a=this._triggerCache[o];if(!a){const l=[],d=O2(this._driver,s,l,[]);if(l.length)throw function UMe(i,e){return new Pe(3404,!1)}();a=function N1e(i,e,t){return new j1e(i,e,t)}(r,d,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}onRemove(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,r){if("@"==n.charAt(0)){const[s,o]=lQ(n);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}listen(e,t,n,r,s){if("@"==n.charAt(0)){const[o,a]=lQ(n);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,n,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let rEe=(()=>{class i{constructor(t,n,r){this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;let s=i.initialStylesByElement.get(t);s||i.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&nl(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(nl(this._element,this._initialStyles),this._endStyles&&(nl(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(i.initialStylesByElement.delete(this._element),this._startStyles&&(vh(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(vh(this._element,this._endStyles),this._endStyles=null),nl(this._element,this._initialStyles),this._state=3)}}return i.initialStylesByElement=new WeakMap,i})();function Y2(i){let e=null;return i.forEach((t,n)=>{(function sEe(i){return"display"===i||"position"===i})(n)&&(e=e||new Map,e.set(n,t))}),e}class OQ{constructor(e,t,n,r){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(n=>{t.push(Object.fromEntries(n))}),t}_triggerWebAnimation(e,t,n){return e.animate(this._convertKeyframesToObject(t),n)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,r)=>{"offset"!==r&&e.set(r,this._finished?n:xQ(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class oEe{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return hQ(e,t)}getParentElement(e){return I2(e)}query(e,t,n){return fQ(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,r,s,o=[]){const l={duration:n,delay:r,fill:0==r?"both":"forwards"};s&&(l.easing=s);const c=new Map,d=o.filter(f=>f instanceof OQ);(function d1e(i,e){return 0===i||0===e})(n,r)&&d.forEach(f=>{f.currentSnapshot.forEach((m,_)=>c.set(_,m))});let u=function o1e(i){return i.length?i[0]instanceof Map?i:i.map(e=>_Q(e)):[]}(t).map(f=>pd(f));u=function u1e(i,e,t){if(t.size&&e.length){let n=e[0],r=[];if(t.forEach((s,o)=>{n.has(o)||r.push(o),n.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(a=>o.set(a,xQ(i,a)))}}return e}(e,u,c);const h=function nEe(i,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=Y2(e[0]),e.length>1&&(n=Y2(e[e.length-1]))):e instanceof Map&&(t=Y2(e)),t||n?new rEe(i,t,n):null}(e,u);return new OQ(e,u,l,h)}}let aEe=(()=>{class i extends Cz{constructor(t,n){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(n.body,{id:"0",encapsulation:Qo.None,styles:[],data:{animation:[]}})}build(t){const n=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?Mz(t):t;return NQ(this._renderer,null,n,"register",[r]),new lEe(n,this._renderer)}}return i.\u0275fac=function(t){return new(t||i)(xe(s_),xe(ti))},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})();class lEe extends spe{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new cEe(this._id,e,t||{},this._renderer)}}class cEe{constructor(e,t,n,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return NQ(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function NQ(i,e,t,n,r){return i.setProperty(e,`@@${t}:${n}`,r)}const jQ="@.disabled";let dEe=(()=>{class i{constructor(t,n,r){this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=(s,o)=>{const a=o?.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,n){const s=this.delegate.createRenderer(t,n);if(!(t&&n&&n.data&&n.data.animation)){let d=this._rendererCache.get(s);return d||(d=new UQ("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,d)),d}const o=n.id,a=n.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const l=d=>{Array.isArray(d)?d.forEach(l):this.engine.registerTrigger(o,a,t,d.name,d)};return n.data.animation.forEach(l),new uEe(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,n,r){t>=0&&t<this._microtaskId?this._zone.run(()=>n(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return i.\u0275fac=function(t){return new(t||i)(xe(s_),xe(dM),xe(gt))},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})();class UQ{constructor(e,t,n,r){this.namespaceId=e,this.delegate=t,this.engine=n,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?s=>t.destroyNode(s):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,r=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,r){this.delegate.setStyle(e,t,n,r)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==jQ?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class uEe extends UQ{constructor(e,t,n,r,s){super(t,n,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==jQ?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.slice(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const r=function hEe(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function fEe(i){const e=i.indexOf(".");return[i.substring(0,e),i.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,n,a)})}return this.delegate.listen(e,t,n)}}let pEe=(()=>{class i extends dM{constructor(t,n,r,s){super(t.body,n,r)}ngOnDestroy(){this.flush()}}return i.\u0275fac=function(t){return new(t||i)(xe(ti),xe(D2),xe(z2),xe(uf))},i.\u0275prov=He({token:i,factory:i.\u0275fac}),i})();const VQ=[{provide:Cz,useClass:aEe},{provide:z2,useFactory:function mEe(){return new B1e}},{provide:dM,useClass:pEe},{provide:s_,useFactory:function gEe(i,e,t){return new dEe(i,e,t)},deps:[QA,dM,gt]}],X2=[{provide:D2,useFactory:()=>new oEe},{provide:rs,useValue:"BrowserAnimations"},...VQ],zQ=[{provide:D2,useClass:pQ},{provide:rs,useValue:"NoopAnimations"},...VQ];let _Ee=(()=>{class i{static withConfig(t){return{ngModule:i,providers:t.disableAnimations?zQ:X2}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=li({type:i}),i.\u0275inj=si({providers:X2,imports:[K3]}),i})();class kg{}kg.\u0275fac=function(e){return new(e||kg)},kg.\u0275mod=li({type:kg,bootstrap:[ov]}),kg.\u0275inj=si({providers:[{provide:_w,useValue:{fullLibraryLoader:()=>xh.e(225).then(xh.bind(xh,7225))}},Kx],imports:[K3,Rg,Vp,Dg,zye,Tme,_Ee,nhe,A2,SI,RCe,kI,v2]}),QJ().bootstrapModule(kg).catch(i=>console.error(i))}},pM=>{pM(pM.s=4210)}]);